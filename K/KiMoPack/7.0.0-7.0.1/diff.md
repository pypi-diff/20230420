# Comparing `tmp/KiMoPack-7.0.0.tar.gz` & `tmp/KiMoPack-7.0.1.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "KiMoPack-7.0.0.tar", last modified: Tue Mar 28 10:05:55 2023, max compression
+gzip compressed data, was "KiMoPack-7.0.1.tar", last modified: Thu Apr 20 11:01:27 2023, max compression
```

## Comparing `KiMoPack-7.0.0.tar` & `KiMoPack-7.0.1.tar`

### file list

```diff
@@ -1,62 +1,51 @@
-drwxrwxrwx   0        0        0        0 2023-03-28 10:05:55.174435 KiMoPack-7.0.0/
--rw-rw-rw-   0        0        0    35823 2021-09-12 20:51:08.000000 KiMoPack-7.0.0/LICENSE
--rw-rw-rw-   0        0        0       51 2022-06-13 14:27:08.000000 KiMoPack-7.0.0/MANIFEST.in
--rw-rw-rw-   0        0        0     5530 2023-03-28 10:05:55.174435 KiMoPack-7.0.0/PKG-INFO
--rw-rw-rw-   0        0        0     4669 2022-12-08 21:00:40.000000 KiMoPack-7.0.0/README.rst
-drwxrwxrwx   0        0        0        0 2023-03-28 10:05:55.121465 KiMoPack-7.0.0/Workflow_tools/
-drwxrwxrwx   0        0        0        0 2023-03-28 10:05:55.133458 KiMoPack-7.0.0/Workflow_tools/.ipynb_checkpoints/
--rw-rw-rw-   0        0        0     7627 2023-03-28 09:55:29.000000 KiMoPack-7.0.0/Workflow_tools/.ipynb_checkpoints/TA_Advanced_Fit-checkpoint.ipynb
--rw-rw-rw-   0        0        0     3472 2022-12-08 22:16:07.000000 KiMoPack-7.0.0/Workflow_tools/.ipynb_checkpoints/TA_Kumar-checkpoint.ipynb
--rw-rw-rw-   0        0        0     4808 2023-03-28 09:56:04.000000 KiMoPack-7.0.0/Workflow_tools/.ipynb_checkpoints/TA_Raw_plotting-checkpoint.ipynb
--rw-rw-rw-   0        0        0    11390 2023-03-28 09:55:52.000000 KiMoPack-7.0.0/Workflow_tools/.ipynb_checkpoints/TA_Raw_plotting_and_Simple_Fit-checkpoint.ipynb
--rw-rw-rw-   0        0        0     5442 2023-03-28 09:55:18.000000 KiMoPack-7.0.0/Workflow_tools/.ipynb_checkpoints/TA_comparative_plotting_and_data_extraction-checkpoint.ipynb
--rw-rw-rw-   0        0        0     3897 2023-03-28 09:55:43.000000 KiMoPack-7.0.0/Workflow_tools/.ipynb_checkpoints/TA_single_scan_handling-checkpoint.ipynb
--rw-rw-rw-   0        0        0    14416 2022-11-08 18:55:10.000000 KiMoPack-7.0.0/Workflow_tools/.ipynb_checkpoints/TA_testing-checkpoint.ipynb
-drwxrwxrwx   0        0        0        0 2023-03-28 10:05:55.138456 KiMoPack-7.0.0/Workflow_tools/Data/
--rw-rw-rw-   0        0        0  1263591 2020-05-19 08:45:04.000000 KiMoPack-7.0.0/Workflow_tools/Data/Sample_1.SIA
--rw-rw-rw-   0        0        0  1268547 2020-05-15 07:11:18.000000 KiMoPack-7.0.0/Workflow_tools/Data/Sample_2.SIA
--rw-rw-rw-   0        0        0     8532 2022-07-20 12:02:05.000000 KiMoPack-7.0.0/Workflow_tools/Ivan_horse.ipynb
--rw-rw-rw-   0        0        0    11744 2022-07-08 21:17:55.000000 KiMoPack-7.0.0/Workflow_tools/Streak_camera_analysis.ipynb
--rw-rw-rw-   0        0        0    17958 2022-07-20 10:17:48.000000 KiMoPack-7.0.0/Workflow_tools/TA testing.ipynb
--rw-rw-rw-   0        0        0     7627 2023-03-28 09:55:29.000000 KiMoPack-7.0.0/Workflow_tools/TA_Advanced_Fit.ipynb
--rw-rw-rw-   0        0        0     7794 2022-07-19 10:01:23.000000 KiMoPack-7.0.0/Workflow_tools/TA_Pump_dump.ipynb
--rw-rw-rw-   0        0        0     4808 2023-03-28 09:56:04.000000 KiMoPack-7.0.0/Workflow_tools/TA_Raw_plotting.ipynb
--rw-rw-rw-   0        0        0    11390 2023-03-28 09:55:52.000000 KiMoPack-7.0.0/Workflow_tools/TA_Raw_plotting_and_Simple_Fit.ipynb
--rw-rw-rw-   0        0        0     5442 2023-03-28 09:55:18.000000 KiMoPack-7.0.0/Workflow_tools/TA_comparative_plotting_and_data_extraction.ipynb
--rw-rw-rw-   0        0        0     3897 2023-03-28 09:55:43.000000 KiMoPack-7.0.0/Workflow_tools/TA_single_scan_handling.ipynb
--rw-rw-rw-   0        0        0    14823 2022-12-08 21:48:41.000000 KiMoPack-7.0.0/Workflow_tools/TA_testing.ipynb
-drwxrwxrwx   0        0        0        0 2023-03-28 10:05:55.150449 KiMoPack-7.0.0/Workflow_tools/Workflow_tools/
-drwxrwxrwx   0        0        0        0 2023-03-28 10:05:55.154446 KiMoPack-7.0.0/Workflow_tools/Workflow_tools/.ipynb_checkpoints/
--rw-rw-rw-   0        0        0     7426 2023-03-28 09:52:30.000000 KiMoPack-7.0.0/Workflow_tools/Workflow_tools/.ipynb_checkpoints/TA_Advanced_Fit-checkpoint.ipynb
--rw-rw-rw-   0        0        0    11279 2023-03-28 09:46:08.000000 KiMoPack-7.0.0/Workflow_tools/Workflow_tools/.ipynb_checkpoints/TA_Raw_plotting_and_Simple_Fit-checkpoint.ipynb
--rw-rw-rw-   0        0        0     7426 2023-03-28 09:52:30.000000 KiMoPack-7.0.0/Workflow_tools/Workflow_tools/TA_Advanced_Fit.ipynb
--rw-rw-rw-   0        0        0     4776 2023-03-28 09:36:07.000000 KiMoPack-7.0.0/Workflow_tools/Workflow_tools/TA_Raw_plotting.ipynb
--rw-rw-rw-   0        0        0    32440 2023-03-28 09:49:02.000000 KiMoPack-7.0.0/Workflow_tools/Workflow_tools/TA_Raw_plotting_and_Simple_Fit.ipynb
--rw-rw-rw-   0        0        0     5709 2023-03-28 09:36:06.000000 KiMoPack-7.0.0/Workflow_tools/Workflow_tools/TA_comparative_plotting_and_data_extraction.ipynb
--rw-rw-rw-   0        0        0     4169 2023-03-28 09:36:07.000000 KiMoPack-7.0.0/Workflow_tools/Workflow_tools/TA_single_scan_handling.ipynb
--rw-rw-rw-   0        0        0    41576 2023-03-28 09:36:08.000000 KiMoPack-7.0.0/Workflow_tools/Workflow_tools/function_library.py
--rw-rw-rw-   0        0        0     1989 2023-03-28 09:36:08.000000 KiMoPack-7.0.0/Workflow_tools/Workflow_tools/import_library.py
-drwxrwxrwx   0        0        0        0 2023-03-28 10:04:02.454357 KiMoPack-7.0.0/Workflow_tools/additional_formats/
-drwxrwxrwx   0        0        0        0 2023-03-28 10:05:55.084486 KiMoPack-7.0.0/Workflow_tools/additional_formats/streak_camera/
-drwxrwxrwx   0        0        0        0 2023-03-28 10:05:55.156445 KiMoPack-7.0.0/Workflow_tools/additional_formats/streak_camera/.ipynb_checkpoints/
--rw-rw-rw-   0        0        0    16723 2022-07-08 19:10:02.000000 KiMoPack-7.0.0/Workflow_tools/additional_formats/streak_camera/.ipynb_checkpoints/Importing and analysis of emission data-checkpoint.ipynb
--rw-rw-rw-   0        0        0    24324 2022-07-08 21:14:23.000000 KiMoPack-7.0.0/Workflow_tools/additional_formats/streak_camera/Analysis of emission data.ipynb
--rw-rw-rw-   0        0        0     1055 2022-07-08 19:34:34.000000 KiMoPack-7.0.0/Workflow_tools/additional_formats/streak_camera/import_library.py
-drwxrwxrwx   0        0        0        0 2023-03-28 10:05:55.158444 KiMoPack-7.0.0/Workflow_tools/additional_functions/
--rw-rw-rw-   0        0        0     1399 2022-11-27 20:54:31.000000 KiMoPack-7.0.0/Workflow_tools/additional_functions/cut.py
--rw-rw-rw-   0        0        0    33184 2022-06-13 13:57:20.000000 KiMoPack-7.0.0/Workflow_tools/additional_functions/standard_functions.py
--rw-rw-rw-   0        0        0    42156 2022-12-08 21:58:00.000000 KiMoPack-7.0.0/Workflow_tools/function_library.py
--rw-rw-rw-   0        0        0     2052 2022-07-20 11:34:37.000000 KiMoPack-7.0.0/Workflow_tools/import_library.py
--rw-rw-rw-   0        0        0      108 2021-09-12 20:51:08.000000 KiMoPack-7.0.0/pyproject.toml
--rw-rw-rw-   0        0        0     1080 2023-03-28 10:05:55.175434 KiMoPack-7.0.0/setup.cfg
--rw-rw-rw-   0        0        0     1103 2022-06-13 14:38:11.000000 KiMoPack-7.0.0/setup.py
-drwxrwxrwx   0        0        0        0 2023-03-28 10:05:55.088483 KiMoPack-7.0.0/src/
-drwxrwxrwx   0        0        0        0 2023-03-28 10:05:55.161442 KiMoPack-7.0.0/src/KiMoPack/
--rw-rw-rw-   0        0        0     4424 2022-10-03 11:31:41.000000 KiMoPack-7.0.0/src/KiMoPack/__init__.py
--rw-rw-rw-   0        0        0   423391 2023-03-28 10:00:31.000000 KiMoPack-7.0.0/src/KiMoPack/plot_func.py
-drwxrwxrwx   0        0        0        0 2023-03-28 10:05:55.173435 KiMoPack-7.0.0/src/KiMoPack.egg-info/
--rw-rw-rw-   0        0        0     5530 2023-03-28 10:05:55.000000 KiMoPack-7.0.0/src/KiMoPack.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0     2305 2023-03-28 10:05:55.000000 KiMoPack-7.0.0/src/KiMoPack.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2023-03-28 10:05:55.000000 KiMoPack-7.0.0/src/KiMoPack.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0       87 2023-03-28 10:05:55.000000 KiMoPack-7.0.0/src/KiMoPack.egg-info/requires.txt
--rw-rw-rw-   0        0        0        9 2023-03-28 10:05:55.000000 KiMoPack-7.0.0/src/KiMoPack.egg-info/top_level.txt
+drwxrwxrwx   0        0        0        0 2023-04-20 11:01:27.326099 KiMoPack-7.0.1/
+-rw-rw-rw-   0        0        0    35823 2021-09-12 20:51:08.000000 KiMoPack-7.0.1/LICENSE
+-rw-rw-rw-   0        0        0       51 2022-06-13 14:27:08.000000 KiMoPack-7.0.1/MANIFEST.in
+-rw-rw-rw-   0        0        0     5530 2023-04-20 11:01:27.326099 KiMoPack-7.0.1/PKG-INFO
+-rw-rw-rw-   0        0        0     4669 2022-12-08 21:00:40.000000 KiMoPack-7.0.1/README.rst
+drwxrwxrwx   0        0        0        0 2023-04-20 11:01:27.182421 KiMoPack-7.0.1/Workflow_tools/
+drwxrwxrwx   0        0        0        0 2023-04-20 11:01:27.234228 KiMoPack-7.0.1/Workflow_tools/.ipynb_checkpoints/
+-rw-rw-rw-   0        0        0     7627 2023-03-28 09:55:29.000000 KiMoPack-7.0.1/Workflow_tools/.ipynb_checkpoints/TA_Advanced_Fit-checkpoint.ipynb
+-rw-rw-rw-   0        0        0     3472 2022-12-08 22:16:07.000000 KiMoPack-7.0.1/Workflow_tools/.ipynb_checkpoints/TA_Kumar-checkpoint.ipynb
+-rw-rw-rw-   0        0        0     4808 2023-03-28 09:56:04.000000 KiMoPack-7.0.1/Workflow_tools/.ipynb_checkpoints/TA_Raw_plotting-checkpoint.ipynb
+-rw-rw-rw-   0        0        0    11395 2023-04-18 15:07:49.000000 KiMoPack-7.0.1/Workflow_tools/.ipynb_checkpoints/TA_Raw_plotting_and_Simple_Fit-checkpoint.ipynb
+-rw-rw-rw-   0        0        0     5442 2023-03-28 09:55:18.000000 KiMoPack-7.0.1/Workflow_tools/.ipynb_checkpoints/TA_comparative_plotting_and_data_extraction-checkpoint.ipynb
+-rw-rw-rw-   0        0        0     3897 2023-03-28 09:55:43.000000 KiMoPack-7.0.1/Workflow_tools/.ipynb_checkpoints/TA_single_scan_handling-checkpoint.ipynb
+-rw-rw-rw-   0        0        0    14416 2022-11-08 18:55:10.000000 KiMoPack-7.0.1/Workflow_tools/.ipynb_checkpoints/TA_testing-checkpoint.ipynb
+drwxrwxrwx   0        0        0        0 2023-04-20 11:01:27.252232 KiMoPack-7.0.1/Workflow_tools/Data/
+-rw-rw-rw-   0        0        0  1263591 2020-05-19 08:45:04.000000 KiMoPack-7.0.1/Workflow_tools/Data/Sample_1.SIA
+-rw-rw-rw-   0        0        0  1268547 2020-05-15 07:11:18.000000 KiMoPack-7.0.1/Workflow_tools/Data/Sample_2.SIA
+-rw-rw-rw-   0        0        0     8532 2022-07-20 12:02:05.000000 KiMoPack-7.0.1/Workflow_tools/Ivan_horse.ipynb
+-rw-rw-rw-   0        0        0    11744 2022-07-08 21:17:55.000000 KiMoPack-7.0.1/Workflow_tools/Streak_camera_analysis.ipynb
+-rw-rw-rw-   0        0        0    17958 2022-07-20 10:17:48.000000 KiMoPack-7.0.1/Workflow_tools/TA testing.ipynb
+-rw-rw-rw-   0        0        0     8046 2023-04-18 15:49:27.000000 KiMoPack-7.0.1/Workflow_tools/TA_Advanced_Fit.ipynb
+-rw-rw-rw-   0        0        0     7794 2022-07-19 10:01:23.000000 KiMoPack-7.0.1/Workflow_tools/TA_Pump_dump.ipynb
+-rw-rw-rw-   0        0        0     4808 2023-03-28 09:56:04.000000 KiMoPack-7.0.1/Workflow_tools/TA_Raw_plotting.ipynb
+-rw-rw-rw-   0        0        0    11395 2023-04-18 16:23:38.000000 KiMoPack-7.0.1/Workflow_tools/TA_Raw_plotting_and_Simple_Fit.ipynb
+-rw-rw-rw-   0        0        0     5442 2023-03-28 09:55:18.000000 KiMoPack-7.0.1/Workflow_tools/TA_comparative_plotting_and_data_extraction.ipynb
+-rw-rw-rw-   0        0        0     3897 2023-03-28 09:55:43.000000 KiMoPack-7.0.1/Workflow_tools/TA_single_scan_handling.ipynb
+-rw-rw-rw-   0        0        0    14823 2022-12-08 21:48:59.000000 KiMoPack-7.0.1/Workflow_tools/TA_testing.ipynb
+drwxrwxrwx   0        0        0        0 2023-04-20 11:01:27.021874 KiMoPack-7.0.1/Workflow_tools/additional_formats/
+drwxrwxrwx   0        0        0        0 2023-04-20 11:01:27.276234 KiMoPack-7.0.1/Workflow_tools/additional_formats/streak_camera/
+drwxrwxrwx   0        0        0        0 2023-04-20 11:01:27.288231 KiMoPack-7.0.1/Workflow_tools/additional_formats/streak_camera/.ipynb_checkpoints/
+-rw-rw-rw-   0        0        0    16723 2022-07-08 19:10:02.000000 KiMoPack-7.0.1/Workflow_tools/additional_formats/streak_camera/.ipynb_checkpoints/Importing and analysis of emission data-checkpoint.ipynb
+-rw-rw-rw-   0        0        0    24324 2022-07-08 21:14:23.000000 KiMoPack-7.0.1/Workflow_tools/additional_formats/streak_camera/Analysis of emission data.ipynb
+-rw-rw-rw-   0        0        0     1055 2022-07-08 19:34:34.000000 KiMoPack-7.0.1/Workflow_tools/additional_formats/streak_camera/import_library.py
+drwxrwxrwx   0        0        0        0 2023-04-20 11:01:27.308430 KiMoPack-7.0.1/Workflow_tools/additional_functions/
+-rw-rw-rw-   0        0        0     1399 2022-11-27 20:54:31.000000 KiMoPack-7.0.1/Workflow_tools/additional_functions/cut.py
+-rw-rw-rw-   0        0        0    33184 2022-06-13 13:57:20.000000 KiMoPack-7.0.1/Workflow_tools/additional_functions/standard_functions.py
+-rw-rw-rw-   0        0        0    42156 2022-12-08 21:58:00.000000 KiMoPack-7.0.1/Workflow_tools/function_library.py
+-rw-rw-rw-   0        0        0     2052 2022-07-20 11:34:37.000000 KiMoPack-7.0.1/Workflow_tools/import_library.py
+-rw-rw-rw-   0        0        0      108 2021-09-12 20:51:08.000000 KiMoPack-7.0.1/pyproject.toml
+-rw-rw-rw-   0        0        0     1080 2023-04-20 11:01:27.342167 KiMoPack-7.0.1/setup.cfg
+-rw-rw-rw-   0        0        0     1103 2022-06-13 14:38:11.000000 KiMoPack-7.0.1/setup.py
+drwxrwxrwx   0        0        0        0 2023-04-20 11:01:27.024732 KiMoPack-7.0.1/src/
+drwxrwxrwx   0        0        0        0 2023-04-20 11:01:27.318099 KiMoPack-7.0.1/src/KiMoPack/
+-rw-rw-rw-   0        0        0     4424 2022-10-03 11:31:41.000000 KiMoPack-7.0.1/src/KiMoPack/__init__.py
+-rw-rw-rw-   0        0        0   423466 2023-04-20 10:59:57.000000 KiMoPack-7.0.1/src/KiMoPack/plot_func.py
+drwxrwxrwx   0        0        0        0 2023-04-20 11:01:27.324098 KiMoPack-7.0.1/src/KiMoPack.egg-info/
+-rw-rw-rw-   0        0        0     5530 2023-04-20 11:01:26.000000 KiMoPack-7.0.1/src/KiMoPack.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0     1717 2023-04-20 11:01:27.000000 KiMoPack-7.0.1/src/KiMoPack.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2023-04-20 11:01:26.000000 KiMoPack-7.0.1/src/KiMoPack.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0       87 2023-04-20 11:01:26.000000 KiMoPack-7.0.1/src/KiMoPack.egg-info/requires.txt
+-rw-rw-rw-   0        0        0        9 2023-04-20 11:01:26.000000 KiMoPack-7.0.1/src/KiMoPack.egg-info/top_level.txt
```

### Comparing `KiMoPack-7.0.0/LICENSE` & `KiMoPack-7.0.1/LICENSE`

 * *Files identical despite different names*

### Comparing `KiMoPack-7.0.0/PKG-INFO` & `KiMoPack-7.0.1/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: KiMoPack
-Version: 7.0.0
+Version: 7.0.1
 Summary: A comprehensive package for the analysis of kinetic data.
 Home-page: https://github.com/erdzeichen/KiMoPack
 Author: Jens Uhlig
 Author-email: jens.uhlig@chemphys.lu.se
 Project-URL: Bug Tracker, https://github.com/erdzeichen/KiMoPack/issues
 Classifier: Programming Language :: Python :: 3
 Classifier: License :: OSI Approved :: GNU General Public License v3 (GPLv3)
```

### Comparing `KiMoPack-7.0.0/README.rst` & `KiMoPack-7.0.1/README.rst`

 * *Files identical despite different names*

### Comparing `KiMoPack-7.0.0/Workflow_tools/.ipynb_checkpoints/TA_Advanced_Fit-checkpoint.ipynb` & `KiMoPack-7.0.1/Workflow_tools/.ipynb_checkpoints/TA_Advanced_Fit-checkpoint.ipynb`

 * *Files identical despite different names*

### Comparing `KiMoPack-7.0.0/Workflow_tools/.ipynb_checkpoints/TA_Kumar-checkpoint.ipynb` & `KiMoPack-7.0.1/Workflow_tools/.ipynb_checkpoints/TA_Kumar-checkpoint.ipynb`

 * *Files identical despite different names*

### Comparing `KiMoPack-7.0.0/Workflow_tools/.ipynb_checkpoints/TA_Raw_plotting-checkpoint.ipynb` & `KiMoPack-7.0.1/Workflow_tools/.ipynb_checkpoints/TA_Raw_plotting-checkpoint.ipynb`

 * *Files identical despite different names*

### Comparing `KiMoPack-7.0.0/Workflow_tools/.ipynb_checkpoints/TA_Raw_plotting_and_Simple_Fit-checkpoint.ipynb` & `KiMoPack-7.0.1/Workflow_tools/.ipynb_checkpoints/TA_Raw_plotting_and_Simple_Fit-checkpoint.ipynb`

 * *Files 2% similar despite different names*

#### Pretty-printed

 * *Similarity: 0.9982433862433863%*

 * *Differences: {"'cells'": '{5: {\'source\': {insert: [(2, "ta.Cor_Chirp() #correct for arrival time difference '*

 * *            'ta.Cor_Chirp(\'gui\') allows to choose file ")], delete: [2]}}, 9: {\'source\': '*

 * *            '{insert: [(2, "ta.mod=\'exponential\'                                        # Choose '*

 * *            "the model 'exponential', 'consecutive' and 'fast_consecutive'are build "*

 * *            'in\\n")], delete: [2]}}}',*

 * * "'metadata'": "{'language_info': {'version': '3.9.12'}}"}*

```diff
@@ -53,15 +53,15 @@
             "cell_type": "code",
             "execution_count": null,
             "metadata": {},
             "outputs": [],
             "source": [
                 "ta.Filter_data(value=21)               #remove bad data here everything above abs=21 is considered bad\n",
                 "ta.intensity_range=ta.ds.describe().median(axis=1)['75%']*2\n",
-                "ta.Man_Chirp() #correct for arrival time difference ta.Cor_Chirp('gui') allows to choose file "
+                "ta.Cor_Chirp() #correct for arrival time difference ta.Cor_Chirp('gui') allows to choose file "
             ]
         },
         {
             "cell_type": "markdown",
             "metadata": {},
             "source": [
                 "### Shape data and plot Raw images"
@@ -99,15 +99,15 @@
             "cell_type": "code",
             "execution_count": null,
             "metadata": {},
             "outputs": [],
             "source": [
                 "ta.wave_nm_bin=2; \n",
                 "plt.close('all')                                             # Close old spectra\n",
-                "ta.mod=mod.p12                                         # Choose the model 'exponential', 'consecutive' and 'fast_consecutive'are build in\n",
+                "ta.mod='exponential'                                        # Choose the model 'exponential', 'consecutive' and 'fast_consecutive'are build in\n",
                 "par=lmfit.Parameters()                                       # create empty parameter object\n",
                 "\n",
                 "par.add('k0',value=1/0.1,vary=True)                                # Add second rate component\n",
                 "par.add('k1',value=1/2.5,vary=True)                                # Add one rate component\n",
                 "par.add('k2',value=1/40,vary=True)                                 # Add second rate component\n",
                 "par.add('t0',value=0,min=-2,max=2,vary=False)                       # Allow the arrival time to adjust (for all)\n",
                 "par.add('resolution',value=0.086,min=0.04,max=0.5,vary=False)       # Allow the instrument response to adjust (for all)\n",
@@ -320,13 +320,13 @@
                 "version": 3
             },
             "file_extension": ".py",
             "mimetype": "text/x-python",
             "name": "python",
             "nbconvert_exporter": "python",
             "pygments_lexer": "ipython3",
-            "version": "3.9.16"
+            "version": "3.9.12"
         }
     },
     "nbformat": 4,
     "nbformat_minor": 2
 }
```

### Comparing `KiMoPack-7.0.0/Workflow_tools/.ipynb_checkpoints/TA_comparative_plotting_and_data_extraction-checkpoint.ipynb` & `KiMoPack-7.0.1/Workflow_tools/.ipynb_checkpoints/TA_comparative_plotting_and_data_extraction-checkpoint.ipynb`

 * *Files identical despite different names*

### Comparing `KiMoPack-7.0.0/Workflow_tools/.ipynb_checkpoints/TA_single_scan_handling-checkpoint.ipynb` & `KiMoPack-7.0.1/Workflow_tools/.ipynb_checkpoints/TA_single_scan_handling-checkpoint.ipynb`

 * *Files identical despite different names*

### Comparing `KiMoPack-7.0.0/Workflow_tools/.ipynb_checkpoints/TA_testing-checkpoint.ipynb` & `KiMoPack-7.0.1/Workflow_tools/.ipynb_checkpoints/TA_testing-checkpoint.ipynb`

 * *Files identical despite different names*

### Comparing `KiMoPack-7.0.0/Workflow_tools/Data/Sample_1.SIA` & `KiMoPack-7.0.1/Workflow_tools/Data/Sample_1.SIA`

 * *Files identical despite different names*

### Comparing `KiMoPack-7.0.0/Workflow_tools/Data/Sample_2.SIA` & `KiMoPack-7.0.1/Workflow_tools/Data/Sample_2.SIA`

 * *Files identical despite different names*

### Comparing `KiMoPack-7.0.0/Workflow_tools/Ivan_horse.ipynb` & `KiMoPack-7.0.1/Workflow_tools/Ivan_horse.ipynb`

 * *Files identical despite different names*

### Comparing `KiMoPack-7.0.0/Workflow_tools/Streak_camera_analysis.ipynb` & `KiMoPack-7.0.1/Workflow_tools/Streak_camera_analysis.ipynb`

 * *Files identical despite different names*

### Comparing `KiMoPack-7.0.0/Workflow_tools/TA testing.ipynb` & `KiMoPack-7.0.1/Workflow_tools/TA testing.ipynb`

 * *Files identical despite different names*

### Comparing `KiMoPack-7.0.0/Workflow_tools/TA_Advanced_Fit.ipynb` & `KiMoPack-7.0.1/Workflow_tools/TA_Pump_dump.ipynb`

 * *Files 2% similar despite different names*

#### Pretty-printed

 * *Similarity: 0.9843716931216931%*

 * *Differences: {"'cells'": "{1: {'source': {insert: [(3, '%matplotlib qt\\n')], delete: [5, 4, 3]}}, 6: "*

 * *            '{\'source\': {insert: [(6, "par.add(\'f0\',value=5)\\n")], delete: [6]}}, insert: '*

 * *            "[(17, OrderedDict([('cell_type', 'code'), ('execution_count', None), ('metadata', "*

 * *            "OrderedDict()), ('outputs', []), ('source', "*

 * *            "['ta.Fit_Global(multi_project=other_projects,same_DAS = True)'])])), (18, "*

 * *            "OrderedDict([('cell_type', 'code'), ('execution_count', None), ('m […]*

```diff
@@ -12,17 +12,15 @@
             "execution_count": null,
             "metadata": {},
             "outputs": [],
             "source": [
                 "import matplotlib,lmfit,os,sys\n",
                 "import matplotlib.pyplot as plt\n",
                 "import numpy as np\n",
-                "%matplotlib tk\n",
-                "#for more comfort use\n",
-                "#%matplotlib qt\n",
+                "%matplotlib qt\n",
                 "import KiMoPack.plot_func as pf\n",
                 "from importlib import reload\n",
                 "#reload(pf)"
             ]
         },
         {
             "cell_type": "markdown",
@@ -65,15 +63,15 @@
             "source": [
                 "plt.close('all')\n",
                 "ta.mod=func.P12             # if you want to use function P12 from the standard function library\n",
                 "par=lmfit.Parameters()\n",
                 "par.add('k0',value=1/1.6,vary=True)                       # this function has a lot of parameter, they can be named\n",
                 "par.add('k1',value=1/0.4,vary=True)                       # but a rate must be starting with \"k\" (this is how it is regognized)\n",
                 "par.add('k2',value=1/6e11,vary=True)\n",
-                "#pad.add('f0',value=5)\n",
+                "par.add('f0',value=5)\n",
                 "par.add('t0',value=0.025,min=-2,max=2,vary=False)          # if applicable, keep those\n",
                 "par.add('resolution',value=0.25,min=0.04,max=0.5,vary=False)\n",
                 "#par.add('infinite')\n",
                 "ta.par=par\n",
                 "\n",
                 "ta.Fit_Global()                                           # Fitting syntax stays the same"
             ]
@@ -89,23 +87,14 @@
         },
         {
             "cell_type": "code",
             "execution_count": null,
             "metadata": {},
             "outputs": [],
             "source": [
-                "ta.Save_Powerpoint()"
-            ]
-        },
-        {
-            "cell_type": "code",
-            "execution_count": null,
-            "metadata": {},
-            "outputs": [],
-            "source": [
                 "ta.par=ta.fit_par #reuse the fitted parameter\n",
                 "ta.Fit_Global(dump_paras=True)\n",
                 "ta.Fit_Global(dump_shapes=True)"
             ]
         },
         {
             "cell_type": "code",
@@ -181,14 +170,32 @@
                 "ta.Fit_Global(multi_project=other_projects)#fit both projects together,\n",
                 "ta.Fit_Global(multi_project=other_projects,unique_parameter=['f0']) #unique parameter allows to additionally freeze a parameter (that e.g. were optimized b)\n",
                 "ta.Fit_Global(multi_project=other_projects,unique_parameter=['f0'],weights=[1,2])\n",
                 "ta.Fit_Global(multi_project=other_projects,same_DAS = True)"
             ]
         },
         {
+            "cell_type": "code",
+            "execution_count": null,
+            "metadata": {},
+            "outputs": [],
+            "source": [
+                "ta.Fit_Global(multi_project=other_projects,same_DAS = True)"
+            ]
+        },
+        {
+            "cell_type": "code",
+            "execution_count": null,
+            "metadata": {},
+            "outputs": [],
+            "source": [
+                "ta.Fit_Global(multi_project=other_projects,same_DAS = False)"
+            ]
+        },
+        {
             "cell_type": "markdown",
             "metadata": {},
             "source": [
                 "### Using Global minimum search"
             ]
         },
         {
@@ -278,13 +285,13 @@
                 "version": 3
             },
             "file_extension": ".py",
             "mimetype": "text/x-python",
             "name": "python",
             "nbconvert_exporter": "python",
             "pygments_lexer": "ipython3",
-            "version": "3.9.16"
+            "version": "3.9.12"
         }
     },
     "nbformat": 4,
     "nbformat_minor": 2
 }
```

### Comparing `KiMoPack-7.0.0/Workflow_tools/TA_Pump_dump.ipynb` & `KiMoPack-7.0.1/Workflow_tools/TA_Advanced_Fit.ipynb`

 * *Files 3% similar despite different names*

#### Pretty-printed

 * *Similarity: 0.9856797472075249%*

 * *Differences: {"'cells'": "{1: {'source': {insert: [(3, '%matplotlib tk\\n'), (4, '#for more comfort use\\n'), "*

 * *            "(5, '#%matplotlib qt\\n')], delete: [3]}}, 6: {'source': {insert: [(6, "*

 * *            '"#pad.add(\'f0\',value=5)\\n")], delete: [6]}}, 19: {\'source\': {insert: [(11, '*

 * *            "'ta.Fit_Global(use_ampgo=True)                                           # Fitting "*

 * *            'syntax stays the same\\n\'), (12, "\'\'\'Sometimes this optimization runs into '*

 * *            'extremely small value that  […]*

```diff
@@ -12,15 +12,17 @@
             "execution_count": null,
             "metadata": {},
             "outputs": [],
             "source": [
                 "import matplotlib,lmfit,os,sys\n",
                 "import matplotlib.pyplot as plt\n",
                 "import numpy as np\n",
-                "%matplotlib qt\n",
+                "%matplotlib tk\n",
+                "#for more comfort use\n",
+                "#%matplotlib qt\n",
                 "import KiMoPack.plot_func as pf\n",
                 "from importlib import reload\n",
                 "#reload(pf)"
             ]
         },
         {
             "cell_type": "markdown",
@@ -63,15 +65,15 @@
             "source": [
                 "plt.close('all')\n",
                 "ta.mod=func.P12             # if you want to use function P12 from the standard function library\n",
                 "par=lmfit.Parameters()\n",
                 "par.add('k0',value=1/1.6,vary=True)                       # this function has a lot of parameter, they can be named\n",
                 "par.add('k1',value=1/0.4,vary=True)                       # but a rate must be starting with \"k\" (this is how it is regognized)\n",
                 "par.add('k2',value=1/6e11,vary=True)\n",
-                "par.add('f0',value=5)\n",
+                "#pad.add('f0',value=5)\n",
                 "par.add('t0',value=0.025,min=-2,max=2,vary=False)          # if applicable, keep those\n",
                 "par.add('resolution',value=0.25,min=0.04,max=0.5,vary=False)\n",
                 "#par.add('infinite')\n",
                 "ta.par=par\n",
                 "\n",
                 "ta.Fit_Global()                                           # Fitting syntax stays the same"
             ]
@@ -87,14 +89,23 @@
         },
         {
             "cell_type": "code",
             "execution_count": null,
             "metadata": {},
             "outputs": [],
             "source": [
+                "ta.Save_Powerpoint()"
+            ]
+        },
+        {
+            "cell_type": "code",
+            "execution_count": null,
+            "metadata": {},
+            "outputs": [],
+            "source": [
                 "ta.par=ta.fit_par #reuse the fitted parameter\n",
                 "ta.Fit_Global(dump_paras=True)\n",
                 "ta.Fit_Global(dump_shapes=True)"
             ]
         },
         {
             "cell_type": "code",
@@ -170,32 +181,14 @@
                 "ta.Fit_Global(multi_project=other_projects)#fit both projects together,\n",
                 "ta.Fit_Global(multi_project=other_projects,unique_parameter=['f0']) #unique parameter allows to additionally freeze a parameter (that e.g. were optimized b)\n",
                 "ta.Fit_Global(multi_project=other_projects,unique_parameter=['f0'],weights=[1,2])\n",
                 "ta.Fit_Global(multi_project=other_projects,same_DAS = True)"
             ]
         },
         {
-            "cell_type": "code",
-            "execution_count": null,
-            "metadata": {},
-            "outputs": [],
-            "source": [
-                "ta.Fit_Global(multi_project=other_projects,same_DAS = True)"
-            ]
-        },
-        {
-            "cell_type": "code",
-            "execution_count": null,
-            "metadata": {},
-            "outputs": [],
-            "source": [
-                "ta.Fit_Global(multi_project=other_projects,same_DAS = False)"
-            ]
-        },
-        {
             "cell_type": "markdown",
             "metadata": {},
             "source": [
                 "### Using Global minimum search"
             ]
         },
         {
@@ -211,15 +204,20 @@
                 "par.add('k1',value=1/0.4,vary=True,min=1/4,max=1)          \n",
                 "par.add('k2',value=1/6e11,vary=True,min=1/1e13,max=1)\n",
                 "par.add('t0',value=0.025,min=-2,max=2,vary=False)\n",
                 "par.add('resolution',value=0.25,min=0.04,max=0.5,vary=False)\n",
                 "#par.add('background')\n",
                 "#par.add('infinite')\n",
                 "ta.par=par\n",
-                "ta.Fit_Global(use_ampgo=True)                                           # Fitting syntax stays the same"
+                "ta.Fit_Global(use_ampgo=True)                                           # Fitting syntax stays the same\n",
+                "'''Sometimes this optimization runs into extremely small value that overflow the double precission \n",
+                "(making a lot of warnings). As a temporary fix enable the following line that will turn of all warnings.\n",
+                "as most likely these solutions will be rejected anyhow, this should not be a big problem. Alternative is to \n",
+                "give more restrictive limits.'''\n",
+                "#np.seterr(all=\"ignore\")"
             ]
         },
         {
             "cell_type": "markdown",
             "metadata": {},
             "source": [
                 "### export the results as images and save the project"
```

### Comparing `KiMoPack-7.0.0/Workflow_tools/TA_Raw_plotting.ipynb` & `KiMoPack-7.0.1/Workflow_tools/TA_Raw_plotting.ipynb`

 * *Files identical despite different names*

### Comparing `KiMoPack-7.0.0/Workflow_tools/TA_Raw_plotting_and_Simple_Fit.ipynb` & `KiMoPack-7.0.1/Workflow_tools/TA_Raw_plotting_and_Simple_Fit.ipynb`

 * *Files 2% similar despite different names*

#### Pretty-printed

 * *Similarity: 0.9982433862433863%*

 * *Differences: {"'cells'": '{5: {\'source\': {insert: [(2, "ta.Cor_Chirp() #correct for arrival time difference '*

 * *            'ta.Cor_Chirp(\'gui\') allows to choose file ")], delete: [2]}}, 9: {\'source\': '*

 * *            '{insert: [(2, "ta.mod=\'exponential\'                                        # Choose '*

 * *            "the model 'exponential', 'consecutive' and 'fast_consecutive'are build "*

 * *            'in\\n")], delete: [2]}}}',*

 * * "'metadata'": "{'language_info': {'version': '3.9.12'}}"}*

```diff
@@ -53,15 +53,15 @@
             "cell_type": "code",
             "execution_count": null,
             "metadata": {},
             "outputs": [],
             "source": [
                 "ta.Filter_data(value=21)               #remove bad data here everything above abs=21 is considered bad\n",
                 "ta.intensity_range=ta.ds.describe().median(axis=1)['75%']*2\n",
-                "ta.Man_Chirp() #correct for arrival time difference ta.Cor_Chirp('gui') allows to choose file "
+                "ta.Cor_Chirp() #correct for arrival time difference ta.Cor_Chirp('gui') allows to choose file "
             ]
         },
         {
             "cell_type": "markdown",
             "metadata": {},
             "source": [
                 "### Shape data and plot Raw images"
@@ -99,15 +99,15 @@
             "cell_type": "code",
             "execution_count": null,
             "metadata": {},
             "outputs": [],
             "source": [
                 "ta.wave_nm_bin=2; \n",
                 "plt.close('all')                                             # Close old spectra\n",
-                "ta.mod=mod.p12                                         # Choose the model 'exponential', 'consecutive' and 'fast_consecutive'are build in\n",
+                "ta.mod='exponential'                                        # Choose the model 'exponential', 'consecutive' and 'fast_consecutive'are build in\n",
                 "par=lmfit.Parameters()                                       # create empty parameter object\n",
                 "\n",
                 "par.add('k0',value=1/0.1,vary=True)                                # Add second rate component\n",
                 "par.add('k1',value=1/2.5,vary=True)                                # Add one rate component\n",
                 "par.add('k2',value=1/40,vary=True)                                 # Add second rate component\n",
                 "par.add('t0',value=0,min=-2,max=2,vary=False)                       # Allow the arrival time to adjust (for all)\n",
                 "par.add('resolution',value=0.086,min=0.04,max=0.5,vary=False)       # Allow the instrument response to adjust (for all)\n",
@@ -320,13 +320,13 @@
                 "version": 3
             },
             "file_extension": ".py",
             "mimetype": "text/x-python",
             "name": "python",
             "nbconvert_exporter": "python",
             "pygments_lexer": "ipython3",
-            "version": "3.9.16"
+            "version": "3.9.12"
         }
     },
     "nbformat": 4,
     "nbformat_minor": 2
 }
```

### Comparing `KiMoPack-7.0.0/Workflow_tools/TA_comparative_plotting_and_data_extraction.ipynb` & `KiMoPack-7.0.1/Workflow_tools/TA_comparative_plotting_and_data_extraction.ipynb`

 * *Files identical despite different names*

### Comparing `KiMoPack-7.0.0/Workflow_tools/TA_single_scan_handling.ipynb` & `KiMoPack-7.0.1/Workflow_tools/TA_single_scan_handling.ipynb`

 * *Files identical despite different names*

### Comparing `KiMoPack-7.0.0/Workflow_tools/TA_testing.ipynb` & `KiMoPack-7.0.1/Workflow_tools/TA_testing.ipynb`

 * *Files identical despite different names*

### Comparing `KiMoPack-7.0.0/Workflow_tools/Workflow_tools/.ipynb_checkpoints/TA_Raw_plotting_and_Simple_Fit-checkpoint.ipynb` & `KiMoPack-7.0.1/Workflow_tools/additional_formats/streak_camera/.ipynb_checkpoints/Importing and analysis of emission data-checkpoint.ipynb`

 * *Files 25% similar despite different names*

#### Pretty-printed

 * *Similarity: 0.9660624098124098%*

 * *Differences: {"'cells'": '{2: {\'source\': [\'def streak_Lund(filename):\\n\', "    '*

 * *            'code=filename.split(\'-\')\\n", "    '*

 * *            'ds=pd.read_csv(filename,sep=\'\\\\t\',header=None)\\n", \'    '*

 * *            'n_waves=len(ds.index.values)\\n\', \'    n_times=len(ds.columns)\\n\', "    '*

 * *            'times={\'t6\':np.linspace(0,2000,n_times),\\n", "           '*

 * *            '\'t5\':np.linspace(0,1000,n_times),\\n", "           '*

 * *            '\'t4\':np.linspace(0,500,n_times),\\n", "           '*

 * *          […]*

```diff
@@ -5,126 +5,337 @@
             "metadata": {},
             "source": [
                 "### Set standard imports"
             ]
         },
         {
             "cell_type": "code",
-            "execution_count": null,
+            "execution_count": 5,
             "metadata": {},
-            "outputs": [],
+            "outputs": [
+                {
+                    "name": "stdout",
+                    "output_type": "stream",
+                    "text": [
+                        "Plot_func version 6.8.0\n",
+                        "was imported from path:\n",
+                        " C:\\Users\\Jens\\anaconda3\\Lib\\site-packages\\KiMoPack\n",
+                        "The current working folder is:\n",
+                        " D:\\Dropbox\\coding\\github\\KiMoPack\\Workflow_tools\\additional_formats\\streak_camera\n"
+                    ]
+                },
+                {
+                    "data": {
+                        "text/plain": [
+                            "<module 'KiMoPack.plot_func' from 'C:\\\\Users\\\\Jens\\\\anaconda3\\\\lib\\\\site-packages\\\\KiMoPack\\\\plot_func.py'>"
+                        ]
+                    },
+                    "execution_count": 5,
+                    "metadata": {},
+                    "output_type": "execute_result"
+                }
+            ],
             "source": [
                 "import matplotlib,lmfit\n",
                 "import matplotlib.pyplot as plt\n",
                 "import numpy as np\n",
                 "import pandas as pd\n",
                 "%matplotlib qt\n",
                 "import KiMoPack.plot_func as pf\n",
+                "from importlib import reload\n",
+                "reload(pf)\n",
                 "#from KiMoPack.plotfunc import pf"
             ]
         },
         {
+            "cell_type": "code",
+            "execution_count": null,
+            "metadata": {},
+            "outputs": [],
+            "source": [
+                "def streak_Lund(filename):\n",
+                "    code=filename.split('-')\n",
+                "    ds=pd.read_csv(filename,sep='\\t',header=None)\n",
+                "    n_waves=len(ds.index.values)\n",
+                "    n_times=len(ds.columns)\n",
+                "    times={'t6':np.linspace(0,2000,n_times),\n",
+                "           't5':np.linspace(0,1000,n_times),\n",
+                "           't4':np.linspace(0,500,n_times),\n",
+                "           't3':np.linspace(0,200,n_times),\n",
+                "           't2':np.linspace(0,100,n_times),\n",
+                "           't1':np.linspace(0,50,n_times)}\n",
+                "    for i in [4,3,2,5]:\n",
+                "        try:\n",
+                "            times=times[code[i]]\n",
+                "            break\n",
+                "        except:\n",
+                "            pass\n",
+                "    for i in [6,5,7,8]:\n",
+                "        if code[i][0]==w:\n",
+                "            center=code[i][1:]\n",
+                "            waves=np.linspace(float(center)-60,float(center)+75,n_waves)\n",
+                "            break\n",
+                "        else:\n",
+                "            continue\n",
+                "    ds.index=times\n",
+                "    ds.index=ds.index.astype(float)\n",
+                "    ds.columns=waves\n",
+                "    ds.columns=ds.columns.astype(float)\n",
+                "    ds.index.name='Time in ps'\n",
+                "    ds.columns.name='Wavelength in nm'\n",
+                "    return ds,'emission intensity'"
+            ]
+        },
+        {
             "cell_type": "markdown",
             "metadata": {},
             "source": [
-                "### Load and inspect Data "
+                "## Import the data and two slices that define the axis"
             ]
         },
         {
             "cell_type": "code",
-            "execution_count": null,
+            "execution_count": 6,
             "metadata": {},
             "outputs": [],
             "source": [
-                "%matplotlib qt\n",
-                "ta=pf.TA('sample_1.SIA',path='Data')   #type filename and path (leave path empty if in the same folder)\n",
-                "#ta=pf.TA(\"sample_1.hdf5\",path=\"Data\")  #reload saved projects using the same syntax\n",
-                "#ta=pf.TA('gui')                       #use a GUI to select data"
+                "ds=pd.read_csv('FeCM02-266nm-4mw-QB390-t6-G63-w450-s150-556ms-E100.dat',sep='\\t',header=None)\n",
+                "time=pd.read_csv('FeCM02-266nm-4mw-QB390-t6-G63-w450-s150-556ms-E100 vt.prf',sep=',',skiprows=5,index_col=0,header=None)\n",
+                "wave=pd.read_csv('FeCM02-266nm-4mw-QB390-t6-G63-w450-s150-556ms-E100 hw.prf',sep=',',skiprows=5,index_col=0,header=None)\n",
+                "ds.index=time.index\n",
+                "ds.columns=wave.index\n",
+                "ds.columns=ds.columns.astype(float)\n",
+                "ta=pf.TA('external',ds=ds)\n",
+                "ta.intensity_range=[0,20000]"
+            ]
+        },
+        {
+            "cell_type": "code",
+            "execution_count": 7,
+            "metadata": {},
+            "outputs": [
+                {
+                    "data": {
+                        "text/html": [
+                            "<div>\n",
+                            "<style scoped>\n",
+                            "    .dataframe tbody tr th:only-of-type {\n",
+                            "        vertical-align: middle;\n",
+                            "    }\n",
+                            "\n",
+                            "    .dataframe tbody tr th {\n",
+                            "        vertical-align: top;\n",
+                            "    }\n",
+                            "\n",
+                            "    .dataframe thead th {\n",
+                            "        text-align: right;\n",
+                            "    }\n",
+                            "</style>\n",
+                            "<table border=\"1\" class=\"dataframe\">\n",
+                            "  <thead>\n",
+                            "    <tr style=\"text-align: right;\">\n",
+                            "      <th></th>\n",
+                            "      <th>1</th>\n",
+                            "    </tr>\n",
+                            "    <tr>\n",
+                            "      <th>0</th>\n",
+                            "      <th></th>\n",
+                            "    </tr>\n",
+                            "  </thead>\n",
+                            "  <tbody>\n",
+                            "    <tr>\n",
+                            "      <th>390.8657</th>\n",
+                            "      <td>4116.824</td>\n",
+                            "    </tr>\n",
+                            "    <tr>\n",
+                            "      <th>391.0746</th>\n",
+                            "      <td>13565.440</td>\n",
+                            "    </tr>\n",
+                            "    <tr>\n",
+                            "      <th>391.2836</th>\n",
+                            "      <td>31525.010</td>\n",
+                            "    </tr>\n",
+                            "    <tr>\n",
+                            "      <th>391.4926</th>\n",
+                            "      <td>7284.055</td>\n",
+                            "    </tr>\n",
+                            "    <tr>\n",
+                            "      <th>391.7015</th>\n",
+                            "      <td>69088.490</td>\n",
+                            "    </tr>\n",
+                            "    <tr>\n",
+                            "      <th>...</th>\n",
+                            "      <td>...</td>\n",
+                            "    </tr>\n",
+                            "    <tr>\n",
+                            "      <th>523.5522</th>\n",
+                            "      <td>8867.901</td>\n",
+                            "    </tr>\n",
+                            "    <tr>\n",
+                            "      <th>523.7612</th>\n",
+                            "      <td>9204.638</td>\n",
+                            "    </tr>\n",
+                            "    <tr>\n",
+                            "      <th>523.9702</th>\n",
+                            "      <td>9038.945</td>\n",
+                            "    </tr>\n",
+                            "    <tr>\n",
+                            "      <th>524.1791</th>\n",
+                            "      <td>8895.330</td>\n",
+                            "    </tr>\n",
+                            "    <tr>\n",
+                            "      <th>524.3881</th>\n",
+                            "      <td>9082.066</td>\n",
+                            "    </tr>\n",
+                            "  </tbody>\n",
+                            "</table>\n",
+                            "<p>640 rows \u00d7 1 columns</p>\n",
+                            "</div>"
+                        ],
+                        "text/plain": [
+                            "                  1\n",
+                            "0                  \n",
+                            "390.8657   4116.824\n",
+                            "391.0746  13565.440\n",
+                            "391.2836  31525.010\n",
+                            "391.4926   7284.055\n",
+                            "391.7015  69088.490\n",
+                            "...             ...\n",
+                            "523.5522   8867.901\n",
+                            "523.7612   9204.638\n",
+                            "523.9702   9038.945\n",
+                            "524.1791   8895.330\n",
+                            "524.3881   9082.066\n",
+                            "\n",
+                            "[640 rows x 1 columns]"
+                        ]
+                    },
+                    "execution_count": 7,
+                    "metadata": {},
+                    "output_type": "execute_result"
+                }
+            ],
+            "source": [
+                "wave"
             ]
         },
         {
             "cell_type": "markdown",
             "metadata": {},
             "source": [
-                "### perform standard corrections"
+                "### Shape data and plot Raw images"
             ]
         },
         {
             "cell_type": "code",
-            "execution_count": null,
+            "execution_count": 70,
             "metadata": {},
             "outputs": [],
             "source": [
-                "ta.Filter_data(value=21)               #remove bad data here everything above abs=21 is considered bad\n",
-                "ta.intensity_range=ta.ds.describe().median(axis=1)['75%']*2\n",
-                "ta.Cor_Chirp() #correct for arrival time difference ta.Cor_Chirp('gui') allows to choose file \n",
-                "ta.Plot_RAW(0)"
+                "plt.close('all')\n",
+                "ta.intensity_range=[0,20000]\n",
+                "ta.rel_wave=[400,410,420,460,480,500]\n",
+                "ta.rel_time=np.array([250,600,750,1000,1750])\n",
+                "ta.bordercut=[390,514]\n",
+                "ta.wave_nm_bin=None\n",
+                "ta.wavelength_bin=50  \n",
+                "ta.Plot_RAW(range(3),scale_type='linear')   "
             ]
         },
         {
             "cell_type": "markdown",
             "metadata": {},
             "source": [
-                "### Shape data and plot Raw images"
+                "### shift t0 run only once!!!"
             ]
         },
         {
             "cell_type": "code",
-            "execution_count": null,
+            "execution_count": 71,
             "metadata": {},
             "outputs": [],
             "source": [
-                "plt.close('all')\n",
-                "ta.Background(uplimit=-0.5)                                  #substract Background before time_zero\n",
-                "#ta.rel_wave=[390,420,440,530,580,700,800,950,930,1050]      # use to manually select interesting wavelength for the kinetics\n",
-                "ta.wavelength_bin=20                                         # width of wavelength bin in kinetics\n",
-                "ta.wave_nm_bin=5;                                            # rebinning wavelength\n",
-                "ta.rel_time=[0.3,0.4,1,3,5,10,20,30,100,300,2000,3000]          # use to manually set interesting times for the spectra\n",
-                "ta.time_width_percent=0                                      # rebinning of time_points in percent\n",
-                "ta.timelimits=[-1,5000]                                      # use to manually limit the range to plot (and fit)     \n",
-                "ta.log_scale=False                                           # use to plot the 2d plots with logarithmic intensity scale\n",
-                "ta.bordercut=[400,1100]                                      # use to set the outer wavelength limits\n",
-                "ta.scattercut=[522,605]                                      # this region is blanked out to block scatter, this can be a list of regions\n",
-                "ta.intensity_range=None#[0,3e-3]                                  # set a value 5e-3 or a range [-1e-3,5e-3] for 2d plotting\n",
-                "ta.Plot_RAW(title=None)                                      # Plot Raw Spectra"
+                "t0=586.\n",
+                "ta.ds.index=ta.ds.index.values-t0\n",
+                "ta.rel_time=ta.rel_time-t0\n",
+                "ta.timelimits=[1,1500]"
             ]
         },
         {
             "cell_type": "markdown",
             "metadata": {},
             "source": [
-                "### Perform fast fitting using independent exponential decay (first order)"
+                "### plot_cleaned"
             ]
         },
         {
             "cell_type": "code",
-            "execution_count": null,
+            "execution_count": 72,
+            "metadata": {},
+            "outputs": [],
+            "source": [
+                "plt.close('all')                                           # use to plot the 2d plots with logarithmic intensity scale\n",
+                "ta.rel_wave=np.arange(400,480,10)\n",
+                "ta.bordercut=[390,480]                                    # use to set the outer wavelength limits\n",
+                "ta.intensity_range=[0,30000]                                  # set a value 5e-3 or a range [-1e-3,5e-3] for 2d plotting\n",
+                "ta.Plot_RAW(range(3),scale_type='log')                                      # Plot Raw Spectra"
+            ]
+        },
+        {
+            "cell_type": "markdown",
+            "metadata": {},
+            "source": [
+                "### with background substraction"
+            ]
+        },
+        {
+            "cell_type": "code",
+            "execution_count": 73,
             "metadata": {},
             "outputs": [],
             "source": [
+                "ta.Background(uplimit=-20)\n",
+                "plt.close('all')                                           # use to plot the 2d plots with logarithmic intensity scale\n",
+                "ta.rel_wave=np.arange(400,480,10)\n",
+                "ta.bordercut=[390,510]                                    # use to set the outer wavelength limits\n",
+                "ta.intensity_range=[0,30000]                                  # set a value 5e-3 or a range [-1e-3,5e-3] for 2d plotting\n",
+                "ta.Plot_RAW(range(3),scale_type='log')                                      # Plot Raw Spectra"
+            ]
+        },
+        {
+            "cell_type": "markdown",
+            "metadata": {},
+            "source": [
+                "### Perform fast fitting using independent exponential decay (first order)"
+            ]
+        },
+        {
+            "cell_type": "raw",
+            "metadata": {},
+            "source": [
                 "ta.wave_nm_bin=2; \n",
                 "plt.close('all')                                             # Close old spectra\n",
                 "ta.mod='exponential'                                         # Choose the model 'exponential', 'consecutive' and 'fast_consecutive'are build in\n",
                 "par=lmfit.Parameters()                                       # create empty parameter object\n",
                 "\n",
                 "par.add('k0',value=1/0.1,vary=True)                                # Add second rate component\n",
                 "par.add('k1',value=1/2.5,vary=True)                                # Add one rate component\n",
                 "par.add('k2',value=1/40,vary=True)                                 # Add second rate component\n",
-                "par.add('t0',value=0,min=-2,max=2,vary=False)                       # Allow the arrival time to adjust (for all)\n",
+                "par.add('t0',value=0,vary=False)                       # Allow the arrival time to adjust (for all)\n",
                 "par.add('resolution',value=0.086,min=0.04,max=0.5,vary=False)       # Allow the instrument response to adjust (for all)\n",
                 "#par.add('infinite')                                                # Keyword for an non decaying component\n",
                 "#par.add('background')                                             # Keyword to fit the Background Disable the background substraction in the loading cell for best effect\n",
                 "#ta.timelimits=[0.2,5000]                                      # select time window in which to fit\n",
                 "ta.ignore_time_region=[-0.1,0.5]                              # ignore the region over t0 for the fit\n",
                 "ta.log_fit=False                                               # fit in linear or log scale\n",
                 "if 0:\n",
                 "    for key in par.keys():\n",
                 "        par[key].vary=False\n",
                 "ta.par=par                                                     # write parameter object into file for fitting\n",
-                "ta.Fit_Global(fit_chirp=False,dump_shapes=True)                                 # trigger fitting\n",
+                "ta.Fit_Global(fit_chirp=False)                                 # trigger fitting\n",
                 "\n",
                 "ta.error_matrix_amplification=10;                              # Choose how much stronger should error be plotted       \n",
                 "ta.log_scale=False                                             # 2D plots in linear or log scale\n",
                 "ta.Plot_fit_output()                                 # plot the fit output"
             ]
         },
         {
@@ -164,14 +375,21 @@
             ]
         },
         {
             "cell_type": "code",
             "execution_count": null,
             "metadata": {},
             "outputs": [],
+            "source": []
+        },
+        {
+            "cell_type": "code",
+            "execution_count": null,
+            "metadata": {},
+            "outputs": [],
             "source": [
                 "#ta.filename='new'+ta.filename\n",
                 "ta.Save_project()                     # This saves the whole project including raw data, fits and chirp correction into a single file"
             ]
         },
         {
             "cell_type": "code",
@@ -311,13 +529,13 @@
                 "version": 3
             },
             "file_extension": ".py",
             "mimetype": "text/x-python",
             "name": "python",
             "nbconvert_exporter": "python",
             "pygments_lexer": "ipython3",
-            "version": "3.9.16"
+            "version": "3.9.12"
         }
     },
     "nbformat": 4,
     "nbformat_minor": 2
 }
```

### Comparing `KiMoPack-7.0.0/Workflow_tools/Workflow_tools/function_library.py` & `KiMoPack-7.0.1/Workflow_tools/function_library.py`

 * *Ordering differences only*

 * *Files 6% similar despite different names*

```diff
@@ -1,580 +1,580 @@
-import pandas
-import scipy
-import numpy as np
-from numpy import power,log10,shape
-FWHM=2.35482
-
-def gauss(t,sigma=0.1,mu=0):
-	y=np.exp(-0.5*((t-mu)**2)/sigma**2)
-	y/=sigma*np.sqrt(2*np.pi)
-	return y
-
-def manual_consecutive(times,pardf):								
-	'''we have 1MLCT,3MLCT,3MC state with 
-	consecutive decays, hint this function could have been created with the linear exp model
-	'''
-	c=np.zeros((len(times),3),dtype='float') 						#creation of matrix that will hold the concentrations
-	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
-	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
-	for i in range(1,len(times)):									#iterate over all timepoints
-		dc=np.zeros((3,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
-		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
-		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
-		for j in range(int(sub_steps)):
-			dc[0]=-pardf['k0']*dt*c_temp[0]+g[i]*dt					#excite a small fraction with g[i] and decay with 'k0'
-			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]	#form with "k0" and decay with "k1"
-			dc[2]=pardf['k1']*dt*c_temp[1]-pardf['k2']*dt*c_temp[2]	#form with "k1" and decay with "k2"
-			for b in range(c.shape[1]):
-				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
-		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
-	c=pandas.DataFrame(c,index=times)								#write back the right indexes
-	c.index.name='time'												#and give it a name
-	c.columns=['1MLCT','3MLCT','3MC']								#this is optional but very useful. The species get names that represent some particular states
-	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
-		c['background']=1											#background always there (flat)
-	return c														#return the concentrations to the global fitting
-	
-def Square_dependence(times,pardf):
-	'''initial A then two paths to C one over B and one direct, last paramter is the ratio'''
-	c=np.zeros((len(times),3),dtype='float')						#creation of matrix that will hold the concentrations
-	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0'])*pardf['f0']	#creating the gaussian pulse that will "excite" our sample. Note the additional fraction with "f0". This fraction is breaking the normalization but allows the pump fluence to be added
-	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
-	for i in range(1,len(times)):									#iterate over all timepoints
-		dc=np.zeros((3,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
-		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
-		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
-		for j in range(int(sub_steps)):
-			dc[0]=-pardf['k0']*dt*c_temp[0]-2*pardf['k2']*dt*c_temp[0]**2+g[i]*dt #excite a small fraction with g[i] and decay with 'k0' linear, two state decay with the square dependence and "k2"
-			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]	#form with "k0" and decay with "k1"
-			dc[2]=pardf['k2']*dt*c_temp[0]**2						#one single part of c[2] is formed from the non linear combination of two c[0]
-			for b in range(c.shape[1]):
-				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
-		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
-	c=pandas.DataFrame(c,index=times)								#write back the right indexes
-	c.index.name='time'												#and give it a name
-	c.columns=['A*','B*','C']										#this is optional but very useful. The species get names that represent some particular states
-	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
-		c['background']=1											#background always there (flat)
-	return c														#return the concentrations to the global fitting
-	
-def gaussian_distribution(times,pardf):
-		#first attempt, we have one decay, then the gauss, then f0 is the spread of the gauss in rate
-		#so G - with pulse to A to gauss B to intermediate C and back to G
-		decays=3
-		spread_shape=gauss(np.linspace(-1,1,91),sigma=1/3.,mu=0)					#this vector holds the fresh distribution
-		rate_spread=pardf['k1']+np.linspace(-3*pardf['rate_spread']/FWHM,3*pardf['rate_spread']/FWHM,91) #this vector has the same shape as the distribution and 
-																										#holds one rate entry in the spread_shape
-		spread=np.zeros(spread_shape.shape) 															#initially there is nothing in the spread matrix
-		c=np.zeros((len(times),decays),dtype='float') 													#here I define number of concentrations
-		g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0'])									#this is my pump
-		sub_steps=10																					#We sample with 10 steps per measured timestep
-		for i in range(1,len(times)):
-			dc=np.zeros((c.shape[1],1),dtype='float')													# this contains the usual concentration differences
-			c_temp=c[i-1,:]																				#load the previous concentrations (absolute)
-			dt=(times[i]-times[i-1])/(sub_steps)														#create the momentary timestep	
-			for j in range(int(sub_steps)):
-				dc[0]=-pardf['k0']*dt*c_temp[0]+g[i]*dt 												#C0 is filled by the pump and decays with k0				
-				spread+=spread_shape*pardf['k0']*dt*c_temp[0]-spread_shape*rate_spread*dt				#whatever decays from C0 flows into the distribution, 
-																										#important on the new stuff is distributed with the gaussian, 
-																										#each unit has its own flowing out rate
-				dc[1]=0																					#set to 0 because we do use the matrix later to record the change
-				dc[2]=(spread_shape*rate_spread*dt).sum()												#whatever flows out of the C1 (the distrubution) is collected into 
-				for b in range(c.shape[1]):
-					c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])										#check that nothing will be below 0 (concentrations)
-			c[i,:] =c_temp
-			c[i,1] =spread.sum()																		#here we fill the record matrix with the sum of the units
-		c=pandas.DataFrame(c,index=times)
-		c.index.name='time'
-		if 'background' in list(pardf.index.values):													#we still might want to have a backgraound
-			c['background']=1
-		c.columns=['initial','gauss_populated','final']													#this is optional but very useful. The species get names that represent 
-																										#some particular states
-		return c
-
-def P12(times,pardf):								
-	'''P12'''
-	c=np.zeros((len(times),3),dtype='float') 						#creation of matrix that will hold the concentrations
-	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
-	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
-	for i in range(1,len(times)):									#iterate over all timepoints
-		dc=np.zeros((3,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
-		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
-		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
-		for j in range(int(sub_steps)):
-			dc[0]=-pardf['k0']*dt*c_temp[0]-pardf['k2']*dt*c_temp[0]+g[i]*dt					
-			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]
-			dc[2]=pardf['k1']*dt*c_temp[1]+pardf['k2']*dt*c_temp[0]
-			for b in range(c.shape[1]):
-				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
-		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
-	c=pandas.DataFrame(c,index=times)								#write back the right indexes
-	c.index.name='time'												#and give it a name
-	c.columns=['A','B','Inf']									    #this is optional but very useful. The species get names that represent some particular states
-	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
-		c['background']=1											#background always there (flat)
-	if 'infinite' in list(pardf.index.values):
-		return c													
-	else:
-		c.drop('Inf',axis=1,inplace=True)
-		return c
-
-def P13(times,pardf):								
-	'''P13'''
-	c=np.zeros((len(times),4),dtype='float') 						#creation of matrix that will hold the concentrations
-	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
-	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
-	for i in range(1,len(times)):									#iterate over all timepoints
-		dc=np.zeros((4,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
-		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
-		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
-		for j in range(int(sub_steps)):
-			dc[0]=-pardf['k0']*dt*c_temp[0]-pardf['k4']*dt*c_temp[0]-pardf['k2']*dt*c_temp[0]+g[i]*dt					
-			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]
-			dc[2]=pardf['k2']*dt*c_temp[0]-pardf['k3']*dt*c_temp[2]
-			dc[3]=pardf['k1']*dt*c_temp[1]+pardf['k3']*dt*c_temp[2]+pardf['k4']*dt*c_temp[0]
-			for b in range(c.shape[1]):
-				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
-		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
-	c=pandas.DataFrame(c,index=times)								#write back the right indexes
-	c.index.name='time'												#and give it a name
-	c.columns=['A','B','C','Inf']									#this is optional but very useful. The species get names that represent some particular states
-	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
-		c['background']=1											#background always there (flat)
-	if 'infinite' in list(pardf.index.values):
-		return c													
-	else:
-		c.drop('Inf',axis=1,inplace=True)
-		return c
-
-def P14(times,pardf):								
-	'''P14'''
-	c=np.zeros((len(times),5),dtype='float') 						#creation of matrix that will hold the concentrations
-	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
-	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
-	for i in range(1,len(times)):									#iterate over all timepoints
-		dc=np.zeros((5,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
-		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
-		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
-		for j in range(int(sub_steps)):
-			dc[0]=-pardf['k6']*dt*c_temp[0]-pardf['k0']*dt*c_temp[0]-pardf['k2']*dt*c_temp[0]-pardf['k4']*dt*c_temp[0]+g[i]*dt
-			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]
-			dc[2]=pardf['k2']*dt*c_temp[0]-pardf['k3']*dt*c_temp[2]
-			dc[3]=pardf['k4']*dt*c_temp[0]-pardf['k5']*dt*c_temp[3]
-			dc[4]=pardf['k6']*dt*c_temp[0]+pardf['k1']*dt*c_temp[1]+pardf['k3']*dt*c_temp[2]+pardf['k5']*dt*c_temp[3]
-			for b in range(c.shape[1]):
-				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
-		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
-	c=pandas.DataFrame(c,index=times)								#write back the right indexes
-	c.index.name='time'												#and give it a name
-	c.columns=['A','B','C','D','Inf']									#this is optional but very useful. The species get names that represent some particular states
-	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
-		c['background']=1											#background always there (flat)
-	if 'infinite' in list(pardf.index.values):
-		return c													
-	else:
-		c.drop('Inf',axis=1,inplace=True)
-		return c
-
-def P21(times,pardf):								
-	'''P21'''
-	c=np.zeros((len(times),5),dtype='float') 						#creation of matrix that will hold the concentrations
-	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
-	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
-	for i in range(1,len(times)):									#iterate over all timepoints
-		dc=np.zeros((5,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
-		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
-		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
-		for j in range(int(sub_steps)):
-			dc[0]=-pardf['k4']*dt*c_temp[0]-pardf['k0']*dt*c_temp[0]-pardf['k2']*dt*c_temp[0]+g[i]*dt
-			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]
-			dc[2]=pardf['k2']*dt*c_temp[0]-pardf['k3']*dt*c_temp[2]
-			dc[3]=pardf['k4']*dt*c_temp[0]+pardf['k1']*dt*c_temp[1]+pardf['k3']*dt*c_temp[2]-pardf['k5']*dt*c_temp[3]
-			dc[4]=pardf['k5']*dt*c_temp[3]
-			for b in range(c.shape[1]):
-				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
-		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
-	c=pandas.DataFrame(c,index=times)								#write back the right indexes
-	c.index.name='time'												#and give it a name
-	c.columns=['A','B','C','D','Inf']									#this is optional but very useful. The species get names that represent some particular states
-	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
-		c['background']=1											#background always there (flat)
-	if 'infinite' in list(pardf.index.values):
-		return c													
-	else:
-		c.drop('Inf',axis=1,inplace=True)
-		return c
-
-def P22(times,pardf):								
-	'''P22'''
-	c=np.zeros((len(times),5),dtype='float') 						#creation of matrix that will hold the concentrations
-	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
-	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
-	for i in range(1,len(times)):									#iterate over all timepoints
-		dc=np.zeros((5,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
-		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
-		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
-		for j in range(int(sub_steps)):
-			dc[0]=-pardf['k0']*dt*c_temp[0]+g[i]*dt
-			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]-pardf['k2']*dt*c_temp[1]-pardf['k4']*dt*c_temp[1]
-			dc[2]=pardf['k2']*dt*c_temp[1]-pardf['k3']*dt*c_temp[2]
-			dc[3]=pardf['k4']*dt*c_temp[1]-pardf['k5']*dt*c_temp[3]
-			dc[4]=pardf['k1']*dt*c_temp[1]+pardf['k3']*dt*c_temp[2]+pardf['k5']*dt*c_temp[3]
-			for b in range(c.shape[1]):
-				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
-		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
-	c=pandas.DataFrame(c,index=times)								#write back the right indexes
-	c.index.name='time'												#and give it a name
-	c.columns=['A','B','C','D','Inf']									#this is optional but very useful. The species get names that represent some particular states
-	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
-		c['background']=1											#background always there (flat)
-	if 'infinite' in list(pardf.index.values):
-		return c													
-	else:
-		c.drop('Inf',axis=1,inplace=True)
-		return c
-
-def P23(times,pardf):								
-	'''P23'''
-	c=np.zeros((len(times),5),dtype='float') 						#creation of matrix that will hold the concentrations
-	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
-	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
-	for i in range(1,len(times)):									#iterate over all timepoints
-		dc=np.zeros((5,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
-		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
-		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
-		for j in range(int(sub_steps)):
-			dc[0]=-pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[0]+g[i]*dt
-			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k2']*dt*c_temp[1]-pardf['k4']*dt*c_temp[1]
-			dc[2]=pardf['k2']*dt*c_temp[1]-pardf['k3']*dt*c_temp[2]
-			dc[3]=pardf['k4']*dt*c_temp[1]-pardf['k5']*dt*c_temp[3]
-			dc[4]=pardf['k1']*dt*c_temp[0]+pardf['k3']*dt*c_temp[2]+pardf['k5']*dt*c_temp[3]
-			for b in range(c.shape[1]):
-				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
-		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
-	c=pandas.DataFrame(c,index=times)								#write back the right indexes
-	c.index.name='time'												#and give it a name
-	c.columns=['A','B','C','D','Inf']									#this is optional but very useful. The species get names that represent some particular states
-	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
-		c['background']=1											#background always there (flat)
-	if 'infinite' in list(pardf.index.values):
-		return c													
-	else:
-		c.drop('Inf',axis=1,inplace=True)
-		return c
-
-def P24(times,pardf):								
-	'''P24'''
-	c=np.zeros((len(times),5),dtype='float') 						#creation of matrix that will hold the concentrations
-	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
-	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
-	for i in range(1,len(times)):									#iterate over all timepoints
-		dc=np.zeros((5,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
-		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
-		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
-		for j in range(int(sub_steps)):
-			dc[0]=-pardf['k0']*dt*c_temp[0]-pardf['k2']*dt*c_temp[0]-pardf['k4']*dt*c_temp[0]+g[i]*dt
-			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]
-			dc[2]=pardf['k2']*dt*c_temp[0]-pardf['k3']*dt*c_temp[2]
-			dc[3]=pardf['k1']*dt*c_temp[1]+pardf['k3']*dt*c_temp[2]-pardf['k5']*dt*c_temp[3]
-			dc[4]=pardf['k4']*dt*c_temp[0]+pardf['k5']*dt*c_temp[3]
-			for b in range(c.shape[1]):
-				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
-		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
-	c=pandas.DataFrame(c,index=times)								#write back the right indexes
-	c.index.name='time'												#and give it a name
-	c.columns=['A','B','C','D','Inf']									#this is optional but very useful. The species get names that represent some particular states
-	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
-		c['background']=1											#background always there (flat)
-	if 'infinite' in list(pardf.index.values):
-		return c													
-	else:
-		c.drop('Inf',axis=1,inplace=True)
-		return c		
-		
-def P31(times,pardf):								
-	'''P31'''
-	c=np.zeros((len(times),4),dtype='float') 						#creation of matrix that will hold the concentrations
-	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
-	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
-	for i in range(1,len(times)):									#iterate over all timepoints
-		dc=np.zeros((4,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
-		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
-		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
-		for j in range(int(sub_steps)):
-			dc[0]=-pardf['k0']*dt*c_temp[0]-pardf['k3']*dt*c_temp[0]+g[i]*dt					
-			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]
-			dc[2]=pardf['k1']*dt*c_temp[1]-pardf['k2']*dt*c_temp[2]
-			dc[3]=pardf['k2']*dt*c_temp[2]+pardf['k3']*dt*c_temp[0]
-			for b in range(c.shape[1]):
-				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
-		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
-	c=pandas.DataFrame(c,index=times)								#write back the right indexes
-	c.index.name='time'												#and give it a name
-	c.columns=['A','B','C','Inf']									#this is optional but very useful. The species get names that represent some particular states
-	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
-		c['background']=1											#background always there (flat)
-	if 'infinite' in list(pardf.index.values):
-		return c													
-	else:
-		c.drop('Inf',axis=1,inplace=True)
-		return c
-	
-def P32(times,pardf):								
-	'''P32'''
-	c=np.zeros((len(times),4),dtype='float') 						#creation of matrix that will hold the concentrations
-	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
-	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
-	for i in range(1,len(times)):									#iterate over all timepoints
-		dc=np.zeros((4,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
-		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
-		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
-		for j in range(int(sub_steps)):
-			dc[0]=-pardf['k0']*dt*c_temp[0]-pardf['k2']*dt*c_temp[0]+g[i]*dt					
-			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]
-			dc[2]=pardf['k1']*dt*c_temp[1]+pardf['k2']*dt*c_temp[0]-pardf['k3']*dt*c_temp[2]
-			dc[3]=pardf['k3']*dt*c_temp[2]
-			for b in range(c.shape[1]):
-				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
-		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
-	c=pandas.DataFrame(c,index=times)								#write back the right indexes
-	c.index.name='time'												#and give it a name
-	c.columns=['A','B','C','Inf']									#this is optional but very useful. The species get names that represent some particular states
-	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
-		c['background']=1											#background always there (flat)
-	if 'infinite' in list(pardf.index.values):
-		return c													
-	else:
-		c.drop('Inf',axis=1,inplace=True)
-		return c
-		
-def P33(times,pardf):								
-	'''P33'''
-	c=np.zeros((len(times),4),dtype='float') 						#creation of matrix that will hold the concentrations
-	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
-	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
-	for i in range(1,len(times)):									#iterate over all timepoints
-		dc=np.zeros((4,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
-		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
-		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
-		for j in range(int(sub_steps)):
-			dc[0]=-pardf['k0']*dt*c_temp[0]+g[i]*dt					
-			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]-pardf['k3']*dt*c_temp[1]
-			dc[2]=pardf['k1']*dt*c_temp[1]-pardf['k2']*dt*c_temp[2]
-			dc[3]=pardf['k3']*dt*c_temp[1]+pardf['k2']*dt*c_temp[2]
-			for b in range(c.shape[1]):
-				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
-		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
-	c=pandas.DataFrame(c,index=times)								#write back the right indexes
-	c.index.name='time'												#and give it a name
-	c.columns=['A','B','C','Inf']									#this is optional but very useful. The species get names that represent some particular states
-	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
-		c['background']=1											#background always there (flat)
-	if 'infinite' in list(pardf.index.values):
-		return c													
-	else:
-		c.drop('Inf',axis=1,inplace=True)
-		return c
-
-def P34(times,pardf):								
-	'''P33'''
-	c=np.zeros((len(times),3),dtype='float') 						#creation of matrix that will hold the concentrations
-	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
-	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
-	for i in range(1,len(times)):									#iterate over all timepoints
-		dc=np.zeros((3,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
-		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
-		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
-		for j in range(int(sub_steps)):
-			dc[0]=-pardf['k0']*dt*c_temp[0]+g[i]*dt					
-			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]-pardf['k2']*dt*c_temp[1]
-			dc[2]=pardf['k2']*dt*c_temp[1]+pardf['k1']*dt*c_temp[1]
-			for b in range(c.shape[1]):
-				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
-		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
-	c=pandas.DataFrame(c,index=times)								#write back the right indexes
-	c.index.name='time'												#and give it a name
-	c.columns=['A','B','Inf']									#this is optional but very useful. The species get names that represent some particular states
-	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
-		c['background']=1											#background always there (flat)
-	if 'infinite' in list(pardf.index.values):
-		return c													
-	else:
-		c.drop('Inf',axis=1,inplace=True)
-		return c
-		
-def P41(times,pardf):								
-	'''P41'''
-	c=np.zeros((len(times),5),dtype='float') 						#creation of matrix that will hold the concentrations
-	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
-	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
-	for i in range(1,len(times)):									#iterate over all timepoints
-		dc=np.zeros((5,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
-		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
-		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
-		for j in range(int(sub_steps)):
-			dc[0]=-pardf['k0']*dt*c_temp[0]-pardf['k4']*dt*c_temp[0]+g[i]*dt
-			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]
-			dc[2]=pardf['k1']*dt*c_temp[1]+pardf['k4']*dt*c_temp[0]-pardf['k2']*dt*c_temp[2]-pardf['k5']*dt*c_temp[2]
-			dc[3]=pardf['k2']*dt*c_temp[2]-pardf['k3']*dt*c_temp[3]
-			dc[4]=pardf['k5']*dt*c_temp[2]+pardf['k3']*dt*c_temp[3]
-			for b in range(c.shape[1]):
-				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
-		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
-	c=pandas.DataFrame(c,index=times)								#write back the right indexes
-	c.index.name='time'												#and give it a name
-	c.columns=['A','B','C','D','Inf']									#this is optional but very useful. The species get names that represent some particular states
-	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
-		c['background']=1											#background always there (flat)
-	if 'infinite' in list(pardf.index.values):
-		return c													
-	else:
-		c.drop('Inf',axis=1,inplace=True)
-		return c
-
-def P42(times,pardf):								
-	'''P42'''
-	c=np.zeros((len(times),5),dtype='float') 						#creation of matrix that will hold the concentrations
-	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
-	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
-	for i in range(1,len(times)):									#iterate over all timepoints
-		dc=np.zeros((5,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
-		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
-		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
-		for j in range(int(sub_steps)):
-			dc[0]=-pardf['k0']*dt*c_temp[0]+g[i]*dt
-			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]-pardf['k3']*dt*c_temp[1]
-			dc[2]=pardf['k1']*dt*c_temp[1]-pardf['k2']*dt*c_temp[2]
-			dc[3]=pardf['k2']*dt*c_temp[2]+pardf['k3']*dt*c_temp[1]-pardf['k4']*dt*c_temp[3]
-			dc[4]=pardf['k4']*dt*c_temp[3]
-			for b in range(c.shape[1]):
-				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
-		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
-	c=pandas.DataFrame(c,index=times)								#write back the right indexes
-	c.index.name='time'												#and give it a name
-	c.columns=['A','B','C','D','Inf']									#this is optional but very useful. The species get names that represent some particular states
-	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
-		c['background']=1											#background always there (flat)
-	if 'infinite' in list(pardf.index.values):
-		return c													
-	else:
-		c.drop('Inf',axis=1,inplace=True)
-		return c
-		
-def P43(times,pardf):								
-	'''P43'''
-	c=np.zeros((len(times),5),dtype='float') 						#creation of matrix that will hold the concentrations
-	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
-	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
-	for i in range(1,len(times)):									#iterate over all timepoints
-		dc=np.zeros((5,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
-		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
-		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
-		for j in range(int(sub_steps)):
-			dc[0]=-pardf['k0']*dt*c_temp[0]-pardf['k3']*dt*c_temp[0]+g[i]*dt
-			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]
-			dc[2]=pardf['k1']*dt*c_temp[1]-pardf['k2']*dt*c_temp[2]
-			dc[3]=pardf['k2']*dt*c_temp[2]+pardf['k3']*dt*c_temp[0]-pardf['k4']*dt*c_temp[3]
-			dc[4]=pardf['k4']*dt*c_temp[3]
-			for b in range(c.shape[1]):
-				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
-		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
-	c=pandas.DataFrame(c,index=times)								#write back the right indexes
-	c.index.name='time'												#and give it a name
-	c.columns=['A','B','C','D','Inf']									#this is optional but very useful. The species get names that represent some particular states
-	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
-		c['background']=1											#background always there (flat)
-	if 'infinite' in list(pardf.index.values):
-		return c													
-	else:
-		c.drop('Inf',axis=1,inplace=True)
-		return c	
-		
-def P44(times,pardf):								
-	'''P44'''
-	c=np.zeros((len(times),5),dtype='float') 						#creation of matrix that will hold the concentrations
-	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
-	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
-	for i in range(1,len(times)):									#iterate over all timepoints
-		dc=np.zeros((5,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
-		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
-		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
-		for j in range(int(sub_steps)):
-			dc[0]=-pardf['k0']*dt*c_temp[0]+g[i]*dt
-			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]-pardf['k4']*dt*c_temp[1]
-			dc[2]=pardf['k1']*dt*c_temp[1]-pardf['k2']*dt*c_temp[2]
-			dc[3]=pardf['k2']*dt*c_temp[2]-pardf['k3']*dt*c_temp[3]
-			dc[4]=pardf['k4']*dt*c_temp[1]+pardf['k3']*dt*c_temp[3]
-			for b in range(c.shape[1]):
-				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
-		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
-	c=pandas.DataFrame(c,index=times)								#write back the right indexes
-	c.index.name='time'												#and give it a name
-	c.columns=['A','B','C','D','Inf']									#this is optional but very useful. The species get names that represent some particular states
-	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
-		c['background']=1											#background always there (flat)
-	if 'infinite' in list(pardf.index.values):
-		return c													
-	else:
-		c.drop('Inf',axis=1,inplace=True)
-		return c		
-
-def P45(times,pardf):								
-	'''P45'''
-	c=np.zeros((len(times),5),dtype='float') 						#creation of matrix that will hold the concentrations
-	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
-	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
-	for i in range(1,len(times)):									#iterate over all timepoints
-		dc=np.zeros((5,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
-		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
-		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
-		for j in range(int(sub_steps)):
-			dc[0]=-pardf['k0']*dt*c_temp[0]-pardf['k4']*dt*c_temp[0]+g[i]*dt
-			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]
-			dc[2]=pardf['k1']*dt*c_temp[1]-pardf['k2']*dt*c_temp[2]
-			dc[3]=pardf['k2']*dt*c_temp[2]-pardf['k3']*dt*c_temp[3]
-			dc[4]=pardf['k4']*dt*c_temp[0]+pardf['k3']*dt*c_temp[3]
-			for b in range(c.shape[1]):
-				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
-		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
-	c=pandas.DataFrame(c,index=times)								#write back the right indexes
-	c.index.name='time'												#and give it a name
-	c.columns=['A','B','C','D','Inf']									#this is optional but very useful. The species get names that represent some particular states
-	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
-		c['background']=1											#background always there (flat)
-	if 'infinite' in list(pardf.index.values):
-		return c													
-	else:
-		c.drop('Inf',axis=1,inplace=True)
-		return c
-
-def ABC_model(times,pardf):								
-	'''Classical ABC model for solids, -A*n^1-2*B*n^2-3*C*n^3, A=k0, B=k1, C=k2, k3 single charge returns to excited state 
-	note that the recombination looses 2 excitations (so B might be slightly different), C is auger recombination where the single charge has spectrum if a parameter with name [Auger] is present, which is invisible if not. Both Background and an non decaying (damaged) spectrum are implented and triggered by including of 'infinite' and 'background' as parameter '''
-	c=np.zeros((len(times),3),dtype='float') 						#creation of matrix that will hold the concentrations
-	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
-	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
-	for i in range(1,len(times)):									#iterate over all timepoints
-		dc=np.zeros((3,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
-		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
-		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
-		for j in range(int(sub_steps)):
-			dc[0]=-pardf['k0']*dt*c_temp[0]-2*pardf['k1']*dt*c_temp[0]^2-3*pardf['k2']*dt*c_temp[0]^3+pardf['k3']*dt*c_temp[1]+g[i]*dt
-			dc[1]=pardf['k2']*dt*c_temp[0]-pardf['k3']*dt*c_temp[1]
-			dc[2]=pardf['k0']*dt*c_temp[0]+2*pardf['k1']*dt*c_temp[0]^2+2*pardf['k2']*dt*c_temp[0]^3
-			for b in range(c.shape[1]):
-				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
-		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
-	c=pandas.DataFrame(c,index=times)								#write back the right indexes
-	c.index.name='time'												#and give it a name
-	c.columns=['Excited_state','Auger','Inf']									#this is optional but very useful. The species get names that represent some particular states
-	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
-		c['background']=1											#background always there (flat)
-	if 'auger' in list(pardf.index.values):
-		pass													
-	else:
-		c.drop('Auger',axis=1,inplace=True)
-	if 'infinite' in list(pardf.index.values):
-		pass													
-	else:
-		c.drop('Inf',axis=1,inplace=True)
-	return c
+import pandas
+import scipy
+import numpy as np
+from numpy import power,log10,shape
+FWHM=2.35482
+
+def gauss(t,sigma=0.1,mu=0):
+	y=np.exp(-0.5*((t-mu)**2)/sigma**2)
+	y/=sigma*np.sqrt(2*np.pi)
+	return y
+
+def manual_consecutive(times,pardf):								
+	'''we have 1MLCT,3MLCT,3MC state with 
+	consecutive decays, hint this function could have been created with the linear exp model
+	'''
+	c=np.zeros((len(times),3),dtype='float') 						#creation of matrix that will hold the concentrations
+	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
+	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
+	for i in range(1,len(times)):									#iterate over all timepoints
+		dc=np.zeros((3,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
+		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
+		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
+		for j in range(int(sub_steps)):
+			dc[0]=-pardf['k0']*dt*c_temp[0]+g[i]*dt					#excite a small fraction with g[i] and decay with 'k0'
+			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]	#form with "k0" and decay with "k1"
+			dc[2]=pardf['k1']*dt*c_temp[1]-pardf['k2']*dt*c_temp[2]	#form with "k1" and decay with "k2"
+			for b in range(c.shape[1]):
+				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
+		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
+	c=pandas.DataFrame(c,index=times)								#write back the right indexes
+	c.index.name='time'												#and give it a name
+	c.columns=['1MLCT','3MLCT','3MC']								#this is optional but very useful. The species get names that represent some particular states
+	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
+		c['background']=1											#background always there (flat)
+	return c														#return the concentrations to the global fitting
+	
+def Square_dependence(times,pardf):
+	'''initial A then two paths to C one over B and one direct, last paramter is the ratio'''
+	c=np.zeros((len(times),3),dtype='float')						#creation of matrix that will hold the concentrations
+	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0'])*pardf['f0']	#creating the gaussian pulse that will "excite" our sample. Note the additional fraction with "f0". This fraction is breaking the normalization but allows the pump fluence to be added
+	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
+	for i in range(1,len(times)):									#iterate over all timepoints
+		dc=np.zeros((3,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
+		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
+		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
+		for j in range(int(sub_steps)):
+			dc[0]=-pardf['k0']*dt*c_temp[0]-2*pardf['k2']*dt*c_temp[0]**2+g[i]*dt #excite a small fraction with g[i] and decay with 'k0' linear, two state decay with the square dependence and "k2"
+			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]	#form with "k0" and decay with "k1"
+			dc[2]=pardf['k2']*dt*c_temp[0]**2						#one single part of c[2] is formed from the non linear combination of two c[0]
+			for b in range(c.shape[1]):
+				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
+		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
+	c=pandas.DataFrame(c,index=times)								#write back the right indexes
+	c.index.name='time'												#and give it a name
+	c.columns=['A*','B*','C']										#this is optional but very useful. The species get names that represent some particular states
+	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
+		c['background']=1											#background always there (flat)
+	return c														#return the concentrations to the global fitting
+	
+def gaussian_distribution(times,pardf):
+		#first attempt, we have one decay, then the gauss, then f0 is the spread of the gauss in rate
+		#so G - with pulse to A to gauss B to intermediate C and back to G
+		decays=3
+		spread_shape=gauss(np.linspace(-1,1,91),sigma=1/3.,mu=0)					#this vector holds the fresh distribution
+		rate_spread=pardf['k1']+np.linspace(-3*pardf['rate_spread']/FWHM,3*pardf['rate_spread']/FWHM,91) #this vector has the same shape as the distribution and 
+																										#holds one rate entry in the spread_shape
+		spread=np.zeros(spread_shape.shape) 															#initially there is nothing in the spread matrix
+		c=np.zeros((len(times),decays),dtype='float') 													#here I define number of concentrations
+		g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0'])									#this is my pump
+		sub_steps=10																					#We sample with 10 steps per measured timestep
+		for i in range(1,len(times)):
+			dc=np.zeros((c.shape[1],1),dtype='float')													# this contains the usual concentration differences
+			c_temp=c[i-1,:]																				#load the previous concentrations (absolute)
+			dt=(times[i]-times[i-1])/(sub_steps)														#create the momentary timestep	
+			for j in range(int(sub_steps)):
+				dc[0]=-pardf['k0']*dt*c_temp[0]+g[i]*dt 												#C0 is filled by the pump and decays with k0				
+				spread+=spread_shape*pardf['k0']*dt*c_temp[0]-spread_shape*rate_spread*dt				#whatever decays from C0 flows into the distribution, 
+																										#important on the new stuff is distributed with the gaussian, 
+																										#each unit has its own flowing out rate
+				dc[1]=0																					#set to 0 because we do use the matrix later to record the change
+				dc[2]=(spread_shape*rate_spread*dt).sum()												#whatever flows out of the C1 (the distrubution) is collected into 
+				for b in range(c.shape[1]):
+					c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])										#check that nothing will be below 0 (concentrations)
+			c[i,:] =c_temp
+			c[i,1] =spread.sum()																		#here we fill the record matrix with the sum of the units
+		c=pandas.DataFrame(c,index=times)
+		c.index.name='time'
+		if 'background' in list(pardf.index.values):													#we still might want to have a backgraound
+			c['background']=1
+		c.columns=['initial','gauss_populated','final']													#this is optional but very useful. The species get names that represent 
+																										#some particular states
+		return c
+
+def P12(times,pardf):								
+	'''P12'''
+	c=np.zeros((len(times),3),dtype='float') 						#creation of matrix that will hold the concentrations
+	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
+	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
+	for i in range(1,len(times)):									#iterate over all timepoints
+		dc=np.zeros((3,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
+		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
+		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
+		for j in range(int(sub_steps)):
+			dc[0]=-pardf['k0']*dt*c_temp[0]-pardf['k2']*dt*c_temp[0]+g[i]*dt					
+			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]
+			dc[2]=pardf['k1']*dt*c_temp[1]+pardf['k2']*dt*c_temp[0]
+			for b in range(c.shape[1]):
+				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
+		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
+	c=pandas.DataFrame(c,index=times)								#write back the right indexes
+	c.index.name='time'												#and give it a name
+	c.columns=['A','B','Inf']									    #this is optional but very useful. The species get names that represent some particular states
+	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
+		c['background']=1											#background always there (flat)
+	if 'infinite' in list(pardf.index.values):
+		return c													
+	else:
+		c.drop('Inf',axis=1,inplace=True)
+		return c
+
+def P13(times,pardf):								
+	'''P13'''
+	c=np.zeros((len(times),4),dtype='float') 						#creation of matrix that will hold the concentrations
+	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
+	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
+	for i in range(1,len(times)):									#iterate over all timepoints
+		dc=np.zeros((4,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
+		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
+		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
+		for j in range(int(sub_steps)):
+			dc[0]=-pardf['k0']*dt*c_temp[0]-pardf['k4']*dt*c_temp[0]-pardf['k2']*dt*c_temp[0]+g[i]*dt					
+			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]
+			dc[2]=pardf['k2']*dt*c_temp[0]-pardf['k3']*dt*c_temp[2]
+			dc[3]=pardf['k1']*dt*c_temp[1]+pardf['k3']*dt*c_temp[2]+pardf['k4']*dt*c_temp[0]
+			for b in range(c.shape[1]):
+				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
+		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
+	c=pandas.DataFrame(c,index=times)								#write back the right indexes
+	c.index.name='time'												#and give it a name
+	c.columns=['A','B','C','Inf']									#this is optional but very useful. The species get names that represent some particular states
+	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
+		c['background']=1											#background always there (flat)
+	if 'infinite' in list(pardf.index.values):
+		return c													
+	else:
+		c.drop('Inf',axis=1,inplace=True)
+		return c
+
+def P14(times,pardf):								
+	'''P14'''
+	c=np.zeros((len(times),5),dtype='float') 						#creation of matrix that will hold the concentrations
+	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
+	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
+	for i in range(1,len(times)):									#iterate over all timepoints
+		dc=np.zeros((5,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
+		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
+		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
+		for j in range(int(sub_steps)):
+			dc[0]=-pardf['k6']*dt*c_temp[0]-pardf['k0']*dt*c_temp[0]-pardf['k2']*dt*c_temp[0]-pardf['k4']*dt*c_temp[0]+g[i]*dt
+			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]
+			dc[2]=pardf['k2']*dt*c_temp[0]-pardf['k3']*dt*c_temp[2]
+			dc[3]=pardf['k4']*dt*c_temp[0]-pardf['k5']*dt*c_temp[3]
+			dc[4]=pardf['k6']*dt*c_temp[0]+pardf['k1']*dt*c_temp[1]+pardf['k3']*dt*c_temp[2]+pardf['k5']*dt*c_temp[3]
+			for b in range(c.shape[1]):
+				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
+		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
+	c=pandas.DataFrame(c,index=times)								#write back the right indexes
+	c.index.name='time'												#and give it a name
+	c.columns=['A','B','C','D','Inf']									#this is optional but very useful. The species get names that represent some particular states
+	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
+		c['background']=1											#background always there (flat)
+	if 'infinite' in list(pardf.index.values):
+		return c													
+	else:
+		c.drop('Inf',axis=1,inplace=True)
+		return c
+
+def P21(times,pardf):								
+	'''P21'''
+	c=np.zeros((len(times),5),dtype='float') 						#creation of matrix that will hold the concentrations
+	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
+	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
+	for i in range(1,len(times)):									#iterate over all timepoints
+		dc=np.zeros((5,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
+		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
+		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
+		for j in range(int(sub_steps)):
+			dc[0]=-pardf['k4']*dt*c_temp[0]-pardf['k0']*dt*c_temp[0]-pardf['k2']*dt*c_temp[0]+g[i]*dt
+			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]
+			dc[2]=pardf['k2']*dt*c_temp[0]-pardf['k3']*dt*c_temp[2]
+			dc[3]=pardf['k4']*dt*c_temp[0]+pardf['k1']*dt*c_temp[1]+pardf['k3']*dt*c_temp[2]-pardf['k5']*dt*c_temp[3]
+			dc[4]=pardf['k5']*dt*c_temp[3]
+			for b in range(c.shape[1]):
+				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
+		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
+	c=pandas.DataFrame(c,index=times)								#write back the right indexes
+	c.index.name='time'												#and give it a name
+	c.columns=['A','B','C','D','Inf']									#this is optional but very useful. The species get names that represent some particular states
+	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
+		c['background']=1											#background always there (flat)
+	if 'infinite' in list(pardf.index.values):
+		return c													
+	else:
+		c.drop('Inf',axis=1,inplace=True)
+		return c
+
+def P22(times,pardf):								
+	'''P22'''
+	c=np.zeros((len(times),5),dtype='float') 						#creation of matrix that will hold the concentrations
+	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
+	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
+	for i in range(1,len(times)):									#iterate over all timepoints
+		dc=np.zeros((5,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
+		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
+		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
+		for j in range(int(sub_steps)):
+			dc[0]=-pardf['k0']*dt*c_temp[0]+g[i]*dt
+			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]-pardf['k2']*dt*c_temp[1]-pardf['k4']*dt*c_temp[1]
+			dc[2]=pardf['k2']*dt*c_temp[1]-pardf['k3']*dt*c_temp[2]
+			dc[3]=pardf['k4']*dt*c_temp[1]-pardf['k5']*dt*c_temp[3]
+			dc[4]=pardf['k1']*dt*c_temp[1]+pardf['k3']*dt*c_temp[2]+pardf['k5']*dt*c_temp[3]
+			for b in range(c.shape[1]):
+				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
+		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
+	c=pandas.DataFrame(c,index=times)								#write back the right indexes
+	c.index.name='time'												#and give it a name
+	c.columns=['A','B','C','D','Inf']									#this is optional but very useful. The species get names that represent some particular states
+	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
+		c['background']=1											#background always there (flat)
+	if 'infinite' in list(pardf.index.values):
+		return c													
+	else:
+		c.drop('Inf',axis=1,inplace=True)
+		return c
+
+def P23(times,pardf):								
+	'''P23'''
+	c=np.zeros((len(times),5),dtype='float') 						#creation of matrix that will hold the concentrations
+	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
+	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
+	for i in range(1,len(times)):									#iterate over all timepoints
+		dc=np.zeros((5,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
+		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
+		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
+		for j in range(int(sub_steps)):
+			dc[0]=-pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[0]+g[i]*dt
+			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k2']*dt*c_temp[1]-pardf['k4']*dt*c_temp[1]
+			dc[2]=pardf['k2']*dt*c_temp[1]-pardf['k3']*dt*c_temp[2]
+			dc[3]=pardf['k4']*dt*c_temp[1]-pardf['k5']*dt*c_temp[3]
+			dc[4]=pardf['k1']*dt*c_temp[0]+pardf['k3']*dt*c_temp[2]+pardf['k5']*dt*c_temp[3]
+			for b in range(c.shape[1]):
+				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
+		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
+	c=pandas.DataFrame(c,index=times)								#write back the right indexes
+	c.index.name='time'												#and give it a name
+	c.columns=['A','B','C','D','Inf']									#this is optional but very useful. The species get names that represent some particular states
+	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
+		c['background']=1											#background always there (flat)
+	if 'infinite' in list(pardf.index.values):
+		return c													
+	else:
+		c.drop('Inf',axis=1,inplace=True)
+		return c
+
+def P24(times,pardf):								
+	'''P24'''
+	c=np.zeros((len(times),5),dtype='float') 						#creation of matrix that will hold the concentrations
+	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
+	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
+	for i in range(1,len(times)):									#iterate over all timepoints
+		dc=np.zeros((5,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
+		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
+		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
+		for j in range(int(sub_steps)):
+			dc[0]=-pardf['k0']*dt*c_temp[0]-pardf['k2']*dt*c_temp[0]-pardf['k4']*dt*c_temp[0]+g[i]*dt
+			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]
+			dc[2]=pardf['k2']*dt*c_temp[0]-pardf['k3']*dt*c_temp[2]
+			dc[3]=pardf['k1']*dt*c_temp[1]+pardf['k3']*dt*c_temp[2]-pardf['k5']*dt*c_temp[3]
+			dc[4]=pardf['k4']*dt*c_temp[0]+pardf['k5']*dt*c_temp[3]
+			for b in range(c.shape[1]):
+				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
+		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
+	c=pandas.DataFrame(c,index=times)								#write back the right indexes
+	c.index.name='time'												#and give it a name
+	c.columns=['A','B','C','D','Inf']									#this is optional but very useful. The species get names that represent some particular states
+	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
+		c['background']=1											#background always there (flat)
+	if 'infinite' in list(pardf.index.values):
+		return c													
+	else:
+		c.drop('Inf',axis=1,inplace=True)
+		return c		
+		
+def P31(times,pardf):								
+	'''P31'''
+	c=np.zeros((len(times),4),dtype='float') 						#creation of matrix that will hold the concentrations
+	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
+	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
+	for i in range(1,len(times)):									#iterate over all timepoints
+		dc=np.zeros((4,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
+		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
+		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
+		for j in range(int(sub_steps)):
+			dc[0]=-pardf['k0']*dt*c_temp[0]-pardf['k3']*dt*c_temp[0]+g[i]*dt					
+			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]
+			dc[2]=pardf['k1']*dt*c_temp[1]-pardf['k2']*dt*c_temp[2]
+			dc[3]=pardf['k2']*dt*c_temp[2]+pardf['k3']*dt*c_temp[0]
+			for b in range(c.shape[1]):
+				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
+		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
+	c=pandas.DataFrame(c,index=times)								#write back the right indexes
+	c.index.name='time'												#and give it a name
+	c.columns=['A','B','C','Inf']									#this is optional but very useful. The species get names that represent some particular states
+	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
+		c['background']=1											#background always there (flat)
+	if 'infinite' in list(pardf.index.values):
+		return c													
+	else:
+		c.drop('Inf',axis=1,inplace=True)
+		return c
+	
+def P32(times,pardf):								
+	'''P32'''
+	c=np.zeros((len(times),4),dtype='float') 						#creation of matrix that will hold the concentrations
+	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
+	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
+	for i in range(1,len(times)):									#iterate over all timepoints
+		dc=np.zeros((4,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
+		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
+		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
+		for j in range(int(sub_steps)):
+			dc[0]=-pardf['k0']*dt*c_temp[0]-pardf['k2']*dt*c_temp[0]+g[i]*dt					
+			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]
+			dc[2]=pardf['k1']*dt*c_temp[1]+pardf['k2']*dt*c_temp[0]-pardf['k3']*dt*c_temp[2]
+			dc[3]=pardf['k3']*dt*c_temp[2]
+			for b in range(c.shape[1]):
+				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
+		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
+	c=pandas.DataFrame(c,index=times)								#write back the right indexes
+	c.index.name='time'												#and give it a name
+	c.columns=['A','B','C','Inf']									#this is optional but very useful. The species get names that represent some particular states
+	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
+		c['background']=1											#background always there (flat)
+	if 'infinite' in list(pardf.index.values):
+		return c													
+	else:
+		c.drop('Inf',axis=1,inplace=True)
+		return c
+		
+def P33(times,pardf):								
+	'''P33'''
+	c=np.zeros((len(times),4),dtype='float') 						#creation of matrix that will hold the concentrations
+	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
+	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
+	for i in range(1,len(times)):									#iterate over all timepoints
+		dc=np.zeros((4,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
+		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
+		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
+		for j in range(int(sub_steps)):
+			dc[0]=-pardf['k0']*dt*c_temp[0]+g[i]*dt					
+			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]-pardf['k3']*dt*c_temp[1]
+			dc[2]=pardf['k1']*dt*c_temp[1]-pardf['k2']*dt*c_temp[2]
+			dc[3]=pardf['k3']*dt*c_temp[1]+pardf['k2']*dt*c_temp[2]
+			for b in range(c.shape[1]):
+				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
+		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
+	c=pandas.DataFrame(c,index=times)								#write back the right indexes
+	c.index.name='time'												#and give it a name
+	c.columns=['A','B','C','Inf']									#this is optional but very useful. The species get names that represent some particular states
+	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
+		c['background']=1											#background always there (flat)
+	if 'infinite' in list(pardf.index.values):
+		return c													
+	else:
+		c.drop('Inf',axis=1,inplace=True)
+		return c
+
+def P34(times,pardf):								
+	'''P33'''
+	c=np.zeros((len(times),3),dtype='float') 						#creation of matrix that will hold the concentrations
+	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
+	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
+	for i in range(1,len(times)):									#iterate over all timepoints
+		dc=np.zeros((3,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
+		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
+		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
+		for j in range(int(sub_steps)):
+			dc[0]=-pardf['k0']*dt*c_temp[0]+g[i]*dt					
+			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]-pardf['k2']*dt*c_temp[1]
+			dc[2]=pardf['k2']*dt*c_temp[1]+pardf['k1']*dt*c_temp[1]
+			for b in range(c.shape[1]):
+				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
+		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
+	c=pandas.DataFrame(c,index=times)								#write back the right indexes
+	c.index.name='time'												#and give it a name
+	c.columns=['A','B','Inf']									#this is optional but very useful. The species get names that represent some particular states
+	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
+		c['background']=1											#background always there (flat)
+	if 'infinite' in list(pardf.index.values):
+		return c													
+	else:
+		c.drop('Inf',axis=1,inplace=True)
+		return c
+		
+def P41(times,pardf):								
+	'''P41'''
+	c=np.zeros((len(times),5),dtype='float') 						#creation of matrix that will hold the concentrations
+	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
+	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
+	for i in range(1,len(times)):									#iterate over all timepoints
+		dc=np.zeros((5,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
+		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
+		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
+		for j in range(int(sub_steps)):
+			dc[0]=-pardf['k0']*dt*c_temp[0]-pardf['k4']*dt*c_temp[0]+g[i]*dt
+			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]
+			dc[2]=pardf['k1']*dt*c_temp[1]+pardf['k4']*dt*c_temp[0]-pardf['k2']*dt*c_temp[2]-pardf['k5']*dt*c_temp[2]
+			dc[3]=pardf['k2']*dt*c_temp[2]-pardf['k3']*dt*c_temp[3]
+			dc[4]=pardf['k5']*dt*c_temp[2]+pardf['k3']*dt*c_temp[3]
+			for b in range(c.shape[1]):
+				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
+		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
+	c=pandas.DataFrame(c,index=times)								#write back the right indexes
+	c.index.name='time'												#and give it a name
+	c.columns=['A','B','C','D','Inf']									#this is optional but very useful. The species get names that represent some particular states
+	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
+		c['background']=1											#background always there (flat)
+	if 'infinite' in list(pardf.index.values):
+		return c													
+	else:
+		c.drop('Inf',axis=1,inplace=True)
+		return c
+
+def P42(times,pardf):								
+	'''P42'''
+	c=np.zeros((len(times),5),dtype='float') 						#creation of matrix that will hold the concentrations
+	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
+	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
+	for i in range(1,len(times)):									#iterate over all timepoints
+		dc=np.zeros((5,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
+		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
+		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
+		for j in range(int(sub_steps)):
+			dc[0]=-pardf['k0']*dt*c_temp[0]+g[i]*dt
+			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]-pardf['k3']*dt*c_temp[1]
+			dc[2]=pardf['k1']*dt*c_temp[1]-pardf['k2']*dt*c_temp[2]
+			dc[3]=pardf['k2']*dt*c_temp[2]+pardf['k3']*dt*c_temp[1]-pardf['k4']*dt*c_temp[3]
+			dc[4]=pardf['k4']*dt*c_temp[3]
+			for b in range(c.shape[1]):
+				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
+		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
+	c=pandas.DataFrame(c,index=times)								#write back the right indexes
+	c.index.name='time'												#and give it a name
+	c.columns=['A','B','C','D','Inf']									#this is optional but very useful. The species get names that represent some particular states
+	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
+		c['background']=1											#background always there (flat)
+	if 'infinite' in list(pardf.index.values):
+		return c													
+	else:
+		c.drop('Inf',axis=1,inplace=True)
+		return c
+		
+def P43(times,pardf):								
+	'''P43'''
+	c=np.zeros((len(times),5),dtype='float') 						#creation of matrix that will hold the concentrations
+	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
+	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
+	for i in range(1,len(times)):									#iterate over all timepoints
+		dc=np.zeros((5,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
+		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
+		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
+		for j in range(int(sub_steps)):
+			dc[0]=-pardf['k0']*dt*c_temp[0]-pardf['k3']*dt*c_temp[0]+g[i]*dt
+			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]
+			dc[2]=pardf['k1']*dt*c_temp[1]-pardf['k2']*dt*c_temp[2]
+			dc[3]=pardf['k2']*dt*c_temp[2]+pardf['k3']*dt*c_temp[0]-pardf['k4']*dt*c_temp[3]
+			dc[4]=pardf['k4']*dt*c_temp[3]
+			for b in range(c.shape[1]):
+				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
+		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
+	c=pandas.DataFrame(c,index=times)								#write back the right indexes
+	c.index.name='time'												#and give it a name
+	c.columns=['A','B','C','D','Inf']									#this is optional but very useful. The species get names that represent some particular states
+	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
+		c['background']=1											#background always there (flat)
+	if 'infinite' in list(pardf.index.values):
+		return c													
+	else:
+		c.drop('Inf',axis=1,inplace=True)
+		return c	
+		
+def P44(times,pardf):								
+	'''P44'''
+	c=np.zeros((len(times),5),dtype='float') 						#creation of matrix that will hold the concentrations
+	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
+	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
+	for i in range(1,len(times)):									#iterate over all timepoints
+		dc=np.zeros((5,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
+		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
+		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
+		for j in range(int(sub_steps)):
+			dc[0]=-pardf['k0']*dt*c_temp[0]+g[i]*dt
+			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]-pardf['k4']*dt*c_temp[1]
+			dc[2]=pardf['k1']*dt*c_temp[1]-pardf['k2']*dt*c_temp[2]
+			dc[3]=pardf['k2']*dt*c_temp[2]-pardf['k3']*dt*c_temp[3]
+			dc[4]=pardf['k4']*dt*c_temp[1]+pardf['k3']*dt*c_temp[3]
+			for b in range(c.shape[1]):
+				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
+		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
+	c=pandas.DataFrame(c,index=times)								#write back the right indexes
+	c.index.name='time'												#and give it a name
+	c.columns=['A','B','C','D','Inf']									#this is optional but very useful. The species get names that represent some particular states
+	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
+		c['background']=1											#background always there (flat)
+	if 'infinite' in list(pardf.index.values):
+		return c													
+	else:
+		c.drop('Inf',axis=1,inplace=True)
+		return c		
+
+def P45(times,pardf):								
+	'''P45'''
+	c=np.zeros((len(times),5),dtype='float') 						#creation of matrix that will hold the concentrations
+	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
+	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
+	for i in range(1,len(times)):									#iterate over all timepoints
+		dc=np.zeros((5,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
+		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
+		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
+		for j in range(int(sub_steps)):
+			dc[0]=-pardf['k0']*dt*c_temp[0]-pardf['k4']*dt*c_temp[0]+g[i]*dt
+			dc[1]=pardf['k0']*dt*c_temp[0]-pardf['k1']*dt*c_temp[1]
+			dc[2]=pardf['k1']*dt*c_temp[1]-pardf['k2']*dt*c_temp[2]
+			dc[3]=pardf['k2']*dt*c_temp[2]-pardf['k3']*dt*c_temp[3]
+			dc[4]=pardf['k4']*dt*c_temp[0]+pardf['k3']*dt*c_temp[3]
+			for b in range(c.shape[1]):
+				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
+		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
+	c=pandas.DataFrame(c,index=times)								#write back the right indexes
+	c.index.name='time'												#and give it a name
+	c.columns=['A','B','C','D','Inf']									#this is optional but very useful. The species get names that represent some particular states
+	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
+		c['background']=1											#background always there (flat)
+	if 'infinite' in list(pardf.index.values):
+		return c													
+	else:
+		c.drop('Inf',axis=1,inplace=True)
+		return c
+
+def ABC_model(times,pardf):								
+	'''Classical ABC model for solids, -A*n^1-2*B*n^2-3*C*n^3, A=k0, B=k1, C=k2, k3 single charge returns to excited state 
+	note that the recombination looses 2 excitations (so B might be slightly different), C is auger recombination where the single charge has spectrum if a parameter with name [Auger] is present, which is invisible if not. Both Background and an non decaying (damaged) spectrum are implented and triggered by including of 'infinite' and 'background' as parameter '''
+	c=np.zeros((len(times),3),dtype='float') 						#creation of matrix that will hold the concentrations
+	g=gauss(times,sigma=pardf['resolution']/FWHM,mu=pardf['t0']) 	#creating the gaussian pulse that will "excite" our sample
+	sub_steps=10 													#defining how many extra steps will be taken between the main time_points
+	for i in range(1,len(times)):									#iterate over all timepoints
+		dc=np.zeros((3,1),dtype='float')							#the initial change for each concentration, the "3" is representative of how many changes there will be
+		dt=(times[i]-times[i-1])/(sub_steps)						# as we are taking smaller steps the time intervals need to be adapted
+		c_temp=c[i-1,:]												#temporary matrix holding the changes (needed as we have sub steps and need to check for zero in the end)
+		for j in range(int(sub_steps)):
+			dc[0]=-pardf['k0']*dt*c_temp[0]-2*pardf['k1']*dt*c_temp[0]^2-3*pardf['k2']*dt*c_temp[0]^3+pardf['k3']*dt*c_temp[1]+g[i]*dt
+			dc[1]=pardf['k2']*dt*c_temp[0]-pardf['k3']*dt*c_temp[1]
+			dc[2]=pardf['k0']*dt*c_temp[0]+2*pardf['k1']*dt*c_temp[0]^2+2*pardf['k2']*dt*c_temp[0]^3
+			for b in range(c.shape[1]):
+				c_temp[b] =np.nanmax([(c_temp[b]+float(dc[b])),0.])		#check that nothing will be below 0 (concentrations)
+		c[i,:] =c_temp												#store the temporary concentrations into the main matrix
+	c=pandas.DataFrame(c,index=times)								#write back the right indexes
+	c.index.name='time'												#and give it a name
+	c.columns=['Excited_state','Auger','Inf']									#this is optional but very useful. The species get names that represent some particular states
+	if 'background' in list(pardf.index.values):					#optional but usefull, allow the keyword "background" to be used to fit the background in the global analysis
+		c['background']=1											#background always there (flat)
+	if 'auger' in list(pardf.index.values):
+		pass													
+	else:
+		c.drop('Auger',axis=1,inplace=True)
+	if 'infinite' in list(pardf.index.values):
+		pass													
+	else:
+		c.drop('Inf',axis=1,inplace=True)
+	return c
```

### Comparing `KiMoPack-7.0.0/Workflow_tools/additional_formats/streak_camera/Analysis of emission data.ipynb` & `KiMoPack-7.0.1/Workflow_tools/additional_formats/streak_camera/Analysis of emission data.ipynb`

 * *Files identical despite different names*

### Comparing `KiMoPack-7.0.0/Workflow_tools/additional_formats/streak_camera/import_library.py` & `KiMoPack-7.0.1/Workflow_tools/additional_formats/streak_camera/import_library.py`

 * *Files identical despite different names*

### Comparing `KiMoPack-7.0.0/Workflow_tools/additional_functions/cut.py` & `KiMoPack-7.0.1/Workflow_tools/additional_functions/cut.py`

 * *Files identical despite different names*

### Comparing `KiMoPack-7.0.0/Workflow_tools/additional_functions/standard_functions.py` & `KiMoPack-7.0.1/Workflow_tools/additional_functions/standard_functions.py`

 * *Files identical despite different names*

### Comparing `KiMoPack-7.0.0/Workflow_tools/import_library.py` & `KiMoPack-7.0.1/Workflow_tools/import_library.py`

 * *Files identical despite different names*

### Comparing `KiMoPack-7.0.0/setup.cfg` & `KiMoPack-7.0.1/setup.cfg`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 00000000: 5b6d 6574 6164 6174 615d 0d0a 6e61 6d65  [metadata]..name
 00000010: 203d 204b 694d 6f50 6163 6b0d 0a76 6572   = KiMoPack..ver
-00000020: 7369 6f6e 203d 2037 2e30 2e30 0d0a 6175  sion = 7.0.0..au
+00000020: 7369 6f6e 203d 2037 2e30 2e31 0d0a 6175  sion = 7.0.1..au
 00000030: 7468 6f72 203d 204a 656e 7320 5568 6c69  thor = Jens Uhli
 00000040: 670d 0a61 7574 686f 725f 656d 6169 6c20  g..author_email 
 00000050: 3d20 6a65 6e73 2e75 686c 6967 4063 6865  = jens.uhlig@che
 00000060: 6d70 6879 732e 6c75 2e73 650d 0a64 6573  mphys.lu.se..des
 00000070: 6372 6970 7469 6f6e 203d 2041 2063 6f6d  cription = A com
 00000080: 7072 6568 656e 7369 7665 2070 6163 6b61  prehensive packa
 00000090: 6765 2066 6f72 2074 6865 2061 6e61 6c79  ge for the analy
```

### Comparing `KiMoPack-7.0.0/setup.py` & `KiMoPack-7.0.1/setup.py`

 * *Files identical despite different names*

### Comparing `KiMoPack-7.0.0/src/KiMoPack/__init__.py` & `KiMoPack-7.0.1/src/KiMoPack/__init__.py`

 * *Files identical despite different names*

### Comparing `KiMoPack-7.0.0/src/KiMoPack/plot_func.py` & `KiMoPack-7.0.1/src/KiMoPack/plot_func.py`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 00000000: 2320 2d2a 2d20 636f 6469 6e67 3a20 7574  # -*- coding: ut
 00000010: 662d 3820 2d2a 2d0d 0a76 6572 7369 6f6e  f-8 -*-..version
-00000020: 203d 2022 372e 302e 3022 0d0a 436f 7079   = "7.0.0"..Copy
+00000020: 203d 2022 372e 302e 3122 0d0a 436f 7079   = "7.0.1"..Copy
 00000030: 7269 6768 7420 3d20 2740 4a65 6e73 2055  right = '@Jens U
 00000040: 686c 6967 270d 0a69 6620 313a 2023 4869  hlig'..if 1: #Hi
 00000050: 6465 2069 6d70 6f72 7473 090d 0a09 696d  de imports....im
 00000060: 706f 7274 206f 730d 0a09 6672 6f6d 206f  port os...from o
 00000070: 7320 696d 706f 7274 2077 616c 6b0d 0a09  s import walk...
 00000080: 696d 706f 7274 2073 7973 0d0a 0969 6d70  import sys...imp
 00000090: 6f72 7420 7061 6e64 6173 0d0a 0969 6d70  ort pandas...imp
@@ -13572,12891 +13572,12896 @@
 00035030: 0a09 0909 7472 793a 236c 6574 2773 2073  ....try:#let's s
 00035040: 6565 2069 6620 7468 6520 7072 6f6a 6563  ee if the projec
 00035050: 7420 6861 7320 616e 2070 6172 616d 6574  t has an paramet
 00035060: 6572 206f 626a 6563 740d 0a09 0909 0970  er object......p
 00035070: 6172 6466 5f6f 7269 3d70 6172 5f74 6f5f  ardf_ori=par_to_
 00035080: 7061 7264 6628 7461 2e70 6172 290d 0a09  pardf(ta.par)...
 00035090: 0909 6578 6365 7074 3a0d 0a09 0909 0970  ..except:......p
-000350a0: 6172 6466 5f6f 7269 3d70 6172 6466 0d0a  ardf_ori=pardf..
-000350b0: 0909 0969 6620 756e 6971 7565 5f70 6172  ...if unique_par
-000350c0: 616d 6574 6572 2069 7320 6e6f 7420 4e6f  ameter is not No
-000350d0: 6e65 3a0d 0a09 0909 0966 6f72 206b 6579  ne:......for key
-000350e0: 2069 6e20 756e 6971 7565 5f70 6172 616d   in unique_param
-000350f0: 6574 6572 3a0d 0a09 0909 0909 7061 7264  eter:.......pard
-00035100: 662e 6c6f 635b 6b65 792c 2776 616c 7565  f.loc[key,'value
-00035110: 275d 3d70 6172 6466 5f6f 7269 2e6c 6f63  ']=pardf_ori.loc
-00035120: 5b6b 6579 2c27 7661 6c75 6527 5d0d 0a09  [key,'value']...
-00035130: 0909 7061 725f 7374 6163 6b2e 6170 7065  ..par_stack.appe
-00035140: 6e64 2870 6172 6466 290d 0a09 0909 6966  nd(pardf).....if
-00035150: 206c 6f67 5f66 6974 3a0d 0a09 0909 0970   log_fit:......p
-00035160: 6172 6466 2e6c 6f63 5b70 6172 6466 2e69  ardf.loc[pardf.i
-00035170: 735f 7261 7465 2c27 7661 6c75 6527 5d3d  s_rate,'value']=
-00035180: 7061 7264 662e 6c6f 635b 7061 7264 662e  pardf.loc[pardf.
-00035190: 6973 5f72 6174 652c 2776 616c 7565 275d  is_rate,'value']
-000351a0: 2e61 7070 6c79 286c 616d 6264 6120 783a  .apply(lambda x:
-000351b0: 2031 302a 2a78 290d 0a09 0909 6966 2069   10**x).....if i
-000351c0: 7369 6e73 7461 6e63 6528 6d6f 642c 7479  sinstance(mod,ty
-000351d0: 7065 2827 6865 6c6c 6f27 2929 3a23 6469  pe('hello')):#di
-000351e0: 6420 7765 2075 7365 2061 2062 7569 6c64  d we use a build
-000351f0: 2069 6e20 6d6f 6465 6c3f 0d0a 0909 0909   in model?......
-00035200: 633d 6275 696c 645f 6328 7469 6d65 733d  c=build_c(times=
-00035210: 6473 2e69 6e64 6578 2e76 616c 7565 732e  ds.index.values.
-00035220: 6173 7479 7065 2827 666c 6f61 7427 292c  astype('float'),
-00035230: 6d6f 643d 6d6f 642c 7061 7264 663d 7061  mod=mod,pardf=pa
-00035240: 7264 6629 0d0a 0909 0965 6c73 653a 0d0a  rdf).....else:..
-00035250: 0909 0909 633d 6d6f 6428 7469 6d65 733d  ....c=mod(times=
-00035260: 6473 2e69 6e64 6578 2e76 616c 7565 732e  ds.index.values.
-00035270: 6173 7479 7065 2827 666c 6f61 7427 292c  astype('float'),
-00035280: 7061 7264 663d 7061 7264 662e 6c6f 635b  pardf=pardf.loc[
-00035290: 3a2c 2776 616c 7565 275d 290d 0a09 0909  :,'value']).....
-000352a0: 6966 2065 7874 5f73 7065 6374 7261 2069  if ext_spectra i
-000352b0: 7320 4e6f 6e65 3a0d 0a09 0909 0963 5f74  s None:......c_t
-000352c0: 656d 703d 632e 636f 7079 2829 0d0a 0909  emp=c.copy()....
-000352d0: 0965 6c73 653a 0d0a 0909 0909 6966 2027  .else:......if '
-000352e0: 6578 745f 7370 6563 7472 615f 7368 6966  ext_spectra_shif
-000352f0: 7427 2069 6e20 6c69 7374 2870 6172 6466  t' in list(pardf
-00035300: 2e69 6e64 6578 2e76 616c 7565 7329 3a0d  .index.values):.
-00035310: 0a09 0909 0909 6578 745f 7370 6563 7472  ......ext_spectr
-00035320: 612e 696e 6465 783d 6578 745f 7370 6563  a.index=ext_spec
-00035330: 7472 612e 696e 6465 782e 7661 6c75 6573  tra.index.values
-00035340: 2b70 6172 6466 2e6c 6f63 5b27 6578 745f  +pardf.loc['ext_
-00035350: 7370 6563 7472 615f 7368 6966 7427 2c27  spectra_shift','
-00035360: 7661 6c75 6527 5d0d 0a09 0909 0909 6578  value'].......ex
-00035370: 745f 7370 6563 7472 613d 7265 6269 6e28  t_spectra=rebin(
-00035380: 6578 745f 7370 6563 7472 612c 6473 2e63  ext_spectra,ds.c
-00035390: 6f6c 756d 6e73 2e76 616c 7565 732e 6173  olumns.values.as
-000353a0: 7479 7065 2866 6c6f 6174 2929 0d0a 0909  type(float))....
-000353b0: 0909 656c 7365 3a0d 0a09 0909 0909 6578  ..else:.......ex
-000353c0: 745f 7370 6563 7472 613d 7265 6269 6e28  t_spectra=rebin(
-000353d0: 6578 745f 7370 6563 7472 612c 6473 2e63  ext_spectra,ds.c
-000353e0: 6f6c 756d 6e73 2e76 616c 7565 732e 6173  olumns.values.as
-000353f0: 7479 7065 2866 6c6f 6174 2929 0d0a 0909  type(float))....
-00035400: 0909 6966 2022 6578 745f 7370 6563 7472  ..if "ext_spectr
-00035410: 615f 7363 616c 6522 2069 6e20 6c69 7374  a_scale" in list
-00035420: 2870 6172 6466 2e69 6e64 6578 2e76 616c  (pardf.index.val
-00035430: 7565 7329 3a0d 0a09 0909 0909 6578 745f  ues):.......ext_
-00035440: 7370 6563 7472 613d 6578 745f 7370 6563  spectra=ext_spec
-00035450: 7472 612a 7061 7264 662e 6c6f 635b 2765  tra*pardf.loc['e
-00035460: 7874 5f73 7065 6374 7261 5f73 6361 6c65  xt_spectra_scale
-00035470: 272c 2776 616c 7565 275d 0d0a 0909 0909  ','value']......
-00035480: 635f 7465 6d70 3d63 2e63 6f70 7928 290d  c_temp=c.copy().
-00035490: 0a09 0909 0966 6f72 2063 6f6c 2069 6e20  .....for col in 
-000354a0: 6578 745f 7370 6563 7472 612e 636f 6c75  ext_spectra.colu
-000354b0: 6d6e 733a 0d0a 0909 0909 0941 2c42 3d6e  mns:.......A,B=n
-000354c0: 702e 6d65 7368 6772 6964 2863 2e6c 6f63  p.meshgrid(c.loc
-000354d0: 5b3a 2c63 6f6c 5d2e 7661 6c75 6573 2c65  [:,col].values,e
-000354e0: 7874 5f73 7065 6374 7261 2e6c 6f63 5b3a  xt_spectra.loc[:
-000354f0: 2c63 6f6c 5d2e 7661 6c75 6573 290d 0a09  ,col].values)...
-00035500: 0909 0909 433d 7061 6e64 6173 2e44 6174  ....C=pandas.Dat
-00035510: 6146 7261 6d65 2828 412a 4229 2e54 2c69  aFrame((A*B).T,i
-00035520: 6e64 6578 3d63 2e69 6e64 6578 2c63 6f6c  ndex=c.index,col
-00035530: 756d 6e73 3d65 7874 5f73 7065 6374 7261  umns=ext_spectra
-00035540: 2e69 6e64 6578 2e76 616c 7565 7329 0d0a  .index.values)..
-00035550: 0909 0909 0964 733d 6473 2d43 0d0a 0909  .....ds=ds-C....
-00035560: 0909 0963 5f74 656d 702e 6472 6f70 2863  ...c_temp.drop(c
-00035570: 6f6c 2c61 7869 733d 312c 696e 706c 6163  ol,axis=1,inplac
-00035580: 653d 5472 7565 290d 0a09 0909 6966 206e  e=True).....if n
-00035590: 6f74 2077 6569 6768 7473 2069 7320 4e6f  ot weights is No
-000355a0: 6e65 3a0d 0a09 0909 0969 6620 6c65 6e28  ne:......if len(
-000355b0: 7765 6967 6874 7329 3d3d 6c65 6e28 6d75  weights)==len(mu
-000355c0: 6c74 695f 7072 6f6a 6563 7429 2d31 3a0d  lti_project)-1:.
-000355d0: 0a09 0909 0909 7765 6967 6874 733d 6c69  ......weights=li
-000355e0: 7374 2877 6569 6768 7473 290d 0a09 0909  st(weights).....
-000355f0: 0909 7765 6967 6874 732e 696e 7365 7274  ..weights.insert
-00035600: 2830 2c31 290d 0a09 0909 0965 6c69 6620  (0,1)......elif 
-00035610: 6c65 6e28 7765 6967 6874 7329 213d 6c65  len(weights)!=le
-00035620: 6e28 6d75 6c74 695f 7072 6f6a 6563 7429  n(multi_project)
-00035630: 3a0d 0a09 0909 0909 4578 203d 2056 616c  :.......Ex = Val
-00035640: 7565 4572 726f 7228 290d 0a09 0909 0909  ueError().......
-00035650: 4578 2e73 7472 6572 726f 723d 2754 6865  Ex.strerror='The
-00035660: 206e 756d 6265 7220 6f66 2065 6e74 7269   number of entri
-00035670: 6573 2069 2074 6865 206c 6973 7420 6d75  es i the list mu
-00035680: 7374 2065 6974 6865 7220 6265 2074 6865  st either be the
-00035690: 206e 756d 6265 7220 6f66 2061 6c6c 2065   number of all e
-000356a0: 6c65 6d65 6e74 7320 2869 6e63 6c75 6469  lements (includi
-000356b0: 6e67 205c 2254 415c 2220 6f72 2074 6865  ng \"TA\" or the
-000356c0: 206e 756d 6265 7220 6f66 2065 6c65 6d65   number of eleme
-000356d0: 6e74 7320 696e 206f 7468 6572 2e20 496e  nts in other. In
-000356e0: 2074 6869 7320 6361 7365 2074 6865 2065   this case the e
-000356f0: 6c65 6d65 6e74 2074 6120 6765 7473 2074  lement ta gets t
-00035700: 6865 2077 6569 6768 743d 3127 0d0a 0909  he weight=1'....
-00035710: 0909 0972 6169 7365 2045 780d 0a09 0909  ...raise Ex.....
-00035720: 0964 735f 7374 6163 6b2e 6170 7065 6e64  .ds_stack.append
-00035730: 2864 732a 7765 6967 6874 735b 695d 290d  (ds*weights[i]).
-00035740: 0a09 0909 656c 7365 3a0d 0a09 0909 0964  ....else:......d
-00035750: 735f 7374 6163 6b2e 6170 7065 6e64 2864  s_stack.append(d
-00035760: 7329 0d0a 0909 0963 5f73 7461 636b 2e61  s).....c_stack.a
-00035770: 7070 656e 6428 635f 7465 6d70 290d 0a09  ppend(c_temp)...
-00035780: 0909 6865 6967 6874 5f73 7461 636b 2e61  ..height_stack.a
-00035790: 7070 656e 6428 6c65 6e28 635f 7465 6d70  ppend(len(c_temp
-000357a0: 2e69 6e64 6578 2e76 616c 7565 7329 290d  .index.values)).
-000357b0: 0a09 0909 0d0a 0909 415f 636f 6e3d 7061  ........A_con=pa
-000357c0: 6e64 6173 2e63 6f6e 6361 7428 6473 5f73  ndas.concat(ds_s
-000357d0: 7461 636b 290d 0a09 0963 5f63 6f6e 3d70  tack)....c_con=p
-000357e0: 616e 6461 732e 636f 6e63 6174 2863 5f73  andas.concat(c_s
-000357f0: 7461 636b 290d 0a09 0972 653d 6669 6c6c  tack)....re=fill
-00035800: 5f69 6e74 2864 733d 415f 636f 6e2c 633d  _int(ds=A_con,c=
-00035810: 635f 636f 6e2c 2072 6574 7572 6e5f 7368  c_con, return_sh
-00035820: 6170 6573 203d 2064 756d 705f 7368 6170  apes = dump_shap
-00035830: 6573 2c20 6669 6e61 6c20 3d66 696e 616c  es, final =final
-00035840: 290d 0a09 090d 0a09 0969 6620 6475 6d70  )........if dump
-00035850: 5f70 6172 6173 3a0d 0a09 0909 7472 793a  _paras:.....try:
-00035860: 0d0a 0909 0909 7061 7264 662e 6c6f 635b  ......pardf.loc[
-00035870: 2765 7272 6f72 272c 2776 616c 7565 275d  'error','value']
-00035880: 3d72 655b 2765 7272 6f72 275d 0d0a 0909  =re['error']....
-00035890: 0965 7863 6570 743a 0d0a 0909 0909 7061  .except:......pa
-000358a0: 7373 0d0a 0909 0969 6620 6669 6e61 6c3a  ss.....if final:
-000358b0: 0d0a 0909 0909 7472 793a 0d0a 0909 0909  ......try:......
-000358c0: 0970 6172 6466 2e6c 6f63 5b27 7232 272c  .pardf.loc['r2',
-000358d0: 2776 616c 7565 275d 3d31 2d72 655b 2765  'value']=1-re['e
-000358e0: 7272 6f72 275d 2f28 2872 655b 2741 275d  rror']/((re['A']
-000358f0: 2d72 655b 2741 275d 2e6d 6561 6e28 292e  -re['A'].mean().
-00035900: 6d65 616e 2829 292a 2a32 292e 7375 6d28  mean())**2).sum(
-00035910: 292e 7375 6d28 290d 0a09 0909 0965 7863  ).sum()......exc
-00035920: 6570 743a 0d0a 0909 0909 0970 6173 730d  ept:.......pass.
-00035930: 0a09 0909 7472 793a 0d0a 0909 0909 6966  ....try:......if
-00035940: 2066 696c 656e 616d 6520 6973 204e 6f6e   filename is Non
-00035950: 653a 0d0a 0909 0909 0973 746f 7265 5f6e  e:.......store_n
-00035960: 616d 653d 276d 696e 696d 616c 5f64 756d  ame='minimal_dum
-00035970: 705f 7061 7261 732e 7061 7227 0d0a 0909  p_paras.par'....
-00035980: 0909 656c 7365 3a0d 0a09 0909 0909 7374  ..else:.......st
-00035990: 6f72 655f 6e61 6d65 3d27 6d69 6e69 6d61  ore_name='minima
-000359a0: 6c5f 6475 6d70 5f70 6172 6173 5f25 732e  l_dump_paras_%s.
-000359b0: 7061 7227 2566 696c 656e 616d 650d 0a09  par'%filename...
-000359c0: 0909 096d 696e 5f64 663d 7061 6e64 6173  ...min_df=pandas
-000359d0: 2e72 6561 645f 6373 7628 7374 6f72 655f  .read_csv(store_
-000359e0: 6e61 6d65 2c73 6570 3d27 2c27 2c68 6561  name,sep=',',hea
-000359f0: 6465 723d 4e6f 6e65 2c73 6b69 7072 6f77  der=None,skiprow
-00035a00: 733d 3129 0d0a 0909 0909 6966 2066 6c6f  s=1)......if flo
-00035a10: 6174 286d 696e 5f64 662e 696c 6f63 5b2d  at(min_df.iloc[-
-00035a20: 312c 315d 293e 666c 6f61 7428 636f 6d62  1,1])>float(comb
-00035a30: 696e 6564 5f65 7272 6f72 293a 0d0a 0909  ined_error):....
-00035a40: 0909 0970 6172 6466 2e74 6f5f 6373 7628  ...pardf.to_csv(
-00035a50: 7374 6f72 655f 6e61 6d65 290d 0a09 0909  store_name).....
-00035a60: 6578 6365 7074 3a0d 0a09 0909 0970 6173  except:......pas
-00035a70: 730d 0a09 0909 6966 2066 696c 656e 616d  s.....if filenam
-00035a80: 6520 6973 204e 6f6e 653a 0d0a 0909 0909  e is None:......
-00035a90: 7374 6f72 655f 6e61 6d65 3d27 6475 6d70  store_name='dump
-00035aa0: 5f70 6172 6173 2e70 6172 270d 0a09 0909  _paras.par'.....
-00035ab0: 656c 7365 3a0d 0a09 0909 0973 746f 7265  else:......store
-00035ac0: 5f6e 616d 653d 2764 756d 705f 7061 7261  _name='dump_para
-00035ad0: 735f 2573 2e70 6172 2725 6669 6c65 6e61  s_%s.par'%filena
-00035ae0: 6d65 0d0a 0909 0974 7279 3a0d 0a09 0909  me.....try:.....
-00035af0: 0970 6172 6466 2e74 6f5f 6373 7628 7374  .pardf.to_csv(st
-00035b00: 6f72 655f 6e61 6d65 290d 0a09 0909 6578  ore_name).....ex
-00035b10: 6365 7074 3a0d 0a09 0909 0970 7269 6e74  cept:......print
-00035b20: 2827 5361 7669 6e67 206f 6620 2573 2066  ('Saving of %s f
-00035b30: 6169 6c65 6427 2573 746f 7265 5f6e 616d  ailed'%store_nam
-00035b40: 6529 0d0a 0909 0d0a 0909 6966 2066 696e  e)........if fin
-00035b50: 616c 3a0d 0a09 0909 6966 2069 7369 6e73  al:.....if isins
-00035b60: 7461 6e63 6528 6d6f 642c 7479 7065 2827  tance(mod,type('
-00035b70: 6865 6c6c 6f27 2929 3a23 6469 6420 7765  hello')):#did we
-00035b80: 2075 7365 2061 2062 7569 6c64 2069 6e20   use a build in 
-00035b90: 6d6f 6465 6c3f 090d 0a09 0909 096c 6162  model?.......lab
-00035ba0: 656c 733d 6c69 7374 2872 655b 2744 4143  els=list(re['DAC
-00035bb0: 275d 2e63 6f6c 756d 6e73 2e76 616c 7565  '].columns.value
-00035bc0: 7329 0d0a 0909 0909 6368 616e 6765 643d  s)......changed=
-00035bd0: 5472 7565 0d0a 0909 0909 6966 2027 6261  True......if 'ba
-00035be0: 636b 6772 6f75 6e64 2720 696e 206c 6973  ckground' in lis
-00035bf0: 7428 7061 7264 662e 696e 6465 782e 7661  t(pardf.index.va
-00035c00: 6c75 6573 293a 0d0a 0909 0909 0969 6620  lues):.......if 
-00035c10: 2769 6e66 696e 6974 6527 2069 6e20 6c69  'infinite' in li
-00035c20: 7374 2870 6172 6466 2e69 6e64 6578 2e76  st(pardf.index.v
-00035c30: 616c 7565 7329 3a0d 0a09 0909 0909 096c  alues):........l
-00035c40: 6162 656c 735b 2d31 5d3d 274e 6f6e 2044  abels[-1]='Non D
-00035c50: 6563 6179 696e 6727 0d0a 0909 0909 0909  ecaying'........
-00035c60: 6c61 6265 6c73 5b2d 325d 3d27 6261 636b  labels[-2]='back
-00035c70: 6772 6f75 6e64 270d 0a09 0909 0909 656c  ground'.......el
-00035c80: 7365 3a0d 0a09 0909 0909 096c 6162 656c  se:........label
-00035c90: 735b 2d31 5d3d 2762 6163 6b67 726f 756e  s[-1]='backgroun
-00035ca0: 6427 0d0a 0909 0909 656c 7365 3a0d 0a09  d'......else:...
-00035cb0: 0909 0909 6966 2027 696e 6669 6e69 7465  ....if 'infinite
-00035cc0: 2720 696e 206c 6973 7428 7061 7264 662e  ' in list(pardf.
-00035cd0: 696e 6465 782e 7661 6c75 6573 293a 0d0a  index.values):..
-00035ce0: 0909 0909 0909 6c61 6265 6c73 5b2d 315d  ......labels[-1]
-00035cf0: 3d27 4e6f 6e20 4465 6361 7969 6e67 270d  ='Non Decaying'.
-00035d00: 0a09 0909 0909 656c 7365 3a63 6861 6e67  ......else:chang
-00035d10: 6564 3d46 616c 7365 0d0a 0909 0909 6966  ed=False......if
-00035d20: 2063 6861 6e67 6564 3a0d 0a09 0909 0909   changed:.......
-00035d30: 7265 5b27 4441 4327 5d2e 636f 6c75 6d6e  re['DAC'].column
-00035d40: 733d 6c61 6265 6c73 0d0a 0909 0909 0972  s=labels.......r
-00035d50: 655b 2763 275d 2e63 6f6c 756d 6e73 3d6c  e['c'].columns=l
-00035d60: 6162 656c 730d 0a09 0909 0969 6620 6e6f  abels......if no
-00035d70: 7420 6578 745f 7370 6563 7472 6120 6973  t ext_spectra is
-00035d80: 204e 6f6e 653a 0d0a 0909 0909 0966 6f72   None:.......for
-00035d90: 2063 6f6c 2069 6e20 6578 745f 7370 6563   col in ext_spec
-00035da0: 7472 612e 636f 6c75 6d6e 733a 0d0a 0909  tra.columns:....
-00035db0: 0909 0909 7265 5b27 4441 4327 5d5b 636f  ....re['DAC'][co
-00035dc0: 6c5d 3d65 7874 5f73 7065 6374 7261 2e6c  l]=ext_spectra.l
-00035dd0: 6f63 5b3a 2c63 6f6c 5d2e 7661 6c75 6573  oc[:,col].values
-00035de0: 0d0a 0909 0909 0909 7265 5b27 6327 5d5b  ........re['c'][
-00035df0: 636f 6c5d 3d63 2e6c 6f63 5b3a 2c63 6f6c  col]=c.loc[:,col
-00035e00: 5d2e 7661 6c75 6573 0d0a 0909 0909 0909  ].values........
-00035e10: 412c 423d 6e70 2e6d 6573 6867 7269 6428  A,B=np.meshgrid(
-00035e20: 632e 6c6f 635b 3a2c 636f 6c5d 2e76 616c  c.loc[:,col].val
-00035e30: 7565 732c 6578 745f 7370 6563 7472 612e  ues,ext_spectra.
-00035e40: 6c6f 635b 3a2c 636f 6c5d 2e76 616c 7565  loc[:,col].value
-00035e50: 7329 0d0a 0909 0909 0909 433d 7061 6e64  s)........C=pand
-00035e60: 6173 2e44 6174 6146 7261 6d65 2828 412a  as.DataFrame((A*
-00035e70: 4229 2e54 2c69 6e64 6578 3d63 2e69 6e64  B).T,index=c.ind
-00035e80: 6578 2c63 6f6c 756d 6e73 3d65 7874 5f73  ex,columns=ext_s
-00035e90: 7065 6374 7261 2e69 6e64 6578 2e76 616c  pectra.index.val
-00035ea0: 7565 7329 0d0a 0909 0909 0909 7265 5b27  ues)........re['
-00035eb0: 4127 5d3d 7265 5b27 4127 5d2b 430d 0a09  A']=re['A']+C...
-00035ec0: 0909 0909 0972 655b 2741 4327 5d3d 7265  .....re['AC']=re
-00035ed0: 5b27 4143 275d 2b43 0d0a 0909 0965 6c73  ['AC']+C.....els
-00035ee0: 653a 0d0a 0909 0909 7265 5b27 4441 4327  e:......re['DAC'
-00035ef0: 5d2e 636f 6c75 6d6e 733d 632e 636f 6c75  ].columns=c.colu
-00035f00: 6d6e 732e 7661 6c75 6573 0d0a 0909 0909  mns.values......
-00035f10: 7265 5b27 6327 5d2e 636f 6c75 6d6e 733d  re['c'].columns=
-00035f20: 632e 636f 6c75 6d6e 732e 7661 6c75 6573  c.columns.values
-00035f30: 0d0a 0909 0909 6966 206e 6f74 2065 7874  ......if not ext
-00035f40: 5f73 7065 6374 7261 2069 7320 4e6f 6e65  _spectra is None
-00035f50: 3a0d 0a09 0909 0909 666f 7220 636f 6c20  :.......for col 
-00035f60: 696e 2065 7874 5f73 7065 6374 7261 2e63  in ext_spectra.c
-00035f70: 6f6c 756d 6e73 3a0d 0a09 0909 0909 0972  olumns:........r
-00035f80: 655b 2744 4143 275d 5b63 6f6c 5d3d 6578  e['DAC'][col]=ex
-00035f90: 745f 7370 6563 7472 612e 6c6f 635b 3a2c  t_spectra.loc[:,
-00035fa0: 636f 6c5d 2e76 616c 7565 730d 0a09 0909  col].values.....
-00035fb0: 0909 0972 655b 2763 275d 5b63 6f6c 5d3d  ...re['c'][col]=
-00035fc0: 632e 6c6f 635b 3a2c 636f 6c5d 2e76 616c  c.loc[:,col].val
-00035fd0: 7565 730d 0a09 0909 0909 0941 2c42 3d6e  ues........A,B=n
-00035fe0: 702e 6d65 7368 6772 6964 2863 2e6c 6f63  p.meshgrid(c.loc
-00035ff0: 5b3a 2c63 6f6c 5d2e 7661 6c75 6573 2c65  [:,col].values,e
-00036000: 7874 5f73 7065 6374 7261 2e6c 6f63 5b3a  xt_spectra.loc[:
-00036010: 2c63 6f6c 5d2e 7661 6c75 6573 290d 0a09  ,col].values)...
-00036020: 0909 0909 0943 3d70 616e 6461 732e 4461  .....C=pandas.Da
-00036030: 7461 4672 616d 6528 2841 2a42 292e 542c  taFrame((A*B).T,
-00036040: 696e 6465 783d 632e 696e 6465 782c 636f  index=c.index,co
-00036050: 6c75 6d6e 733d 6578 745f 7370 6563 7472  lumns=ext_spectr
-00036060: 612e 696e 6465 782e 7661 6c75 6573 290d  a.index.values).
-00036070: 0a09 0909 0909 0972 655b 2741 275d 3d72  .......re['A']=r
-00036080: 655b 2741 275d 2b43 0d0a 0909 0909 0909  e['A']+C........
-00036090: 7265 5b27 4143 275d 3d72 655b 2741 4327  re['AC']=re['AC'
-000360a0: 5d2b 430d 0a09 0909 7265 7475 726e 5f6c  ]+C.....return_l
-000360b0: 6973 7465 6e3d 5b5d 0d0a 0909 0966 6f72  isten=[].....for
-000360c0: 2069 2c74 6120 696e 2065 6e75 6d65 7261   i,ta in enumera
-000360d0: 7465 286d 756c 7469 5f70 726f 6a65 6374  te(multi_project
-000360e0: 293a 0d0a 0909 0909 7265 5f6c 6f63 616c  ):......re_local
-000360f0: 3d7b 7d0d 0a09 0909 0969 6620 693d 3d30  ={}......if i==0
-00036100: 3a0d 0a09 0909 0909 6c6f 7765 723d 300d  :.......lower=0.
-00036110: 0a09 0909 0965 6c73 653a 0d0a 0909 0909  .....else:......
-00036120: 096c 6f77 6572 3d6e 702e 6172 7261 7928  .lower=np.array(
-00036130: 6865 6967 6874 5f73 7461 636b 295b 3a69  height_stack)[:i
-00036140: 5d2e 7375 6d28 290d 0a09 0909 0972 655f  ].sum()......re_
-00036150: 6c6f 6361 6c5b 2741 275d 3d72 655b 2741  local['A']=re['A
-00036160: 275d 2e63 6f70 7928 292e 696c 6f63 5b6c  '].copy().iloc[l
-00036170: 6f77 6572 3a6c 6f77 6572 2b68 6569 6768  ower:lower+heigh
-00036180: 745f 7374 6163 6b5b 695d 2c3a 5d0d 0a09  t_stack[i],:]...
-00036190: 0909 0972 655f 6c6f 6361 6c5b 2741 4327  ...re_local['AC'
-000361a0: 5d3d 7265 5b27 4143 275d 2e63 6f70 7928  ]=re['AC'].copy(
-000361b0: 292e 696c 6f63 5b6c 6f77 6572 3a6c 6f77  ).iloc[lower:low
-000361c0: 6572 2b68 6569 6768 745f 7374 6163 6b5b  er+height_stack[
-000361d0: 695d 2c3a 5d0d 0a09 0909 0972 655f 6c6f  i],:]......re_lo
-000361e0: 6361 6c5b 2741 4527 5d3d 7265 5b27 4145  cal['AE']=re['AE
-000361f0: 275d 2e63 6f70 7928 292e 696c 6f63 5b6c  '].copy().iloc[l
-00036200: 6f77 6572 3a6c 6f77 6572 2b68 6569 6768  ower:lower+heigh
-00036210: 745f 7374 6163 6b5b 695d 2c3a 5d0d 0a09  t_stack[i],:]...
-00036220: 0909 0972 655f 6c6f 6361 6c5b 2763 275d  ...re_local['c']
-00036230: 3d72 655b 2763 275d 2e63 6f70 7928 292e  =re['c'].copy().
-00036240: 696c 6f63 5b6c 6f77 6572 3a6c 6f77 6572  iloc[lower:lower
-00036250: 2b68 6569 6768 745f 7374 6163 6b5b 695d  +height_stack[i]
-00036260: 2c3a 5d0d 0a09 0909 0972 655f 6c6f 6361  ,:]......re_loca
-00036270: 6c5b 2765 7272 6f72 5f74 6f74 616c 275d  l['error_total']
-00036280: 3d72 655b 2765 7272 6f72 275d 0d0a 0909  =re['error']....
-00036290: 0909 7265 5f6c 6f63 616c 5b27 6572 726f  ..re_local['erro
-000362a0: 7227 5d3d 2872 655b 2741 4527 5d2a 2a32  r']=(re['AE']**2
-000362b0: 292e 7375 6d28 292e 7375 6d28 290d 0a09  ).sum().sum()...
-000362c0: 0909 0972 655f 6c6f 6361 6c5b 2744 4143  ...re_local['DAC
-000362d0: 275d 3d72 655b 2744 4143 275d 2e63 6f70  ']=re['DAC'].cop
-000362e0: 7928 290d 0a09 0909 0972 655f 6c6f 6361  y()......re_loca
-000362f0: 6c5b 2772 3227 5d3d 312d 7265 5f6c 6f63  l['r2']=1-re_loc
-00036300: 616c 5b27 6572 726f 7227 5d2f 2828 7265  al['error']/((re
-00036310: 5f6c 6f63 616c 5b27 4127 5d2d 7265 5f6c  _local['A']-re_l
-00036320: 6f63 616c 5b27 4127 5d2e 6d65 616e 2829  ocal['A'].mean()
-00036330: 2e6d 6561 6e28 2929 2a2a 3229 2e73 756d  .mean())**2).sum
-00036340: 2829 2e73 756d 2829 0d0a 0909 0909 7265  ().sum()......re
-00036350: 5f6c 6f63 616c 5b27 7232 5f74 6f74 616c  _local['r2_total
-00036360: 275d 3d31 2d72 655b 2765 7272 6f72 275d  ']=1-re['error']
-00036370: 2f28 2872 655b 2741 275d 2d72 655b 2741  /((re['A']-re['A
-00036380: 275d 2e6d 6561 6e28 292e 6d65 616e 2829  '].mean().mean()
-00036390: 292a 2a32 292e 7375 6d28 292e 7375 6d28  )**2).sum().sum(
-000363a0: 290d 0a09 0909 0972 655f 6c6f 6361 6c5b  )......re_local[
-000363b0: 2770 6172 6466 275d 3d70 6172 5f73 7461  'pardf']=par_sta
-000363c0: 636b 5b69 5d0d 0a09 0909 0974 7279 3a0d  ck[i]......try:.
-000363d0: 0a09 0909 0909 7265 5f6c 6f63 616c 5b27  ......re_local['
-000363e0: 6669 6c65 6e61 6d65 275d 3d66 696c 656e  filename']=filen
-000363f0: 616d 650d 0a09 0909 0965 7863 6570 743a  ame......except:
-00036400: 0d0a 0909 0909 0970 6173 730d 0a09 0909  .......pass.....
-00036410: 0972 6574 7572 6e5f 6c69 7374 656e 2e61  .return_listen.a
-00036420: 7070 656e 6428 7265 5f6c 6f63 616c 290d  ppend(re_local).
-00036430: 0a09 0969 6620 6e6f 7420 6d6f 6420 696e  ...if not mod in
-00036440: 205b 2770 6172 616c 272c 2765 7870 6f6e   ['paral','expon
-00036450: 656e 7469 616c 272c 2763 6f6e 7365 6375  ential','consecu
-00036460: 7469 7665 275d 3a0d 0a09 0909 7072 696e  tive']:.....prin
-00036470: 7428 7265 5b27 6572 726f 7227 5d29 0d0a  t(re['error'])..
-00036480: 0909 6966 2066 696e 616c 3a0d 0a09 0909  ..if final:.....
-00036490: 7265 7475 726e 2072 6574 7572 6e5f 6c69  return return_li
-000364a0: 7374 656e 0d0a 0909 656c 7365 3a0d 0a09  sten....else:...
-000364b0: 0909 7265 7475 726e 2072 655b 2765 7272  ..return re['err
-000364c0: 6f72 275d 0d0a 0923 2323 2323 2323 2323  or']...#########
-000364d0: 2323 2323 2323 2323 2323 2020 206e 6f74  ##########   not
-000364e0: 2073 616d 6520 4441 5323 2323 2323 2323   same DAS#######
-000364f0: 2323 2323 2323 2323 2323 2323 230d 0a09  #############...
-00036500: 656c 7365 3a0d 0a09 090d 0a09 0966 6f72  else:........for
-00036510: 2069 2c74 6120 696e 2065 6e75 6d65 7261   i,ta in enumera
-00036520: 7465 286d 756c 7469 5f70 726f 6a65 6374  te(multi_project
-00036530: 293a 0d0a 0909 0964 7320 3d20 7375 625f  ):.....ds = sub_
-00036540: 6473 2864 7320 3d20 7461 2e64 732c 2073  ds(ds = ta.ds, s
-00036550: 6361 7474 6572 6375 7420 3d20 736c 6963  cattercut = slic
-00036560: 655f 7365 7474 696e 675f 6f62 6a65 6374  e_setting_object
-00036570: 2e73 6361 7474 6572 6375 742c 2062 6f72  .scattercut, bor
-00036580: 6465 7263 7574 203d 2073 6c69 6365 5f73  dercut = slice_s
-00036590: 6574 7469 6e67 5f6f 626a 6563 742e 626f  etting_object.bo
-000365a0: 7264 6572 6375 742c 200d 0a09 0909 0909  rdercut, .......
-000365b0: 0974 696d 656c 696d 6974 7320 3d20 736c  .timelimits = sl
-000365c0: 6963 655f 7365 7474 696e 675f 6f62 6a65  ice_setting_obje
-000365d0: 6374 2e74 696d 656c 696d 6974 732c 2077  ct.timelimits, w
-000365e0: 6176 655f 6e6d 5f62 696e 203d 2073 6c69  ave_nm_bin = sli
-000365f0: 6365 5f73 6574 7469 6e67 5f6f 626a 6563  ce_setting_objec
-00036600: 742e 7761 7665 5f6e 6d5f 6269 6e2c 200d  t.wave_nm_bin, .
-00036610: 0a09 0909 0909 0974 696d 655f 6269 6e20  .......time_bin 
-00036620: 3d20 736c 6963 655f 7365 7474 696e 675f  = slice_setting_
-00036630: 6f62 6a65 6374 2e74 696d 655f 6269 6e2c  object.time_bin,
-00036640: 2069 676e 6f72 655f 7469 6d65 5f72 6567   ignore_time_reg
-00036650: 696f 6e20 3d20 736c 6963 655f 7365 7474  ion = slice_sett
-00036660: 696e 675f 6f62 6a65 6374 2e69 676e 6f72  ing_object.ignor
-00036670: 655f 7469 6d65 5f72 6567 696f 6e29 090d  e_time_region)..
-00036680: 0a09 0909 7061 7264 663d 7061 7264 665f  ....pardf=pardf_
-00036690: 6368 616e 6769 6e67 2e63 6f70 7928 290d  changing.copy().
-000366a0: 0a09 0909 7472 793a 236c 6574 2773 2073  ....try:#let's s
-000366b0: 6565 2069 6620 7468 6520 7072 6f6a 6563  ee if the projec
-000366c0: 7420 6861 7320 616e 2070 6172 616d 6574  t has an paramet
-000366d0: 6572 206f 626a 6563 740d 0a09 0909 0970  er object......p
-000366e0: 6172 6466 5f6f 7269 3d70 6172 5f74 6f5f  ardf_ori=par_to_
-000366f0: 7061 7264 6628 7461 2e70 6172 290d 0a09  pardf(ta.par)...
-00036700: 0909 6578 6365 7074 3a0d 0a09 0909 0970  ..except:......p
-00036710: 6172 6466 5f6f 7269 3d70 6172 6466 0d0a  ardf_ori=pardf..
-00036720: 0909 0969 6620 756e 6971 7565 5f70 6172  ...if unique_par
-00036730: 616d 6574 6572 2069 7320 6e6f 7420 4e6f  ameter is not No
-00036740: 6e65 3a0d 0a09 0909 0966 6f72 206b 6579  ne:......for key
-00036750: 2069 6e20 756e 6971 7565 5f70 6172 616d   in unique_param
-00036760: 6574 6572 3a0d 0a09 0909 0909 7061 7264  eter:.......pard
-00036770: 662e 6c6f 635b 6b65 792c 2776 616c 7565  f.loc[key,'value
-00036780: 275d 3d70 6172 6466 5f6f 7269 2e6c 6f63  ']=pardf_ori.loc
-00036790: 5b6b 6579 2c27 7661 6c75 6527 5d09 0d0a  [key,'value']...
-000367a0: 0909 0969 6620 6c6f 675f 6669 743a 0d0a  ...if log_fit:..
-000367b0: 0909 0909 7061 7264 662e 6c6f 635b 7061  ....pardf.loc[pa
-000367c0: 7264 662e 6973 5f72 6174 652c 2776 616c  rdf.is_rate,'val
-000367d0: 7565 275d 3d70 6172 6466 2e6c 6f63 5b70  ue']=pardf.loc[p
-000367e0: 6172 6466 2e69 735f 7261 7465 2c27 7661  ardf.is_rate,'va
-000367f0: 6c75 6527 5d2e 6170 706c 7928 6c61 6d62  lue'].apply(lamb
-00036800: 6461 2078 3a20 3130 2a2a 7829 0d0a 0d0a  da x: 10**x)....
-00036810: 0909 0969 6620 6973 696e 7374 616e 6365  ...if isinstance
-00036820: 286d 6f64 2c74 7970 6528 2768 656c 6c6f  (mod,type('hello
-00036830: 2729 293a 2364 6964 2077 6520 7573 6520  ')):#did we use 
-00036840: 6120 6275 696c 6420 696e 206d 6f64 656c  a build in model
-00036850: 3f0d 0a09 0909 0963 3d62 7569 6c64 5f63  ?......c=build_c
-00036860: 2874 696d 6573 3d64 732e 696e 6465 782e  (times=ds.index.
-00036870: 7661 6c75 6573 2e61 7374 7970 6528 2766  values.astype('f
-00036880: 6c6f 6174 2729 2c6d 6f64 3d6d 6f64 2c70  loat'),mod=mod,p
-00036890: 6172 6466 3d70 6172 6466 290d 0a09 0909  ardf=pardf).....
-000368a0: 0969 6620 6578 745f 7370 6563 7472 6120  .if ext_spectra 
-000368b0: 6973 204e 6f6e 653a 0d0a 0909 0909 0972  is None:.......r
-000368c0: 653d 6669 6c6c 5f69 6e74 2864 733d 6473  e=fill_int(ds=ds
-000368d0: 2c63 3d63 2c20 7265 7475 726e 5f73 6861  ,c=c, return_sha
-000368e0: 7065 7320 3d20 6475 6d70 5f73 6861 7065  pes = dump_shape
-000368f0: 7329 0d0a 0909 0909 656c 7365 3a0d 0a09  s)......else:...
-00036900: 0909 0909 6578 745f 7370 6563 7472 613d  ....ext_spectra=
-00036910: 7265 6269 6e28 6578 745f 7370 6563 7472  rebin(ext_spectr
-00036920: 612c 6473 2e63 6f6c 756d 6e73 2e76 616c  a,ds.columns.val
-00036930: 7565 732e 6173 7479 7065 2866 6c6f 6174  ues.astype(float
-00036940: 2929 0d0a 0909 0909 0963 5f74 656d 703d  )).......c_temp=
-00036950: 632e 636f 7079 2829 0d0a 0909 0909 0966  c.copy().......f
-00036960: 6f72 2063 6f6c 2069 6e20 6578 745f 7370  or col in ext_sp
-00036970: 6563 7472 612e 636f 6c75 6d6e 733a 0d0a  ectra.columns:..
-00036980: 0909 0909 0909 412c 423d 6e70 2e6d 6573  ......A,B=np.mes
-00036990: 6867 7269 6428 632e 6c6f 635b 3a2c 636f  hgrid(c.loc[:,co
-000369a0: 6c5d 2e76 616c 7565 732c 6578 745f 7370  l].values,ext_sp
-000369b0: 6563 7472 612e 6c6f 635b 3a2c 636f 6c5d  ectra.loc[:,col]
-000369c0: 2e76 616c 7565 7329 0d0a 0909 0909 0909  .values)........
-000369d0: 433d 7061 6e64 6173 2e44 6174 6146 7261  C=pandas.DataFra
-000369e0: 6d65 2828 412a 4229 2e54 2c69 6e64 6578  me((A*B).T,index
-000369f0: 3d63 2e69 6e64 6578 2c63 6f6c 756d 6e73  =c.index,columns
-00036a00: 3d65 7874 5f73 7065 6374 7261 2e69 6e64  =ext_spectra.ind
-00036a10: 6578 2e76 616c 7565 7329 0d0a 0909 0909  ex.values)......
-00036a20: 0909 6473 3d64 732d 430d 0a09 0909 0909  ..ds=ds-C.......
-00036a30: 0963 5f74 656d 702e 6472 6f70 2863 6f6c  .c_temp.drop(col
-00036a40: 2c61 7869 733d 312c 696e 706c 6163 653d  ,axis=1,inplace=
-00036a50: 5472 7565 290d 0a09 0909 0909 7265 3d66  True).......re=f
-00036a60: 696c 6c5f 696e 7428 6473 3d64 732c 633d  ill_int(ds=ds,c=
-00036a70: 635f 7465 6d70 2c20 7265 7475 726e 5f73  c_temp, return_s
-00036a80: 6861 7065 7320 3d20 6475 6d70 5f73 6861  hapes = dump_sha
-00036a90: 7065 7329 0d0a 0909 0909 6966 2066 696e  pes)......if fin
-00036aa0: 616c 3a0d 0a09 0909 0909 6966 2069 3d3d  al:.......if i==
-00036ab0: 303a 0d0a 0909 0909 0909 6c61 6265 6c73  0:........labels
-00036ac0: 3d6c 6973 7428 7265 5b27 4441 4327 5d2e  =list(re['DAC'].
-00036ad0: 636f 6c75 6d6e 732e 7661 6c75 6573 290d  columns.values).
-00036ae0: 0a09 0909 0909 0963 6861 6e67 6564 3d54  .......changed=T
-00036af0: 7275 650d 0a09 0909 0909 0969 6620 2762  rue........if 'b
-00036b00: 6163 6b67 726f 756e 6427 2069 6e20 6c69  ackground' in li
-00036b10: 7374 2870 6172 6466 2e69 6e64 6578 2e76  st(pardf.index.v
-00036b20: 616c 7565 7329 3a0d 0a09 0909 0909 0909  alues):.........
-00036b30: 6966 2027 696e 6669 6e69 7465 2720 696e  if 'infinite' in
-00036b40: 206c 6973 7428 7061 7264 662e 696e 6465   list(pardf.inde
-00036b50: 782e 7661 6c75 6573 293a 0d0a 0909 0909  x.values):......
-00036b60: 0909 0909 6c61 6265 6c73 5b2d 315d 3d27  ....labels[-1]='
-00036b70: 4e6f 6e20 4465 6361 7969 6e67 270d 0a09  Non Decaying'...
-00036b80: 0909 0909 0909 096c 6162 656c 735b 2d32  .......labels[-2
-00036b90: 5d3d 2762 6163 6b67 726f 756e 6427 0d0a  ]='background'..
-00036ba0: 0909 0909 0909 0965 6c73 653a 0d0a 0909  .......else:....
-00036bb0: 0909 0909 0909 6c61 6265 6c73 5b2d 315d  ......labels[-1]
-00036bc0: 3d27 6261 636b 6772 6f75 6e64 270d 0a09  ='background'...
+000350a0: 6172 6466 5f6f 7269 3d74 612e 7061 7264  ardf_ori=ta.pard
+000350b0: 662e 636f 7079 2829 0d0a 0909 0969 6620  f.copy().....if 
+000350c0: 756e 6971 7565 5f70 6172 616d 6574 6572  unique_parameter
+000350d0: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a09   is not None:...
+000350e0: 0909 0966 6f72 206b 6579 2069 6e20 756e  ...for key in un
+000350f0: 6971 7565 5f70 6172 616d 6574 6572 3a0d  ique_parameter:.
+00035100: 0a09 0909 0909 7061 7264 662e 6c6f 635b  ......pardf.loc[
+00035110: 6b65 792c 2776 616c 7565 275d 3d70 6172  key,'value']=par
+00035120: 6466 5f6f 7269 2e6c 6f63 5b6b 6579 2c27  df_ori.loc[key,'
+00035130: 7661 6c75 6527 5d0d 0a09 0909 7061 725f  value'].....par_
+00035140: 7374 6163 6b2e 6170 7065 6e64 2870 6172  stack.append(par
+00035150: 6466 290d 0a09 0909 6966 206c 6f67 5f66  df).....if log_f
+00035160: 6974 3a0d 0a09 0909 0970 6172 6466 2e6c  it:......pardf.l
+00035170: 6f63 5b70 6172 6466 2e69 735f 7261 7465  oc[pardf.is_rate
+00035180: 2c27 7661 6c75 6527 5d3d 7061 7264 662e  ,'value']=pardf.
+00035190: 6c6f 635b 7061 7264 662e 6973 5f72 6174  loc[pardf.is_rat
+000351a0: 652c 2776 616c 7565 275d 2e61 7070 6c79  e,'value'].apply
+000351b0: 286c 616d 6264 6120 783a 2031 302a 2a78  (lambda x: 10**x
+000351c0: 290d 0a09 0909 6966 2069 7369 6e73 7461  ).....if isinsta
+000351d0: 6e63 6528 6d6f 642c 7479 7065 2827 6865  nce(mod,type('he
+000351e0: 6c6c 6f27 2929 3a23 6469 6420 7765 2075  llo')):#did we u
+000351f0: 7365 2061 2062 7569 6c64 2069 6e20 6d6f  se a build in mo
+00035200: 6465 6c3f 0d0a 0909 0909 633d 6275 696c  del?......c=buil
+00035210: 645f 6328 7469 6d65 733d 6473 2e69 6e64  d_c(times=ds.ind
+00035220: 6578 2e76 616c 7565 732e 6173 7479 7065  ex.values.astype
+00035230: 2827 666c 6f61 7427 292c 6d6f 643d 6d6f  ('float'),mod=mo
+00035240: 642c 7061 7264 663d 7061 7264 6629 0d0a  d,pardf=pardf)..
+00035250: 0909 0965 6c73 653a 0d0a 0909 0909 633d  ...else:......c=
+00035260: 6d6f 6428 7469 6d65 733d 6473 2e69 6e64  mod(times=ds.ind
+00035270: 6578 2e76 616c 7565 732e 6173 7479 7065  ex.values.astype
+00035280: 2827 666c 6f61 7427 292c 7061 7264 663d  ('float'),pardf=
+00035290: 7061 7264 662e 6c6f 635b 3a2c 2776 616c  pardf.loc[:,'val
+000352a0: 7565 275d 290d 0a09 0909 6966 2065 7874  ue']).....if ext
+000352b0: 5f73 7065 6374 7261 2069 7320 4e6f 6e65  _spectra is None
+000352c0: 3a0d 0a09 0909 0963 5f74 656d 703d 632e  :......c_temp=c.
+000352d0: 636f 7079 2829 0d0a 0909 0965 6c73 653a  copy().....else:
+000352e0: 0d0a 0909 0909 6966 2027 6578 745f 7370  ......if 'ext_sp
+000352f0: 6563 7472 615f 7368 6966 7427 2069 6e20  ectra_shift' in 
+00035300: 6c69 7374 2870 6172 6466 2e69 6e64 6578  list(pardf.index
+00035310: 2e76 616c 7565 7329 3a0d 0a09 0909 0909  .values):.......
+00035320: 6578 745f 7370 6563 7472 612e 696e 6465  ext_spectra.inde
+00035330: 783d 6578 745f 7370 6563 7472 612e 696e  x=ext_spectra.in
+00035340: 6465 782e 7661 6c75 6573 2b70 6172 6466  dex.values+pardf
+00035350: 2e6c 6f63 5b27 6578 745f 7370 6563 7472  .loc['ext_spectr
+00035360: 615f 7368 6966 7427 2c27 7661 6c75 6527  a_shift','value'
+00035370: 5d0d 0a09 0909 0909 6578 745f 7370 6563  ].......ext_spec
+00035380: 7472 613d 7265 6269 6e28 6578 745f 7370  tra=rebin(ext_sp
+00035390: 6563 7472 612c 6473 2e63 6f6c 756d 6e73  ectra,ds.columns
+000353a0: 2e76 616c 7565 732e 6173 7479 7065 2866  .values.astype(f
+000353b0: 6c6f 6174 2929 0d0a 0909 0909 656c 7365  loat))......else
+000353c0: 3a0d 0a09 0909 0909 6578 745f 7370 6563  :.......ext_spec
+000353d0: 7472 613d 7265 6269 6e28 6578 745f 7370  tra=rebin(ext_sp
+000353e0: 6563 7472 612c 6473 2e63 6f6c 756d 6e73  ectra,ds.columns
+000353f0: 2e76 616c 7565 732e 6173 7479 7065 2866  .values.astype(f
+00035400: 6c6f 6174 2929 0d0a 0909 0909 6966 2022  loat))......if "
+00035410: 6578 745f 7370 6563 7472 615f 7363 616c  ext_spectra_scal
+00035420: 6522 2069 6e20 6c69 7374 2870 6172 6466  e" in list(pardf
+00035430: 2e69 6e64 6578 2e76 616c 7565 7329 3a0d  .index.values):.
+00035440: 0a09 0909 0909 6578 745f 7370 6563 7472  ......ext_spectr
+00035450: 613d 6578 745f 7370 6563 7472 612a 7061  a=ext_spectra*pa
+00035460: 7264 662e 6c6f 635b 2765 7874 5f73 7065  rdf.loc['ext_spe
+00035470: 6374 7261 5f73 6361 6c65 272c 2776 616c  ctra_scale','val
+00035480: 7565 275d 0d0a 0909 0909 635f 7465 6d70  ue']......c_temp
+00035490: 3d63 2e63 6f70 7928 290d 0a09 0909 0966  =c.copy()......f
+000354a0: 6f72 2063 6f6c 2069 6e20 6578 745f 7370  or col in ext_sp
+000354b0: 6563 7472 612e 636f 6c75 6d6e 733a 0d0a  ectra.columns:..
+000354c0: 0909 0909 0941 2c42 3d6e 702e 6d65 7368  .....A,B=np.mesh
+000354d0: 6772 6964 2863 2e6c 6f63 5b3a 2c63 6f6c  grid(c.loc[:,col
+000354e0: 5d2e 7661 6c75 6573 2c65 7874 5f73 7065  ].values,ext_spe
+000354f0: 6374 7261 2e6c 6f63 5b3a 2c63 6f6c 5d2e  ctra.loc[:,col].
+00035500: 7661 6c75 6573 290d 0a09 0909 0909 433d  values).......C=
+00035510: 7061 6e64 6173 2e44 6174 6146 7261 6d65  pandas.DataFrame
+00035520: 2828 412a 4229 2e54 2c69 6e64 6578 3d63  ((A*B).T,index=c
+00035530: 2e69 6e64 6578 2c63 6f6c 756d 6e73 3d65  .index,columns=e
+00035540: 7874 5f73 7065 6374 7261 2e69 6e64 6578  xt_spectra.index
+00035550: 2e76 616c 7565 7329 0d0a 0909 0909 0964  .values).......d
+00035560: 733d 6473 2d43 0d0a 0909 0909 0963 5f74  s=ds-C.......c_t
+00035570: 656d 702e 6472 6f70 2863 6f6c 2c61 7869  emp.drop(col,axi
+00035580: 733d 312c 696e 706c 6163 653d 5472 7565  s=1,inplace=True
+00035590: 290d 0a09 0909 6966 206e 6f74 2077 6569  ).....if not wei
+000355a0: 6768 7473 2069 7320 4e6f 6e65 3a0d 0a09  ghts is None:...
+000355b0: 0909 0969 6620 6c65 6e28 7765 6967 6874  ...if len(weight
+000355c0: 7329 3d3d 6c65 6e28 6d75 6c74 695f 7072  s)==len(multi_pr
+000355d0: 6f6a 6563 7429 2d31 3a0d 0a09 0909 0909  oject)-1:.......
+000355e0: 7765 6967 6874 733d 6c69 7374 2877 6569  weights=list(wei
+000355f0: 6768 7473 290d 0a09 0909 0909 7765 6967  ghts).......weig
+00035600: 6874 732e 696e 7365 7274 2830 2c31 290d  hts.insert(0,1).
+00035610: 0a09 0909 0965 6c69 6620 6c65 6e28 7765  .....elif len(we
+00035620: 6967 6874 7329 213d 6c65 6e28 6d75 6c74  ights)!=len(mult
+00035630: 695f 7072 6f6a 6563 7429 3a0d 0a09 0909  i_project):.....
+00035640: 0909 4578 203d 2056 616c 7565 4572 726f  ..Ex = ValueErro
+00035650: 7228 290d 0a09 0909 0909 4578 2e73 7472  r().......Ex.str
+00035660: 6572 726f 723d 2754 6865 206e 756d 6265  error='The numbe
+00035670: 7220 6f66 2065 6e74 7269 6573 2069 2074  r of entries i t
+00035680: 6865 206c 6973 7420 6d75 7374 2065 6974  he list must eit
+00035690: 6865 7220 6265 2074 6865 206e 756d 6265  her be the numbe
+000356a0: 7220 6f66 2061 6c6c 2065 6c65 6d65 6e74  r of all element
+000356b0: 7320 2869 6e63 6c75 6469 6e67 205c 2254  s (including \"T
+000356c0: 415c 2220 6f72 2074 6865 206e 756d 6265  A\" or the numbe
+000356d0: 7220 6f66 2065 6c65 6d65 6e74 7320 696e  r of elements in
+000356e0: 206f 7468 6572 2e20 496e 2074 6869 7320   other. In this 
+000356f0: 6361 7365 2074 6865 2065 6c65 6d65 6e74  case the element
+00035700: 2074 6120 6765 7473 2074 6865 2077 6569   ta gets the wei
+00035710: 6768 743d 3127 0d0a 0909 0909 0972 6169  ght=1'.......rai
+00035720: 7365 2045 780d 0a09 0909 0964 735f 7374  se Ex......ds_st
+00035730: 6163 6b2e 6170 7065 6e64 2864 732a 7765  ack.append(ds*we
+00035740: 6967 6874 735b 695d 290d 0a09 0909 656c  ights[i]).....el
+00035750: 7365 3a0d 0a09 0909 0964 735f 7374 6163  se:......ds_stac
+00035760: 6b2e 6170 7065 6e64 2864 7329 0d0a 0909  k.append(ds)....
+00035770: 0963 5f73 7461 636b 2e61 7070 656e 6428  .c_stack.append(
+00035780: 635f 7465 6d70 290d 0a09 0909 6865 6967  c_temp).....heig
+00035790: 6874 5f73 7461 636b 2e61 7070 656e 6428  ht_stack.append(
+000357a0: 6c65 6e28 635f 7465 6d70 2e69 6e64 6578  len(c_temp.index
+000357b0: 2e76 616c 7565 7329 290d 0a09 0909 0d0a  .values)).......
+000357c0: 0909 415f 636f 6e3d 7061 6e64 6173 2e63  ..A_con=pandas.c
+000357d0: 6f6e 6361 7428 6473 5f73 7461 636b 290d  oncat(ds_stack).
+000357e0: 0a09 0963 5f63 6f6e 3d70 616e 6461 732e  ...c_con=pandas.
+000357f0: 636f 6e63 6174 2863 5f73 7461 636b 290d  concat(c_stack).
+00035800: 0a09 0972 653d 6669 6c6c 5f69 6e74 2864  ...re=fill_int(d
+00035810: 733d 415f 636f 6e2c 633d 635f 636f 6e2c  s=A_con,c=c_con,
+00035820: 2072 6574 7572 6e5f 7368 6170 6573 203d   return_shapes =
+00035830: 2064 756d 705f 7368 6170 6573 2c20 6669   dump_shapes, fi
+00035840: 6e61 6c20 3d66 696e 616c 290d 0a09 0969  nal =final)....i
+00035850: 6620 6669 6e61 6c3a 0d0a 0909 0972 655b  f final:.....re[
+00035860: 2763 275d 3d63 0d0a 0909 6966 2064 756d  'c']=c....if dum
+00035870: 705f 7061 7261 733a 0d0a 0909 0974 7279  p_paras:.....try
+00035880: 3a0d 0a09 0909 0970 6172 6466 2e6c 6f63  :......pardf.loc
+00035890: 5b27 6572 726f 7227 2c27 7661 6c75 6527  ['error','value'
+000358a0: 5d3d 7265 5b27 6572 726f 7227 5d0d 0a09  ]=re['error']...
+000358b0: 0909 6578 6365 7074 3a0d 0a09 0909 0970  ..except:......p
+000358c0: 6173 730d 0a09 0909 6966 2066 696e 616c  ass.....if final
+000358d0: 3a0d 0a09 0909 0974 7279 3a0d 0a09 0909  :......try:.....
+000358e0: 0909 7061 7264 662e 6c6f 635b 2772 3227  ..pardf.loc['r2'
+000358f0: 2c27 7661 6c75 6527 5d3d 312d 7265 5b27  ,'value']=1-re['
+00035900: 6572 726f 7227 5d2f 2828 7265 5b27 4127  error']/((re['A'
+00035910: 5d2d 7265 5b27 4127 5d2e 6d65 616e 2829  ]-re['A'].mean()
+00035920: 2e6d 6561 6e28 2929 2a2a 3229 2e73 756d  .mean())**2).sum
+00035930: 2829 2e73 756d 2829 0d0a 0909 0909 6578  ().sum()......ex
+00035940: 6365 7074 3a0d 0a09 0909 0909 7061 7373  cept:.......pass
+00035950: 0d0a 0909 0974 7279 3a0d 0a09 0909 0969  .....try:......i
+00035960: 6620 6669 6c65 6e61 6d65 2069 7320 4e6f  f filename is No
+00035970: 6e65 3a0d 0a09 0909 0909 7374 6f72 655f  ne:.......store_
+00035980: 6e61 6d65 3d27 6d69 6e69 6d61 6c5f 6475  name='minimal_du
+00035990: 6d70 5f70 6172 6173 2e70 6172 270d 0a09  mp_paras.par'...
+000359a0: 0909 0965 6c73 653a 0d0a 0909 0909 0973  ...else:.......s
+000359b0: 746f 7265 5f6e 616d 653d 276d 696e 696d  tore_name='minim
+000359c0: 616c 5f64 756d 705f 7061 7261 735f 2573  al_dump_paras_%s
+000359d0: 2e70 6172 2725 6669 6c65 6e61 6d65 0d0a  .par'%filename..
+000359e0: 0909 0909 6d69 6e5f 6466 3d70 616e 6461  ....min_df=panda
+000359f0: 732e 7265 6164 5f63 7376 2873 746f 7265  s.read_csv(store
+00035a00: 5f6e 616d 652c 7365 703d 272c 272c 6865  _name,sep=',',he
+00035a10: 6164 6572 3d4e 6f6e 652c 736b 6970 726f  ader=None,skipro
+00035a20: 7773 3d31 290d 0a09 0909 0969 6620 666c  ws=1)......if fl
+00035a30: 6f61 7428 6d69 6e5f 6466 2e69 6c6f 635b  oat(min_df.iloc[
+00035a40: 2d31 2c31 5d29 3e66 6c6f 6174 2863 6f6d  -1,1])>float(com
+00035a50: 6269 6e65 645f 6572 726f 7229 3a0d 0a09  bined_error):...
+00035a60: 0909 0909 7061 7264 662e 746f 5f63 7376  ....pardf.to_csv
+00035a70: 2873 746f 7265 5f6e 616d 6529 0d0a 0909  (store_name)....
+00035a80: 0965 7863 6570 743a 0d0a 0909 0909 7061  .except:......pa
+00035a90: 7373 0d0a 0909 0969 6620 6669 6c65 6e61  ss.....if filena
+00035aa0: 6d65 2069 7320 4e6f 6e65 3a0d 0a09 0909  me is None:.....
+00035ab0: 0973 746f 7265 5f6e 616d 653d 2764 756d  .store_name='dum
+00035ac0: 705f 7061 7261 732e 7061 7227 0d0a 0909  p_paras.par'....
+00035ad0: 0965 6c73 653a 0d0a 0909 0909 7374 6f72  .else:......stor
+00035ae0: 655f 6e61 6d65 3d27 6475 6d70 5f70 6172  e_name='dump_par
+00035af0: 6173 5f25 732e 7061 7227 2566 696c 656e  as_%s.par'%filen
+00035b00: 616d 650d 0a09 0909 7472 793a 0d0a 0909  ame.....try:....
+00035b10: 0909 7061 7264 662e 746f 5f63 7376 2873  ..pardf.to_csv(s
+00035b20: 746f 7265 5f6e 616d 6529 0d0a 0909 0965  tore_name).....e
+00035b30: 7863 6570 743a 0d0a 0909 0909 7072 696e  xcept:......prin
+00035b40: 7428 2753 6176 696e 6720 6f66 2025 7320  t('Saving of %s 
+00035b50: 6661 696c 6564 2725 7374 6f72 655f 6e61  failed'%store_na
+00035b60: 6d65 290d 0a09 090d 0a09 0969 6620 6669  me)........if fi
+00035b70: 6e61 6c3a 0d0a 0909 0969 6620 6973 696e  nal:.....if isin
+00035b80: 7374 616e 6365 286d 6f64 2c74 7970 6528  stance(mod,type(
+00035b90: 2768 656c 6c6f 2729 293a 2364 6964 2077  'hello')):#did w
+00035ba0: 6520 7573 6520 6120 6275 696c 6420 696e  e use a build in
+00035bb0: 206d 6f64 656c 3f09 0d0a 0909 0909 6c61   model?.......la
+00035bc0: 6265 6c73 3d6c 6973 7428 7265 5b27 4441  bels=list(re['DA
+00035bd0: 4327 5d2e 636f 6c75 6d6e 732e 7661 6c75  C'].columns.valu
+00035be0: 6573 290d 0a09 0909 0963 6861 6e67 6564  es)......changed
+00035bf0: 3d54 7275 650d 0a09 0909 0969 6620 2762  =True......if 'b
+00035c00: 6163 6b67 726f 756e 6427 2069 6e20 6c69  ackground' in li
+00035c10: 7374 2870 6172 6466 2e69 6e64 6578 2e76  st(pardf.index.v
+00035c20: 616c 7565 7329 3a0d 0a09 0909 0909 6966  alues):.......if
+00035c30: 2027 696e 6669 6e69 7465 2720 696e 206c   'infinite' in l
+00035c40: 6973 7428 7061 7264 662e 696e 6465 782e  ist(pardf.index.
+00035c50: 7661 6c75 6573 293a 0d0a 0909 0909 0909  values):........
+00035c60: 6c61 6265 6c73 5b2d 315d 3d27 4e6f 6e20  labels[-1]='Non 
+00035c70: 4465 6361 7969 6e67 270d 0a09 0909 0909  Decaying'.......
+00035c80: 096c 6162 656c 735b 2d32 5d3d 2762 6163  .labels[-2]='bac
+00035c90: 6b67 726f 756e 6427 0d0a 0909 0909 0965  kground'.......e
+00035ca0: 6c73 653a 0d0a 0909 0909 0909 6c61 6265  lse:........labe
+00035cb0: 6c73 5b2d 315d 3d27 6261 636b 6772 6f75  ls[-1]='backgrou
+00035cc0: 6e64 270d 0a09 0909 0965 6c73 653a 0d0a  nd'......else:..
+00035cd0: 0909 0909 0969 6620 2769 6e66 696e 6974  .....if 'infinit
+00035ce0: 6527 2069 6e20 6c69 7374 2870 6172 6466  e' in list(pardf
+00035cf0: 2e69 6e64 6578 2e76 616c 7565 7329 3a0d  .index.values):.
+00035d00: 0a09 0909 0909 096c 6162 656c 735b 2d31  .......labels[-1
+00035d10: 5d3d 274e 6f6e 2044 6563 6179 696e 6727  ]='Non Decaying'
+00035d20: 0d0a 0909 0909 0965 6c73 653a 6368 616e  .......else:chan
+00035d30: 6765 643d 4661 6c73 650d 0a09 0909 0969  ged=False......i
+00035d40: 6620 6368 616e 6765 643a 0d0a 0909 0909  f changed:......
+00035d50: 0972 655b 2744 4143 275d 2e63 6f6c 756d  .re['DAC'].colum
+00035d60: 6e73 3d6c 6162 656c 730d 0a09 0909 0909  ns=labels.......
+00035d70: 7265 5b27 6327 5d2e 636f 6c75 6d6e 733d  re['c'].columns=
+00035d80: 6c61 6265 6c73 0d0a 0909 0909 6966 206e  labels......if n
+00035d90: 6f74 2065 7874 5f73 7065 6374 7261 2069  ot ext_spectra i
+00035da0: 7320 4e6f 6e65 3a0d 0a09 0909 0909 666f  s None:.......fo
+00035db0: 7220 636f 6c20 696e 2065 7874 5f73 7065  r col in ext_spe
+00035dc0: 6374 7261 2e63 6f6c 756d 6e73 3a0d 0a09  ctra.columns:...
+00035dd0: 0909 0909 0972 655b 2744 4143 275d 5b63  .....re['DAC'][c
+00035de0: 6f6c 5d3d 6578 745f 7370 6563 7472 612e  ol]=ext_spectra.
+00035df0: 6c6f 635b 3a2c 636f 6c5d 2e76 616c 7565  loc[:,col].value
+00035e00: 730d 0a09 0909 0909 0972 655b 2763 275d  s........re['c']
+00035e10: 5b63 6f6c 5d3d 632e 6c6f 635b 3a2c 636f  [col]=c.loc[:,co
+00035e20: 6c5d 2e76 616c 7565 730d 0a09 0909 0909  l].values.......
+00035e30: 0941 2c42 3d6e 702e 6d65 7368 6772 6964  .A,B=np.meshgrid
+00035e40: 2863 2e6c 6f63 5b3a 2c63 6f6c 5d2e 7661  (c.loc[:,col].va
+00035e50: 6c75 6573 2c65 7874 5f73 7065 6374 7261  lues,ext_spectra
+00035e60: 2e6c 6f63 5b3a 2c63 6f6c 5d2e 7661 6c75  .loc[:,col].valu
+00035e70: 6573 290d 0a09 0909 0909 0943 3d70 616e  es)........C=pan
+00035e80: 6461 732e 4461 7461 4672 616d 6528 2841  das.DataFrame((A
+00035e90: 2a42 292e 542c 696e 6465 783d 632e 696e  *B).T,index=c.in
+00035ea0: 6465 782c 636f 6c75 6d6e 733d 6578 745f  dex,columns=ext_
+00035eb0: 7370 6563 7472 612e 696e 6465 782e 7661  spectra.index.va
+00035ec0: 6c75 6573 290d 0a09 0909 0909 0972 655b  lues)........re[
+00035ed0: 2741 275d 3d72 655b 2741 275d 2b43 0d0a  'A']=re['A']+C..
+00035ee0: 0909 0909 0909 7265 5b27 4143 275d 3d72  ......re['AC']=r
+00035ef0: 655b 2741 4327 5d2b 430d 0a09 0909 656c  e['AC']+C.....el
+00035f00: 7365 3a0d 0a09 0909 0969 6620 6e6f 7420  se:......if not 
+00035f10: 6578 745f 7370 6563 7472 6120 6973 204e  ext_spectra is N
+00035f20: 6f6e 653a 0d0a 0909 0909 0966 6f72 2063  one:.......for c
+00035f30: 6f6c 2069 6e20 6578 745f 7370 6563 7472  ol in ext_spectr
+00035f40: 612e 636f 6c75 6d6e 733a 0d0a 0909 0909  a.columns:......
+00035f50: 0909 7265 5b27 4441 4327 5d5b 636f 6c5d  ..re['DAC'][col]
+00035f60: 3d65 7874 5f73 7065 6374 7261 2e6c 6f63  =ext_spectra.loc
+00035f70: 5b3a 2c63 6f6c 5d2e 7661 6c75 6573 0d0a  [:,col].values..
+00035f80: 0909 0909 0909 7265 5b27 6327 5d5b 636f  ......re['c'][co
+00035f90: 6c5d 3d63 2e6c 6f63 5b3a 2c63 6f6c 5d2e  l]=c.loc[:,col].
+00035fa0: 7661 6c75 6573 0d0a 0909 0909 0909 412c  values........A,
+00035fb0: 423d 6e70 2e6d 6573 6867 7269 6428 632e  B=np.meshgrid(c.
+00035fc0: 6c6f 635b 3a2c 636f 6c5d 2e76 616c 7565  loc[:,col].value
+00035fd0: 732c 6578 745f 7370 6563 7472 612e 6c6f  s,ext_spectra.lo
+00035fe0: 635b 3a2c 636f 6c5d 2e76 616c 7565 7329  c[:,col].values)
+00035ff0: 0d0a 0909 0909 0909 433d 7061 6e64 6173  ........C=pandas
+00036000: 2e44 6174 6146 7261 6d65 2828 412a 4229  .DataFrame((A*B)
+00036010: 2e54 2c69 6e64 6578 3d63 2e69 6e64 6578  .T,index=c.index
+00036020: 2c63 6f6c 756d 6e73 3d65 7874 5f73 7065  ,columns=ext_spe
+00036030: 6374 7261 2e69 6e64 6578 2e76 616c 7565  ctra.index.value
+00036040: 7329 0d0a 0909 0909 0909 7265 5b27 4127  s)........re['A'
+00036050: 5d3d 7265 5b27 4127 5d2b 430d 0a09 0909  ]=re['A']+C.....
+00036060: 0909 0972 655b 2741 4327 5d3d 7265 5b27  ...re['AC']=re['
+00036070: 4143 275d 2b43 0d0a 0909 0909 656c 7365  AC']+C......else
+00036080: 3a0d 0a09 0909 0909 7265 5b27 4441 4327  :.......re['DAC'
+00036090: 5d2e 636f 6c75 6d6e 733d 632e 636f 6c75  ].columns=c.colu
+000360a0: 6d6e 732e 7661 6c75 6573 0d0a 0909 0909  mns.values......
+000360b0: 0972 655b 2763 275d 2e63 6f6c 756d 6e73  .re['c'].columns
+000360c0: 3d63 2e63 6f6c 756d 6e73 2e76 616c 7565  =c.columns.value
+000360d0: 730d 0a09 0909 7265 7475 726e 5f6c 6973  s.....return_lis
+000360e0: 7465 6e3d 5b5d 0d0a 0909 0966 6f72 2069  ten=[].....for i
+000360f0: 2c74 6120 696e 2065 6e75 6d65 7261 7465  ,ta in enumerate
+00036100: 286d 756c 7469 5f70 726f 6a65 6374 293a  (multi_project):
+00036110: 0d0a 0909 0909 7265 5f6c 6f63 616c 3d7b  ......re_local={
+00036120: 7d0d 0a09 0909 0969 6620 693d 3d30 3a0d  }......if i==0:.
+00036130: 0a09 0909 0909 6c6f 7765 723d 300d 0a09  ......lower=0...
+00036140: 0909 0965 6c73 653a 0d0a 0909 0909 096c  ...else:.......l
+00036150: 6f77 6572 3d6e 702e 6172 7261 7928 6865  ower=np.array(he
+00036160: 6967 6874 5f73 7461 636b 295b 3a69 5d2e  ight_stack)[:i].
+00036170: 7375 6d28 290d 0a09 0909 0972 655f 6c6f  sum()......re_lo
+00036180: 6361 6c5b 2741 275d 3d72 655b 2741 275d  cal['A']=re['A']
+00036190: 2e63 6f70 7928 292e 696c 6f63 5b6c 6f77  .copy().iloc[low
+000361a0: 6572 3a6c 6f77 6572 2b68 6569 6768 745f  er:lower+height_
+000361b0: 7374 6163 6b5b 695d 2c3a 5d0d 0a09 0909  stack[i],:].....
+000361c0: 0972 655f 6c6f 6361 6c5b 2741 4327 5d3d  .re_local['AC']=
+000361d0: 7265 5b27 4143 275d 2e63 6f70 7928 292e  re['AC'].copy().
+000361e0: 696c 6f63 5b6c 6f77 6572 3a6c 6f77 6572  iloc[lower:lower
+000361f0: 2b68 6569 6768 745f 7374 6163 6b5b 695d  +height_stack[i]
+00036200: 2c3a 5d0d 0a09 0909 0972 655f 6c6f 6361  ,:]......re_loca
+00036210: 6c5b 2741 4527 5d3d 7265 5b27 4145 275d  l['AE']=re['AE']
+00036220: 2e63 6f70 7928 292e 696c 6f63 5b6c 6f77  .copy().iloc[low
+00036230: 6572 3a6c 6f77 6572 2b68 6569 6768 745f  er:lower+height_
+00036240: 7374 6163 6b5b 695d 2c3a 5d0d 0a09 0909  stack[i],:].....
+00036250: 0972 655f 6c6f 6361 6c5b 2763 275d 3d72  .re_local['c']=r
+00036260: 655b 2763 275d 2e63 6f70 7928 292e 696c  e['c'].copy().il
+00036270: 6f63 5b6c 6f77 6572 3a6c 6f77 6572 2b68  oc[lower:lower+h
+00036280: 6569 6768 745f 7374 6163 6b5b 695d 2c3a  eight_stack[i],:
+00036290: 5d0d 0a09 0909 0972 655f 6c6f 6361 6c5b  ]......re_local[
+000362a0: 2765 7272 6f72 5f74 6f74 616c 275d 3d72  'error_total']=r
+000362b0: 655b 2765 7272 6f72 275d 0d0a 0909 0909  e['error']......
+000362c0: 7265 5f6c 6f63 616c 5b27 6572 726f 7227  re_local['error'
+000362d0: 5d3d 2872 655b 2741 4527 5d2a 2a32 292e  ]=(re['AE']**2).
+000362e0: 7375 6d28 292e 7375 6d28 290d 0a09 0909  sum().sum().....
+000362f0: 0972 655f 6c6f 6361 6c5b 2744 4143 275d  .re_local['DAC']
+00036300: 3d72 655b 2744 4143 275d 2e63 6f70 7928  =re['DAC'].copy(
+00036310: 290d 0a09 0909 0972 655f 6c6f 6361 6c5b  )......re_local[
+00036320: 2772 3227 5d3d 312d 7265 5f6c 6f63 616c  'r2']=1-re_local
+00036330: 5b27 6572 726f 7227 5d2f 2828 7265 5f6c  ['error']/((re_l
+00036340: 6f63 616c 5b27 4127 5d2d 7265 5f6c 6f63  ocal['A']-re_loc
+00036350: 616c 5b27 4127 5d2e 6d65 616e 2829 2e6d  al['A'].mean().m
+00036360: 6561 6e28 2929 2a2a 3229 2e73 756d 2829  ean())**2).sum()
+00036370: 2e73 756d 2829 0d0a 0909 0909 7265 5f6c  .sum()......re_l
+00036380: 6f63 616c 5b27 7232 5f74 6f74 616c 275d  ocal['r2_total']
+00036390: 3d31 2d72 655b 2765 7272 6f72 275d 2f28  =1-re['error']/(
+000363a0: 2872 655b 2741 275d 2d72 655b 2741 275d  (re['A']-re['A']
+000363b0: 2e6d 6561 6e28 292e 6d65 616e 2829 292a  .mean().mean())*
+000363c0: 2a32 292e 7375 6d28 292e 7375 6d28 290d  *2).sum().sum().
+000363d0: 0a09 0909 0972 655f 6c6f 6361 6c5b 2770  .....re_local['p
+000363e0: 6172 6466 275d 3d70 6172 5f73 7461 636b  ardf']=par_stack
+000363f0: 5b69 5d0d 0a09 0909 0974 7279 3a0d 0a09  [i]......try:...
+00036400: 0909 0909 7265 5f6c 6f63 616c 5b27 6669  ....re_local['fi
+00036410: 6c65 6e61 6d65 275d 3d66 696c 656e 616d  lename']=filenam
+00036420: 650d 0a09 0909 0965 7863 6570 743a 0d0a  e......except:..
+00036430: 0909 0909 0970 6173 730d 0a09 0909 0972  .....pass......r
+00036440: 6574 7572 6e5f 6c69 7374 656e 2e61 7070  eturn_listen.app
+00036450: 656e 6428 7265 5f6c 6f63 616c 290d 0a09  end(re_local)...
+00036460: 0969 6620 6e6f 7420 6d6f 6420 696e 205b  .if not mod in [
+00036470: 2770 6172 616c 272c 2765 7870 6f6e 656e  'paral','exponen
+00036480: 7469 616c 272c 2763 6f6e 7365 6375 7469  tial','consecuti
+00036490: 7665 275d 3a0d 0a09 0909 7072 696e 7428  ve']:.....print(
+000364a0: 7265 5b27 6572 726f 7227 5d29 0d0a 0909  re['error'])....
+000364b0: 6966 2066 696e 616c 3a0d 0a09 0909 7265  if final:.....re
+000364c0: 7475 726e 2072 6574 7572 6e5f 6c69 7374  turn return_list
+000364d0: 656e 0d0a 0909 656c 7365 3a0d 0a09 0909  en....else:.....
+000364e0: 7265 7475 726e 2072 655b 2765 7272 6f72  return re['error
+000364f0: 275d 0d0a 0923 2323 2323 2323 2323 2323  ']...###########
+00036500: 2323 2323 2323 2323 2020 206e 6f74 2073  ########   not s
+00036510: 616d 6520 4441 5323 2323 2323 2323 2323  ame DAS#########
+00036520: 2323 2323 2323 2323 2323 230d 0a09 656c  ###########...el
+00036530: 7365 3a0d 0a09 090d 0a09 0966 6f72 2069  se:........for i
+00036540: 2c74 6120 696e 2065 6e75 6d65 7261 7465  ,ta in enumerate
+00036550: 286d 756c 7469 5f70 726f 6a65 6374 293a  (multi_project):
+00036560: 0d0a 0909 0964 7320 3d20 7375 625f 6473  .....ds = sub_ds
+00036570: 2864 7320 3d20 7461 2e64 732c 2073 6361  (ds = ta.ds, sca
+00036580: 7474 6572 6375 7420 3d20 736c 6963 655f  ttercut = slice_
+00036590: 7365 7474 696e 675f 6f62 6a65 6374 2e73  setting_object.s
+000365a0: 6361 7474 6572 6375 742c 2062 6f72 6465  cattercut, borde
+000365b0: 7263 7574 203d 2073 6c69 6365 5f73 6574  rcut = slice_set
+000365c0: 7469 6e67 5f6f 626a 6563 742e 626f 7264  ting_object.bord
+000365d0: 6572 6375 742c 200d 0a09 0909 0909 0974  ercut, ........t
+000365e0: 696d 656c 696d 6974 7320 3d20 736c 6963  imelimits = slic
+000365f0: 655f 7365 7474 696e 675f 6f62 6a65 6374  e_setting_object
+00036600: 2e74 696d 656c 696d 6974 732c 2077 6176  .timelimits, wav
+00036610: 655f 6e6d 5f62 696e 203d 2073 6c69 6365  e_nm_bin = slice
+00036620: 5f73 6574 7469 6e67 5f6f 626a 6563 742e  _setting_object.
+00036630: 7761 7665 5f6e 6d5f 6269 6e2c 200d 0a09  wave_nm_bin, ...
+00036640: 0909 0909 0974 696d 655f 6269 6e20 3d20  .....time_bin = 
+00036650: 736c 6963 655f 7365 7474 696e 675f 6f62  slice_setting_ob
+00036660: 6a65 6374 2e74 696d 655f 6269 6e2c 2069  ject.time_bin, i
+00036670: 676e 6f72 655f 7469 6d65 5f72 6567 696f  gnore_time_regio
+00036680: 6e20 3d20 736c 6963 655f 7365 7474 696e  n = slice_settin
+00036690: 675f 6f62 6a65 6374 2e69 676e 6f72 655f  g_object.ignore_
+000366a0: 7469 6d65 5f72 6567 696f 6e29 090d 0a09  time_region)....
+000366b0: 0909 7061 7264 663d 7061 7264 665f 6368  ..pardf=pardf_ch
+000366c0: 616e 6769 6e67 2e63 6f70 7928 290d 0a09  anging.copy()...
+000366d0: 0909 7472 793a 236c 6574 2773 2073 6565  ..try:#let's see
+000366e0: 2069 6620 7468 6520 7072 6f6a 6563 7420   if the project 
+000366f0: 6861 7320 616e 2070 6172 616d 6574 6572  has an parameter
+00036700: 206f 626a 6563 740d 0a09 0909 0970 6172   object......par
+00036710: 6466 5f6f 7269 3d70 6172 5f74 6f5f 7061  df_ori=par_to_pa
+00036720: 7264 6628 7461 2e70 6172 290d 0a09 0909  rdf(ta.par).....
+00036730: 6578 6365 7074 3a0d 0a09 0909 0970 6172  except:......par
+00036740: 6466 5f6f 7269 3d70 6172 6466 0d0a 0909  df_ori=pardf....
+00036750: 0969 6620 756e 6971 7565 5f70 6172 616d  .if unique_param
+00036760: 6574 6572 2069 7320 6e6f 7420 4e6f 6e65  eter is not None
+00036770: 3a0d 0a09 0909 0966 6f72 206b 6579 2069  :......for key i
+00036780: 6e20 756e 6971 7565 5f70 6172 616d 6574  n unique_paramet
+00036790: 6572 3a0d 0a09 0909 0909 7061 7264 662e  er:.......pardf.
+000367a0: 6c6f 635b 6b65 792c 2776 616c 7565 275d  loc[key,'value']
+000367b0: 3d70 6172 6466 5f6f 7269 2e6c 6f63 5b6b  =pardf_ori.loc[k
+000367c0: 6579 2c27 7661 6c75 6527 5d09 0d0a 0909  ey,'value'].....
+000367d0: 0969 6620 6c6f 675f 6669 743a 0d0a 0909  .if log_fit:....
+000367e0: 0909 7061 7264 662e 6c6f 635b 7061 7264  ..pardf.loc[pard
+000367f0: 662e 6973 5f72 6174 652c 2776 616c 7565  f.is_rate,'value
+00036800: 275d 3d70 6172 6466 2e6c 6f63 5b70 6172  ']=pardf.loc[par
+00036810: 6466 2e69 735f 7261 7465 2c27 7661 6c75  df.is_rate,'valu
+00036820: 6527 5d2e 6170 706c 7928 6c61 6d62 6461  e'].apply(lambda
+00036830: 2078 3a20 3130 2a2a 7829 0d0a 0d0a 0909   x: 10**x)......
+00036840: 0969 6620 6973 696e 7374 616e 6365 286d  .if isinstance(m
+00036850: 6f64 2c74 7970 6528 2768 656c 6c6f 2729  od,type('hello')
+00036860: 293a 2364 6964 2077 6520 7573 6520 6120  ):#did we use a 
+00036870: 6275 696c 6420 696e 206d 6f64 656c 3f0d  build in model?.
+00036880: 0a09 0909 0963 3d62 7569 6c64 5f63 2874  .....c=build_c(t
+00036890: 696d 6573 3d64 732e 696e 6465 782e 7661  imes=ds.index.va
+000368a0: 6c75 6573 2e61 7374 7970 6528 2766 6c6f  lues.astype('flo
+000368b0: 6174 2729 2c6d 6f64 3d6d 6f64 2c70 6172  at'),mod=mod,par
+000368c0: 6466 3d70 6172 6466 290d 0a09 0909 0969  df=pardf)......i
+000368d0: 6620 6578 745f 7370 6563 7472 6120 6973  f ext_spectra is
+000368e0: 204e 6f6e 653a 0d0a 0909 0909 0972 653d   None:.......re=
+000368f0: 6669 6c6c 5f69 6e74 2864 733d 6473 2c63  fill_int(ds=ds,c
+00036900: 3d63 2c20 7265 7475 726e 5f73 6861 7065  =c, return_shape
+00036910: 7320 3d20 6475 6d70 5f73 6861 7065 7329  s = dump_shapes)
+00036920: 0d0a 0909 0909 656c 7365 3a0d 0a09 0909  ......else:.....
+00036930: 0909 6578 745f 7370 6563 7472 613d 7265  ..ext_spectra=re
+00036940: 6269 6e28 6578 745f 7370 6563 7472 612c  bin(ext_spectra,
+00036950: 6473 2e63 6f6c 756d 6e73 2e76 616c 7565  ds.columns.value
+00036960: 732e 6173 7479 7065 2866 6c6f 6174 2929  s.astype(float))
+00036970: 0d0a 0909 0909 0963 5f74 656d 703d 632e  .......c_temp=c.
+00036980: 636f 7079 2829 0d0a 0909 0909 0966 6f72  copy().......for
+00036990: 2063 6f6c 2069 6e20 6578 745f 7370 6563   col in ext_spec
+000369a0: 7472 612e 636f 6c75 6d6e 733a 0d0a 0909  tra.columns:....
+000369b0: 0909 0909 412c 423d 6e70 2e6d 6573 6867  ....A,B=np.meshg
+000369c0: 7269 6428 632e 6c6f 635b 3a2c 636f 6c5d  rid(c.loc[:,col]
+000369d0: 2e76 616c 7565 732c 6578 745f 7370 6563  .values,ext_spec
+000369e0: 7472 612e 6c6f 635b 3a2c 636f 6c5d 2e76  tra.loc[:,col].v
+000369f0: 616c 7565 7329 0d0a 0909 0909 0909 433d  alues)........C=
+00036a00: 7061 6e64 6173 2e44 6174 6146 7261 6d65  pandas.DataFrame
+00036a10: 2828 412a 4229 2e54 2c69 6e64 6578 3d63  ((A*B).T,index=c
+00036a20: 2e69 6e64 6578 2c63 6f6c 756d 6e73 3d65  .index,columns=e
+00036a30: 7874 5f73 7065 6374 7261 2e69 6e64 6578  xt_spectra.index
+00036a40: 2e76 616c 7565 7329 0d0a 0909 0909 0909  .values)........
+00036a50: 6473 3d64 732d 430d 0a09 0909 0909 0963  ds=ds-C........c
+00036a60: 5f74 656d 702e 6472 6f70 2863 6f6c 2c61  _temp.drop(col,a
+00036a70: 7869 733d 312c 696e 706c 6163 653d 5472  xis=1,inplace=Tr
+00036a80: 7565 290d 0a09 0909 0909 7265 3d66 696c  ue).......re=fil
+00036a90: 6c5f 696e 7428 6473 3d64 732c 633d 635f  l_int(ds=ds,c=c_
+00036aa0: 7465 6d70 2c20 7265 7475 726e 5f73 6861  temp, return_sha
+00036ab0: 7065 7320 3d20 6475 6d70 5f73 6861 7065  pes = dump_shape
+00036ac0: 7329 0d0a 0909 0909 6966 2066 696e 616c  s)......if final
+00036ad0: 3a0d 0a09 0909 0909 6966 2069 3d3d 303a  :.......if i==0:
+00036ae0: 0d0a 0909 0909 0909 6c61 6265 6c73 3d6c  ........labels=l
+00036af0: 6973 7428 7265 5b27 4441 4327 5d2e 636f  ist(re['DAC'].co
+00036b00: 6c75 6d6e 732e 7661 6c75 6573 290d 0a09  lumns.values)...
+00036b10: 0909 0909 0963 6861 6e67 6564 3d54 7275  .....changed=Tru
+00036b20: 650d 0a09 0909 0909 0969 6620 2762 6163  e........if 'bac
+00036b30: 6b67 726f 756e 6427 2069 6e20 6c69 7374  kground' in list
+00036b40: 2870 6172 6466 2e69 6e64 6578 2e76 616c  (pardf.index.val
+00036b50: 7565 7329 3a0d 0a09 0909 0909 0909 6966  ues):.........if
+00036b60: 2027 696e 6669 6e69 7465 2720 696e 206c   'infinite' in l
+00036b70: 6973 7428 7061 7264 662e 696e 6465 782e  ist(pardf.index.
+00036b80: 7661 6c75 6573 293a 0d0a 0909 0909 0909  values):........
+00036b90: 0909 6c61 6265 6c73 5b2d 315d 3d27 4e6f  ..labels[-1]='No
+00036ba0: 6e20 4465 6361 7969 6e67 270d 0a09 0909  n Decaying'.....
+00036bb0: 0909 0909 096c 6162 656c 735b 2d32 5d3d  .....labels[-2]=
+00036bc0: 2762 6163 6b67 726f 756e 6427 0d0a 0909  'background'....
 00036bd0: 0909 0909 0965 6c73 653a 0d0a 0909 0909  .....else:......
-00036be0: 0909 0969 6620 2769 6e66 696e 6974 6527  ...if 'infinite'
-00036bf0: 2069 6e20 6c69 7374 2870 6172 6466 2e69   in list(pardf.i
-00036c00: 6e64 6578 2e76 616c 7565 7329 3a0d 0a09  ndex.values):...
-00036c10: 0909 0909 0909 096c 6162 656c 735b 2d31  .......labels[-1
-00036c20: 5d3d 274e 6f6e 2044 6563 6179 696e 6727  ]='Non Decaying'
-00036c30: 0d0a 0909 0920 2020 0d0a 0909 0909 0909  .....   ........
-00036c40: 0965 6c73 653a 6368 616e 6765 643d 4661  .else:changed=Fa
-00036c50: 6c73 650d 0a09 0909 0909 0969 6620 6368  lse........if ch
-00036c60: 616e 6765 643a 0d0a 0909 0909 0909 0972  anged:.........r
-00036c70: 655b 2744 4143 275d 2e63 6f6c 756d 6e73  e['DAC'].columns
-00036c80: 3d6c 6162 656c 730d 0a09 0909 0909 0909  =labels.........
-00036c90: 7265 5b27 6327 5d2e 636f 6c75 6d6e 733d  re['c'].columns=
-00036ca0: 6c61 6265 6c73 0d0a 0909 0909 0909 6966  labels........if
-00036cb0: 206e 6f74 2065 7874 5f73 7065 6374 7261   not ext_spectra
-00036cc0: 2069 7320 4e6f 6e65 3a0d 0a09 0909 0909   is None:.......
-00036cd0: 0909 666f 7220 636f 6c20 696e 2065 7874  ..for col in ext
-00036ce0: 5f73 7065 6374 7261 2e63 6f6c 756d 6e73  _spectra.columns
-00036cf0: 3a0d 0a09 0909 0909 0909 0972 655b 2744  :..........re['D
-00036d00: 4143 275d 5b63 6f6c 5d3d 6578 745f 7370  AC'][col]=ext_sp
-00036d10: 6563 7472 612e 6c6f 635b 3a2c 636f 6c5d  ectra.loc[:,col]
-00036d20: 2e76 616c 7565 730d 0a09 0909 0909 0909  .values.........
-00036d30: 0972 655b 2763 275d 5b63 6f6c 5d3d 632e  .re['c'][col]=c.
-00036d40: 6c6f 635b 3a2c 636f 6c5d 2e76 616c 7565  loc[:,col].value
-00036d50: 730d 0a09 0909 0909 0909 0941 2c42 3d6e  s..........A,B=n
-00036d60: 702e 6d65 7368 6772 6964 2863 2e6c 6f63  p.meshgrid(c.loc
-00036d70: 5b3a 2c63 6f6c 5d2e 7661 6c75 6573 2c65  [:,col].values,e
-00036d80: 7874 5f73 7065 6374 7261 2e6c 6f63 5b3a  xt_spectra.loc[:
-00036d90: 2c63 6f6c 5d2e 7661 6c75 6573 290d 0a09  ,col].values)...
-00036da0: 0909 0909 0909 0943 3d70 616e 6461 732e  .......C=pandas.
-00036db0: 4461 7461 4672 616d 6528 2841 2a42 292e  DataFrame((A*B).
-00036dc0: 542c 696e 6465 783d 632e 696e 6465 782c  T,index=c.index,
-00036dd0: 636f 6c75 6d6e 733d 6578 745f 7370 6563  columns=ext_spec
-00036de0: 7472 612e 696e 6465 782e 7661 6c75 6573  tra.index.values
-00036df0: 290d 0a09 0909 0909 0909 0972 655b 2741  )..........re['A
-00036e00: 275d 3d72 655b 2741 275d 2b43 0d0a 0909  ']=re['A']+C....
-00036e10: 0909 0909 0909 7265 5b27 4143 275d 3d72  ......re['AC']=r
-00036e20: 655b 2741 4327 5d2b 4309 0d0a 0909 0909  e['AC']+C.......
-00036e30: 0909 7265 5f66 696e 616c 3d72 652e 636f  ..re_final=re.co
-00036e40: 7079 2829 0d0a 0909 0909 0965 7272 6f72  py().......error
-00036e50: 5f6c 6973 7465 6e2e 6170 7065 6e64 2872  _listen.append(r
-00036e60: 655b 2765 7272 6f72 275d 290d 0a09 0909  e['error']).....
-00036e70: 0909 7232 5f6c 6973 7465 6e2e 6170 7065  ..r2_listen.appe
-00036e80: 6e64 2831 2d72 655b 2765 7272 6f72 275d  nd(1-re['error']
-00036e90: 2f28 2872 655b 2741 275d 2d72 655b 2741  /((re['A']-re['A
-00036ea0: 275d 2e6d 6561 6e28 292e 6d65 616e 2829  '].mean().mean()
-00036eb0: 292a 2a32 292e 7375 6d28 292e 7375 6d28  )**2).sum().sum(
-00036ec0: 2929 0d0a 0909 0909 656c 7365 3a0d 0a09  ))......else:...
-00036ed0: 0909 0909 6966 2064 756d 705f 7368 6170  ....if dump_shap
-00036ee0: 6573 3a0d 0a09 0909 0909 0972 655b 2763  es:........re['c
-00036ef0: 275d 2e74 6f5f 6373 7628 7061 7468 5f6f  '].to_csv(path_o
-00036f00: 725f 6275 663d 7461 2e66 696c 656e 616d  r_buf=ta.filenam
-00036f10: 6520 2b20 275f 6327 290d 0a09 0909 0909  e + '_c').......
-00036f20: 0972 655b 2744 4143 275d 2e74 6f5f 6373  .re['DAC'].to_cs
-00036f30: 7628 7061 7468 5f6f 725f 6275 663d 7461  v(path_or_buf=ta
-00036f40: 2e66 696c 656e 616d 6520 2b20 275f 4441  .filename + '_DA
-00036f50: 4327 290d 0a09 0909 0909 6572 726f 725f  C').......error_
-00036f60: 6c69 7374 656e 2e61 7070 656e 6428 7265  listen.append(re
-00036f70: 5b27 6572 726f 7227 5d29 0d0a 0909 0965  ['error']).....e
-00036f80: 6c73 653a 0d0a 0909 0909 633d 6d6f 6428  lse:......c=mod(
-00036f90: 7469 6d65 733d 6473 2e69 6e64 6578 2e76  times=ds.index.v
-00036fa0: 616c 7565 732e 6173 7479 7065 2827 666c  alues.astype('fl
-00036fb0: 6f61 7427 292c 7061 7264 663d 7061 7264  oat'),pardf=pard
-00036fc0: 662e 6c6f 635b 3a2c 2776 616c 7565 275d  f.loc[:,'value']
-00036fd0: 290d 0a09 0909 0969 6620 6578 745f 7370  )......if ext_sp
-00036fe0: 6563 7472 6120 6973 204e 6f6e 653a 0d0a  ectra is None:..
-00036ff0: 0909 0909 0972 653d 6669 6c6c 5f69 6e74  .....re=fill_int
-00037000: 2864 733d 6473 2c63 3d63 2c20 7265 7475  (ds=ds,c=c, retu
-00037010: 726e 5f73 6861 7065 7320 3d20 6475 6d70  rn_shapes = dump
-00037020: 5f73 6861 7065 7329 0d0a 0909 0909 656c  _shapes)......el
-00037030: 7365 3a0d 0a09 0909 0909 6578 745f 7370  se:.......ext_sp
-00037040: 6563 7472 613d 7265 6269 6e28 6578 745f  ectra=rebin(ext_
-00037050: 7370 6563 7472 612c 6473 2e63 6f6c 756d  spectra,ds.colum
-00037060: 6e73 2e76 616c 7565 732e 6173 7479 7065  ns.values.astype
-00037070: 2866 6c6f 6174 2929 0d0a 0909 0909 0963  (float)).......c
-00037080: 5f74 656d 703d 632e 636f 7079 2829 0d0a  _temp=c.copy()..
-00037090: 0909 0909 0966 6f72 2063 6f6c 2069 6e20  .....for col in 
-000370a0: 6578 745f 7370 6563 7472 612e 636f 6c75  ext_spectra.colu
-000370b0: 6d6e 733a 0d0a 0909 0909 0909 412c 423d  mns:........A,B=
-000370c0: 6e70 2e6d 6573 6867 7269 6428 632e 6c6f  np.meshgrid(c.lo
-000370d0: 635b 3a2c 636f 6c5d 2e76 616c 7565 732c  c[:,col].values,
-000370e0: 6578 745f 7370 6563 7472 612e 6c6f 635b  ext_spectra.loc[
-000370f0: 3a2c 636f 6c5d 2e76 616c 7565 7329 0d0a  :,col].values)..
-00037100: 0909 0909 0909 433d 7061 6e64 6173 2e44  ......C=pandas.D
-00037110: 6174 6146 7261 6d65 2828 412a 4229 2e54  ataFrame((A*B).T
-00037120: 2c69 6e64 6578 3d63 2e69 6e64 6578 2c63  ,index=c.index,c
-00037130: 6f6c 756d 6e73 3d65 7874 5f73 7065 6374  olumns=ext_spect
-00037140: 7261 2e69 6e64 6578 2e76 616c 7565 7329  ra.index.values)
-00037150: 0d0a 0909 0909 0909 6473 3d64 732d 430d  ........ds=ds-C.
-00037160: 0a09 0909 0909 0963 5f74 656d 702e 6472  .......c_temp.dr
-00037170: 6f70 2863 6f6c 2c61 7869 733d 312c 696e  op(col,axis=1,in
-00037180: 706c 6163 653d 5472 7565 290d 0a09 0909  place=True).....
-00037190: 0909 7265 3d66 696c 6c5f 696e 7428 6473  ..re=fill_int(ds
-000371a0: 3d64 732c 633d 635f 7465 6d70 2c20 7265  =ds,c=c_temp, re
-000371b0: 7475 726e 5f73 6861 7065 7320 3d20 6475  turn_shapes = du
-000371c0: 6d70 5f73 6861 7065 7329 0d0a 0909 0909  mp_shapes)......
-000371d0: 6966 2066 696e 616c 3a0d 0a09 0909 0909  if final:.......
-000371e0: 6966 2069 3d3d 303a 0d0a 0909 0909 0909  if i==0:........
-000371f0: 7265 5b27 4441 4327 5d2e 636f 6c75 6d6e  re['DAC'].column
-00037200: 733d 632e 636f 6c75 6d6e 732e 7661 6c75  s=c.columns.valu
-00037210: 6573 0d0a 0909 0909 0909 7265 5b27 6327  es........re['c'
-00037220: 5d2e 636f 6c75 6d6e 733d 632e 636f 6c75  ].columns=c.colu
-00037230: 6d6e 732e 7661 6c75 6573 0d0a 0909 0909  mns.values......
-00037240: 0909 6966 206e 6f74 2065 7874 5f73 7065  ..if not ext_spe
-00037250: 6374 7261 2069 7320 4e6f 6e65 3a0d 0a09  ctra is None:...
-00037260: 0909 0909 0909 666f 7220 636f 6c20 696e  ......for col in
-00037270: 2065 7874 5f73 7065 6374 7261 2e63 6f6c   ext_spectra.col
-00037280: 756d 6e73 3a0d 0a09 0909 0909 0909 0972  umns:..........r
-00037290: 655b 2744 4143 275d 5b63 6f6c 5d3d 6578  e['DAC'][col]=ex
-000372a0: 745f 7370 6563 7472 612e 6c6f 635b 3a2c  t_spectra.loc[:,
-000372b0: 636f 6c5d 2e76 616c 7565 730d 0a09 0909  col].values.....
-000372c0: 0909 0909 0972 655b 2763 275d 5b63 6f6c  .....re['c'][col
-000372d0: 5d3d 632e 6c6f 635b 3a2c 636f 6c5d 2e76  ]=c.loc[:,col].v
-000372e0: 616c 7565 730d 0a09 0909 0909 0909 0941  alues..........A
-000372f0: 2c42 3d6e 702e 6d65 7368 6772 6964 2863  ,B=np.meshgrid(c
-00037300: 2e6c 6f63 5b3a 2c63 6f6c 5d2e 7661 6c75  .loc[:,col].valu
-00037310: 6573 2c65 7874 5f73 7065 6374 7261 2e6c  es,ext_spectra.l
-00037320: 6f63 5b3a 2c63 6f6c 5d2e 7661 6c75 6573  oc[:,col].values
-00037330: 290d 0a09 0909 0909 0909 0943 3d70 616e  )..........C=pan
-00037340: 6461 732e 4461 7461 4672 616d 6528 2841  das.DataFrame((A
-00037350: 2a42 292e 542c 696e 6465 783d 632e 696e  *B).T,index=c.in
-00037360: 6465 782c 636f 6c75 6d6e 733d 6578 745f  dex,columns=ext_
-00037370: 7370 6563 7472 612e 696e 6465 782e 7661  spectra.index.va
-00037380: 6c75 6573 290d 0a09 0909 0909 0909 0972  lues)..........r
-00037390: 655b 2741 275d 3d72 655b 2741 275d 2b43  e['A']=re['A']+C
-000373a0: 0d0a 0909 0909 0909 0909 7265 5b27 4143  ..........re['AC
-000373b0: 275d 3d72 655b 2741 4327 5d2b 4309 0d0a  ']=re['AC']+C...
-000373c0: 0909 0909 0909 7265 5f66 696e 616c 3d72  ......re_final=r
-000373d0: 652e 636f 7079 2829 0d0a 0909 0909 0965  e.copy().......e
-000373e0: 7272 6f72 5f6c 6973 7465 6e2e 6170 7065  rror_listen.appe
-000373f0: 6e64 2872 655b 2765 7272 6f72 275d 290d  nd(re['error']).
-00037400: 0a09 0909 0909 7232 5f6c 6973 7465 6e2e  ......r2_listen.
-00037410: 6170 7065 6e64 2831 2d72 655b 2765 7272  append(1-re['err
-00037420: 6f72 275d 2f28 2872 655b 2741 275d 2d72  or']/((re['A']-r
-00037430: 655b 2741 275d 2e6d 6561 6e28 292e 6d65  e['A'].mean().me
-00037440: 616e 2829 292a 2a32 292e 7375 6d28 292e  an())**2).sum().
-00037450: 7375 6d28 2929 0d0a 0909 0909 656c 7365  sum())......else
-00037460: 3a0d 0a09 0909 0909 6966 2064 756d 705f  :.......if dump_
-00037470: 7368 6170 6573 3a0d 0a09 0909 0909 0972  shapes:........r
-00037480: 655b 2763 275d 2e74 6f5f 6373 7628 7061  e['c'].to_csv(pa
-00037490: 7468 5f6f 725f 6275 663d 6669 6c65 6e61  th_or_buf=filena
-000374a0: 6d65 202b 2027 5f63 2729 0d0a 0909 0909  me + '_c')......
-000374b0: 0909 7265 5b27 4441 4327 5d2e 746f 5f63  ..re['DAC'].to_c
-000374c0: 7376 2870 6174 685f 6f72 5f62 7566 3d66  sv(path_or_buf=f
-000374d0: 696c 656e 616d 6520 2b20 275f 4441 4327  ilename + '_DAC'
-000374e0: 290d 0a09 0909 0909 6572 726f 725f 6c69  ).......error_li
-000374f0: 7374 656e 2e61 7070 656e 6428 7265 5b27  sten.append(re['
-00037500: 6572 726f 7227 5d29 0d0a 0909 6966 206e  error'])....if n
-00037510: 6f74 2077 6569 6768 7473 2069 7320 4e6f  ot weights is No
-00037520: 6e65 3a0d 0a09 0909 6966 206c 656e 2877  ne:.....if len(w
-00037530: 6569 6768 7473 293d 3d6c 656e 2865 7272  eights)==len(err
-00037540: 6f72 5f6c 6973 7465 6e29 2d31 3a0d 0a09  or_listen)-1:...
-00037550: 0909 0977 6569 6768 7473 3d6c 6973 7428  ...weights=list(
-00037560: 7765 6967 6874 7329 0d0a 0909 0909 7765  weights)......we
-00037570: 6967 6874 732e 696e 7365 7274 2830 2c31  ights.insert(0,1
-00037580: 290d 0a09 0909 656c 6966 206c 656e 2877  ).....elif len(w
-00037590: 6569 6768 7473 2921 3d6c 656e 2865 7272  eights)!=len(err
-000375a0: 6f72 5f6c 6973 7465 6e29 3a0d 0a09 0909  or_listen):.....
-000375b0: 0945 7820 3d20 5661 6c75 6545 7272 6f72  .Ex = ValueError
-000375c0: 2829 0d0a 0909 0909 4578 2e73 7472 6572  ()......Ex.strer
-000375d0: 726f 723d 2754 6865 206e 756d 6265 7220  ror='The number 
-000375e0: 6f66 2065 6e74 7269 6573 2069 2074 6865  of entries i the
-000375f0: 206c 6973 7420 6d75 7374 2065 6974 6865   list must eithe
-00037600: 7220 6265 2074 6865 206e 756d 6265 7220  r be the number 
-00037610: 6f66 2061 6c6c 2065 6c65 6d65 6e74 7320  of all elements 
-00037620: 2869 6e63 6c75 6469 6e67 205c 2254 415c  (including \"TA\
-00037630: 2220 6f72 2074 6865 206e 756d 6265 7220  " or the number 
-00037640: 6f66 2065 6c65 6d65 6e74 7320 696e 206f  of elements in o
-00037650: 7468 6572 2e20 496e 2074 6869 7320 6361  ther. In this ca
-00037660: 7365 2074 6865 2065 6c65 6d65 6e74 2074  se the element t
-00037670: 6120 6765 7473 2074 6865 2077 6569 6768  a gets the weigh
-00037680: 743d 3127 0d0a 0909 0909 7261 6973 6520  t=1'......raise 
-00037690: 4578 0d0a 0909 0963 6f6d 6269 6e65 645f  Ex.....combined_
-000376a0: 6572 726f 723d 6e70 2e73 7172 7428 2828  error=np.sqrt(((
-000376b0: 6e70 2e61 7272 6179 2865 7272 6f72 5f6c  np.array(error_l
-000376c0: 6973 7465 6e29 2a6e 702e 6172 7261 7928  isten)*np.array(
-000376d0: 7765 6967 6874 7329 292a 2a32 292e 6d65  weights))**2).me
-000376e0: 616e 2829 290d 0a09 0909 6966 2066 696e  an()).....if fin
-000376f0: 616c 3a0d 0a09 0909 0963 6f6d 6269 6e65  al:......combine
-00037700: 645f 7232 3d6e 702e 7371 7274 2828 286e  d_r2=np.sqrt(((n
-00037710: 702e 6172 7261 7928 7232 5f6c 6973 7465  p.array(r2_liste
-00037720: 6e29 2a6e 702e 6172 7261 7928 7765 6967  n)*np.array(weig
-00037730: 6874 7329 292a 2a32 292e 6d65 616e 2829  hts))**2).mean()
-00037740: 290d 0a09 0965 6c73 653a 0d0a 0909 0963  )....else:.....c
-00037750: 6f6d 6269 6e65 645f 6572 726f 723d 6e70  ombined_error=np
-00037760: 2e73 7172 7428 286e 702e 6172 7261 7928  .sqrt((np.array(
-00037770: 6572 726f 725f 6c69 7374 656e 292a 2a32  error_listen)**2
-00037780: 292e 6d65 616e 2829 290d 0a09 0909 6966  ).mean()).....if
-00037790: 2066 696e 616c 3a0d 0a09 0909 0963 6f6d   final:......com
-000377a0: 6269 6e65 645f 7232 3d6e 702e 7371 7274  bined_r2=np.sqrt
-000377b0: 2828 286e 702e 6172 7261 7928 7232 5f6c  (((np.array(r2_l
-000377c0: 6973 7465 6e29 292a 2a32 292e 6d65 616e  isten))**2).mean
-000377d0: 2829 290d 0a09 0969 6620 6669 6e61 6c3a  ())....if final:
-000377e0: 0d0a 0909 0972 655f 6669 6e61 6c5b 2765  .....re_final['e
-000377f0: 7272 6f72 275d 3d63 6f6d 6269 6e65 645f  rror']=combined_
-00037800: 6572 726f 720d 0a09 0909 7265 5f66 696e  error.....re_fin
-00037810: 616c 5b27 7232 275d 3d63 6f6d 6269 6e65  al['r2']=combine
-00037820: 645f 7232 0d0a 0909 6966 2064 756d 705f  d_r2....if dump_
-00037830: 7061 7261 733a 0d0a 0909 0974 7279 3a0d  paras:.....try:.
-00037840: 0a09 0909 0970 6172 6466 2e6c 6f63 5b27  .....pardf.loc['
-00037850: 6572 726f 7227 2c27 7661 6c75 6527 5d3d  error','value']=
-00037860: 636f 6d62 696e 6564 5f65 7272 6f72 0d0a  combined_error..
-00037870: 0909 0965 7863 6570 743a 0d0a 0909 0909  ...except:......
-00037880: 7061 7373 0d0a 0909 0974 7279 3a0d 0a09  pass.....try:...
-00037890: 0909 0970 6172 6466 2e6c 6f63 5b27 7232  ...pardf.loc['r2
-000378a0: 272c 2776 616c 7565 275d 3d63 6f6d 6269  ','value']=combi
-000378b0: 6e65 645f 7232 0d0a 0909 0965 7863 6570  ned_r2.....excep
-000378c0: 743a 0d0a 0909 0909 7061 7373 0d0a 0909  t:......pass....
-000378d0: 0974 7279 3a0d 0a09 0909 0969 6620 6669  .try:......if fi
-000378e0: 6c65 6e61 6d65 2069 7320 4e6f 6e65 3a0d  lename is None:.
-000378f0: 0a09 0909 0909 7374 6f72 655f 6e61 6d65  ......store_name
-00037900: 3d27 6d69 6e69 6d61 6c5f 6475 6d70 5f70  ='minimal_dump_p
-00037910: 6172 6173 2e70 6172 270d 0a09 0909 0965  aras.par'......e
-00037920: 6c73 653a 0d0a 0909 0909 0973 746f 7265  lse:.......store
-00037930: 5f6e 616d 653d 276d 696e 696d 616c 5f64  _name='minimal_d
-00037940: 756d 705f 7061 7261 735f 2573 2e70 6172  ump_paras_%s.par
-00037950: 2725 6669 6c65 6e61 6d65 0d0a 0909 0909  '%filename......
-00037960: 6d69 6e5f 6466 3d70 616e 6461 732e 7265  min_df=pandas.re
-00037970: 6164 5f63 7376 2873 746f 7265 5f6e 616d  ad_csv(store_nam
-00037980: 652c 7365 703d 272c 272c 6865 6164 6572  e,sep=',',header
-00037990: 3d4e 6f6e 652c 736b 6970 726f 7773 3d31  =None,skiprows=1
-000379a0: 290d 0a09 0909 0969 6620 666c 6f61 7428  )......if float(
-000379b0: 6d69 6e5f 6466 2e69 6c6f 635b 2d31 2c31  min_df.iloc[-1,1
-000379c0: 5d29 3e66 6c6f 6174 2863 6f6d 6269 6e65  ])>float(combine
-000379d0: 645f 6572 726f 7229 3a0d 0a09 0909 0909  d_error):.......
-000379e0: 7061 7264 662e 746f 5f63 7376 2873 746f  pardf.to_csv(sto
-000379f0: 7265 5f6e 616d 6529 0d0a 0909 0965 7863  re_name).....exc
-00037a00: 6570 743a 0d0a 0909 0909 7061 7373 0d0a  ept:......pass..
-00037a10: 0909 0969 6620 6669 6c65 6e61 6d65 2069  ...if filename i
-00037a20: 7320 4e6f 6e65 3a0d 0a09 0909 0973 746f  s None:......sto
-00037a30: 7265 5f6e 616d 653d 2764 756d 705f 7061  re_name='dump_pa
-00037a40: 7261 732e 7061 7227 0d0a 0909 0965 6c73  ras.par'.....els
-00037a50: 653a 0d0a 0909 0909 7374 6f72 655f 6e61  e:......store_na
-00037a60: 6d65 3d27 6475 6d70 5f70 6172 6173 5f25  me='dump_paras_%
-00037a70: 732e 7061 7227 2566 696c 656e 616d 650d  s.par'%filename.
-00037a80: 0a09 0909 7472 793a 0d0a 0909 0909 7061  ....try:......pa
-00037a90: 7264 662e 746f 5f63 7376 2873 746f 7265  rdf.to_csv(store
-00037aa0: 5f6e 616d 6529 0d0a 0909 0965 7863 6570  _name).....excep
-00037ab0: 743a 0d0a 0909 0909 7072 696e 7428 2753  t:......print('S
-00037ac0: 6176 696e 6720 6f66 2025 7320 6661 696c  aving of %s fail
-00037ad0: 6564 2725 7374 6f72 655f 6e61 6d65 290d  ed'%store_name).
-00037ae0: 0a09 0969 6620 6e6f 7420 6d6f 6420 696e  ...if not mod in
-00037af0: 205b 2770 6172 616c 272c 2765 7870 6f6e   ['paral','expon
-00037b00: 656e 7469 616c 272c 2763 6f6e 7365 6375  ential','consecu
-00037b10: 7469 7665 275d 3a0d 0a09 0909 7072 696e  tive']:.....prin
-00037b20: 7428 636f 6d62 696e 6564 5f65 7272 6f72  t(combined_error
-00037b30: 290d 0a09 0969 6620 6669 6e61 6c3a 0d0a  )....if final:..
-00037b40: 0909 0972 6574 7572 6e20 7265 5f66 696e  ...return re_fin
-00037b50: 616c 0d0a 0909 656c 7365 3a0d 0a09 0909  al....else:.....
-00037b60: 7265 7475 726e 2063 6f6d 6269 6e65 645f  return combined_
-00037b70: 6572 726f 720d 0a0d 0a0d 0a64 6566 2070  error......def p
-00037b80: 6172 5f74 6f5f 7061 7264 6628 7061 7229  ar_to_pardf(par)
-00037b90: 3a0d 0a09 2727 2766 756e 6374 696f 6e20  :...'''function 
-00037ba0: 746f 2063 6f6e 7665 7274 2061 2070 6172  to convert a par
-00037bb0: 616d 6574 6572 7320 6f62 6a65 6374 2069  ameters object i
-00037bc0: 6e74 6f20 6120 7072 6574 7479 2044 6174  nto a pretty Dat
-00037bd0: 6146 7261 6d65 2c20 6974 2065 7870 6563  aFrame, it expec
-00037be0: 7473 2070 6172 2074 6f20 6265 2061 206c  ts par to be a l
-00037bf0: 6d66 6974 2070 6172 616d 6574 6572 7320  mfit parameters 
-00037c00: 6f62 6a65 6374 2061 6e64 206c 6f6f 7073  object and loops
-00037c10: 2074 6872 6f75 6768 2074 6865 206b 6579   through the key
-00037c20: 7327 2727 0d0a 096f 7574 5f64 6963 7465  s'''...out_dicte
-00037c30: 6e3d 7b7d 0d0a 0966 6f72 206b 6579 2069  n={}...for key i
-00037c40: 6e20 7061 722e 6b65 7973 2829 3a0d 0a09  n par.keys():...
-00037c50: 096f 7574 5f64 6963 7465 6e5b 6b65 795d  .out_dicten[key]
-00037c60: 3d7b 2776 616c 7565 273a 7061 725b 6b65  ={'value':par[ke
-00037c70: 795d 2e76 616c 7565 7d0d 0a09 0969 6620  y].value}....if 
-00037c80: 6b65 795b 305d 203d 3d20 276b 273a 2369  key[0] == 'k':#i
-00037c90: 7473 2061 2074 696d 6520 7061 7261 6d65  ts a time parame
-00037ca0: 7465 720d 0a09 0909 6f75 745f 6469 6374  ter.....out_dict
-00037cb0: 656e 5b6b 6579 5d5b 2769 735f 7261 7465  en[key]['is_rate
-00037cc0: 275d 3d54 7275 650d 0a09 0965 6c73 653a  ']=True....else:
-00037cd0: 0d0a 0909 096f 7574 5f64 6963 7465 6e5b  .....out_dicten[
-00037ce0: 6b65 795d 5b27 6973 5f72 6174 6527 5d3d  key]['is_rate']=
-00037cf0: 4661 6c73 650d 0a09 096f 7574 5f64 6963  False....out_dic
-00037d00: 7465 6e5b 6b65 795d 5b27 6d69 6e27 5d3d  ten[key]['min']=
-00037d10: 7061 725b 6b65 795d 2e6d 696e 0d0a 0909  par[key].min....
-00037d20: 6f75 745f 6469 6374 656e 5b6b 6579 5d5b  out_dicten[key][
-00037d30: 276d 6178 275d 3d70 6172 5b6b 6579 5d2e  'max']=par[key].
-00037d40: 6d61 780d 0a09 096f 7574 5f64 6963 7465  max....out_dicte
-00037d50: 6e5b 6b65 795d 5b27 7661 7279 275d 3d70  n[key]['vary']=p
-00037d60: 6172 5b6b 6579 5d2e 7661 7279 0d0a 0909  ar[key].vary....
-00037d70: 6f75 745f 6469 6374 656e 5b6b 6579 5d5b  out_dicten[key][
-00037d80: 2765 7870 7227 5d3d 7061 725b 6b65 795d  'expr']=par[key]
-00037d90: 2e65 7870 720d 0a09 7265 7475 726e 2070  .expr...return p
-00037da0: 616e 6461 732e 4461 7461 4672 616d 6528  andas.DataFrame(
-00037db0: 6f75 745f 6469 6374 656e 292e 540d 0a0d  out_dicten).T...
-00037dc0: 0a0d 0a64 6566 2070 6172 6466 5f74 6f5f  ...def pardf_to_
-00037dd0: 7061 7228 7061 725f 6466 293a 0d0a 0927  par(par_df):...'
-00037de0: 2727 636f 6e76 6572 7473 2061 2064 6174  ''converts a dat
-00037df0: 6166 7261 6d65 2074 6f20 6c6d 6669 7420  aframe to lmfit 
-00037e00: 6f62 6a65 6374 0d0a 0973 6574 2876 616c  object...set(val
-00037e10: 7565 3d4e 6f6e 652c 2076 6172 793d 4e6f  ue=None, vary=No
-00037e20: 6e65 2c20 6d69 6e3d 4e6f 6e65 2c20 6d61  ne, min=None, ma
-00037e30: 783d 4e6f 6e65 2c20 6578 7072 3d4e 6f6e  x=None, expr=Non
-00037e40: 652c 2062 7275 7465 5f73 7465 703d 4e6f  e, brute_step=No
-00037e50: 6e65 2927 2727 0d0a 0970 6172 3d6c 6d66  ne)'''...par=lmf
-00037e60: 6974 2e50 6172 616d 6574 6572 7328 290d  it.Parameters().
-00037e70: 0a09 666f 7220 6b65 7920 696e 2070 6172  ..for key in par
-00037e80: 5f64 662e 696e 6465 782e 7661 6c75 6573  _df.index.values
-00037e90: 3a0d 0a09 0970 6172 2e61 6464 286b 6579  :....par.add(key
-00037ea0: 2c20 7661 6c75 653d 7061 725f 6466 2e6c  , value=par_df.l
-00037eb0: 6f63 5b6b 6579 2c27 7661 6c75 6527 5d2c  oc[key,'value'],
-00037ec0: 2076 6172 793d 7061 725f 6466 2e6c 6f63   vary=par_df.loc
-00037ed0: 5b6b 6579 2c27 7661 7279 275d 2c20 6d69  [key,'vary'], mi
-00037ee0: 6e3d 7061 725f 6466 2e6c 6f63 5b6b 6579  n=par_df.loc[key
-00037ef0: 2c27 6d69 6e27 5d2c 206d 6178 3d70 6172  ,'min'], max=par
-00037f00: 5f64 662e 6c6f 635b 6b65 792c 276d 6178  _df.loc[key,'max
-00037f10: 275d 2c20 6578 7072 3d70 6172 5f64 662e  '], expr=par_df.
-00037f20: 6c6f 635b 6b65 792c 2765 7870 7227 5d29  loc[key,'expr'])
-00037f30: 0909 0909 0909 0909 0909 0909 0909 0920  ............... 
-00037f40: 0d0a 0972 6574 7572 6e20 7061 720d 0a09  ...return par...
-00037f50: 0d0a 090d 0a64 6566 2070 6172 6466 5f74  .....def pardf_t
-00037f60: 6f5f 7469 6d65 6466 2870 6172 6466 293a  o_timedf(pardf):
-00037f70: 0d0a 0927 2727 696e 7665 7274 7320 616c  ...'''inverts al
-00037f80: 6c20 7468 6520 7261 7465 7320 746f 2074  l the rates to t
-00037f90: 696d 6573 2069 6e20 6120 6461 7461 6672  imes in a datafr
-00037fa0: 616d 6527 2727 0d0a 0974 696d 6564 663d  ame'''...timedf=
-00037fb0: 7061 7264 662e 636f 7079 2829 0d0a 0969  pardf.copy()...i
-00037fc0: 6620 2775 7070 6572 5f6c 696d 6974 2720  f 'upper_limit' 
-00037fd0: 696e 2070 6172 6466 2e6b 6579 7328 293a  in pardf.keys():
-00037fe0: 0d0a 0909 666f 7220 6b65 7920 696e 205b  ....for key in [
-00037ff0: 2769 6e69 745f 7661 6c75 6527 2c27 7661  'init_value','va
-00038000: 6c75 6527 2c27 6d69 6e27 2c27 6d61 7827  lue','min','max'
-00038010: 2c27 6c6f 7765 725f 6c69 6d69 7427 2c27  ,'lower_limit','
-00038020: 7570 7065 725f 6c69 6d69 7427 5d3a 0d0a  upper_limit']:..
-00038030: 0909 0966 6f72 2072 6f77 2069 6e20 7061  ...for row in pa
-00038040: 7264 662e 696e 6465 782e 7661 6c75 6573  rdf.index.values
-00038050: 3a0d 0a09 0909 0969 6620 7469 6d65 6466  :......if timedf
-00038060: 2e6c 6f63 5b72 6f77 2c27 6973 5f72 6174  .loc[row,'is_rat
-00038070: 6527 5d3a 0d0a 0909 0909 0969 6620 6b65  e']:.......if ke
-00038080: 7920 3d3d 2027 6d69 6e27 3a6b 6579 5f69  y == 'min':key_i
-00038090: 6e3d 276d 6178 270d 0a09 0909 0909 656c  n='max'.......el
-000380a0: 6966 206b 6579 203d 3d20 276d 6178 273a  if key == 'max':
-000380b0: 6b65 795f 696e 3d27 6d69 6e27 0d0a 0909  key_in='min'....
-000380c0: 0909 0965 6c69 6620 6b65 7920 3d3d 2027  ...elif key == '
-000380d0: 6c6f 7765 725f 6c69 6d69 7427 3a6b 6579  lower_limit':key
-000380e0: 5f69 6e3d 2775 7070 6572 5f6c 696d 6974  _in='upper_limit
-000380f0: 270d 0a09 0909 0909 656c 6966 206b 6579  '.......elif key
-00038100: 203d 3d20 2775 7070 6572 5f6c 696d 6974   == 'upper_limit
-00038110: 273a 6b65 795f 696e 3d27 6c6f 7765 725f  ':key_in='lower_
-00038120: 6c69 6d69 7427 0d0a 0909 0909 0965 6c73  limit'.......els
-00038130: 653a 6b65 795f 696e 3d6b 6579 0d0a 0909  e:key_in=key....
-00038140: 0909 0974 7279 3a0d 0a09 0909 0909 0969  ...try:........i
-00038150: 6620 7061 7264 662e 6c6f 635b 726f 772c  f pardf.loc[row,
-00038160: 6b65 795d 2021 3d30 3a0d 0a09 0909 0909  key] !=0:.......
-00038170: 0909 7469 6d65 6466 2e6c 6f63 5b72 6f77  ..timedf.loc[row
-00038180: 2c6b 6579 5f69 6e5d 3d31 2f70 6172 6466  ,key_in]=1/pardf
-00038190: 2e6c 6f63 5b72 6f77 2c6b 6579 5d20 0d0a  .loc[row,key] ..
-000381a0: 0909 0909 0909 656c 7365 3a0d 0a09 0909  ......else:.....
-000381b0: 0909 0909 7469 6d65 6466 2e6c 6f63 5b72  ....timedf.loc[r
-000381c0: 6f77 2c6b 6579 5f69 6e5d 3d27 696e 6627  ow,key_in]='inf'
-000381d0: 0d0a 0909 0909 0965 7863 6570 743a 0d0a  .......except:..
-000381e0: 0909 0909 0909 6966 206b 6579 203d 3d20  ......if key == 
-000381f0: 2769 6e69 745f 7661 6c75 6527 3a70 6173  'init_value':pas
-00038200: 7323 7765 2064 6f6e 2774 2073 6176 6520  s#we don't save 
-00038210: 7468 6520 696e 6974 2076 616c 7565 732c  the init values,
-00038220: 2073 6f20 7765 2067 6574 2061 6e20 6572   so we get an er
-00038230: 726f 7220 7768 656e 2063 6f6e 7665 7274  ror when convert
-00038240: 696e 6720 7468 6520 7361 7665 6420 6669  ing the saved fi
-00038250: 6c65 0d0a 0909 0909 0909 656c 6966 2070  le........elif p
-00038260: 6172 6466 2e6c 6f63 5b72 6f77 2c6b 6579  ardf.loc[row,key
-00038270: 5d20 6973 204e 6f6e 653a 636f 6e74 696e  ] is None:contin
-00038280: 7565 0d0a 0909 0909 0909 656c 7365 3a70  ue........else:p
-00038290: 7269 6e74 2827 636f 6e76 6572 7369 6f6e  rint('conversion
-000382a0: 206f 6620 7468 6973 206b 6579 2066 6169   of this key fai
-000382b0: 6c65 643a 2025 7320 2573 2725 2872 6f77  led: %s %s'%(row
-000382c0: 2c6b 6579 2929 0d0a 0965 6c73 653a 0d0a  ,key))...else:..
-000382d0: 0909 666f 7220 6b65 7920 696e 205b 2769  ..for key in ['i
-000382e0: 6e69 745f 7661 6c75 6527 2c27 7661 6c75  nit_value','valu
-000382f0: 6527 2c27 6d69 6e27 2c27 6d61 7827 5d3a  e','min','max']:
-00038300: 0d0a 0909 0969 6620 6b65 7920 3d3d 2027  .....if key == '
-00038310: 6d69 6e27 3a6b 6579 5f69 6e3d 276d 6178  min':key_in='max
-00038320: 2709 0920 0d0a 0909 0965 6c69 6620 6b65  '.. .....elif ke
-00038330: 7920 3d3d 2027 6d61 7827 3a6b 6579 5f69  y == 'max':key_i
-00038340: 6e3d 276d 696e 270d 0a09 0909 656c 7365  n='min'.....else
-00038350: 3a6b 6579 5f69 6e3d 6b65 790d 0a09 0909  :key_in=key.....
-00038360: 7472 793a 0d0a 0909 0909 7469 6d65 6466  try:......timedf
-00038370: 2e6c 6f63 5b70 6172 6466 2e69 735f 7261  .loc[pardf.is_ra
-00038380: 7465 2c6b 6579 5f69 6e5d 3d70 6172 6466  te,key_in]=pardf
-00038390: 2e6c 6f63 5b70 6172 6466 2e69 735f 7261  .loc[pardf.is_ra
-000383a0: 7465 2c6b 6579 5d2e 6170 706c 7928 6c61  te,key].apply(la
-000383b0: 6d62 6461 2078 3a20 312f 7820 6966 2078  mbda x: 1/x if x
-000383c0: 213d 3020 2065 6c73 6520 2769 6e66 2729  !=0  else 'inf')
-000383d0: 0d0a 0909 0965 7863 6570 743a 0d0a 0909  .....except:....
-000383e0: 0909 6966 206b 6579 203d 3d20 2769 6e69  ..if key == 'ini
-000383f0: 745f 7661 6c75 6527 3a70 6173 7323 7765  t_value':pass#we
-00038400: 2064 6f6e 2774 2073 6176 6520 7468 6520   don't save the 
-00038410: 696e 6974 2076 616c 7565 732c 2073 6f20  init values, so 
-00038420: 7765 2067 6574 2061 6e20 6572 726f 7220  we get an error 
-00038430: 7768 656e 2063 6f6e 7665 7274 696e 6720  when converting 
-00038440: 7468 6520 7361 7665 6420 6669 6c65 0d0a  the saved file..
-00038450: 0909 0909 656c 7365 3a70 7269 6e74 2827  ....else:print('
-00038460: 636f 6e76 6572 7369 6f6e 206f 6620 7468  conversion of th
-00038470: 6973 206b 6579 2066 6169 6c65 643a 2720  is key failed:' 
-00038480: 2b20 6b65 7929 0d0a 0972 6574 7572 6e20  + key)...return 
-00038490: 7469 6d65 6466 0d0a 0d0a 0d0a 636c 6173  timedf......clas
-000384a0: 7320 5441 2829 3a09 2320 6f62 6a65 6374  s TA():.# object
-000384b0: 2077 7261 7070 6572 2066 6f72 2074 6865   wrapper for the
-000384c0: 2077 686f 6c65 0d0a 0964 6566 205f 5f69   whole...def __i
-000384d0: 6e69 745f 5f28 7365 6c66 2c20 6669 6c65  nit__(self, file
-000384e0: 6e61 6d65 2c20 7061 7468 203d 204e 6f6e  name, path = Non
-000384f0: 652c 2073 6570 203d 2022 5c74 222c 2064  e, sep = "\t", d
-00038500: 6563 696d 616c 203d 2027 2e27 2c20 696e  ecimal = '.', in
-00038510: 6465 785f 6973 5f65 6e65 7267 7920 3d20  dex_is_energy = 
-00038520: 4661 6c73 652c 2074 7261 6e73 706f 7365  False, transpose
-00038530: 203d 2046 616c 7365 2c0d 0a09 0909 0973   = False,......s
-00038540: 6f72 745f 696e 6465 7865 7320 3d20 4661  ort_indexes = Fa
-00038550: 6c73 652c 2064 6976 6964 655f 7469 6d65  lse, divide_time
-00038560: 735f 6279 203d 204e 6f6e 652c 2073 6869  s_by = None, shi
-00038570: 6674 5f74 696d 6573 5f62 7920 3d20 4e6f  ft_times_by = No
-00038580: 6e65 2c20 6578 7465 726e 616c 5f74 696d  ne, external_tim
-00038590: 6520 3d20 4e6f 6e65 2c20 6578 7465 726e  e = None, extern
-000385a0: 616c 5f77 6176 6520 3d20 4e6f 6e65 2c20  al_wave = None, 
-000385b0: 0d0a 0909 0909 7573 655f 7361 6d65 5f6e  ......use_same_n
-000385c0: 616d 6520 3d20 5472 7565 2c20 6461 7461  ame = True, data
-000385d0: 5f74 7970 6520 3d20 4e6f 6e65 202c 2075  _type = None , u
-000385e0: 6e69 7473 203d 204e 6f6e 652c 2062 6173  nits = None, bas
-000385f0: 6575 6e69 7420 3d20 4e6f 6e65 2c20 6473  eunit = None, ds
-00038600: 203d 204e 6f6e 652c 2063 6f6e 7665 7273   = None, convers
-00038610: 696f 6e5f 6675 6e63 7469 6f6e 203d 204e  ion_function = N
-00038620: 6f6e 6529 3a09 0920 0d0a 0909 2727 2746  one):.. ....'''F
-00038630: 756e 6374 696f 6e20 7468 6174 206f 7065  unction that ope
-00038640: 6e73 2061 6e64 2069 6d70 6f72 7473 2064  ns and imports d
-00038650: 6174 6120 696e 746f 2061 6e20 5441 206f  ata into an TA o
-00038660: 626a 6563 740d 0a09 0969 7420 6973 2064  bject....it is d
-00038670: 6573 6967 6e65 6420 746f 206f 7065 6e20  esigned to open 
-00038680: 636f 6d62 696e 6564 2066 696c 6573 2074  combined files t
-00038690: 6861 7420 636f 6e74 6169 6e20 626f 7468  hat contain both
-000386a0: 2074 6865 2077 6176 656c 656e 6774 6820   the wavelength 
-000386b0: 616e 6420 7468 6520 7469 6d65 2e20 2865  and the time. (e
-000386c0: 2e67 2e20 5349 4120 6669 6c65 7320 6173  .g. SIA files as
-000386d0: 2072 6563 6f72 6465 6420 6279 2050 6173   recorded by Pas
-000386e0: 6368 6572 2069 6e73 7472 756d 656e 7473  cher instruments
-000386f0: 2073 6f66 7477 6172 6529 206f 7220 6864   software) or hd
-00038700: 6635 2070 726f 6a65 6374 7320 7361 7665  f5 projects save
-00038710: 6420 6279 2074 6869 7320 736f 6674 7761  d by this softwa
-00038720: 7265 0d0a 0909 5468 6572 6520 6172 6520  re....There are 
-00038730: 686f 7765 7665 7220 6120 6c6f 7420 6f66  however a lot of
-00038740: 2061 6464 6974 696f 6e61 6c20 6f70 7469   additional opti
-00038750: 6f6e 7320 746f 206f 7065 6e20 6f74 6865  ons to open othe
-00038760: 7220 6173 6369 6920 7479 7065 2066 696c  r ascii type fil
-00038770: 6573 2061 6e64 2061 6461 7074 2074 6865  es and adapt the
-00038780: 6972 2066 6f72 6d61 7420 696e 7465 726e  ir format intern
-00038790: 616c 6c79 0d0a 0909 4174 7465 6e74 696f  ally....Attentio
-000387a0: 6e20 7469 6d65 7320 7769 7468 204e 616e  n times with Nan
-000387b0: 2077 696c 6c20 6265 2063 6f6d 706c 6574   will be complet
-000387c0: 656c 7920 7265 6d6f 7665 6420 6475 7269  ely removed duri
-000387d0: 6e67 2074 6865 2069 6d70 6f72 740d 0a09  ng the import...
-000387e0: 090d 0a09 0950 6172 616d 6574 6572 730d  .....Parameters.
-000387f0: 0a09 092d 2d2d 2d2d 2d2d 2d2d 2d0d 0a09  ...----------...
-00038800: 090d 0a09 0966 696c 656e 616d 6520 3a20  .....filename : 
-00038810: 7374 720d 0a09 0909 0d0a 0909 092a 2065  str..........* e
-00038820: 7870 6563 7473 2061 2066 696c 656e 616d  xpects a filenam
-00038830: 6520 696e 2073 7472 696e 6720 666f 726d  e in string form
-00038840: 2066 6f72 206f 7065 6e69 6e67 2061 2073   for opening a s
-00038850: 696e 676c 6520 6669 6c65 2e20 0d0a 0909  ingle file. ....
-00038860: 092a 2061 6c74 6572 6e61 7469 7665 6c79  .* alternatively
-00038870: 2027 6775 6927 2063 616e 2062 6520 7365   'gui' can be se
-00038880: 7420 6173 2066 696c 656e 616d 652c 2074  t as filename, t
-00038890: 6865 6e20 6120 544b 696e 7465 7220 6775  hen a TKinter gu
-000388a0: 6920 6973 206f 7065 6e65 6420 666f 7220  i is opened for 
-000388b0: 7365 6c65 6374 2e0d 0a09 0909 2a20 616c  select......* al
-000388c0: 7465 726e 6174 6976 656c 7920 2772 6563  ternatively 'rec
-000388d0: 656e 7427 2063 616e 2067 6976 656e 2061  ent' can given a
-000388e0: 7320 6b65 7920 776f 7264 2e20 696e 2074  s key word. in t
-000388f0: 6869 7320 6361 7365 2069 7420 7472 6965  his case it trie
-00038900: 7320 746f 2066 696e 6420 6120 7465 7874  s to find a text
-00038910: 2066 696c 6520 6e61 6d65 6420 2272 6563   file named "rec
-00038920: 656e 742e 6461 7422 2074 6861 7420 7368  ent.dat" that sh
-00038930: 6f75 6c64 2063 6f6e 7461 696e 2074 6865  ould contain the
-00038940: 2070 6174 6820 746f 2074 6865 206c 6173   path to the las
-00038950: 7420 6669 6c65 206f 7065 6e65 6420 7769  t file opened wi
-00038960: 7468 2074 6865 2047 5549 2e20 7468 6973  th the GUI. this
-00038970: 2066 696c 6520 6973 2074 6865 6e20 6f70   file is then op
-00038980: 656e 6564 2e20 6966 2074 6869 7320 6669  ened. if this fi
-00038990: 6c65 2069 7320 6e6f 7420 666f 756e 6420  le is not found 
-000389a0: 7468 6520 4755 4920 6973 206f 7065 6e65  the GUI is opene
-000389b0: 6420 696e 7374 6561 640d 0a09 090d 0a09  d instead.......
-000389c0: 0970 6174 6820 3a20 7374 7220 6f72 2070  .path : str or p
-000389d0: 6174 6820 6f62 6a65 6374 2028 6f70 7469  ath object (opti
-000389e0: 6f6e 616c 290d 0a09 0909 6966 2070 6174  onal).....if pat
-000389f0: 6820 6973 2061 2073 7472 696e 6720 7769  h is a string wi
-00038a00: 7468 6f75 7420 7468 6520 6f70 6572 6174  thout the operat
-00038a10: 696f 6e20 7379 7374 656d 2064 6570 656e  ion system depen
-00038a20: 6465 6e74 2073 6570 6172 6174 6f72 2c20  dent separator, 
-00038a30: 6974 2069 7320 7472 6561 7465 6420 6173  it is treated as
-00038a40: 2061 2072 656c 6174 6976 6520 7061 7468   a relative path
-00038a50: 2c20 0d0a 0909 0965 2e67 2e20 6461 7461  , .....e.g. data
-00038a60: 2077 696c 6c20 6c6f 6f6b 2066 726f 6d20   will look from 
-00038a70: 7468 6520 776f 726b 696e 6720 6469 7265  the working dire
-00038a80: 6374 6f72 7920 696e 2074 6865 2073 7562  ctory in the sub
-00038a90: 2064 6972 6563 746f 7220 6461 7461 2e20   director data. 
-00038aa0: 4f74 6865 7277 6973 6520 7468 6973 2068  Otherwise this h
-00038ab0: 6173 2074 6f20 6265 2061 200d 0a09 0909  as to be a .....
-00038ac0: 6675 6c6c 2070 6174 6820 696e 2065 6974  full path in eit
-00038ad0: 6865 7220 7374 726f 6e67 206f 7220 7061  her strong or pa
-00038ae0: 7468 206f 626a 6563 7420 666f 726d 2e0d  th object form..
-00038af0: 0a09 090d 0a09 0973 6570 203a 2073 7472  .......sep : str
-00038b00: 2028 6f70 7469 6f6e 616c 290d 0a09 0909   (optional).....
-00038b10: 6973 2074 6865 2073 6570 6172 6174 6f72  is the separator
-00038b20: 2062 6574 7765 656e 2064 6966 6665 7265   between differe
-00038b30: 6e74 206e 756d 6265 7273 2c20 7479 7069  nt numbers, typi
-00038b40: 6361 6c20 6172 6520 7461 7020 2842 6163  cal are tap (Bac
-00038b50: 6b73 6c61 7368 2074 2920 2844 6566 6175  kslash t) (Defau
-00038b60: 6c74 2920 2c6f 6e65 206f 7220 0d0a 0909  lt) ,one or ....
-00038b70: 096d 756c 7469 706c 6520 7768 6974 6520  .multiple white 
-00038b80: 7370 6163 6573 2027 6261 636b 736c 6173  spaces 'backslas
-00038b90: 6820 732b 2720 6f72 2063 6f6d 6d61 2027  h s+' or comma '
-00038ba0: 2c27 2e0d 0a09 090d 0a09 0964 6563 696d  ,'.........decim
-00038bb0: 616c 203a 2073 7472 2028 6f70 7469 6f6e  al : str (option
-00038bc0: 616c 2920 0d0a 0909 0973 6574 7320 7468  al) .....sets th
-00038bd0: 6520 6173 6369 6920 7379 6d62 6f6c 2074  e ascii symbol t
-00038be0: 6861 7420 6973 2075 7365 6420 666f 7220  hat is used for 
-00038bf0: 7468 6520 6465 6369 6d61 6c20 7369 676e  the decimal sign
-00038c00: 2e20 496e 206d 6f73 7420 636f 756e 7472  . In most countr
-00038c10: 6965 7320 7468 6973 2069 7320 272e 2728  ies this is '.'(
-00038c20: 4465 6661 756c 7429 200d 0a09 0909 6275  Default) .....bu
-00038c30: 7420 6974 2063 616e 2062 6520 272c 2720  t it can be ',' 
-00038c40: 696e 2063 6f75 6e74 7269 6573 206c 696b  in countries lik
-00038c50: 6520 5377 6564 656e 206f 7220 4765 726d  e Sweden or Germ
-00038c60: 616e 790d 0a09 090d 0a09 0969 6e64 6578  any........index
-00038c70: 5f69 735f 656e 6572 6779 203a 2062 6f6f  _is_energy : boo
-00038c80: 6c20 286f 7074 696f 6e61 6c29 0d0a 0909  l (optional)....
-00038c90: 0973 7769 7463 6865 7320 6966 2074 6865  .switches if the
-00038ca0: 2077 6176 656c 656e 6774 6820 6973 2067   wavelength is g
-00038cb0: 6976 656e 2069 6e20 6e6d 2028 4465 6661  iven in nm (Defa
-00038cc0: 756c 7429 206f 7220 696e 2065 5620 2869  ult) or in eV (i
-00038cd0: 6620 5472 7565 292c 2063 7572 7265 6e74  f True), current
-00038ce0: 6c79 2065 7665 7279 7468 696e 6720 0d0a  ly everything ..
-00038cf0: 0909 0969 7320 6861 6e64 6c65 6420 6173  ...is handled as
-00038d00: 2077 6176 656c 656e 6774 6820 696e 206e   wavelength in n
-00038d10: 6d20 696e 7465 726e 616c 6c79 0d0a 0909  m internally....
-00038d20: 0d0a 0909 6461 7461 5f74 7970 653a 2073  ....data_type: s
-00038d30: 7472 2028 6f70 7469 6f6e 616c 290d 0a09  tr (optional)...
-00038d40: 0909 6461 7461 5f74 7970 6520 6973 2074  ..data_type is t
-00038d50: 6865 2073 7472 696e 6720 7468 6174 2072  he string that r
-00038d60: 6570 7265 7365 6e74 7320 7468 6520 696e  epresents the in
-00038d70: 7465 6e73 6974 7920 6d65 6173 7572 656d  tensity measurem
-00038d80: 656e 7473 2e20 5573 7561 6c6c 7920 7468  ents. Usually th
-00038d90: 6973 2063 6f6e 7461 696e 7320 6966 2061  is contains if a
-00038da0: 6273 6f6c 7574 6520 0d0a 0909 096f 6620  bsolute .....of 
-00038db0: 6469 6666 6572 656e 7469 616c 2064 6174  differential dat
-00038dc0: 612e 2054 6869 7320 6973 2075 7365 6420  a. This is used 
-00038dd0: 666f 7220 7468 6520 636f 6c6f 7220 696e  for the color in
-00038de0: 7465 6e73 6974 7920 696e 2074 6865 2032  tensity in the 2
-00038df0: 6420 706c 6f74 7320 616e 6420 7468 6520  d plots and the 
-00038e00: 792d 6178 6973 2066 6f72 2074 6865 2031  y-axis for the 1
-00038e10: 6420 706c 6f74 730d 0a09 0909 0d0a 0909  d plots.........
-00038e20: 756e 6974 733a 2073 7472 2028 6f70 7469  units: str (opti
-00038e30: 6f6e 616c 290d 0a09 0909 7468 6973 2069  onal).....this i
-00038e40: 7320 7573 6564 2074 6f20 6964 656e 7469  s used to identi
-00038e50: 6679 2074 6865 2075 6e69 7473 206f 6e20  fy the units on 
-00038e60: 7468 6520 656e 6572 6779 2061 7869 7320  the energy axis 
-00038e70: 616e 6420 746f 206c 6162 656c 2074 6865  and to label the
-00038e80: 2073 6c69 6365 732c 2072 6563 6f67 6e69   slices, recogni
-00038e90: 7a65 6420 6973 2027 6e6d 272c 2027 6556  zed is 'nm', 'eV
-00038ea0: 2720 616e 6420 276b 6556 2720 0d0a 0909  ' and 'keV' ....
-00038eb0: 0962 7574 2069 6620 616e 6f74 6865 7220  .but if another 
-00038ec0: 756e 6974 206c 696b 6520 2763 6d5e 2d31  unit like 'cm^-1
-00038ed0: 2720 6973 2075 7365 6420 6974 2077 696c  ' is used it wil
-00038ee0: 6c20 7374 6174 6520 656e 6572 6779 2069  l state energy i
-00038ef0: 6e20 2763 6d5e 2d31 272e 2050 6c65 6173  n 'cm^-1'. Pleas
-00038f00: 206f 6273 6572 7665 2074 6861 7420 6966   observe that if
-00038f10: 2079 6f75 2075 7365 2074 6865 2069 6e64   you use the ind
-00038f20: 6578 5f69 735f 656e 6572 6779 0d0a 0909  ex_is_energy....
-00038f30: 0973 7769 7463 6820 7468 6520 7072 6f67  .switch the prog
-00038f40: 7261 6d20 7472 6965 7320 746f 2063 6f6e  ram tries to con
-00038f50: 7665 7274 2074 6869 7320 656e 6572 6779  vert this energy
-00038f60: 2069 6e74 6f20 7761 7665 6c65 6e67 7468   into wavelength
-00038f70: 2e20 0d0a 0909 090d 0a09 0962 6173 6575  . .........baseu
-00038f80: 6e69 743a 2073 7472 2028 6f70 7469 6f6e  nit: str (option
-00038f90: 616c 290d 0a09 0909 7468 6973 2069 7320  al).....this is 
-00038fa0: 7573 6564 2074 6f20 6964 656e 7469 6679  used to identify
-00038fb0: 2074 6865 2075 6e69 7473 206f 6e20 7468   the units on th
-00038fc0: 6520 6465 7665 6c6f 7069 6e67 2f74 696d  e developing/tim
-00038fd0: 6520 6178 6973 2e20 5468 6973 2069 7320  e axis. This is 
-00038fe0: 6e61 6d65 2074 6861 7420 6973 2061 7474  name that is att
-00038ff0: 6163 6865 6420 746f 2074 6865 2069 6e64  ached to the ind
-00039000: 6578 206f 6620 7468 6520 6461 7461 6672  ex of the datafr
-00039010: 616d 652e 200d 0a09 0909 7365 7474 696e  ame. .....settin
-00039020: 6720 7468 6973 2064 7572 696e 6720 696d  g this during im
-00039030: 706f 7274 2069 7320 6571 7569 7661 6c65  port is equivale
-00039040: 6e74 2074 6f20 7461 2e62 6173 6575 6e69  nt to ta.baseuni
-00039050: 740d 0a09 090d 0a09 0974 7261 6e73 706f  t........transpo
-00039060: 7365 203a 2062 6f6f 6c20 286f 7074 696f  se : bool (optio
-00039070: 6e61 6c29 0d0a 0909 0969 6620 7468 6973  nal).....if this
-00039080: 2073 7769 7463 6820 6973 2046 616c 7365   switch is False
-00039090: 2028 4465 6661 756c 7429 2074 6865 2077   (Default) the w
-000390a0: 6176 656c 656e 6774 6820 6172 6520 7468  avelength are th
-000390b0: 6520 636f 6c75 6d6e 7320 616e 6420 7468  e columns and th
-000390c0: 6520 726f 7773 2074 6865 2074 696d 6573  e rows the times
-000390d0: 2e0d 0a09 090d 0a09 0973 6f72 745f 696e  .........sort_in
-000390e0: 6465 7865 7320 3a20 626f 6f6c 2028 6f70  dexes : bool (op
-000390f0: 7469 6f6e 616c 290d 0a09 0909 466f 7220  tional).....For 
-00039100: 4661 6c73 6520 2844 6566 6175 6c74 2920  False (Default) 
-00039110: 4920 6173 7375 6d65 2074 6861 7420 7468  I assume that th
-00039120: 6520 7469 6d65 7320 616e 6420 656e 6572  e times and ener
-00039130: 6769 6573 2061 7265 2061 6c72 6561 6479  gies are already
-00039140: 2069 6e20 6120 7269 7369 6e67 206f 7264   in a rising ord
-00039150: 6572 2e20 0d0a 0909 0977 6974 6820 7468  er. .....with th
-00039160: 6973 2073 7769 7463 682c 2062 6f74 6820  is switch, both 
-00039170: 6172 6520 736f 7274 6564 2061 6761 696e  are sorted again
-00039180: 2e20 0d0a 0909 0d0a 0909 6469 7669 6465  . ........divide
-00039190: 5f74 696d 6573 5f62 7920 3a20 4e6f 6e65  _times_by : None
-000391a0: 206f 7220 666c 6f61 7420 286f 7074 696f   or float (optio
-000391b0: 6e61 6c29 200d 0a09 0909 6865 7265 2061  nal) .....here a
-000391c0: 206e 756d 6265 7220 6361 6e20 6265 2067   number can be g
-000391d0: 6976 656e 2074 6861 7420 7363 616c 6573  iven that scales
-000391e0: 2074 6865 2074 696d 6520 6279 2061 6e20   the time by an 
-000391f0: 6172 6269 7461 7279 2066 6163 746f 722e  arbitary factor.
-00039200: 2054 6869 7320 6973 2061 6374 7561 6c6c   This is actuall
-00039210: 7920 6469 7669 6469 6e67 0d0a 0909 0974  y dividing.....t
-00039220: 6865 2074 696d 6573 2062 7920 7468 6973  he times by this
-00039230: 2076 616c 7565 2e20 416c 7465 726e 6174   value. Alternat
-00039240: 6976 656c 7920 7468 6572 6520 6973 2074  ively there is t
-00039250: 6865 2076 6172 6961 626c 6520 7365 6c66  he variable self
-00039260: 2e62 6173 6575 6e69 742e 2054 6865 206c  .baseunit. The l
-00039270: 6174 7465 7220 6f6e 6c79 2061 6666 6563  atter only affec
-00039280: 7473 200d 0a09 0909 7768 6174 2069 7320  ts .....what is 
-00039290: 7772 6974 7465 6e20 6f6e 2074 6865 2061  written on the a
-000392a0: 7869 732c 2077 6869 6c65 2074 6869 7320  xis, while this 
-000392b0: 7661 6c75 6520 6973 2061 6374 7561 6c6c  value is actuall
-000392c0: 7920 7573 6564 2074 6f20 7363 616c 6520  y used to scale 
-000392d0: 7468 6520 7469 6d65 732e 204e 6f6e 6520  the times. None 
-000392e0: 2844 6566 6175 6c74 2920 0d0a 0909 0969  (Default) .....i
-000392f0: 676e 6f72 6573 2074 6869 730d 0a09 090d  gnores this.....
-00039300: 0a09 0973 6869 6674 5f74 696d 6573 5f62  ...shift_times_b
-00039310: 7920 3a20 4e6f 6e65 2c20 666c 6f61 7420  y : None, float 
-00039320: 286f 7074 696f 6e61 6c29 0d0a 0909 0954  (optional).....T
-00039330: 6869 7320 6120 7661 6c75 6520 6279 2077  his a value by w
-00039340: 6869 6368 2074 6865 2074 696d 6520 6178  hich the time ax
-00039350: 6973 2069 7320 7368 6966 7465 6420 6475  is is shifted du
-00039360: 7269 6e67 2069 6d70 6f72 742e 2054 6869  ring import. Thi
-00039370: 7320 6973 2061 2075 7365 6675 6c20 6f70  s is a useful op
-00039380: 7469 6f6e 206f 6620 652e 672e 200d 0a09  tion of e.g. ...
-00039390: 0909 7468 6520 7265 636f 7264 696e 6720  ..the recording 
-000393a0: 736f 6674 7761 7265 2064 6f65 7320 6e6f  software does no
-000393b0: 7420 636f 6d70 656e 7361 7465 2066 6f72  t compensate for
-000393c0: 2074 3020 616e 6420 7468 6520 6461 7461   t0 and the data
-000393d0: 2069 7320 616c 7761 7973 2073 6869 6674   is always shift
-000393e0: 6564 2e20 0d0a 0909 094e 6f6e 6520 2844  ed. .....None (D
-000393f0: 6566 6175 6c74 2920 6967 6e6f 7265 7320  efault) ignores 
-00039400: 7468 6973 2073 6574 7469 6e67 0d0a 0909  this setting....
-00039410: 0d0a 0909 6461 7461 5f74 7970 6520 3a20  ....data_type : 
-00039420: 7374 722c 204e 6f6e 650d 0a09 0909 7468  str, None.....th
-00039430: 6973 2069 7320 7468 6520 6461 7461 7479  is is the dataty
-00039440: 7065 2061 6e64 2065 6666 6563 7469 7665  pe and effective
-00039450: 6c79 2074 6865 2075 6e69 7420 7075 7420  ly the unit put 
-00039460: 6f6e 2074 6865 2069 6e74 656e 7369 7479  on the intensity
-00039470: 2061 7869 7320 0d0a 0909 0928 4465 6661   axis .....(Defa
-00039480: 756c 7429 2764 6966 6665 7265 6e74 6961  ult)'differentia
-00039490: 6c20 4162 736f 7270 7469 6f6e 2069 6e20  l Absorption in 
-000394a0: 245c 6d61 7468 7265 6775 6c61 727b 5c44  $\mathregular{\D
-000394b0: 656c 7461 204f 447d 240d 0a09 090d 0a09  elta OD}$.......
-000394c0: 0965 7874 6572 6e61 6c5f 7469 6d65 203a  .external_time :
-000394d0: 204e 6f6e 6520 6f72 2073 7472 2028 6f70   None or str (op
-000394e0: 7469 6f6e 616c 290d 0a09 0909 4865 7265  tional).....Here
-000394f0: 2061 2066 696c 656e 616d 6520 6578 7465   a filename exte
-00039500: 6e73 696f 6e20 2873 7472 696e 6729 2063  nsion (string) c
-00039510: 616e 2062 6520 6769 7665 6e20 7468 6174  an be given that
-00039520: 2063 6f6e 7461 696e 7320 7468 6520 7469   contains the ti
-00039530: 6d65 2076 6563 746f 722e 200d 0a09 0909  me vector. .....
-00039540: 5468 6520 6669 6c65 2069 7320 6173 7375  The file is assu
-00039550: 6d65 6420 746f 2062 6520 6174 2074 6865  med to be at the
-00039560: 2073 616d 6520 7061 7468 2061 7320 7468   same path as th
-00039570: 6520 6461 7461 2061 6e64 2074 6f20 636f  e data and to co
-00039580: 6e74 6169 6e20 6120 7369 6e67 6c65 200d  ntain a single .
-00039590: 0a09 0909 7479 7065 206f 6620 7365 7061  ....type of sepa
-000395a0: 7261 7465 6420 6461 7461 2077 6974 686f  rated data witho
-000395b0: 7574 2068 6561 6465 722e 200d 0a09 0909  ut header. .....
-000395c0: 4966 2075 7365 5f73 616d 655f 6e61 6d65  If use_same_name
-000395d0: 203d 2054 7275 6520 2864 6566 6175 6c74   = True (default
-000395e0: 290d 0a09 0909 4974 2061 7373 756d 6573  ).....It assumes
-000395f0: 2074 6861 7420 7468 6973 2069 7320 7468   that this is th
-00039600: 6520 656e 6469 6e67 2066 6f72 2074 6865  e ending for the
-00039610: 2066 696c 652e 2054 6865 2066 696c 656e   file. The filen
-00039620: 616d 6520 6974 7365 6c66 2069 7320 7461  ame itself is ta
-00039630: 6b65 6e20 6672 6f6d 2074 6865 2066 696c  ken from the fil
-00039640: 656e 616d 652e 200d 0a09 0909 652e 672e  ename. .....e.g.
-00039650: 2069 6620 7361 6d70 312e 7478 7420 6973   if samp1.txt is
-00039660: 2074 6865 2066 696c 656e 616d 6520 616e   the filename an
-00039670: 6420 6578 7465 726e 616c 5f74 696d 653d  d external_time=
-00039680: 272e 7469 6427 2074 6865 2070 726f 6772  '.tid' the progr
-00039690: 616d 2073 6561 7263 6865 7320 0d0a 0909  am searches ....
-000396a0: 0973 616d 7031 2e74 6964 2066 6f72 2074  .samp1.tid for t
-000396b0: 6865 2074 696d 6573 2e20 5468 6520 7472  he times. The tr
-000396c0: 616e 7370 6f73 6520 7365 7474 696e 6720  anspose setting 
-000396d0: 6973 2061 7070 6c69 6564 2061 6e64 2073  is applied and s
-000396e0: 6574 7320 7768 6572 6520 7468 6520 7469  ets where the ti
-000396f0: 6d65 7320 6172 6520 0d0a 0909 0974 6f20  mes are .....to 
-00039700: 6265 2069 6e73 6572 7465 6420 2872 6f77  be inserted (row
-00039710: 206f 7220 636f 6c75 6d6e 2069 6e64 6578   or column index
-00039720: 6573 290d 0a09 0909 4966 2075 7365 5f73  es).....If use_s
-00039730: 616d 655f 6e61 6d65 203d 2046 616c 7365  ame_name = False
-00039740: 2074 6869 7320 7368 6f75 6c64 2062 6520   this should be 
-00039750: 7468 6520 6669 6c65 2063 6f6e 7461 696e  the file contain
-00039760: 696e 6720 7468 6520 7665 6374 6f72 2066  ing the vector f
-00039770: 6f72 2074 6865 2074 696d 6520 2869 6e20  or the time (in 
-00039780: 7468 6520 7361 6d65 2066 6f72 6d61 7420  the same format 
-00039790: 6173 2074 6865 206d 6169 6e20 6669 6c65  as the main file
-000397a0: 290d 0a09 0909 0d0a 0909 6578 7465 726e  ).........extern
-000397b0: 616c 5f77 6176 6520 3a20 4e6f 6e65 206f  al_wave : None o
-000397c0: 7220 7374 7220 286f 7074 696f 6e61 6c29  r str (optional)
-000397d0: 200d 0a09 0909 4865 7265 2061 2066 696c   .....Here a fil
-000397e0: 656e 616d 6520 6578 7465 6e73 696f 6e20  ename extension 
-000397f0: 2873 7472 696e 6729 2063 616e 2062 6520  (string) can be 
-00039800: 6769 7665 6e20 7468 6174 2063 6f6e 7461  given that conta
-00039810: 696e 7320 7468 6520 7761 7665 6c65 6e67  ins the waveleng
-00039820: 7468 2076 6563 746f 722e 200d 0a09 0909  th vector. .....
-00039830: 4966 2075 7365 5f73 616d 655f 6e61 6d65  If use_same_name
-00039840: 203d 2054 7275 6520 2864 6566 6175 6c74   = True (default
-00039850: 290d 0a09 0909 5468 6520 6669 6c65 2069  ).....The file i
-00039860: 7320 6173 7375 6d65 6420 746f 2062 6520  s assumed to be 
-00039870: 6174 2074 6865 2073 616d 6520 7061 7468  at the same path
-00039880: 2061 7320 7468 6520 6461 7461 2061 6e64   as the data and
-00039890: 2074 6f20 636f 6e74 6169 6e20 6120 7369   to contain a si
-000398a0: 6e67 6c65 2074 7970 6520 0d0a 0909 096f  ngle type .....o
-000398b0: 6620 7365 7061 7261 7465 6420 6461 7461  f separated data
-000398c0: 2077 6974 686f 7574 2068 6561 6465 722e   without header.
-000398d0: 2054 6869 7320 6973 2074 6865 2065 6e64   This is the end
-000398e0: 696e 6720 666f 7220 7468 6520 6669 6c65  ing for the file
-000398f0: 2e20 5468 6520 6669 6c65 6e61 6d65 2069  . The filename i
-00039900: 7473 656c 6620 0d0a 0909 0969 7320 7461  tself .....is ta
-00039910: 6b65 6e20 6672 6f6d 2074 6865 2066 696c  ken from the fil
-00039920: 656e 616d 652e 2065 2e67 2e20 6966 2073  ename. e.g. if s
-00039930: 616d 7031 2e74 7874 2069 7320 7468 6520  amp1.txt is the 
-00039940: 6669 6c65 6e61 6d65 2061 6e64 2065 7874  filename and ext
-00039950: 6572 6e61 6c5f 7761 7665 3d27 2e77 6176  ernal_wave='.wav
-00039960: 2720 0d0a 0909 0974 6865 6e20 7468 6520  ' .....then the 
-00039970: 7072 6f67 7261 6d20 7365 6172 6368 6573  program searches
-00039980: 2073 616d 7031 2e77 6176 2066 6f72 2074   samp1.wav for t
-00039990: 6865 2077 6176 656c 656e 6774 682e 2054  he wavelength. T
-000399a0: 6865 2074 7261 6e73 706f 7365 2073 6574  he transpose set
-000399b0: 7469 6e67 2069 7320 6170 706c 6965 6420  ting is applied 
-000399c0: 0d0a 0909 0961 6e64 2073 6574 7320 7768  .....and sets wh
-000399d0: 6572 6520 7468 6520 7761 7665 6c65 6e67  ere the waveleng
-000399e0: 7468 2061 7265 2074 6f20 6265 2069 6e73  th are to be ins
-000399f0: 6572 7465 6420 2863 6f6c 756d 6e73 206f  erted (columns o
-00039a00: 7220 726f 7720 696e 6465 7865 7329 0d0a  r row indexes)..
-00039a10: 0909 0949 6620 7573 655f 7361 6d65 5f6e  ...If use_same_n
-00039a20: 616d 6520 3d20 4661 6c73 650d 0a09 0909  ame = False.....
-00039a30: 7468 6973 2073 686f 756c 6420 6265 2061  this should be a
-00039a40: 2066 756c 6c20 6669 6c65 6e61 6d65 2074   full filename t
-00039a50: 6861 7420 636f 6e74 6169 6e73 2074 6865  hat contains the
-00039a60: 2076 6563 746f 720d 0a09 0909 0d0a 0909   vector.........
-00039a70: 7573 655f 7361 6d65 5f6e 616d 6520 3a20  use_same_name : 
-00039a80: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0d0a  bool, optional..
-00039a90: 0909 0974 6869 7320 7377 6974 6368 6573  ...this switches
-00039aa0: 2069 6620 7468 6520 6578 7465 726e 616c   if the external
-00039ab0: 2066 696c 656e 616d 6520 696e 636c 7564   filename includ
-00039ac0: 6564 2074 6865 206c 6f61 6465 6420 6669  ed the loaded fi
-00039ad0: 6c65 6e61 6d65 206f 7220 6973 2061 2073  lename or is a s
-00039ae0: 6570 6172 6174 6520 6669 6c65 2054 7275  eparate file Tru
-00039af0: 6528 6465 6661 756c 7429 0d0a 0909 090d  e(default)......
-00039b00: 0a09 0964 733a 2070 616e 6461 732e 4461  ...ds: pandas.Da
-00039b10: 7461 4672 616d 6520 286f 7074 696f 6e61  taFrame (optiona
-00039b20: 6c29 0d0a 0909 0966 6565 6420 696e 2061  l).....feed in a
-00039b30: 6e20 6578 7465 726e 616c 2064 6174 6166  n external dataf
-00039b40: 7261 6d65 2069 6e73 7465 6164 206f 6620  rame instead of 
-00039b50: 6f70 656e 696e 6720 6120 6669 6c65 0d0a  opening a file..
-00039b60: 0909 090d 0a09 0963 6f6e 7665 7273 696f  .......conversio
-00039b70: 6e5f 6675 6e63 7469 6f6e 3a20 6675 6e63  n_function: func
-00039b80: 7469 6f6e 286f 7074 696f 6e61 6c29 0d0a  tion(optional)..
-00039b90: 0909 0966 756e 6374 696f 6e20 7468 6174  ...function that
-00039ba0: 2072 6563 6569 7665 7320 7368 6f75 6c64   receives should
-00039bb0: 2068 6176 6520 7468 6520 7368 6170 653a   have the shape:
-00039bc0: 0d0a 0909 0972 6574 7572 6e20 7061 6e64  .....return pand
-00039bd0: 6173 2044 6174 6166 7261 6d65 2077 6974  as Dataframe wit
-00039be0: 6820 7469 6d65 2f66 7261 6d65 7320 2069  h time/frames  i
-00039bf0: 6e20 726f 7773 2061 6e64 2077 6176 656c  n rows and wavel
-00039c00: 656e 6774 682f 656e 6572 6779 2069 6e20  ength/energy in 
-00039c10: 636f 6c75 6d6e 732c 0d0a 0909 0954 6865  columns,.....The
-00039c20: 2066 756e 6374 696f 6e20 6973 2074 6573   function is tes
-00039c30: 7465 6420 746f 2061 6363 6570 7420 2869  ted to accept (i
-00039c40: 6e20 7468 6174 206f 7264 6572 2920 6120  n that order) a 
-00039c50: 0d0a 0909 096d 795f 6675 6e63 7469 6f6e  .....my_function
-00039c60: 2866 696c 656e 616d 652c 2065 7874 6572  (filename, exter
-00039c70: 6e61 6c5f 7469 6d65 2c65 7874 6572 6e61  nal_time,externa
-00039c80: 6c5f 7761 7665 292c 200d 0a09 0909 6d79  l_wave), .....my
-00039c90: 5f66 756e 6374 696f 6e28 6669 6c65 6e61  _function(filena
-00039ca0: 6d65 2c20 6578 7465 726e 616c 5f74 696d  me, external_tim
-00039cb0: 6529 2c20 0d0a 0909 096d 795f 6675 6e63  e), .....my_func
-00039cc0: 7469 6f6e 2866 696c 656e 616d 652c 6578  tion(filename,ex
-00039cd0: 7465 726e 616c 5f77 6176 6529 2c20 0d0a  ternal_wave), ..
-00039ce0: 0909 096d 795f 6675 6e63 7469 6f6e 2866  ...my_function(f
-00039cf0: 696c 656e 616d 6529 2061 6e64 200d 0a09  ilename) and ...
-00039d00: 0909 7265 7475 726e 3a20 7468 6520 6461  ..return: the da
-00039d10: 7461 6672 616d 6520 6473 2077 6974 6820  taframe ds with 
-00039d20: 7468 6520 7469 6d65 5f61 7869 7320 6173  the time_axis as
-00039d30: 2072 6f77 7320 616e 6420 7370 6563 7472   rows and spectr
-00039d40: 616c 2061 7869 7320 6173 2063 6f6c 756d  al axis as colum
-00039d50: 6e73 200d 0a09 0909 6966 2074 6865 2064  ns .....if the d
-00039d60: 732e 696e 6465 782e 6e61 6d65 2069 6120  s.index.name ia 
-00039d70: 6e6f 7420 656d 7074 7920 7468 6520 2274  not empty the "t
-00039d80: 696d 6520 6178 6973 2220 6973 2069 6e20  ime axis" is in 
-00039d90: 746f 2074 6861 7420 6e61 6d65 2074 6865  to that name the
-00039da0: 2073 7065 6374 7261 6c20 6178 6973 2069   spectral axis i
-00039db0: 7320 696e 2064 732e 636f 6c75 6d6e 732e  s in ds.columns.
-00039dc0: 6e61 6d65 0d0a 0909 0974 6865 2072 6574  name.....the ret
-00039dd0: 7572 6e20 6973 2069 6e76 6573 7469 6761  urn is investiga
-00039de0: 7465 6420 6966 2069 7420 6973 206f 6e65  ted if it is one
-00039df0: 2c20 7477 6f2c 206f 7220 7468 7265 6520  , two, or three 
-00039e00: 7468 696e 6773 2e20 0d0a 0909 0969 6620  things. .....if 
-00039e10: 7477 6f20 6172 6520 7265 7475 726e 6564  two are returned
-00039e20: 2074 6865 6e20 7468 6520 7365 636f 6e64   then the second
-00039e30: 206d 7573 7420 6265 2074 6865 206e 616d   must be the nam
-00039e40: 6520 6f66 2077 6861 7420 7468 6520 696e  e of what the in
-00039e50: 7465 6e73 6974 7920 6178 6973 2069 732e  tensity axis is.
-00039e60: 2054 6869 7320 7661 6c75 6520 7769 6c6c   This value will
-00039e70: 2074 6865 6e20 6265 2073 6574 2074 6f20   then be set to 
-00039e80: 6461 7461 5f74 7970 650d 0a09 0909 6966  data_type.....if
-00039e90: 2074 6872 6565 2061 7265 2072 6574 7572   three are retur
-00039ea0: 6e65 6420 7468 6520 7468 6972 6420 6973  ned the third is
-00039eb0: 2074 6865 2062 6173 6575 6e69 7420 2866   the baseunit (f
-00039ec0: 6f72 2074 6865 2074 696d 6520 6178 6973  or the time axis
-00039ed0: 2920 7468 6973 2061 6c6c 6f77 7320 746f  ) this allows to
-00039ee0: 2075 7365 2074 6865 2061 7574 6f6d 6174   use the automat
-00039ef0: 6963 206e 616d 696e 6720 696e 2070 7320  ic naming in ps 
-00039f00: 6f72 206e 616e 6f73 6563 6f6e 640d 0a09  or nanosecond...
-00039f10: 0909 4966 2074 6865 2076 616c 7565 7320  ..If the values 
-00039f20: 756e 6974 732c 2064 6174 615f 7479 7065  units, data_type
-00039f30: 206f 7220 6261 7365 756e 6974 2061 7265   or baseunit are
-00039f40: 2028 6d61 6e75 616c 6c79 2920 7365 7420   (manually) set 
-00039f50: 696e 2074 6865 2069 6d70 6f72 7420 6675  in the import fu
-00039f60: 6e63 7469 6f6e 2074 6865 2063 6f72 7265  nction the corre
-00039f70: 7370 6f6e 6469 6e67 2065 6e74 7269 6573  sponding entries
-00039f80: 2069 6e0d 0a09 0909 6461 7461 6672 616d   in.....datafram
-00039f90: 2077 696c 6c20 6265 206f 7665 7277 7269   will be overwri
-00039fa0: 7474 656e 0d0a 0909 0973 6869 6674 5f74  tten.....shift_t
-00039fb0: 696d 6573 5f62 7920 616e 6420 6469 7669  imes_by and divi
-00039fc0: 6465 5f74 696d 6573 5f62 7920 7769 6c6c  de_times_by will
-00039fd0: 2062 6520 6170 706c 6965 6420 6966 206e   be applied if n
-00039fe0: 6f74 204e 6f6e 6520 2875 7365 6675 6c20  ot None (useful 
-00039ff0: 746f 2061 646a 7573 7420 666f 7220 6f66  to adjust for of
-0003a000: 6673 6574 2062 6566 6f72 6520 6368 6972  fset before chir
-0003a010: 7020 636f 7272 6563 7469 6f6e 290d 0a09  p correction)...
-0003a020: 0909 200d 0a09 0909 0d0a 0909 090d 0a09  .. .............
-0003a030: 0952 6574 7572 6e73 0d0a 0909 2d2d 2d2d  .Returns....----
-0003a040: 2d2d 2d0d 0a09 090d 0a09 0941 2054 4120  ---........A TA 
-0003a050: 6f62 6a65 6374 2077 6974 6820 616c 6c20  object with all 
-0003a060: 7061 7261 6d65 7465 7220 696e 6974 6961  parameter initia
-0003a070: 6c69 7a65 640d 0a09 090d 0a09 0945 7861  lized........Exa
-0003a080: 6d70 6c65 730d 0a09 092d 2d2d 2d2d 2d2d  mples....-------
-0003a090: 2d2d 2d2d 2d2d 2d0d 0a09 090d 0a09 0954  -------........T
-0003a0a0: 7970 6963 616c 2075 7365 6167 653a 0d0a  ypical useage:..
-0003a0b0: 0909 0d0a 0909 3e3e 3e20 696d 706f 7274  ......>>> import
-0003a0c0: 2070 6c6f 745f 6675 6e63 2061 7320 7066   plot_func as pf
-0003a0d0: 2023 696d 706f 7274 2074 6865 206d 6f64   #import the mod
-0003a0e0: 756c 6520 616e 6420 6769 7665 2069 7420  ule and give it 
-0003a0f0: 6120 7368 6f72 7465 7220 6e61 6d65 0d0a  a shorter name..
-0003a100: 0909 3e3e 3e20 7461 3d70 662e 5441 2827  ..>>> ta=pf.TA('
-0003a110: 6775 6927 2920 2375 7365 2061 2047 5549  gui') #use a GUI
-0003a120: 2074 6f20 6f70 656e 0d0a 0909 3e3e 3e20   to open....>>> 
-0003a130: 7461 3d70 662e 5441 2827 7361 6d70 6c65  ta=pf.TA('sample
-0003a140: 5f31 2e53 4941 2729 2023 7573 6520 6120  _1.SIA') #use a 
-0003a150: 6669 6c65 6e61 6d65 2069 6e20 7468 6520  filename in the 
-0003a160: 7361 6d65 2066 6f6c 6465 720d 0a09 093e  same folder....>
-0003a170: 3e3e 2074 613d 7066 2e54 4128 2773 616d  >> ta=pf.TA('sam
-0003a180: 706c 655f 312e 6864 6635 272c 7061 7468  ple_1.hdf5',path
-0003a190: 3d27 4461 7461 2729 2023 7573 6520 6120  ='Data') #use a 
-0003a1a0: 6669 6c65 6e61 6d65 2069 6e20 7468 6520  filename in the 
-0003a1b0: 666f 6c64 6572 2027 4461 7461 270d 0a09  folder 'Data'...
-0003a1c0: 090d 0a09 094f 7065 6e69 6e67 2061 206c  .....Opening a l
-0003a1d0: 6973 7420 6f66 2066 696c 6573 2077 6974  ist of files wit
-0003a1e0: 6820 6578 7465 726e 616c 2074 696d 6520  h external time 
-0003a1f0: 7665 6374 6f72 2028 6f66 2074 6865 2073  vector (of the s
-0003a200: 616d 6520 6e61 6d65 2920 736f 2069 7420  ame name) so it 
-0003a210: 6c6f 6f6b 7320 666f 7220 6120 6461 7461  looks for a data
-0003a220: 0d0a 0909 6669 6c65 2022 6669 7465 312e  ....file "fite1.
-0003a230: 7478 7422 2061 6e64 2061 2066 696c 6520  txt" and a file 
-0003a240: 7769 7468 2074 6865 2074 696d 6520 696e  with the time in
-0003a250: 666f 726d 6174 696f 6e20 2266 696c 6531  formation "file1
-0003a260: 2e74 6964 220d 0a09 090d 0a09 093e 3e3e  .tid"........>>>
-0003a270: 7461 3d70 662e 5441 2827 6669 6c65 312e  ta=pf.TA('file1.
-0003a280: 7478 7427 2c20 6578 7465 726e 616c 5f74  txt', external_t
-0003a290: 696d 6520 3d20 2774 6964 2729 0d0a 0909  ime = 'tid')....
-0003a2a0: 0d0a 0909 2727 270d 0a09 090d 0a09 090d  ....'''.........
-0003a2b0: 0a09 090d 0a09 0973 656c 662e 7061 7468  .......self.path
-0003a2c0: 3d63 6865 636b 5f66 6f6c 6465 7228 7061  =check_folder(pa
-0003a2d0: 7468 3d70 6174 682c 6375 7272 656e 745f  th=path,current_
-0003a2e0: 7061 7468 3d6f 732e 6765 7463 7764 2829  path=os.getcwd()
-0003a2f0: 290d 0a09 0973 656c 662e 6669 6c65 6e61  )....self.filena
-0003a300: 6d65 3d66 696c 656e 616d 650d 0a09 0969  me=filename....i
-0003a310: 6620 6473 2069 7320 6e6f 7420 4e6f 6e65  f ds is not None
-0003a320: 3a0d 0a09 0909 6966 2066 696c 656e 616d  :.....if filenam
-0003a330: 6520 6973 204e 6f6e 653a 0d0a 0909 0909  e is None:......
-0003a340: 6669 6c65 6e61 6d65 203d 2027 6578 7465  filename = 'exte
-0003a350: 726e 616c 270d 0a09 0909 0973 656c 662e  rnal'......self.
-0003a360: 6669 6c65 6e61 6d65 3d27 6578 7465 726e  filename='extern
-0003a370: 616c 270d 0a09 0969 6620 6669 6c65 6e61  al'....if filena
-0003a380: 6d65 203d 3d20 2767 7569 273a 0d0a 0909  me == 'gui':....
-0003a390: 0972 6f6f 745f 7769 6e64 6f77 203d 2074  .root_window = t
-0003a3a0: 6b69 6e74 6572 2e54 6b28 2909 0909 0d0a  kinter.Tk().....
-0003a3b0: 0909 0972 6f6f 745f 7769 6e64 6f77 2e77  ...root_window.w
-0003a3c0: 6974 6864 7261 7728 290d 0a09 0909 726f  ithdraw().....ro
-0003a3d0: 6f74 5f77 696e 646f 772e 6174 7472 6962  ot_window.attrib
-0003a3e0: 7574 6573 2827 2d74 6f70 6d6f 7374 272c  utes('-topmost',
-0003a3f0: 5472 7565 290d 0a09 0909 726f 6f74 5f77  True).....root_w
-0003a400: 696e 646f 772e 6166 7465 7228 3130 3030  indow.after(1000
-0003a410: 2c20 6c61 6d62 6461 3a20 726f 6f74 5f77  , lambda: root_w
-0003a420: 696e 646f 772e 666f 6375 735f 666f 7263  indow.focus_forc
-0003a430: 6528 2929 0d0a 0909 0963 6f6d 706c 6574  e()).....complet
-0003a440: 655f 7061 7468 203d 2066 696c 6564 6961  e_path = filedia
-0003a450: 6c6f 672e 6173 6b6f 7065 6e66 696c 656e  log.askopenfilen
-0003a460: 616d 6528 696e 6974 6961 6c64 6972 3d6f  ame(initialdir=o
-0003a470: 732e 6765 7463 7764 2829 290d 0a09 0909  s.getcwd()).....
-0003a480: 6c69 7374 656e 3d6f 732e 7061 7468 2e73  listen=os.path.s
-0003a490: 706c 6974 2863 6f6d 706c 6574 655f 7061  plit(complete_pa
-0003a4a0: 7468 290d 0a09 0909 7061 7468 3d6f 732e  th).....path=os.
-0003a4b0: 7061 7468 2e6e 6f72 6d70 6174 6828 6c69  path.normpath(li
-0003a4c0: 7374 656e 5b30 5d29 0d0a 0909 0973 656c  sten[0]).....sel
-0003a4d0: 662e 7061 7468 3d70 6174 680d 0a09 0909  f.path=path.....
-0003a4e0: 6669 6c65 6e61 6d65 3d6c 6973 7465 6e5b  filename=listen[
-0003a4f0: 315d 0d0a 0909 0973 656c 662e 6669 6c65  1].....self.file
-0003a500: 6e61 6d65 3d66 696c 656e 616d 650d 0a09  name=filename...
-0003a510: 0909 7769 7468 206f 7065 6e28 2772 6563  ..with open('rec
-0003a520: 656e 742e 6461 7427 2c27 7727 2920 6173  ent.dat','w') as
-0003a530: 2066 3a0d 0a09 0909 0966 2e77 7269 7465   f:......f.write
-0003a540: 2863 6f6d 706c 6574 655f 7061 7468 290d  (complete_path).
-0003a550: 0a09 0965 6c69 6620 6669 6c65 6e61 6d65  ...elif filename
-0003a560: 203d 3d20 2772 6563 656e 7427 3a0d 0a09   == 'recent':...
-0003a570: 0909 7472 793a 0d0a 0909 0909 7769 7468  ..try:......with
-0003a580: 206f 7065 6e28 2772 6563 656e 742e 6461   open('recent.da
-0003a590: 7427 2c27 7227 2920 6173 2066 3a0d 0a09  t','r') as f:...
-0003a5a0: 0909 0909 636f 6d70 6c65 7465 5f70 6174  ....complete_pat
-0003a5b0: 6820 3d20 662e 7265 6164 6c69 6e65 2829  h = f.readline()
-0003a5c0: 0d0a 0909 0909 096c 6973 7465 6e3d 6f73  .......listen=os
-0003a5d0: 2e70 6174 682e 7370 6c69 7428 636f 6d70  .path.split(comp
-0003a5e0: 6c65 7465 5f70 6174 6829 0d0a 0909 0909  lete_path)......
-0003a5f0: 0970 6174 683d 6f73 2e70 6174 682e 6e6f  .path=os.path.no
-0003a600: 726d 7061 7468 286c 6973 7465 6e5b 305d  rmpath(listen[0]
-0003a610: 290d 0a09 0909 0909 7365 6c66 2e70 6174  ).......self.pat
-0003a620: 683d 7061 7468 0d0a 0909 0909 0966 696c  h=path.......fil
-0003a630: 656e 616d 653d 6c69 7374 656e 5b31 5d0d  ename=listen[1].
-0003a640: 0a09 0909 0909 7365 6c66 2e66 696c 656e  ......self.filen
-0003a650: 616d 653d 6669 6c65 6e61 6d65 0d0a 0909  ame=filename....
-0003a660: 0965 7863 6570 743a 0d0a 0909 0909 726f  .except:......ro
-0003a670: 6f74 5f77 696e 646f 7720 3d20 746b 696e  ot_window = tkin
-0003a680: 7465 722e 546b 2829 0d0a 0909 0909 726f  ter.Tk()......ro
-0003a690: 6f74 5f77 696e 646f 772e 7769 7468 6472  ot_window.withdr
-0003a6a0: 6177 2829 0d0a 0909 0909 726f 6f74 5f77  aw()......root_w
-0003a6b0: 696e 646f 772e 6174 7472 6962 7574 6573  indow.attributes
-0003a6c0: 2827 2d74 6f70 6d6f 7374 272c 5472 7565  ('-topmost',True
-0003a6d0: 290d 0a09 0909 0972 6f6f 745f 7769 6e64  )......root_wind
-0003a6e0: 6f77 2e61 6674 6572 2831 3030 302c 206c  ow.after(1000, l
-0003a6f0: 616d 6264 613a 2072 6f6f 745f 7769 6e64  ambda: root_wind
-0003a700: 6f77 2e66 6f63 7573 5f66 6f72 6365 2829  ow.focus_force()
-0003a710: 290d 0a09 0909 0963 6f6d 706c 6574 655f  )......complete_
-0003a720: 7061 7468 203d 2066 696c 6564 6961 6c6f  path = filedialo
-0003a730: 672e 6173 6b6f 7065 6e66 696c 656e 616d  g.askopenfilenam
-0003a740: 6528 696e 6974 6961 6c64 6972 3d6f 732e  e(initialdir=os.
-0003a750: 6765 7463 7764 2829 290d 0a09 0909 096c  getcwd())......l
-0003a760: 6973 7465 6e3d 6f73 2e70 6174 682e 7370  isten=os.path.sp
-0003a770: 6c69 7428 636f 6d70 6c65 7465 5f70 6174  lit(complete_pat
-0003a780: 6829 0d0a 0909 0909 7061 7468 3d6f 732e  h)......path=os.
-0003a790: 7061 7468 2e6e 6f72 6d70 6174 6828 6c69  path.normpath(li
-0003a7a0: 7374 656e 5b30 5d29 0d0a 0909 0909 7365  sten[0])......se
-0003a7b0: 6c66 2e70 6174 683d 7061 7468 0d0a 0909  lf.path=path....
-0003a7c0: 0909 6669 6c65 6e61 6d65 3d6c 6973 7465  ..filename=liste
-0003a7d0: 6e5b 315d 0d0a 0909 0909 7365 6c66 2e66  n[1]......self.f
-0003a7e0: 696c 656e 616d 653d 6669 6c65 6e61 6d65  ilename=filename
-0003a7f0: 0d0a 0909 0909 7769 7468 206f 7065 6e28  ......with open(
-0003a800: 2772 6563 656e 742e 6461 7427 2c27 7727  'recent.dat','w'
-0003a810: 2920 6173 2066 3a0d 0a09 0909 0909 662e  ) as f:.......f.
-0003a820: 7772 6974 6528 636f 6d70 6c65 7465 5f70  write(complete_p
-0003a830: 6174 6829 0d0a 0d0a 0909 6966 2066 696c  ath)......if fil
-0003a840: 656e 616d 6520 3d3d 2027 6578 7465 726e  ename == 'extern
-0003a850: 616c 273a 2375 7365 2061 2070 726f 7669  al':#use a provi
-0003a860: 6465 6420 6461 7461 6672 616d 6520 2864  ded dataframe (d
-0003a870: 7329 2069 6e73 7465 6164 0d0a 0909 0969  s) instead.....i
-0003a880: 6620 6461 7461 5f74 7970 6520 6973 206e  f data_type is n
-0003a890: 6f74 204e 6f6e 653a 0d0a 0909 0909 7365  ot None:......se
-0003a8a0: 6c66 2e64 6174 615f 7479 7065 203d 2064  lf.data_type = d
-0003a8b0: 6174 615f 7479 7065 0d0a 0909 0969 6620  ata_type.....if 
-0003a8c0: 756e 6974 7320 6973 206e 6f74 204e 6f6e  units is not Non
-0003a8d0: 653a 0d0a 0909 0909 7365 6c66 2e75 6e69  e:......self.uni
-0003a8e0: 7473 203d 2075 6e69 7473 0d0a 0909 0909  ts = units......
-0003a8f0: 7472 793a 0d0a 0909 0909 0969 6620 6c65  try:.......if le
-0003a900: 6e28 6473 2e63 6f6c 756d 6e73 2e6e 616d  n(ds.columns.nam
-0003a910: 6529 3d3d 303a 0d0a 0909 0909 0909 6473  e)==0:........ds
-0003a920: 2e63 6f6c 756d 6e73 2e6e 616d 653d 2075  .columns.name= u
-0003a930: 6e69 7473 0d0a 0909 0909 6578 6365 7074  nits......except
-0003a940: 3a0d 0a09 0909 0909 7061 7373 0d0a 0909  :.......pass....
-0003a950: 0965 6c73 653a 0d0a 0909 0909 7472 793a  .else:......try:
-0003a960: 0d0a 0909 0909 0969 6620 6c65 6e28 6473  .......if len(ds
-0003a970: 2e63 6f6c 756d 6e73 2e6e 616d 6529 213d  .columns.name)!=
-0003a980: 303a 0d0a 0909 0909 0909 7365 6c66 2e75  0:........self.u
-0003a990: 6e69 7473 203d 2064 732e 636f 6c75 6d6e  nits = ds.column
-0003a9a0: 732e 6e61 6d65 200d 0a09 0909 0965 7863  s.name ......exc
-0003a9b0: 6570 743a 0d0a 0909 0909 0970 6173 730d  ept:.......pass.
-0003a9c0: 0a09 0909 6966 2062 6173 6575 6e69 7420  ....if baseunit 
-0003a9d0: 6973 206e 6f74 204e 6f6e 653a 0d0a 0909  is not None:....
-0003a9e0: 0909 7365 6c66 2e62 6173 6575 6e69 7420  ..self.baseunit 
-0003a9f0: 3d20 6261 7365 756e 6974 0d0a 0909 0909  = baseunit......
-0003aa00: 7472 793a 0d0a 0909 0909 0969 6620 6c65  try:.......if le
-0003aa10: 6e28 6473 2e69 6e64 6578 2e6e 616d 6529  n(ds.index.name)
-0003aa20: 3d3d 303a 0d0a 0909 0909 0909 6966 2028  ==0:........if (
-0003aa30: 6261 7365 756e 6974 203d 3d20 2770 7327  baseunit == 'ps'
-0003aa40: 2920 6f72 2028 6261 7365 756e 6974 203d  ) or (baseunit =
-0003aa50: 3d20 276e 7327 293a 0d0a 0909 0909 0909  = 'ns'):........
-0003aa60: 0964 732e 696e 6465 782e 6e61 6d65 3d27  .ds.index.name='
-0003aa70: 5469 6d65 2069 6e20 2573 2725 6261 7365  Time in %s'%base
-0003aa80: 756e 6974 0d0a 0909 0909 0909 656c 7365  unit........else
-0003aa90: 3a0d 0a09 0909 0909 0909 6473 2e69 6e64  :.........ds.ind
-0003aaa0: 6578 2e6e 616d 653d 2062 6173 6575 6e69  ex.name= baseuni
-0003aab0: 740d 0a09 0909 0965 7863 6570 743a 0d0a  t......except:..
-0003aac0: 0909 0909 0970 6173 730d 0a09 0909 656c  .....pass.....el
-0003aad0: 7365 3a0d 0a09 0909 0974 7279 3a0d 0a09  se:......try:...
-0003aae0: 0909 0909 6966 206c 656e 2864 732e 696e  ....if len(ds.in
-0003aaf0: 6465 782e 6e61 6d65 2921 3d30 3a0d 0a09  dex.name)!=0:...
-0003ab00: 0909 0909 0973 656c 662e 6261 7365 756e  .....self.baseun
-0003ab10: 6974 203d 2064 732e 696e 6465 782e 6e61  it = ds.index.na
-0003ab20: 6d65 0d0a 0909 0909 6578 6365 7074 3a0d  me......except:.
-0003ab30: 0a09 0909 0909 0970 6173 730d 0a09 0909  .......pass.....
-0003ab40: 7365 6c66 2e64 735f 6f72 693d 6473 0d0a  self.ds_ori=ds..
-0003ab50: 0909 0973 656c 662e 6473 3d64 730d 0a09  ...self.ds=ds...
-0003ab60: 0909 7365 6c66 2e5f 5f6d 616b 655f 7374  ..self.__make_st
-0003ab70: 616e 6461 7264 5f70 6172 616d 6574 6572  andard_parameter
-0003ab80: 2829 0d0a 0909 656c 6966 2028 2768 6466  ()....elif ('hdf
-0003ab90: 3527 2069 6e20 6669 6c65 6e61 6d65 2920  5' in filename) 
-0003aba0: 616e 6420 2863 6f6e 7665 7273 696f 6e5f  and (conversion_
-0003abb0: 6675 6e63 7469 6f6e 2069 7320 4e6f 6e65  function is None
-0003abc0: 293a 2377 6520 6c6f 6164 2061 2063 6f6e  ):#we load a con
-0003abd0: 7665 7273 696f 6e20 6675 6e63 7469 6f6e  version function
-0003abe0: 2074 6f20 6465 616c 2077 6974 6820 7468   to deal with th
-0003abf0: 6520 6669 6c65 3a23 7765 2072 6561 6420  e file:#we read 
-0003ac00: 696e 2064 6174 6120 6672 6f6d 2070 7265  in data from pre
-0003ac10: 7669 6f75 7320 7275 6e0d 0a09 0909 7365  vious run.....se
-0003ac20: 6c66 2e5f 5f72 6561 645f 7072 6f6a 6563  lf.__read_projec
-0003ac30: 7428 7361 7665 645f 7072 6f6a 6563 743d  t(saved_project=
-0003ac40: 6368 6563 6b5f 666f 6c64 6572 2870 6174  check_folder(pat
-0003ac50: 683d 7365 6c66 2e70 6174 682c 6669 6c65  h=self.path,file
-0003ac60: 6e61 6d65 3d73 656c 662e 6669 6c65 6e61  name=self.filena
-0003ac70: 6d65 2929 0d0a 0909 0973 656c 662e 5f5f  me)).....self.__
-0003ac80: 6d61 6b65 5f73 7461 6e64 6172 645f 7061  make_standard_pa
-0003ac90: 7261 6d65 7465 7228 290d 0a09 0909 7365  rameter().....se
-0003aca0: 6c66 2e43 6f72 5f43 6869 7270 2866 6974  lf.Cor_Chirp(fit
-0003acb0: 636f 6566 663d 7365 6c66 2e66 6974 636f  coeff=self.fitco
-0003acc0: 6566 6629 0d0a 0909 656c 7365 3a23 7765  eff)....else:#we
-0003acd0: 2072 6561 6420 696e 2072 6177 2064 6174   read in raw dat
-0003ace0: 6120 6672 6f6d 2073 6961 2046 696c 650d  a from sia File.
-0003acf0: 0a09 0909 6966 2063 6f6e 7665 7273 696f  ....if conversio
-0003ad00: 6e5f 6675 6e63 7469 6f6e 2069 7320 6e6f  n_function is no
-0003ad10: 7420 4e6f 6e65 3a0d 0a09 0909 0966 696c  t None:......fil
-0003ad20: 656e 616d 653d 6368 6563 6b5f 666f 6c64  ename=check_fold
-0003ad30: 6572 2870 6174 683d 7365 6c66 2e70 6174  er(path=self.pat
-0003ad40: 682c 6669 6c65 6e61 6d65 3d66 696c 656e  h,filename=filen
-0003ad50: 616d 6529 0909 0909 0909 0909 0909 2020  ame)..........  
-0003ad60: 200d 0a09 0909 0974 7279 3a0d 0a09 0909   ......try:.....
-0003ad70: 0909 7265 743d 636f 6e76 6572 7369 6f6e  ..ret=conversion
-0003ad80: 5f66 756e 6374 696f 6e28 6669 6c65 6e61  _function(filena
-0003ad90: 6d65 203d 2066 696c 656e 616d 652c 2065  me = filename, e
-0003ada0: 7874 6572 6e61 6c5f 7469 6d65 203d 2065  xternal_time = e
-0003adb0: 7874 6572 6e61 6c5f 7469 6d65 2c20 6578  xternal_time, ex
-0003adc0: 7465 726e 616c 5f77 6176 6520 3d20 6578  ternal_wave = ex
-0003add0: 7465 726e 616c 5f77 6176 6529 0d0a 0909  ternal_wave)....
-0003ade0: 0909 6578 6365 7074 3a0d 0a09 0909 0909  ..except:.......
-0003adf0: 7472 793a 0d0a 0909 0909 0909 7265 743d  try:........ret=
-0003ae00: 636f 6e76 6572 7369 6f6e 5f66 756e 6374  conversion_funct
-0003ae10: 696f 6e28 6669 6c65 6e61 6d65 203d 2066  ion(filename = f
-0003ae20: 696c 656e 616d 652c 2065 7874 6572 6e61  ilename, externa
-0003ae30: 6c5f 7469 6d65 203d 2065 7874 6572 6e61  l_time = externa
-0003ae40: 6c5f 7469 6d65 290d 0a09 0909 0909 6578  l_time).......ex
-0003ae50: 6365 7074 3a0d 0a09 0909 0909 0974 7279  cept:........try
-0003ae60: 3a0d 0a09 0909 0909 0909 7265 743d 636f  :.........ret=co
-0003ae70: 6e76 6572 7369 6f6e 5f66 756e 6374 696f  nversion_functio
-0003ae80: 6e28 6669 6c65 6e61 6d65 203d 2066 696c  n(filename = fil
-0003ae90: 656e 616d 652c 2065 7874 6572 6e61 6c5f  ename, external_
-0003aea0: 7761 7665 203d 2065 7874 6572 6e61 6c5f  wave = external_
-0003aeb0: 7761 7665 290d 0a09 0909 0909 0965 7863  wave)........exc
-0003aec0: 6570 743a 0d0a 0909 0909 0909 0974 7279  ept:.........try
-0003aed0: 3a0d 0a09 0909 0909 0909 0972 6574 3d63  :..........ret=c
-0003aee0: 6f6e 7665 7273 696f 6e5f 6675 6e63 7469  onversion_functi
-0003aef0: 6f6e 2866 696c 656e 616d 6520 3d20 6669  on(filename = fi
-0003af00: 6c65 6e61 6d65 290d 0a09 0909 0909 0909  lename).........
-0003af10: 6578 6365 7074 2045 7863 6570 7469 6f6e  except Exception
-0003af20: 2061 7320 653a 0d0a 0909 0909 0909 0909   as e:..........
-0003af30: 7072 696e 7428 6529 0d0a 0909 0909 0909  print(e)........
-0003af40: 0909 7265 7475 726e 2046 616c 7365 0d0a  ..return False..
-0003af50: 0909 0909 6966 2069 7369 6e73 7461 6e63  ....if isinstanc
-0003af60: 6528 7265 742c 7061 6e64 6173 2e44 6174  e(ret,pandas.Dat
-0003af70: 6146 7261 6d65 293a 0d0a 0909 0909 0923  aFrame):.......#
-0003af80: 2369 6d70 6f72 7420 6973 2077 6861 7420  #import is what 
-0003af90: 7765 2077 616e 7465 640d 0a09 0909 0909  we wanted.......
-0003afa0: 6473 3d72 6574 0d0a 0909 0909 656c 6966  ds=ret......elif
-0003afb0: 2069 7369 6e73 7461 6e63 6528 7265 742c   isinstance(ret,
-0003afc0: 7061 6e64 6173 2e53 6572 6965 7329 3a0d  pandas.Series):.
-0003afd0: 0a09 0909 0909 6473 3d72 6574 2e61 735f  ......ds=ret.as_
-0003afe0: 6672 616d 6528 290d 0a09 0909 0965 6c73  frame()......els
-0003aff0: 653a 0d0a 0909 0909 0969 6620 6c65 6e28  e:.......if len(
-0003b000: 7265 7429 203d 3d20 323a 0d0a 0909 0909  ret) == 2:......
-0003b010: 0909 6966 2064 6174 615f 7479 7065 2069  ..if data_type i
-0003b020: 7320 4e6f 6e65 3a0d 0a09 0909 0909 0909  s None:.........
-0003b030: 6473 2c64 6174 615f 7479 7065 3d72 6574  ds,data_type=ret
-0003b040: 0d0a 0909 0909 0909 656c 7365 3a0d 0a09  ........else:...
-0003b050: 0909 0909 0909 6473 2c5f 3d72 6574 0d0a  ......ds,_=ret..
-0003b060: 0909 0909 0965 6c69 6620 6c65 6e28 7265  .....elif len(re
-0003b070: 7429 203d 3d20 333a 0d0a 0909 0909 0909  t) == 3:........
-0003b080: 6966 2064 6174 615f 7479 7065 2069 7320  if data_type is 
-0003b090: 4e6f 6e65 3a0d 0a09 0909 0909 0909 6473  None:.........ds
-0003b0a0: 2c64 6174 615f 7479 7065 2c62 6173 6575  ,data_type,baseu
-0003b0b0: 6e69 743d 7265 740d 0a09 0909 0909 0965  nit=ret........e
-0003b0c0: 6c73 653a 0d0a 0909 0909 0909 0964 732c  lse:.........ds,
-0003b0d0: 5f2c 6261 7365 756e 6974 3d72 6574 0d0a  _,baseunit=ret..
-0003b0e0: 0909 0909 0965 6c73 653a 0d0a 0909 0909  .....else:......
-0003b0f0: 0909 7072 696e 7428 2773 6f72 7279 2074  ..print('sorry t
-0003b100: 6865 2072 6574 7572 6e20 666f 726d 6174  he return format
-0003b110: 206f 6620 7468 6520 636f 6e76 6572 7369   of the conversi
-0003b120: 6f6e 5f66 756e 6374 696f 6e20 7761 7320  on_function was 
-0003b130: 6e6f 7420 756e 6465 7273 746f 6f64 2729  not understood')
-0003b140: 0d0a 0909 0909 0909 7072 696e 7428 2772  ........print('r
-0003b150: 6574 7572 6e3a 2074 6865 2064 6174 6166  eturn: the dataf
-0003b160: 7261 6d65 2064 7320 7769 7468 2074 6865  rame ds with the
-0003b170: 2074 696d 655f 6178 6973 2061 7320 726f   time_axis as ro
-0003b180: 7773 2061 6e64 2073 7065 6374 7261 6c20  ws and spectral 
-0003b190: 6178 6973 2061 7320 636f 6c75 6d6e 735c  axis as columns\
-0003b1a0: 6e27 290d 0a09 0909 0909 0970 7269 6e74  n')........print
-0003b1b0: 2827 6966 2074 6865 2064 732e 696e 6465  ('if the ds.inde
-0003b1c0: 782e 6e61 6d65 2069 6120 6e6f 7420 656d  x.name ia not em
-0003b1d0: 7074 7920 7468 6520 2274 696d 6520 6178  pty the "time ax
-0003b1e0: 6973 2220 6973 2069 6e20 746f 2074 6861  is" is in to tha
-0003b1f0: 7420 6e61 6d65 2074 6865 2073 7065 6374  t name the spect
-0003b200: 7261 6c20 6178 6973 2069 7320 696e 2064  ral axis is in d
-0003b210: 732e 636f 6c75 6d6e 732e 6e61 6d65 5c6e  s.columns.name\n
-0003b220: 2729 0d0a 0909 0909 0909 7072 696e 7428  ')........print(
-0003b230: 2774 6865 2072 6574 7572 6e20 6973 2069  'the return is i
-0003b240: 6e76 6573 7469 6761 7465 6420 6966 2069  nvestigated if i
-0003b250: 7420 6973 206f 6e65 2c20 7477 6f2c 206f  t is one, two, o
-0003b260: 7220 7468 7265 6520 7468 696e 6773 2e5c  r three things.\
-0003b270: 6e20 2729 0d0a 0909 0909 0909 7072 696e  n ')........prin
-0003b280: 7428 2769 6620 7477 6f20 6172 6520 7265  t('if two are re
-0003b290: 7475 726e 6564 2074 6865 6e20 7468 6520  turned then the 
-0003b2a0: 7365 636f 6e64 206d 7573 7420 6265 2074  second must be t
-0003b2b0: 6865 206e 616d 6520 6f66 2077 6861 7420  he name of what 
-0003b2c0: 7468 6520 696e 7465 6e73 6974 7920 6178  the intensity ax
-0003b2d0: 6973 2069 732e 2054 6869 7320 7661 6c75  is is. This valu
-0003b2e0: 6520 7769 6c6c 2074 6865 6e20 6265 2073  e will then be s
-0003b2f0: 6574 2074 6f20 6461 7461 5f74 7970 655c  et to data_type\
-0003b300: 6e27 290d 0a09 0909 0909 0970 7269 6e74  n')........print
-0003b310: 2827 6966 2074 6872 6565 2061 7265 2072  ('if three are r
-0003b320: 6574 7572 6e65 6420 7468 6520 7468 6972  eturned the thir
-0003b330: 6420 6973 2074 6865 2062 6173 6575 6e69  d is the baseuni
-0003b340: 7420 2866 6f72 2074 6865 2074 696d 6520  t (for the time 
-0003b350: 6178 6973 2920 7468 6973 2061 6c6c 6f77  axis) this allow
-0003b360: 7320 746f 2075 7365 2074 6865 2061 7574  s to use the aut
-0003b370: 6f6d 6174 6963 206e 616d 696e 6720 696e  omatic naming in
-0003b380: 2070 7320 6f72 206e 7320 2720 290d 0a09   ps or ns ' )...
-0003b390: 0909 0909 0972 6574 7572 6e20 4661 6c73  .....return Fals
-0003b3a0: 650d 0a09 0909 0923 2320 7365 6520 6966  e......## see if
-0003b3b0: 2077 6520 6861 7665 2074 6865 206e 616d   we have the nam
-0003b3c0: 6520 6120 6461 7461 2074 7970 6573 2069  e a data types i
-0003b3d0: 6e20 7468 6520 6461 7461 200d 0a09 0909  n the data .....
-0003b3e0: 0969 6620 6461 7461 5f74 7970 6520 6973  .if data_type is
-0003b3f0: 206e 6f74 204e 6f6e 653a 0d0a 0909 0909   not None:......
-0003b400: 0973 656c 662e 6461 7461 5f74 7970 6520  .self.data_type 
-0003b410: 3d20 6461 7461 5f74 7970 650d 0a09 0909  = data_type.....
-0003b420: 0969 6620 756e 6974 7320 6973 206e 6f74  .if units is not
-0003b430: 204e 6f6e 653a 0d0a 0909 0909 0973 656c   None:.......sel
-0003b440: 662e 756e 6974 7320 3d20 756e 6974 730d  f.units = units.
-0003b450: 0a09 0909 0909 7472 793a 0d0a 0909 0909  ......try:......
-0003b460: 0909 6966 206c 656e 2864 732e 636f 6c75  ..if len(ds.colu
-0003b470: 6d6e 732e 6e61 6d65 293d 3d30 3a0d 0a09  mns.name)==0:...
-0003b480: 0909 0909 0909 6473 2e63 6f6c 756d 6e73  ......ds.columns
-0003b490: 2e6e 616d 653d 2075 6e69 7473 0d0a 0909  .name= units....
-0003b4a0: 0909 0965 7863 6570 743a 0d0a 0909 0909  ...except:......
-0003b4b0: 0909 7061 7373 0d0a 0909 0909 656c 7365  ..pass......else
-0003b4c0: 3a0d 0a09 0909 0909 7472 793a 0d0a 0909  :.......try:....
-0003b4d0: 0909 0909 6966 206c 656e 2864 732e 636f  ....if len(ds.co
-0003b4e0: 6c75 6d6e 732e 6e61 6d65 2921 3d30 3a0d  lumns.name)!=0:.
-0003b4f0: 0a09 0909 0909 0909 7365 6c66 2e75 6e69  ........self.uni
-0003b500: 7473 203d 2064 732e 636f 6c75 6d6e 732e  ts = ds.columns.
-0003b510: 6e61 6d65 200d 0a09 0909 0909 6578 6365  name .......exce
-0003b520: 7074 3a0d 0a09 0909 0909 0970 6173 730d  pt:........pass.
-0003b530: 0a09 0909 0969 6620 6261 7365 756e 6974  .....if baseunit
-0003b540: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a09   is not None:...
-0003b550: 0909 0909 7365 6c66 2e62 6173 6575 6e69  ....self.baseuni
-0003b560: 7420 3d20 6261 7365 756e 6974 0d0a 0909  t = baseunit....
-0003b570: 0909 0974 7279 3a0d 0a09 0909 0909 0969  ...try:........i
-0003b580: 6620 6c65 6e28 6473 2e69 6e64 6578 2e6e  f len(ds.index.n
-0003b590: 616d 6529 3d3d 303a 0d0a 0909 0909 0909  ame)==0:........
-0003b5a0: 0969 6620 2862 6173 6575 6e69 7420 3d3d  .if (baseunit ==
-0003b5b0: 2027 7073 2729 206f 7220 2862 6173 6575   'ps') or (baseu
-0003b5c0: 6e69 7420 3d3d 2027 6e73 2729 3a0d 0a09  nit == 'ns'):...
-0003b5d0: 0909 0909 0909 0964 732e 696e 6465 782e  .......ds.index.
-0003b5e0: 6e61 6d65 3d27 5469 6d65 2069 6e20 2573  name='Time in %s
-0003b5f0: 2725 6261 7365 756e 6974 0d0a 0909 0909  '%baseunit......
-0003b600: 0909 0965 6c73 653a 0d0a 0909 0909 0909  ...else:........
-0003b610: 0909 6473 2e69 6e64 6578 2e6e 616d 653d  ..ds.index.name=
-0003b620: 2062 6173 6575 6e69 740d 0a09 0909 0909   baseunit.......
-0003b630: 6578 6365 7074 3a0d 0a09 0909 0909 0970  except:........p
-0003b640: 6173 730d 0a09 0909 0965 6c73 653a 0d0a  ass......else:..
-0003b650: 0909 0909 0974 7279 3a0d 0a09 0909 0909  .....try:.......
-0003b660: 0969 6620 6c65 6e28 6473 2e69 6e64 6578  .if len(ds.index
-0003b670: 2e6e 616d 6529 213d 303a 0d0a 0909 0909  .name)!=0:......
-0003b680: 0909 0973 656c 662e 6261 7365 756e 6974  ...self.baseunit
-0003b690: 203d 2064 732e 696e 6465 782e 6e61 6d65   = ds.index.name
-0003b6a0: 0d0a 0909 0909 0965 7863 6570 743a 0d0a  .......except:..
-0003b6b0: 0909 0909 0909 0970 6173 730d 0a09 0909  .......pass.....
-0003b6c0: 0969 6620 7368 6966 745f 7469 6d65 735f  .if shift_times_
-0003b6d0: 6279 2069 7320 6e6f 7420 4e6f 6e65 3a0d  by is not None:.
-0003b6e0: 0a09 0909 0909 6473 2e69 6e64 6578 3d64  ......ds.index=d
-0003b6f0: 732e 696e 6465 782e 7661 6c75 6573 2b73  s.index.values+s
-0003b700: 6869 6674 5f74 696d 6573 5f62 790d 0a09  hift_times_by...
-0003b710: 0909 0969 6620 6469 7669 6465 5f74 696d  ...if divide_tim
-0003b720: 6573 5f62 7920 6973 206e 6f74 204e 6f6e  es_by is not Non
-0003b730: 653a 0d0a 0909 0909 0964 732e 696e 6465  e:.......ds.inde
-0003b740: 783d 6473 2e69 6e64 6578 2e76 616c 7565  x=ds.index.value
-0003b750: 732f 6469 7669 6465 5f74 696d 6573 5f62  s/divide_times_b
-0003b760: 790d 0a09 0909 0973 656c 662e 6473 5f6f  y......self.ds_o
-0003b770: 7269 3d64 730d 0a09 0909 0973 656c 662e  ri=ds......self.
-0003b780: 6473 3d64 730d 0a09 0909 656c 7365 3a0d  ds=ds.....else:.
-0003b790: 0a09 0909 0973 656c 662e 5f5f 7265 6164  .....self.__read
-0003b7a0: 5f61 7363 6969 5f64 6174 6128 7365 7020  _ascii_data(sep 
-0003b7b0: 3d20 7365 702c 2064 6563 696d 616c 203d  = sep, decimal =
-0003b7c0: 2064 6563 696d 616c 2c20 696e 6465 785f   decimal, index_
-0003b7d0: 6973 5f65 6e65 7267 7920 3d20 696e 6465  is_energy = inde
-0003b7e0: 785f 6973 5f65 6e65 7267 792c 200d 0a09  x_is_energy, ...
-0003b7f0: 0909 0909 0909 0909 7472 616e 7370 6f73  ........transpos
-0003b800: 6520 3d20 7472 616e 7370 6f73 652c 2073  e = transpose, s
-0003b810: 6f72 745f 696e 6465 7865 7320 3d20 736f  ort_indexes = so
-0003b820: 7274 5f69 6e64 6578 6573 2c20 0d0a 0909  rt_indexes, ....
-0003b830: 0909 0909 0909 0964 6976 6964 655f 7469  .......divide_ti
-0003b840: 6d65 735f 6279 203d 2064 6976 6964 655f  mes_by = divide_
-0003b850: 7469 6d65 735f 6279 2c20 7368 6966 745f  times_by, shift_
-0003b860: 7469 6d65 735f 6279 203d 2073 6869 6674  times_by = shift
-0003b870: 5f74 696d 6573 5f62 792c 200d 0a09 0909  _times_by, .....
-0003b880: 0909 0909 0909 6578 7465 726e 616c 5f74  ......external_t
-0003b890: 696d 6520 3d20 6578 7465 726e 616c 5f74  ime = external_t
-0003b8a0: 696d 652c 2065 7874 6572 6e61 6c5f 7761  ime, external_wa
-0003b8b0: 7665 203d 2065 7874 6572 6e61 6c5f 7761  ve = external_wa
-0003b8c0: 7665 2c20 0d0a 0909 0909 0909 0909 0975  ve, ...........u
-0003b8d0: 7365 5f73 616d 655f 6e61 6d65 203d 2075  se_same_name = u
-0003b8e0: 7365 5f73 616d 655f 6e61 6d65 2c20 6461  se_same_name, da
-0003b8f0: 7461 5f74 7970 6520 3d20 6461 7461 5f74  ta_type = data_t
-0003b900: 7970 652c 2075 6e69 7473 203d 2075 6e69  ype, units = uni
-0003b910: 7473 2c20 200d 0a09 0909 0909 0909 0909  ts,  ...........
-0003b920: 6261 7365 756e 6974 203d 2062 6173 6575  baseunit = baseu
-0003b930: 6e69 7429 0d0a 0909 0973 656c 662e 5f5f  nit).....self.__
-0003b940: 6d61 6b65 5f73 7461 6e64 6172 645f 7061  make_standard_pa
-0003b950: 7261 6d65 7465 7228 290d 0a09 0909 6966  rameter().....if
-0003b960: 206c 656e 2873 656c 662e 6473 2e63 6f6c   len(self.ds.col
-0003b970: 756d 6e73 2e76 616c 7565 7329 3c32 3a0d  umns.values)<2:.
-0003b980: 0a09 0909 0973 656c 662e 7265 6c5f 7761  .....self.rel_wa
-0003b990: 7665 3d5b 7365 6c66 2e64 732e 636f 6c75  ve=[self.ds.colu
-0003b9a0: 6d6e 732e 7661 6c75 6573 5b30 5d5d 0909  mns.values[0]]..
-0003b9b0: 0909 0909 0909 090d 0a0d 0a0d 0a09 6465  ..............de
-0003b9c0: 6620 5f5f 7265 6164 5f61 7363 6969 5f64  f __read_ascii_d
-0003b9d0: 6174 6128 7365 6c66 2c20 7365 7020 3d20  ata(self, sep = 
-0003b9e0: 225c 7422 2c20 6465 6369 6d61 6c20 3d20  "\t", decimal = 
-0003b9f0: 272e 272c 2069 6e64 6578 5f69 735f 656e  '.', index_is_en
-0003ba00: 6572 6779 203d 2046 616c 7365 2c20 7472  ergy = False, tr
-0003ba10: 616e 7370 6f73 6520 3d20 4661 6c73 652c  anspose = False,
-0003ba20: 0d0a 0909 0909 0909 0973 6f72 745f 696e  .........sort_in
-0003ba30: 6465 7865 7320 3d20 4661 6c73 652c 2064  dexes = False, d
-0003ba40: 6976 6964 655f 7469 6d65 735f 6279 203d  ivide_times_by =
-0003ba50: 204e 6f6e 652c 2073 6869 6674 5f74 696d   None, shift_tim
-0003ba60: 6573 5f62 7920 3d20 4e6f 6e65 2c20 0d0a  es_by = None, ..
-0003ba70: 0909 0909 0909 0965 7874 6572 6e61 6c5f  .......external_
-0003ba80: 7469 6d65 203d 204e 6f6e 652c 2065 7874  time = None, ext
-0003ba90: 6572 6e61 6c5f 7761 7665 203d 204e 6f6e  ernal_wave = Non
-0003baa0: 652c 2075 7365 5f73 616d 655f 6e61 6d65  e, use_same_name
-0003bab0: 203d 2054 7275 652c 2063 6f72 7265 6374   = True, correct
-0003bac0: 5f61 7363 6969 5f65 7272 6f72 7320 3d20  _ascii_errors = 
-0003bad0: 5472 7565 2c0d 0a09 0909 0909 0909 6461  True,.........da
-0003bae0: 7461 5f74 7970 6520 3d20 4e6f 6e65 2c20  ta_type = None, 
-0003baf0: 756e 6974 7320 3d20 4e6f 6e65 2c20 2062  units = None,  b
-0003bb00: 6173 6575 6e69 7420 3d20 4e6f 6e65 293a  aseunit = None):
-0003bb10: 0d0a 0909 2727 2746 616e 6379 2066 756e  ....'''Fancy fun
-0003bb20: 6374 696f 6e20 7468 6174 2068 616e 646c  ction that handl
-0003bb30: 6573 2074 6865 2069 6d70 6f72 7420 6f66  es the import of
-0003bb40: 2070 7572 6520 6173 6369 6920 6669 6c65   pure ascii file
-0003bb50: 732e 0d0a 0909 0d0a 0909 5061 7261 6d65  s.........Parame
-0003bb60: 7465 7273 0d0a 0909 2d2d 2d2d 2d2d 2d2d  ters....--------
-0003bb70: 2d2d 0d0a 0909 0d0a 0909 7365 7020 3a20  --........sep : 
-0003bb80: 7374 7220 286f 7074 696f 6e61 6c29 0d0a  str (optional)..
-0003bb90: 0909 0969 7320 7468 6520 7365 7061 7261  ...is the separa
-0003bba0: 746f 7220 6265 7477 6565 6e20 6469 6666  tor between diff
-0003bbb0: 6572 656e 7420 6e75 6d62 6572 732c 2074  erent numbers, t
-0003bbc0: 7970 6963 616c 2061 7265 2074 6170 2028  ypical are tap (
-0003bbd0: 4261 636b 736c 6173 6820 7429 2028 4465  Backslash t) (De
-0003bbe0: 6661 756c 7429 202c 6f6e 6520 6f72 200d  fault) ,one or .
-0003bbf0: 0a09 0909 6d75 6c74 6970 6c65 2077 6869  ....multiple whi
-0003bc00: 7465 2073 7061 6365 7320 2762 6163 6b73  te spaces 'backs
-0003bc10: 6c61 7368 2073 2b27 206f 7220 636f 6d6d  lash s+' or comm
-0003bc20: 6120 272c 272e 0d0a 0909 0d0a 0909 6465  a ','.........de
-0003bc30: 6369 6d61 6c20 3a20 7374 7220 286f 7074  cimal : str (opt
-0003bc40: 696f 6e61 6c29 200d 0a09 0909 7365 7473  ional) .....sets
-0003bc50: 2074 6865 2061 7363 6969 2073 796d 626f   the ascii symbo
-0003bc60: 6c20 7468 6174 2069 7320 7573 6564 2066  l that is used f
-0003bc70: 6f72 2074 6865 2064 6563 696d 616c 2073  or the decimal s
-0003bc80: 6967 6e2e 2049 6e20 6d6f 7374 2063 6f75  ign. In most cou
-0003bc90: 6e74 7269 6573 2074 6869 7320 6973 2027  ntries this is '
-0003bca0: 2e27 2844 6566 6175 6c74 2920 0d0a 0909  .'(Default) ....
-0003bcb0: 0962 7574 2069 7420 6361 6e20 6265 2027  .but it can be '
-0003bcc0: 2c27 2069 6e20 636f 756e 7472 6965 7320  ,' in countries 
-0003bcd0: 6c69 6b65 2053 7765 6465 6e20 6f72 2047  like Sweden or G
-0003bce0: 6572 6d61 6e79 0d0a 0909 0d0a 0909 696e  ermany........in
-0003bcf0: 6465 785f 6973 5f65 6e65 7267 7920 3a20  dex_is_energy : 
-0003bd00: 626f 6f6c 2028 6f70 7469 6f6e 616c 290d  bool (optional).
-0003bd10: 0a09 0909 7377 6974 6368 6573 2069 6620  ....switches if 
-0003bd20: 7468 6520 7761 7665 6c65 6e67 7468 2069  the wavelength i
-0003bd30: 7320 6769 7665 6e20 696e 206e 6d20 2844  s given in nm (D
-0003bd40: 6566 6175 6c74 2920 6f72 2069 6e20 6556  efault) or in eV
-0003bd50: 2028 6966 2054 7275 6529 2c20 6375 7272   (if True), curr
-0003bd60: 656e 746c 7920 6576 6572 7974 6869 6e67  ently everything
-0003bd70: 200d 0a09 0909 6973 2068 616e 646c 6564   .....is handled
-0003bd80: 2061 7320 7761 7665 6c65 6e67 7468 2069   as wavelength i
-0003bd90: 6e20 6e6d 2069 6e74 6572 6e61 6c6c 790d  n nm internally.
-0003bda0: 0a09 090d 0a09 0964 6174 615f 7479 7065  .......data_type
-0003bdb0: 3a20 7374 7220 286f 7074 696f 6e61 6c29  : str (optional)
-0003bdc0: 0d0a 0909 0964 6174 615f 7479 7065 2069  .....data_type i
-0003bdd0: 7320 7468 6520 7374 7269 6e67 2074 6861  s the string tha
-0003bde0: 7420 7265 7072 6573 656e 7473 2074 6865  t represents the
-0003bdf0: 2069 6e74 656e 7369 7479 206d 6561 7375   intensity measu
-0003be00: 7265 6d65 6e74 732e 2055 7375 616c 6c79  rements. Usually
-0003be10: 2074 6869 7320 636f 6e74 6169 6e73 2069   this contains i
-0003be20: 6620 6162 736f 6c75 7465 200d 0a09 0909  f absolute .....
-0003be30: 6f66 2064 6966 6665 7265 6e74 6961 6c20  of differential 
-0003be40: 6461 7461 2e20 5468 6973 2069 7320 7573  data. This is us
-0003be50: 6564 2066 6f72 2074 6865 2063 6f6c 6f72  ed for the color
-0003be60: 2069 6e74 656e 7369 7479 2069 6e20 7468   intensity in th
-0003be70: 6520 3264 2070 6c6f 7473 2061 6e64 2074  e 2d plots and t
-0003be80: 6865 2079 2d61 7869 7320 666f 7220 7468  he y-axis for th
-0003be90: 6520 3164 2070 6c6f 7473 0d0a 0909 0d0a  e 1d plots......
-0003bea0: 0909 756e 6974 733a 2073 7472 2028 6f70  ..units: str (op
-0003beb0: 7469 6f6e 616c 290d 0a09 0909 7468 6973  tional).....this
-0003bec0: 2069 7320 7573 6564 2074 6f20 6964 656e   is used to iden
-0003bed0: 7469 6679 2074 6865 2075 6e69 7473 206f  tify the units o
-0003bee0: 6e20 7468 6520 656e 6572 6779 2061 7869  n the energy axi
-0003bef0: 7320 616e 6420 746f 206c 6162 656c 2074  s and to label t
-0003bf00: 6865 2073 6c69 6365 732c 2072 6563 6f67  he slices, recog
-0003bf10: 6e69 7a65 6420 6973 2027 6e6d 272c 2027  nized is 'nm', '
-0003bf20: 6556 2720 616e 6420 276b 6556 2720 0d0a  eV' and 'keV' ..
-0003bf30: 0909 0962 7574 2069 6620 616e 6f74 6865  ...but if anothe
-0003bf40: 7220 756e 6974 206c 696b 6520 2763 6d5e  r unit like 'cm^
-0003bf50: 2d31 2720 6973 2075 7365 6420 6974 2077  -1' is used it w
-0003bf60: 696c 6c20 7374 6174 6520 656e 6572 6779  ill state energy
-0003bf70: 2069 6e20 2763 6d5e 2d31 272e 2050 6c65   in 'cm^-1'. Ple
-0003bf80: 6173 206f 6273 6572 7665 2074 6861 7420  as observe that 
-0003bf90: 6966 2079 6f75 2075 7365 2074 6865 2069  if you use the i
-0003bfa0: 6e64 6578 5f69 735f 656e 6572 6779 0d0a  ndex_is_energy..
-0003bfb0: 0909 0973 7769 7463 6820 7468 6520 7072  ...switch the pr
-0003bfc0: 6f67 7261 6d20 7472 6965 7320 746f 2063  ogram tries to c
-0003bfd0: 6f6e 7665 7274 2074 6869 7320 656e 6572  onvert this ener
-0003bfe0: 6779 2069 6e74 6f20 7761 7665 6c65 6e67  gy into waveleng
-0003bff0: 7468 2e20 0d0a 0909 0d0a 0909 6261 7365  th. ........base
-0003c000: 756e 6974 3a20 7374 7220 286f 7074 696f  unit: str (optio
-0003c010: 6e61 6c29 0d0a 0909 0974 6869 7320 6973  nal).....this is
-0003c020: 2075 7365 6420 746f 2069 6465 6e74 6966   used to identif
-0003c030: 7920 7468 6520 756e 6974 7320 6f6e 2074  y the units on t
-0003c040: 6865 2064 6576 656c 6f70 696e 672f 7469  he developing/ti
-0003c050: 6d65 2061 7869 732e 2054 6869 7320 6973  me axis. This is
-0003c060: 206e 616d 6520 7468 6174 2069 7320 6174   name that is at
-0003c070: 7461 6368 6564 2074 6f20 7468 6520 696e  tached to the in
-0003c080: 6465 7820 6f66 2074 6865 2064 6174 6166  dex of the dataf
-0003c090: 7261 6d65 2e20 0d0a 0909 0973 6574 7469  rame. .....setti
-0003c0a0: 6e67 2074 6869 7320 6475 7269 6e67 2069  ng this during i
-0003c0b0: 6d70 6f72 7420 6973 2065 7175 6976 616c  mport is equival
-0003c0c0: 656e 7420 746f 2074 612e 6261 7365 756e  ent to ta.baseun
-0003c0d0: 6974 0d0a 0909 0d0a 0909 7472 616e 7370  it........transp
-0003c0e0: 6f73 6520 3a20 626f 6f6c 2028 6f70 7469  ose : bool (opti
-0003c0f0: 6f6e 616c 290d 0a09 0909 6966 2074 6869  onal).....if thi
-0003c100: 7320 7377 6974 6368 2069 7320 4661 6c73  s switch is Fals
-0003c110: 6520 2844 6566 6175 6c74 2920 7468 6520  e (Default) the 
-0003c120: 7761 7665 6c65 6e67 7468 2061 7265 2074  wavelength are t
-0003c130: 6865 2063 6f6c 756d 6e73 2061 6e64 2074  he columns and t
-0003c140: 6865 2072 6f77 7320 7468 6520 7469 6d65  he rows the time
-0003c150: 732e 0d0a 0909 0d0a 0909 736f 7274 5f69  s.........sort_i
-0003c160: 6e64 6578 6573 203a 2062 6f6f 6c20 286f  ndexes : bool (o
-0003c170: 7074 696f 6e61 6c29 0d0a 0909 0946 6f72  ptional).....For
-0003c180: 2046 616c 7365 2028 4465 6661 756c 7429   False (Default)
-0003c190: 2049 2061 7373 756d 6520 7468 6174 2074   I assume that t
-0003c1a0: 6865 2074 696d 6573 2061 6e64 2065 6e65  he times and ene
-0003c1b0: 7267 6965 7320 6172 6520 616c 7265 6164  rgies are alread
-0003c1c0: 7920 696e 2061 2072 6973 696e 6720 6f72  y in a rising or
-0003c1d0: 6465 722e 200d 0a09 0909 7769 7468 2074  der. .....with t
-0003c1e0: 6869 7320 7377 6974 6368 2c20 626f 7468  his switch, both
-0003c1f0: 2061 7265 2073 6f72 7465 6420 6167 6169   are sorted agai
-0003c200: 6e2e 200d 0a09 090d 0a09 0964 6976 6964  n. ........divid
-0003c210: 655f 7469 6d65 735f 6279 203a 204e 6f6e  e_times_by : Non
-0003c220: 6520 6f72 2066 6c6f 6174 2028 6f70 7469  e or float (opti
-0003c230: 6f6e 616c 2920 0d0a 0909 0968 6572 6520  onal) .....here 
-0003c240: 6120 6e75 6d62 6572 2063 616e 2062 6520  a number can be 
-0003c250: 6769 7665 6e20 7468 6174 2073 6361 6c65  given that scale
-0003c260: 7320 7468 6520 7469 6d65 2062 7920 616e  s the time by an
-0003c270: 2061 7262 6974 6172 7920 6661 6374 6f72   arbitary factor
-0003c280: 2e20 5468 6973 2069 7320 6163 7475 616c  . This is actual
-0003c290: 6c79 2064 6976 6964 696e 670d 0a09 0909  ly dividing.....
-0003c2a0: 7468 6520 7469 6d65 7320 6279 2074 6869  the times by thi
-0003c2b0: 7320 7661 6c75 652e 2041 6c74 6572 6e61  s value. Alterna
-0003c2c0: 7469 7665 6c79 2074 6865 7265 2069 7320  tively there is 
-0003c2d0: 7468 6520 7661 7269 6162 6c65 2073 656c  the variable sel
-0003c2e0: 662e 6261 7365 756e 6974 2e20 5468 6520  f.baseunit. The 
-0003c2f0: 6c61 7474 6572 206f 6e6c 7920 6166 6665  latter only affe
-0003c300: 6374 7320 0d0a 0909 0977 6861 7420 6973  cts .....what is
-0003c310: 2077 7269 7474 656e 206f 6e20 7468 6520   written on the 
-0003c320: 6178 6973 2c20 7768 696c 6520 7468 6973  axis, while this
-0003c330: 2076 616c 7565 2069 7320 6163 7475 616c   value is actual
-0003c340: 6c79 2075 7365 6420 746f 2073 6361 6c65  ly used to scale
-0003c350: 2074 6865 2074 696d 6573 2e20 4e6f 6e65   the times. None
-0003c360: 2028 4465 6661 756c 7429 200d 0a09 0909   (Default) .....
-0003c370: 6967 6e6f 7265 7320 7468 6973 0d0a 0909  ignores this....
-0003c380: 0d0a 0909 7368 6966 745f 7469 6d65 735f  ....shift_times_
-0003c390: 6279 203a 204e 6f6e 652c 2066 6c6f 6174  by : None, float
-0003c3a0: 2028 6f70 7469 6f6e 616c 290d 0a09 0909   (optional).....
-0003c3b0: 5468 6973 2061 2076 616c 7565 2062 7920  This a value by 
-0003c3c0: 7768 6963 6820 7468 6520 7469 6d65 2061  which the time a
-0003c3d0: 7869 7320 6973 2073 6869 6674 6564 2064  xis is shifted d
-0003c3e0: 7572 696e 6720 696d 706f 7274 2e20 5468  uring import. Th
-0003c3f0: 6973 2069 7320 6120 7573 6566 756c 206f  is is a useful o
-0003c400: 7074 696f 6e20 6f66 2065 2e67 2e20 0d0a  ption of e.g. ..
-0003c410: 0909 0974 6865 2072 6563 6f72 6469 6e67  ...the recording
-0003c420: 2073 6f66 7477 6172 6520 646f 6573 206e   software does n
-0003c430: 6f74 2063 6f6d 7065 6e73 6174 6520 666f  ot compensate fo
-0003c440: 7220 7430 2061 6e64 2074 6865 2064 6174  r t0 and the dat
-0003c450: 6120 6973 2061 6c77 6179 7320 7368 6966  a is always shif
-0003c460: 7465 642e 200d 0a09 0909 4e6f 6e65 2028  ted. .....None (
-0003c470: 4465 6661 756c 7429 2069 676e 6f72 6573  Default) ignores
-0003c480: 2074 6869 7320 7365 7474 696e 670d 0a09   this setting...
-0003c490: 090d 0a09 0965 7874 6572 6e61 6c5f 7469  .....external_ti
-0003c4a0: 6d65 203a 204e 6f6e 6520 6f72 2073 7472  me : None or str
-0003c4b0: 2028 6f70 7469 6f6e 616c 290d 0a09 0909   (optional).....
-0003c4c0: 4865 7265 2061 2066 696c 656e 616d 6520  Here a filename 
-0003c4d0: 6578 7465 6e73 696f 6e20 2873 7472 696e  extension (strin
-0003c4e0: 6729 2063 616e 2062 6520 6769 7665 6e20  g) can be given 
-0003c4f0: 7468 6174 2063 6f6e 7461 696e 7320 7468  that contains th
-0003c500: 6520 7469 6d65 2076 6563 746f 722e 200d  e time vector. .
-0003c510: 0a09 0909 5468 6520 6669 6c65 2069 7320  ....The file is 
-0003c520: 6173 7375 6d65 6420 746f 2062 6520 6174  assumed to be at
-0003c530: 2074 6865 2073 616d 6520 7061 7468 2061   the same path a
-0003c540: 7320 7468 6520 6461 7461 2061 6e64 2074  s the data and t
-0003c550: 6f20 636f 6e74 6169 6e20 6120 7369 6e67  o contain a sing
-0003c560: 6c65 200d 0a09 0909 7479 7065 206f 6620  le .....type of 
-0003c570: 7365 7061 7261 7465 6420 6461 7461 2077  separated data w
-0003c580: 6974 686f 7574 2068 6561 6465 722e 200d  ithout header. .
-0003c590: 0a09 0909 4966 2075 7365 5f73 616d 655f  ....If use_same_
-0003c5a0: 6e61 6d65 203d 2054 7275 6520 2864 6566  name = True (def
-0003c5b0: 6175 6c74 290d 0a09 0909 4974 2061 7373  ault).....It ass
-0003c5c0: 756d 6573 2074 6861 7420 7468 6973 2069  umes that this i
-0003c5d0: 7320 7468 6520 656e 6469 6e67 2066 6f72  s the ending for
-0003c5e0: 2074 6865 2066 696c 652e 2054 6865 2066   the file. The f
-0003c5f0: 696c 656e 616d 6520 6974 7365 6c66 2069  ilename itself i
-0003c600: 7320 7461 6b65 6e20 6672 6f6d 2074 6865  s taken from the
-0003c610: 2066 696c 656e 616d 652e 200d 0a09 0909   filename. .....
-0003c620: 652e 672e 2069 6620 7361 6d70 312e 7478  e.g. if samp1.tx
-0003c630: 7420 6973 2074 6865 2066 696c 656e 616d  t is the filenam
-0003c640: 6520 616e 6420 6578 7465 726e 616c 5f74  e and external_t
-0003c650: 696d 653d 272e 7469 6427 2074 6865 2070  ime='.tid' the p
-0003c660: 726f 6772 616d 2073 6561 7263 6865 7320  rogram searches 
-0003c670: 0d0a 0909 0973 616d 7031 2e74 6964 2066  .....samp1.tid f
-0003c680: 6f72 2074 6865 2074 696d 6573 2e20 5468  or the times. Th
-0003c690: 6520 7472 616e 7370 6f73 6520 7365 7474  e transpose sett
-0003c6a0: 696e 6720 6973 2061 7070 6c69 6564 2061  ing is applied a
-0003c6b0: 6e64 2073 6574 7320 7768 6572 6520 7468  nd sets where th
-0003c6c0: 6520 7469 6d65 7320 6172 6520 0d0a 0909  e times are ....
-0003c6d0: 0974 6f20 6265 2069 6e73 6572 7465 6420  .to be inserted 
-0003c6e0: 2872 6f77 206f 7220 636f 6c75 6d6e 2069  (row or column i
-0003c6f0: 6e64 6578 6573 290d 0a09 0909 4966 2075  ndexes).....If u
-0003c700: 7365 5f73 616d 655f 6e61 6d65 203d 2046  se_same_name = F
-0003c710: 616c 7365 2074 6869 7320 7368 6f75 6c64  alse this should
-0003c720: 2062 6520 7468 6520 6669 6c65 2063 6f6e   be the file con
-0003c730: 7461 696e 696e 6720 7468 6520 7665 6374  taining the vect
-0003c740: 6f72 2066 6f72 2074 6865 2074 696d 6520  or for the time 
-0003c750: 2869 6e20 7468 6520 7361 6d65 2066 6f72  (in the same for
-0003c760: 6d61 7420 6173 2074 6865 206d 6169 6e20  mat as the main 
-0003c770: 6669 6c65 290d 0a09 090d 0a09 0965 7874  file)........ext
-0003c780: 6572 6e61 6c5f 7761 7665 203a 204e 6f6e  ernal_wave : Non
-0003c790: 6520 6f72 2073 7472 2028 6f70 7469 6f6e  e or str (option
-0003c7a0: 616c 2920 0d0a 0909 0948 6572 6520 6120  al) .....Here a 
-0003c7b0: 6669 6c65 6e61 6d65 2065 7874 656e 7369  filename extensi
-0003c7c0: 6f6e 2028 7374 7269 6e67 2920 6361 6e20  on (string) can 
-0003c7d0: 6265 2067 6976 656e 2074 6861 7420 636f  be given that co
-0003c7e0: 6e74 6169 6e73 2074 6865 2077 6176 656c  ntains the wavel
-0003c7f0: 656e 6774 6820 7665 6374 6f72 2e20 0d0a  ength vector. ..
-0003c800: 0909 0949 6620 7573 655f 7361 6d65 5f6e  ...If use_same_n
-0003c810: 616d 6520 3d20 5472 7565 2028 6465 6661  ame = True (defa
-0003c820: 756c 7429 0d0a 0909 0954 6865 2066 696c  ult).....The fil
-0003c830: 6520 6973 2061 7373 756d 6564 2074 6f20  e is assumed to 
-0003c840: 6265 2061 7420 7468 6520 7361 6d65 2070  be at the same p
-0003c850: 6174 6820 6173 2074 6865 2064 6174 6120  ath as the data 
-0003c860: 616e 6420 746f 2063 6f6e 7461 696e 2061  and to contain a
-0003c870: 2073 696e 676c 6520 7479 7065 200d 0a09   single type ...
-0003c880: 0909 6f66 2073 6570 6172 6174 6564 2064  ..of separated d
-0003c890: 6174 6120 7769 7468 6f75 7420 6865 6164  ata without head
-0003c8a0: 6572 2e20 5468 6973 2069 7320 7468 6520  er. This is the 
-0003c8b0: 656e 6469 6e67 2066 6f72 2074 6865 2066  ending for the f
-0003c8c0: 696c 652e 2054 6865 2066 696c 656e 616d  ile. The filenam
-0003c8d0: 6520 6974 7365 6c66 200d 0a09 0909 6973  e itself .....is
-0003c8e0: 2074 616b 656e 2066 726f 6d20 7468 6520   taken from the 
-0003c8f0: 6669 6c65 6e61 6d65 2e20 652e 672e 2069  filename. e.g. i
-0003c900: 6620 7361 6d70 312e 7478 7420 6973 2074  f samp1.txt is t
-0003c910: 6865 2066 696c 656e 616d 6520 616e 6420  he filename and 
-0003c920: 6578 7465 726e 616c 5f77 6176 653d 272e  external_wave='.
-0003c930: 7761 7627 200d 0a09 0909 7468 656e 2074  wav' .....then t
-0003c940: 6865 2070 726f 6772 616d 2073 6561 7263  he program searc
-0003c950: 6865 7320 7361 6d70 312e 7761 7620 666f  hes samp1.wav fo
-0003c960: 7220 7468 6520 7761 7665 6c65 6e67 7468  r the wavelength
-0003c970: 2e20 5468 6520 7472 616e 7370 6f73 6520  . The transpose 
-0003c980: 7365 7474 696e 6720 6973 2061 7070 6c69  setting is appli
-0003c990: 6564 200d 0a09 0909 616e 6420 7365 7473  ed .....and sets
-0003c9a0: 2077 6865 7265 2074 6865 2077 6176 656c   where the wavel
-0003c9b0: 656e 6774 6820 6172 6520 746f 2062 6520  ength are to be 
-0003c9c0: 696e 7365 7274 6564 2028 636f 6c75 6d6e  inserted (column
-0003c9d0: 7320 6f72 2072 6f77 2069 6e64 6578 6573  s or row indexes
-0003c9e0: 290d 0a09 0909 4966 2075 7365 5f73 616d  ).....If use_sam
-0003c9f0: 655f 6e61 6d65 203d 2046 616c 7365 0d0a  e_name = False..
-0003ca00: 0909 0974 6869 7320 7368 6f75 6c64 2062  ...this should b
-0003ca10: 6520 6120 6675 6c6c 2066 696c 656e 616d  e a full filenam
-0003ca20: 6520 7468 6174 2063 6f6e 7461 696e 7320  e that contains 
-0003ca30: 7468 6520 7665 6374 6f72 0d0a 0909 0d0a  the vector......
-0003ca40: 0909 7573 655f 7361 6d65 5f6e 616d 6520  ..use_same_name 
-0003ca50: 3a20 626f 6f6c 2c20 6f70 7469 6f6e 616c  : bool, optional
-0003ca60: 0d0a 0909 0974 6869 7320 7377 6974 6368  .....this switch
-0003ca70: 6573 2069 6620 7468 6520 6578 7465 726e  es if the extern
-0003ca80: 616c 2066 696c 656e 616d 6520 696e 636c  al filename incl
-0003ca90: 7564 6564 2074 6865 206c 6f61 6465 6420  uded the loaded 
-0003caa0: 6669 6c65 6e61 6d65 206f 7220 6973 2061  filename or is a
-0003cab0: 2073 6570 6172 6174 6520 6669 6c65 0d0a   separate file..
-0003cac0: 0909 0d0a 0909 636f 7272 6563 745f 6173  ......correct_as
-0003cad0: 6369 695f 6572 726f 7273 203a 2020 626f  cii_errors :  bo
-0003cae0: 6f6c 2028 6f70 7469 6f6e 616c 290d 0a09  ol (optional)...
-0003caf0: 0909 4966 2054 7275 6520 2844 6566 6175  ..If True (Defau
-0003cb00: 6c74 2920 7468 656e 2074 6865 2063 6f64  lt) then the cod
-0003cb10: 6520 7472 6965 7320 746f 2063 6174 6368  e tries to catch
-0003cb20: 2073 6f6d 6520 7374 7566 6620 6c69 6b65   some stuff like
-0003cb30: 2064 6f75 626c 6520 6d69 6e75 7320 7369   double minus si
-0003cb40: 676e 7320 616e 6420 646f 7562 6c65 2064  gns and double d
-0003cb50: 6f74 730d 0a09 0909 0d0a 0909 2727 270d  ots.........'''.
-0003cb60: 0a09 090d 0a09 0973 656c 662e 6473 5f6f  .......self.ds_o
-0003cb70: 7269 3d70 616e 6461 732e 7265 6164 5f63  ri=pandas.read_c
-0003cb80: 7376 2863 6865 636b 5f66 6f6c 6465 7228  sv(check_folder(
-0003cb90: 7061 7468 3d73 656c 662e 7061 7468 2c66  path=self.path,f
-0003cba0: 696c 656e 616d 653d 7365 6c66 2e66 696c  ilename=self.fil
-0003cbb0: 656e 616d 6529 2c20 7365 703d 7365 702c  ename), sep=sep,
-0003cbc0: 2069 6e64 6578 5f63 6f6c 3d30 290d 0a09   index_col=0)...
-0003cbd0: 0969 6620 636f 7272 6563 745f 6173 6369  .if correct_asci
-0003cbe0: 695f 6572 726f 7273 3a0d 0a09 0909 6966  i_errors:.....if
-0003cbf0: 2028 7365 6c66 2e64 735f 6f72 692e 6170   (self.ds_ori.ap
-0003cc00: 706c 796d 6170 2874 7970 6529 203d 3d20  plymap(type) == 
-0003cc10: 666c 6f61 7429 2e61 6c6c 2829 2e61 6c6c  float).all().all
-0003cc20: 2829 3a0d 0a09 0909 0970 6173 7323 616c  ():......pass#al
-0003cc30: 6c20 636f 6c75 6d6e 7320 7765 7265 2063  l columns were c
-0003cc40: 6f6e 7665 7274 6564 2074 6f20 666c 6f61  onverted to floa
-0003cc50: 742c 6e69 6365 0d0a 0909 0965 6c73 653a  t,nice.....else:
-0003cc60: 0d0a 0909 0909 7072 696e 7428 2773 6f6d  ......print('som
-0003cc70: 6520 6461 7461 2062 6164 2c20 7472 7920  e data bad, try 
-0003cc80: 6669 6c74 6572 696e 6727 290d 0a09 0909  filtering').....
-0003cc90: 0974 7279 3a23 2074 7279 2066 6f72 6365  .try:# try force
-0003cca0: 6420 636f 6e76 6572 7369 6f6e 0d0a 0909  d conversion....
-0003ccb0: 0909 0973 656c 662e 6473 5f6f 7269 3d73  ...self.ds_ori=s
-0003ccc0: 656c 662e 6473 5f6f 7269 2e61 7070 6c79  elf.ds_ori.apply
-0003ccd0: 6d61 7028 6c61 6d62 6461 2078 3a20 2072  map(lambda x:  r
-0003cce0: 652e 7375 6228 272d 2d27 2c20 272d 272c  e.sub('--', '-',
-0003ccf0: 7829 2069 6620 7479 7065 2878 2920 6973  x) if type(x) is
-0003cd00: 2073 7472 2065 6c73 6520 7829 0d0a 0909   str else x)....
-0003cd10: 0909 0973 656c 662e 6473 5f6f 7269 3d73  ...self.ds_ori=s
-0003cd20: 656c 662e 6473 5f6f 7269 2e61 7070 6c79  elf.ds_ori.apply
-0003cd30: 6d61 7028 6c61 6d62 6461 2078 3a20 7265  map(lambda x: re
-0003cd40: 2e73 7562 2872 275c 2e2b 272c 2027 2e27  .sub(r'\.+', '.'
-0003cd50: 2c78 2920 6966 2074 7970 6528 7829 2069  ,x) if type(x) i
-0003cd60: 7320 7374 7220 656c 7365 2078 290d 0a09  s str else x)...
-0003cd70: 0909 0909 7365 6c66 2e64 735f 6f72 693d  ....self.ds_ori=
-0003cd80: 7365 6c66 2e64 735f 6f72 692e 6173 7479  self.ds_ori.asty
-0003cd90: 7065 286e 702e 666c 6f61 7436 3429 0d0a  pe(np.float64)..
-0003cda0: 0909 0909 6578 6365 7074 2045 7863 6570  ....except Excep
-0003cdb0: 7469 6f6e 2061 7320 653a 0d0a 0909 0909  tion as e:......
-0003cdc0: 0970 7269 6e74 2827 666f 7263 6520 636c  .print('force cl
-0003cdd0: 6561 6e69 6e67 2077 656e 7420 7772 6f6e  eaning went wron
-0003cde0: 6720 616e 6420 7468 6520 6669 6c65 2025  g and the file %
-0003cdf0: 7320 6361 6e20 6e6f 7420 6265 2072 6561  s can not be rea
-0003ce00: 642e 2045 7272 6f72 206d 6573 7361 6765  d. Error message
-0003ce10: 2069 733a 2725 7365 6c66 2e66 696c 656e   is:'%self.filen
-0003ce20: 616d 6529 0d0a 0909 0909 0970 7269 6e74  ame).......print
-0003ce30: 2865 290d 0a09 0909 0909 7265 7475 726e  (e).......return
-0003ce40: 2046 616c 7365 0d0a 0909 6966 2065 7874   False....if ext
-0003ce50: 6572 6e61 6c5f 7469 6d65 2069 7320 6e6f  ernal_time is no
-0003ce60: 7420 4e6f 6e65 3a0d 0a09 0909 6966 2075  t None:.....if u
-0003ce70: 7365 5f73 616d 655f 6e61 6d65 3a0d 0a09  se_same_name:...
-0003ce80: 0909 0974 696d 655f 6669 6c65 3d63 6865  ...time_file=che
-0003ce90: 636b 5f66 6f6c 6465 7228 7061 7468 3d73  ck_folder(path=s
-0003cea0: 656c 662e 7061 7468 2c66 696c 656e 616d  elf.path,filenam
-0003ceb0: 653d 7365 6c66 2e66 696c 656e 616d 652e  e=self.filename.
-0003cec0: 7370 6c69 7428 272e 2729 5b30 5d2b 272e  split('.')[0]+'.
-0003ced0: 272b 6578 7465 726e 616c 5f74 696d 6529  '+external_time)
-0003cee0: 0d0a 0909 0965 6c73 653a 0d0a 0909 0909  .....else:......
-0003cef0: 7469 6d65 5f66 696c 653d 6368 6563 6b5f  time_file=check_
-0003cf00: 666f 6c64 6572 2870 6174 683d 7365 6c66  folder(path=self
-0003cf10: 2e70 6174 682c 6669 6c65 6e61 6d65 3d65  .path,filename=e
-0003cf20: 7874 6572 6e61 6c5f 7469 6d65 290d 0a09  xternal_time)...
-0003cf30: 0969 6620 6578 7465 726e 616c 5f77 6176  .if external_wav
-0003cf40: 6520 6973 206e 6f74 204e 6f6e 653a 0d0a  e is not None:..
-0003cf50: 0909 0969 6620 7573 655f 7361 6d65 5f6e  ...if use_same_n
-0003cf60: 616d 653a 0d0a 0909 0909 7761 7665 5f66  ame:......wave_f
-0003cf70: 696c 653d 6368 6563 6b5f 666f 6c64 6572  ile=check_folder
-0003cf80: 2870 6174 683d 7365 6c66 2e70 6174 682c  (path=self.path,
-0003cf90: 6669 6c65 6e61 6d65 3d73 656c 662e 6669  filename=self.fi
-0003cfa0: 6c65 6e61 6d65 2e73 706c 6974 2827 2e27  lename.split('.'
-0003cfb0: 295b 305d 2b27 2e27 2b65 7874 6572 6e61  )[0]+'.'+externa
-0003cfc0: 6c5f 7761 7665 290d 0a09 0909 656c 7365  l_wave).....else
-0003cfd0: 3a0d 0a09 0909 0977 6176 655f 6669 6c65  :......wave_file
-0003cfe0: 3d63 6865 636b 5f66 6f6c 6465 7228 7061  =check_folder(pa
-0003cff0: 7468 3d73 656c 662e 7061 7468 2c66 696c  th=self.path,fil
-0003d000: 656e 616d 653d 6578 7465 726e 616c 5f77  ename=external_w
-0003d010: 6176 6529 0d0a 0909 0d0a 0909 6966 2065  ave)........if e
-0003d020: 7874 6572 6e61 6c5f 7469 6d65 2069 7320  xternal_time is 
-0003d030: 6e6f 7420 4e6f 6e65 3a0d 0a09 0909 6461  not None:.....da
-0003d040: 7461 5f66 696c 655f 6e61 6d65 3d63 6865  ta_file_name=che
-0003d050: 636b 5f66 6f6c 6465 7228 7061 7468 3d73  ck_folder(path=s
-0003d060: 656c 662e 7061 7468 2c66 696c 656e 616d  elf.path,filenam
-0003d070: 653d 7365 6c66 2e66 696c 656e 616d 6529  e=self.filename)
-0003d080: 0d0a 0909 0974 696d 6573 3d70 616e 6461  .....times=panda
-0003d090: 732e 7265 6164 5f63 7376 2874 696d 655f  s.read_csv(time_
-0003d0a0: 6669 6c65 2c68 6561 6465 723d 4e6f 6e65  file,header=None
-0003d0b0: 2c64 6563 696d 616c 3d64 6563 696d 616c  ,decimal=decimal
-0003d0c0: 292e 7661 6c75 6573 2e72 6176 656c 2829  ).values.ravel()
-0003d0d0: 0d0a 0909 0969 6620 7472 616e 7370 6f73  .....if transpos
-0003d0e0: 653a 0d0a 0909 0909 6966 2065 7874 6572  e:......if exter
-0003d0f0: 6e61 6c5f 7761 7665 2069 7320 6e6f 7420  nal_wave is not 
-0003d100: 4e6f 6e65 3a0d 0a09 0909 0909 7365 6c66  None:.......self
-0003d110: 2e64 735f 6f72 693d 7061 6e64 6173 2e72  .ds_ori=pandas.r
-0003d120: 6561 645f 6373 7628 6368 6563 6b5f 666f  ead_csv(check_fo
-0003d130: 6c64 6572 2870 6174 683d 7365 6c66 2e70  lder(path=self.p
-0003d140: 6174 682c 6669 6c65 6e61 6d65 3d73 656c  ath,filename=sel
-0003d150: 662e 6669 6c65 6e61 6d65 292c 2073 6570  f.filename), sep
-0003d160: 3d73 6570 202c 2064 6563 696d 616c 3d64  =sep , decimal=d
-0003d170: 6563 696d 616c 2c20 6865 6164 6572 3d4e  ecimal, header=N
-0003d180: 6f6e 6529 0d0a 0909 0909 0977 6176 6573  one).......waves
-0003d190: 3d70 616e 6461 732e 7265 6164 5f63 7376  =pandas.read_csv
-0003d1a0: 2877 6176 655f 6669 6c65 2c68 6561 6465  (wave_file,heade
-0003d1b0: 723d 4e6f 6e65 2c64 6563 696d 616c 3d64  r=None,decimal=d
-0003d1c0: 6563 696d 616c 292e 7661 6c75 6573 2e72  ecimal).values.r
-0003d1d0: 6176 656c 2829 0d0a 0909 0909 0973 656c  avel().......sel
-0003d1e0: 662e 6473 5f6f 7269 2e69 6e64 6578 3d77  f.ds_ori.index=w
-0003d1f0: 6176 6573 0d0a 0909 0909 656c 7365 3a0d  aves......else:.
-0003d200: 0a09 0909 0909 7365 6c66 2e64 735f 6f72  ......self.ds_or
-0003d210: 693d 7061 6e64 6173 2e72 6561 645f 6373  i=pandas.read_cs
-0003d220: 7628 6368 6563 6b5f 666f 6c64 6572 2870  v(check_folder(p
-0003d230: 6174 683d 7365 6c66 2e70 6174 682c 6669  ath=self.path,fi
-0003d240: 6c65 6e61 6d65 3d73 656c 662e 6669 6c65  lename=self.file
-0003d250: 6e61 6d65 292c 2073 6570 3d73 6570 202c  name), sep=sep ,
-0003d260: 2064 6563 696d 616c 3d64 6563 696d 616c   decimal=decimal
-0003d270: 2c20 696e 6465 785f 636f 6c3d 302c 6865  , index_col=0,he
-0003d280: 6164 6572 3d4e 6f6e 6529 0d0a 0909 0909  ader=None)......
-0003d290: 7365 6c66 2e64 735f 6f72 692e 636f 6c75  self.ds_ori.colu
-0003d2a0: 6d6e 733d 7469 6d65 730d 0a09 0909 656c  mns=times.....el
-0003d2b0: 7365 3a0d 0a09 0909 0969 6620 6578 7465  se:......if exte
-0003d2c0: 726e 616c 5f77 6176 6520 6973 206e 6f74  rnal_wave is not
-0003d2d0: 204e 6f6e 653a 0d0a 0909 0909 0973 656c   None:.......sel
-0003d2e0: 662e 6473 5f6f 7269 3d70 616e 6461 732e  f.ds_ori=pandas.
-0003d2f0: 7265 6164 5f63 7376 2863 6865 636b 5f66  read_csv(check_f
-0003d300: 6f6c 6465 7228 7061 7468 3d73 656c 662e  older(path=self.
-0003d310: 7061 7468 2c66 696c 656e 616d 653d 7365  path,filename=se
-0003d320: 6c66 2e66 696c 656e 616d 6529 2c20 7365  lf.filename), se
-0003d330: 703d 7365 702c 2064 6563 696d 616c 3d64  p=sep, decimal=d
-0003d340: 6563 696d 616c 2c68 6561 6465 723d 4e6f  ecimal,header=No
-0003d350: 6e65 290d 0a09 0909 0909 7761 7665 733d  ne).......waves=
-0003d360: 7061 6e64 6173 2e72 6561 645f 6373 7628  pandas.read_csv(
-0003d370: 7761 7665 5f66 696c 652c 6865 6164 6572  wave_file,header
-0003d380: 3d4e 6f6e 652c 6465 6369 6d61 6c3d 6465  =None,decimal=de
-0003d390: 6369 6d61 6c29 2e76 616c 7565 732e 7261  cimal).values.ra
-0003d3a0: 7665 6c28 290d 0a09 0909 0909 7365 6c66  vel().......self
-0003d3b0: 2e64 735f 6f72 692e 636f 6c75 6d6e 733d  .ds_ori.columns=
-0003d3c0: 7761 7665 730d 0a09 0909 0965 6c73 653a  waves......else:
-0003d3d0: 0d0a 0909 0909 0973 656c 662e 6473 5f6f  .......self.ds_o
-0003d3e0: 7269 3d70 616e 6461 732e 7265 6164 5f63  ri=pandas.read_c
-0003d3f0: 7376 2863 6865 636b 5f66 6f6c 6465 7228  sv(check_folder(
-0003d400: 7061 7468 3d73 656c 662e 7061 7468 2c66  path=self.path,f
-0003d410: 696c 656e 616d 653d 7365 6c66 2e66 696c  ilename=self.fil
-0003d420: 656e 616d 6529 2c20 7365 703d 7365 702c  ename), sep=sep,
-0003d430: 2064 6563 696d 616c 3d64 6563 696d 616c   decimal=decimal
-0003d440: 290d 0a09 0909 0973 656c 662e 6473 5f6f  )......self.ds_o
-0003d450: 7269 2e69 6e64 6578 3d74 696d 6573 0d0a  ri.index=times..
-0003d460: 0909 656c 6966 2065 7874 6572 6e61 6c5f  ..elif external_
-0003d470: 7761 7665 2069 7320 6e6f 7420 4e6f 6e65  wave is not None
-0003d480: 3a0d 0a09 0909 6461 7461 5f66 696c 655f  :.....data_file_
-0003d490: 6e61 6d65 3d63 6865 636b 5f66 6f6c 6465  name=check_folde
-0003d4a0: 7228 7061 7468 3d73 656c 662e 7061 7468  r(path=self.path
-0003d4b0: 2c66 696c 656e 616d 653d 7365 6c66 2e66  ,filename=self.f
-0003d4c0: 696c 656e 616d 6529 0d0a 0909 0977 6176  ilename).....wav
-0003d4d0: 6573 3d70 616e 6461 732e 7265 6164 5f63  es=pandas.read_c
-0003d4e0: 7376 2877 6176 655f 6669 6c65 2c68 6561  sv(wave_file,hea
-0003d4f0: 6465 723d 4e6f 6e65 2c64 6563 696d 616c  der=None,decimal
-0003d500: 3d64 6563 696d 616c 292e 7661 6c75 6573  =decimal).values
-0003d510: 2e72 6176 656c 2829 0d0a 0909 0969 6620  .ravel().....if 
-0003d520: 7472 616e 7370 6f73 653a 0d0a 0909 0909  transpose:......
-0003d530: 7365 6c66 2e64 735f 6f72 693d 7061 6e64  self.ds_ori=pand
-0003d540: 6173 2e72 6561 645f 6373 7628 6368 6563  as.read_csv(chec
-0003d550: 6b5f 666f 6c64 6572 2870 6174 683d 7365  k_folder(path=se
-0003d560: 6c66 2e70 6174 682c 6669 6c65 6e61 6d65  lf.path,filename
-0003d570: 3d73 656c 662e 6669 6c65 6e61 6d65 292c  =self.filename),
-0003d580: 2073 6570 3d73 6570 2c20 6465 6369 6d61   sep=sep, decima
-0003d590: 6c3d 6465 6369 6d61 6c29 0d0a 0909 0909  l=decimal)......
-0003d5a0: 7365 6c66 2e64 735f 6f72 692e 696e 6465  self.ds_ori.inde
-0003d5b0: 783d 7761 7665 730d 0a09 0909 656c 7365  x=waves.....else
-0003d5c0: 3a0d 0a09 0909 0973 656c 662e 6473 5f6f  :......self.ds_o
-0003d5d0: 7269 3d70 616e 6461 732e 7265 6164 5f63  ri=pandas.read_c
-0003d5e0: 7376 2863 6865 636b 5f66 6f6c 6465 7228  sv(check_folder(
-0003d5f0: 7061 7468 3d73 656c 662e 7061 7468 2c66  path=self.path,f
-0003d600: 696c 656e 616d 653d 7365 6c66 2e66 696c  ilename=self.fil
-0003d610: 656e 616d 6529 2c20 7365 703d 7365 702c  ename), sep=sep,
-0003d620: 2064 6563 696d 616c 3d64 6563 696d 616c   decimal=decimal
-0003d630: 2c69 6e64 6578 5f63 6f6c 3d30 2c68 6561  ,index_col=0,hea
-0003d640: 6465 723d 4e6f 6e65 290d 0a09 0909 0973  der=None)......s
-0003d650: 656c 662e 6473 5f6f 7269 2e63 6f6c 756d  elf.ds_ori.colum
-0003d660: 6e73 3d77 6176 6573 0d0a 0909 7365 6c66  ns=waves....self
-0003d670: 2e64 735f 6f72 692e 636f 6c75 6d6e 733d  .ds_ori.columns=
-0003d680: 7365 6c66 2e64 735f 6f72 692e 636f 6c75  self.ds_ori.colu
-0003d690: 6d6e 732e 6173 7479 7065 2827 666c 6f61  mns.astype('floa
-0003d6a0: 7427 2923 4d61 6b65 2063 6f6c 756d 6e73  t')#Make columns
-0003d6b0: 2069 6e64 6578 6573 206e 756d 6265 7273   indexes numbers
-0003d6c0: 0d0a 0909 7365 6c66 2e64 735f 6f72 692e  ....self.ds_ori.
-0003d6d0: 696e 6465 783d 7365 6c66 2e64 735f 6f72  index=self.ds_or
-0003d6e0: 692e 696e 6465 782e 6173 7479 7065 2827  i.index.astype('
-0003d6f0: 666c 6f61 7427 2923 4d61 6b65 2072 6f77  float')#Make row
-0003d700: 2069 6e64 6578 6573 206e 756d 6265 7273   indexes numbers
-0003d710: 0d0a 0909 6966 2069 6e64 6578 5f69 735f  ....if index_is_
-0003d720: 656e 6572 6779 3a0d 0a09 0909 7365 6c66  energy:.....self
-0003d730: 2e64 735f 6f72 692e 696e 6465 783d 7363  .ds_ori.index=sc
-0003d740: 6970 792e 636f 6e73 7461 6e74 732e 682a  ipy.constants.h*
-0003d750: 7363 6970 792e 636f 6e73 7461 6e74 732e  scipy.constants.
-0003d760: 632f 2873 656c 662e 6473 5f6f 7269 2e69  c/(self.ds_ori.i
-0003d770: 6e64 6578 2a31 652d 392a 7363 6970 792e  ndex*1e-9*scipy.
-0003d780: 636f 6e73 7461 6e74 732e 656c 6563 7472  constants.electr
-0003d790: 6f6e 5f76 6f6c 7429 0d0a 0909 0909 0909  on_volt)........
-0003d7a0: 0909 0909 0909 0909 0920 200d 0a09 0969  .........  ....i
-0003d7b0: 6620 7472 616e 7370 6f73 653a 0d0a 0909  f transpose:....
-0003d7c0: 0973 656c 662e 6473 5f6f 7269 3d73 656c  .self.ds_ori=sel
-0003d7d0: 662e 6473 5f6f 7269 2e54 0d0a 0909 6966  f.ds_ori.T....if
-0003d7e0: 2073 6f72 745f 696e 6465 7865 733a 0d0a   sort_indexes:..
-0003d7f0: 0909 0973 656c 662e 6473 5f6f 7269 2e73  ...self.ds_ori.s
-0003d800: 6f72 745f 696e 6465 7828 6178 6973 3d30  ort_index(axis=0
-0003d810: 2c69 6e70 6c61 6365 3d54 7275 6529 0d0a  ,inplace=True)..
-0003d820: 0909 0973 656c 662e 6473 5f6f 7269 2e73  ...self.ds_ori.s
-0003d830: 6f72 745f 696e 6465 7828 6178 6973 3d31  ort_index(axis=1
-0003d840: 2c69 6e70 6c61 6365 3d54 7275 6529 0d0a  ,inplace=True)..
-0003d850: 0909 6966 2073 6869 6674 5f74 696d 6573  ..if shift_times
-0003d860: 5f62 7920 6973 206e 6f74 204e 6f6e 653a  _by is not None:
-0003d870: 0d0a 0909 0973 656c 662e 6473 5f6f 7269  .....self.ds_ori
-0003d880: 2e69 6e64 6578 3d73 656c 662e 6473 5f6f  .index=self.ds_o
-0003d890: 7269 2e69 6e64 6578 2e76 616c 7565 732b  ri.index.values+
-0003d8a0: 7368 6966 745f 7469 6d65 735f 6279 0d0a  shift_times_by..
-0003d8b0: 0909 6966 2064 6976 6964 655f 7469 6d65  ..if divide_time
-0003d8c0: 735f 6279 2069 7320 6e6f 7420 4e6f 6e65  s_by is not None
-0003d8d0: 3a0d 0a09 0909 7365 6c66 2e64 735f 6f72  :.....self.ds_or
-0003d8e0: 692e 696e 6465 783d 7365 6c66 2e64 735f  i.index=self.ds_
-0003d8f0: 6f72 692e 696e 6465 782e 7661 6c75 6573  ori.index.values
-0003d900: 2f64 6976 6964 655f 7469 6d65 735f 6279  /divide_times_by
-0003d910: 0d0a 0909 6966 2064 6174 615f 7479 7065  ....if data_type
-0003d920: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a09   is not None:...
-0003d930: 0909 7365 6c66 2e64 6174 615f 7479 7065  ..self.data_type
-0003d940: 203d 2064 6174 615f 7479 7065 0d0a 0909   = data_type....
-0003d950: 6966 2075 6e69 7473 2069 7320 6e6f 7420  if units is not 
-0003d960: 4e6f 6e65 3a0d 0a09 0909 7365 6c66 2e75  None:.....self.u
-0003d970: 6e69 7473 203d 2075 6e69 7473 0d0a 0909  nits = units....
-0003d980: 6966 2062 6173 6575 6e69 7420 6973 206e  if baseunit is n
-0003d990: 6f74 204e 6f6e 653a 0d0a 0909 0973 656c  ot None:.....sel
-0003d9a0: 662e 6261 7365 756e 6974 203d 2062 6173  f.baseunit = bas
-0003d9b0: 6575 6e69 740d 0a0d 0a09 090d 0a09 6465  eunit.........de
-0003d9c0: 6620 5f5f 6d61 6b65 5f73 7461 6e64 6172  f __make_standar
-0003d9d0: 645f 7061 7261 6d65 7465 7228 7365 6c66  d_parameter(self
-0003d9e0: 293a 0d0a 0909 2727 2766 756e 6374 696f  ):....'''functio
-0003d9f0: 6e20 7468 6174 2073 6574 7320 7468 6520  n that sets the 
-0003da00: 7374 616e 6461 7264 2070 6172 616d 6574  standard paramet
-0003da10: 6572 2e20 5468 6520 6675 6e63 7469 6f6e  er. The function
-0003da20: 2074 616b 6573 206e 6f20 696e 7075 742c   takes no input,
-0003da30: 2062 7574 2077 6520 7573 6520 7468 6973   but we use this
-0003da40: 2064 6f63 7374 7269 6e67 2074 6f20 6578   docstring to ex
-0003da50: 706c 6169 6e20 7468 6520 7061 7261 6d65  plain the parame
-0003da60: 7465 722e 0d0a 0d0a 0909 5061 7261 6d65  ter.......Parame
-0003da70: 7465 7273 0d0a 0909 2d2d 2d2d 2d2d 2d2d  ters....--------
-0003da80: 2d2d 2d2d 2d0d 0a0d 0a09 096c 6f67 5f73  -----......log_s
-0003da90: 6361 6c65 203a 2062 6f6f 6c2c 206f 7074  cale : bool, opt
-0003daa0: 696f 6e61 6c0d 0a09 0909 4966 2046 616c  ional.....If Fal
-0003dab0: 7365 2028 4465 6661 756c 7429 2c20 5468  se (Default), Th
-0003dac0: 6520 3244 2070 6c6f 7473 2028 4d61 7472  e 2D plots (Matr
-0003dad0: 6978 2920 6973 2070 6c6f 7474 6564 2077  ix) is plotted w
-0003dae0: 6974 6820 6120 7073 6575 646f 206c 6f67  ith a pseudo log
-0003daf0: 6172 6974 686d 6963 2069 6e74 656e 7369  arithmic intensi
-0003db00: 7479 2073 6361 6c65 2e20 0d0a 0909 0954  ty scale. .....T
-0003db10: 6869 7320 7573 7561 6c6c 7920 646f 6573  his usually does
-0003db20: 206e 6f74 2067 6976 6520 676f 6f64 2072   not give good r
-0003db30: 6573 756c 7473 2075 6e6c 6573 7320 7468  esults unless th
-0003db40: 6520 696e 7465 6e73 6974 7920 7363 616c  e intensity scal
-0003db50: 6520 6973 2073 796d 6d65 7472 6963 200d  e is symmetric .
-0003db60: 0a09 0973 656c 662e 636d 6170 2020 3a20  ...self.cmap  : 
-0003db70: 6d61 7470 6c6f 746c 6962 2e63 6d0d 0a09  matplotlib.cm...
-0003db80: 0909 2844 6566 6175 6c74 2920 2073 7461  ..(Default)  sta
-0003db90: 6e64 6172 645f 6d61 7020 2d20 676c 6f62  ndard_map - glob
-0003dba0: 616c 2070 6172 616d 6574 6572 0d0a 0909  al parameter....
-0003dbb0: 0963 6d61 7020 6973 2061 2070 6f77 6572  .cmap is a power
-0003dbc0: 6675 6c6c 2076 6172 6961 626c 6520 7468  full variable th
-0003dbd0: 6174 2063 686f 6f73 6573 2074 6865 2063  at chooses the c
-0003dbe0: 6f6c 6f75 7220 6d61 7020 6170 706c 6965  olour map applie
-0003dbf0: 6420 666f 7220 616c 6c20 706c 6f74 732e  d for all plots.
-0003dc00: 2049 6620 7365 7420 746f 200d 0a09 0909   If set to .....
-0003dc10: 4e6f 6e65 2028 4465 6661 756c 7429 2074  None (Default) t
-0003dc20: 6865 6e20 7468 6520 7365 6c66 2e63 6d61  hen the self.cma
-0003dc30: 7020 6973 2075 7365 642e 0d0a 0909 0941  p is used......A
-0003dc40: 7320 7374 616e 6461 7264 2049 2075 7365  s standard I use
-0003dc50: 2074 6865 2063 6f6c 6f72 206d 6170 2022   the color map "
-0003dc60: 6a65 7422 2066 726f 6d20 6d61 7470 6c6f  jet" from matplo
-0003dc70: 746c 6962 2e20 5468 6572 6520 6172 6520  tlib. There are 
-0003dc80: 6120 7661 7269 6574 7920 6f66 2063 6f6c  a variety of col
-0003dc90: 6f72 6d61 7073 200d 0a09 0909 6176 6169  ormaps .....avai
-0003dca0: 6c61 626c 6520 7468 6174 2061 7265 2076  lable that are v
-0003dcb0: 6572 7920 7573 6566 756c 6c2e 2042 6573  ery usefull. Bes
-0003dcc0: 6964 6520 226a 6574 222c 2022 7669 7269  ide "jet", "viri
-0003dcd0: 6469 7322 2069 7320 6120 676f 6f64 2063  dis" is a good c
-0003dce0: 686f 6963 6520 6173 2069 7420 6973 2077  hoice as it is w
-0003dcf0: 656c 6c20 0d0a 0909 0976 6973 6962 6c65  ell .....visible
-0003dd00: 2075 6e64 6572 2072 6564 2d67 7265 656e   under red-green
-0003dd10: 2062 6c69 6e64 6e65 7373 2e20 4f74 6865   blindness. Othe
-0003dd20: 7220 7573 6566 756c 206d 6170 7320 6172  r useful maps ar
-0003dd30: 6520 2270 7269 736d 2220 666f 7220 6869  e "prism" for hi
-0003dd40: 6768 2066 6c75 6374 7561 7469 6f6e 7320  gh fluctuations 
-0003dd50: 0d0a 0909 096f 7220 6469 7665 7267 696e  .....or divergin
-0003dd60: 6720 636f 6c6f 7220 6d61 7073 206c 696b  g color maps lik
-0003dd70: 6520 2273 6569 736d 6963 222e 200d 0a09  e "seismic". ...
-0003dd80: 0909 5365 6520 6874 7470 733a 2f2f 6d61  ..See https://ma
-0003dd90: 7470 6c6f 746c 6962 2e6f 7267 2f33 2e31  tplotlib.org/3.1
-0003dda0: 2e30 2f74 7574 6f72 6961 6c73 2f63 6f6c  .0/tutorials/col
-0003ddb0: 6f72 732f 636f 6c6f 726d 6170 732e 6874  ors/colormaps.ht
-0003ddc0: 6d6c 2066 6f72 2061 2063 6f6d 7072 6568  ml for a compreh
-0003ddd0: 656e 7369 7665 200d 0a09 0909 7365 6c65  ensive .....sele
-0003dde0: 6374 696f 6e2e 2049 6e20 7468 6520 636f  ction. In the co
-0003ddf0: 6465 2074 6865 2063 6f6c 6f72 6d61 7073  de the colormaps
-0003de00: 2061 7265 2069 6d70 6f72 7465 6420 736f   are imported so
-0003de10: 2069 6620 706c 6f74 5f66 756e 6320 6973   if plot_func is
-0003de20: 2069 6d70 6f72 7465 6420 6173 2070 6620   imported as pf 
-0003de30: 7468 656e 200d 0a09 0909 7365 6c66 2e63  then .....self.c
-0003de40: 6d61 703d 7066 2e63 6d2e 7669 7269 6469  map=pf.cm.viridi
-0003de50: 7320 7365 7473 2076 6972 6964 6973 2061  s sets viridis a
-0003de60: 7320 7468 6520 6d61 7020 746f 2075 7365  s the map to use
-0003de70: 2e20 496e 7465 726e 616c 6c79 2074 6865  . Internally the
-0003de80: 2063 6f6c 6f72 7320 6172 6520 6368 6f73   colors are chos
-0003de90: 656e 200d 0a09 0909 7769 7468 2074 6865  en .....with the
-0003dea0: 2022 636f 6c6d 2220 6675 6e63 7469 6f6e   "colm" function
-0003deb0: 2e20 5468 6520 3264 2070 6c6f 7473 2072  . The 2d plots r
-0003dec0: 6571 7569 7265 2061 2063 6f6e 7469 6e75  equire a continu
-0003ded0: 6f75 7320 636f 6c6f 7220 6d61 7020 736f  ous color map so
-0003dee0: 2069 6620 736f 6d65 7468 696e 6720 0d0a   if something ..
-0003def0: 0909 0965 6c73 6520 6973 2067 6976 6520  ...else is give 
-0003df00: 3264 2070 6c6f 7473 2061 7265 2073 686f  2d plots are sho
-0003df10: 776e 2061 7574 6f6d 6174 6963 616c 6c79  wn automatically
-0003df20: 2077 6974 6820 226a 6574 222e 2046 6f72   with "jet". For
-0003df30: 2061 6c6c 206f 6620 7468 6520 3164 2070   all of the 1d p
-0003df40: 6c6f 7473 2068 6f77 6576 6572 200d 0a09  lots however ...
-0003df50: 0909 4920 6669 7273 7420 7365 6c65 6374  ..I first select
-0003df60: 2061 206e 756d 6265 7220 6f66 2063 6f6c   a number of col
-0003df70: 6f72 7320 6265 666f 7265 2065 6163 6820  ors before each 
-0003df80: 706c 6f74 2e20 4966 2063 6d61 7020 6973  plot. If cmap is
-0003df90: 2061 2063 6f6e 7469 6e6f 7573 206d 6170   a continous map
-0003dfa0: 2074 6865 6e20 7468 6573 650d 0a09 0909   then these.....
-0003dfb0: 6172 6520 7361 6d70 6c65 6420 6576 656e  are sampled even
-0003dfc0: 6c79 206f 7665 7220 7468 6520 636f 6c6f  ly over the colo
-0003dfd0: 7572 6d61 702e 204d 616e 7561 6c20 6974  urmap. Manual it
-0003dfe0: 6572 6162 6c65 7320 6f66 2063 6f6c 6f75  erables of colou
-0003dff0: 7273 200d 0a09 0909 636d 6170 3d5b 2831  rs .....cmap=[(1
-0003e000: 2c30 2c30 292c 2830 2c31 2c30 292c 2830  ,0,0),(0,1,0),(0
-0003e010: 2c30 2c31 292c 2e2e 2e5d 2061 7265 2061  ,0,1),...] are a
-0003e020: 6c73 6f20 6163 6365 7074 6564 2c20 6173  lso accepted, as
-0003e030: 2061 7265 2076 6563 746f 7273 206f 7220   are vectors or 
-0003e040: 6461 7461 6672 616d 6573 2074 6861 7420  dataframes that 
-0003e050: 0d0a 0909 0963 6f6e 7461 696e 2061 7320  .....contain as 
-0003e060: 726f 7773 2074 6865 2063 6f6c 6f72 732e  rows the colors.
-0003e070: 2054 6865 7265 206d 7573 7420 6265 206f   There must be o
-0003e080: 6620 636f 7572 7365 2073 7566 6669 6369  f course suffici
-0003e090: 656e 7420 636f 6c6f 7273 2070 7265 7365  ent colors prese
-0003e0a0: 6e74 2066 6f72 200d 0a09 0909 7468 6520  nt for .....the 
-0003e0b0: 6e75 6d62 6572 7320 6f66 206c 696e 6573  numbers of lines
-0003e0c0: 2074 6861 7420 7769 6c6c 2062 6520 706c   that will be pl
-0003e0d0: 6f74 7465 642e 2053 6f20 4920 7265 636f  otted. So I reco
-0003e0e0: 6d6d 656e 6420 746f 2070 726f 7669 6465  mmend to provide
-0003e0f0: 2061 7420 6c65 6173 7420 3130 2063 6f6c   at least 10 col
-0003e100: 6f75 7273 200d 0a09 0909 2865 2e67 2e7e  ours .....(e.g.~
-0003e110: 796f 7572 2075 6e69 7665 7273 6974 7920  your university 
-0003e120: 636f 6c6f 7273 292e 2063 6f6c 6f75 7273  colors). colours
-0003e130: 2061 7265 2061 6c77 6179 7320 6769 7665   are always give
-0003e140: 6e20 6173 2061 2c20 6c69 7374 206f 7220  n as a, list or 
-0003e150: 7475 706c 6520 7769 7468 2052 4741 206f  tuple with RGA o
-0003e160: 7220 5247 4241 0d0a 0909 0928 7769 7468  r RGBA.....(with
-0003e170: 2074 6865 206c 6173 7420 4120 6265 6569   the last A beei
-0003e180: 6e67 2074 6865 2041 6c70 6861 3d74 7261  ng the Alpha=tra
-0003e190: 6e73 7061 7265 6e63 792e 2041 6c6c 206e  nsparency. All n
-0003e1a0: 756d 6265 7273 2061 7265 2062 6574 7765  umbers are betwe
-0003e1b0: 656e 2030 2061 6e64 2031 2e20 0d0a 0909  en 0 and 1. ....
-0003e1c0: 0949 6620 6120 6c69 7374 2f76 6563 746f  .If a list/vecto
-0003e1d0: 722f 4461 7461 4672 616d 6520 6973 2067  r/DataFrame is g
-0003e1e0: 6976 656e 2066 6f72 2074 6865 2063 6f6c  iven for the col
-0003e1f0: 6f75 7273 2074 6865 7920 7769 6c6c 2062  ours they will b
-0003e200: 6520 7573 6564 2069 6e20 7468 6520 6f72  e used in the or
-0003e210: 6465 7220 7072 6f76 6964 6564 2e0d 0a09  der provided....
-0003e220: 0973 656c 662e 6c69 6e74 7265 7368 203a  .self.lintresh :
-0003e230: 2066 6c6f 6174 0d0a 0909 0954 6865 2070   float.....The p
-0003e240: 7365 7564 6f20 6c6f 6772 6174 6968 6d69  seudo logratihmi
-0003e250: 6320 7261 6e67 6520 2273 796d 6c6f 6722  c range "symlog"
-0003e260: 2069 7320 7573 6564 2066 6f72 206d 6f73   is used for mos
-0003e270: 7420 7469 6d65 2061 7869 732e 2053 796d  t time axis. Sym
-0003e280: 6c6f 6720 706c 6f74 7320 6120 7261 6e67  log plots a rang
-0003e290: 6520 6172 6f75 6e64 0d0a 0909 0974 696d  e around.....tim
-0003e2a0: 6520 7a65 726f 206c 696e 6561 7220 616e  e zero linear an
-0003e2b0: 6420 6265 796f 6e64 2074 6869 7320 6c69  d beyond this li
-0003e2c0: 6e65 6172 2074 7265 7368 6f6c 6420 276c  near treshold 'l
-0003e2d0: 696e 7472 6573 6827 206f 6e20 6120 6c6f  intresh' on a lo
-0003e2e0: 6761 7269 7468 6d69 6320 7363 616c 652e  garithmic scale.
-0003e2f0: 2028 4465 6661 756c 7429 2030 2e33 200d   (Default) 0.3 .
-0003e300: 0a09 0973 656c 662e 6c6f 675f 6669 7420  ...self.log_fit 
-0003e310: 203a 200d 0a09 0909 2844 6566 6175 6c74   : .....(Default
-0003e320: 2920 2046 616c 7365 5c6e 0d0a 0909 0954  )  False\n.....T
-0003e330: 7261 6e73 6665 7220 616c 6c20 7468 6520  ransfer all the 
-0003e340: 7469 6d65 2d66 6974 7469 6e67 2070 6172  time-fitting par
-0003e350: 616d 6574 6572 7320 696e 746f 206c 6f67  ameters into log
-0003e360: 2d73 7061 6365 2062 6566 6f72 6520 7468  -space before th
-0003e370: 6520 6669 740d 0a09 0973 656c 662e 6967  e fit....self.ig
-0003e380: 6e6f 7265 5f74 696d 655f 7265 6769 6f6e  nore_time_region
-0003e390: 2020 3a20 4e6f 6e65 206f 7220 6c69 7374    : None or list
-0003e3a0: 2028 6f66 2074 776f 2066 6c6f 6174 7320   (of two floats 
-0003e3b0: 6f72 206f 6620 6c69 7374 7329 0d0a 0909  or of lists)....
-0003e3c0: 0928 4465 6661 756c 7429 2020 4e6f 6e65  .(Default)  None
-0003e3d0: 0d0a 0909 0963 7574 2073 6574 2061 2074  .....cut set a t
-0003e3e0: 696d 6520 7261 6e67 6520 7769 7468 2061  ime range with a
-0003e3f0: 206c 6f77 2061 6e64 2068 6967 6820 6c69   low and high li
-0003e400: 6d69 7420 6672 6f6d 2074 6865 2066 6974  mit from the fit
-0003e410: 732e 2028 4465 6661 756c 7429 204e 6f6e  s. (Default) Non
-0003e420: 6520 6e6f 7468 696e 6720 6861 7070 656e  e nothing happen
-0003e430: 730d 0a09 0909 5468 6520 7265 6769 6f6e  s.....The region
-0003e440: 2077 696c 6c20 6265 2072 656d 6f76 6564   will be removed
-0003e450: 2064 7572 696e 6720 7468 6520 6669 7474   during the fitt
-0003e460: 696e 6720 7072 6f63 6573 7320 2861 6e64  ing process (and
-0003e470: 2077 696c 6c20 6265 206d 6973 7369 6e67   will be missing
-0003e480: 2069 6e20 7468 6520 6669 742d 7265 7375   in the fit-resu
-0003e490: 6c74 0d0a 0909 0970 6c6f 7473 295c 6e0d  lt.....plots)\n.
-0003e4a0: 0a09 0909 5573 6167 6520 7369 6e67 6c65  ....Usage single
-0003e4b0: 2072 6567 696f 6e3a 205b 6c6f 7765 7220   region: [lower 
-0003e4c0: 7265 6769 6f6e 206c 696d 6974 2c75 7070  region limit,upp
-0003e4d0: 6572 2072 6567 696f 6e20 6c69 6d69 745d  er region limit]
-0003e4e0: 5c6e 0d0a 0909 0975 7365 2066 6f72 206d  \n.....use for m
-0003e4f0: 756c 7469 706c 6520 7265 6769 6f6e 733a  ultiple regions:
-0003e500: 5b5b 6c6f 7765 7220 6c69 6d69 7420 312c  [[lower limit 1,
-0003e510: 7570 7065 7220 6c69 6d69 7420 315d 2c5b  upper limit 1],[
-0003e520: 6c6f 7765 7220 6c69 6d69 7420 322c 7570  lower limit 2,up
-0003e530: 7065 7220 6c69 6d69 7420 325d 2c2e 2e2e  per limit 2],...
-0003e540: 5d0d 0a09 0973 656c 662e 6572 726f 725f  ]....self.error_
-0003e550: 6d61 7472 6978 5f61 6d70 6c69 6669 6361  matrix_amplifica
-0003e560: 7469 6f6e 2020 3a20 0d0a 0909 0928 4465  tion  : .....(De
-0003e570: 6661 756c 7429 2020 3130 0d0a 0909 7365  fault)  10....se
-0003e580: 6c66 2e72 656c 5f77 6176 6520 203a 2066  lf.rel_wave  : f
-0003e590: 6c6f 6174 206f 7220 6c69 7374 2028 6f66  loat or list (of
-0003e5a0: 2066 6c6f 6174 7329 200d 0a09 0909 2844   floats) .....(D
-0003e5b0: 6566 6175 6c74 2920 206e 702e 6172 616e  efault)  np.aran
-0003e5c0: 6765 2833 3030 2c31 3030 302c 3130 3029  ge(300,1000,100)
-0003e5d0: 5c6e 0d0a 0909 0927 7265 6c5f 7761 7665  \n.....'rel_wave
-0003e5e0: 2720 616e 6420 2777 6964 7468 2720 2869  ' and 'width' (i
-0003e5f0: 6e20 7468 6520 6f62 6a65 6374 2063 616c  n the object cal
-0003e600: 6c65 6420 2777 6176 656c 656e 6774 685f  led 'wavelength_
-0003e610: 6269 6e27 2077 6f72 6b20 746f 6765 7468  bin' work togeth
-0003e620: 6572 2066 6f72 2074 6865 2063 7265 6174  er for the creat
-0003e630: 696f 6e20 0d0a 0909 096f 6620 6b69 6e65  ion .....of kine
-0003e640: 7469 6320 706c 6f74 732e 2057 6865 6e20  tic plots. When 
-0003e650: 706c 6f74 7469 6e67 206b 696e 6574 6963  plotting kinetic
-0003e660: 2073 7065 6374 7261 206f 6e65 206c 696e   spectra one lin
-0003e670: 6520 7769 6c6c 2062 6520 706c 6f74 7465  e will be plotte
-0003e680: 6420 666f 7220 6561 6368 2065 6e74 7261  d for each entra
-0003e690: 6e63 650d 0a09 0909 696e 2074 6865 206c  nce.....in the l
-0003e6a0: 6973 742f 7665 6374 6f72 2072 656c 5f77  ist/vector rel_w
-0003e6b0: 6176 652e 2044 7572 696e 6720 6f62 6a65  ave. During obje
-0003e6c0: 6374 2067 656e 6572 6174 696f 6e20 7468  ct generation th
-0003e6d0: 6520 7665 6374 6f72 206e 702e 6172 616e  e vector np.aran
-0003e6e0: 6765 2833 3030 2c31 3030 302c 3130 3029  ge(300,1000,100)
-0003e6f0: 200d 0a09 0909 6973 2073 6574 2061 7320   .....is set as 
-0003e700: 7374 616e 6461 7264 2e20 416e 6f74 6865  standard. Anothe
-0003e710: 7220 7479 7069 6361 6c20 7573 696e 6720  r typical using 
-0003e720: 7374 796c 6520 776f 756c 6420 6265 2074  style would be t
-0003e730: 6f20 6465 6669 6e65 2061 206c 6973 7420  o define a list 
-0003e740: 6f66 2069 6e74 6572 6573 7469 6e67 200d  of interesting .
-0003e750: 0a09 0909 7761 7665 6c65 6e67 7468 2061  ....wavelength a
-0003e760: 7420 7768 6963 6820 6120 6b69 6e65 7469  t which a kineti
-0003e770: 6320 6465 7665 6c6f 706d 656e 7420 6973  c development is
-0003e780: 2074 6f20 6265 2070 6c6f 7474 6564 2e20   to be plotted. 
-0003e790: 4174 2065 6163 6820 7365 6c65 6374 6564  At each selected
-0003e7a0: 2077 6176 656c 656e 6774 6820 0d0a 0909   wavelength ....
-0003e7b0: 0974 6865 2064 6174 6120 6265 7477 6565  .the data betwee
-0003e7c0: 6e20 7761 7665 6c65 6e67 7468 2b74 612e  n wavelength+ta.
-0003e7d0: 7761 7665 6c65 6e67 7468 5f62 696e 2061  wavelength_bin a
-0003e7e0: 6e64 2077 6176 656c 656e 6774 682d 7461  nd wavelength-ta
-0003e7f0: 2e77 6176 656c 656e 6774 685f 6269 6e20  .wavelength_bin 
-0003e800: 6973 2061 7665 7261 6765 6420 0d0a 0909  is averaged ....
-0003e810: 0966 6f72 2065 6163 6820 7469 6d65 706f  .for each timepo
-0003e820: 696e 7420 7265 7475 726e 6564 200d 0a09  int returned ...
-0003e830: 0973 656c 662e 7265 6c5f 7469 6d65 2020  .self.rel_time  
-0003e840: 3a20 666c 6f61 7420 6f72 206c 6973 742f  : float or list/
-0003e850: 7665 6374 6f72 2028 6f66 2066 6c6f 6174  vector (of float
-0003e860: 7329 0d0a 0909 0928 4465 6661 756c 7429  s).....(Default)
-0003e870: 2020 5b30 2e32 2c30 2e33 2c30 2e35 2c31    [0.2,0.3,0.5,1
-0003e880: 2c33 2c31 302c 3330 2c31 3030 2c33 3030  ,3,10,30,100,300
-0003e890: 2c31 3030 302c 3330 3030 2c39 3030 305d  ,1000,3000,9000]
-0003e8a0: 5c6e 0d0a 0909 0946 6f72 2065 6163 6820  \n.....For each 
-0003e8b0: 656e 7472 7920 696e 2072 656c 5f74 696d  entry in rel_tim
-0003e8c0: 6520 6120 7370 6563 7472 756d 2069 7320  e a spectrum is 
-0003e8d0: 706c 6f74 7465 642e 2049 6620 7469 6d65  plotted. If time
-0003e8e0: 5f77 6964 7468 5f70 6572 6365 6e74 3d30  _width_percent=0
-0003e8f0: 2028 4465 6661 756c 7429 2074 6865 200d   (Default) the .
-0003e900: 0a09 0909 6e65 6172 6573 7420 6d65 6173  ....nearest meas
-0003e910: 7572 6564 2074 696d 6570 6f69 6e74 2069  ured timepoint i
-0003e920: 7320 6368 6f73 656e 2e20 466f 7220 6f74  s chosen. For ot
-0003e930: 6865 7220 7661 6c75 6573 2073 6565 2027  her values see '
-0003e940: 7469 6d65 5f77 6964 7468 5f70 6572 6365  time_width_perce
-0003e950: 6e74 270d 0a09 0973 656c 662e 7469 6d65  nt'....self.time
-0003e960: 5f77 6964 7468 5f70 6572 6365 6e74 2020  _width_percent  
-0003e970: 3a20 666c 6f61 740d 0a09 0909 2844 6566  : float.....(Def
-0003e980: 6175 6c74 2920 2030 2022 7265 6c5f 7469  ault)  0 "rel_ti
-0003e990: 6d65 2220 616e 6420 2274 696d 655f 7769  me" and "time_wi
-0003e9a0: 6474 685f 7065 7263 656e 7422 2077 6f72  dth_percent" wor
-0003e9b0: 6b20 746f 6765 7468 6572 2066 6f72 200d  k together for .
-0003e9c0: 0a09 0909 6372 6561 7469 6e67 2073 7065  ....creating spe
-0003e9d0: 6374 7261 6c20 706c 6f74 7320 6174 2073  ctral plots at s
-0003e9e0: 7065 6369 6669 6320 7469 6d65 706f 696e  pecific timepoin
-0003e9f0: 7473 2e20 466f 7220 6561 6368 2065 6e74  ts. For each ent
-0003ea00: 7279 200d 0a09 0909 696e 2072 656c 5f74  ry .....in rel_t
-0003ea10: 696d 6520 6120 7370 6563 7472 756d 2069  ime a spectrum i
-0003ea20: 7320 706c 6f74 7465 642e 2049 6620 686f  s plotted. If ho
-0003ea30: 7765 7665 7220 652e 672e 2074 696d 655f  wever e.g. time_
-0003ea40: 7769 6474 685f 7065 7263 656e 743d 3130  width_percent=10
-0003ea50: 200d 0a09 0909 7468 6520 7265 6769 6f6e   .....the region
-0003ea60: 2062 6574 7765 656e 2074 6865 2074 696d   between the tim
-0003ea70: 6570 6f69 6e74 2063 6c6f 7365 7374 2074  epoint closest t
-0003ea80: 6f20 7468 6520 2031 2e31 2078 2074 696d  o the  1.1 x tim
-0003ea90: 6570 6f69 6e74 200d 0a09 0909 616e 6420  epoint .....and 
-0003eaa0: 302e 3920 7820 7469 6d65 706f 696e 7420  0.9 x timepoint 
-0003eab0: 6973 2061 7665 7261 6765 6420 616e 6420  is averaged and 
-0003eac0: 7368 6f77 6e20 2861 6e64 2074 6865 206c  shown (and the l
-0003ead0: 6567 656e 6420 6164 6a75 7374 6564 2061  egend adjusted a
-0003eae0: 6363 6f72 6469 6e67 6c79 292e 200d 0a09  ccordingly). ...
-0003eaf0: 0909 5468 6973 2069 7320 7061 7274 6963  ..This is partic
-0003eb00: 756c 6172 6c79 2075 7365 6675 6c20 666f  ularly useful fo
-0003eb10: 7220 7468 6520 6465 6e73 6c79 0d0a 0909  r the densly....
-0003eb20: 0973 616d 706c 6564 2072 6567 696f 6e20  .sampled region 
-0003eb30: 636c 6f73 6520 746f 2074 3d30 2e20 5479  close to t=0. Ty
-0003eb40: 7069 6361 6c6c 7920 666f 7220 6120 6c6f  pically for a lo
-0003eb50: 6761 7269 7468 6d69 6320 7265 636f 7264  garithmic record
-0003eb60: 6564 206b 696e 6574 6963 732c 2074 6865  ed kinetics, the
-0003eb70: 200d 0a09 0909 7469 6d65 706f 696e 7473   .....timepoints
-0003eb80: 2061 7420 6c61 7465 7220 7469 6d65 7320   at later times 
-0003eb90: 7769 6c6c 2062 6520 6675 7274 6865 7220  will be further 
-0003eba0: 6170 7061 7274 2074 6861 6e20 3130 2070  appart than 10 p
-0003ebb0: 6572 6365 6e74 206f 6620 7468 6520 7661  ercent of the va
-0003ebc0: 6c75 652c 200d 0a09 0909 6275 7420 7468  lue, .....but th
-0003ebd0: 6973 2061 6c6c 6f77 7320 746f 2065 6c65  is allows to ele
-0003ebe0: 6761 6e74 6c79 2063 6f6d 6269 6e65 2076  gantly combine v
-0003ebf0: 616c 7565 7320 6172 6f75 6e64 2074 696d  alues around tim
-0003ec00: 653d 3020 666f 7220 6265 7474 6572 2073  e=0 for better s
-0003ec10: 7461 7469 7374 6963 732e 200d 0a09 0909  tatistics. .....
-0003ec20: 5468 6973 2061 7665 7261 6769 6e67 2069  This averaging i
-0003ec30: 7320 6f6e 6c79 2061 7070 6c69 6564 2066  s only applied f
-0003ec40: 6f72 2074 6865 2070 6c6f 7474 696e 6720  or the plotting 
-0003ec50: 6675 6e63 7469 6f6e 2061 6e64 206e 6f74  function and not
-0003ec60: 2066 6f72 2074 6865 2066 6974 732e 0d0a   for the fits...
-0003ec70: 0909 7365 6c66 2e62 6173 6575 6e69 7420  ..self.baseunit 
-0003ec80: 203a 2073 7472 0d0a 0909 0928 4465 6661   : str.....(Defa
-0003ec90: 756c 7429 2020 2770 7327 5c6e 0d0a 0909  ult)  'ps'\n....
-0003eca0: 0962 6173 6575 6e69 7420 6973 2061 206e  .baseunit is a n
-0003ecb0: 6561 7420 7761 7920 746f 2063 6861 6e67  eat way to chang
-0003ecc0: 6520 7468 6520 756e 6974 206f 6e20 7468  e the unit on th
-0003ecd0: 6520 7469 6d65 2061 7869 7320 6f66 2074  e time axis of t
-0003ece0: 6865 2070 6c6f 7473 2e20 2844 6566 6175  he plots. (Defau
-0003ecf0: 6c74 2920 2770 7327 2c20 6275 7420 7468  lt) 'ps', but th
-0003ed00: 6579 200d 0a09 0909 6361 6e20 6265 2066  ey .....can be f
-0003ed10: 7261 6d65 7320 6f72 2073 6f6d 6574 6869  rames or somethi
-0003ed20: 6e67 2073 696d 696c 6172 6c79 2e20 5468  ng similarly. Th
-0003ed30: 6973 2069 7320 6368 616e 6769 6e67 206f  is is changing o
-0003ed40: 6e6c 7920 7468 6520 6c61 6265 6c20 6f66  nly the label of
-0003ed50: 2074 6865 2061 7869 732e 200d 0a09 0909   the axis. .....
-0003ed60: 4475 7269 6e67 2074 6865 2069 6d70 6f72  During the impor
-0003ed70: 7420 7468 6572 6520 6973 2074 6865 206f  t there is the o
-0003ed80: 7074 696f 6e20 746f 2064 6976 6964 6520  ption to divide 
-0003ed90: 7468 6520 6e75 6d62 6572 7320 6279 2061  the numbers by a
-0003eda0: 2066 6163 746f 722e 200d 0a09 0909 4920   factor. .....I 
-0003edb0: 6861 7665 2061 6c73 6f20 7573 6564 2066  have also used f
-0003edc0: 7261 6d65 7320 6f72 2066 7320 6173 2075  rames or fs as u
-0003edd0: 6e69 7473 2e20 496d 706f 7274 616e 7420  nits. Important 
-0003ede0: 6973 2074 6861 7420 616c 6c20 7469 6d65  is that all time
-0003edf0: 2075 6e69 7473 2077 696c 6c20 6265 206c   units will be l
-0003ee00: 6162 656c 6564 2077 6974 680d 0a09 0909  abeled with.....
-0003ee10: 7468 6973 2075 6e69 742e 0d0a 0909 7365  this unit.....se
-0003ee20: 6c66 2e6d 6f64 2020 3a20 0d0a 0909 0928  lf.mod  : .....(
-0003ee30: 4465 6661 756c 7429 2020 2765 7870 6f6e  Default)  'expon
-0003ee40: 656e 7469 616c 275c 6e0d 0a09 0909 5468  ential'\n.....Th
-0003ee50: 6973 2069 7320 7468 6520 6465 6661 756c  is is the defaul
-0003ee60: 7420 6669 7474 696e 6720 6675 6e63 7469  t fitting functi
-0003ee70: 6f6e 2c20 696e 2067 656e 6572 616c 2074  on, in general t
-0003ee80: 6869 7320 6973 2064 6973 6375 7373 6564  his is discussed
-0003ee90: 2069 6e20 7468 6520 6669 7474 696e 6720   in the fitting 
-0003eea0: 7365 6374 696f 6e0d 0a09 0973 656c 662e  section....self.
-0003eeb0: 7363 6174 7465 7263 7574 2020 3a20 4e6f  scattercut  : No
-0003eec0: 6e65 206f 7220 6974 6572 6162 6c65 2028  ne or iterable (
-0003eed0: 6f66 2066 6c6f 6174 7320 6f72 206f 7468  of floats or oth
-0003eee0: 6572 2069 7465 7261 626c 652c 2061 6c77  er iterable, alw
-0003eef0: 6179 7320 7061 6972 7321 290d 0a09 0909  ays pairs!).....
-0003ef00: 2844 6566 6175 6c74 2920 204e 6f6e 655c  (Default)  None\
-0003ef10: 6e0d 0a09 0909 696e 7465 6e74 6564 2074  n.....intented t
-0003ef20: 6f20 2263 7574 2220 6f6e 6520 6f72 206d  o "cut" one or m
-0003ef30: 756c 7469 706c 6520 7363 6174 7465 7220  ultiple scatter 
-0003ef40: 7265 6769 6f6e 732e 2028 6966 2028 4465  regions. (if (De
-0003ef50: 6661 756c 7429 204e 6f6e 6520 6e6f 7468  fault) None noth
-0003ef60: 696e 670d 0a09 0909 6861 7070 656e 7329  ing.....happens)
-0003ef70: 2049 6620 6974 2069 7320 7365 7420 7468   If it is set th
-0003ef80: 6520 7370 6563 7472 616c 2072 6567 696f  e spectral regio
-0003ef90: 6e20 6265 7477 6565 6e20 7468 6520 6c69  n between the li
-0003efa0: 6d69 7473 2069 7320 7365 7420 746f 207a  mits is set to z
-0003efb0: 6572 6f2e 200d 0a09 0909 5573 6167 6520  ero. .....Usage 
-0003efc0: 7369 6e67 6c65 2072 6567 696f 6e3a 205b  single region: [
-0003efd0: 6c6f 7765 7220 7265 6769 6f6e 206c 696d  lower region lim
-0003efe0: 6974 2c75 7070 6572 2072 6567 696f 6e20  it,upper region 
-0003eff0: 6c69 6d69 745d 2c20 0d0a 0909 0975 7365  limit], .....use
-0003f000: 2066 6f72 206d 756c 7469 706c 6520 7265   for multiple re
-0003f010: 6769 6f6e 733a 5b5b 6c6f 7765 7220 6c69  gions:[[lower li
-0003f020: 6d69 7420 312c 7570 7065 7220 6c69 6d69  mit 1,upper limi
-0003f030: 7420 315d 2c5b 6c6f 7765 7220 6c69 6d69  t 1],[lower limi
-0003f040: 7420 322c 7570 7065 7220 6c69 6d69 7420  t 2,upper limit 
-0003f050: 325d 2c2e 2e2e 5d0d 0a09 0973 656c 662e  2],...]....self.
-0003f060: 626f 7264 6572 6375 7420 203a 204e 6f6e  bordercut  : Non
-0003f070: 6520 6f72 2069 7465 7261 626c 6520 2877  e or iterable (w
-0003f080: 6974 6820 7477 6f20 666c 6f61 7473 290d  ith two floats).
-0003f090: 0a09 0909 2844 6566 6175 6c74 2920 204e  ....(Default)  N
-0003f0a0: 6f6e 655c 6e0d 0a09 0909 6375 7420 7370  one\n.....cut sp
-0003f0b0: 6563 7472 6120 6174 2074 6865 206c 6f77  ectra at the low
-0003f0c0: 2061 6e64 2068 6967 6820 7761 7665 6c65   and high wavele
-0003f0d0: 6e67 7468 206c 696d 6974 2e20 2844 6566  ngth limit. (Def
-0003f0e0: 6175 6c74 2920 4e6f 6e65 200d 0a09 0909  ault) None .....
-0003f0f0: 7573 6573 2074 6865 206c 696d 6974 7320  uses the limits 
-0003f100: 6f66 206d 6561 7375 7265 6d65 6e74 200d  of measurement .
-0003f110: 0a09 0973 656c 662e 7469 6d65 5f62 696e  ...self.time_bin
-0003f120: 2020 3a20 4e6f 6e65 206f 7220 696e 740d    : None or int.
-0003f130: 0a09 0909 2844 6566 6175 6c74 2920 204e  ....(Default)  N
-0003f140: 6f6e 650d 0a09 0909 6973 2064 6976 6964  one.....is divid
-0003f150: 696e 6720 7468 6520 706f 696e 7473 206f  ing the points o
-0003f160: 6e20 7468 6520 7469 6d65 2d61 7869 7320  n the time-axis 
-0003f170: 696e 2065 7665 6e20 6269 6e73 2061 6e64  in even bins and
-0003f180: 2061 7665 7261 6765 7320 7468 6520 666f   averages the fo
-0003f190: 756e 6420 7661 6c75 6573 2069 6e20 6265  und values in be
-0003f1a0: 7477 6565 6e2e 200d 0a09 0909 5468 6973  tween. .....This
-0003f1b0: 2069 7320 6120 6861 7264 2061 7070 726f   is a hard appro
-0003f1c0: 6163 6820 7468 6174 2061 6c73 6f20 6166  ach that also af
-0003f1d0: 6665 6374 7320 7468 6520 6669 7473 2e20  fects the fits. 
-0003f1e0: 4920 646f 2072 6563 6f6d 6d65 6e64 2074  I do recommend t
-0003f1f0: 6f20 7573 6520 7468 6973 2063 6172 6566  o use this caref
-0003f200: 756c 6c79 2c20 0d0a 0909 0969 7420 6973  ully, .....it is
-0003f210: 206d 6f73 7420 7573 6566 756c 2066 6f72   most useful for
-0003f220: 206d 6f64 756c 6174 6564 2064 6174 612e   modulated data.
-0003f230: 2041 2062 6574 7465 7220 6368 6f69 6365   A better choice
-0003f240: 2066 6f72 2074 7261 6e73 6965 6e74 2061   for transient a
-0003f250: 6273 6f72 7074 696f 6e20 7468 6174 206f  bsorption that o
-0003f260: 6e6c 7920 0d0a 0909 0961 6666 6563 7473  nly .....affects
-0003f270: 2074 6865 206b 696e 6574 6963 7320 6973   the kinetics is
-0003f280: 2027 7469 6d65 5f77 6964 7468 5f70 6572   'time_width_per
-0003f290: 6365 6e74 270d 0a09 0973 656c 662e 7469  cent'....self.ti
-0003f2a0: 6d65 6c69 6d69 7473 2020 3a20 4e6f 6e65  melimits  : None
-0003f2b0: 206f 7220 6c69 7374 2028 6f66 2032 2066   or list (of 2 f
-0003f2c0: 6c6f 6174 7329 0d0a 0909 0928 4465 6661  loats).....(Defa
-0003f2d0: 756c 7429 2020 4e6f 6e65 5c6e 0d0a 0909  ult)  None\n....
-0003f2e0: 0963 7574 2074 696d 6573 2061 7420 7468  .cut times at th
-0003f2f0: 6520 6c6f 7720 616e 6420 6869 6768 2074  e low and high t
-0003f300: 696d 6520 6c69 6d69 742e 2028 4465 6661  ime limit. (Defa
-0003f310: 756c 7429 204e 6f6e 6520 7573 6573 2074  ult) None uses t
-0003f320: 6865 206c 696d 6974 7320 6f66 206d 6561  he limits of mea
-0003f330: 7375 7265 6d65 6e74 0d0a 0909 0949 6d70  surement.....Imp
-0003f340: 6f72 7461 6e74 3a20 4966 2065 6974 6865  ortant: If eithe
-0003f350: 7220 7468 6520 6261 636b 6772 6f75 6e64  r the background
-0003f360: 206f 7220 7468 6520 6368 6972 7020 6973   or the chirp is
-0003f370: 2074 6f20 6265 2066 6974 2074 6869 7320   to be fit this 
-0003f380: 6d75 7374 2069 6e63 6c75 6465 2074 6865  must include the
-0003f390: 200d 0a09 0909 7469 6d65 2062 6566 6f72   .....time befor
-0003f3a0: 6520 7a65 726f 2120 5573 6566 756c 3a20  e zero! Useful: 
-0003f3b0: 4974 2069 7320 7573 6566 756c 2074 6f20  It is useful to 
-0003f3c0: 776f 726b 206f 6e20 6469 6666 6572 656e  work on differen
-0003f3d0: 7420 7265 6769 6f6e 732c 2073 7461 7274  t regions, start
-0003f3e0: 696e 6720 7769 7468 0d0a 0909 0974 6865  ing with.....the
-0003f3f0: 206c 6f6e 6765 7374 2028 7468 656e 2075   longest (then u
-0003f400: 7365 2074 6865 2074 612e 4261 636b 676f  se the ta.Backgo
-0003f410: 756e 6420 6675 6e63 7469 6f6e 2070 7269  und function pri
-0003f420: 6f72 2074 6f20 6669 7429 2061 6e64 2065  or to fit) and e
-0003f430: 7870 616e 6420 6672 6f6d 2074 6865 7265  xpand from there
-0003f440: 0d0a 0909 6461 7461 5f74 7970 6520 3a20  ....data_type : 
-0003f450: 7374 720d 0a09 0909 7468 6973 2069 7320  str.....this is 
-0003f460: 7468 6520 6461 7461 7479 7065 2061 6e64  the datatype and
-0003f470: 2065 6666 6563 7469 7665 6c79 2074 6865   effectively the
-0003f480: 2075 6e69 7420 7075 7420 6f6e 2074 6865   unit put on the
-0003f490: 2069 6e74 656e 7369 7479 2061 7869 7320   intensity axis 
-0003f4a0: 0d0a 0909 0928 4465 6661 756c 7429 2764  .....(Default)'d
-0003f4b0: 6966 6665 7265 6e74 6961 6c20 4162 736f  ifferential Abso
-0003f4c0: 7270 7469 6f6e 2069 6e20 245c 6d61 7468  rption in $\math
-0003f4d0: 7265 6775 6c61 727b 5c44 656c 7461 204f  regular{\Delta O
-0003f4e0: 447d 240d 0a09 0973 656c 662e 7761 7665  D}$....self.wave
-0003f4f0: 5f6e 6d5f 6269 6e20 203a 204e 6f6e 6520  _nm_bin  : None 
-0003f500: 6f72 2066 6c6f 6174 200d 0a09 0909 2844  or float .....(D
-0003f510: 6566 6175 6c74 2920 204e 6f6e 655c 6e0d  efault)  None\n.
-0003f520: 0a09 0909 7265 6269 6e73 2074 6865 206f  ....rebins the o
-0003f530: 7269 6769 6e61 6c20 6461 7461 2069 6e74  riginal data int
-0003f540: 6f20 6576 656e 2069 6e74 6572 7661 6c73  o even intervals
-0003f550: 2e20 4966 2073 6574 2074 6f20 4e6f 6e65  . If set to None
-0003f560: 2074 6865 206f 7269 6769 6e61 6c20 6461   the original da
-0003f570: 7461 2077 696c 6c20 6265 2075 7365 642e  ta will be used.
-0003f580: 200d 0a09 0909 4966 2073 6574 2074 6f20   .....If set to 
-0003f590: 6120 7769 6474 6820 2865 2e67 2e20 326e  a width (e.g. 2n
-0003f5a0: 6d29 2c20 7468 6520 7761 7665 6c65 6e67  m), the waveleng
-0003f5b0: 7468 2061 7869 7320 7769 6c6c 2062 6520  th axis will be 
-0003f5c0: 6469 7669 6465 6420 696e 746f 2073 7465  divided into ste
-0003f5d0: 7073 206f 6620 7468 6973 2073 697a 650d  ps of this size.
-0003f5e0: 0a09 0909 616e 6420 7468 6520 6d65 616e  ....and the mean
-0003f5f0: 206f 6620 616c 6c20 6d65 6173 7572 656d   of all measurem
-0003f600: 656e 7473 2069 6e20 7468 6520 696e 7465  ents in the inte
-0003f610: 7276 616c 2069 7320 7461 6b65 6e2e 2054  rval is taken. T
-0003f620: 6865 2072 652d 6269 6e6e 696e 6720 7374  he re-binning st
-0003f630: 6f70 7320 6173 2073 6f6f 6e20 6173 0d0a  ops as soon as..
-0003f640: 0909 0974 6865 206d 6561 7375 7265 6420  ...the measured 
-0003f650: 7374 6570 7369 7a65 2069 7320 7769 6465  stepsize is wide
-0003f660: 7220 7468 616e 2067 6976 656e 2068 6572  r than given her
-0003f670: 652c 2074 6865 6e20 7468 6520 6f72 6967  e, then the orig
-0003f680: 696e 616c 2062 696e 7320 6172 6520 7573  inal bins are us
-0003f690: 6564 2e20 0d0a 0909 0954 6869 7320 6675  ed. .....This fu
-0003f6a0: 6e63 7469 6f6e 2069 7320 7061 7274 6963  nction is partic
-0003f6b0: 756c 6172 6c79 2075 7365 6675 6c20 666f  ularly useful fo
-0003f6c0: 7220 7370 6563 7472 6f6d 6574 6572 2077  r spectrometer w
-0003f6d0: 6974 6820 6e6f 6e2d 6c69 6e65 6172 2064  ith non-linear d
-0003f6e0: 6973 7065 7273 696f 6e2c 200d 0a09 0909  ispersion, .....
-0003f6f0: 6c69 6b65 2061 2070 7269 736d 2069 6e20  like a prism in 
-0003f700: 7468 6520 696e 6672 6172 6564 2e0d 0a09  the infrared....
-0003f710: 0973 656c 662e 7761 7665 6c65 6e67 7468  .self.wavelength
-0003f720: 5f62 696e 2020 3a20 2066 6c6f 6174 2c20  _bin  :  float, 
-0003f730: 6f70 7469 6f6e 616c 0d0a 0909 0928 4465  optional.....(De
-0003f740: 6661 756c 7429 2020 3130 6e6d 2074 6865  fault)  10nm the
-0003f750: 2077 6964 7468 2075 7365 6420 696e 206b   width used in k
-0003f760: 696e 6574 6963 732c 2073 6565 2062 656c  inetics, see bel
-0003f770: 6f77 0d0a 0909 7365 6c66 2e69 6e74 656e  ow....self.inten
-0003f780: 7369 7479 5f72 616e 6765 2020 3a20 4e6f  sity_range  : No
-0003f790: 6e65 2c20 666c 6f61 7420 6f72 206c 6973  ne, float or lis
-0003f7a0: 7420 5b6f 6620 7477 6f20 666c 6f61 7473  t [of two floats
-0003f7b0: 5d0d 0a09 0909 2844 6566 6175 6c74 2920  ].....(Default) 
-0003f7c0: 204e 6f6e 6520 2d20 696e 7465 6e73 6974   None - intensit
-0003f7d0: 795f 7261 6e67 6520 6973 2061 2067 656e  y_range is a gen
-0003f7e0: 6572 616c 2073 7769 7463 6820 7468 6174  eral switch that
-0003f7f0: 2067 6f76 6572 6e73 2077 6861 7420 696e   governs what in
-0003f800: 7465 6e73 6974 7920 7261 6e67 6520 7468  tensity range th
-0003f810: 6520 706c 6f74 7320 7368 6f77 2e20 0d0a  e plots show. ..
-0003f820: 0909 0946 6f72 2074 6865 2031 6420 706c  ...For the 1d pl
-0003f830: 6f74 7320 7468 6973 2069 7320 7468 6520  ots this is the 
-0003f840: 792d 6178 6973 2066 6f72 2074 6865 2032  y-axis for the 2
-0003f850: 642d 706c 6f74 7320 7468 6973 2069 7320  d-plots this is 
-0003f860: 7468 6520 636f 6c6f 7572 2073 6361 6c65  the colour scale
-0003f870: 2e20 0d0a 0909 0954 6869 7320 7061 7261  . .....This para
-0003f880: 6d65 7465 7220 7265 636f 676e 697a 6573  meter recognizes
-0003f890: 2074 6872 6565 2073 6574 7469 6e67 732e   three settings.
-0003f8a0: 2049 6620 7365 7420 746f 2022 4e6f 6e65   If set to "None
-0003f8b0: 2220 2844 6566 6175 6c74 2920 7468 6973  " (Default) this
-0003f8c0: 2075 7365 7320 7468 6520 6d69 6e69 6d75   uses the minimu
-0003f8d0: 6d20 616e 640d 0a09 0909 6d61 7869 6d75  m and.....maximu
-0003f8e0: 6d20 6f66 2074 6865 2064 6174 612e 2041  m of the data. A
-0003f8f0: 2073 696e 676c 6520 7661 6c75 6520 6c69   single value li
-0003f900: 6b65 2069 6e20 7468 6520 6578 616d 706c  ke in the exampl
-0003f910: 6520 6265 6c6f 7720 616e 6420 7468 6520  e below and the 
-0003f920: 696e 7465 6e64 6564 2075 7365 2069 7320  intended use is 
-0003f930: 7468 6520 7379 6d6d 6574 7269 630d 0a09  the symmetric...
-0003f940: 0909 7363 616c 6520 7768 696c 6520 6120  ..scale while a 
-0003f950: 6c69 7374 2077 6974 6820 7477 6f20 656e  list with two en
-0003f960: 7472 6965 7320 616e 2061 7373 796d 6d65  tries an assymme
-0003f970: 7472 6963 2073 6361 6c65 2065 2e67 2e20  tric scale e.g. 
-0003f980: 0d0a 0909 0969 6e74 656e 7369 7479 5f72  .....intensity_r
-0003f990: 616e 6765 3d33 652d 3320 6973 2063 6f6e  ange=3e-3 is con
-0003f9a0: 7665 7274 6564 2069 6e74 6f20 696e 7465  verted into inte
-0003f9b0: 6e73 6974 795f 7261 6e67 653d 5b2d 3365  nsity_range=[-3e
-0003f9c0: 2d33 2c33 652d 335d 0d0a 0909 7365 6c66  -3,3e-3]....self
-0003f9d0: 2e64 735f 6f72 692e 636f 6c75 6d6e 732e  .ds_ori.columns.
-0003f9e0: 6e61 6d65 203a 2073 7472 2c20 6f70 7469  name : str, opti
-0003f9f0: 6f6e 616c 200d 0a09 0909 2844 6566 6175  onal .....(Defau
-0003fa00: 6c74 2920 2027 5761 7665 6c65 6e67 7468  lt)  'Wavelength
-0003fa10: 2069 6e20 6e6d 275c 6e0d 0a09 0909 5468   in nm'\n.....Th
-0003fa20: 6973 2069 7320 7468 6520 6765 6e65 7261  is is the genera
-0003fa30: 6c20 656e 6572 6779 2061 7869 732e 2068  l energy axis. h
-0003fa40: 6572 6520 7765 2064 6566 696e 6520 6974  ere we define it
-0003fa50: 2077 6974 6820 7468 6520 756e 6974 2e20   with the unit. 
-0003fa60: 4368 616e 6765 2074 6869 7320 746f 2065  Change this to e
-0003fa70: 6e65 7267 7920 666f 7220 7573 6520 696e  nergy for use in
-0003fa80: 2065 2e67 2078 2d72 6179 2073 6369 656e   e.g x-ray scien
-0003fa90: 6365 0d0a 0909 7365 6c66 2e64 735f 6f72  ce....self.ds_or
-0003faa0: 692e 696e 6465 782e 6e61 6d65 203a 2073  i.index.name : s
-0003fab0: 7472 2c20 6f70 7469 6f6e 616c 0d0a 0909  tr, optional....
-0003fac0: 0953 7461 6e64 6172 6420 2754 696d 6520  .Standard 'Time 
-0003fad0: 696e 2025 7327 2025 2073 656c 662e 6261  in %s' % self.ba
-0003fae0: 7365 756e 6974 200d 0a09 0973 656c 662e  seunit ....self.
-0003faf0: 6461 7461 5f74 7970 653a 2073 7472 2028  data_type: str (
-0003fb00: 6f70 7469 6f6e 616c 290d 0a09 0909 7365  optional).....se
-0003fb10: 6c66 2e64 6174 615f 7479 7065 3d27 6469  lf.data_type='di
-0003fb20: 6666 2e20 4162 736f 7270 7469 6f6e 2069  ff. Absorption i
-0003fb30: 6e20 245c 6d61 7468 7265 6775 6c61 727b  n $\mathregular{
-0003fb40: 5c44 656c 7461 204f 447d 2427 0d0a 0909  \Delta OD}$'....
-0003fb50: 7365 6c66 2e66 6974 636f 6566 6620 3a20  self.fitcoeff : 
-0003fb60: 6c69 7374 2028 3520 666c 6f61 7473 290d  list (5 floats).
-0003fb70: 0a09 0909 6368 6972 7020 636f 7272 6563  ....chirp correc
-0003fb80: 7469 6f6e 2070 6f6c 796e 6f6d 0d0a 0909  tion polynom....
-0003fb90: 7365 6c66 2e63 6869 7270 5f66 696c 6520  self.chirp_file 
-0003fba0: 3a20 7374 720d 0a09 0909 6966 2074 6865  : str.....if the
-0003fbb0: 7265 2069 7320 6120 6669 6c65 2077 6974  re is a file wit
-0003fbc0: 6874 6865 2072 6967 6874 206e 616d 6520  hthe right name 
-0003fbd0: 7772 6974 6520 6974 2068 6572 652c 206f  write it here, o
-0003fbe0: 7468 6572 7769 7365 204e 6f6e 650d 0a09  therwise None...
-0003fbf0: 0973 656c 662e 6669 6775 7265 5f70 6174  .self.figure_pat
-0003fc00: 6820 3a20 7374 720d 0a09 0909 5061 7468  h : str.....Path
-0003fc10: 2066 6f72 2073 6176 696e 6720 6669 6775   for saving figu
-0003fc20: 7265 732c 2069 6620 7365 740d 0a09 0973  res, if set....s
-0003fc30: 656c 662e 7361 7665 5f66 6967 7572 6573  elf.save_figures
-0003fc40: 5f74 6f5f 666f 6c64 6572 203a 2062 6f6f  _to_folder : boo
-0003fc50: 6c0d 0a09 0909 6966 2054 7275 6520 616c  l.....if True al
-0003fc60: 6c20 6669 6775 7265 7320 6172 6520 6175  l figures are au
-0003fc70: 746f 6d61 7469 6361 6c6c 7920 7361 7665  tomatically save
-0003fc80: 6420 7768 656e 2061 6e79 2070 6c6f 7466  d when any plotf
-0003fc90: 756e 6374 696f 6e20 6973 2063 616c 6c65  unction is calle
-0003fca0: 640d 0a0d 0a09 0945 7861 6d70 6c65 730d  d......Examples.
-0003fcb0: 0a09 092d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  ...-----------..
-0003fcc0: 0d0a 0909 3e3e 3e20 7461 2e62 6f72 6465  ....>>> ta.borde
-0003fcd0: 7263 7574 3d5b 3335 302c 3132 3030 5d20  rcut=[350,1200] 
-0003fce0: 2023 7265 6d6f 7665 2061 6c6c 2064 6174   #remove all dat
-0003fcf0: 6120 6f75 7473 6964 6520 7468 6973 206c  a outside this l
-0003fd00: 696d 6974 0d0a 0909 3e3e 3e20 7461 2e73  imit....>>> ta.s
-0003fd10: 6361 7474 6572 6375 743d 5b35 3232 2c36  cattercut=[522,6
-0003fd20: 3035 5d20 2023 7365 7420 6461 7461 2069  05]  #set data i
-0003fd30: 6e73 6964 6520 7468 6973 206c 696d 6974  nside this limit
-0003fd40: 2074 6f20 7a65 726f 0d0a 0909 3e3e 3e20   to zero....>>> 
-0003fd50: 7461 2e74 696d 656c 696d 6974 733d 5b30  ta.timelimits=[0
-0003fd60: 2e32 2c35 3030 305d 2020 2372 656d 6f76  .2,5000]  #remov
-0003fd70: 6520 616c 6c20 6461 7461 206f 7574 7369  e all data outsi
-0003fd80: 6465 2074 6869 7320 6c69 6d69 740d 0a09  de this limit...
-0003fd90: 093e 3e3e 2074 612e 7761 7665 5f6e 6d5f  .>>> ta.wave_nm_
-0003fda0: 6269 6e3d 3520 2023 7265 6269 6e20 7468  bin=5  #rebin th
-0003fdb0: 6520 6461 7461 2074 6f20 7468 6973 2077  e data to this w
-0003fdc0: 6964 7468 0d0a 0909 3e3e 3e20 7461 2e69  idth....>>> ta.i
-0003fdd0: 6e74 656e 7369 7479 5f72 616e 6765 3d33  ntensity_range=3
-0003fde0: 652d 3320 2023 6571 7569 7661 6c65 6e74  e-3  #equivalent
-0003fdf0: 2074 6f20 5b2d 3365 2d33 2c33 652d 335d   to [-3e-3,3e-3]
-0003fe00: 0d0a 0909 3e3e 3e20 7461 2e69 6e74 656e  ....>>> ta.inten
-0003fe10: 7369 7479 5f72 616e 6765 3d5b 2d31 652d  sity_range=[-1e-
-0003fe20: 332c 3365 2d33 5d20 2023 696e 7465 6e73  3,3e-3]  #intens
-0003fe30: 6974 7920 7468 6174 2069 7320 706c 6f74  ity that is plot
-0003fe40: 7465 6420 696e 2032 6420 706c 6f74 2061  ted in 2d plot a
-0003fe50: 6e64 2079 2d61 7869 7320 696e 2031 6420  nd y-axis in 1d 
-0003fe60: 706c 6f74 730d 0a09 093e 3e3e 2074 612e  plots....>>> ta.
-0003fe70: 636d 6170 3d6d 6174 706c 6f74 6c69 622e  cmap=matplotlib.
-0003fe80: 636d 2e70 7269 736d 2020 2363 686f 6f73  cm.prism  #choos
-0003fe90: 6520 6469 6666 6572 656e 7420 636f 6c6f  e different colo
-0003fea0: 7572 206d 6170 0d0a 0909 3e3e 3e20 7461  ur map....>>> ta
-0003feb0: 2e69 676e 6f72 655f 7469 6d65 5f72 6567  .ignore_time_reg
-0003fec0: 696f 6e3d 5b2d 302e 312c 302e 315d 2023  ion=[-0.1,0.1] #
-0003fed0: 6967 6e6f 7265 202d 302e 3170 7320 746f  ignore -0.1ps to
-0003fee0: 2030 2e31 7073 0d0a 0d0a 0d0a 0909 2727   0.1ps........''
-0003fef0: 270d 0a09 0973 656c 662e 6c6f 675f 7363  '....self.log_sc
-0003ff00: 616c 6520 3d20 4661 6c73 6520 6966 206e  ale = False if n
-0003ff10: 6f74 2068 6173 6174 7472 2873 656c 662c  ot hasattr(self,
-0003ff20: 2027 6c6f 675f 7363 616c 6527 2920 656c   'log_scale') el
-0003ff30: 7365 2073 656c 662e 6c6f 675f 7363 616c  se self.log_scal
-0003ff40: 650d 0a09 0973 656c 662e 636d 6170 203d  e....self.cmap =
-0003ff50: 2073 7461 6e64 6172 645f 6d61 7020 6966   standard_map if
-0003ff60: 206e 6f74 2068 6173 6174 7472 2873 656c   not hasattr(sel
-0003ff70: 662c 2027 636d 6170 2729 2065 6c73 6520  f, 'cmap') else 
-0003ff80: 7365 6c66 2e63 6d61 700d 0a09 0973 656c  self.cmap....sel
-0003ff90: 662e 6c69 6e74 7265 7368 203d 2030 2e33  f.lintresh = 0.3
-0003ffa0: 2069 6620 6e6f 7420 6861 7361 7474 7228   if not hasattr(
-0003ffb0: 7365 6c66 2c20 276c 696e 7472 6573 6827  self, 'lintresh'
-0003ffc0: 2920 656c 7365 2073 656c 662e 6c69 6e74  ) else self.lint
-0003ffd0: 7265 7368 0d0a 0909 7365 6c66 2e6c 6f67  resh....self.log
-0003ffe0: 5f66 6974 203d 2046 616c 7365 2069 6620  _fit = False if 
-0003fff0: 6e6f 7420 6861 7361 7474 7228 7365 6c66  not hasattr(self
-00040000: 2c20 276c 6f67 5f66 6974 2729 2065 6c73  , 'log_fit') els
-00040010: 6520 7365 6c66 2e6c 6f67 5f66 6974 0d0a  e self.log_fit..
-00040020: 0909 7365 6c66 2e69 676e 6f72 655f 7469  ..self.ignore_ti
-00040030: 6d65 5f72 6567 696f 6e20 3d20 4e6f 6e65  me_region = None
-00040040: 2069 6620 6e6f 7420 6861 7361 7474 7228   if not hasattr(
-00040050: 7365 6c66 2c20 2769 676e 6f72 655f 7469  self, 'ignore_ti
-00040060: 6d65 5f72 6567 696f 6e27 2920 656c 7365  me_region') else
-00040070: 2073 656c 662e 6967 6e6f 7265 5f74 696d   self.ignore_tim
-00040080: 655f 7265 6769 6f6e 0d0a 0909 7365 6c66  e_region....self
-00040090: 2e65 7272 6f72 5f6d 6174 7269 785f 616d  .error_matrix_am
-000400a0: 706c 6966 6963 6174 696f 6e20 3d20 3130  plification = 10
-000400b0: 2069 6620 6e6f 7420 6861 7361 7474 7228   if not hasattr(
-000400c0: 7365 6c66 2c20 2765 7272 6f72 5f6d 6174  self, 'error_mat
-000400d0: 7269 785f 616d 706c 6966 6963 6174 696f  rix_amplificatio
-000400e0: 2729 2065 6c73 6520 7365 6c66 2e65 7272  ') else self.err
-000400f0: 6f72 5f6d 6174 7269 785f 616d 706c 6966  or_matrix_amplif
-00040100: 6963 6174 696f 6e0d 0a09 0974 7279 3a0d  ication....try:.
-00040110: 0a09 0909 7365 6c66 2e72 656c 5f77 6176  ....self.rel_wav
-00040120: 6520 3d20 7365 6c66 2e72 656c 5f77 6176  e = self.rel_wav
-00040130: 650d 0a09 0965 7863 6570 743a 0d0a 0909  e....except:....
-00040140: 0973 656c 662e 7265 6c5f 7761 7665 203d  .self.rel_wave =
-00040150: 206e 702e 6172 616e 6765 2833 3030 2c31   np.arange(300,1
-00040160: 3030 302c 3130 3029 2069 6620 6e6f 7420  000,100) if not 
-00040170: 6861 7361 7474 7228 7365 6c66 2c20 2772  hasattr(self, 'r
-00040180: 656c 5f77 6176 6527 2920 656c 7365 2073  el_wave') else s
-00040190: 656c 662e 7265 6c5f 7761 7665 0d0a 0909  elf.rel_wave....
-000401a0: 7365 6c66 2e72 656c 5f74 696d 6520 3d20  self.rel_time = 
-000401b0: 5b30 2e32 2c30 2e33 2c30 2e35 2c31 2c33  [0.2,0.3,0.5,1,3
-000401c0: 2c31 302c 3330 2c31 3030 2c33 3030 2c31  ,10,30,100,300,1
-000401d0: 3030 302c 3330 3030 2c39 3030 305d 2069  000,3000,9000] i
-000401e0: 6620 6e6f 7420 6861 7361 7474 7228 7365  f not hasattr(se
-000401f0: 6c66 2c20 2772 656c 5f74 696d 6527 2920  lf, 'rel_time') 
-00040200: 656c 7365 2073 656c 662e 7265 6c5f 7469  else self.rel_ti
-00040210: 6d65 0d0a 0909 7365 6c66 2e74 696d 655f  me....self.time_
-00040220: 7769 6474 685f 7065 7263 656e 7420 3d20  width_percent = 
-00040230: 3020 6966 206e 6f74 2068 6173 6174 7472  0 if not hasattr
-00040240: 2873 656c 662c 2027 7469 6d65 5f77 6964  (self, 'time_wid
-00040250: 7468 5f70 6572 6365 6e74 2729 2065 6c73  th_percent') els
-00040260: 6520 7365 6c66 2e74 696d 655f 7769 6474  e self.time_widt
-00040270: 685f 7065 7263 656e 740d 0a09 0973 656c  h_percent....sel
-00040280: 662e 6261 7365 756e 6974 203d 2027 7073  f.baseunit = 'ps
-00040290: 2720 6966 206e 6f74 2068 6173 6174 7472  ' if not hasattr
-000402a0: 2873 656c 662c 2027 6261 7365 756e 6974  (self, 'baseunit
-000402b0: 2729 2065 6c73 6520 7365 6c66 2e62 6173  ') else self.bas
-000402c0: 6575 6e69 740d 0a09 0973 656c 662e 6d6f  eunit....self.mo
-000402d0: 6420 3d20 2765 7870 6f6e 656e 7469 616c  d = 'exponential
-000402e0: 2720 6966 206e 6f74 2068 6173 6174 7472  ' if not hasattr
-000402f0: 2873 656c 662c 2027 6d6f 6427 2920 656c  (self, 'mod') el
-00040300: 7365 2073 656c 662e 6d6f 640d 0a09 0973  se self.mod....s
-00040310: 656c 662e 7363 6174 7465 7263 7574 203d  elf.scattercut =
-00040320: 204e 6f6e 6520 6966 206e 6f74 2068 6173   None if not has
-00040330: 6174 7472 2873 656c 662c 2027 7363 6174  attr(self, 'scat
-00040340: 7465 7263 7574 2729 2065 6c73 6520 7365  tercut') else se
-00040350: 6c66 2e73 6361 7474 6572 6375 740d 0a09  lf.scattercut...
-00040360: 0973 656c 662e 626f 7264 6572 6375 7420  .self.bordercut 
-00040370: 3d20 4e6f 6e65 2069 6620 6e6f 7420 6861  = None if not ha
-00040380: 7361 7474 7228 7365 6c66 2c20 2762 6f72  sattr(self, 'bor
-00040390: 6465 7263 7574 2729 2065 6c73 6520 7365  dercut') else se
-000403a0: 6c66 2e62 6f72 6465 7263 7574 0d0a 0909  lf.bordercut....
-000403b0: 7365 6c66 2e74 696d 655f 6269 6e20 3d20  self.time_bin = 
-000403c0: 4e6f 6e65 2069 6620 6e6f 7420 6861 7361  None if not hasa
-000403d0: 7474 7228 7365 6c66 2c20 2774 696d 655f  ttr(self, 'time_
-000403e0: 6269 6e27 2920 656c 7365 2073 656c 662e  bin') else self.
-000403f0: 7469 6d65 5f62 696e 0d0a 0909 7365 6c66  time_bin....self
-00040400: 2e74 696d 656c 696d 6974 7320 3d20 4e6f  .timelimits = No
-00040410: 6e65 2069 6620 6e6f 7420 6861 7361 7474  ne if not hasatt
-00040420: 7228 7365 6c66 2c20 2774 696d 656c 696d  r(self, 'timelim
-00040430: 6974 7327 2920 656c 7365 2073 656c 662e  its') else self.
-00040440: 7469 6d65 6c69 6d69 7473 0d0a 0909 7365  timelimits....se
-00040450: 6c66 2e77 6176 655f 6e6d 5f62 696e 203d  lf.wave_nm_bin =
-00040460: 204e 6f6e 6520 6966 206e 6f74 2068 6173   None if not has
-00040470: 6174 7472 2873 656c 662c 2027 7761 7665  attr(self, 'wave
-00040480: 5f6e 6d5f 6269 6e27 2920 656c 7365 2073  _nm_bin') else s
-00040490: 656c 662e 7761 7665 5f6e 6d5f 6269 6e0d  elf.wave_nm_bin.
-000404a0: 0a09 0973 656c 662e 7761 7665 6c65 6e67  ...self.waveleng
-000404b0: 7468 5f62 696e 203d 2031 3020 6966 206e  th_bin = 10 if n
-000404c0: 6f74 2068 6173 6174 7472 2873 656c 662c  ot hasattr(self,
-000404d0: 2027 7761 7665 6c65 6e67 7468 5f62 696e   'wavelength_bin
-000404e0: 2729 2065 6c73 6520 7365 6c66 2e77 6176  ') else self.wav
-000404f0: 656c 656e 6774 685f 6269 6e0d 0a09 0973  elength_bin....s
-00040500: 656c 662e 7361 7665 5f66 6967 7572 6573  elf.save_figures
-00040510: 5f74 6f5f 666f 6c64 6572 203d 2046 616c  _to_folder = Fal
-00040520: 7365 2069 6620 6e6f 7420 6861 7361 7474  se if not hasatt
-00040530: 7228 7365 6c66 2c20 2773 6176 655f 6669  r(self, 'save_fi
-00040540: 6775 7265 735f 746f 5f66 6f6c 6465 7227  gures_to_folder'
-00040550: 2920 656c 7365 2073 656c 662e 7361 7665  ) else self.save
-00040560: 5f66 6967 7572 6573 5f74 6f5f 666f 6c64  _figures_to_fold
-00040570: 6572 0d0a 0909 7365 6c66 2e69 6e74 656e  er....self.inten
-00040580: 7369 7479 5f72 616e 6765 203d 204e 6f6e  sity_range = Non
-00040590: 6520 6966 206e 6f74 2068 6173 6174 7472  e if not hasattr
-000405a0: 2873 656c 662c 2027 696e 7465 6e73 6974  (self, 'intensit
-000405b0: 795f 7261 6e67 6527 2920 656c 7365 2073  y_range') else s
-000405c0: 656c 662e 696e 7465 6e73 6974 795f 7261  elf.intensity_ra
-000405d0: 6e67 650d 0a09 0973 656c 662e 6473 5f6f  nge....self.ds_o
-000405e0: 7269 2e69 6e64 6578 2e6e 616d 6520 3d20  ri.index.name = 
-000405f0: 2754 696d 6520 696e 2025 7327 2025 2073  'Time in %s' % s
-00040600: 656c 662e 6261 7365 756e 6974 2069 6620  elf.baseunit if 
-00040610: 6e6f 7420 6861 7361 7474 7228 7365 6c66  not hasattr(self
-00040620: 2c20 2764 735f 6f72 692e 696e 6465 782e  , 'ds_ori.index.
-00040630: 6e61 6d65 2729 2065 6c73 6520 7365 6c66  name') else self
-00040640: 2e64 735f 6f72 692e 696e 6465 782e 6e61  .ds_ori.index.na
-00040650: 6d65 0d0a 0909 7365 6c66 2e65 7175 616c  me....self.equal
-00040660: 5f65 6e65 7267 795f 6269 6e20 3d20 4e6f  _energy_bin = No
-00040670: 6e65 2069 6620 6e6f 7420 6861 7361 7474  ne if not hasatt
-00040680: 7228 7365 6c66 2c20 2765 7175 616c 5f65  r(self, 'equal_e
-00040690: 6e65 7267 795f 6269 6e27 2920 656c 7365  nergy_bin') else
-000406a0: 2073 656c 662e 6571 7561 6c5f 656e 6572   self.equal_ener
-000406b0: 6779 5f62 696e 0d0a 0909 7365 6c66 2e75  gy_bin....self.u
-000406c0: 6e69 7473 3d27 6e6d 2720 6966 206e 6f74  nits='nm' if not
-000406d0: 2068 6173 6174 7472 2873 656c 662c 2027   hasattr(self, '
-000406e0: 756e 6974 7327 2920 656c 7365 2073 656c  units') else sel
-000406f0: 662e 756e 6974 730d 0a09 0969 6620 7365  f.units....if se
-00040700: 6c66 2e75 6e69 7473 203d 3d20 276e 6d27  lf.units == 'nm'
-00040710: 3a0d 0a09 0909 7365 6c66 2e64 735f 6f72  :.....self.ds_or
-00040720: 692e 636f 6c75 6d6e 732e 6e61 6d65 203d  i.columns.name =
-00040730: 2027 5761 7665 6c65 6e67 7468 2069 6e20   'Wavelength in 
-00040740: 2573 2725 7365 6c66 2e75 6e69 7473 2069  %s'%self.units i
-00040750: 6620 6e6f 7420 6861 7361 7474 7228 7365  f not hasattr(se
-00040760: 6c66 2c20 2764 735f 6f72 692e 636f 6c75  lf, 'ds_ori.colu
-00040770: 6d6e 732e 6e61 6d65 2729 2065 6c73 6520  mns.name') else 
-00040780: 7365 6c66 2e64 735f 6f72 692e 636f 6c75  self.ds_ori.colu
-00040790: 6d6e 732e 6e61 6d65 0d0a 0909 656c 6966  mns.name....elif
-000407a0: 2073 656c 662e 756e 6974 7320 3d3d 2027   self.units == '
-000407b0: 6556 273a 0d0a 0909 0973 656c 662e 6473  eV':.....self.ds
-000407c0: 5f6f 7269 2e63 6f6c 756d 6e73 2e6e 616d  _ori.columns.nam
-000407d0: 6520 3d20 2745 6e65 7267 7920 696e 2025  e = 'Energy in %
-000407e0: 7327 2573 656c 662e 756e 6974 7320 6966  s'%self.units if
-000407f0: 206e 6f74 2068 6173 6174 7472 2873 656c   not hasattr(sel
-00040800: 662c 2027 6473 5f6f 7269 2e63 6f6c 756d  f, 'ds_ori.colum
-00040810: 6e73 2e6e 616d 6527 2920 656c 7365 2073  ns.name') else s
-00040820: 656c 662e 6473 5f6f 7269 2e63 6f6c 756d  elf.ds_ori.colum
-00040830: 6e73 2e6e 616d 650d 0a09 0965 6c69 6620  ns.name....elif 
-00040840: 7365 6c66 2e75 6e69 7473 203d 3d20 276b  self.units == 'k
-00040850: 6556 273a 0d0a 0909 0973 656c 662e 6473  eV':.....self.ds
-00040860: 5f6f 7269 2e63 6f6c 756d 6e73 2e6e 616d  _ori.columns.nam
-00040870: 6520 3d20 2745 6e65 7267 7920 696e 2025  e = 'Energy in %
-00040880: 7327 2573 656c 662e 756e 6974 7320 6966  s'%self.units if
-00040890: 206e 6f74 2068 6173 6174 7472 2873 656c   not hasattr(sel
-000408a0: 662c 2027 6473 5f6f 7269 2e63 6f6c 756d  f, 'ds_ori.colum
-000408b0: 6e73 2e6e 616d 6527 2920 656c 7365 2073  ns.name') else s
-000408c0: 656c 662e 6473 5f6f 7269 2e63 6f6c 756d  elf.ds_ori.colum
-000408d0: 6e73 2e6e 616d 650d 0a09 0965 6c73 653a  ns.name....else:
-000408e0: 0d0a 0909 0973 656c 662e 6473 5f6f 7269  .....self.ds_ori
-000408f0: 2e63 6f6c 756d 6e73 2e6e 616d 6520 3d20  .columns.name = 
-00040900: 2745 6e65 7267 7920 696e 2025 7327 2573  'Energy in %s'%s
-00040910: 656c 662e 756e 6974 7320 6966 206e 6f74  elf.units if not
-00040920: 2068 6173 6174 7472 2873 656c 662c 2027   hasattr(self, '
-00040930: 6473 5f6f 7269 2e63 6f6c 756d 6e73 2e6e  ds_ori.columns.n
-00040940: 616d 6527 2920 656c 7365 2073 656c 662e  ame') else self.
-00040950: 6473 5f6f 7269 2e63 6f6c 756d 6e73 2e6e  ds_ori.columns.n
-00040960: 616d 650d 0a09 0973 656c 662e 6461 7461  ame....self.data
-00040970: 5f74 7970 653d 2027 6469 6666 2e20 4162  _type= 'diff. Ab
-00040980: 736f 7270 7469 6f6e 2069 6e20 245c 6d61  sorption in $\ma
-00040990: 7468 7265 6775 6c61 727b 5c44 656c 7461  thregular{\Delta
-000409a0: 204f 447d 2427 2069 6620 6e6f 7420 6861   OD}$' if not ha
-000409b0: 7361 7474 7228 7365 6c66 2c20 2764 6174  sattr(self, 'dat
-000409c0: 615f 7479 7065 2729 2065 6c73 6520 7365  a_type') else se
-000409d0: 6c66 2e64 6174 615f 7479 7065 0d0a 0909  lf.data_type....
-000409e0: 0d0a 0909 7472 793a 2373 656c 662e 6669  ....try:#self.fi
-000409f0: 7463 6f65 6666 0d0a 0909 0973 656c 662e  tcoeff.....self.
-00040a00: 6669 7463 6f65 6666 0d0a 0909 0969 6620  fitcoeff.....if 
-00040a10: 6c65 6e28 6c69 7374 2873 656c 662e 6669  len(list(self.fi
-00040a20: 7463 6f65 6666 2929 3c35 3a72 6169 7365  tcoeff))<5:raise
-00040a30: 0d0a 0909 6578 6365 7074 3a0d 0a09 0909  ....except:.....
-00040a40: 7365 6c66 2e66 6974 636f 6566 663d 5b30  self.fitcoeff=[0
-00040a50: 2c30 2c30 2c30 2c30 5d20 233a 2074 6573  ,0,0,0,0] #: tes
-00040a60: 7420 636f 6d6d 656e 7420 6865 7265 0d0a  t comment here..
-00040a70: 0909 7472 793a 2373 656c 662e 6368 6972  ..try:#self.chir
-00040a80: 705f 6669 6c65 0d0a 0909 0973 656c 662e  p_file.....self.
-00040a90: 6368 6972 705f 6669 6c65 0d0a 0909 6578  chirp_file....ex
-00040aa0: 6365 7074 3a0d 0a09 0909 6966 206f 732e  cept:.....if os.
-00040ab0: 7061 7468 2e69 7366 696c 6528 6368 6563  path.isfile(chec
-00040ac0: 6b5f 666f 6c64 6572 2870 6174 683d 7365  k_folder(path=se
-00040ad0: 6c66 2e70 6174 682c 6669 6c65 6e61 6d65  lf.path,filename
-00040ae0: 3d73 656c 662e 6669 6c65 6e61 6d65 2e73  =self.filename.s
-00040af0: 706c 6974 2827 2e27 295b 305d 202b 2027  plit('.')[0] + '
-00040b00: 5f63 6869 7270 2e64 6174 2729 293a 0d0a  _chirp.dat')):..
-00040b10: 0909 0909 7365 6c66 2e63 6869 7270 5f66  ....self.chirp_f
-00040b20: 696c 653d 7365 6c66 2e66 696c 656e 616d  ile=self.filenam
-00040b30: 652e 7370 6c69 7428 272e 2729 5b30 5d20  e.split('.')[0] 
-00040b40: 2b20 275f 6368 6972 702e 6461 7427 0d0a  + '_chirp.dat'..
-00040b50: 0909 0965 6c73 653a 0d0a 0909 0909 7365  ...else:......se
-00040b60: 6c66 2e63 6869 7270 5f66 696c 653d 4661  lf.chirp_file=Fa
-00040b70: 6c73 650d 0a09 0974 7279 3a23 7365 6c66  lse....try:#self
-00040b80: 2e66 6967 7572 655f 7061 7468 0d0a 0909  .figure_path....
-00040b90: 0973 656c 662e 6669 6775 7265 5f70 6174  .self.figure_pat
-00040ba0: 680d 0a09 0965 7863 6570 743a 0d0a 0909  h....except:....
-00040bb0: 0969 6620 7365 6c66 2e73 6176 655f 6669  .if self.save_fi
-00040bc0: 6775 7265 735f 746f 5f66 6f6c 6465 723a  gures_to_folder:
-00040bd0: 0d0a 0909 0909 7365 6c66 2e66 6967 7572  ......self.figur
-00040be0: 655f 7061 7468 3d63 6865 636b 5f66 6f6c  e_path=check_fol
-00040bf0: 6465 7228 7061 7468 3d22 7265 7375 6c74  der(path="result
-00040c00: 5f66 6967 7572 6573 222c 6375 7272 656e  _figures",curren
-00040c10: 745f 7061 7468 3d70 6174 6829 0d0a 0909  t_path=path)....
-00040c20: 0965 6c73 653a 0d0a 0909 0909 7365 6c66  .else:......self
-00040c30: 2e66 6967 7572 655f 7061 7468 3d4e 6f6e  .figure_path=Non
-00040c40: 650d 0a0d 0a09 0973 656c 662e 6473 3d73  e......self.ds=s
-00040c50: 656c 662e 6473 5f6f 7269 2e63 6f70 7928  elf.ds_ori.copy(
-00040c60: 290d 0a0d 0a09 0d0a 0964 6566 2046 696c  )........def Fil
-00040c70: 7465 725f 6461 7461 2873 656c 662c 2064  ter_data(self, d
-00040c80: 733d 4e6f 6e65 2c20 6375 745f 6261 645f  s=None, cut_bad_
-00040c90: 7469 6d65 7320 3d20 4661 6c73 652c 2072  times = False, r
-00040ca0: 6570 6c61 6365 5f62 6164 5f76 616c 7565  eplace_bad_value
-00040cb0: 7320 3d20 302c 2076 616c 7565 203d 2032  s = 0, value = 2
-00040cc0: 302c 2075 7070 6572 7661 6c75 6520 3d20  0, uppervalue = 
-00040cd0: 4e6f 6e65 2c20 6c6f 7765 7276 616c 7565  None, lowervalue
-00040ce0: 203d 204e 6f6e 652c 2075 7070 6572 5f6d   = None, upper_m
-00040cf0: 6174 7269 7820 3d20 4e6f 6e65 2c20 6c6f  atrix = None, lo
-00040d00: 7765 725f 6d61 7472 6978 203d 204e 6f6e  wer_matrix = Non
-00040d10: 6529 3a0d 0a09 0927 2727 4669 6c74 6572  e):....'''Filter
-00040d20: 6573 2074 6865 2064 6174 6120 6279 2061  es the data by a
-00040d30: 7070 6c79 696e 6720 6861 7264 2072 6570  pplying hard rep
-00040d40: 6c61 6365 6d65 6e74 732e 2069 6620 626f  lacements. if bo
-00040d50: 7468 2072 6570 6c61 6365 5f62 6164 5f76  th replace_bad_v
-00040d60: 616c 7565 7320 616e 6420 0d0a 0909 6375  alues and ....cu
-00040d70: 745f 6261 645f 7469 6d65 7320 6172 6520  t_bad_times are 
-00040d80: 6661 6c73 6520 6f72 204e 6f6e 652c 2074  false or None, t
-00040d90: 6865 2074 696d 6573 2061 626f 7665 2022  he times above "
-00040da0: 7661 6c75 6522 2061 7265 2072 6570 6c61  value" are repla
-00040db0: 6365 6420 6279 207a 6572 6f0d 0a09 090d  ced by zero.....
-00040dc0: 0a09 0950 6172 616d 6574 6572 730d 0a09  ...Parameters...
-00040dd0: 092d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a09  .------------...
-00040de0: 090d 0a09 0964 7320 3a20 7061 6e64 6173  .....ds : pandas
-00040df0: 2044 6174 6166 7261 6d65 2c20 6f70 7469   Dataframe, opti
-00040e00: 6f6e 616c 0d0a 0909 0969 6620 7468 6973  onal.....if this
-00040e10: 2069 7320 4e6f 6e65 2028 6465 6661 756c   is None (defaul
-00040e20: 7429 2074 6865 6e20 7468 6520 7365 6c66  t) then the self
-00040e30: 2e64 7320 616e 6420 7365 6c66 2e64 735f  .ds and self.ds_
-00040e40: 6f72 6920 7769 6c20 6265 2066 696c 7465  ori wil be filte
-00040e50: 7265 640d 0a09 090d 0a09 0976 616c 7565  red........value
-00040e60: 203a 2066 6c6f 6174 2c20 6f70 7469 6f6e   : float, option
-00040e70: 616c 0d0a 0909 0961 6c6c 2076 616c 7565  al.....all value
-00040e80: 7320 6162 6f76 6520 7468 6973 2028 6162  s above this (ab
-00040e90: 736f 6c75 7465 2920 7661 6c75 6520 6172  solute) value ar
-00040ea0: 6520 636f 6e73 6964 6572 6564 2074 6f20  e considered to 
-00040eb0: 6265 2063 6f72 7275 7074 6564 2e20 2844  be corrupted. (D
-00040ec0: 6566 6175 6c74 2032 3029 2061 7320 636c  efault 20) as cl
-00040ed0: 6173 7369 6361 6c6c 7920 7468 6520 7365  assically the se
-00040ee0: 7475 7020 0d0a 0909 0972 6570 6f72 7473  tup .....reports
-00040ef0: 206f 7074 6963 616c 2044 456e 7369 7479   optical DEnsity
-00040f00: 2c20 616e 204f 4420 6f66 2032 3020 776f  , an OD of 20 wo
-00040f10: 756c 6420 6265 2066 6172 2061 626f 7665  uld be far above
-00040f20: 2074 6865 2074 7970 6963 616c 6c79 2065   the typically e
-00040f30: 7870 6563 7465 640d 0a09 0909 4f44 2031  xpected.....OD 1
-00040f40: 652d 332e 2050 6173 6368 6572 2069 6e73  e-3. Pascher ins
-00040f50: 7472 756d 656e 7420 736f 6674 7761 7265  trument software
-00040f60: 2075 7365 7320 6120 7661 6c75 6520 6f66   uses a value of
-00040f70: 2032 3120 746f 2069 6e64 6963 6174 6520   21 to indicate 
-00040f80: 616e 2065 7272 6f72 2e0d 0a09 090d 0a09  an error........
-00040f90: 0975 7070 6572 7661 6c75 6520 3a20 666c  .uppervalue : fl
-00040fa0: 6f61 742c 206f 7074 696f 6e61 6c0d 0a09  oat, optional...
-00040fb0: 0909 616c 6c20 7661 6c75 6573 2061 626f  ..all values abo
-00040fc0: 7665 2074 6869 7320 6e75 6d62 6572 2061  ve this number a
-00040fd0: 7265 2063 6f6e 7369 6465 7265 6420 746f  re considered to
-00040fe0: 2062 6520 636f 7272 7570 7465 642e 2028   be corrupted. (
-00040ff0: 4465 6661 756c 7420 3230 2920 6173 2063  Default 20) as c
-00041000: 6c61 7373 6963 616c 6c79 2074 6865 2073  lassically the s
-00041010: 6574 7570 200d 0a09 0909 7265 706f 7274  etup .....report
-00041020: 7320 6f70 7469 6361 6c20 4445 6e73 6974  s optical DEnsit
-00041030: 792c 2061 6e20 4f44 206f 6620 3230 2077  y, an OD of 20 w
-00041040: 6f75 6c64 2062 6520 6661 7220 6162 6f76  ould be far abov
-00041050: 6520 7468 6520 7479 7069 6361 6c6c 7920  e the typically 
-00041060: 6578 7065 6374 6564 0d0a 0909 094f 4420  expected.....OD 
-00041070: 3165 2d33 2e20 5061 7363 6865 7220 696e  1e-3. Pascher in
-00041080: 7374 7275 6d65 6e74 2073 6f66 7477 6172  strument softwar
-00041090: 6520 7573 6573 2061 2076 616c 7565 206f  e uses a value o
-000410a0: 6620 3231 2074 6f20 696e 6469 6361 7465  f 21 to indicate
-000410b0: 2061 6e20 6572 726f 722e 0d0a 0909 0d0a   an error.......
-000410c0: 0909 6c6f 7765 7276 616c 7565 203a 2066  ..lowervalue : f
-000410d0: 6c6f 6174 2c20 6f70 7469 6f6e 616c 0d0a  loat, optional..
-000410e0: 0909 0961 6c6c 2076 616c 7565 7320 6265  ...all values be
-000410f0: 6c6f 7720 7468 6973 206e 756d 6265 7220  low this number 
-00041100: 6172 6520 636f 6e73 6964 6572 6564 2074  are considered t
-00041110: 6f20 6265 2063 6f72 7275 7074 6564 2e20  o be corrupted. 
-00041120: 2844 6566 6175 6c74 202d 3230 2920 6173  (Default -20) as
-00041130: 2063 6c61 7373 6963 616c 6c79 2074 6865   classically the
-00041140: 2073 6574 7570 200d 0a09 0909 7265 706f   setup .....repo
-00041150: 7274 7320 6f70 7469 6361 6c20 4445 6e73  rts optical DEns
-00041160: 6974 792c 2061 6e20 4f44 206f 6620 2d32  ity, an OD of -2
-00041170: 3020 776f 756c 6420 6265 2066 6172 2061  0 would be far a
-00041180: 626f 7665 2074 6865 2074 7970 6963 616c  bove the typical
-00041190: 6c79 2065 7870 6563 7465 640d 0a09 0909  ly expected.....
-000411a0: 4f44 2031 652d 332e 2050 6173 6368 6572  OD 1e-3. Pascher
-000411b0: 2069 6e73 7472 756d 656e 7420 736f 6674   instrument soft
-000411c0: 7761 7265 2075 7365 7320 6120 7661 6c75  ware uses a valu
-000411d0: 6520 6f66 2032 3120 746f 2069 6e64 6963  e of 21 to indic
-000411e0: 6174 6520 616e 2065 7272 6f72 2e0d 0a09  ate an error....
-000411f0: 090d 0a09 0972 6570 6c61 6365 5f62 6164  .....replace_bad
-00041200: 5f76 616c 7565 7320 3a20 4e6f 6e65 206f  _values : None o
-00041210: 6620 666c 6f61 742c 206f 7074 696f 6e61  f float, optiona
-00041220: 6c0d 0a09 0909 7661 6c75 6573 2061 626f  l.....values abo
-00041230: 7665 2074 6865 2074 7265 7368 6f6c 6420  ve the treshold 
-00041240: 6172 6520 7265 706c 6163 6564 2077 6974  are replaced wit
-00041250: 6820 7468 6973 2076 616c 7565 2e20 4967  h this value. Ig
-00041260: 6e6f 7265 6420 6f66 204e 6f6e 6520 2844  nored of None (D
-00041270: 6566 6175 6c74 290d 0a09 0909 0d0a 0909  efault).........
-00041280: 6375 745f 6261 645f 7469 6d65 7320 3d20  cut_bad_times = 
-00041290: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0d0a  bool, optional..
-000412a0: 0909 0954 7275 6520 2844 6566 6175 6c74  ...True (Default
-000412b0: 3d46 616c 7365 2920 7265 6d6f 7665 7320  =False) removes 
-000412c0: 7468 6520 7768 6f6c 6520 7469 6d65 2077  the whole time w
-000412d0: 6865 7265 2074 6869 7320 6973 2074 7275  here this is tru
-000412e0: 650d 0a09 090d 0a09 0975 7070 6572 5f6d  e........upper_m
-000412f0: 6174 7269 7820 3a20 5061 6e64 6173 2044  atrix : Pandas D
-00041300: 6174 6146 7261 6d65 2c20 6f70 7469 6f6e  ataFrame, option
-00041310: 616c 0d0a 0909 0961 6c6c 2076 616c 7565  al.....all value
-00041320: 7320 6162 6f76 6520 7468 6973 2074 7265  s above this tre
-00041330: 7368 6f6c 6420 7769 6c6c 2062 6520 7075  shold will be pu
-00041340: 7420 4e2f 4120 6f72 2072 6570 6c61 6365  t N/A or replace
-00041350: 2062 7920 7468 6520 7661 6c75 6520 696e   by the value in
-00041360: 2072 6570 6c61 6365 5f62 6164 5f76 616c   replace_bad_val
-00041370: 7565 730d 0a09 090d 0a09 096c 6f77 6572  ues........lower
-00041380: 5f6d 6174 7269 7820 5061 6e64 6173 2044  _matrix Pandas D
-00041390: 6174 6146 7261 6d65 2c20 6f70 7469 6f6e  ataFrame, option
-000413a0: 616c 0d0a 0909 0961 6c6c 2076 616c 7565  al.....all value
-000413b0: 7320 6265 6c6f 7720 7468 6973 2074 7265  s below this tre
-000413c0: 7368 6f6c 6420 7769 6c6c 2062 6520 7075  shold will be pu
-000413d0: 7420 4e2f 4120 6f72 2072 6570 6c61 6365  t N/A or replace
-000413e0: 2062 7920 7468 6520 7661 6c75 6520 696e   by the value in
-000413f0: 2072 6570 6c61 6365 5f62 6164 5f76 616c   replace_bad_val
-00041400: 7565 730d 0a09 090d 0a09 0974 6865 2076  ues........the v
-00041410: 616c 7565 2069 7320 7468 6520 7570 7065  alue is the uppe
-00041420: 7220 626f 756e 642e 2065 7665 7279 7468  r bound. everyth
-00041430: 696e 6720 0d0a 0909 6162 6f76 6520 7769  ing ....above wi
-00041440: 6c6c 2062 6520 6669 6c74 6572 6564 2e20  ll be filtered. 
-00041450: 5374 616e 6461 7264 2069 7320 746f 2064  Standard is to d
-00041460: 726f 7020 7468 6520 726f 7773 283d 7469  rop the rows(=ti
-00041470: 6d65 7329 2077 6865 7265 2073 6f6d 6574  mes) where somet
-00041480: 6869 6e67 2077 656e 7420 7772 6f6e 670d  hing went wrong.
-00041490: 0a09 090d 0a09 0945 7861 6d70 6c65 730d  .......Examples.
-000414a0: 0a09 092d 2d2d 2d2d 2d2d 2d2d 0d0a 0909  ...---------....
-000414b0: 0d0a 0909 7479 7069 6361 6c20 7573 6167  ....typical usag
-000414c0: 650d 0a09 090d 0a09 093e 3e3e 2069 6d70  e........>>> imp
-000414d0: 6f72 7420 706c 6f74 6675 6e63 2061 7320  ort plotfunc as 
-000414e0: 7066 0d0a 0909 3e3e 3e20 7461 3d70 662e  pf....>>> ta=pf.
-000414f0: 5441 2827 7465 7374 6669 6c65 2e53 4941  TA('testfile.SIA
-00041500: 2729 0d0a 0909 3e3e 3e20 7461 2e46 696c  ')....>>> ta.Fil
-00041510: 7465 725f 6461 7461 2829 0d0a 0909 3e3e  ter_data()....>>
-00041520: 3e20 7461 2e46 696c 7465 725f 6461 7461  > ta.Filter_data
-00041530: 2876 616c 7565 3d31 2920 2374 6f20 6669  (value=1) #to fi
-00041540: 6c74 6572 2074 696d 6573 2077 6974 6820  lter times with 
-00041550: 6174 206c 6561 7374 206f 6e65 2070 6f69  at least one poi
-00041560: 6e74 2077 6974 6820 4f44 2031 0d0a 0909  nt with OD 1....
-00041570: 0d0a 0909 2727 270d 0a09 0969 6620 7570  ....'''....if up
-00041580: 7065 7276 616c 7565 2069 7320 4e6f 6e65  pervalue is None
-00041590: 3a20 7570 7065 7276 616c 7565 203d 206e  : uppervalue = n
-000415a0: 702e 6162 7328 7661 6c75 6529 0d0a 0909  p.abs(value)....
-000415b0: 6966 206c 6f77 6572 7661 6c75 6520 6973  if lowervalue is
-000415c0: 204e 6f6e 653a 206c 6f77 6572 7661 6c75   None: lowervalu
-000415d0: 6520 3d20 2d6e 702e 6162 7328 7661 6c75  e = -np.abs(valu
-000415e0: 6529 0d0a 0909 0d0a 0909 6966 2072 6570  e)........if rep
-000415f0: 6c61 6365 5f62 6164 5f76 616c 7565 7320  lace_bad_values 
-00041600: 6973 206e 6f74 204e 6f6e 653a 0d0a 0909  is not None:....
-00041610: 0963 7574 5f62 6164 5f74 696d 6573 3d46  .cut_bad_times=F
-00041620: 616c 7365 0d0a 0909 0d0a 0909 6966 2064  alse........if d
-00041630: 7320 6973 204e 6f6e 653a 0d0a 0909 0966  s is None:.....f
-00041640: 696c 7465 7269 6e67 3d5b 7365 6c66 2e64  iltering=[self.d
-00041650: 732c 7365 6c66 2e64 735f 6f72 695d 0d0a  s,self.ds_ori]..
-00041660: 0909 656c 7365 3a0d 0a09 0909 6669 6c74  ..else:.....filt
-00041670: 6572 696e 673d 5b64 735d 0d0a 0909 0d0a  ering=[ds]......
-00041680: 0909 666f 7220 6461 7461 7365 7420 696e  ..for dataset in
-00041690: 2066 696c 7465 7269 6e67 3a0d 0a09 0909   filtering:.....
-000416a0: 6966 2061 6e79 285b 7365 6c66 2e69 676e  if any([self.ign
-000416b0: 6f72 655f 7469 6d65 5f72 6567 696f 6e20  ore_time_region 
-000416c0: 6973 206e 6f74 204e 6f6e 652c 2073 656c  is not None, sel
-000416d0: 662e 7363 6174 7465 7263 7574 2069 7320  f.scattercut is 
-000416e0: 6e6f 7420 4e6f 6e65 2c20 7365 6c66 2e62  not None, self.b
-000416f0: 6f72 6465 7263 7574 2069 7320 6e6f 7420  ordercut is not 
-00041700: 4e6f 6e65 2c20 7365 6c66 2e74 696d 656c  None, self.timel
-00041710: 696d 6974 7320 6973 206e 6f74 204e 6f6e  imits is not Non
-00041720: 655d 293a 0d0a 0909 0909 6461 7461 7365  e]):......datase
-00041730: 743d 7375 625f 6473 2864 6174 6173 6574  t=sub_ds(dataset
-00041740: 2c20 6967 6e6f 7265 5f74 696d 655f 7265  , ignore_time_re
-00041750: 6769 6f6e 203d 2073 656c 662e 6967 6e6f  gion = self.igno
-00041760: 7265 5f74 696d 655f 7265 6769 6f6e 2c20  re_time_region, 
-00041770: 7363 6174 7465 7263 7574 203d 2073 656c  scattercut = sel
-00041780: 662e 7363 6174 7465 7263 7574 2c20 626f  f.scattercut, bo
-00041790: 7264 6572 6375 7420 3d20 7365 6c66 2e62  rdercut = self.b
-000417a0: 6f72 6465 7263 7574 2c20 7469 6d65 6c69  ordercut, timeli
-000417b0: 6d69 7473 203d 2073 656c 662e 7469 6d65  mits = self.time
-000417c0: 6c69 6d69 7473 290d 0a09 0909 6966 2063  limits).....if c
-000417d0: 7574 5f62 6164 5f74 696d 6573 3a20 2374  ut_bad_times: #t
-000417e0: 696d 6570 6f69 6e74 2066 696c 7465 722c  imepoint filter,
-000417f0: 2064 656c 6574 6520 7468 6520 7469 6d65   delete the time
-00041800: 706f 696e 7473 2077 6865 7265 2076 616c  points where val
-00041810: 7565 2069 7320 7374 7570 6964 0d0a 0909  ue is stupid....
-00041820: 0909 6d61 7472 6978 5f73 697a 653d 6c65  ..matrix_size=le
-00041830: 6e28 6461 7461 7365 742e 696e 6465 782e  n(dataset.index.
-00041840: 7661 6c75 6573 290d 0a09 0909 0969 6620  values)......if 
-00041850: 7570 7065 725f 6d61 7472 6978 2069 7320  upper_matrix is 
-00041860: 4e6f 6e65 3a0d 0a09 0909 0909 6461 6d61  None:.......dama
-00041870: 6765 645f 7469 6d65 733d 6461 7461 7365  ged_times=datase
-00041880: 745b 6e70 2e61 6e79 2864 6174 6173 6574  t[np.any(dataset
-00041890: 2e76 616c 7565 733e 7570 7065 7276 616c  .values>upperval
-000418a0: 7565 2c61 7869 733d 3129 5d2e 696e 6465  ue,axis=1)].inde
-000418b0: 780d 0a09 0909 0965 6c73 653a 0d0a 0909  x......else:....
-000418c0: 0909 0964 616d 6167 6564 5f74 696d 6573  ...damaged_times
-000418d0: 3d64 6174 6173 6574 5b6e 702e 616e 7928  =dataset[np.any(
-000418e0: 6461 7461 7365 742e 7661 6c75 6573 3e75  dataset.values>u
-000418f0: 7070 6572 5f6d 6174 7269 782c 6178 6973  pper_matrix,axis
-00041900: 3d31 295d 2e69 6e64 6578 0d0a 0909 0909  =1)].index......
-00041910: 6461 7461 7365 742e 6472 6f70 2864 616d  dataset.drop(dam
-00041920: 6167 6564 5f74 696d 6573 2c69 6e70 6c61  aged_times,inpla
-00041930: 6365 203d 2054 7275 6529 0d0a 0909 0909  ce = True)......
-00041940: 6966 206c 6f77 6572 5f6d 6174 7269 7820  if lower_matrix 
-00041950: 6973 204e 6f6e 653a 0d0a 0909 0909 0964  is None:.......d
-00041960: 616d 6167 6564 5f74 696d 6573 3d64 6174  amaged_times=dat
-00041970: 6173 6574 5b6e 702e 616e 7928 6461 7461  aset[np.any(data
-00041980: 7365 742e 7661 6c75 6573 3c6c 6f77 6572  set.values<lower
-00041990: 7661 6c75 652c 6178 6973 3d31 295d 2e69  value,axis=1)].i
-000419a0: 6e64 6578 0d0a 0909 0909 656c 7365 3a0d  ndex......else:.
-000419b0: 0a09 0909 0909 6461 6d61 6765 645f 7469  ......damaged_ti
-000419c0: 6d65 733d 6461 7461 7365 745b 6e70 2e61  mes=dataset[np.a
-000419d0: 6e79 2864 6174 6173 6574 2e76 616c 7565  ny(dataset.value
-000419e0: 733c 6c6f 7765 725f 6d61 7472 6978 2c61  s<lower_matrix,a
-000419f0: 7869 733d 3129 5d2e 696e 6465 780d 0a09  xis=1)].index...
-00041a00: 0909 0964 6174 6173 6574 2e64 726f 7028  ...dataset.drop(
-00041a10: 6461 6d61 6765 645f 7469 6d65 732c 696e  damaged_times,in
-00041a20: 706c 6163 6520 3d20 5472 7565 290d 0a09  place = True)...
-00041a30: 0909 0969 6620 6c65 6e28 6461 7461 7365  ...if len(datase
-00041a40: 742e 696e 6465 782e 7661 6c75 6573 293c  t.index.values)<
-00041a50: 6d61 7472 6978 5f73 697a 652a 302e 383a  matrix_size*0.8:
-00041a60: 0d0a 0909 0909 0970 7269 6e74 2827 6174  .......print('at
-00041a70: 7465 6e74 696f 6e2c 206d 6f72 6520 7468  tention, more th
-00041a80: 616e 2032 3025 206f 6620 7468 6520 6461  an 20% of the da
-00041a90: 7461 2077 6173 2072 656d 6f76 6564 2062  ta was removed b
-00041aa0: 7920 7468 6973 2066 696c 7465 722e 2729  y this filter.')
-00041ab0: 200d 0a09 0909 0909 7072 696e 7428 2750   .......print('P
-00041ac0: 6c65 6173 6520 6368 6563 6b20 7769 7468  lease check with
-00041ad0: 2069 6620 7468 6520 7370 6563 7461 6c20   if the spectal 
-00041ae0: 626f 7264 6572 7320 636f 6e74 6169 6e20  borders contain 
-00041af0: 7265 6769 6f6e 7320 7769 7468 6f75 7420  regions without 
-00041b00: 6c69 6768 7420 2861 6e64 2068 6967 6820  light (and high 
-00041b10: 6e6f 6973 6529 2729 0d0a 0909 0909 0970  noise)').......p
-00041b20: 7269 6e74 2827 5365 7474 696e 6720 6120  rint('Setting a 
-00041b30: 626f 7264 6572 6375 7420 616e 6420 7363  bordercut and sc
-00041b40: 6174 7465 7263 7574 2062 6566 6f72 6520  attercut before 
-00041b50: 7468 6520 6669 6c74 6572 696e 6720 6d69  the filtering mi
-00041b60: 6768 7420 6265 2075 7365 6675 6c27 290d  ght be useful').
-00041b70: 0a09 0909 656c 7365 3a20 0d0a 0909 0909  ....else: ......
-00041b80: 6966 2072 6570 6c61 6365 5f62 6164 5f76  if replace_bad_v
-00041b90: 616c 7565 7320 6973 204e 6f6e 653a 2023  alues is None: #
-00041ba0: 696e 6469 7669 6475 616c 2064 6174 6120  individual data 
-00041bb0: 6669 6c74 6572 0d0a 0909 0909 0972 6570  filter.......rep
-00041bc0: 6c61 6365 5f62 6164 5f76 616c 7565 733d  lace_bad_values=
-00041bd0: 6e70 2e6e 616e 0d0a 0909 0909 6966 2075  np.nan......if u
-00041be0: 7070 6572 5f6d 6174 7269 7820 6973 204e  pper_matrix is N
-00041bf0: 6f6e 653a 0d0a 0909 0909 0964 6174 6173  one:.......datas
-00041c00: 6574 2e76 616c 7565 735b 6461 7461 7365  et.values[datase
-00041c10: 742e 7661 6c75 6573 3e75 7070 6572 7661  t.values>upperva
-00041c20: 6c75 655d 3d72 6570 6c61 6365 5f62 6164  lue]=replace_bad
-00041c30: 5f76 616c 7565 730d 0a09 0909 0965 6c73  _values......els
-00041c40: 653a 0d0a 0909 0909 0964 6174 6173 6574  e:.......dataset
-00041c50: 2e76 616c 7565 735b 6461 7461 7365 742e  .values[dataset.
-00041c60: 7661 6c75 6573 3e75 7070 6572 5f6d 6174  values>upper_mat
-00041c70: 7269 785d 3d72 6570 6c61 6365 5f62 6164  rix]=replace_bad
-00041c80: 5f76 616c 7565 730d 0a09 0909 0969 6620  _values......if 
-00041c90: 6c6f 7765 725f 6d61 7472 6978 2069 7320  lower_matrix is 
-00041ca0: 4e6f 6e65 3a0d 0a09 0909 0909 6461 7461  None:.......data
-00041cb0: 7365 742e 7661 6c75 6573 5b64 6174 6173  set.values[datas
-00041cc0: 6574 2e76 616c 7565 733c 6c6f 7765 7276  et.values<lowerv
-00041cd0: 616c 7565 5d3d 7265 706c 6163 655f 6261  alue]=replace_ba
-00041ce0: 645f 7661 6c75 6573 0d0a 0909 0909 656c  d_values......el
-00041cf0: 7365 3a0d 0a09 0909 0909 6461 7461 7365  se:.......datase
-00041d00: 742e 7661 6c75 6573 5b64 6174 6173 6574  t.values[dataset
-00041d10: 2e76 616c 7565 733c 6c6f 7765 725f 6d61  .values<lower_ma
-00041d20: 7472 6978 5d3d 7265 706c 6163 655f 6261  trix]=replace_ba
-00041d30: 645f 7661 6c75 6573 0d0a 0909 0909 6966  d_values......if
-00041d40: 2072 6570 6c61 6365 5f62 6164 5f76 616c   replace_bad_val
-00041d50: 7565 7320 3d3d 206e 702e 6e61 6e3a 200d  ues == np.nan: .
-00041d60: 0a09 0909 0909 6966 2064 6174 6173 6574  ......if dataset
-00041d70: 2e69 736e 6128 292e 7375 6d28 292e 7375  .isna().sum().su
-00041d80: 6d28 293e 302e 3220 2a20 6461 7461 7365  m()>0.2 * datase
-00041d90: 742e 6e6f 746e 6128 292e 7375 6d28 292e  t.notna().sum().
-00041da0: 7375 6d28 293a 0d0a 0909 0909 0909 7072  sum():........pr
-00041db0: 696e 7428 2761 7474 656e 7469 6f6e 2c20  int('attention, 
-00041dc0: 6d6f 7265 2074 6861 6e20 3230 2520 6f66  more than 20% of
-00041dd0: 2074 6865 2064 6174 6120 7761 7320 7265   the data was re
-00041de0: 6d6f 7665 6420 6279 2074 6869 7320 6669  moved by this fi
-00041df0: 6c74 6572 2e27 2920 0d0a 0909 0909 0909  lter.') ........
-00041e00: 7072 696e 7428 2750 6c65 6173 6520 6368  print('Please ch
-00041e10: 6563 6b20 7769 7468 2069 6620 7468 6520  eck with if the 
-00041e20: 7370 6563 7461 6c20 626f 7264 6572 7320  spectal borders 
-00041e30: 636f 6e74 6169 6e20 7265 6769 6f6e 7320  contain regions 
-00041e40: 7769 7468 6f75 7420 6c69 6768 7420 2861  without light (a
-00041e50: 6e64 2068 6967 6820 6e6f 6973 6529 2729  nd high noise)')
-00041e60: 0d0a 0909 0909 0909 7072 696e 7428 2753  ........print('S
-00041e70: 6574 7469 6e67 2061 2062 6f72 6465 7263  etting a borderc
-00041e80: 7574 2061 6e64 2073 6361 7474 6572 6375  ut and scattercu
-00041e90: 7420 6265 666f 7265 2074 6865 2066 696c  t before the fil
-00041ea0: 7465 7269 6e67 206d 6967 6874 2062 6520  tering might be 
-00041eb0: 7573 6566 756c 2729 0d0a 0909 0909 656c  useful')......el
-00041ec0: 7365 3a0d 0a09 0909 0909 6966 2064 6174  se:.......if dat
-00041ed0: 6173 6574 5b64 6174 6173 6574 3d3d 7265  aset[dataset==re
-00041ee0: 706c 6163 655f 6261 645f 7661 6c75 6573  place_bad_values
-00041ef0: 5d2e 6e6f 746e 6128 292e 7375 6d28 292e  ].notna().sum().
-00041f00: 7375 6d28 293e 2030 2e32 2a20 6461 7461  sum()> 0.2* data
-00041f10: 7365 745b 6461 7461 7365 7421 3d72 6570  set[dataset!=rep
-00041f20: 6c61 6365 5f62 6164 5f76 616c 7565 735d  lace_bad_values]
-00041f30: 2e6e 6f74 6e61 2829 2e73 756d 2829 2e73  .notna().sum().s
-00041f40: 756d 2829 3a0d 0a09 0909 0909 0970 7269  um():........pri
-00041f50: 6e74 2827 6174 7465 6e74 696f 6e2c 206d  nt('attention, m
-00041f60: 6f72 6520 7468 616e 2032 3025 206f 6620  ore than 20% of 
-00041f70: 7468 6520 6461 7461 2077 6173 2072 656d  the data was rem
-00041f80: 6f76 6564 2062 7920 7468 6973 2066 696c  oved by this fil
-00041f90: 7465 722e 2729 200d 0a09 0909 0909 0970  ter.') ........p
-00041fa0: 7269 6e74 2827 506c 6561 7365 2063 6865  rint('Please che
-00041fb0: 636b 2077 6974 6820 6966 2074 6865 2073  ck with if the s
-00041fc0: 7065 6374 616c 2062 6f72 6465 7273 2063  pectal borders c
-00041fd0: 6f6e 7461 696e 2072 6567 696f 6e73 2077  ontain regions w
-00041fe0: 6974 686f 7574 206c 6967 6874 2028 616e  ithout light (an
-00041ff0: 6420 6869 6768 206e 6f69 7365 2927 290d  d high noise)').
-00042000: 0a09 0909 0909 0970 7269 6e74 2827 5365  .......print('Se
-00042010: 7474 696e 6720 6120 626f 7264 6572 6375  tting a bordercu
-00042020: 7420 616e 6420 7363 6174 7465 7263 7574  t and scattercut
-00042030: 2062 6566 6f72 6520 7468 6520 6669 6c74   before the filt
-00042040: 6572 696e 6720 6d69 6768 7420 6265 2075  ering might be u
-00042050: 7365 6675 6c27 290d 0a09 090d 0a09 0969  seful')........i
-00042060: 6620 6473 2069 7320 6e6f 7420 4e6f 6e65  f ds is not None
-00042070: 3a72 6574 7572 6e20 6669 6c74 6572 696e  :return filterin
-00042080: 675b 305d 0d0a 0d0a 090d 0a09 0d0a 0964  g[0]...........d
-00042090: 6566 2042 6163 6b67 726f 756e 6428 7365  ef Background(se
-000420a0: 6c66 2c20 6c6f 776c 696d 6974 3d4e 6f6e  lf, lowlimit=Non
-000420b0: 652c 7570 6c69 6d69 743d 2d31 2c20 7573  e,uplimit=-1, us
-000420c0: 655f 6d65 6469 616e 3d46 616c 7365 2c20  e_median=False, 
-000420d0: 6473 3d4e 6f6e 652c 2063 6f72 7265 6374  ds=None, correct
-000420e0: 696f 6e3d 4e6f 6e65 293a 0d0a 0909 2727  ion=None):....''
-000420f0: 2754 6869 7320 6973 2074 6865 2062 6163  'This is the bac
-00042100: 6b67 726f 756e 6420 636f 7272 6563 7469  kground correcti
-00042110: 6f6e 2e20 496e 2067 656e 6572 616c 2069  on. In general i
-00042120: 7420 666f 7220 6561 6368 206d 6561 7375  t for each measu
-00042130: 7265 6420 0d0a 0909 7761 7665 6c65 6e67  red ....waveleng
-00042140: 7468 2061 7665 7261 6765 7320 7468 6520  th averages the 
-00042150: 7661 6c75 6573 2066 726f 6d20 276c 6f77  values from 'low
-00042160: 6c69 6d69 7427 2074 6f20 2775 706c 696d  limit' to 'uplim
-00042170: 6974 2720 616e 6420 0d0a 0909 7375 6274  it' and ....subt
-00042180: 7261 6374 7320 6974 2066 726f 6d20 7468  racts it from th
-00042190: 6520 6461 7461 2e20 4974 2072 756e 6420  e data. It rund 
-000421a0: 6f6e 2074 6865 206f 626a 6563 7420 2867  on the object (g
-000421b0: 6c6f 6261 6c29 206f 7220 6966 200d 0a09  lobal) or if ...
-000421c0: 0967 6976 656e 2061 2073 7065 6369 6669  .given a specifi
-000421d0: 6320 6473 206c 6f63 616c 2e20 0d0a 0909  c ds local. ....
-000421e0: 5468 6520 6c6f 7720 616e 6420 7570 6c69  The low and upli
-000421f0: 6d69 7420 6361 6e20 6265 2073 6574 2061  mit can be set a
-00042200: 6e79 7768 6572 6520 746f 2073 7562 7374  nywhere to subst
-00042210: 7261 6374 2061 6e79 2062 6163 6b67 726f  ract any backgro
-00042220: 756e 642e 0d0a 0909 4974 2069 7320 696d  und.....It is im
-00042230: 706f 7274 616e 7420 746f 206e 6f74 6520  portant to note 
-00042240: 7468 6174 206d 616e 7920 7072 6f62 6c65  that many proble
-00042250: 6d73 2064 7572 696e 6720 6d65 6173 7572  ms during measur
-00042260: 656d 656e 7473 206d 6967 6874 0d0a 0909  ements might....
-00042270: 6265 2076 6973 6962 6c65 2069 6e20 7468  be visible in th
-00042280: 6520 6461 7461 2062 6566 6f72 6520 7469  e data before ti
-00042290: 6d65 207a 6572 6f2e 2053 6f20 4920 7265  me zero. So I re
-000422a0: 636f 6d6d 656e 6420 746f 2066 6972 7374  commend to first
-000422b0: 0d0a 0909 706c 6f74 2077 6974 686f 7574  ....plot without
-000422c0: 2062 6163 6b67 726f 756e 6420 636f 7272   background corr
-000422d0: 6563 7469 6f6e 2061 6e64 206f 6e6c 7920  ection and only 
-000422e0: 6166 7465 7220 7468 6973 2069 6e73 7065  after this inspe
-000422f0: 6374 696f 6e20 0d0a 0909 6170 706c 7920  ction ....apply 
-00042300: 7468 6520 6261 636b 6772 6f75 6e64 2063  the background c
-00042310: 6f72 7265 6374 696f 6e2e 200d 0a09 0954  orrection. ....T
-00042320: 6865 2066 6974 2066 756e 6374 696f 6e20  he fit function 
-00042330: 6861 7320 6974 7320 6f77 6e20 7761 7920  has its own way 
-00042340: 746f 2063 616c 6375 6c63 6174 6520 616e  to calculcate an
-00042350: 6420 6170 706c 7920 6120 6261 636b 6772  d apply a backgr
-00042360: 6f75 6e64 200d 0a09 0954 6861 7420 636f  ound ....That co
-00042370: 756c 6420 6265 2075 7365 6420 696e 7374  uld be used inst
-00042380: 6561 6420 2862 7574 206d 616b 696e 6720  ead (but making 
-00042390: 7468 6520 6669 7420 6c65 7373 2073 7461  the fit less sta
-000423a0: 626c 6529 200d 0a09 090d 0a09 0950 6172  ble) ........Par
-000423b0: 616d 6574 6572 730d 0a09 092d 2d2d 2d2d  ameters....-----
-000423c0: 2d2d 2d2d 2d2d 2d0d 0a09 090d 0a09 096c  -------........l
-000423d0: 6f77 6c69 6d69 7420 3a20 4e6f 6e65 206f  owlimit : None o
-000423e0: 7220 666c 6f61 742c 206f 7074 696f 6e61  r float, optiona
-000423f0: 6c0d 0a09 0909 7468 6973 2069 7320 7468  l.....this is th
-00042400: 6520 6c6f 7765 7220 6c69 6d69 7420 6672  e lower limit fr
-00042410: 6f6d 2077 6869 6368 2074 6865 2061 7665  om which the ave
-00042420: 7261 6765 2028 6f72 206d 6564 6961 6e29  rage (or median)
-00042430: 2069 7320 7461 6b65 6e0d 0a09 0909 2844   is taken.....(D
-00042440: 6566 6175 6c74 2920 6973 204e 6f6e 652c  efault) is None,
-00042450: 2069 6e20 7768 6963 6820 6361 7365 2074   in which case t
-00042460: 6865 206c 6f77 6572 206c 696d 6974 206f  he lower limit o
-00042470: 6620 7468 6520 6461 7461 2069 7320 7573  f the data is us
-00042480: 6564 2e0d 0a09 090d 0a09 0975 706c 696d  ed.........uplim
-00042490: 6974 203a 204e 6f6e 6520 6f72 2066 6c6f  it : None or flo
-000424a0: 6174 2c20 6f70 7469 6f6e 616c 200d 0a09  at, optional ...
-000424b0: 0909 7468 6973 2069 7320 7468 6520 7570  ..this is the up
-000424c0: 7065 7220 6c69 6d69 7420 756e 7469 6c20  per limit until 
-000424d0: 7768 6963 6820 7468 6520 6176 6572 6167  which the averag
-000424e0: 6520 286f 7220 6d65 6469 616e 2920 6973  e (or median) is
-000424f0: 2074 616b 656e 0d0a 0909 0928 4465 6661   taken.....(Defa
-00042500: 756c 7429 2069 7320 2d31 2028 7573 7561  ult) is -1 (usua
-00042510: 6c6c 7920 7073 292c 2069 6e20 7768 6963  lly ps), in whic
-00042520: 6820 6361 7365 2074 6865 206c 6f77 6572  h case the lower
-00042530: 206c 696d 6974 206f 6620 7468 6520 6461   limit of the da
-00042540: 7461 2069 7320 7573 6564 2e0d 0a09 090d  ta is used......
-00042550: 0a09 0975 7365 5f6d 6564 6961 6e20 3a20  ...use_median : 
-00042560: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0d0a  bool, optional..
-00042570: 0909 0974 6865 204d 6564 6961 6e20 6973  ...the Median is
-00042580: 2061 206d 6f72 6520 6f75 746c 6965 7220   a more outlier 
-00042590: 7265 7369 7374 616e 7420 6d65 7472 6963  resistant metric
-000425a0: 2069 6e20 636f 6d70 6172 6973 696f 6e20   in comparision 
-000425b0: 746f 200d 0a09 0909 7468 6520 4d65 616e  to .....the Mean
-000425c0: 2028 4176 6572 6167 6529 2e20 486f 7765   (Average). Howe
-000425d0: 7665 7220 7468 6520 7661 6c75 6573 2061  ver the values a
-000425e0: 7265 206e 6f74 2071 7569 7465 2061 7320  re not quite as 
-000425f0: 636c 6f73 6520 0d0a 0909 0974 6f20 7468  close .....to th
-00042600: 6520 6469 7374 7269 6275 7469 6f6e 2063  e distribution c
-00042610: 656e 7465 7220 696e 2063 6173 6520 6f66  enter in case of
-00042620: 2076 6572 7920 6665 7720 7661 6c75 6573   very few values
-00042630: 2e20 4661 6c73 6520 0d0a 0909 0928 4465  . False .....(De
-00042640: 6661 756c 7429 206d 6561 6e73 2074 6865  fault) means the
-00042650: 204d 6561 6e20 6973 2075 7365 640d 0a09   Mean is used...
-00042660: 0909 0d0a 0909 6473 203a 204e 6f6e 6520  ......ds : None 
-00042670: 6f72 2044 6174 6146 7261 6d65 2c20 6f70  or DataFrame, op
-00042680: 7469 6f6e 616c 0d0a 0909 0969 6620 4e6f  tional.....if No
-00042690: 6e65 2028 4465 6661 756c 7429 2074 6865  ne (Default) the
-000426a0: 2069 6e74 6572 6e61 6c20 4461 7461 6672   internal Datafr
-000426b0: 616d 6520 7365 6c66 2e64 7320 6973 2075  ame self.ds is u
-000426c0: 7365 642c 200d 0a09 0909 6f74 6865 7277  sed, .....otherw
-000426d0: 6973 6520 7468 6520 7061 6e64 6173 2044  ise the pandas D
-000426e0: 6174 6146 7261 6d65 2064 7320 6973 2063  ataFrame ds is c
-000426f0: 6f72 7265 6374 6564 2061 6e64 2072 6574  orrected and ret
-00042700: 7572 6e65 640d 0a09 0909 0d0a 0909 636f  urned.........co
-00042710: 7272 6563 7469 6f6e 203a 204e 6f6e 6520  rrection : None 
-00042720: 6f72 2044 6174 6146 7261 6d65 2c20 6f70  or DataFrame, op
-00042730: 7469 6f6e 616c 0d0a 0909 0974 6869 7320  tional.....this 
-00042740: 6973 2074 6865 2063 6f72 7265 6374 696f  is the correctio
-00042750: 6e20 6170 706c 6965 642e 2049 7420 6d75  n applied. It mu
-00042760: 7374 2062 6520 6120 4461 7461 4672 616d  st be a DataFram
-00042770: 6520 7769 7468 200d 0a09 0909 7468 6520  e with .....the 
-00042780: 7361 6d65 206e 756d 6265 7273 206f 6620  same numbers of 
-00042790: 636f 6c75 6d6e 7320 2873 7065 6374 7261  columns (spectra
-000427a0: 6c20 706f 696e 7473 2920 6173 2074 6865  l points) as the
-000427b0: 2075 7365 6420 6473 0d0a 0909 0d0a 0909   used ds........
-000427c0: 4578 616d 706c 6573 0d0a 0909 2d2d 2d2d  Examples....----
-000427d0: 2d2d 2d2d 0d0a 0909 6966 2074 6865 206f  ----....if the o
-000427e0: 626a 6563 7420 7365 6c66 2068 6173 2074  bject self has t
-000427f0: 6865 206e 616d 6520 2274 6122 0d0a 0909  he name "ta"....
-00042800: 0d0a 0909 7479 7069 6361 6c20 7573 6561  ....typical usea
-00042810: 6765 3a20 2009 090d 0a09 0909 090d 0a09  ge:  ...........
-00042820: 093e 3e3e 2074 612e 4261 636b 6772 6f75  .>>> ta.Backgrou
-00042830: 6e64 2829 0d0a 0909 0d0a 0909 7370 6563  nd()........spec
-00042840: 6966 7920 696e 6567 7261 7465 6420 6172  ify inegrated ar
-00042850: 6520 746f 202d 2069 6e66 2028 4465 6661  e to - inf (Defa
-00042860: 756c 7429 2075 7020 746f 202d 302e 3570  ult) up to -0.5p
-00042870: 7320 616e 6420 7573 6520 7468 6520 4d65  s and use the Me
-00042880: 6469 616e 2066 6f72 2063 6f6d 7075 7461  dian for computa
-00042890: 7469 6f6e 090d 0a09 090d 0a09 093e 3e3e  tion.........>>>
-000428a0: 2074 612e 4261 636b 6772 6f75 6e64 2875   ta.Background(u
-000428b0: 706c 696d 6974 203d 202d 302e 352c 2075  plimit = -0.5, u
-000428c0: 7365 5f6d 6564 6961 6e20 3d20 5472 7565  se_median = True
-000428d0: 290d 0a09 090d 0a09 0927 2727 0d0a 0909  )........'''....
-000428e0: 6966 2064 7320 6973 204e 6f6e 653a 0d0a  if ds is None:..
-000428f0: 0909 0972 756e 5f67 6c6f 6261 6c3d 5472  ...run_global=Tr
-00042900: 7565 0d0a 0909 0964 733d 7365 6c66 2e64  ue.....ds=self.d
-00042910: 730d 0a09 0965 6c73 653a 0d0a 0909 0972  s....else:.....r
-00042920: 756e 5f67 6c6f 6261 6c3d 4661 6c73 650d  un_global=False.
-00042930: 0a09 0909 6966 2063 6f72 7265 6374 696f  ....if correctio
-00042940: 6e20 6973 204e 6f6e 653a 7261 6973 6520  n is None:raise 
-00042950: 5661 6c75 6545 7272 6f72 2827 5765 206d  ValueError('We m
-00042960: 7573 7420 6861 7665 2063 6f72 7265 6374  ust have correct
-00042970: 696f 6e20 6769 7665 6e2c 2074 6f20 736c  ion given, to sl
-00042980: 6f77 206f 7468 6572 6877 6973 6527 290d  ow otherhwise').
-00042990: 0a09 0969 6620 286c 6f77 6c69 6d69 7420  ...if (lowlimit 
-000429a0: 6973 204e 6f6e 6529 2061 6e64 2028 636f  is None) and (co
-000429b0: 7272 6563 7469 6f6e 2069 7320 4e6f 6e65  rrection is None
-000429c0: 293a 0d0a 0909 0969 6620 7573 655f 6d65  ):.....if use_me
-000429d0: 6469 616e 3a0d 0a09 0909 0963 6f72 7265  dian:......corre
-000429e0: 6374 696f 6e3d 6473 5b3a 7570 6c69 6d69  ction=ds[:uplimi
-000429f0: 745d 2e6d 6564 6961 6e28 6178 6973 3d30  t].median(axis=0
-00042a00: 290d 0a09 0909 656c 7365 3a0d 0a09 0909  ).....else:.....
-00042a10: 0963 6f72 7265 6374 696f 6e3d 6473 5b3a  .correction=ds[:
-00042a20: 7570 6c69 6d69 745d 2e6d 6561 6e28 6178  uplimit].mean(ax
-00042a30: 6973 3d30 290d 0a09 0965 6c69 6620 286c  is=0)....elif (l
-00042a40: 6f77 6c69 6d69 7420 6973 206e 6f74 204e  owlimit is not N
-00042a50: 6f6e 6529 2061 6e64 2028 636f 7272 6563  one) and (correc
-00042a60: 7469 6f6e 2069 7320 4e6f 6e65 293a 0d0a  tion is None):..
-00042a70: 0909 0969 6620 7573 655f 6d65 6469 616e  ...if use_median
-00042a80: 3a0d 0a09 0909 0963 6f72 7265 6374 696f  :......correctio
-00042a90: 6e3d 6473 5b6c 6f77 6c69 6d69 743a 7570  n=ds[lowlimit:up
-00042aa0: 6c69 6d69 745d 2e6d 6564 6961 6e28 6178  limit].median(ax
-00042ab0: 6973 3d30 290d 0a09 0909 656c 7365 3a0d  is=0).....else:.
-00042ac0: 0a09 0909 0963 6f72 7265 6374 696f 6e3d  .....correction=
-00042ad0: 6473 5b6c 6f77 6c69 6d69 743a 7570 6c69  ds[lowlimit:upli
-00042ae0: 6d69 745d 2e6d 6561 6e28 6178 6973 3d30  mit].mean(axis=0
-00042af0: 290d 0a09 0969 6620 7275 6e5f 676c 6f62  )....if run_glob
-00042b00: 616c 3a0d 0a09 0909 7365 6c66 2e64 733d  al:.....self.ds=
-00042b10: 6473 2d63 6f72 7265 6374 696f 6e0d 0a09  ds-correction...
-00042b20: 0909 7365 6c66 2e62 6163 6b67 726f 756e  ..self.backgroun
-00042b30: 645f 7061 723d 5b6c 6f77 6c69 6d69 742c  d_par=[lowlimit,
-00042b40: 7570 6c69 6d69 742c 7573 655f 6d65 6469  uplimit,use_medi
-00042b50: 616e 2c63 6f72 7265 6374 696f 6e5d 0d0a  an,correction]..
-00042b60: 0909 656c 7365 3a0d 0a09 0909 7265 7475  ..else:.....retu
-00042b70: 726e 2064 732d 636f 7272 6563 7469 6f6e  rn ds-correction
-00042b80: 0d0a 0d0a 0d0a 0964 6566 204d 616e 5f43  .......def Man_C
-00042b90: 6869 7270 2873 656c 662c 7368 6f77 6e5f  hirp(self,shown_
-00042ba0: 7769 6e64 6f77 3d5b 2d31 2c31 5d2c 7061  window=[-1,1],pa
-00042bb0: 7468 3d4e 6f6e 652c 6d61 785f 706f 696e  th=None,max_poin
-00042bc0: 7473 3d34 302c 636d 6170 3d63 6d2e 7072  ts=40,cmap=cm.pr
-00042bd0: 6973 6d2c 6473 3d4e 6f6e 6529 3a0d 0a09  ism,ds=None):...
-00042be0: 0927 2727 5472 6967 6765 7269 6e67 206f  .'''Triggering o
-00042bf0: 6620 4d61 6e75 656c 2046 6978 5f43 6869  f Manuel Fix_Chi
-00042c00: 7270 2e20 7573 7561 6c6c 7920 7573 6564  rp. usually used
-00042c10: 2077 6865 6e20 436f 725f 4368 6972 7020   when Cor_Chirp 
-00042c20: 6861 7320 7275 6e20 616c 7265 6164 792e  has run already.
-00042c30: 200d 0a09 0941 6c74 6572 6e61 7469 7665   ....Alternative
-00042c40: 6c79 2064 656c 6574 6520 7468 6520 6368  ly delete the ch
-00042c50: 6972 7020 6669 6c65 2e20 5468 6973 2046  irp file. This F
-00042c60: 756e 6374 696f 6e20 6f70 656e 7320 6120  unction opens a 
-00042c70: 706c 6f74 2069 6e20 7768 6963 6820 7468  plot in which th
-00042c80: 6520 7573 6572 206d 616e 7561 6c6c 7920  e user manually 
-00042c90: 7365 6c65 6374 7320 6120 6e75 6d62 6572  selects a number
-00042ca0: 206f 6620 706f 696e 7473 0d0a 0909 5468   of points....Th
-00042cb0: 6573 6520 706f 696e 7473 2077 696c 6c20  ese points will 
-00042cc0: 7468 656e 2062 6520 696e 7465 7270 6f6c  then be interpol
-00042cd0: 6174 6564 2077 6974 6820 6120 3474 6820  ated with a 4th 
-00042ce0: 6f72 6465 7220 706f 6c79 6e6f 6d69 616c  order polynomial
-00042cf0: 0d0a 0909 5468 6520 7573 6572 2063 616e  ....The user can
-00042d00: 2074 6865 6e20 7365 6c65 6374 2061 206e   then select a n
-00042d10: 6577 2074 3d30 2070 6f69 6e74 2e20 0d0a  ew t=0 point. ..
-00042d20: 0909 5468 6520 6669 7273 7420 6f70 7469  ..The first opti
-00042d30: 6f6e 2061 6c6c 6f77 7320 746f 2066 696e  on allows to fin
-00042d40: 6520 7365 6c65 6374 2061 6e20 696e 7465  e select an inte
-00042d50: 6e73 6974 7920 7365 7474 696e 6720 666f  nsity setting fo
-00042d60: 7220 7468 6973 2063 6869 7270 2063 6f72  r this chirp cor
-00042d70: 7265 6374 696f 6e2e 0d0a 0909 486f 7765  rection.....Howe
-00042d80: 7665 7220 736f 6d65 7469 6d65 7320 7370  ver sometimes sp
-00042d90: 696b 6573 2061 7265 206d 616b 696e 6720  ikes are making 
-00042da0: 7468 6973 2074 6869 6e67 7320 6469 6666  this things diff
-00042db0: 6963 756c 742e 2049 6e20 7468 6973 2063  icult. In this c
-00042dc0: 6173 6520 7365 7420 6120 6775 6573 7365  ase set a guesse
-00042dd0: 6420 696e 7465 6e73 6974 7920 7769 7468  d intensity with
-00042de0: 2073 656c 662e 696e 7465 6e73 6974 795f   self.intensity_
-00042df0: 7261 6e67 653d 3165 2d33 0d0a 0909 0d0a  range=1e-3......
-00042e00: 0909 5061 7261 6d65 7465 7273 0d0a 0909  ..Parameters....
-00042e10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a09  -------------...
-00042e20: 0920 2020 0d0a 0909 7061 7468 203a 2073  .   ....path : s
-00042e30: 7472 206f 7220 7061 7468 206f 626a 6563  tr or path objec
-00042e40: 7420 286f 7074 696f 6e61 6c29 0d0a 0909  t (optional)....
-00042e50: 0969 6620 7061 7468 2069 7320 6120 7374  .if path is a st
-00042e60: 7269 6e67 2077 6974 686f 7574 2074 6865  ring without the
-00042e70: 206f 7065 7261 7469 6f6e 2073 7973 7465   operation syste
-00042e80: 6d20 6465 7065 6e64 656e 7420 7365 7061  m dependent sepa
-00042e90: 7261 746f 722c 2069 7420 6973 2074 7265  rator, it is tre
-00042ea0: 6174 6564 2061 7320 6120 7265 6c61 7469  ated as a relati
-00042eb0: 7665 2070 6174 682c 200d 0a09 0909 652e  ve path, .....e.
-00042ec0: 672e 2064 6174 6120 7769 6c6c 206c 6f6f  g. data will loo
-00042ed0: 6b20 6672 6f6d 2074 6865 2077 6f72 6b69  k from the worki
-00042ee0: 6e67 2064 6972 6563 746f 7279 2069 6e20  ng directory in 
-00042ef0: 7468 6520 7375 6220 6469 7265 6374 6f72  the sub director
-00042f00: 2064 6174 612e 204f 7468 6572 7769 7365   data. Otherwise
-00042f10: 2074 6869 7320 6861 7320 746f 2062 6520   this has to be 
-00042f20: 6120 0d0a 0909 0966 756c 6c20 7061 7468  a .....full path
-00042f30: 2069 6e20 6569 7468 6572 2073 7472 6f6e   in either stron
-00042f40: 6720 6f72 2070 6174 6820 6f62 6a65 6374  g or path object
-00042f50: 2066 6f72 6d2e 0d0a 0909 0d0a 0909 7368   form.........sh
-00042f60: 6f77 6e5f 7769 6e64 6f77 203a 206c 6973  own_window : lis
-00042f70: 7420 2877 6974 6820 7477 6f20 666c 6f61  t (with two floa
-00042f80: 7473 292c 206f 7074 696f 6e61 6c0d 0a09  ts), optional...
-00042f90: 0909 4465 6669 6e65 7320 7468 6520 7769  ..Defines the wi
-00042fa0: 6e64 6f77 2074 6861 7420 6973 2073 686f  ndow that is sho
-00042fb0: 776e 2064 7572 696e 6720 6368 6972 7020  wn during chirp 
-00042fc0: 636f 7272 6563 7469 6f6e 2e20 4966 2074  correction. If t
-00042fd0: 6865 2074 3d30 2069 7320 6e6f 7420 7669  he t=0 is not vi
-00042fe0: 7369 626c 652c 2061 646a 7573 7420 7468  sible, adjust th
-00042ff0: 6973 2070 6172 616d 6574 6572 0d0a 0909  is parameter....
-00043000: 0974 6f20 7375 6974 2074 6865 2065 7870  .to suit the exp
-00043010: 6572 696d 656e 742e 2049 6620 7072 6f62  eriment. If prob
-00043020: 6c65 6d73 2061 7269 7365 2c20 4920 7265  lems arise, I re
-00043030: 636f 6d6d 656e 7420 746f 2075 7365 2050  comment to use P
-00043040: 6c6f 745f 5261 7720 746f 2063 6865 636b  lot_Raw to check
-00043050: 2077 6865 7265 2074 3d30 2069 7320 6c6f   where t=0 is lo
-00043060: 6361 7465 640d 0a0d 0a09 096d 6178 5f70  cated......max_p
-00043070: 6f69 6e74 7320 3a20 696e 742c 206f 7074  oints : int, opt
-00043080: 696f 6e61 6c0d 0a09 0909 4465 6661 756c  ional.....Defaul
-00043090: 7420 3d20 3430 206d 6178 206e 756d 6265  t = 40 max numbe
-000430a0: 7273 206f 6620 706f 696e 7473 2074 6f20  rs of points to 
-000430b0: 7573 6520 696e 2047 7569 2073 656c 6563  use in Gui selec
-000430c0: 7469 6f6e 2e20 5573 6566 756c 206f 7074  tion. Useful opt
-000430d0: 696f 6e20 696e 2063 6173 6520 6e6f 206d  ion in case no m
-000430e0: 6964 646c 6520 6d6f 7573 6520 6275 7474  iddle mouse butt
-000430f0: 6f6e 0d0a 0909 0969 7320 6176 6169 6c61  on.....is availa
-00043100: 626c 652e 2028 652e 672e 2074 6f75 6368  ble. (e.g. touch
-00043110: 7061 6429 0d0a 0909 0d0a 0909 636d 6170  pad)........cmap
-00043120: 203a 206d 6174 706c 6f74 6c69 6220 636f   : matplotlib co
-00043130: 6c6f 7572 6d61 702c 206f 7074 696f 6e61  lourmap, optiona
-00043140: 6c0d 0a09 0909 436f 6c6f 7572 6d61 7020  l.....Colourmap 
-00043150: 746f 2062 6520 7573 6564 2066 6f72 2074  to be used for t
-00043160: 6865 2063 6869 7270 2063 6f72 7265 6374  he chirp correct
-00043170: 696f 6e2e 2057 6869 6c65 2074 6865 7265  ion. While there
-00043180: 2069 7320 6120 6c61 7267 6520 7365 6c65   is a large sele
-00043190: 6374 696f 6e20 6865 7265 2049 2072 6563  ction here I rec
-000431a0: 6f6d 6d65 6e64 2074 6f20 6368 6f6f 7365  ommend to choose
-000431b0: 0d0a 0909 0961 2064 6966 6665 7265 6e74  .....a different
-000431c0: 206d 6170 2074 6861 6e20 6973 2075 7365   map than is use
-000431d0: 6420 666f 7220 7468 6520 6e6f 726d 616c  d for the normal
-000431e0: 2032 6420 706c 6f74 7469 6e67 2e5c 6e0d   2d plotting.\n.
-000431f0: 0a09 0909 636d 2e70 7269 736d 2028 4465  ....cm.prism (De
-00043200: 6661 756c 7429 2068 6173 2070 726f 6f66  fault) has proof
-00043210: 656e 2074 6f20 6265 2076 6572 7920 7573  en to be very us
-00043220: 6566 756c 6c0d 0a09 090d 0a09 0964 733a  efull........ds:
-00043230: 2070 616e 6461 7320 6461 7461 6672 616d   pandas datafram
-00043240: 652c 6f70 7469 6f6e 616c 0d0a 0909 0974  e,optional.....t
-00043250: 6869 7320 616c 6c6f 7773 2074 6f20 6861  his allows to ha
-00043260: 6e64 2069 6e20 616e 2065 7874 6572 6e61  nd in an externa
-00043270: 6c20 6473 2c20 6966 2074 6869 7320 6973  l ds, if this is
-00043280: 2064 6f6e 6520 7468 656e 2074 6865 206f   done then the o
-00043290: 6e20 6469 736b 2073 6176 6564 2066 6974  n disk saved fit
-000432a0: 636f 6566 6620 6172 6520 7468 6520 6e65  coeff are the ne
-000432b0: 7720 6f6e 6573 206f 6e6c 7920 616e 6420  w ones only and 
-000432c0: 7468 6520 0d0a 0909 0966 756e 6374 696f  the .....functio
-000432d0: 6e20 7265 7475 726e 7320 7468 6520 6e65  n returns the ne
-000432e0: 7720 6669 7463 6f65 6666 2061 6e64 2074  w fitcoeff and t
-000432f0: 6865 2063 6f6d 6269 6e65 6420 6669 7463  he combined fitc
-00043300: 6f65 6666 2c20 7365 6c66 2061 6c73 6f20  oeff, self also 
-00043310: 6861 7320 6120 6e65 7720 7661 7269 6162  has a new variab
-00043320: 6c65 2063 616c 6c65 6420 7365 6c66 2e63  le called self.c
-00043330: 6f6d 6269 6e65 645f 6669 7463 6f65 6666  ombined_fitcoeff
-00043340: 0d0a 0909 0974 6865 206f 7269 6769 6e61  .....the origina
-00043350: 6c20 6669 6c65 206f 6e20 6469 7320 616e  l file on dis an
-00043360: 6420 7365 6c66 2e66 6974 636f 6566 6620  d self.fitcoeff 
-00043370: 6172 6520 4e4f 5420 6f76 6572 7772 6974  are NOT overwrit
-00043380: 7465 6e20 2861 7265 2074 6865 206f 6c64  ten (are the old
-00043390: 206f 6e65 7329 0d0a 0909 0974 6865 2073   ones).....the s
-000433a0: 656c 662e 6473 2069 7320 7468 6520 4e45  elf.ds is the NE
-000433b0: 5720 6f6e 6520 2877 6974 6820 7468 6520  W one (with the 
-000433c0: 636f 7272 6563 7469 6f6e 2061 7070 6c69  correction appli
-000433d0: 6564 290d 0a09 0909 746f 2072 6576 6572  ed).....to rever
-000433e0: 7365 2073 696d 706c 7920 7275 6e20 436f  se simply run Co
-000433f0: 725f 4368 6972 7028 290d 0a09 0909 746f  r_Chirp().....to
-00043400: 2070 6572 6d61 6e65 6e74 6c79 2061 7070   permanently app
-00043410: 6c79 2063 6861 6e67 6520 7365 6c66 2e66  ly change self.f
-00043420: 6974 636f 6566 6620 7769 7468 2073 656c  itcoeff with sel
-00043430: 662e 636f 6d62 696e 6564 5f66 6974 636f  f.combined_fitco
-00043440: 6566 6620 616e 6420 7265 6e61 6d65 2074  eff and rename t
-00043450: 6865 2066 696c 6520 7769 7468 2027 6669  he file with 'fi
-00043460: 6c65 6e61 6d65 5f73 6563 6f6e 645f 6368  lename_second_ch
-00043470: 6972 7027 2074 6f20 6669 6c65 6e61 6d65  irp' to filename
-00043480: 5f63 6869 7270 0d0a 0909 2727 270d 0a09  _chirp....'''...
-00043490: 0969 6620 6473 2069 7320 4e6f 6e65 3a0d  .if ds is None:.
-000434a0: 0a09 0909 6473 3d73 656c 662e 6473 5f6f  ....ds=self.ds_o
-000434b0: 7269 0d0a 0909 096f 7269 6769 6e61 6c3d  ri.....original=
-000434c0: 5472 7565 0d0a 0909 656c 7365 3a0d 0a09  True....else:...
-000434d0: 0909 6f72 6967 696e 616c 3d46 616c 7365  ..original=False
-000434e0: 0d0a 0909 6966 206f 7269 6769 6e61 6c3a  ....if original:
-000434f0: 0d0a 0909 0974 656d 705f 6473 203d 2046  .....temp_ds = F
-00043500: 6978 5f43 6869 7270 2864 732c 2063 6d61  ix_Chirp(ds, cma
-00043510: 7020 3d20 636d 6170 2c20 7361 7665 5f66  p = cmap, save_f
-00043520: 696c 6520 3d20 4e6f 6e65 2c20 696e 7465  ile = None, inte
-00043530: 6e73 6974 795f 7261 6e67 6520 3d20 7365  nsity_range = se
-00043540: 6c66 2e69 6e74 656e 7369 7479 5f72 616e  lf.intensity_ran
-00043550: 6765 2c20 0d0a 0909 0909 0909 0909 7761  ge, ..........wa
-00043560: 7665 5f6e 6d5f 6269 6e20 3d20 3130 2c20  ve_nm_bin = 10, 
-00043570: 7368 6f77 6e5f 7769 6e64 6f77 203d 2073  shown_window = s
-00043580: 686f 776e 5f77 696e 646f 772c 2066 696c  hown_window, fil
-00043590: 656e 616d 6520 3d20 7365 6c66 2e66 696c  ename = self.fil
-000435a0: 656e 616d 652c 200d 0a09 0909 0909 0909  ename, .........
-000435b0: 0973 6361 7474 6572 6375 7420 3d20 7365  .scattercut = se
-000435c0: 6c66 2e73 6361 7474 6572 6375 742c 2062  lf.scattercut, b
-000435d0: 6f72 6465 7263 7574 203d 2073 656c 662e  ordercut = self.
-000435e0: 626f 7264 6572 6375 742c 200d 0a09 0909  bordercut, .....
-000435f0: 0909 0909 0970 6174 6820 3d20 6368 6563  .....path = chec
-00043600: 6b5f 666f 6c64 6572 2870 6174 6820 3d20  k_folder(path = 
-00043610: 7061 7468 2c20 6375 7272 656e 745f 7061  path, current_pa
-00043620: 7468 203d 2073 656c 662e 7061 7468 292c  th = self.path),
-00043630: 206d 6178 5f70 6f69 6e74 7320 3d20 6d61   max_points = ma
-00043640: 785f 706f 696e 7473 290d 0a09 0965 6c73  x_points)....els
-00043650: 653a 0d0a 0909 0974 656d 705f 6473 203d  e:.....temp_ds =
-00043660: 2046 6978 5f43 6869 7270 2864 732c 2063   Fix_Chirp(ds, c
-00043670: 6d61 7020 3d20 636d 6170 2c20 7361 7665  map = cmap, save
-00043680: 5f66 696c 6520 3d20 4e6f 6e65 2c20 696e  _file = None, in
-00043690: 7465 6e73 6974 795f 7261 6e67 6520 3d20  tensity_range = 
-000436a0: 7365 6c66 2e69 6e74 656e 7369 7479 5f72  self.intensity_r
-000436b0: 616e 6765 2c20 0d0a 0909 0909 0909 0909  ange, ..........
-000436c0: 7761 7665 5f6e 6d5f 6269 6e20 3d20 3130  wave_nm_bin = 10
-000436d0: 2c20 7368 6f77 6e5f 7769 6e64 6f77 203d  , shown_window =
-000436e0: 2073 686f 776e 5f77 696e 646f 772c 2066   shown_window, f
-000436f0: 696c 656e 616d 6520 3d20 7365 6c66 2e66  ilename = self.f
-00043700: 696c 656e 616d 652b 275f 7365 636f 6e64  ilename+'_second
-00043710: 5f63 6869 7270 272c 200d 0a09 0909 0909  _chirp', .......
-00043720: 0909 0973 6361 7474 6572 6375 7420 3d20  ...scattercut = 
-00043730: 7365 6c66 2e73 6361 7474 6572 6375 742c  self.scattercut,
-00043740: 2062 6f72 6465 7263 7574 203d 2073 656c   bordercut = sel
-00043750: 662e 626f 7264 6572 6375 742c 200d 0a09  f.bordercut, ...
-00043760: 0909 0909 0909 0970 6174 6820 3d20 6368  .......path = ch
-00043770: 6563 6b5f 666f 6c64 6572 2870 6174 6820  eck_folder(path 
-00043780: 3d20 7061 7468 2c20 6375 7272 656e 745f  = path, current_
-00043790: 7061 7468 203d 2073 656c 662e 7061 7468  path = self.path
-000437a0: 292c 206d 6178 5f70 6f69 6e74 7320 3d20  ), max_points = 
-000437b0: 6d61 785f 706f 696e 7473 290d 0a09 0969  max_points)....i
-000437c0: 6620 6973 696e 7374 616e 6365 2874 656d  f isinstance(tem
-000437d0: 705f 6473 2c70 616e 6461 732e 4461 7461  p_ds,pandas.Data
-000437e0: 4672 616d 6529 3a0d 0a09 0909 7365 6c66  Frame):.....self
-000437f0: 2e64 733d 7465 6d70 5f64 730d 0a09 0909  .ds=temp_ds.....
-00043800: 7365 6c66 2e63 6869 7270 5f66 696c 653d  self.chirp_file=
-00043810: 7365 6c66 2e66 696c 656e 616d 652e 7370  self.filename.sp
-00043820: 6c69 7428 272e 2729 5b30 5d20 2b20 275f  lit('.')[0] + '_
-00043830: 6368 6972 702e 6461 7427 0d0a 0909 0969  chirp.dat'.....i
-00043840: 6620 6f72 6967 696e 616c 3a23 7765 2068  f original:#we h
-00043850: 6176 6520 7275 6e20 6672 6f6d 2073 6372  ave run from scr
-00043860: 6174 6368 0d0a 0909 0909 7365 6c66 2e43  atch......self.C
-00043870: 6f72 5f43 6869 7270 2870 6174 683d 7061  or_Chirp(path=pa
-00043880: 7468 290d 0a09 0909 656c 7365 3a0d 0a09  th).....else:...
-00043890: 0909 0970 7269 6e74 2827 796f 7520 7072  ...print('you pr
-000438a0: 6f76 6964 6564 2061 2073 6570 6172 6174  ovided a separat
-000438b0: 6520 6473 2066 696c 652e 2072 6574 7572  e ds file. retur
-000438c0: 6e65 6420 6172 6520 7468 6520 6e65 7720  ned are the new 
-000438d0: 6669 7463 6f65 6666 2061 6e64 2074 6865  fitcoeff and the
-000438e0: 2063 6f6d 6269 6e65 6420 6669 7463 6f65   combined fitcoe
-000438f0: 6666 2c20 7461 2061 6c73 6f20 6861 7320  ff, ta also has 
-00043900: 6120 6e65 7720 7661 7269 6162 6c65 2063  a new variable c
-00043910: 616c 6c65 6420 7461 2e63 6f6d 6269 6e65  alled ta.combine
-00043920: 645f 6669 7463 6f65 6666 2729 0d0a 0909  d_fitcoeff')....
-00043930: 0909 7361 7665 5f66 696c 653d 6368 6563  ..save_file=chec
-00043940: 6b5f 666f 6c64 6572 2870 6174 683d 7061  k_folder(path=pa
-00043950: 7468 2c63 7572 7265 6e74 5f70 6174 6820  th,current_path 
-00043960: 3d20 7365 6c66 2e70 6174 682c 2066 696c  = self.path, fil
-00043970: 656e 616d 653d 7365 6c66 2e66 696c 656e  ename=self.filen
-00043980: 616d 652b 275f 7365 636f 6e64 5f63 6869  ame+'_second_chi
-00043990: 7270 2729 0d0a 0909 0909 7769 7468 206f  rp')......with o
-000439a0: 7065 6e28 7361 7665 5f66 696c 652c 2772  pen(save_file,'r
-000439b0: 2729 2061 7320 663a 0d0a 0909 0909 096e  ') as f:.......n
-000439c0: 6577 5f66 6974 636f 6566 663d 662e 7265  ew_fitcoeff=f.re
-000439d0: 6164 6c69 6e65 2829 0d0a 0909 0909 6e65  adline()......ne
-000439e0: 775f 6669 7463 6f65 6666 3d6e 702e 6172  w_fitcoeff=np.ar
-000439f0: 7261 7928 6e65 775f 6669 7463 6f65 6666  ray(new_fitcoeff
-00043a00: 2e73 706c 6974 2827 2c27 292c 6474 7970  .split(','),dtyp
-00043a10: 653d 2766 6c6f 6174 2729 0d0a 0909 0909  e='float')......
-00043a20: 7365 6c66 2e63 6f6d 6269 6e65 645f 6669  self.combined_fi
-00043a30: 7463 6f65 6666 3d73 656c 662e 6669 7463  tcoeff=self.fitc
-00043a40: 6f65 6666 2b6e 6577 5f66 6974 636f 6566  oeff+new_fitcoef
-00043a50: 660d 0a09 0909 0972 6574 7572 6e20 6e65  f......return ne
-00043a60: 775f 6669 7463 6f65 6666 2c73 656c 662e  w_fitcoeff,self.
-00043a70: 636f 6d62 696e 6564 5f66 6974 636f 6566  combined_fitcoef
-00043a80: 660d 0a09 0965 6c73 653a 0d0a 0909 0972  f....else:.....r
-00043a90: 6169 7365 2057 6172 6e69 6e67 2827 4d61  aise Warning('Ma
-00043aa0: 6e20 4368 6972 7020 696e 7465 7272 7570  n Chirp interrup
-00043ab0: 7465 6427 290d 0a0d 0a0d 0a09 6465 6620  ted').......def 
-00043ac0: 436f 725f 4368 6972 7028 7365 6c66 2c20  Cor_Chirp(self, 
-00043ad0: 6368 6972 705f 6669 6c65 203d 204e 6f6e  chirp_file = Non
-00043ae0: 652c 2070 6174 6820 3d20 4e6f 6e65 2c20  e, path = None, 
-00043af0: 7368 6f77 6e5f 7769 6e64 6f77 203d 205b  shown_window = [
-00043b00: 2d31 2c20 315d 2c20 6669 7463 6f65 6666  -1, 1], fitcoeff
-00043b10: 203d 204e 6f6e 652c 206d 6178 5f70 6f69   = None, max_poi
-00043b20: 6e74 7320 3d20 3430 2c20 636d 6170 203d  nts = 40, cmap =
-00043b30: 2063 6d2e 7072 6973 6d29 3a0d 0a09 0927   cm.prism):....'
-00043b40: 2727 2a43 6f72 5f43 6869 7270 2a20 6973  ''*Cor_Chirp* is
-00043b50: 2061 2070 6f77 6572 6675 6c20 4675 6e63   a powerful Func
-00043b60: 7469 6f6e 2074 6f20 636f 7272 6563 7420  tion to correct 
-00043b70: 666f 7220 6120 6469 6666 6572 656e 7420  for a different 
-00043b80: 6172 7269 7661 6c20 7469 6d65 7320 6f66  arrival times of
-00043b90: 200d 0a09 0964 6966 6665 7265 6e74 2077   ....different w
-00043ba0: 6176 656c 656e 6774 6820 2873 6f6d 6574  avelength (somet
-00043bb0: 696d 6573 2063 616c 6c20 6368 6972 7029  imes call chirp)
-00043bc0: 2e20 0d0a 0909 496e 2067 656e 6572 616c  . ....In general
-00043bd0: 2069 6620 6120 6669 6c65 2069 7320 6f70   if a file is op
-00043be0: 656e 6564 2066 6f72 2074 6865 2066 6972  ened for the fir
-00043bf0: 7374 2074 696d 6520 7468 6973 2066 756e  st time this fun
-00043c00: 6374 696f 6e20 6973 206f 7065 6e69 6e67  ction is opening
-00043c10: 200d 0a09 0961 2070 6c6f 7420 616e 6420   ....a plot and 
-00043c20: 616c 6c6f 7773 2074 6865 2075 7365 7220  allows the user 
-00043c30: 746f 2073 656c 6563 7420 6120 6e75 6d62  to select a numb
-00043c40: 6572 206f 6620 706f 696e 7473 2c20 7768  er of points, wh
-00043c50: 6963 6820 6172 6520 7468 656e 200d 0a09  ich are then ...
-00043c60: 0961 7070 726f 7869 6d61 7465 6420 7769  .approximated wi
-00043c70: 7468 2061 2034 7468 206f 7264 6572 2070  th a 4th order p
-00043c80: 6f6c 796e 6f6d 6961 6c20 616e 6420 6669  olynomial and fi
-00043c90: 6e61 6c6c 7920 746f 2073 656c 6563 7420  nally to select 
-00043ca0: 6120 706f 696e 7420 0d0a 0909 7468 6174  a point ....that
-00043cb0: 2069 7320 6465 636c 6172 6564 2061 7320   is declared as 
-00043cc0: 7469 6d65 207a 6572 6f2e 2054 6865 206f  time zero. The o
-00043cd0: 6273 6572 7665 6420 7769 6e64 6f77 2061  bserved window a
-00043ce0: 7320 7765 6c6c 2061 7320 7468 6520 696e  s well as the in
-00043cf0: 7465 6e73 6974 6965 7320 0d0a 0909 616e  tensities ....an
-00043d00: 6420 7468 6520 636f 6c6f 7572 206d 6170  d the colour map
-00043d10: 2063 616e 2062 6520 6368 6f73 656e 2074   can be chosen t
-00043d20: 6f20 656e 6162 6c65 2061 2067 6f6f 6420  o enable a good 
-00043d30: 636f 7272 6563 7469 6f6e 2e20 4865 7265  correction. Here
-00043d40: 2061 2066 6173 7420 0d0a 0909 6974 6572   a fast ....iter
-00043d50: 6174 696e 6720 636f 6c6f 7572 2073 6368  ating colour sch
-00043d60: 656d 6520 7375 6368 2061 7320 2270 7269  eme such as "pri
-00043d70: 736d 2220 6973 206f 6674 656e 2061 2067  sm" is often a g
-00043d80: 6f6f 6420 6368 6f69 6365 2e20 496e 2061  ood choice. In a
-00043d90: 6c6c 206f 6620 7468 6520 0d0a 0909 7365  ll of the ....se
-00043da0: 6c65 6374 696f 6e73 2061 206c 6566 7420  lections a left 
-00043db0: 636c 6963 6b20 7365 6c65 6374 732c 2061  click selects, a
-00043dc0: 2072 6967 6874 2063 6c69 636b 2072 656d   right click rem
-00043dd0: 6f76 6573 2074 6865 206c 6173 7420 706f  oves the last po
-00043de0: 696e 7420 616e 6420 0d0a 0909 6120 6d69  int and ....a mi
-00043df0: 6464 6c65 2063 6c69 636b 2028 736f 6d65  ddle click (some
-00043e00: 7469 6d65 2061 7070 7265 7669 6174 6564  time appreviated
-00043e10: 2062 7920 636c 6963 6b69 6e67 206c 6566   by clicking lef
-00043e20: 7420 616e 6420 7269 6768 7420 746f 6765  t and right toge
-00043e30: 7468 6572 2920 0d0a 0909 6669 6e69 7368  ther) ....finish
-00043e40: 6573 2074 6865 2073 656c 6563 7469 6f6e  es the selection
-00043e50: 2e20 4966 206e 6f20 6d69 6464 6c65 2063  . If no middle c
-00043e60: 6c69 636b 2065 7869 7374 732c 2074 6865  lick exists, the
-00043e70: 2070 726f 6365 7373 0d0a 0909 6175 746f   process....auto
-00043e80: 6d61 7469 6361 6c6c 7920 656e 6473 2061  matically ends a
-00043e90: 6674 6572 206d 6178 5f70 6f69 6e74 7320  fter max_points 
-00043ea0: 2834 3020 7072 6573 6574 292e 0d0a 0909  (40 preset).....
-00043eb0: 0d0a 0909 5468 6520 6669 7273 7420 6f70  ....The first op
-00043ec0: 7469 6f6e 2061 6c6c 6f77 7320 746f 2066  tion allows to f
-00043ed0: 696e 6520 7365 6c65 6374 2061 6e20 696e  ine select an in
-00043ee0: 7465 6e73 6974 7920 7365 7474 696e 6720  tensity setting 
-00043ef0: 666f 7220 7468 6973 2063 6869 7270 2063  for this chirp c
-00043f00: 6f72 7265 6374 696f 6e2e 0d0a 0909 486f  orrection.....Ho
-00043f10: 7765 7665 7220 736f 6d65 7469 6d65 7320  wever sometimes 
-00043f20: 7370 696b 6573 2061 7265 206d 616b 696e  spikes are makin
-00043f30: 6720 7468 6973 2074 6869 6e67 7320 6469  g this things di
-00043f40: 6666 6963 756c 742e 200d 0a09 0949 6e20  fficult. ....In 
-00043f50: 7468 6973 2063 6173 6520 7365 7420 6120  this case set a 
-00043f60: 6775 6573 7365 6420 696e 7465 6e73 6974  guessed intensit
-00043f70: 7920 7769 7468 2073 656c 662e 696e 7465  y with self.inte
-00043f80: 6e73 6974 795f 7261 6e67 653d 3165 2d33  nsity_range=1e-3
-00043f90: 5c6e 200d 0a09 094e 6f74 6520 7468 6174  \n ....Note that
-00043fa0: 2073 6361 7474 6572 6375 742c 2062 6f72   scattercut, bor
-00043fb0: 6465 7263 7574 2061 6e64 2069 6e74 656e  dercut and inten
-00043fc0: 7369 7479 5f72 616e 6765 2063 616e 2062  sity_range can b
-00043fd0: 6520 7573 6564 0d0a 0d0a 0909 4166 7465  e used......Afte
-00043fe0: 7220 7468 6520 6669 7273 7420 7275 6e20  r the first run 
-00043ff0: 7468 6520 706f 6c79 6e6f 6d20 6973 2073  the polynom is s
-00044000: 746f 7265 6420 696e 2073 656c 662e 6669  tored in self.fi
-00044010: 7463 6f65 6666 2c20 6120 6e65 7720 6d61  tcoeff, a new ma
-00044020: 7472 6978 200d 0a09 0963 616c 6375 6c61  trix ....calcula
-00044030: 7465 6420 6672 6f6d 2073 656c 662e 6473  ted from self.ds
-00044040: 5f6f 7269 2074 6861 7420 6973 2073 746f  _ori that is sto
-00044050: 7265 6420 6173 2073 656c 662e 6473 2061  red as self.ds a
-00044060: 6e64 2061 2066 696c 6520 7374 6f72 6564  nd a file stored
-00044070: 2069 6e20 7468 6520 0d0a 0909 7361 6d65   in the ....same
-00044080: 206c 6f63 6174 696f 6e20 6173 2074 6865   location as the
-00044090: 206f 7269 6769 6e61 6c20 6461 7461 2e20   original data. 
-000440a0: 5468 6520 7365 636f 6e64 2074 696d 6520  The second time 
-000440b0: 7468 6520 6675 6e63 7469 6f6e 202a 436f  the function *Co
-000440c0: 725f 4368 6972 702a 2069 7320 0d0a 0909  r_Chirp* is ....
-000440d0: 7275 6e20 7468 6520 6675 6e63 7469 6f6e  run the function
-000440e0: 2077 696c 6c20 6669 6e64 2074 6865 2066   will find the f
-000440f0: 696c 6520 616e 6420 6170 706c 7920 7468  ile and apply th
-00044100: 6520 6368 6972 7020 636f 7272 6563 7469  e chirp correcti
-00044110: 6f6e 2061 7574 6f6d 6174 6963 616c 6c79  on automatically
-00044120: 2e0d 0a0d 0a09 0949 6620 6f6e 6520 646f  .......If one do
-00044130: 6573 2077 616e 7420 746f 2072 652d 7275  es want to re-ru
-00044140: 6e20 7468 6520 6368 6972 7020 636f 7272  n the chirp corr
-00044150: 6563 7469 6f6e 2074 6865 2066 756e 6374  ection the funct
-00044160: 696f 6e20 2a4d 616e 5f43 6869 7270 2a20  ion *Man_Chirp* 
-00044170: 646f 6573 0d0a 0909 6e6f 7420 6c6f 6f6b  does....not look
-00044180: 2066 6f72 2074 6869 7320 6669 6c65 2c20   for this file, 
-00044190: 6275 7420 6372 6561 7465 7320 6166 7465  but creates afte
-000441a0: 7220 6669 6e69 7368 696e 6720 6120 6e65  r finishing a ne
-000441b0: 7720 6669 6c65 2e0d 0a0d 0a09 0941 6c74  w file.......Alt
-000441c0: 6572 6e61 7469 7665 6c79 2074 6865 2070  ernatively the p
-000441d0: 6f6c 796e 6f6d 206f 7220 6120 6669 6c65  olynom or a file
-000441e0: 6e61 6d65 2063 616e 2062 6520 6769 7665  name can be give
-000441f0: 6e20 7468 6174 206c 6f61 6420 6120 6368  n that load a ch
-00044200: 6972 7020 636f 7272 6563 7469 6f6e 0d0a  irp correction..
-00044210: 0909 2865 2e67 2e20 6672 6f6d 2061 2064  ..(e.g. from a d
-00044220: 6966 6665 7265 6e74 2072 756e 2077 6974  ifferent run wit
-00044230: 6820 7468 6520 7361 6d65 2073 616d 706c  h the same sampl
-00044240: 6529 2e0d 0a09 0954 6865 2066 756e 6374  e).....The funct
-00044250: 696f 6e20 2a43 6f72 5f43 6869 7270 2a20  ion *Cor_Chirp* 
-00044260: 7365 6c65 6374 7320 696e 2074 6865 206f  selects in the o
-00044270: 7264 6572 3a20 0d0a 0d0a 0909 2320 2266  rder: ......# "f
-00044280: 6974 636f 6566 6622 0d0a 0909 2320 226f  itcoeff"....# "o
-00044290: 7468 6572 2066 696c 6573 220d 0a09 0923  ther files"....#
-000442a0: 2022 7374 6f72 6564 5f66 696c 6522 0d0a   "stored_file"..
-000442b0: 0909 2320 6361 6c6c 204d 616e 5f43 6869  ..# call Man_Chi
-000442c0: 7270 2028 636c 6963 6b69 6e67 2062 7920  rp (clicking by 
-000442d0: 6861 6e64 290d 0a09 090d 0a0d 0a09 090d  hand)...........
-000442e0: 0a09 0950 6172 616d 6574 6572 730d 0a09  ...Parameters...
-000442f0: 092d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  .-------------..
-00044300: 0909 0d0a 0909 6368 6972 702d 6669 6c65  ......chirp-file
-00044310: 203a 204e 6f6e 6520 6f72 2073 7472 2c20   : None or str, 
-00044320: 6f70 7469 6f6e 616c 0d0a 0909 2020 2049  optional....   I
-00044330: 6620 6120 7261 7720 6669 6c65 2077 6173  f a raw file was
-00044340: 2072 6561 6428 652e 672e 2022 6461 7461   read(e.g. "data
-00044350: 2e53 4941 2229 2061 6e64 2074 6865 2063  .SIA") and the c
-00044360: 6869 7270 2063 6f72 7265 6374 696f 6e20  hirp correction 
-00044370: 7761 730d 0a09 0920 2020 636f 6d70 6c65  was....   comple
-00044380: 7465 642c 2061 2066 696c 6520 7769 7468  ted, a file with
-00044390: 2074 6865 2061 7474 6163 6865 6420 776f   the attached wo
-000443a0: 7264 2022 6368 6972 7022 2069 7320 6372  rd "chirp" is cr
-000443b0: 6561 7465 6420 616e 640d 0a09 0920 2020  eated and....   
-000443c0: 7374 6f72 6564 2069 6e20 7468 6520 7361  stored in the sa
-000443d0: 6d65 206c 6f63 6174 696f 6e2e 2028 2264  me location. ("d
-000443e0: 6174 615f 6368 6972 702e 6461 7422 2920  ata_chirp.dat") 
-000443f0: 5468 6973 2066 696c 6520 636f 6e74 6169  This file contai
-00044400: 6e73 0d0a 0909 2020 2074 6865 2035 2076  ns....   the 5 v
-00044410: 616c 7565 7320 6f66 2074 6865 2063 6869  alues of the chi
-00044420: 7270 2063 6f72 7265 6374 696f 6e2e 2042  rp correction. B
-00044430: 7920 7365 6c65 6374 696e 6720 7375 6368  y selecting such
-00044440: 2061 2066 696c 650d 0a09 0920 2020 2865   a file....   (e
-00044450: 2e67 2ec2 a066 726f 6d20 616e 6f74 6865  .g...from anothe
-00044460: 7220 7261 7720 6461 7461 2920 6120 7370  r raw data) a sp
-00044470: 6563 6966 6963 2063 6869 7270 2069 7320  ecific chirp is 
-00044480: 6170 706c 6965 642e 2049 6620 610d 0a09  applied. If a...
-00044490: 0920 2020 7370 6563 6966 6963 206e 616d  .   specific nam
-000444a0: 6520 6973 2067 6976 656e 2077 6974 6820  e is given with 
-000444b0: 2a2a 6368 6972 705f 6669 6c65 2a2a 2028  **chirp_file** (
-000444c0: 616e 6420 6f70 7469 6f6e 616c 202a 2a70  and optional **p
-000444d0: 6174 682a 2a29 0d0a 0909 2020 2074 6865  ath**)....   the
-000444e0: 6e20 7468 6973 2066 696c 6520 6973 2075  n this file is u
-000444f0: 7365 642e 5c6e 0d0a 0909 2020 2047 5549  sed.\n....   GUI
-00044500: 5c6e 0d0a 0909 2020 2054 6865 2077 6f72  \n....   The wor
-00044510: 6420 2a27 6775 6927 2a20 6361 6e20 6265  d *'gui'* can be
-00044520: 2075 7365 6420 696e 7374 6561 6420 6f66   used instead of
-00044530: 2061 2066 696c 656e 616d 6520 746f 206f   a filename to o
-00044540: 7065 6e20 6120 6775 6920 7468 6174 0d0a  pen a gui that..
-00044550: 0909 2020 2061 6c6c 6f77 7320 7468 6520  ..   allows the 
-00044560: 7365 6c65 6374 696f 6e20 6f66 2061 2063  selection of a c
-00044570: 6872 6970 2066 696c 650d 0a09 0920 2020  hrip file....   
-00044580: 0d0a 0909 7061 7468 203a 2073 7472 206f  ....path : str o
-00044590: 7220 7061 7468 206f 626a 6563 7420 286f  r path object (o
-000445a0: 7074 696f 6e61 6c29 0d0a 0909 0969 6620  ptional).....if 
-000445b0: 7061 7468 2069 7320 6120 7374 7269 6e67  path is a string
-000445c0: 2077 6974 686f 7574 2074 6865 206f 7065   without the ope
-000445d0: 7261 7469 6f6e 2073 7973 7465 6d20 6465  ration system de
-000445e0: 7065 6e64 656e 7420 7365 7061 7261 746f  pendent separato
-000445f0: 722c 2069 7420 6973 2074 7265 6174 6564  r, it is treated
-00044600: 2061 7320 6120 7265 6c61 7469 7665 2070   as a relative p
-00044610: 6174 682c 200d 0a09 0909 652e 672e 2064  ath, .....e.g. d
-00044620: 6174 6120 7769 6c6c 206c 6f6f 6b20 6672  ata will look fr
-00044630: 6f6d 2074 6865 2077 6f72 6b69 6e67 2064  om the working d
-00044640: 6972 6563 746f 7279 2069 6e20 7468 6520  irectory in the 
-00044650: 7375 6220 6469 7265 6374 6f72 2064 6174  sub director dat
-00044660: 612e 204f 7468 6572 7769 7365 2074 6869  a. Otherwise thi
-00044670: 7320 6861 7320 746f 2062 6520 6120 0d0a  s has to be a ..
-00044680: 0909 0966 756c 6c20 7061 7468 2069 6e20  ...full path in 
-00044690: 6569 7468 6572 2073 7472 6f6e 6720 6f72  either strong or
-000446a0: 2070 6174 6820 6f62 6a65 6374 2066 6f72   path object for
-000446b0: 6d2e 0d0a 0909 0d0a 0909 7368 6f77 6e5f  m.........shown_
-000446c0: 7769 6e64 6f77 203a 206c 6973 7420 2877  window : list (w
-000446d0: 6974 6820 7477 6f20 666c 6f61 7473 292c  ith two floats),
-000446e0: 206f 7074 696f 6e61 6c0d 0a09 0909 4465   optional.....De
-000446f0: 6669 6e65 7320 7468 6520 7769 6e64 6f77  fines the window
-00044700: 2074 6861 7420 6973 2073 686f 776e 2064   that is shown d
-00044710: 7572 696e 6720 6368 6972 7020 636f 7272  uring chirp corr
-00044720: 6563 7469 6f6e 2e20 4966 2074 6865 2074  ection. If the t
-00044730: 3d30 2069 7320 6e6f 7420 7669 7369 626c  =0 is not visibl
-00044740: 652c 2061 646a 7573 7420 7468 6973 2070  e, adjust this p
-00044750: 6172 616d 6574 6572 0d0a 0909 0974 6f20  arameter.....to 
-00044760: 7375 6974 2074 6865 2065 7870 6572 696d  suit the experim
-00044770: 656e 742e 2049 6620 7072 6f62 6c65 6d73  ent. If problems
-00044780: 2061 7269 7365 2c20 4920 7265 636f 6d6d   arise, I recomm
-00044790: 656e 7420 746f 2075 7365 2050 6c6f 745f  ent to use Plot_
-000447a0: 5261 7720 746f 2063 6865 636b 2077 6865  Raw to check whe
-000447b0: 7265 2074 3d30 2069 7320 6c6f 6361 7465  re t=0 is locate
-000447c0: 640d 0a09 0909 0d0a 0909 6669 7463 6f65  d.........fitcoe
-000447d0: 6666 203a 206c 6973 7420 6f72 2076 6563  ff : list or vec
-000447e0: 746f 7220 2835 2066 6c6f 6174 7329 2c20  tor (5 floats), 
-000447f0: 6f70 7469 6f6e 616c 0d0a 0909 094f 6e65  optional.....One
-00044800: 2063 616e 2067 6976 6520 6120 7665 6374   can give a vect
-00044810: 6f72 2f6c 6973 7420 7769 7468 2035 206e  or/list with 5 n
-00044820: 756d 6265 7273 2072 6570 7265 7365 6e74  umbers represent
-00044830: 696e 6720 7468 6520 7061 7261 6d65 7465  ing the paramete
-00044840: 720d 0a09 0909 6f66 2061 2034 7468 206f  r.....of a 4th o
-00044850: 7264 6572 2070 6f6c 796e 6f6d 6961 6c20  rder polynomial 
-00044860: 2869 6e20 7468 6520 6f72 6465 720d 0a09  (in the order...
-00044870: 0909 3a6d 6174 683a 6028 6134 2a78 5e34  ..:math:`(a4*x^4
-00044880: 202b 2061 332a 785e 332b 6132 2a78 5e32   + a3*x^3+a2*x^2
-00044890: 2b61 312a 7831 2b61 3029 602e 2054 6865  +a1*x1+a0)`. The
-000448a0: 2063 6869 7270 2070 6172 616d 6574 6572   chirp parameter
-000448b0: 2061 7265 0d0a 0909 0973 746f 7265 6420   are.....stored 
-000448c0: 696e 2074 612e 6669 7463 6f65 6666 2061  in ta.fitcoeff a
-000448d0: 6e64 2063 616e 2074 6875 7320 6265 2075  nd can thus be u
-000448e0: 7365 6420 696e 206f 7468 6572 2054 4120  sed in other TA 
-000448f0: 6f62 6a65 6374 732e 2054 6869 730d 0a09  objects. This...
-00044900: 0909 7665 6374 6f72 2069 7320 616c 736f  ..vector is also
-00044910: 2073 746f 7265 6420 7769 7468 2074 6865   stored with the
-00044920: 2066 696c 6520 616e 6420 6175 746f 6d61   file and automa
-00044930: 7469 6361 6c6c 7920 6170 706c 6965 6420  tically applied 
-00044940: 6475 7269 6e67 0d0a 0909 0972 652d 6c6f  during.....re-lo
-00044950: 6164 696e 6720 6f66 2061 2068 6466 352d  ading of a hdf5-
-00044960: 6f62 6a65 6374 0d0a 0d0a 0909 6d61 785f  object......max_
-00044970: 706f 696e 7473 203a 2069 6e74 2c20 6f70  points : int, op
-00044980: 7469 6f6e 616c 0d0a 0909 0944 6566 6175  tional.....Defau
-00044990: 6c74 203d 2034 3020 6d61 7820 6e75 6d62  lt = 40 max numb
-000449a0: 6572 7320 6f66 2070 6f69 6e74 7320 746f  ers of points to
-000449b0: 2075 7365 2069 6e20 4775 6920 7365 6c65   use in Gui sele
-000449c0: 6374 696f 6e2e 2055 7365 6675 6c20 6f70  ction. Useful op
-000449d0: 7469 6f6e 2069 6e20 6361 7365 206e 6f20  tion in case no 
-000449e0: 6d69 6464 6c65 206d 6f75 7365 2062 7574  middle mouse but
-000449f0: 746f 6e0d 0a09 0909 6973 2061 7661 696c  ton.....is avail
-00044a00: 6162 6c65 2e20 2865 2e67 2e20 746f 7563  able. (e.g. touc
-00044a10: 6870 6164 290d 0a09 090d 0a09 0963 6d61  hpad)........cma
-00044a20: 7020 3a20 6d61 7470 6c6f 746c 6962 2063  p : matplotlib c
-00044a30: 6f6c 6f75 726d 6170 2c20 6f70 7469 6f6e  olourmap, option
-00044a40: 616c 0d0a 0909 0943 6f6c 6f75 726d 6170  al.....Colourmap
-00044a50: 2074 6f20 6265 2075 7365 6420 666f 7220   to be used for 
-00044a60: 7468 6520 6368 6972 7020 636f 7272 6563  the chirp correc
-00044a70: 7469 6f6e 2e20 5768 696c 6520 7468 6572  tion. While ther
-00044a80: 6520 6973 2061 206c 6172 6765 2073 656c  e is a large sel
-00044a90: 6563 7469 6f6e 2068 6572 6520 4920 7265  ection here I re
-00044aa0: 636f 6d6d 656e 6420 746f 2063 686f 6f73  commend to choos
-00044ab0: 650d 0a09 0909 6120 6469 6666 6572 656e  e.....a differen
-00044ac0: 7420 6d61 7020 7468 616e 2069 7320 7573  t map than is us
-00044ad0: 6564 2066 6f72 2074 6865 206e 6f72 6d61  ed for the norma
-00044ae0: 6c20 3264 2070 6c6f 7474 696e 672e 5c6e  l 2d plotting.\n
-00044af0: 0d0a 0909 0963 6d2e 7072 6973 6d20 2844  .....cm.prism (D
-00044b00: 6566 6175 6c74 2920 6861 7320 7072 6f6f  efault) has proo
-00044b10: 6665 6e20 746f 2062 6520 7665 7279 2075  fen to be very u
-00044b20: 7365 6675 6c6c 0d0a 0d0a 0909 4578 616d  sefull......Exam
-00044b30: 706c 6573 0d0a 0909 2d2d 2d2d 2d2d 2d2d  ples....--------
-00044b40: 2d2d 0d0a 0909 0d0a 0909 496e 206d 6f73  --........In mos
-00044b50: 7420 6361 7365 733a 0d0a 0909 0d0a 0909  t cases:........
-00044b60: 3e3e 3e20 696d 706f 7274 2070 6c6f 745f  >>> import plot_
-00044b70: 6675 6e63 2061 7320 7066 0d0a 0909 3e3e  func as pf....>>
-00044b80: 3e20 7461 203d 2070 662e 5441 2827 7465  > ta = pf.TA('te
-00044b90: 7374 312e 5349 4127 2920 236f 7065 6e20  st1.SIA') #open 
-00044ba0: 7468 6520 6f72 6967 696e 616c 2070 726f  the original pro
-00044bb0: 6a65 6374 2c20 0d0a 0909 3e3e 3e20 7461  ject, ....>>> ta
-00044bc0: 2e43 6f72 5f43 6869 7270 2829 0d0a 0909  .Cor_Chirp()....
-00044bd0: 0d0a 0909 5365 6c65 6374 696e 6720 6120  ....Selecting a 
-00044be0: 7370 6563 6966 6963 2063 6f72 7265 6374  specific correct
-00044bf0: 696f 6e0d 0a09 090d 0a09 093e 3e3e 2074  ion........>>> t
-00044c00: 612e 436f 725f 4368 6972 7028 e280 9867  a.Cor_Chirp(...g
-00044c10: 7569 e280 9929 0d0a 0909 3e3e 3e20 7461  ui...)....>>> ta
-00044c20: 2e43 6f72 5f43 6869 7270 2863 6869 7270  .Cor_Chirp(chirp
-00044c30: 5f66 696c 6520 3d20 276f 6c64 6572 5f64  _file = 'older_d
-00044c40: 6174 615f 6368 6972 702e 6461 7427 290d  ata_chirp.dat').
-00044c50: 0a09 093e 3e3e 2023 7573 6520 7468 6520  ...>>> #use the 
-00044c60: 636f 6566 6669 6369 656e 7473 2066 726f  coefficients fro
-00044c70: 6d20 6120 6469 6666 6572 656e 7420 7072  m a different pr
-00044c80: 6f6a 6563 740d 0a09 093e 3e3e 2074 612e  oject....>>> ta.
-00044c90: 436f 725f 4368 6972 7028 6669 7463 6f65  Cor_Chirp(fitcoe
-00044ca0: 6666 203d 2074 615f 6f6c 642e 6669 7463  ff = ta_old.fitc
-00044cb0: 6f65 6666 2920 2375 7365 2074 6865 2063  oeff) #use the c
-00044cc0: 6f65 6666 6963 6965 6e74 7320 6672 6f6d  oefficients from
-00044cd0: 2061 2064 6966 6665 7265 6e74 2070 726f   a different pro
-00044ce0: 6a65 6374 0d0a 0909 0d0a 0909 2727 270d  ject........'''.
-00044cf0: 0a09 090d 0a09 0969 6620 6368 6972 705f  .......if chirp_
-00044d00: 6669 6c65 2069 7320 4e6f 6e65 3a0d 0a09  file is None:...
-00044d10: 0909 6368 6972 705f 6669 6c65 3d73 656c  ..chirp_file=sel
-00044d20: 662e 6368 6972 705f 6669 6c65 0d0a 0909  f.chirp_file....
-00044d30: 656c 6966 2027 6775 6927 2069 6e20 6368  elif 'gui' in ch
-00044d40: 6972 705f 6669 6c65 3a0d 0a09 0909 726f  irp_file:.....ro
-00044d50: 6f74 5f77 696e 646f 7720 3d20 746b 696e  ot_window = tkin
-00044d60: 7465 722e 546b 2829 0d0a 0909 0972 6f6f  ter.Tk().....roo
-00044d70: 745f 7769 6e64 6f77 2e77 6974 6864 7261  t_window.withdra
-00044d80: 7728 290d 0a09 0909 726f 6f74 5f77 696e  w().....root_win
-00044d90: 646f 772e 6174 7472 6962 7574 6573 2827  dow.attributes('
-00044da0: 2d74 6f70 6d6f 7374 272c 5472 7565 290d  -topmost',True).
-00044db0: 0a09 0909 726f 6f74 5f77 696e 646f 772e  ....root_window.
-00044dc0: 6166 7465 7228 3130 3030 2c20 6c61 6d62  after(1000, lamb
-00044dd0: 6461 3a20 726f 6f74 5f77 696e 646f 772e  da: root_window.
-00044de0: 666f 6375 735f 666f 7263 6528 2929 0d0a  focus_force())..
-00044df0: 0909 0963 6f6d 706c 6574 655f 7061 7468  ...complete_path
-00044e00: 203d 2066 696c 6564 6961 6c6f 672e 6173   = filedialog.as
-00044e10: 6b6f 7065 6e66 696c 656e 616d 6528 696e  kopenfilename(in
-00044e20: 6974 6961 6c64 6972 3d6f 732e 6765 7463  itialdir=os.getc
-00044e30: 7764 2829 290d 0a09 0909 6c69 7374 656e  wd()).....listen
-00044e40: 3d6f 732e 7061 7468 2e73 706c 6974 2863  =os.path.split(c
-00044e50: 6f6d 706c 6574 655f 7061 7468 290d 0a09  omplete_path)...
-00044e60: 0909 7061 7468 3d6f 732e 7061 7468 2e6e  ..path=os.path.n
-00044e70: 6f72 6d70 6174 6828 6c69 7374 656e 5b30  ormpath(listen[0
-00044e80: 5d29 0d0a 0909 0963 6869 7270 5f66 696c  ]).....chirp_fil
-00044e90: 653d 6c69 7374 656e 5b31 5d0d 0a09 0970  e=listen[1]....p
-00044ea0: 6174 683d 6368 6563 6b5f 666f 6c64 6572  ath=check_folder
-00044eb0: 2870 6174 682c 7365 6c66 2e70 6174 6829  (path,self.path)
-00044ec0: 0d0a 0909 6966 2066 6974 636f 6566 6620  ....if fitcoeff 
-00044ed0: 6973 206e 6f74 204e 6f6e 653a 2377 6520  is not None:#we 
-00044ee0: 7573 6520 6120 7374 6f72 6564 2070 726f  use a stored pro
-00044ef0: 6a65 6374 0d0a 0909 0974 7279 3a0d 0a09  ject.....try:...
-00044f00: 0909 0969 6620 6c65 6e28 6669 7463 6f65  ...if len(fitcoe
-00044f10: 6666 293d 3d35 206f 7220 6c65 6e28 6669  ff)==5 or len(fi
-00044f20: 7463 6f65 6666 293d 3d36 3a23 7765 2070  tcoeff)==6:#we p
-00044f30: 726f 7669 6465 2061 2076 616c 6964 206c  rovide a valid l
-00044f40: 6973 742f 7665 6374 6f72 0d0a 0909 0909  ist/vector......
-00044f50: 0969 6620 616c 6c28 656c 656d 203d 3d20  .if all(elem == 
-00044f60: 3020 666f 7220 656c 656d 2069 6e20 6669  0 for elem in fi
-00044f70: 7463 6f65 6666 293a 0d0a 0909 0909 0909  tcoeff):........
-00044f80: 7365 6c66 2e64 733d 7365 6c66 2e64 735f  self.ds=self.ds_
-00044f90: 6f72 690d 0a09 0909 0909 0970 7269 6e74  ori........print
-00044fa0: 2827 616c 6c20 6368 6972 7020 636f 6566  ('all chirp coef
-00044fb0: 6669 6369 656e 7473 2061 7265 207a 6572  ficients are zer
-00044fc0: 6f20 736f 206e 6f20 6368 6972 7020 636f  o so no chirp co
-00044fd0: 7272 6563 7469 6f6e 2061 7070 6c69 6564  rrection applied
-00044fe0: 2729 0d0a 0909 0909 0965 6c73 653a 090d  ').......else:..
-00044ff0: 0a09 0909 0909 0973 656c 662e 6473 3d46  .......self.ds=F
-00045000: 6978 5f43 6869 7270 2873 656c 662e 6473  ix_Chirp(self.ds
-00045010: 5f6f 7269 2c66 6974 636f 6566 663d 6669  _ori,fitcoeff=fi
-00045020: 7463 6f65 6666 290d 0a09 0909 0909 7365  tcoeff).......se
-00045030: 6c66 2e66 6974 636f 6566 663d 6669 7463  lf.fitcoeff=fitc
-00045040: 6f65 6666 2023 7765 2063 616d 6520 746f  oeff #we came to
-00045050: 2068 6572 6520 736f 2066 6974 636f 6566   here so fitcoef
-00045060: 6620 6d75 7374 2062 6520 7269 6768 740d  f must be right.
-00045070: 0a09 0909 0965 6c73 653a 0d0a 0909 0909  .....else:......
-00045080: 0972 6169 7365 0d0a 0909 0965 7863 6570  .raise.....excep
-00045090: 743a 0d0a 0909 0909 7365 6c66 2e64 733d  t:......self.ds=
-000450a0: 7365 6c66 2e64 735f 6f72 690d 0a09 0920  self.ds_ori.... 
-000450b0: 200d 0a09 0909 0970 7269 6e74 2827 736f   ......print('so
-000450c0: 6d65 7468 696e 6720 7765 6e74 2077 726f  mething went wro
-000450d0: 6e67 2077 6974 6820 7468 6520 7072 6f76  ng with the prov
-000450e0: 6964 6564 2066 6974 636f 6566 662e 2054  ided fitcoeff. T
-000450f0: 6869 7320 7368 6f75 6c64 2062 6520 6569  his should be ei
-00045100: 7468 6572 2061 206c 6973 742f 6172 7261  ther a list/arra
-00045110: 7920 7769 7468 2035 2d36 2070 6172 616d  y with 5-6 param
-00045120: 6574 6572 206f 7220 7468 6520 6f62 6a65  eter or the obje
-00045130: 6374 2073 686f 756c 6420 636f 6e74 6169  ct should contai
-00045140: 6e20 7468 6520 7061 7261 6d65 7465 7227  n the parameter'
-00045150: 290d 0a09 0909 0970 7269 6e74 2827 6669  )......print('fi
-00045160: 7463 6f65 6666 2069 7320 6375 7272 656e  tcoeff is curren
-00045170: 746c 793a 2720 2b20 6669 7463 6f65 6666  tly:' + fitcoeff
-00045180: 290d 0a09 0965 6c73 653a 0d0a 0909 0974  )....else:.....t
-00045190: 7279 3a0d 0a09 0909 0973 656c 662e 6473  ry:......self.ds
-000451a0: 3d46 6978 5f43 6869 7270 2873 656c 662e  =Fix_Chirp(self.
-000451b0: 6473 5f6f 7269 2c63 6d61 703d 636d 6170  ds_ori,cmap=cmap
-000451c0: 2c73 6176 655f 6669 6c65 3d63 6865 636b  ,save_file=check
-000451d0: 5f66 6f6c 6465 7228 7061 7468 3d70 6174  _folder(path=pat
-000451e0: 682c 6669 6c65 6e61 6d65 3d63 6869 7270  h,filename=chirp
-000451f0: 5f66 696c 6529 2c73 6361 7474 6572 6375  _file),scattercu
-00045200: 743d 7365 6c66 2e73 6361 7474 6572 6375  t=self.scattercu
-00045210: 742c 626f 7264 6572 6375 743d 7365 6c66  t,bordercut=self
-00045220: 2e62 6f72 6465 7263 7574 2c69 6e74 656e  .bordercut,inten
-00045230: 7369 7479 5f72 616e 6765 3d73 656c 662e  sity_range=self.
-00045240: 696e 7465 6e73 6974 795f 7261 6e67 652c  intensity_range,
-00045250: 7761 7665 5f6e 6d5f 6269 6e3d 3130 2c73  wave_nm_bin=10,s
-00045260: 686f 776e 5f77 696e 646f 773d 7368 6f77  hown_window=show
-00045270: 6e5f 7769 6e64 6f77 2c66 6974 636f 6566  n_window,fitcoef
-00045280: 663d 6669 7463 6f65 6666 2c6d 6178 5f70  f=fitcoeff,max_p
-00045290: 6f69 6e74 733d 6d61 785f 706f 696e 7473  oints=max_points
-000452a0: 290d 0a09 0909 0977 6974 6820 6f70 656e  )......with open
-000452b0: 2863 6865 636b 5f66 6f6c 6465 7228 7061  (check_folder(pa
-000452c0: 7468 3d70 6174 682c 6669 6c65 6e61 6d65  th=path,filename
-000452d0: 3d63 6869 7270 5f66 696c 6529 2c27 7227  =chirp_file),'r'
-000452e0: 2920 6173 2066 3a0d 0a09 0909 0909 7365  ) as f:.......se
-000452f0: 6c66 2e66 6974 636f 6566 663d 5b66 6c6f  lf.fitcoeff=[flo
-00045300: 6174 2861 2920 666f 7220 6120 696e 2066  at(a) for a in f
-00045310: 2e72 6561 646c 696e 6528 292e 7370 6c69  .readline().spli
-00045320: 7428 272c 2729 5d0d 0a09 0909 6578 6365  t(',')].....exce
-00045330: 7074 3a0d 0a09 0909 0970 7269 6e74 2863  pt:......print(c
-00045340: 6865 636b 5f66 6f6c 6465 7228 7061 7468  heck_folder(path
-00045350: 3d73 656c 662e 7061 7468 2c66 696c 656e  =self.path,filen
-00045360: 616d 653d 7365 6c66 2e66 696c 656e 616d  ame=self.filenam
-00045370: 652e 7370 6c69 7428 272e 2729 5b30 5d20  e.split('.')[0] 
-00045380: 2b20 275f 6368 6972 702e 6461 7427 2929  + '_chirp.dat'))
-00045390: 0d0a 0909 0909 6966 206f 732e 7061 7468  ......if os.path
-000453a0: 2e69 7366 696c 6528 6368 6563 6b5f 666f  .isfile(check_fo
-000453b0: 6c64 6572 2870 6174 683d 7365 6c66 2e70  lder(path=self.p
-000453c0: 6174 682c 6669 6c65 6e61 6d65 3d73 656c  ath,filename=sel
-000453d0: 662e 6669 6c65 6e61 6d65 2e73 706c 6974  f.filename.split
-000453e0: 2827 2e27 295b 305d 202b 2027 5f63 6869  ('.')[0] + '_chi
-000453f0: 7270 2e64 6174 2729 293a 0d0a 0909 0909  rp.dat')):......
-00045400: 0970 7269 6e74 2827 736f 6d65 6874 696e  .print('somehtin
-00045410: 6720 6973 2077 726f 6e67 2c20 7472 7920  g is wrong, try 
-00045420: 6465 6c65 7469 6e67 206f 6c64 2063 6869  deleting old chi
-00045430: 7270 2066 696c 6527 290d 0a09 0909 0909  rp file').......
-00045440: 7261 6973 650d 0a09 0909 0965 6c73 653a  raise......else:
-00045450: 0d0a 0909 0909 0970 7269 6e74 2827 4e6f  .......print('No
-00045460: 206f 6c64 2063 6869 7270 2066 696c 6527   old chirp file'
-00045470: 290d 0a09 0909 0909 7365 6c66 2e4d 616e  ).......self.Man
-00045480: 5f43 6869 7270 2870 6174 683d 7061 7468  _Chirp(path=path
-00045490: 2c63 6d61 703d 636d 6170 2c73 686f 776e  ,cmap=cmap,shown
-000454a0: 5f77 696e 646f 773d 7368 6f77 6e5f 7769  _window=shown_wi
-000454b0: 6e64 6f77 2c6d 6178 5f70 6f69 6e74 733d  ndow,max_points=
-000454c0: 6d61 785f 706f 696e 7473 290d 0a09 0909  max_points).....
-000454d0: 0909 6368 6972 705f 6669 6c65 3d73 656c  ..chirp_file=sel
-000454e0: 662e 6368 6972 705f 6669 6c65 0d0a 0909  f.chirp_file....
-000454f0: 0909 0977 6974 6820 6f70 656e 2863 6865  ...with open(che
-00045500: 636b 5f66 6f6c 6465 7228 7061 7468 3d70  ck_folder(path=p
-00045510: 6174 682c 6669 6c65 6e61 6d65 3d63 6869  ath,filename=chi
-00045520: 7270 5f66 696c 6529 2c27 7227 2920 6173  rp_file),'r') as
-00045530: 2066 3a0d 0a09 0909 0909 0973 656c 662e   f:........self.
-00045540: 6669 7463 6f65 6666 3d5b 666c 6f61 7428  fitcoeff=[float(
-00045550: 6129 2066 6f72 2061 2069 6e20 662e 7265  a) for a in f.re
-00045560: 6164 6c69 6e65 2829 2e73 706c 6974 2827  adline().split('
-00045570: 2c27 295d 0d0a 0909 7365 6c66 2e64 732e  ,')]....self.ds.
-00045580: 636f 6c75 6d6e 732e 6e61 6d65 3d73 656c  columns.name=sel
-00045590: 662e 6473 5f6f 7269 2e63 6f6c 756d 6e73  f.ds_ori.columns
-000455a0: 2e6e 616d 650d 0a09 0973 656c 662e 6473  .name....self.ds
-000455b0: 2e69 6e64 6578 2e6e 616d 653d 7365 6c66  .index.name=self
-000455c0: 2e64 735f 6f72 692e 696e 6465 782e 6e61  .ds_ori.index.na
-000455d0: 6d65 0d0a 0d0a 0964 6566 2050 6c6f 745f  me.....def Plot_
-000455e0: 496e 7465 7261 6374 6976 6528 7365 6c66  Interactive(self
-000455f0: 2c20 6669 7474 6564 203d 2046 616c 7365  , fitted = False
-00045600: 2c20 6473 203d 204e 6f6e 652c 2063 6d61  , ds = None, cma
-00045610: 7020 3d20 4e6f 6e65 2c20 706c 6f74 5f6f  p = None, plot_o
-00045620: 6e5f 6d6f 7665 203d 2046 616c 7365 293a  n_move = False):
-00045630: 0d0a 0909 2727 2769 6e74 6572 6163 7469  ....'''interacti
-00045640: 7665 2070 6c6f 7474 696e 6720 6675 6e63  ve plotting func
-00045650: 7469 6f6e 2e20 6974 2070 6c6f 7473 2074  tion. it plots t
-00045660: 6865 206d 6174 7269 7820 696e 2074 6865  he matrix in the
-00045670: 206d 6964 646c 6520 616e 6420 7477 6f20   middle and two 
-00045680: 736c 6963 6573 2074 6861 7420 6172 6520  slices that are 
-00045690: 7365 6c65 6374 6564 2062 7920 7468 6520  selected by the 
-000456a0: 6d6f 7573 6520 2863 6c69 636b 2920 0d0a  mouse (click) ..
-000456b0: 0909 0d0a 0909 5061 7261 6d65 7465 7273  ......Parameters
-000456c0: 0d0a 0909 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ....------------
-000456d0: 2d2d 2d0d 0a09 0966 6974 7465 6420 3a20  ---....fitted : 
-000456e0: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0d0a  bool, optional..
-000456f0: 0909 0974 6869 7320 7377 6974 6368 2064  ...this switch d
-00045700: 6563 6964 6573 2069 6620 7468 6520 6669  ecides if the fi
-00045710: 7474 6564 206f 7220 7468 6520 5241 5720  tted or the RAW 
-00045720: 6461 7461 2069 7320 706c 6f74 7465 6420  data is plotted 
-00045730: 7769 7468 2074 6869 7320 7769 6467 6574  with this widget
-00045740: 2074 6f20 0d0a 0909 0969 6e73 7065 6374   to .....inspect
-00045750: 2074 6865 2064 6174 6120 6461 7461 2e20   the data data. 
-00045760: 4966 2066 6974 7465 6420 6973 2046 616c  If fitted is Fal
-00045770: 7365 2028 4465 6661 756c 7429 2074 6865  se (Default) the
-00045780: 6e20 7468 6520 7261 7720 6461 7461 2061  n the raw data a
-00045790: 6e64 2061 6e20 696e 7465 7270 6f6c 6174  nd an interpolat
-000457a0: 696f 6e20 0d0a 0909 0969 7320 7573 6564  ion .....is used
-000457b0: 2074 6f20 706c 6f74 2e20 0d0a 0909 0d0a   to plot. ......
-000457c0: 0909 636d 6170 203a 204e 6f6e 6520 6f72  ..cmap : None or
-000457d0: 206d 6174 706c 6f74 6c69 6220 636f 6c6f   matplotlib colo
-000457e0: 7220 6d61 702c 206f 7074 696f 6e61 6c0d  r map, optional.
-000457f0: 0a09 0909 6973 2061 2070 6f77 6572 6675  ....is a powerfu
-00045800: 6c6c 2076 6172 6961 626c 6520 7468 6174  ll variable that
-00045810: 2063 686f 6f73 6573 2074 6865 2063 6f6c   chooses the col
-00045820: 6f75 7220 6d61 7020 6170 706c 6965 6420  our map applied 
-00045830: 666f 7220 616c 6c20 706c 6f74 732e 2049  for all plots. I
-00045840: 6620 7365 7420 746f 200d 0a09 0909 4e6f  f set to .....No
-00045850: 6e65 2028 4465 6661 756c 7429 2074 6865  ne (Default) the
-00045860: 6e20 7468 6520 7365 6c66 2e63 6d61 7020  n the self.cmap 
-00045870: 6973 2075 7365 642e 0d0a 0909 0941 7320  is used......As 
-00045880: 7374 616e 6461 7264 2049 2075 7365 2074  standard I use t
-00045890: 6865 2063 6f6c 6f72 206d 6170 2022 6a65  he color map "je
-000458a0: 7422 2066 726f 6d20 6d61 7470 6c6f 746c  t" from matplotl
-000458b0: 6962 2e20 5468 6572 6520 6172 6520 6120  ib. There are a 
-000458c0: 7661 7269 6574 7920 6f66 2063 6f6c 6f72  variety of color
-000458d0: 6d61 7073 200d 0a09 0909 6176 6169 6c61  maps .....availa
-000458e0: 626c 6520 7468 6174 2061 7265 2076 6572  ble that are ver
-000458f0: 7920 7573 6566 756c 6c2e 2042 6573 6964  y usefull. Besid
-00045900: 6520 226a 6574 222c 2022 7669 7269 6469  e "jet", "viridi
-00045910: 7322 2069 7320 6120 676f 6f64 2063 686f  s" is a good cho
-00045920: 6963 6520 6173 2069 7420 6973 2077 656c  ice as it is wel
-00045930: 6c20 0d0a 0909 0976 6973 6962 6c65 2075  l .....visible u
-00045940: 6e64 6572 2072 6564 2d67 7265 656e 2062  nder red-green b
-00045950: 6c69 6e64 6e65 7373 2e20 4f74 6865 7220  lindness. Other 
-00045960: 7573 6566 756c 206d 6170 7320 6172 6520  useful maps are 
-00045970: 2270 7269 736d 2220 666f 7220 6869 6768  "prism" for high
-00045980: 2066 6c75 6374 7561 7469 6f6e 7320 0d0a   fluctuations ..
-00045990: 0909 096f 7220 6469 7665 7267 696e 6720  ...or diverging 
-000459a0: 636f 6c6f 7220 6d61 7073 206c 696b 6520  color maps like 
-000459b0: 2273 6569 736d 6963 222e 200d 0a09 0909  "seismic". .....
-000459c0: 5365 6520 6874 7470 733a 2f2f 6d61 7470  See https://matp
-000459d0: 6c6f 746c 6962 2e6f 7267 2f33 2e31 2e30  lotlib.org/3.1.0
-000459e0: 2f74 7574 6f72 6961 6c73 2f63 6f6c 6f72  /tutorials/color
-000459f0: 732f 636f 6c6f 726d 6170 732e 6874 6d6c  s/colormaps.html
-00045a00: 2066 6f72 2061 2063 6f6d 7072 6568 656e   for a comprehen
-00045a10: 7369 7665 200d 0a09 0909 7365 6c65 6374  sive .....select
-00045a20: 696f 6e2e 2049 6e20 7468 6520 636f 6465  ion. In the code
-00045a30: 2074 6865 2063 6f6c 6f72 6d61 7073 2061   the colormaps a
-00045a40: 7265 2069 6d70 6f72 7465 6420 736f 2069  re imported so i
-00045a50: 6620 706c 6f74 5f66 756e 6320 6973 2069  f plot_func is i
-00045a60: 6d70 6f72 7465 6420 6173 2070 6620 7468  mported as pf th
-00045a70: 656e 200d 0a09 0909 7365 6c66 2e63 6d61  en .....self.cma
-00045a80: 703d 7066 2e63 6d2e 7669 7269 6469 7320  p=pf.cm.viridis 
-00045a90: 7365 7473 2076 6972 6964 6973 2061 7320  sets viridis as 
-00045aa0: 7468 6520 6d61 7020 746f 2075 7365 2e20  the map to use. 
-00045ab0: 496e 7465 726e 616c 6c79 2074 6865 2063  Internally the c
-00045ac0: 6f6c 6f72 7320 6172 6520 6368 6f73 656e  olors are chosen
-00045ad0: 200d 0a09 0909 7769 7468 2074 6865 2022   .....with the "
-00045ae0: 636f 6c6d 2220 6675 6e63 7469 6f6e 2e20  colm" function. 
-00045af0: 5468 6520 3264 2070 6c6f 7473 2072 6571  The 2d plots req
-00045b00: 7569 7265 2061 2063 6f6e 7469 6e75 6f75  uire a continuou
-00045b10: 7320 636f 6c6f 7220 6d61 7020 736f 2069  s color map so i
-00045b20: 6620 736f 6d65 7468 696e 6720 0d0a 0909  f something ....
-00045b30: 0965 6c73 6520 6973 2067 6976 6520 3264  .else is give 2d
-00045b40: 2070 6c6f 7473 2061 7265 2073 686f 776e   plots are shown
-00045b50: 2061 7574 6f6d 6174 6963 616c 6c79 2077   automatically w
-00045b60: 6974 6820 226a 6574 222e 2046 6f72 2061  ith "jet". For a
-00045b70: 6c6c 206f 6620 7468 6520 3164 2070 6c6f  ll of the 1d plo
-00045b80: 7473 2068 6f77 6576 6572 200d 0a09 0909  ts however .....
-00045b90: 4920 6669 7273 7420 7365 6c65 6374 2061  I first select a
-00045ba0: 206e 756d 6265 7220 6f66 2063 6f6c 6f72   number of color
-00045bb0: 7320 6265 666f 7265 2065 6163 6820 706c  s before each pl
-00045bc0: 6f74 2e20 4966 2063 6d61 7020 6973 2061  ot. If cmap is a
-00045bd0: 2063 6f6e 7469 6e6f 7573 206d 6170 2074   continous map t
-00045be0: 6865 6e20 7468 6573 650d 0a09 0909 6172  hen these.....ar
-00045bf0: 6520 7361 6d70 6c65 6420 6576 656e 6c79  e sampled evenly
-00045c00: 206f 7665 7220 7468 6520 636f 6c6f 7572   over the colour
-00045c10: 6d61 702e 204d 616e 7561 6c20 6974 6572  map. Manual iter
-00045c20: 6162 6c65 7320 6f66 2063 6f6c 6f75 7273  ables of colours
-00045c30: 200d 0a09 0909 636d 6170 3d5b 2831 2c30   .....cmap=[(1,0
-00045c40: 2c30 292c 2830 2c31 2c30 292c 2830 2c30  ,0),(0,1,0),(0,0
-00045c50: 2c31 292c 2e2e 2e5d 2061 7265 2061 6c73  ,1),...] are als
-00045c60: 6f20 6163 6365 7074 6564 2c20 6173 2061  o accepted, as a
-00045c70: 7265 2076 6563 746f 7273 206f 7220 6461  re vectors or da
-00045c80: 7461 6672 616d 6573 2074 6861 7420 0d0a  taframes that ..
-00045c90: 0909 0963 6f6e 7461 696e 2061 7320 726f  ...contain as ro
-00045ca0: 7773 2074 6865 2063 6f6c 6f72 732e 2054  ws the colors. T
-00045cb0: 6865 7265 206d 7573 7420 6265 206f 6620  here must be of 
-00045cc0: 636f 7572 7365 2073 7566 6669 6369 656e  course sufficien
-00045cd0: 7420 636f 6c6f 7273 2070 7265 7365 6e74  t colors present
-00045ce0: 2066 6f72 200d 0a09 0909 7468 6520 6e75   for .....the nu
-00045cf0: 6d62 6572 7320 6f66 206c 696e 6573 2074  mbers of lines t
-00045d00: 6861 7420 7769 6c6c 2062 6520 706c 6f74  hat will be plot
-00045d10: 7465 642e 2053 6f20 4920 7265 636f 6d6d  ted. So I recomm
-00045d20: 656e 6420 746f 2070 726f 7669 6465 2061  end to provide a
-00045d30: 7420 6c65 6173 7420 3130 2063 6f6c 6f75  t least 10 colou
-00045d40: 7273 200d 0a09 0909 2865 2e67 2e7e 796f  rs .....(e.g.~yo
-00045d50: 7572 2075 6e69 7665 7273 6974 7920 636f  ur university co
-00045d60: 6c6f 7273 292e 2063 6f6c 6f75 7273 2061  lors). colours a
-00045d70: 7265 2061 6c77 6179 7320 6769 7665 6e20  re always given 
-00045d80: 6173 2061 2c20 6c69 7374 206f 7220 7475  as a, list or tu
-00045d90: 706c 6520 7769 7468 2052 4741 206f 7220  ple with RGA or 
-00045da0: 5247 4241 0d0a 0909 0928 7769 7468 2074  RGBA.....(with t
-00045db0: 6865 206c 6173 7420 4120 6265 6569 6e67  he last A beeing
-00045dc0: 2074 6865 2041 6c70 6861 3d74 7261 6e73   the Alpha=trans
-00045dd0: 7061 7265 6e63 792e 2041 6c6c 206e 756d  parency. All num
-00045de0: 6265 7273 2061 7265 2062 6574 7765 656e  bers are between
-00045df0: 2030 2061 6e64 2031 2e20 0d0a 0909 0949   0 and 1. .....I
-00045e00: 6620 6120 6c69 7374 2f76 6563 746f 722f  f a list/vector/
-00045e10: 4461 7461 4672 616d 6520 6973 2067 6976  DataFrame is giv
-00045e20: 656e 2066 6f72 2074 6865 2063 6f6c 6f75  en for the colou
-00045e30: 7273 2074 6865 7920 7769 6c6c 2062 6520  rs they will be 
-00045e40: 7573 6564 2069 6e20 7468 6520 6f72 6465  used in the orde
-00045e50: 7220 7072 6f76 6964 6564 2e09 090d 0a09  r provided......
-00045e60: 090d 0a09 0964 7320 3a20 4461 7461 4672  .....ds : DataFr
-00045e70: 616d 652c 206f 7074 696f 6e61 6c0d 0a09  ame, optional...
-00045e80: 0909 6966 204e 6f6e 6520 2844 6566 6175  ..if None (Defau
-00045e90: 6c74 292c 2074 6865 2070 726f 6772 616d  lt), the program
-00045ea0: 2066 6972 7374 2074 6573 7473 2073 656c   first tests sel
-00045eb0: 662e 6473 2061 6e64 2069 6620 7468 6973  f.ds and if this
-00045ec0: 2069 7320 6e6f 7420 7468 6572 6520 7468   is not there th
-00045ed0: 656e 2073 656c 662e 6473 5f6f 7269 2e0d  en self.ds_ori..
-00045ee0: 0a09 0909 5468 6973 206f 7074 696f 6e20  ....This option 
-00045ef0: 7761 7320 696e 7472 6f64 7563 6564 2074  was introduced t
-00045f00: 6f20 616c 6c6f 7720 706c 6f74 7469 6e67  o allow plotting
-00045f10: 206f 6620 6f74 6865 7220 6d61 7472 6978   of other matrix
-00045f20: 6573 2077 6974 6820 7468 6520 7361 6d65  es with the same
-00045f30: 2070 6172 616d 6574 6572 0d0a 0909 090d   parameter......
-00045f40: 0a09 0970 6c6f 745f 6f6e 5f6d 6f76 6520  ...plot_on_move 
-00045f50: 3a20 626f 6f6c 2c20 6f70 7469 6f6e 616c  : bool, optional
-00045f60: 0d0a 0909 0944 6566 6175 6c74 3a20 4661  .....Default: Fa
-00045f70: 6c73 6520 706c 6f74 7320 7468 6520 736c  lse plots the sl
-00045f80: 6963 6573 2061 6674 6572 2063 6c69 636b  ices after click
-00045f90: 2c20 6f6e 2054 7275 6520 7468 6520 706c  , on True the pl
-00045fa0: 6f74 2063 6f6e 7374 616e 746c 7920 7265  ot constantly re
-00045fb0: 736c 6963 6573 2061 6e64 206f 6e20 636c  slices and on cl
-00045fc0: 6963 6b20 0d0a 0909 0954 6865 2063 7572  ick .....The cur
-00045fd0: 7265 6e74 2070 6f73 6974 696f 6e20 6973  rent position is
-00045fe0: 2077 7269 7474 656e 2064 6f77 6e2e 0d0a   written down...
-00045ff0: 0909 090d 0a09 0920 2727 270d 0a09 0966  ....... '''....f
-00046000: 726f 6d20 6d61 7470 6c6f 746c 6962 2e77  rom matplotlib.w
-00046010: 6964 6765 7473 2069 6d70 6f72 7420 4375  idgets import Cu
-00046020: 7273 6f72 0d0a 0909 6966 2063 6d61 7020  rsor....if cmap 
-00046030: 6973 204e 6f6e 653a 636d 6170 3d73 656c  is None:cmap=sel
-00046040: 662e 636d 6170 0d0a 0909 6966 2064 7320  f.cmap....if ds 
-00046050: 6973 204e 6f6e 653a 0d0a 0909 0969 6620  is None:.....if 
-00046060: 6e6f 7420 6669 7474 6564 3a0d 0a09 0909  not fitted:.....
-00046070: 0969 6620 7365 6c66 2e64 7320 6973 204e  .if self.ds is N
-00046080: 6f6e 653a 0d0a 0909 0909 0964 733d 7365  one:.......ds=se
-00046090: 6c66 2e64 735f 6f72 692e 636f 7079 2829  lf.ds_ori.copy()
-000460a0: 0d0a 0909 0909 656c 7365 3a0d 0a09 0909  ......else:.....
-000460b0: 0909 6473 3d73 656c 662e 6473 2e63 6f70  ..ds=self.ds.cop
-000460c0: 7928 290d 0a09 0909 656c 7365 3a0d 0a09  y().....else:...
-000460d0: 0909 0964 733d 7365 6c66 2e72 655b 2741  ...ds=self.re['A
-000460e0: 275d 0d0a 0909 0909 6d6f 6465 6c6c 6564  ']......modelled
-000460f0: 3d73 656c 662e 7265 5b27 4143 275d 0d0a  =self.re['AC']..
-00046100: 0909 696e 7465 6e73 6974 795f 7261 6e67  ..intensity_rang
-00046110: 653d 7365 6c66 2e69 6e74 656e 7369 7479  e=self.intensity
-00046120: 5f72 616e 6765 0d0a 0909 6966 2069 6e74  _range....if int
-00046130: 656e 7369 7479 5f72 616e 6765 2069 7320  ensity_range is 
-00046140: 4e6f 6e65 3a0d 0a09 0909 7472 793a 0d0a  None:.....try:..
-00046150: 0909 0909 6d61 7869 6d3d 6d61 7828 5b61  ....maxim=max([a
-00046160: 6273 2864 732e 7661 6c75 6573 2e6d 696e  bs(ds.values.min
-00046170: 2829 292c 6162 7328 6473 2e76 616c 7565  ()),abs(ds.value
-00046180: 732e 6d61 7828 2929 5d29 0d0a 0909 0909  s.max())])......
-00046190: 696e 7465 6e73 6974 795f 7261 6e67 653d  intensity_range=
-000461a0: 5b2d 6d61 7869 6d2c 6d61 7869 6d5d 0d0a  [-maxim,maxim]..
-000461b0: 0909 0965 7863 6570 743a 0d0a 0909 0909  ...except:......
-000461c0: 696e 7465 6e73 6974 795f 7261 6e67 653d  intensity_range=
-000461d0: 5b2d 3165 2d32 2c31 652d 325d 0d0a 0909  [-1e-2,1e-2]....
-000461e0: 656c 7365 3a0d 0a09 0909 6966 206e 6f74  else:.....if not
-000461f0: 2068 6173 6174 7472 2869 6e74 656e 7369   hasattr(intensi
-00046200: 7479 5f72 616e 6765 2c27 5f5f 6974 6572  ty_range,'__iter
-00046210: 5f5f 2729 3a23 6c65 7473 2068 6176 6520  __'):#lets have 
-00046220: 616e 206c 617a 7920 6f70 7469 6f6e 0d0a  an lazy option..
-00046230: 0909 0909 696e 7465 6e73 6974 795f 7261  ....intensity_ra
-00046240: 6e67 653d 5b2d 696e 7465 6e73 6974 795f  nge=[-intensity_
-00046250: 7261 6e67 652c 696e 7465 6e73 6974 795f  range,intensity_
-00046260: 7261 6e67 655d 0d0a 0909 636c 6173 7320  range]....class 
-00046270: 4d6f 7573 654d 6f76 653a 0d0a 0909 0923  MouseMove:.....#
-00046280: 2069 6e69 7469 616c 697a 6174 696f 6e0d   initialization.
-00046290: 0a09 0909 6465 6620 5f5f 696e 6974 5f5f  ....def __init__
-000462a0: 2873 656c 662c 2064 732c 2063 6d61 702c  (self, ds, cmap,
-000462b0: 2069 6e74 656e 7369 7479 5f72 616e 6765   intensity_range
-000462c0: 2c20 6c6f 675f 7363 616c 652c 2062 6173  , log_scale, bas
-000462d0: 6575 6e69 742c 200d 0a09 0909 0909 0909  eunit, .........
-000462e0: 7469 6d65 6c69 6d69 7473 2c20 7363 6174  timelimits, scat
-000462f0: 7465 7263 7574 2c20 626f 7264 6572 6375  tercut, bordercu
-00046300: 742c 2077 6176 655f 6e6d 5f62 696e 2c20  t, wave_nm_bin, 
-00046310: 6571 7561 6c5f 656e 6572 6779 5f62 696e  equal_energy_bin
-00046320: 2c20 6967 6e6f 7265 5f74 696d 655f 7265  , ignore_time_re
-00046330: 6769 6f6e 2c0d 0a09 0909 0909 0909 7469  gion,.........ti
-00046340: 6d65 5f62 696e 2c20 6c69 6e74 7265 7368  me_bin, lintresh
-00046350: 2c20 6461 7461 5f74 7970 652c 2077 6964  , data_type, wid
-00046360: 7468 2c20 7469 6d65 5f77 6964 7468 5f70  th, time_width_p
-00046370: 6572 6365 6e74 293a 0d0a 0909 0909 6669  ercent):......fi
-00046380: 6720 3d20 706c 742e 6669 6775 7265 2874  g = plt.figure(t
-00046390: 6967 6874 5f6c 6179 6f75 743d 5472 7565  ight_layout=True
-000463a0: 2c66 6967 7369 7a65 3d28 3134 2c38 2929  ,figsize=(14,8))
-000463b0: 0d0a 0909 0909 6773 203d 2047 7269 6453  ......gs = GridS
-000463c0: 7065 6328 352c 2034 290d 0a09 0909 0973  pec(5, 4)......s
-000463d0: 656c 662e 6178 3d20 6669 672e 6164 645f  elf.ax= fig.add_
-000463e0: 7375 6270 6c6f 7428 6773 5b31 3a2c 203a  subplot(gs[1:, :
-000463f0: 335d 290d 0a09 0909 0973 656c 662e 6473  3])......self.ds
-00046400: 3d64 730d 0a09 0909 0973 656c 662e 636d  =ds......self.cm
-00046410: 6170 3d63 6d61 700d 0a09 0909 0973 656c  ap=cmap......sel
-00046420: 662e 696e 7465 6e73 6974 795f 7261 6e67  f.intensity_rang
-00046430: 653d 696e 7465 6e73 6974 795f 7261 6e67  e=intensity_rang
-00046440: 650d 0a09 0909 0973 656c 662e 6c6f 675f  e......self.log_
-00046450: 7363 616c 653d 6c6f 675f 7363 616c 650d  scale=log_scale.
-00046460: 0a09 0909 0973 656c 662e 6261 7365 756e  .....self.baseun
-00046470: 6974 3d62 6173 6575 6e69 740d 0a09 0909  it=baseunit.....
-00046480: 0973 656c 662e 7469 6d65 6c69 6d69 7473  .self.timelimits
-00046490: 3d74 696d 656c 696d 6974 730d 0a09 0909  =timelimits.....
-000464a0: 0973 656c 662e 7363 6174 7465 7263 7574  .self.scattercut
-000464b0: 3d73 6361 7474 6572 6375 740d 0a09 0909  =scattercut.....
-000464c0: 0973 656c 662e 626f 7264 6572 6375 743d  .self.bordercut=
-000464d0: 626f 7264 6572 6375 740d 0a09 0909 0973  bordercut......s
-000464e0: 656c 662e 7761 7665 5f6e 6d5f 6269 6e3d  elf.wave_nm_bin=
-000464f0: 7761 7665 5f6e 6d5f 6269 6e0d 0a09 0909  wave_nm_bin.....
-00046500: 0973 656c 662e 6571 7561 6c5f 656e 6572  .self.equal_ener
-00046510: 6779 5f62 696e 3d65 7175 616c 5f65 6e65  gy_bin=equal_ene
-00046520: 7267 795f 6269 6e0d 0a09 0909 0973 656c  rgy_bin......sel
-00046530: 662e 6967 6e6f 7265 5f74 696d 655f 7265  f.ignore_time_re
-00046540: 6769 6f6e 3d69 676e 6f72 655f 7469 6d65  gion=ignore_time
-00046550: 5f72 6567 696f 6e0d 0a09 0909 0973 656c  _region......sel
-00046560: 662e 7469 6d65 5f62 696e 3d74 696d 655f  f.time_bin=time_
-00046570: 6269 6e0d 0a09 0909 0973 656c 662e 6461  bin......self.da
-00046580: 7461 5f74 7970 653d 6461 7461 5f74 7970  ta_type=data_typ
-00046590: 650d 0a09 0909 0973 656c 662e 7769 6474  e......self.widt
-000465a0: 683d 7769 6474 680d 0a09 0909 0973 656c  h=width......sel
-000465b0: 662e 6c69 6e74 7265 7368 3d6c 696e 7472  f.lintresh=lintr
-000465c0: 6573 680d 0a09 0909 0973 656c 662e 7469  esh......self.ti
-000465d0: 6d65 5f77 6964 7468 5f70 6572 6365 6e74  me_width_percent
-000465e0: 3d74 696d 655f 7769 6474 685f 7065 7263  =time_width_perc
-000465f0: 656e 740d 0a09 0909 090d 0a09 0909 090d  ent.............
-00046600: 0a09 0909 0973 656c 662e 6178 203d 2070  .....self.ax = p
-00046610: 6c6f 7432 6428 6473 3d64 732c 2061 783d  lot2d(ds=ds, ax=
-00046620: 7365 6c66 2e61 782c 2063 6d61 703d 636d  self.ax, cmap=cm
-00046630: 6170 2c20 696e 7465 6e73 6974 795f 7261  ap, intensity_ra
-00046640: 6e67 653d 7365 6c66 2e69 6e74 656e 7369  nge=self.intensi
-00046650: 7479 5f72 616e 6765 2c20 0d0a 0909 0909  ty_range, ......
-00046660: 096c 6f67 5f73 6361 6c65 3d73 656c 662e  .log_scale=self.
-00046670: 6c6f 675f 7363 616c 652c 2062 6173 6575  log_scale, baseu
-00046680: 6e69 743d 7365 6c66 2e62 6173 6575 6e69  nit=self.baseuni
-00046690: 742c 2074 696d 656c 696d 6974 733d 7365  t, timelimits=se
-000466a0: 6c66 2e74 696d 656c 696d 6974 732c 200d  lf.timelimits, .
-000466b0: 0a09 0909 0909 7363 6174 7465 7263 7574  ......scattercut
-000466c0: 3d73 656c 662e 7363 6174 7465 7263 7574  =self.scattercut
-000466d0: 2c20 626f 7264 6572 6375 743d 7365 6c66  , bordercut=self
-000466e0: 2e62 6f72 6465 7263 7574 2c20 7761 7665  .bordercut, wave
-000466f0: 5f6e 6d5f 6269 6e3d 7365 6c66 2e77 6176  _nm_bin=self.wav
-00046700: 655f 6e6d 5f62 696e 2c20 6571 7561 6c5f  e_nm_bin, equal_
-00046710: 656e 6572 6779 5f62 696e 3d73 656c 662e  energy_bin=self.
-00046720: 6571 7561 6c5f 656e 6572 6779 5f62 696e  equal_energy_bin
-00046730: 2c0d 0a09 0909 0909 6967 6e6f 7265 5f74  ,.......ignore_t
-00046740: 696d 655f 7265 6769 6f6e 3d73 656c 662e  ime_region=self.
-00046750: 6967 6e6f 7265 5f74 696d 655f 7265 6769  ignore_time_regi
-00046760: 6f6e 2c20 7469 6d65 5f62 696e 3d73 656c  on, time_bin=sel
-00046770: 662e 7469 6d65 5f62 696e 2c20 0d0a 0909  f.time_bin, ....
-00046780: 0909 096c 696e 7472 6573 683d 7365 6c66  ...lintresh=self
-00046790: 2e6c 696e 7472 6573 682c 2064 6174 615f  .lintresh, data_
-000467a0: 7479 7065 203d 2073 656c 662e 6461 7461  type = self.data
-000467b0: 5f74 7970 652c 2075 7365 5f63 6f6c 6f72  _type, use_color
-000467c0: 6261 7220 3d20 4661 6c73 6529 0d0a 0909  bar = False)....
-000467d0: 0909 7365 6c66 2e61 785f 7469 6d65 3d20  ..self.ax_time= 
-000467e0: 6669 672e 6164 645f 7375 6270 6c6f 7428  fig.add_subplot(
-000467f0: 6773 5b30 2c20 3a33 5d2c 7368 6172 6578  gs[0, :3],sharex
-00046800: 3d73 656c 662e 6178 290d 0a09 0909 0973  =self.ax)......s
-00046810: 656c 662e 6178 5f6b 696e 6574 6963 3d20  elf.ax_kinetic= 
-00046820: 6669 672e 6164 645f 7375 6270 6c6f 7428  fig.add_subplot(
-00046830: 6773 5b31 3a2c 202d 315d 2c73 6861 7265  gs[1:, -1],share
-00046840: 793d 7365 6c66 2e61 7829 0d0a 0909 0909  y=self.ax)......
-00046850: 706c 742e 7375 6270 6c6f 7473 5f61 646a  plt.subplots_adj
-00046860: 7573 7428 7773 7061 6365 3d30 2c68 7370  ust(wspace=0,hsp
-00046870: 6163 653d 3029 0d0a 0909 0909 6966 2070  ace=0)......if p
-00046880: 6c6f 745f 6f6e 5f6d 6f76 653a 0d0a 0909  lot_on_move:....
-00046890: 0909 0966 6967 2e63 616e 7661 732e 6d70  ...fig.canvas.mp
-000468a0: 6c5f 636f 6e6e 6563 7428 276d 6f74 696f  l_connect('motio
-000468b0: 6e5f 6e6f 7469 6679 5f65 7665 6e74 272c  n_notify_event',
-000468c0: 2073 656c 662e 6d6f 7665 290d 0a09 0909   self.move).....
-000468d0: 0909 6669 672e 6361 6e76 6173 2e6d 706c  ..fig.canvas.mpl
-000468e0: 5f63 6f6e 6e65 6374 2827 6275 7474 6f6e  _connect('button
-000468f0: 5f70 7265 7373 5f65 7665 6e74 272c 2073  _press_event', s
-00046900: 656c 662e 636c 6963 6b29 0d0a 0909 0909  elf.click)......
-00046910: 656c 7365 3a0d 0a09 0909 0909 6669 672e  else:.......fig.
-00046920: 6361 6e76 6173 2e6d 706c 5f63 6f6e 6e65  canvas.mpl_conne
-00046930: 6374 2827 6275 7474 6f6e 5f70 7265 7373  ct('button_press
-00046940: 5f65 7665 6e74 272c 2073 656c 662e 6d6f  _event', self.mo
-00046950: 7665 290d 0a09 0909 0d0a 0909 0964 6566  ve)..........def
-00046960: 2063 6c69 636b 2873 656c 662c 2065 7665   click(self, eve
-00046970: 6e74 293a 0d0a 0909 0909 0d0a 0909 0909  nt):............
-00046980: 782c 2079 203d 2065 7665 6e74 2e78 6461  x, y = event.xda
-00046990: 7461 2c20 6576 656e 742e 7964 6174 610d  ta, event.ydata.
-000469a0: 0a09 0909 0969 6620 7365 6c66 2e65 7175  .....if self.equ
-000469b0: 616c 5f65 6e65 7267 795f 6269 6e20 6973  al_energy_bin is
-000469c0: 206e 6f74 204e 6f6e 653a 0d0a 0909 0909   not None:......
-000469d0: 0978 3d73 6369 7079 2e63 6f6e 7374 616e  .x=scipy.constan
-000469e0: 7473 2e68 2a73 6369 7079 2e63 6f6e 7374  ts.h*scipy.const
-000469f0: 616e 7473 2e63 2f28 782a 3165 2d39 2a73  ants.c/(x*1e-9*s
-00046a00: 6369 7079 2e63 6f6e 7374 616e 7473 2e65  cipy.constants.e
-00046a10: 6c65 6374 726f 6e5f 766f 6c74 2920 0d0a  lectron_volt) ..
-00046a20: 0909 0909 7072 696e 7428 2778 3d25 672c  ....print('x=%g,
-00046a30: 2079 3d25 675c 6e27 2528 782c 7929 290d   y=%g\n'%(x,y)).
-00046a40: 0a09 0909 0d0a 0909 0964 6566 206d 6f76  .........def mov
-00046a50: 6528 7365 6c66 2c20 6576 656e 7429 3a0d  e(self, event):.
-00046a60: 0a09 0909 0978 2c20 7920 3d20 6576 656e  .....x, y = even
-00046a70: 742e 7864 6174 612c 2065 7665 6e74 2e79  t.xdata, event.y
-00046a80: 6461 7461 0d0a 0909 0909 6966 2073 656c  data......if sel
-00046a90: 662e 6571 7561 6c5f 656e 6572 6779 5f62  f.equal_energy_b
-00046aa0: 696e 2069 7320 6e6f 7420 4e6f 6e65 3a0d  in is not None:.
-00046ab0: 0a09 0909 0909 783d 7363 6970 792e 636f  ......x=scipy.co
-00046ac0: 6e73 7461 6e74 732e 682a 7363 6970 792e  nstants.h*scipy.
-00046ad0: 636f 6e73 7461 6e74 732e 632f 2878 2a31  constants.c/(x*1
-00046ae0: 652d 392a 7363 6970 792e 636f 6e73 7461  e-9*scipy.consta
-00046af0: 6e74 732e 656c 6563 7472 6f6e 5f76 6f6c  nts.electron_vol
-00046b00: 7429 200d 0a09 0909 0974 7279 3a0d 0a09  t) ......try:...
-00046b10: 0909 0909 7365 6c66 2e61 785f 7469 6d65  ....self.ax_time
-00046b20: 2e63 6c61 2829 0d0a 0909 0909 6578 6365  .cla()......exce
-00046b30: 7074 3a0d 0a09 0909 0909 7061 7373 0d0a  pt:.......pass..
-00046b40: 0909 0909 090d 0a09 0909 0969 6620 6e6f  ...........if no
-00046b50: 7420 6669 7474 6564 3a09 0d0a 0909 0909  t fitted:.......
-00046b60: 0964 735f 7465 6d70 3120 3d20 7375 625f  .ds_temp1 = sub_
-00046b70: 6473 2864 7320 3d20 4672 616d 655f 676f  ds(ds = Frame_go
-00046b80: 6c61 7928 6473 2c35 2c33 292c 2074 696d  lay(ds,5,3), tim
-00046b90: 6573 203d 2079 2c20 7469 6d65 5f77 6964  es = y, time_wid
-00046ba0: 7468 5f70 6572 6365 6e74 203d 2073 656c  th_percent = sel
-00046bb0: 662e 7469 6d65 5f77 6964 7468 5f70 6572  f.time_width_per
-00046bc0: 6365 6e74 2c20 0d0a 0909 0909 0909 0909  cent, ..........
-00046bd0: 0973 6361 7474 6572 6375 7420 3d20 7365  .scattercut = se
-00046be0: 6c66 2e73 6361 7474 6572 6375 742c 2064  lf.scattercut, d
-00046bf0: 726f 705f 7363 6174 7465 723d 5472 7565  rop_scatter=True
-00046c00: 2c20 626f 7264 6572 6375 7420 3d20 7365  , bordercut = se
-00046c10: 6c66 2e62 6f72 6465 7263 7574 2c20 0d0a  lf.bordercut, ..
-00046c20: 0909 0909 0909 0909 0969 676e 6f72 655f  .........ignore_
-00046c30: 7469 6d65 5f72 6567 696f 6e20 3d20 7365  time_region = se
-00046c40: 6c66 2e69 676e 6f72 655f 7469 6d65 5f72  lf.ignore_time_r
-00046c50: 6567 696f 6e2c 2077 6176 655f 6e6d 5f62  egion, wave_nm_b
-00046c60: 696e 203d 2073 656c 662e 7761 7665 5f6e  in = self.wave_n
-00046c70: 6d5f 6269 6e2c 2065 7175 616c 5f65 6e65  m_bin, equal_ene
-00046c80: 7267 795f 6269 6e3d 7365 6c66 2e65 7175  rgy_bin=self.equ
-00046c90: 616c 5f65 6e65 7267 795f 6269 6e2c 0d0a  al_energy_bin,..
-00046ca0: 0909 0909 0909 0909 0977 6176 656c 656e  .........wavelen
-00046cb0: 6774 685f 6269 6e20 3d20 7365 6c66 2e77  gth_bin = self.w
-00046cc0: 6964 7468 290d 0a09 0909 0909 6473 5f74  idth).......ds_t
-00046cd0: 656d 7031 2e70 6c6f 7428 6178 3d73 656c  emp1.plot(ax=sel
-00046ce0: 662e 6178 5f74 696d 652c 7374 796c 653d  f.ax_time,style=
-00046cf0: 272d 272c 636f 6c6f 723d 2772 6564 2729  '-',color='red')
-00046d00: 0d0a 0909 0909 090d 0a09 0909 0965 6c73  .............els
-00046d10: 653a 0d0a 0909 0909 0964 735f 7465 6d70  e:.......ds_temp
-00046d20: 3120 3d20 7375 625f 6473 2864 7320 3d20  1 = sub_ds(ds = 
-00046d30: 6d6f 6465 6c6c 6564 2c20 7469 6d65 7320  modelled, times 
-00046d40: 3d20 792c 2074 696d 655f 7769 6474 685f  = y, time_width_
-00046d50: 7065 7263 656e 7420 3d20 7365 6c66 2e74  percent = self.t
-00046d60: 696d 655f 7769 6474 685f 7065 7263 656e  ime_width_percen
-00046d70: 742c 200d 0a09 0909 0909 0909 0909 7363  t, ...........sc
-00046d80: 6174 7465 7263 7574 203d 2073 656c 662e  attercut = self.
-00046d90: 7363 6174 7465 7263 7574 2c20 6472 6f70  scattercut, drop
-00046da0: 5f73 6361 7474 6572 3d54 7275 652c 2062  _scatter=True, b
-00046db0: 6f72 6465 7263 7574 203d 2073 656c 662e  ordercut = self.
-00046dc0: 626f 7264 6572 6375 742c 200d 0a09 0909  bordercut, .....
-00046dd0: 0909 0909 0909 6967 6e6f 7265 5f74 696d  ......ignore_tim
-00046de0: 655f 7265 6769 6f6e 203d 2073 656c 662e  e_region = self.
-00046df0: 6967 6e6f 7265 5f74 696d 655f 7265 6769  ignore_time_regi
-00046e00: 6f6e 2c20 7761 7665 5f6e 6d5f 6269 6e20  on, wave_nm_bin 
-00046e10: 3d20 7365 6c66 2e77 6176 655f 6e6d 5f62  = self.wave_nm_b
-00046e20: 696e 2c20 2065 7175 616c 5f65 6e65 7267  in,  equal_energ
-00046e30: 795f 6269 6e3d 7365 6c66 2e65 7175 616c  y_bin=self.equal
-00046e40: 5f65 6e65 7267 795f 6269 6e2c 0d0a 0909  _energy_bin,....
-00046e50: 0909 0909 0909 0977 6176 656c 656e 6774  .......wavelengt
-00046e60: 685f 6269 6e20 3d20 7365 6c66 2e77 6964  h_bin = self.wid
-00046e70: 7468 290d 0a09 0909 0909 6473 5f74 656d  th).......ds_tem
-00046e80: 7031 2e70 6c6f 7428 6178 3d73 656c 662e  p1.plot(ax=self.
-00046e90: 6178 5f74 696d 652c 7374 796c 653d 272d  ax_time,style='-
-00046ea0: 272c 636f 6c6f 723d 2772 6564 2729 0d0a  ',color='red')..
-00046eb0: 0909 0909 090d 0a09 0909 0964 735f 7465  ...........ds_te
-00046ec0: 6d70 203d 2073 7562 5f64 7328 6473 203d  mp = sub_ds(ds =
-00046ed0: 2064 732c 2074 696d 6573 203d 2079 2c20   ds, times = y, 
-00046ee0: 7469 6d65 5f77 6964 7468 5f70 6572 6365  time_width_perce
-00046ef0: 6e74 203d 2073 656c 662e 7469 6d65 5f77  nt = self.time_w
-00046f00: 6964 7468 5f70 6572 6365 6e74 2c20 0d0a  idth_percent, ..
-00046f10: 0909 0909 0909 0909 0973 6361 7474 6572  .........scatter
-00046f20: 6375 7420 3d20 7365 6c66 2e73 6361 7474  cut = self.scatt
-00046f30: 6572 6375 742c 2064 726f 705f 7363 6174  ercut, drop_scat
-00046f40: 7465 723d 5472 7565 2c20 626f 7264 6572  ter=True, border
-00046f50: 6375 7420 3d20 7365 6c66 2e62 6f72 6465  cut = self.borde
-00046f60: 7263 7574 2c20 0d0a 0909 0909 0909 0909  rcut, ..........
-00046f70: 0969 676e 6f72 655f 7469 6d65 5f72 6567  .ignore_time_reg
-00046f80: 696f 6e20 3d20 7365 6c66 2e69 676e 6f72  ion = self.ignor
-00046f90: 655f 7469 6d65 5f72 6567 696f 6e2c 2077  e_time_region, w
-00046fa0: 6176 655f 6e6d 5f62 696e 203d 2073 656c  ave_nm_bin = sel
-00046fb0: 662e 7761 7665 5f6e 6d5f 6269 6e2c 2020  f.wave_nm_bin,  
-00046fc0: 6571 7561 6c5f 656e 6572 6779 5f62 696e  equal_energy_bin
-00046fd0: 3d73 656c 662e 6571 7561 6c5f 656e 6572  =self.equal_ener
-00046fe0: 6779 5f62 696e 2c0d 0a09 0909 0909 0909  gy_bin,.........
-00046ff0: 0909 7761 7665 6c65 6e67 7468 5f62 696e  ..wavelength_bin
-00047000: 203d 2073 656c 662e 7769 6474 6829 0d0a   = self.width)..
-00047010: 0909 0909 6473 5f74 656d 702e 706c 6f74  ....ds_temp.plot
-00047020: 2861 783d 7365 6c66 2e61 785f 7469 6d65  (ax=self.ax_time
-00047030: 2c73 7479 6c65 3d27 2a27 2c63 6f6c 6f72  ,style='*',color
-00047040: 3d27 626c 6163 6b27 290d 0a09 0909 0973  ='black')......s
-00047050: 656c 662e 6178 5f74 696d 652e 706c 6f74  elf.ax_time.plot
-00047060: 2873 656c 662e 6178 5f74 696d 652e 6765  (self.ax_time.ge
-00047070: 745f 786c 696d 2829 2c5b 302c 305d 2c27  t_xlim(),[0,0],'
-00047080: 6772 6179 2729 0d0a 0909 0909 6966 206e  gray')......if n
-00047090: 6f74 2066 6974 7465 643a 0d0a 0909 0909  ot fitted:......
-000470a0: 0973 656c 662e 6178 5f74 696d 652e 6c65  .self.ax_time.le
-000470b0: 6765 6e64 285b 2725 2e33 6720 2573 2073  gend(['%.3g %s s
-000470c0: 6d6f 6f74 6865 6427 2528 792c 7365 6c66  moothed'%(y,self
-000470d0: 2e62 6173 6575 6e69 7429 5d29 0d0a 0909  .baseunit)])....
-000470e0: 0909 656c 7365 3a0d 0a09 0909 0909 7365  ..else:.......se
-000470f0: 6c66 2e61 785f 7469 6d65 2e6c 6567 656e  lf.ax_time.legen
-00047100: 6428 5b27 252e 3367 2025 7320 6669 7474  d(['%.3g %s fitt
-00047110: 6564 2725 2879 2c73 656c 662e 6261 7365  ed'%(y,self.base
-00047120: 756e 6974 295d 290d 0a09 0909 0973 656c  unit)])......sel
-00047130: 662e 6178 5f74 696d 652e 7365 745f 7974  f.ax_time.set_yt
-00047140: 6963 6b73 2873 656c 662e 6178 5f74 696d  icks(self.ax_tim
-00047150: 652e 6765 745f 796c 696d 2829 290d 0a09  e.get_ylim())...
-00047160: 0909 0973 656c 662e 6178 5f74 696d 652e  ...self.ax_time.
-00047170: 7365 745f 7974 6963 6b6c 6162 656c 7328  set_yticklabels(
-00047180: 5b27 252e 3165 2725 6620 666f 7220 6620  ['%.1e'%f for f 
-00047190: 696e 2073 656c 662e 6178 5f74 696d 652e  in self.ax_time.
-000471a0: 6765 745f 796c 696d 2829 5d29 0d0a 0909  get_ylim()])....
-000471b0: 0909 0d0a 0909 0909 666f 7220 6920 696e  ........for i in
-000471c0: 2072 616e 6765 2833 293a 0d0a 0909 0909   range(3):......
-000471d0: 0974 7279 3a0d 0a09 0909 0909 0973 656c  .try:........sel
-000471e0: 662e 6178 5f6b 696e 6574 6963 2e6c 696e  f.ax_kinetic.lin
-000471f0: 6573 2e70 6f70 2830 290d 0a09 0909 0909  es.pop(0).......
-00047200: 6578 6365 7074 3a0d 0a09 0909 0909 0970  except:........p
-00047210: 6173 730d 0a09 0909 0969 6620 7365 6c66  ass......if self
-00047220: 2e77 6964 7468 2069 7320 4e6f 6e65 3a0d  .width is None:.
-00047230: 0a09 0909 0909 7365 6c66 2e77 6964 7468  ......self.width
-00047240: 203d 2031 300d 0a09 0909 090d 0a09 0909   = 10...........
-00047250: 0969 6620 6e6f 7420 6669 7474 6564 3a0d  .if not fitted:.
-00047260: 0a09 0909 0909 6473 5f74 656d 7031 203d  ......ds_temp1 =
-00047270: 2073 7562 5f64 7328 6473 203d 2046 7261   sub_ds(ds = Fra
-00047280: 6d65 5f67 6f6c 6179 2864 7329 2c20 7761  me_golay(ds), wa
-00047290: 7665 6c65 6e67 7468 203d 2078 2c20 7363  velength = x, sc
-000472a0: 6174 7465 7263 7574 203d 2073 656c 662e  attercut = self.
-000472b0: 7363 6174 7465 7263 7574 2c20 6472 6f70  scattercut, drop
-000472c0: 5f73 6361 7474 6572 3d54 7275 652c 200d  _scatter=True, .
-000472d0: 0a09 0909 0909 0909 0962 6f72 6465 7263  .........borderc
-000472e0: 7574 203d 2073 656c 662e 626f 7264 6572  ut = self.border
-000472f0: 6375 742c 2069 676e 6f72 655f 7469 6d65  cut, ignore_time
-00047300: 5f72 6567 696f 6e20 3d20 7365 6c66 2e69  _region = self.i
-00047310: 676e 6f72 655f 7469 6d65 5f72 6567 696f  gnore_time_regio
-00047320: 6e2c 200d 0a09 0909 0909 0909 0977 6176  n, ..........wav
-00047330: 655f 6e6d 5f62 696e 203d 2073 656c 662e  e_nm_bin = self.
-00047340: 7761 7665 5f6e 6d5f 6269 6e2c 7761 7665  wave_nm_bin,wave
-00047350: 6c65 6e67 7468 5f62 696e 203d 2073 656c  length_bin = sel
-00047360: 662e 7769 6474 6829 0d0a 0909 0909 0973  f.width).......s
-00047370: 656c 662e 6178 5f6b 696e 6574 6963 2e70  elf.ax_kinetic.p
-00047380: 6c6f 7428 6473 5f74 656d 7031 2e76 616c  lot(ds_temp1.val
-00047390: 7565 732c 6473 5f74 656d 7031 2e69 6e64  ues,ds_temp1.ind
-000473a0: 6578 2e76 616c 7565 732c 272d 272c 6c61  ex.values,'-',la
-000473b0: 6265 6c3d 2725 2e30 6620 736d 6f6f 7468  bel='%.0f smooth
-000473c0: 6564 2725 782c 636f 6c6f 723d 2772 6564  ed'%x,color='red
-000473d0: 2729 0d0a 0909 0909 656c 7365 3a0d 0a09  ')......else:...
-000473e0: 0909 0909 6473 5f74 656d 7031 203d 2073  ....ds_temp1 = s
-000473f0: 7562 5f64 7328 6473 203d 206d 6f64 656c  ub_ds(ds = model
-00047400: 6c65 642c 2077 6176 656c 656e 6774 6820  led, wavelength 
-00047410: 3d20 782c 2073 6361 7474 6572 6375 7420  = x, scattercut 
-00047420: 3d20 7365 6c66 2e73 6361 7474 6572 6375  = self.scattercu
-00047430: 742c 2064 726f 705f 7363 6174 7465 723d  t, drop_scatter=
-00047440: 5472 7565 2c20 0d0a 0909 0909 0909 0909  True, ..........
-00047450: 626f 7264 6572 6375 7420 3d20 7365 6c66  bordercut = self
-00047460: 2e62 6f72 6465 7263 7574 2c20 6967 6e6f  .bordercut, igno
-00047470: 7265 5f74 696d 655f 7265 6769 6f6e 203d  re_time_region =
-00047480: 2073 656c 662e 6967 6e6f 7265 5f74 696d   self.ignore_tim
-00047490: 655f 7265 6769 6f6e 2c20 0d0a 0909 0909  e_region, ......
-000474a0: 0909 0909 7761 7665 5f6e 6d5f 6269 6e20  ....wave_nm_bin 
-000474b0: 3d20 7365 6c66 2e77 6176 655f 6e6d 5f62  = self.wave_nm_b
-000474c0: 696e 2c20 7761 7665 6c65 6e67 7468 5f62  in, wavelength_b
-000474d0: 696e 203d 2073 656c 662e 7769 6474 6829  in = self.width)
-000474e0: 0d0a 0909 0909 0973 656c 662e 6178 5f6b  .......self.ax_k
-000474f0: 696e 6574 6963 2e70 6c6f 7428 6473 5f74  inetic.plot(ds_t
-00047500: 656d 7031 2e76 616c 7565 732c 6473 5f74  emp1.values,ds_t
-00047510: 656d 7031 2e69 6e64 6578 2e76 616c 7565  emp1.index.value
-00047520: 732c 272d 272c 6c61 6265 6c3d 2725 2e30  s,'-',label='%.0
-00047530: 6620 6669 7474 6564 2725 782c 636f 6c6f  f fitted'%x,colo
-00047540: 723d 2772 6564 2729 0d0a 0909 0909 0d0a  r='red')........
-00047550: 0909 0909 6473 5f74 656d 7020 3d20 7375  ....ds_temp = su
-00047560: 625f 6473 2864 7320 3d20 6473 2c20 7761  b_ds(ds = ds, wa
-00047570: 7665 6c65 6e67 7468 203d 2078 2c20 7363  velength = x, sc
-00047580: 6174 7465 7263 7574 203d 2073 656c 662e  attercut = self.
-00047590: 7363 6174 7465 7263 7574 2c20 6472 6f70  scattercut, drop
-000475a0: 5f73 6361 7474 6572 3d54 7275 652c 200d  _scatter=True, .
-000475b0: 0a09 0909 0909 0909 0962 6f72 6465 7263  .........borderc
-000475c0: 7574 203d 2073 656c 662e 626f 7264 6572  ut = self.border
-000475d0: 6375 742c 2069 676e 6f72 655f 7469 6d65  cut, ignore_time
-000475e0: 5f72 6567 696f 6e20 3d20 7365 6c66 2e69  _region = self.i
-000475f0: 676e 6f72 655f 7469 6d65 5f72 6567 696f  gnore_time_regio
-00047600: 6e2c 200d 0a09 0909 0909 0909 0977 6176  n, ..........wav
-00047610: 655f 6e6d 5f62 696e 203d 2073 656c 662e  e_nm_bin = self.
-00047620: 7761 7665 5f6e 6d5f 6269 6e2c 2077 6176  wave_nm_bin, wav
-00047630: 656c 656e 6774 685f 6269 6e20 3d20 7365  elength_bin = se
-00047640: 6c66 2e77 6964 7468 290d 0a09 0909 090d  lf.width).......
-00047650: 0a09 0909 0973 656c 662e 6178 5f6b 696e  .....self.ax_kin
-00047660: 6574 6963 2e73 6574 5f78 6c69 6d28 6d69  etic.set_xlim(mi
-00047670: 6e28 5b30 2c6d 696e 2864 735f 7465 6d70  n([0,min(ds_temp
-00047680: 2e76 616c 7565 7329 5d29 2c6d 6178 285b  .values)]),max([
-00047690: 6d61 7828 6473 5f74 656d 702e 7661 6c75  max(ds_temp.valu
-000476a0: 6573 292c 305d 2929 0d0a 0d0a 0909 0909  es),0]))........
-000476b0: 7365 6c66 2e61 785f 6b69 6e65 7469 632e  self.ax_kinetic.
-000476c0: 706c 6f74 2864 735f 7465 6d70 2e76 616c  plot(ds_temp.val
-000476d0: 7565 732c 6473 5f74 656d 702e 696e 6465  ues,ds_temp.inde
-000476e0: 782e 7661 6c75 6573 2c27 2a27 2c6c 6162  x.values,'*',lab
-000476f0: 656c 3d27 252e 3066 2725 782c 2063 6f6c  el='%.0f'%x, col
-00047700: 6f72 3d27 626c 6163 6b27 290d 0a09 0909  or='black').....
-00047710: 0973 656c 662e 6178 5f6b 696e 6574 6963  .self.ax_kinetic
-00047720: 2e70 6c6f 7428 5b30 2c30 5d2c 7365 6c66  .plot([0,0],self
-00047730: 2e61 785f 6b69 6e65 7469 632e 6765 745f  .ax_kinetic.get_
-00047740: 796c 696d 2829 2c27 6772 6179 2729 0d0a  ylim(),'gray')..
-00047750: 0909 0909 7365 6c66 2e61 785f 6b69 6e65  ....self.ax_kine
-00047760: 7469 632e 6c65 6765 6e64 285b 2725 2e30  tic.legend(['%.0
-00047770: 6627 2578 5d29 0909 0909 0d0a 0909 0909  f'%x])..........
-00047780: 7365 6c66 2e61 785f 6b69 6e65 7469 632e  self.ax_kinetic.
-00047790: 7365 745f 7874 6963 6b73 2873 656c 662e  set_xticks(self.
-000477a0: 6178 5f6b 696e 6574 6963 2e67 6574 5f78  ax_kinetic.get_x
-000477b0: 6c69 6d28 2929 0d0a 0909 0909 7365 6c66  lim())......self
-000477c0: 2e61 785f 6b69 6e65 7469 632e 7365 745f  .ax_kinetic.set_
-000477d0: 7874 6963 6b6c 6162 656c 7328 5b27 252e  xticklabels(['%.
-000477e0: 3165 2725 6620 666f 7220 6620 696e 2073  1e'%f for f in s
-000477f0: 656c 662e 6178 5f6b 696e 6574 6963 2e67  elf.ax_kinetic.g
-00047800: 6574 5f78 6c69 6d28 295d 290d 0a09 0909  et_xlim()]).....
-00047810: 0973 656c 662e 6178 5f6b 696e 6574 6963  .self.ax_kinetic
-00047820: 2e73 6574 5f79 7469 636b 6c61 6265 6c73  .set_yticklabels
-00047830: 2873 656c 662e 6178 2e67 6574 5f79 7469  (self.ax.get_yti
-00047840: 636b 6c61 6265 6c73 2829 290d 0a09 0909  cklabels()).....
-00047850: 0970 6c74 2e73 7562 706c 6f74 735f 6164  .plt.subplots_ad
-00047860: 6a75 7374 2877 7370 6163 653d 302c 6873  just(wspace=0,hs
-00047870: 7061 6365 3d30 290d 0a09 0909 090d 0a09  pace=0).........
-00047880: 0965 7665 3d4d 6f75 7365 4d6f 7665 2864  .eve=MouseMove(d
-00047890: 732c 2063 6d61 702c 2073 656c 662e 696e  s, cmap, self.in
-000478a0: 7465 6e73 6974 795f 7261 6e67 652c 2073  tensity_range, s
-000478b0: 656c 662e 6c6f 675f 7363 616c 652c 2073  elf.log_scale, s
-000478c0: 656c 662e 6261 7365 756e 6974 2c20 7365  elf.baseunit, se
-000478d0: 6c66 2e74 696d 656c 696d 6974 732c 200d  lf.timelimits, .
-000478e0: 0a09 0909 0909 0973 656c 662e 7363 6174  .......self.scat
-000478f0: 7465 7263 7574 2c20 7365 6c66 2e62 6f72  tercut, self.bor
-00047900: 6465 7263 7574 2c20 7365 6c66 2e77 6176  dercut, self.wav
-00047910: 655f 6e6d 5f62 696e 2c20 7365 6c66 2e65  e_nm_bin, self.e
-00047920: 7175 616c 5f65 6e65 7267 795f 6269 6e2c  qual_energy_bin,
-00047930: 2073 656c 662e 6967 6e6f 7265 5f74 696d   self.ignore_tim
-00047940: 655f 7265 6769 6f6e 2c0d 0a09 0909 0909  e_region,.......
-00047950: 0973 656c 662e 7469 6d65 5f62 696e 2c20  .self.time_bin, 
-00047960: 7365 6c66 2e6c 696e 7472 6573 682c 2073  self.lintresh, s
-00047970: 656c 662e 6461 7461 5f74 7970 652c 2073  elf.data_type, s
-00047980: 656c 662e 7761 7665 6c65 6e67 7468 5f62  elf.wavelength_b
-00047990: 696e 2c20 7365 6c66 2e74 696d 655f 7769  in, self.time_wi
-000479a0: 6474 685f 7065 7263 656e 7429 0d0a 0909  dth_percent)....
-000479b0: 6375 7273 6f72 203d 2043 7572 736f 7228  cursor = Cursor(
-000479c0: 6576 652e 6178 2c20 7573 6562 6c69 743d  eve.ax, useblit=
-000479d0: 5472 7565 2c20 636f 6c6f 723d 2772 6564  True, color='red
-000479e0: 272c 206c 696e 6577 6964 7468 3d32 290d  ', linewidth=2).
-000479f0: 0a09 0972 6574 7572 6e20 6576 652c 6375  ...return eve,cu
-00047a00: 7273 6f72 0d0a 0909 0d0a 0d0a 0d0a 0964  rsor...........d
-00047a10: 6566 2050 6c6f 745f 5241 5728 7365 6c66  ef Plot_RAW(self
-00047a20: 2c20 706c 6f74 7469 6e67 203d 2072 616e  , plotting = ran
-00047a30: 6765 2834 292c 2074 6974 6c65 203d 204e  ge(4), title = N
-00047a40: 6f6e 652c 2073 6361 6c65 5f74 7970 6520  one, scale_type 
-00047a50: 3d20 2773 796d 6c6f 6727 2c20 7469 6d65  = 'symlog', time
-00047a60: 7320 3d20 4e6f 6e65 2c0d 0a09 0909 0963  s = None,......c
-00047a70: 6d61 7020 3d20 4e6f 6e65 2c20 6669 6c65  map = None, file
-00047a80: 6e61 6d65 203d 204e 6f6e 652c 2070 6174  name = None, pat
-00047a90: 6820 3d20 2272 6573 756c 745f 6669 6775  h = "result_figu
-00047aa0: 7265 7322 2c20 7361 7665 7479 7065 203d  res", savetype =
-00047ab0: 2027 706e 6727 202c 2070 7269 6e74 5f63   'png' , print_c
-00047ac0: 6c69 636b 5f70 6f73 6974 696f 6e20 3d20  lick_position = 
-00047ad0: 4661 6c73 652c 0d0a 0909 0909 706c 6f74  False,......plot
-00047ae0: 5f73 6563 6f6e 645f 6173 5f65 6e65 7267  _second_as_energ
-00047af0: 7920 3d20 5472 7565 2c20 6473 203d 204e  y = True, ds = N
-00047b00: 6f6e 6529 3a0d 0a09 0927 2727 5468 6973  one):....'''This
-00047b10: 2069 7320 6120 7772 6170 7065 7220 6675   is a wrapper fu
-00047b20: 6e63 7469 6f6e 2074 6861 7420 7472 6967  nction that trig
-00047b30: 6765 7273 2074 6865 2070 6c6f 7474 696e  gers the plottin
-00047b40: 6720 6f66 2076 6172 696f 7573 2052 4157  g of various RAW
-00047b50: 2028 6e6f 6e20 6669 7474 6564 2920 706c   (non fitted) pl
-00047b60: 6f74 732e 200d 0a09 0954 6865 2073 6861  ots. ....The sha
-00047b70: 7069 6e67 2070 6172 616d 6574 6572 2061  ping parameter a
-00047b80: 7265 2074 616b 656e 2066 726f 6d20 7468  re taken from th
-00047b90: 6520 6f62 6a65 6374 2061 6e64 2073 686f  e object and sho
-00047ba0: 756c 6420 6265 2064 6566 696e 6564 2062  uld be defined b
-00047bb0: 6566 6f72 652e 0d0a 0909 5468 6520 7061  efore.....The pa
-00047bc0: 7261 6d65 7465 7220 696e 2074 6869 7320  rameter in this 
-00047bd0: 706c 6f74 2063 616c 6c20 6172 6520 746f  plot call are to
-00047be0: 2063 6f6e 7472 6f6c 2074 6865 2067 656e   control the gen
-00047bf0: 6572 616c 206c 6f6f 6b20 616e 6420 6665  eral look and fe
-00047c00: 6174 7572 6573 206f 6620 7468 6520 706c  atures of the pl
-00047c10: 6f74 2e0d 0a09 0957 6869 6368 2070 6c6f  ot.....Which plo
-00047c20: 7473 2061 7265 2070 7269 6e74 6564 2069  ts are printed i
-00047c30: 7320 6465 6669 6e65 6420 6279 7420 7468  s defined byt th
-00047c40: 6520 6669 7273 7420 636f 6d6d 616e 6420  e first command 
-00047c50: 2870 6c6f 7474 696e 6729 0d0a 0909 5468  (plotting)....Th
-00047c60: 6520 706c 6f74 7320 6172 6520 6765 6e65  e plots are gene
-00047c70: 7261 7465 6420 6f6e 2074 6865 2066 6c79  rated on the fly
-00047c80: 2075 7369 6e67 2073 656c 662e 6473 2061   using self.ds a
-00047c90: 6e64 2061 6c6c 2074 6865 2073 6861 7069  nd all the shapi
-00047ca0: 6e67 2070 6172 616d 6574 6572 0d0a 0909  ng parameter....
-00047cb0: 496e 2061 6c6c 2070 6c6f 7473 2074 6865  In all plots the
-00047cc0: 2052 4157 2064 6174 6120 6973 2070 6c6f   RAW data is plo
-00047cd0: 7474 6564 2061 7320 646f 7473 2061 6e64  tted as dots and
-00047ce0: 2069 6e74 6572 706f 6c61 7465 6420 7769   interpolated wi
-00047cf0: 7468 206c 696e 6573 200d 0a09 0928 7573  th lines ....(us
-00047d00: 696e 6720 5361 7669 747a 6b79 2d47 6f6c  ing Savitzky-Gol
-00047d10: 6179 2077 696e 646f 773d 352c 206f 7264  ay window=5, ord
-00047d20: 6572 3d33 2069 6e74 6572 706f 6c61 7469  er=3 interpolati
-00047d30: 6f6e 292e 2041 7320 6465 6669 6e65 6420  on). As defined 
-00047d40: 6279 2074 6865 2069 6e74 6572 6e61 6c20  by the internal 
-00047d50: 7061 7261 6d65 7465 7273 200d 0a09 0961  parameters ....a
-00047d60: 7420 7365 6c65 6374 6564 2074 696d 652d  t selected time-
-00047d70: 706f 696e 7473 2061 6e64 2074 6865 206b  points and the k
-00047d80: 696e 6574 6963 7320 666f 7220 7365 6c65  inetics for sele
-00047d90: 6374 6564 2077 6176 656c 656e 6774 6820  cted wavelength 
-00047da0: 6172 6520 7368 6170 6564 2062 7920 7468  are shaped by th
-00047db0: 6520 0d0a 0909 6f62 6a65 6374 2070 6172  e ....object par
-00047dc0: 616d 6574 6572 2e20 5468 6520 5356 4420  ameter. The SVD 
-00047dd0: 6973 2070 6572 666f 726d 6564 2075 7369  is performed usi
-00047de0: 6e67 2074 6865 2073 616d 6520 7368 6170  ng the same shap
-00047df0: 696e 6720 7061 7261 6d65 7465 7220 616e  ing parameter an
-00047e00: 6420 6973 2063 6f6d 6d6f 6e6c 7920 0d0a  d is commonly ..
-00047e10: 0909 7573 6564 2061 7320 616e 206f 7269  ..used as an ori
-00047e20: 656e 7461 7469 6f6e 2066 6f72 2074 6865  entation for the
-00047e30: 206e 756d 6265 7220 6f66 2063 6f6d 706f   number of compo
-00047e40: 6e65 6e74 7320 696e 2074 6865 2064 6174  nents in the dat
-00047e50: 612e 0d0a 0909 4576 6572 7974 6869 6e67  a.....Everything
-00047e60: 2069 7320 6861 6e64 6564 206f 7665 7220   is handed over 
-00047e70: 746f 2027 706c 6f74 5f72 6177 2720 6675  to 'plot_raw' fu
-00047e80: 6e63 7469 6f6e 2074 6861 7420 6361 6e20  nction that can 
-00047e90: 6265 2075 7365 6420 666f 7220 6578 7465  be used for exte
-00047ea0: 6e64 6564 2052 4157 2070 6c6f 7474 696e  nded RAW plottin
-00047eb0: 672e 0d0a 0909 0d0a 0909 5061 7261 6d65  g.........Parame
-00047ec0: 7465 7273 0d0a 0909 2d2d 2d2d 2d2d 2d2d  ters....--------
-00047ed0: 2d2d 2d2d 2d2d 2d0d 0a09 090d 0a09 0970  -------........p
-00047ee0: 6c6f 7474 696e 6720 3a20 696e 7420 6f72  lotting : int or
-00047ef0: 2069 7465 7261 626c 6520 286f 6620 696e   iterable (of in
-00047f00: 7465 6765 7273 292c 206f 7074 696f 6e61  tegers), optiona
-00047f10: 6c0d 0a09 0909 5468 6973 2070 6172 616d  l.....This param
-00047f20: 6574 6572 2064 6574 6572 6d69 6e65 7320  eter determines 
-00047f30: 7768 6963 6820 6669 6775 7265 7320 6172  which figures ar
-00047f40: 6520 706c 6f74 7465 6420 0d0a 0909 0974  e plotted .....t
-00047f50: 6865 2066 6967 7572 6573 2063 616e 2062  he figures can b
-00047f60: 6520 6361 6c6c 6564 2073 6570 6172 6174  e called separat
-00047f70: 656c 7920 7769 7468 2070 6c6f 7474 696e  ely with plottin
-00047f80: 6720 3d20 310d 0a09 0909 6f72 2077 6974  g = 1.....or wit
-00047f90: 6820 6120 6c69 7374 206f 6620 706c 6f74  h a list of plot
-00047fa0: 7320 2844 6566 6175 6c74 2920 652e 672e  s (Default) e.g.
-00047fb0: 2070 6c6f 7474 696e 673d 7261 6e67 6528   plotting=range(
-00047fc0: 3429 2063 616c 6c73 2070 6c6f 7473 2030  4) calls plots 0
-00047fd0: 2c31 2c32 2c33 2e0d 0a09 0909 5468 6520  ,1,2,3......The 
-00047fe0: 706c 6f74 7320 6861 7665 2074 6865 2066  plots have the f
-00047ff0: 6f6c 6c6f 7769 6e67 206e 756d 6265 7273  ollowing numbers
-00048000: 3a20 0d0a 0909 090d 0a09 0909 0930 2e20  : ...........0. 
-00048010: 4d61 7472 6978 0d0a 0909 0909 312e 204b  Matrix......1. K
-00048020: 696e 6574 6963 730d 0a09 0909 0932 2e20  inetics......2. 
-00048030: 5370 6563 7472 610d 0a09 0909 0933 2e20  Spectra......3. 
-00048040: 5356 4420 0d0a 0909 090d 0a09 0909 5468  SVD ..........Th
-00048050: 6520 706c 6f74 7469 6e67 2074 616b 6573  e plotting takes
-00048060: 2061 6c6c 2070 6172 616d 6574 6572 2066   all parameter f
-00048070: 726f 6d20 7468 6520 2274 6122 206f 626a  rom the "ta" obj
-00048080: 6563 742e 0d0a 0909 0d0a 0909 7469 746c  ect.........titl
-00048090: 6520 3a20 4e6f 6e65 206f 7220 7374 720d  e : None or str.
-000480a0: 0a09 0909 7469 746c 6520 746f 2062 6520  ....title to be 
-000480b0: 7573 6564 206f 6e20 746f 7020 6f66 2065  used on top of e
-000480c0: 6163 6820 706c 6f74 0d0a 0909 0954 6865  ach plot.....The
-000480d0: 2028 4465 6661 756c 7429 204e 6f6e 6520   (Default) None 
-000480e0: 7472 6967 6765 7273 2020 7365 6c66 2e66  triggers  self.f
-000480f0: 696c 656e 616d 6520 746f 2062 6520 7573  ilename to be us
-00048100: 6564 2e20 5365 7474 696e 6720 6120 7370  ed. Setting a sp
-00048110: 6563 6966 6963 2074 6974 6c65 2061 7320  ecific title as 
-00048120: 7374 7269 6e67 2077 696c 6c2e 0d0a 0909  string will.....
-00048130: 0962 6520 7573 6564 2069 6e20 616c 6c20  .be used in all 
-00048140: 706c 6f74 732e 2054 6f20 7265 6d6f 7665  plots. To remove
-00048150: 2074 6865 2074 6974 6c65 2061 6c6c 2074   the title all t
-00048160: 6f67 6574 6865 7220 7365 7420 616e 2065  ogether set an e
-00048170: 6d70 7479 2073 7472 696e 6720 7769 7468  mpty string with
-00048180: 2074 6869 7320 636f 6d6d 616e 6420 7469   this command ti
-00048190: 746c 653d 2222 202e 0d0a 0909 0d0a 0909  tle="" .........
-000481a0: 5363 616c 655f 7479 7065 203a 204e 6f6e  Scale_type : Non
-000481b0: 6520 6f72 2073 7472 0d0a 0909 0969 7320  e or str.....is 
-000481c0: 6120 6765 6e65 7261 6c20 7365 7474 696e  a general settin
-000481d0: 6720 7468 6174 2063 616e 2069 6e66 6c75  g that can influ
-000481e0: 656e 6365 7320 7768 6174 2074 696d 6520  ences what time 
-000481f0: 6178 6973 2077 696c 6c20 6265 2075 7365  axis will be use
-00048200: 6420 666f 7220 7468 6520 706c 6f74 732e  d for the plots.
-00048210: 200d 0a09 0909 2273 796d 6c6f 6722 2028   ....."symlog" (
-00048220: 6c69 6e65 6172 2061 726f 756e 6420 7a65  linear around ze
-00048230: 726f 2061 6e64 206c 6f67 6172 6974 686d  ro and logarithm
-00048240: 6963 206f 7468 6572 7769 7365 2920 226c  ic otherwise) "l
-00048250: 696e 2220 616e 6420 226c 6f67 2220 6172  in" and "log" ar
-00048260: 6520 7661 6c69 6420 6f70 7469 6f6e 732e  e valid options.
-00048270: 0d0a 0909 0d0a 0909 7469 6d65 7320 3a20  ........times : 
-00048280: 696e 740d 0a09 0909 6172 6520 7468 6520  int.....are the 
-00048290: 6e75 6d62 6572 206f 6620 636f 6d70 6f6e  number of compon
-000482a0: 656e 7473 2074 6f20 6265 2075 7365 6420  ents to be used 
-000482b0: 696e 2074 6865 2053 5644 2028 4465 6661  in the SVD (Defa
-000482c0: 756c 7429 2069 7320 362e 0d0a 0909 0d0a  ult) is 6.......
-000482d0: 0909 636d 6170 203a 204e 6f6e 6520 6f72  ..cmap : None or
-000482e0: 206d 6174 706c 6f74 6c69 6220 636f 6c6f   matplotlib colo
-000482f0: 7220 6d61 702c 206f 7074 696f 6e61 6c0d  r map, optional.
-00048300: 0a09 0909 6973 2061 2070 6f77 6572 6675  ....is a powerfu
-00048310: 6c6c 2076 6172 6961 626c 6520 7468 6174  ll variable that
-00048320: 2063 686f 6f73 6573 2074 6865 2063 6f6c   chooses the col
-00048330: 6f75 7220 6d61 7020 6170 706c 6965 6420  our map applied 
-00048340: 666f 7220 616c 6c20 706c 6f74 732e 2049  for all plots. I
-00048350: 6620 7365 7420 746f 200d 0a09 0909 4e6f  f set to .....No
-00048360: 6e65 2028 4465 6661 756c 7429 2074 6865  ne (Default) the
-00048370: 6e20 7468 6520 7365 6c66 2e63 6d61 7020  n the self.cmap 
-00048380: 6973 2075 7365 642e 0d0a 0909 0941 7320  is used......As 
-00048390: 7374 616e 6461 7264 2049 2075 7365 2074  standard I use t
-000483a0: 6865 2063 6f6c 6f72 206d 6170 2022 6a65  he color map "je
-000483b0: 7422 2066 726f 6d20 6d61 7470 6c6f 746c  t" from matplotl
-000483c0: 6962 2e20 5468 6572 6520 6172 6520 6120  ib. There are a 
-000483d0: 7661 7269 6574 7920 6f66 2063 6f6c 6f72  variety of color
-000483e0: 6d61 7073 200d 0a09 0909 6176 6169 6c61  maps .....availa
-000483f0: 626c 6520 7468 6174 2061 7265 2076 6572  ble that are ver
-00048400: 7920 7573 6566 756c 6c2e 2042 6573 6964  y usefull. Besid
-00048410: 6520 226a 6574 222c 2022 7669 7269 6469  e "jet", "viridi
-00048420: 7322 2069 7320 6120 676f 6f64 2063 686f  s" is a good cho
-00048430: 6963 6520 6173 2069 7420 6973 2077 656c  ice as it is wel
-00048440: 6c20 0d0a 0909 0976 6973 6962 6c65 2075  l .....visible u
-00048450: 6e64 6572 2072 6564 2d67 7265 656e 2062  nder red-green b
-00048460: 6c69 6e64 6e65 7373 2e20 4f74 6865 7220  lindness. Other 
-00048470: 7573 6566 756c 206d 6170 7320 6172 6520  useful maps are 
-00048480: 2270 7269 736d 2220 666f 7220 6869 6768  "prism" for high
-00048490: 2066 6c75 6374 7561 7469 6f6e 7320 0d0a   fluctuations ..
-000484a0: 0909 096f 7220 6469 7665 7267 696e 6720  ...or diverging 
-000484b0: 636f 6c6f 7220 6d61 7073 206c 696b 6520  color maps like 
-000484c0: 2273 6569 736d 6963 222e 200d 0a09 0909  "seismic". .....
-000484d0: 5365 6520 6874 7470 733a 2f2f 6d61 7470  See https://matp
-000484e0: 6c6f 746c 6962 2e6f 7267 2f33 2e31 2e30  lotlib.org/3.1.0
-000484f0: 2f74 7574 6f72 6961 6c73 2f63 6f6c 6f72  /tutorials/color
-00048500: 732f 636f 6c6f 726d 6170 732e 6874 6d6c  s/colormaps.html
-00048510: 2066 6f72 2061 2063 6f6d 7072 6568 656e   for a comprehen
-00048520: 7369 7665 200d 0a09 0909 7365 6c65 6374  sive .....select
-00048530: 696f 6e2e 2049 6e20 7468 6520 636f 6465  ion. In the code
-00048540: 2074 6865 2063 6f6c 6f72 6d61 7073 2061   the colormaps a
-00048550: 7265 2069 6d70 6f72 7465 6420 736f 2069  re imported so i
-00048560: 6620 706c 6f74 5f66 756e 6320 6973 2069  f plot_func is i
-00048570: 6d70 6f72 7465 6420 6173 2070 6620 7468  mported as pf th
-00048580: 656e 200d 0a09 0909 7365 6c66 2e63 6d61  en .....self.cma
-00048590: 703d 7066 2e63 6d2e 7669 7269 6469 7320  p=pf.cm.viridis 
-000485a0: 7365 7473 2076 6972 6964 6973 2061 7320  sets viridis as 
-000485b0: 7468 6520 6d61 7020 746f 2075 7365 2e20  the map to use. 
-000485c0: 496e 7465 726e 616c 6c79 2074 6865 2063  Internally the c
-000485d0: 6f6c 6f72 7320 6172 6520 6368 6f73 656e  olors are chosen
-000485e0: 200d 0a09 0909 7769 7468 2074 6865 2022   .....with the "
-000485f0: 636f 6c6d 2220 6675 6e63 7469 6f6e 2e20  colm" function. 
-00048600: 5468 6520 3264 2070 6c6f 7473 2072 6571  The 2d plots req
-00048610: 7569 7265 2061 2063 6f6e 7469 6e75 6f75  uire a continuou
-00048620: 7320 636f 6c6f 7220 6d61 7020 736f 2069  s color map so i
-00048630: 6620 736f 6d65 7468 696e 6720 0d0a 0909  f something ....
-00048640: 0965 6c73 6520 6973 2067 6976 6520 3264  .else is give 2d
-00048650: 2070 6c6f 7473 2061 7265 2073 686f 776e   plots are shown
-00048660: 2061 7574 6f6d 6174 6963 616c 6c79 2077   automatically w
-00048670: 6974 6820 226a 6574 222e 2046 6f72 2061  ith "jet". For a
-00048680: 6c6c 206f 6620 7468 6520 3164 2070 6c6f  ll of the 1d plo
-00048690: 7473 2068 6f77 6576 6572 200d 0a09 0909  ts however .....
-000486a0: 4920 6669 7273 7420 7365 6c65 6374 2061  I first select a
-000486b0: 206e 756d 6265 7220 6f66 2063 6f6c 6f72   number of color
-000486c0: 7320 6265 666f 7265 2065 6163 6820 706c  s before each pl
-000486d0: 6f74 2e20 4966 2063 6d61 7020 6973 2061  ot. If cmap is a
-000486e0: 2063 6f6e 7469 6e6f 7573 206d 6170 2074   continous map t
-000486f0: 6865 6e20 7468 6573 650d 0a09 0909 6172  hen these.....ar
-00048700: 6520 7361 6d70 6c65 6420 6576 656e 6c79  e sampled evenly
-00048710: 206f 7665 7220 7468 6520 636f 6c6f 7572   over the colour
-00048720: 6d61 702e 204d 616e 7561 6c20 6974 6572  map. Manual iter
-00048730: 6162 6c65 7320 6f66 2063 6f6c 6f75 7273  ables of colours
-00048740: 200d 0a09 0909 636d 6170 3d5b 2831 2c30   .....cmap=[(1,0
-00048750: 2c30 292c 2830 2c31 2c30 292c 2830 2c30  ,0),(0,1,0),(0,0
-00048760: 2c31 292c 2e2e 2e5d 2061 7265 2061 6c73  ,1),...] are als
-00048770: 6f20 6163 6365 7074 6564 2c20 6173 2061  o accepted, as a
-00048780: 7265 2076 6563 746f 7273 206f 7220 6461  re vectors or da
-00048790: 7461 6672 616d 6573 2074 6861 7420 0d0a  taframes that ..
-000487a0: 0909 0963 6f6e 7461 696e 2061 7320 726f  ...contain as ro
-000487b0: 7773 2074 6865 2063 6f6c 6f72 732e 2054  ws the colors. T
-000487c0: 6865 7265 206d 7573 7420 6265 206f 6620  here must be of 
-000487d0: 636f 7572 7365 2073 7566 6669 6369 656e  course sufficien
-000487e0: 7420 636f 6c6f 7273 2070 7265 7365 6e74  t colors present
-000487f0: 2066 6f72 200d 0a09 0909 7468 6520 6e75   for .....the nu
-00048800: 6d62 6572 7320 6f66 206c 696e 6573 2074  mbers of lines t
-00048810: 6861 7420 7769 6c6c 2062 6520 706c 6f74  hat will be plot
-00048820: 7465 642e 2053 6f20 4920 7265 636f 6d6d  ted. So I recomm
-00048830: 656e 6420 746f 2070 726f 7669 6465 2061  end to provide a
-00048840: 7420 6c65 6173 7420 3130 2063 6f6c 6f75  t least 10 colou
-00048850: 7273 200d 0a09 0909 2865 2e67 2e7e 796f  rs .....(e.g.~yo
-00048860: 7572 2075 6e69 7665 7273 6974 7920 636f  ur university co
-00048870: 6c6f 7273 292e 2063 6f6c 6f75 7273 2061  lors). colours a
-00048880: 7265 2061 6c77 6179 7320 6769 7665 6e20  re always given 
-00048890: 6173 2061 2c20 6c69 7374 206f 7220 7475  as a, list or tu
-000488a0: 706c 6520 7769 7468 2052 4741 206f 7220  ple with RGA or 
-000488b0: 5247 4241 0d0a 0909 0928 7769 7468 2074  RGBA.....(with t
-000488c0: 6865 206c 6173 7420 4120 6265 6569 6e67  he last A beeing
-000488d0: 2074 6865 2041 6c70 6861 3d74 7261 6e73   the Alpha=trans
-000488e0: 7061 7265 6e63 792e 2041 6c6c 206e 756d  parency. All num
-000488f0: 6265 7273 2061 7265 2062 6574 7765 656e  bers are between
-00048900: 2030 2061 6e64 2031 2e20 0d0a 0909 0949   0 and 1. .....I
-00048910: 6620 6120 6c69 7374 2f76 6563 746f 722f  f a list/vector/
-00048920: 4461 7461 4672 616d 6520 6973 2067 6976  DataFrame is giv
-00048930: 656e 2066 6f72 2074 6865 2063 6f6c 6f75  en for the colou
-00048940: 7273 2074 6865 7920 7769 6c6c 2062 6520  rs they will be 
-00048950: 7573 6564 2069 6e20 7468 6520 6f72 6465  used in the orde
-00048960: 7220 7072 6f76 6964 6564 2e09 090d 0a09  r provided......
-00048970: 090d 0a09 0966 696c 656e 616d 6520 3a20  .....filename : 
-00048980: 7374 722c 206f 7074 696f 6e61 6c0d 0a09  str, optional...
-00048990: 0909 6f66 6665 7273 2074 6f20 7265 706c  ..offers to repl
-000489a0: 6163 6520 7468 6520 6261 7365 2d6e 616d  ace the base-nam
-000489b0: 6520 7573 6564 2066 6f72 2061 6c6c 2070  e used for all p
-000489c0: 6c6f 7473 2028 746f 2065 2e67 2e7e 7370  lots (to e.g.~sp
-000489d0: 6563 6966 7920 7768 6174 2073 616d 706c  ecify what sampl
-000489e0: 6520 7761 7320 7573 6564 292e 200d 0a09  e was used). ...
-000489f0: 0909 6966 2028 4465 6661 756c 7429 204e  ..if (Default) N
-00048a00: 6f6e 6520 6973 2075 7365 642c 2074 6865  one is used, the
-00048a10: 2073 656c 662e 6669 6c65 6e61 6d65 2069   self.filename i
-00048a20: 7320 7573 6564 2061 7320 6120 6261 7365  s used as a base
-00048a30: 206e 616d 652e 2054 6865 2066 696c 656e   name. The filen
-00048a40: 616d 6520 706c 6179 7320 6f6e 6c79 2061  ame plays only a
-00048a50: 200d 0a09 0909 726f 6c65 2064 7572 696e   .....role durin
-00048a60: 6720 7361 7669 6e67 2c20 6173 2064 6f65  g saving, as doe
-00048a70: 7320 7468 6520 7061 7468 2061 6e64 2073  s the path and s
-00048a80: 6176 6574 7970 652e 0d0a 0909 0d0a 0909  avetype.........
-00048a90: 7061 7468 203a 204e 6f6e 6520 6f72 2073  path : None or s
-00048aa0: 7472 206f 7220 7061 7468 206f 626a 6563  tr or path objec
-00048ab0: 742c 206f 7074 696f 6e61 6c0d 0a09 0909  t, optional.....
-00048ac0: 5468 6973 2064 6566 696e 6573 2077 6865  This defines whe
-00048ad0: 7265 2074 6865 2066 696c 6573 2061 7265  re the files are
-00048ae0: 2073 6176 6564 2069 6620 7468 6520 7361   saved if the sa
-00048af0: 6665 5f66 6967 7572 6573 5f74 6f5f 666f  fe_figures_to_fo
-00048b00: 6c64 6572 2070 6172 616d 6574 6572 2069  lder parameter i
-00048b10: 7320 5472 7565 2c20 0d0a 0909 0971 7569  s True, .....qui
-00048b20: 7465 2075 7365 6675 6c20 6966 2061 206c  te useful if a l
-00048b30: 6f74 206f 6620 6461 7461 2073 6574 7320  ot of data sets 
-00048b40: 6172 6520 746f 2062 6520 7072 696e 7465  are to be printe
-00048b50: 6420 6661 7374 2e20 0d0a 0909 0949 6620  d fast. .....If 
-00048b60: 6120 7061 7468 2069 7320 6769 7665 6e2c  a path is given,
-00048b70: 2074 6869 7320 6973 2075 7365 642e 2049   this is used. I
-00048b80: 6620 6120 7374 7269 6e67 206c 696b 6520  f a string like 
-00048b90: 7468 6520 2844 6566 6175 6c74 2920 2272  the (Default) "r
-00048ba0: 6573 756c 745f 6669 6775 7265 7322 2069  esult_figures" i
-00048bb0: 7320 6769 7665 6e2c 200d 0a09 0909 7468  s given, .....th
-00048bc0: 656e 2061 2073 7562 666f 6c64 6572 206f  en a subfolder o
-00048bd0: 6620 7468 6973 206e 616d 6520 7769 6c6c  f this name will
-00048be0: 2062 6520 7573 6564 2028 616e 2067 656e   be used (an gen
-00048bf0: 6572 6174 6564 2069 6620 6e65 6365 7373  erated if necess
-00048c00: 6172 7929 200d 0a09 0909 7265 6c61 7469  ary) .....relati
-00048c10: 7665 2074 6f20 7365 6c66 2e70 6174 682e  ve to self.path.
-00048c20: 2055 7365 2061 6e64 2065 6d70 7479 2073   Use and empty s
-00048c30: 7472 696e 6720 746f 2075 7365 2074 6865  tring to use the
-00048c40: 2073 656c 662e 7061 7468 0d0a 0909 0949   self.path.....I
-00048c50: 6620 7365 7420 746f 204e 6f6e 652c 2074  f set to None, t
-00048c60: 6865 206c 6f63 6174 696f 6e20 6f66 2074  he location of t
-00048c70: 6865 2070 6c6f 745f 6675 6e63 2077 696c  he plot_func wil
-00048c80: 6c20 6265 2075 7365 6420 616e 640d 0a09  l be used and...
-00048c90: 0909 6120 7375 6266 6f6c 6465 7220 7769  ..a subfolder wi
-00048ca0: 7468 2074 6974 6c65 2022 7265 7375 6c74  th title "result
-00048cb0: 5f66 6967 7572 6573 2220 6265 2067 656e  _figures" be gen
-00048cc0: 6572 6174 6564 2068 6572 652e 0d0a 0909  erated here.....
-00048cd0: 0d0a 0909 7361 7665 7479 7065 203a 2073  ....savetype : s
-00048ce0: 7472 206f 7220 6974 6572 6162 6c65 2028  tr or iterable (
-00048cf0: 6f66 2073 7472 292c 206f 7074 696f 6e61  of str), optiona
-00048d00: 6c20 0d0a 0909 096d 6174 706c 6f74 6c69  l .....matplotli
-00048d10: 6220 616c 6c6f 7773 2074 6865 2073 6176  b allows the sav
-00048d20: 696e 6720 6f66 2066 6967 7572 6573 2069  ing of figures i
-00048d30: 6e20 7661 7269 6f75 7320 666f 726d 6174  n various format
-00048d40: 732e 2028 4465 6661 756c 7429 2022 706e  s. (Default) "pn
-00048d50: 6722 2c20 0d0a 0909 0974 7970 6963 616c  g", .....typical
-00048d60: 2061 6e64 2072 6563 6f6d 6d65 6e64 6162   and recommendab
-00048d70: 6c65 206f 7074 696f 6e73 2061 7265 2022  le options are "
-00048d80: 7376 6722 2061 6e64 2022 7064 6622 2e20  svg" and "pdf". 
-00048d90: 200d 0a09 0909 0d0a 0909 7072 696e 745f   .........print_
-00048da0: 636c 6963 6b5f 706f 7369 7469 6f6e 203a  click_position :
-00048db0: 2062 6f6f 6c2c 206f 7074 696f 6e61 6c0d   bool, optional.
-00048dc0: 0a09 0909 6966 2054 7275 6520 7468 656e  ....if True then
-00048dd0: 2074 6865 2063 6c69 636b 2070 6f73 6974   the click posit
-00048de0: 696f 6e20 6973 2070 7269 6e74 6564 2066  ion is printed f
-00048df0: 6f72 2074 6865 2073 7065 6374 7261 6c20  or the spectral 
-00048e00: 706c 6f74 7320 0d0a 0909 090d 0a09 0964  plots .........d
-00048e10: 7320 3a20 4461 7461 4672 616d 652c 206f  s : DataFrame, o
-00048e20: 7074 696f 6e61 6c0d 0a09 0909 6966 204e  ptional.....if N
-00048e30: 6f6e 6520 2844 6566 6175 6c74 292c 2074  one (Default), t
-00048e40: 6865 2070 726f 6772 616d 2066 6972 7374  he program first
-00048e50: 2074 6573 7473 2073 656c 662e 6473 2061   tests self.ds a
-00048e60: 6e64 2069 6620 7468 6973 2069 7320 6e6f  nd if this is no
-00048e70: 7420 7468 6572 6520 7468 656e 2073 656c  t there then sel
-00048e80: 662e 6473 5f6f 7269 2e0d 0a09 0909 5468  f.ds_ori......Th
-00048e90: 6973 206f 7074 696f 6e20 7761 7320 696e  is option was in
-00048ea0: 7472 6f64 7563 6564 2074 6f20 616c 6c6f  troduced to allo
-00048eb0: 7720 706c 6f74 7469 6e67 206f 6620 6f74  w plotting of ot
-00048ec0: 6865 7220 6d61 7472 6978 6573 2077 6974  her matrixes wit
-00048ed0: 6820 7468 6520 7361 6d65 2070 6172 616d  h the same param
-00048ee0: 6574 6572 0d0a 0909 0d0a 0909 4578 616d  eter........Exam
-00048ef0: 706c 6573 0d0a 0909 2d2d 2d2d 2d2d 2d2d  ples....--------
-00048f00: 2d2d 2d2d 0d0a 0909 0d0a 0909 5479 7069  ----........Typi
-00048f10: 6361 6c6c 7920 6f6e 6520 776f 756c 6420  cally one would 
-00048f20: 6361 6c6c 2074 6869 7320 6675 6e63 7469  call this functi
-00048f30: 6f6e 2065 6d70 7479 2066 6f72 2061 6e20  on empty for an 
-00048f40: 6f76 6572 7669 6577 2e20 5765 206e 616d  overview. We nam
-00048f50: 6520 7468 6520 6f62 6a65 6374 2022 7461  e the object "ta
-00048f60: 2220 736f 2077 6974 680d 0a09 090d 0a09  " so with.......
-00048f70: 093e 3e3e 2074 613d 7066 2e54 4128 2774  .>>> ta=pf.TA('t
-00048f80: 6573 7466 696c 652e 5349 4127 2920 0d0a  estfile.SIA') ..
-00048f90: 0909 0d0a 0909 5468 6973 2077 6f75 6c64  ......This would
-00048fa0: 2074 7269 6767 6572 2074 6865 2070 6c6f   trigger the plo
-00048fb0: 7474 696e 6720 6f66 2074 6865 2034 206d  tting of the 4 m
-00048fc0: 6179 6f72 2070 6c6f 7473 2066 6f72 2061  ayor plots for a
-00048fd0: 6e20 6f76 6572 7669 6577 2e0d 0a09 090d  n overview......
-00048fe0: 0a09 093e 3e3e 2074 612e 506c 6f74 5f52  ...>>> ta.Plot_R
-00048ff0: 4157 2829 0d0a 0909 0d0a 0909 5468 6973  AW()........This
-00049000: 2077 6f75 6c64 2070 6c6f 7420 6f6e 6c79   would plot only
-00049010: 2074 6865 206b 696e 6574 6963 732e 0d0a   the kinetics...
-00049020: 0909 0d0a 0909 3e3e 3e20 7461 2e50 6c6f  ......>>> ta.Plo
-00049030: 745f 5241 5728 3129 0d0a 0909 3e3e 3e20  t_RAW(1)....>>> 
-00049040: 7461 2e50 6c6f 745f 5241 5728 706c 6f74  ta.Plot_RAW(plot
-00049050: 7469 6e67 203d 2031 290d 0a20 0d0a 0909  ting = 1).. ....
-00049060: 2727 270d 0a09 090d 0a09 0970 6174 683d  '''........path=
-00049070: 6368 6563 6b5f 666f 6c64 6572 2870 6174  check_folder(pat
-00049080: 683d 7061 7468 2c63 7572 7265 6e74 5f70  h=path,current_p
-00049090: 6174 683d 7365 6c66 2e70 6174 6829 0d0a  ath=self.path)..
-000490a0: 0909 6966 2073 656c 662e 7361 7665 5f66  ..if self.save_f
-000490b0: 6967 7572 6573 5f74 6f5f 666f 6c64 6572  igures_to_folder
-000490c0: 3a0d 0a09 0909 7365 6c66 2e66 6967 7572  :.....self.figur
-000490d0: 655f 7061 7468 3d70 6174 680d 0a09 0969  e_path=path....i
-000490e0: 6620 636d 6170 2069 7320 4e6f 6e65 3a63  f cmap is None:c
-000490f0: 6d61 703d 7365 6c66 2e63 6d61 700d 0a09  map=self.cmap...
-00049100: 0969 6620 6473 2069 7320 4e6f 6e65 3a0d  .if ds is None:.
-00049110: 0a09 0909 6966 2073 656c 662e 6473 2069  ....if self.ds i
-00049120: 7320 4e6f 6e65 3a0d 0a09 0909 0964 733d  s None:......ds=
-00049130: 7365 6c66 2e64 735f 6f72 692e 636f 7079  self.ds_ori.copy
-00049140: 2829 0d0a 0909 0965 6c73 653a 0d0a 0909  ().....else:....
-00049150: 0909 6473 3d73 656c 662e 6473 2e63 6f70  ..ds=self.ds.cop
-00049160: 7928 290d 0a09 0969 6620 6669 6c65 6e61  y()....if filena
-00049170: 6d65 2069 7320 4e6f 6e65 3a20 6669 6c65  me is None: file
-00049180: 6e61 6d65 3d73 656c 662e 6669 6c65 6e61  name=self.filena
-00049190: 6d65 0d0a 0909 6966 206e 6f74 2068 6173  me....if not has
-000491a0: 6174 7472 2870 6c6f 7474 696e 672c 225f  attr(plotting,"_
-000491b0: 5f69 7465 725f 5f22 293a 706c 6f74 7469  _iter__"):plotti
-000491c0: 6e67 3d5b 706c 6f74 7469 6e67 5d0d 0a09  ng=[plotting]...
-000491d0: 0969 6620 7469 746c 6520 6973 204e 6f6e  .if title is Non
-000491e0: 653a 0d0a 0909 0969 6620 6669 6c65 6e61  e:.....if filena
-000491f0: 6d65 2069 7320 4e6f 6e65 3a0d 0a09 0909  me is None:.....
-00049200: 0974 6974 6c65 3d73 656c 662e 6669 6c65  .title=self.file
-00049210: 6e61 6d65 0d0a 0909 0965 6c73 653a 0d0a  name.....else:..
-00049220: 0909 0909 7469 746c 653d 6669 6c65 6e61  ....title=filena
-00049230: 6d65 0d0a 0909 706c 6f74 5f72 6177 2864  me....plot_raw(d
-00049240: 733d 6473 2c20 706c 6f74 7469 6e67 3d70  s=ds, plotting=p
-00049250: 6c6f 7474 696e 672c 2063 6d61 703d 636d  lotting, cmap=cm
-00049260: 6170 2c20 7469 746c 653d 7469 746c 652c  ap, title=title,
-00049270: 2070 6174 683d 7061 7468 2c20 6669 6c65   path=path, file
-00049280: 6e61 6d65 3d66 696c 656e 616d 652c 200d  name=filename, .
-00049290: 0a09 0909 0969 6e74 656e 7369 7479 5f72  .....intensity_r
-000492a0: 616e 6765 3d73 656c 662e 696e 7465 6e73  ange=self.intens
-000492b0: 6974 795f 7261 6e67 652c 206c 6f67 5f73  ity_range, log_s
-000492c0: 6361 6c65 3d73 656c 662e 6c6f 675f 7363  cale=self.log_sc
-000492d0: 616c 652c 2062 6173 6575 6e69 743d 7365  ale, baseunit=se
-000492e0: 6c66 2e62 6173 6575 6e69 742c 200d 0a09  lf.baseunit, ...
-000492f0: 0909 0974 696d 656c 696d 6974 733d 7365  ...timelimits=se
-00049300: 6c66 2e74 696d 656c 696d 6974 732c 2073  lf.timelimits, s
-00049310: 6361 7474 6572 6375 743d 7365 6c66 2e73  cattercut=self.s
-00049320: 6361 7474 6572 6375 742c 2062 6f72 6465  cattercut, borde
-00049330: 7263 7574 3d73 656c 662e 626f 7264 6572  rcut=self.border
-00049340: 6375 742c 200d 0a09 0909 0977 6176 655f  cut, ......wave_
-00049350: 6e6d 5f62 696e 3d73 656c 662e 7761 7665  nm_bin=self.wave
-00049360: 5f6e 6d5f 6269 6e2c 2072 656c 5f77 6176  _nm_bin, rel_wav
-00049370: 653d 7365 6c66 2e72 656c 5f77 6176 652c  e=self.rel_wave,
-00049380: 2077 6964 7468 3d73 656c 662e 7761 7665   width=self.wave
-00049390: 6c65 6e67 7468 5f62 696e 2c20 0d0a 0909  length_bin, ....
-000493a0: 0909 7469 6d65 5f77 6964 7468 5f70 6572  ..time_width_per
-000493b0: 6365 6e74 3d73 656c 662e 7469 6d65 5f77  cent=self.time_w
-000493c0: 6964 7468 5f70 6572 6365 6e74 2c20 6967  idth_percent, ig
-000493d0: 6e6f 7265 5f74 696d 655f 7265 6769 6f6e  nore_time_region
-000493e0: 3d73 656c 662e 6967 6e6f 7265 5f74 696d  =self.ignore_tim
-000493f0: 655f 7265 6769 6f6e 2c20 0d0a 0909 0909  e_region, ......
-00049400: 7469 6d65 5f62 696e 3d73 656c 662e 7469  time_bin=self.ti
-00049410: 6d65 5f62 696e 2c20 7265 6c5f 7469 6d65  me_bin, rel_time
-00049420: 3d73 656c 662e 7265 6c5f 7469 6d65 2c20  =self.rel_time, 
-00049430: 7361 7665 5f66 6967 7572 6573 5f74 6f5f  save_figures_to_
-00049440: 666f 6c64 6572 3d73 656c 662e 7361 7665  folder=self.save
-00049450: 5f66 6967 7572 6573 5f74 6f5f 666f 6c64  _figures_to_fold
-00049460: 6572 2c20 0d0a 0909 0909 7361 7665 7479  er, ......savety
-00049470: 7065 3d73 6176 6574 7970 652c 706c 6f74  pe=savetype,plot
-00049480: 5f74 7970 653d 7363 616c 655f 7479 7065  _type=scale_type
-00049490: 2c6c 696e 7472 6573 683d 7365 6c66 2e6c  ,lintresh=self.l
-000494a0: 696e 7472 6573 682c 2074 696d 6573 3d74  intresh, times=t
-000494b0: 696d 6573 2c20 0d0a 0909 0909 7072 696e  imes, ......prin
-000494c0: 745f 636c 6963 6b5f 706f 7369 7469 6f6e  t_click_position
-000494d0: 203d 2070 7269 6e74 5f63 6c69 636b 5f70   = print_click_p
-000494e0: 6f73 6974 696f 6e2c 2064 6174 615f 7479  osition, data_ty
-000494f0: 7065 203d 2073 656c 662e 6461 7461 5f74  pe = self.data_t
-00049500: 7970 652c 200d 0a09 0909 0970 6c6f 745f  ype, ......plot_
-00049510: 7365 636f 6e64 5f61 735f 656e 6572 6779  second_as_energy
-00049520: 203d 2070 6c6f 745f 7365 636f 6e64 5f61   = plot_second_a
-00049530: 735f 656e 6572 6779 2c20 756e 6974 733d  s_energy, units=
-00049540: 7365 6c66 2e75 6e69 7473 2c20 6571 7561  self.units, equa
-00049550: 6c5f 656e 6572 6779 5f62 696e 203d 2073  l_energy_bin = s
-00049560: 656c 662e 6571 7561 6c5f 656e 6572 6779  elf.equal_energy
-00049570: 5f62 696e 290d 0a0d 0a0d 0a09 6465 6620  _bin).......def 
-00049580: 5361 7665 5f50 6c6f 7473 2873 656c 662c  Save_Plots(self,
-00049590: 2070 6174 6820 3d20 2772 6573 756c 745f   path = 'result_
-000495a0: 6669 6775 7265 7327 2c20 7361 7665 7479  figures', savety
-000495b0: 7065 203d 204e 6f6e 652c 2074 6974 6c65  pe = None, title
-000495c0: 203d 204e 6f6e 652c 2066 696c 656e 616d   = None, filenam
-000495d0: 6520 3d20 4e6f 6e65 2c20 7363 616c 655f  e = None, scale_
-000495e0: 7479 7065 203d 2027 7379 6d6c 6f67 272c  type = 'symlog',
-000495f0: 200d 0a09 0909 0909 7061 7463 6865 7320   .......patches 
-00049600: 3d20 4661 6c73 652c 2063 6d61 7020 3d20  = False, cmap = 
-00049610: 4e6f 6e65 293a 0d0a 0909 2727 2743 6f6e  None):....'''Con
-00049620: 7665 6e69 656e 6365 2066 756e 6374 696f  venience functio
-00049630: 6e20 7468 6174 2073 6574 7320 7361 7665  n that sets save
-00049640: 5f70 6c6f 7473 5f74 6f5f 666f 6c64 6572  _plots_to_folder
-00049650: 2074 656d 706f 7261 7269 6c79 2074 6f20   temporarily to 
-00049660: 7472 7565 2061 6e64 2072 6570 6c6f 7473  true and replots
-00049670: 2065 7665 7279 7468 696e 670d 0a09 090d   everything.....
-00049680: 0a09 0950 6172 616d 6574 6572 730d 0a09  ...Parameters...
-00049690: 092d 2d2d 2d2d 2d2d 2d2d 2d0d 0a09 090d  .----------.....
-000496a0: 0a09 0970 6174 6820 3a20 4e6f 6e65 2c20  ...path : None, 
-000496b0: 7374 7220 6f72 2070 6174 682c 206f 7074  str or path, opt
-000496c0: 696f 6e61 6c0d 0a09 0909 2844 6566 6175  ional.....(Defau
-000496d0: 6c74 2920 4e6f 6e65 2c20 6966 206c 6566  lt) None, if lef
-000496e0: 7420 6f6e 204e 6f6e 652c 2074 6865 6e20  t on None, then 
-000496f0: 6120 666f 6c64 6572 2022 7265 7375 6c74  a folder "result
-00049700: 5f66 6967 7572 6573 2220 6973 2063 7265  _figures" is cre
-00049710: 6174 6564 2069 6e20 7468 6520 666f 6c64  ated in the fold
-00049720: 6572 200d 0a09 0909 6f66 2074 6865 2064  er .....of the d
-00049730: 6174 6120 2873 656c 662e 7061 7468 290d  ata (self.path).
-00049740: 0a09 090d 0a09 0973 6176 6574 7970 6520  .......savetype 
-00049750: 3a20 7374 7220 6f72 2069 7465 7261 626c  : str or iterabl
-00049760: 6520 286f 6620 7374 7229 2c20 6f70 7469  e (of str), opti
-00049770: 6f6e 616c 200d 0a09 0909 6d61 7470 6c6f  onal .....matplo
-00049780: 746c 6962 2061 6c6c 6f77 7320 7468 6520  tlib allows the 
-00049790: 7361 7669 6e67 206f 6620 6669 6775 7265  saving of figure
-000497a0: 7320 696e 2076 6172 696f 7573 2066 6f72  s in various for
-000497b0: 6d61 7473 2e20 2844 6566 6175 6c74 2920  mats. (Default) 
-000497c0: 2270 6e67 222c 200d 0a09 0909 7479 7069  "png", .....typi
-000497d0: 6361 6c20 616e 6420 7265 636f 6d6d 656e  cal and recommen
-000497e0: 6461 626c 6520 6f70 7469 6f6e 7320 6172  dable options ar
-000497f0: 6520 2273 7667 2220 616e 6420 2270 6466  e "svg" and "pdf
-00049800: 222e 200d 0a09 0909 0d0a 0909 7469 746c  ". .........titl
-00049810: 6520 3a20 4e6f 6e65 206f 7220 7374 722c  e : None or str,
-00049820: 206f 7074 696f 6e61 6c0d 0a09 0909 2844   optional.....(D
-00049830: 6566 6175 6c74 2920 4e6f 6e65 2c20 5573  efault) None, Us
-00049840: 6520 7468 6973 2074 6974 6c65 206f 6e20  e this title on 
-00049850: 616c 6c20 706c 6f74 732e 2069 6620 4e6f  all plots. if No
-00049860: 6e65 2c20 7573 6520 7365 6c66 2e66 696c  ne, use self.fil
-00049870: 656e 616d 650d 0a09 0909 0d0a 0909 6669  ename.........fi
-00049880: 6c65 6e61 6d65 203a 2073 7472 2c20 6f70  lename : str, op
-00049890: 7469 6f6e 616c 0d0a 0909 0928 4465 6661  tional.....(Defa
-000498a0: 756c 7429 204e 6f6e 652c 2042 6173 6520  ult) None, Base 
-000498b0: 6e61 6d65 2066 6f72 2061 6c6c 2070 6c6f  name for all plo
-000498c0: 7473 2e20 4966 204e 6f6e 652c 2074 6865  ts. If None, the
-000498d0: 6e20 7365 6c66 2e66 696c 656e 616d 6520  n self.filename 
-000498e0: 7769 6c6c 2062 6520 7573 6564 0d0a 0909  will be used....
-000498f0: 090d 0a09 0973 6361 6c65 5f74 7970 6520  .....scale_type 
-00049900: 3a20 7374 722c 206f 7074 696f 6e61 6c0d  : str, optional.
-00049910: 0a09 0909 2273 796d 6c6f 6722 2028 4465  ...."symlog" (De
-00049920: 6661 756c 7429 2c20 226c 696e 6561 7222  fault), "linear"
-00049930: 2c20 226c 6f67 2220 7469 6d65 2061 7869  , "log" time axi
-00049940: 730d 0a09 0909 0d0a 0909 7061 7463 6865  s.........patche
-00049950: 7320 3a20 626f 6f6c 2c20 6f70 7469 6f6e  s : bool, option
-00049960: 616c 0d0a 0909 0946 6f72 2074 7275 6520  al.....For true 
-00049970: 7573 6520 7768 6974 6520 7061 7463 6865  use white patche
-00049980: 7320 746f 206c 6162 656c 2074 6869 6e67  s to label thing
-00049990: 7320 696e 2074 6865 2032 6420 6d61 7472  s in the 2d matr
-000499a0: 6978 6573 2c20 746f 2073 6166 650d 0a09  ixes, to safe...
-000499b0: 0909 7370 6163 6520 666f 7220 7075 626c  ..space for publ
-000499c0: 6963 6174 696f 6e0d 0a09 0909 0d0a 0909  ication.........
-000499d0: 636d 6170 203a 204e 6f6e 6520 6f72 206d  cmap : None or m
-000499e0: 6174 706c 6f74 6c69 6220 636f 6c6f 7220  atplotlib color 
-000499f0: 6d61 702c 206f 7074 696f 6e61 6c0d 0a09  map, optional...
-00049a00: 0909 6973 2061 2070 6f77 6572 6675 6c6c  ..is a powerfull
-00049a10: 2076 6172 6961 626c 6520 7468 6174 2063   variable that c
-00049a20: 686f 6f73 6573 2074 6865 2063 6f6c 6f75  hooses the colou
-00049a30: 7220 6d61 7020 6170 706c 6965 6420 666f  r map applied fo
-00049a40: 7220 616c 6c20 706c 6f74 732e 2049 6620  r all plots. If 
-00049a50: 7365 7420 746f 200d 0a09 0909 4e6f 6e65  set to .....None
-00049a60: 2028 4465 6661 756c 7429 2074 6865 6e20   (Default) then 
-00049a70: 7468 6520 7365 6c66 2e63 6d61 7020 6973  the self.cmap is
-00049a80: 2075 7365 642e 0d0a 0909 0941 7320 7374   used......As st
-00049a90: 616e 6461 7264 2049 2075 7365 2074 6865  andard I use the
-00049aa0: 2063 6f6c 6f72 206d 6170 2022 6a65 7422   color map "jet"
-00049ab0: 2066 726f 6d20 6d61 7470 6c6f 746c 6962   from matplotlib
-00049ac0: 2e20 5468 6572 6520 6172 6520 6120 7661  . There are a va
-00049ad0: 7269 6574 7920 6f66 2063 6f6c 6f72 6d61  riety of colorma
-00049ae0: 7073 200d 0a09 0909 6176 6169 6c61 626c  ps .....availabl
-00049af0: 6520 7468 6174 2061 7265 2076 6572 7920  e that are very 
-00049b00: 7573 6566 756c 6c2e 2042 6573 6964 6520  usefull. Beside 
-00049b10: 226a 6574 222c 2022 7669 7269 6469 7322  "jet", "viridis"
-00049b20: 2069 7320 6120 676f 6f64 2063 686f 6963   is a good choic
-00049b30: 6520 6173 2069 7420 6973 2077 656c 6c20  e as it is well 
-00049b40: 0d0a 0909 0976 6973 6962 6c65 2075 6e64  .....visible und
-00049b50: 6572 2072 6564 2d67 7265 656e 2062 6c69  er red-green bli
-00049b60: 6e64 6e65 7373 2e20 4f74 6865 7220 7573  ndness. Other us
-00049b70: 6566 756c 206d 6170 7320 6172 6520 2270  eful maps are "p
-00049b80: 7269 736d 2220 666f 7220 6869 6768 2066  rism" for high f
-00049b90: 6c75 6374 7561 7469 6f6e 7320 0d0a 0909  luctuations ....
-00049ba0: 096f 7220 6469 7665 7267 696e 6720 636f  .or diverging co
-00049bb0: 6c6f 7220 6d61 7073 206c 696b 6520 2273  lor maps like "s
-00049bc0: 6569 736d 6963 222e 200d 0a09 0909 5365  eismic". .....Se
-00049bd0: 6520 6874 7470 733a 2f2f 6d61 7470 6c6f  e https://matplo
-00049be0: 746c 6962 2e6f 7267 2f33 2e31 2e30 2f74  tlib.org/3.1.0/t
-00049bf0: 7574 6f72 6961 6c73 2f63 6f6c 6f72 732f  utorials/colors/
-00049c00: 636f 6c6f 726d 6170 732e 6874 6d6c 2066  colormaps.html f
-00049c10: 6f72 2061 2063 6f6d 7072 6568 656e 7369  or a comprehensi
-00049c20: 7665 200d 0a09 0909 7365 6c65 6374 696f  ve .....selectio
-00049c30: 6e2e 2049 6e20 7468 6520 636f 6465 2074  n. In the code t
-00049c40: 6865 2063 6f6c 6f72 6d61 7073 2061 7265  he colormaps are
-00049c50: 2069 6d70 6f72 7465 6420 736f 2069 6620   imported so if 
-00049c60: 706c 6f74 5f66 756e 6320 6973 2069 6d70  plot_func is imp
-00049c70: 6f72 7465 6420 6173 2070 6620 7468 656e  orted as pf then
-00049c80: 200d 0a09 0909 7365 6c66 2e63 6d61 703d   .....self.cmap=
-00049c90: 7066 2e63 6d2e 7669 7269 6469 7320 7365  pf.cm.viridis se
-00049ca0: 7473 2076 6972 6964 6973 2061 7320 7468  ts viridis as th
-00049cb0: 6520 6d61 7020 746f 2075 7365 2e20 496e  e map to use. In
-00049cc0: 7465 726e 616c 6c79 2074 6865 2063 6f6c  ternally the col
-00049cd0: 6f72 7320 6172 6520 6368 6f73 656e 200d  ors are chosen .
-00049ce0: 0a09 0909 7769 7468 2074 6865 2022 636f  ....with the "co
-00049cf0: 6c6d 2220 6675 6e63 7469 6f6e 2e20 5468  lm" function. Th
-00049d00: 6520 3264 2070 6c6f 7473 2072 6571 7569  e 2d plots requi
-00049d10: 7265 2061 2063 6f6e 7469 6e75 6f75 7320  re a continuous 
-00049d20: 636f 6c6f 7220 6d61 7020 736f 2069 6620  color map so if 
-00049d30: 736f 6d65 7468 696e 6720 0d0a 0909 0965  something .....e
-00049d40: 6c73 6520 6973 2067 6976 6520 3264 2070  lse is give 2d p
-00049d50: 6c6f 7473 2061 7265 2073 686f 776e 2061  lots are shown a
-00049d60: 7574 6f6d 6174 6963 616c 6c79 2077 6974  utomatically wit
-00049d70: 6820 226a 6574 222e 2046 6f72 2061 6c6c  h "jet". For all
-00049d80: 206f 6620 7468 6520 3164 2070 6c6f 7473   of the 1d plots
-00049d90: 2068 6f77 6576 6572 200d 0a09 0909 4920   however .....I 
-00049da0: 6669 7273 7420 7365 6c65 6374 2061 206e  first select a n
-00049db0: 756d 6265 7220 6f66 2063 6f6c 6f72 7320  umber of colors 
-00049dc0: 6265 666f 7265 2065 6163 6820 706c 6f74  before each plot
-00049dd0: 2e20 4966 2063 6d61 7020 6973 2061 2063  . If cmap is a c
-00049de0: 6f6e 7469 6e6f 7573 206d 6170 2074 6865  ontinous map the
-00049df0: 6e20 7468 6573 650d 0a09 0909 6172 6520  n these.....are 
-00049e00: 7361 6d70 6c65 6420 6576 656e 6c79 206f  sampled evenly o
-00049e10: 7665 7220 7468 6520 636f 6c6f 7572 6d61  ver the colourma
-00049e20: 702e 204d 616e 7561 6c20 6974 6572 6162  p. Manual iterab
-00049e30: 6c65 7320 6f66 2063 6f6c 6f75 7273 200d  les of colours .
-00049e40: 0a09 0909 636d 6170 3d5b 2831 2c30 2c30  ....cmap=[(1,0,0
-00049e50: 292c 2830 2c31 2c30 292c 2830 2c30 2c31  ),(0,1,0),(0,0,1
-00049e60: 292c 2e2e 2e5d 2061 7265 2061 6c73 6f20  ),...] are also 
-00049e70: 6163 6365 7074 6564 2c20 6173 2061 7265  accepted, as are
-00049e80: 2076 6563 746f 7273 206f 7220 6461 7461   vectors or data
-00049e90: 6672 616d 6573 2074 6861 7420 0d0a 0909  frames that ....
-00049ea0: 0963 6f6e 7461 696e 2061 7320 726f 7773  .contain as rows
-00049eb0: 2074 6865 2063 6f6c 6f72 732e 2054 6865   the colors. The
-00049ec0: 7265 206d 7573 7420 6265 206f 6620 636f  re must be of co
-00049ed0: 7572 7365 2073 7566 6669 6369 656e 7420  urse sufficient 
-00049ee0: 636f 6c6f 7273 2070 7265 7365 6e74 2066  colors present f
-00049ef0: 6f72 200d 0a09 0909 7468 6520 6e75 6d62  or .....the numb
-00049f00: 6572 7320 6f66 206c 696e 6573 2074 6861  ers of lines tha
-00049f10: 7420 7769 6c6c 2062 6520 706c 6f74 7465  t will be plotte
-00049f20: 642e 2053 6f20 4920 7265 636f 6d6d 656e  d. So I recommen
-00049f30: 6420 746f 2070 726f 7669 6465 2061 7420  d to provide at 
-00049f40: 6c65 6173 7420 3130 2063 6f6c 6f75 7273  least 10 colours
-00049f50: 200d 0a09 0909 2865 2e67 2e7e 796f 7572   .....(e.g.~your
-00049f60: 2075 6e69 7665 7273 6974 7920 636f 6c6f   university colo
-00049f70: 7273 292e 2063 6f6c 6f75 7273 2061 7265  rs). colours are
-00049f80: 2061 6c77 6179 7320 6769 7665 6e20 6173   always given as
-00049f90: 2061 2c20 6c69 7374 206f 7220 7475 706c   a, list or tupl
-00049fa0: 6520 7769 7468 2052 4741 206f 7220 5247  e with RGA or RG
-00049fb0: 4241 0d0a 0909 0928 7769 7468 2074 6865  BA.....(with the
-00049fc0: 206c 6173 7420 4120 6265 6569 6e67 2074   last A beeing t
-00049fd0: 6865 2041 6c70 6861 3d74 7261 6e73 7061  he Alpha=transpa
-00049fe0: 7265 6e63 792e 2041 6c6c 206e 756d 6265  rency. All numbe
-00049ff0: 7273 2061 7265 2062 6574 7765 656e 2030  rs are between 0
-0004a000: 2061 6e64 2031 2e20 0d0a 0909 0949 6620   and 1. .....If 
-0004a010: 6120 6c69 7374 2f76 6563 746f 722f 4461  a list/vector/Da
-0004a020: 7461 4672 616d 6520 6973 2067 6976 656e  taFrame is given
-0004a030: 2066 6f72 2074 6865 2063 6f6c 6f75 7273   for the colours
-0004a040: 2074 6865 7920 7769 6c6c 2062 6520 7573   they will be us
-0004a050: 6564 2069 6e20 7468 6520 6f72 6465 7220  ed in the order 
-0004a060: 7072 6f76 6964 6564 2e0d 0a09 090d 0a09  provided........
-0004a070: 0945 7861 6d70 6c65 730d 0a09 092d 2d2d  .Examples....---
-0004a080: 2d2d 2d2d 2d2d 0d0a 0909 0d0a 0909 3e3e  ------........>>
-0004a090: 3e20 7461 2e53 6176 655f 506c 6f74 7328  > ta.Save_Plots(
-0004a0a0: 290d 0a09 093e 3e3e 2074 612e 5361 7665  )....>>> ta.Save
-0004a0b0: 5f50 6c6f 7473 2870 6174 6368 6573 203d  _Plots(patches =
-0004a0c0: 2054 7275 6529 0d0a 0909 0d0a 0909 2727   True)........''
-0004a0d0: 270d 0a09 0969 6620 636d 6170 2069 7320  '....if cmap is 
-0004a0e0: 4e6f 6e65 3a63 6d61 703d 7365 6c66 2e63  None:cmap=self.c
-0004a0f0: 6d61 700d 0a09 0969 6620 7361 7665 7479  map....if savety
-0004a100: 7065 2069 7320 4e6f 6e65 3a0d 0a09 0909  pe is None:.....
-0004a110: 7361 7665 7479 7065 3d5b 2770 6e67 275d  savetype=['png']
-0004a120: 0d0a 0909 656c 6966 2073 6176 6574 7970  ....elif savetyp
-0004a130: 6520 696e 205b 2770 6e67 272c 2770 6466  e in ['png','pdf
-0004a140: 272c 2773 7667 275d 3a73 6176 6574 7970  ','svg']:savetyp
-0004a150: 653d 5b73 6176 6574 7970 655d 0d0a 0909  e=[savetype]....
-0004a160: 656c 6966 2068 6173 6174 7472 2873 6176  elif hasattr(sav
-0004a170: 6574 7970 652c 225f 5f69 7465 725f 5f22  etype,"__iter__"
-0004a180: 293a 7361 7665 7479 7065 3d6c 6973 7428  ):savetype=list(
-0004a190: 7361 7665 7479 7065 290d 0a09 0965 6c73  savetype)....els
-0004a1a0: 653a 0d0a 0909 0970 7269 6e74 2827 506c  e:.....print('Pl
-0004a1b0: 6561 7365 2073 7065 6369 6679 2061 2073  ease specify a s
-0004a1c0: 696e 676c 6520 6669 6c65 7479 7065 2066  ingle filetype f
-0004a1d0: 726f 6d20 5c27 706e 675c 272c 5c27 7064  rom \'png\',\'pd
-0004a1e0: 665c 272c 5c27 7376 675c 2720 6f72 2061  f\',\'svg\' or a
-0004a1f0: 206c 6973 7420 6f66 2074 686f 7365 2e20   list of those. 
-0004a200: 4e6f 7468 696e 6720 7761 7320 7361 7665  Nothing was save
-0004a210: 6427 290d 0a09 0909 7265 7475 726e 2046  d').....return F
-0004a220: 616c 7365 0d0a 0909 6966 2063 6d61 7020  alse....if cmap 
-0004a230: 6973 204e 6f6e 653a 636d 6170 3d73 7461  is None:cmap=sta
-0004a240: 6e64 6172 645f 6d61 700d 0a09 096f 7269  ndard_map....ori
-0004a250: 6769 6e3d 7365 6c66 2e73 6176 655f 6669  gin=self.save_fi
-0004a260: 6775 7265 735f 746f 5f66 6f6c 6465 720d  gures_to_folder.
-0004a270: 0a09 0973 656c 662e 7361 7665 5f66 6967  ...self.save_fig
-0004a280: 7572 6573 5f74 6f5f 666f 6c64 6572 3d54  ures_to_folder=T
-0004a290: 7275 650d 0a09 0974 7279 3a0d 0a09 0909  rue....try:.....
-0004a2a0: 666f 7220 7420 696e 2073 6176 6574 7970  for t in savetyp
-0004a2b0: 653a 0d0a 0909 0909 706c 742e 636c 6f73  e:......plt.clos
-0004a2c0: 6528 2761 6c6c 2729 0d0a 0909 0909 7365  e('all')......se
-0004a2d0: 6c66 2e50 6c6f 745f 5241 5728 7361 7665  lf.Plot_RAW(save
-0004a2e0: 7479 7065 203d 2074 2c20 7061 7468 203d  type = t, path =
-0004a2f0: 2070 6174 682c 2063 6d61 7020 3d20 636d   path, cmap = cm
-0004a300: 6170 2c20 7469 746c 6520 3d20 7469 746c  ap, title = titl
-0004a310: 652c 200d 0a09 0909 0909 0909 0973 6361  e, ..........sca
-0004a320: 6c65 5f74 7970 6520 3d20 7363 616c 655f  le_type = scale_
-0004a330: 7479 7065 2c20 6669 6c65 6e61 6d65 203d  type, filename =
-0004a340: 2066 696c 656e 616d 652c 2075 6e69 7473   filename, units
-0004a350: 3d73 656c 662e 756e 6974 732c 200d 0a09  =self.units, ...
-0004a360: 0909 0909 0909 0965 7175 616c 5f65 6e65  .......equal_ene
-0004a370: 7267 795f 6269 6e20 3d20 7365 6c66 2e65  rgy_bin = self.e
-0004a380: 7175 616c 5f65 6e65 7267 795f 6269 6e29  qual_energy_bin)
-0004a390: 0d0a 0909 0909 706c 742e 636c 6f73 6528  ......plt.close(
-0004a3a0: 2761 6c6c 2729 0d0a 0909 0909 7072 696e  'all')......prin
-0004a3b0: 7428 2773 6176 6564 2052 4157 2070 6c6f  t('saved RAW plo
-0004a3c0: 7473 2074 7970 6520 2573 2074 6f20 2573  ts type %s to %s
-0004a3d0: 2725 2874 2c63 6865 636b 5f66 6f6c 6465  '%(t,check_folde
-0004a3e0: 7228 7061 7468 3d70 6174 682c 6375 7272  r(path=path,curr
-0004a3f0: 656e 745f 7061 7468 3d73 656c 662e 7061  ent_path=self.pa
-0004a400: 7468 2929 290d 0a09 0965 7863 6570 743a  th)))....except:
-0004a410: 0d0a 0909 0970 7269 6e74 2827 5361 7669  .....print('Savi
-0004a420: 6e67 206f 6620 5261 7720 706c 6f74 7320  ng of Raw plots 
-0004a430: 666f 7220 6669 6c65 7479 7065 2025 7320  for filetype %s 
-0004a440: 6661 696c 6564 2725 7429 0d0a 0909 7472  failed'%t)....tr
-0004a450: 793a 0d0a 0909 0966 6f72 2074 2069 6e20  y:.....for t in 
-0004a460: 7361 7665 7479 7065 3a0d 0a09 0909 0970  savetype:......p
-0004a470: 6c74 2e63 6c6f 7365 2827 616c 6c27 290d  lt.close('all').
-0004a480: 0a09 0909 0973 656c 662e 506c 6f74 5f66  .....self.Plot_f
-0004a490: 6974 5f6f 7574 7075 7428 7361 7665 7479  it_output(savety
-0004a4a0: 7065 3d74 2c70 6174 683d 7061 7468 2c63  pe=t,path=path,c
-0004a4b0: 6d61 703d 636d 6170 2c74 6974 6c65 3d74  map=cmap,title=t
-0004a4c0: 6974 6c65 2c73 6361 6c65 5f74 7970 653d  itle,scale_type=
-0004a4d0: 7363 616c 655f 7479 7065 2c70 6174 6368  scale_type,patch
-0004a4e0: 6573 3d70 6174 6368 6573 2c66 696c 656e  es=patches,filen
-0004a4f0: 616d 653d 6669 6c65 6e61 6d65 290d 0a09  ame=filename)...
-0004a500: 0909 0970 6c74 2e63 6c6f 7365 2827 616c  ...plt.close('al
-0004a510: 6c27 290d 0a09 0909 0970 7269 6e74 2827  l')......print('
-0004a520: 5361 7665 6420 4669 7420 706c 6f74 7320  Saved Fit plots 
-0004a530: 6f66 2074 7970 6520 2573 2074 6f20 2573  of type %s to %s
-0004a540: 2725 2874 2c63 6865 636b 5f66 6f6c 6465  '%(t,check_folde
-0004a550: 7228 7061 7468 3d70 6174 682c 6375 7272  r(path=path,curr
-0004a560: 656e 745f 7061 7468 3d73 656c 662e 7061  ent_path=self.pa
-0004a570: 7468 2929 290d 0a09 0965 7863 6570 743a  th)))....except:
-0004a580: 0d0a 0909 0970 7269 6e74 2827 5361 7669  .....print('Savi
-0004a590: 6e67 206f 6620 4669 7420 706c 6f74 7320  ng of Fit plots 
-0004a5a0: 666f 7220 6669 6c65 7479 7065 2025 7320  for filetype %s 
-0004a5b0: 6661 696c 6564 2725 7429 0d0a 0909 7365  failed'%t)....se
-0004a5c0: 6c66 2e73 6176 655f 6669 6775 7265 735f  lf.save_figures_
-0004a5d0: 746f 5f66 6f6c 6465 723d 6f72 6967 696e  to_folder=origin
-0004a5e0: 0d0a 0d0a 0d0a 0964 6566 205f 5f46 6974  .......def __Fit
-0004a5f0: 5f43 6869 7270 5f69 6e6e 6572 2809 7365  _Chirp_inner(.se
-0004a600: 6c66 2c20 6f70 745f 636f 6566 662c 2069  lf, opt_coeff, i
-0004a610: 6e69 7469 616c 5f66 6974 5f63 6f65 6666  nitial_fit_coeff
-0004a620: 203d 204e 6f6e 652c 2070 6172 616d 7320   = None, params 
-0004a630: 3d20 4e6f 6e65 2c20 7363 6174 7465 7263  = None, scatterc
-0004a640: 7574 203d 204e 6f6e 652c 2062 6f72 6465  ut = None, borde
-0004a650: 7263 7574 203d 204e 6f6e 652c 200d 0a09  rcut = None, ...
-0004a660: 0909 0909 0909 7469 6d65 6c69 6d69 7473  ......timelimits
-0004a670: 203d 204e 6f6e 652c 2077 6176 655f 6e6d   = None, wave_nm
-0004a680: 5f62 696e 203d 204e 6f6e 652c 2074 696d  _bin = None, tim
-0004a690: 655f 6269 6e20 3d20 4e6f 6e65 2c20 6d6f  e_bin = None, mo
-0004a6a0: 6420 3d20 4e6f 6e65 2c20 6c6f 675f 6669  d = None, log_fi
-0004a6b0: 7420 3d20 4e6f 6e65 2c20 6473 5f62 6163  t = None, ds_bac
-0004a6c0: 6b5f 636f 7272 203d 204e 6f6e 6529 3a0d  k_corr = None):.
-0004a6d0: 0a09 0927 2727 2046 756e 6374 696f 6e20  ...''' Function 
-0004a6e0: 746f 2063 616c 6375 6c61 7465 2061 206e  to calculate a n
-0004a6f0: 6577 2063 6869 7270 2063 6f72 7265 6374  ew chirp correct
-0004a700: 6564 206d 6174 7269 7820 616e 6420 7265  ed matrix and re
-0004a710: 7475 726e 2061 6e20 6572 726f 7220 7661  turn an error va
-0004a720: 6c75 652c 2020 5468 6520 2263 6f73 7420  lue,  The "cost 
-0004a730: 6675 6e63 7469 6f6e 2220 666f 7220 7468  function" for th
-0004a740: 6520 6368 6972 7020 6f70 7469 6d69 7a61  e chirp optimiza
-0004a750: 7469 6f6e 200d 0a09 0927 2727 0d0a 0909  tion ....'''....
-0004a760: 6669 7463 6f65 6666 203d 206e 702e 6172  fitcoeff = np.ar
-0004a770: 7261 7928 5b6f 7074 5f63 6f65 6666 5b27  ray([opt_coeff['
-0004a780: 7034 275d 2e76 616c 7565 2c20 6f70 745f  p4'].value, opt_
-0004a790: 636f 6566 665b 2770 3327 5d2e 7661 6c75  coeff['p3'].valu
-0004a7a0: 652c 206f 7074 5f63 6f65 6666 5b27 7032  e, opt_coeff['p2
+00036be0: 0909 0909 6c61 6265 6c73 5b2d 315d 3d27  ....labels[-1]='
+00036bf0: 6261 636b 6772 6f75 6e64 270d 0a09 0909  background'.....
+00036c00: 0909 0965 6c73 653a 0d0a 0909 0909 0909  ...else:........
+00036c10: 0969 6620 2769 6e66 696e 6974 6527 2069  .if 'infinite' i
+00036c20: 6e20 6c69 7374 2870 6172 6466 2e69 6e64  n list(pardf.ind
+00036c30: 6578 2e76 616c 7565 7329 3a0d 0a09 0909  ex.values):.....
+00036c40: 0909 0909 096c 6162 656c 735b 2d31 5d3d  .....labels[-1]=
+00036c50: 274e 6f6e 2044 6563 6179 696e 6727 0d0a  'Non Decaying'..
+00036c60: 0909 0920 2020 0d0a 0909 0909 0909 0965  ...   .........e
+00036c70: 6c73 653a 6368 616e 6765 643d 4661 6c73  lse:changed=Fals
+00036c80: 650d 0a09 0909 0909 0969 6620 6368 616e  e........if chan
+00036c90: 6765 643a 0d0a 0909 0909 0909 0972 655b  ged:.........re[
+00036ca0: 2744 4143 275d 2e63 6f6c 756d 6e73 3d6c  'DAC'].columns=l
+00036cb0: 6162 656c 730d 0a09 0909 0909 0909 7265  abels.........re
+00036cc0: 5b27 6327 5d2e 636f 6c75 6d6e 733d 6c61  ['c'].columns=la
+00036cd0: 6265 6c73 0d0a 0909 0909 0909 6966 206e  bels........if n
+00036ce0: 6f74 2065 7874 5f73 7065 6374 7261 2069  ot ext_spectra i
+00036cf0: 7320 4e6f 6e65 3a0d 0a09 0909 0909 0909  s None:.........
+00036d00: 666f 7220 636f 6c20 696e 2065 7874 5f73  for col in ext_s
+00036d10: 7065 6374 7261 2e63 6f6c 756d 6e73 3a0d  pectra.columns:.
+00036d20: 0a09 0909 0909 0909 0972 655b 2744 4143  .........re['DAC
+00036d30: 275d 5b63 6f6c 5d3d 6578 745f 7370 6563  '][col]=ext_spec
+00036d40: 7472 612e 6c6f 635b 3a2c 636f 6c5d 2e76  tra.loc[:,col].v
+00036d50: 616c 7565 730d 0a09 0909 0909 0909 0972  alues..........r
+00036d60: 655b 2763 275d 5b63 6f6c 5d3d 632e 6c6f  e['c'][col]=c.lo
+00036d70: 635b 3a2c 636f 6c5d 2e76 616c 7565 730d  c[:,col].values.
+00036d80: 0a09 0909 0909 0909 0941 2c42 3d6e 702e  .........A,B=np.
+00036d90: 6d65 7368 6772 6964 2863 2e6c 6f63 5b3a  meshgrid(c.loc[:
+00036da0: 2c63 6f6c 5d2e 7661 6c75 6573 2c65 7874  ,col].values,ext
+00036db0: 5f73 7065 6374 7261 2e6c 6f63 5b3a 2c63  _spectra.loc[:,c
+00036dc0: 6f6c 5d2e 7661 6c75 6573 290d 0a09 0909  ol].values).....
+00036dd0: 0909 0909 0943 3d70 616e 6461 732e 4461  .....C=pandas.Da
+00036de0: 7461 4672 616d 6528 2841 2a42 292e 542c  taFrame((A*B).T,
+00036df0: 696e 6465 783d 632e 696e 6465 782c 636f  index=c.index,co
+00036e00: 6c75 6d6e 733d 6578 745f 7370 6563 7472  lumns=ext_spectr
+00036e10: 612e 696e 6465 782e 7661 6c75 6573 290d  a.index.values).
+00036e20: 0a09 0909 0909 0909 0972 655b 2741 275d  .........re['A']
+00036e30: 3d72 655b 2741 275d 2b43 0d0a 0909 0909  =re['A']+C......
+00036e40: 0909 0909 7265 5b27 4143 275d 3d72 655b  ....re['AC']=re[
+00036e50: 2741 4327 5d2b 4309 0d0a 0909 0909 0909  'AC']+C.........
+00036e60: 7265 5f66 696e 616c 3d72 652e 636f 7079  re_final=re.copy
+00036e70: 2829 0d0a 0909 0909 0965 7272 6f72 5f6c  ().......error_l
+00036e80: 6973 7465 6e2e 6170 7065 6e64 2872 655b  isten.append(re[
+00036e90: 2765 7272 6f72 275d 290d 0a09 0909 0909  'error']).......
+00036ea0: 7232 5f6c 6973 7465 6e2e 6170 7065 6e64  r2_listen.append
+00036eb0: 2831 2d72 655b 2765 7272 6f72 275d 2f28  (1-re['error']/(
+00036ec0: 2872 655b 2741 275d 2d72 655b 2741 275d  (re['A']-re['A']
+00036ed0: 2e6d 6561 6e28 292e 6d65 616e 2829 292a  .mean().mean())*
+00036ee0: 2a32 292e 7375 6d28 292e 7375 6d28 2929  *2).sum().sum())
+00036ef0: 0d0a 0909 0909 656c 7365 3a0d 0a09 0909  ......else:.....
+00036f00: 0909 6966 2064 756d 705f 7368 6170 6573  ..if dump_shapes
+00036f10: 3a0d 0a09 0909 0909 0972 655b 2763 275d  :........re['c']
+00036f20: 2e74 6f5f 6373 7628 7061 7468 5f6f 725f  .to_csv(path_or_
+00036f30: 6275 663d 7461 2e66 696c 656e 616d 6520  buf=ta.filename 
+00036f40: 2b20 275f 6327 290d 0a09 0909 0909 0972  + '_c')........r
+00036f50: 655b 2744 4143 275d 2e74 6f5f 6373 7628  e['DAC'].to_csv(
+00036f60: 7061 7468 5f6f 725f 6275 663d 7461 2e66  path_or_buf=ta.f
+00036f70: 696c 656e 616d 6520 2b20 275f 4441 4327  ilename + '_DAC'
+00036f80: 290d 0a09 0909 0909 6572 726f 725f 6c69  ).......error_li
+00036f90: 7374 656e 2e61 7070 656e 6428 7265 5b27  sten.append(re['
+00036fa0: 6572 726f 7227 5d29 0d0a 0909 0965 6c73  error']).....els
+00036fb0: 653a 0d0a 0909 0909 633d 6d6f 6428 7469  e:......c=mod(ti
+00036fc0: 6d65 733d 6473 2e69 6e64 6578 2e76 616c  mes=ds.index.val
+00036fd0: 7565 732e 6173 7479 7065 2827 666c 6f61  ues.astype('floa
+00036fe0: 7427 292c 7061 7264 663d 7061 7264 662e  t'),pardf=pardf.
+00036ff0: 6c6f 635b 3a2c 2776 616c 7565 275d 290d  loc[:,'value']).
+00037000: 0a09 0909 0969 6620 6578 745f 7370 6563  .....if ext_spec
+00037010: 7472 6120 6973 204e 6f6e 653a 0d0a 0909  tra is None:....
+00037020: 0909 0972 653d 6669 6c6c 5f69 6e74 2864  ...re=fill_int(d
+00037030: 733d 6473 2c63 3d63 2c20 7265 7475 726e  s=ds,c=c, return
+00037040: 5f73 6861 7065 7320 3d20 6475 6d70 5f73  _shapes = dump_s
+00037050: 6861 7065 7329 0d0a 0909 0909 656c 7365  hapes)......else
+00037060: 3a0d 0a09 0909 0909 6578 745f 7370 6563  :.......ext_spec
+00037070: 7472 613d 7265 6269 6e28 6578 745f 7370  tra=rebin(ext_sp
+00037080: 6563 7472 612c 6473 2e63 6f6c 756d 6e73  ectra,ds.columns
+00037090: 2e76 616c 7565 732e 6173 7479 7065 2866  .values.astype(f
+000370a0: 6c6f 6174 2929 0d0a 0909 0909 0963 5f74  loat)).......c_t
+000370b0: 656d 703d 632e 636f 7079 2829 0d0a 0909  emp=c.copy()....
+000370c0: 0909 0966 6f72 2063 6f6c 2069 6e20 6578  ...for col in ex
+000370d0: 745f 7370 6563 7472 612e 636f 6c75 6d6e  t_spectra.column
+000370e0: 733a 0d0a 0909 0909 0909 412c 423d 6e70  s:........A,B=np
+000370f0: 2e6d 6573 6867 7269 6428 632e 6c6f 635b  .meshgrid(c.loc[
+00037100: 3a2c 636f 6c5d 2e76 616c 7565 732c 6578  :,col].values,ex
+00037110: 745f 7370 6563 7472 612e 6c6f 635b 3a2c  t_spectra.loc[:,
+00037120: 636f 6c5d 2e76 616c 7565 7329 0d0a 0909  col].values)....
+00037130: 0909 0909 433d 7061 6e64 6173 2e44 6174  ....C=pandas.Dat
+00037140: 6146 7261 6d65 2828 412a 4229 2e54 2c69  aFrame((A*B).T,i
+00037150: 6e64 6578 3d63 2e69 6e64 6578 2c63 6f6c  ndex=c.index,col
+00037160: 756d 6e73 3d65 7874 5f73 7065 6374 7261  umns=ext_spectra
+00037170: 2e69 6e64 6578 2e76 616c 7565 7329 0d0a  .index.values)..
+00037180: 0909 0909 0909 6473 3d64 732d 430d 0a09  ......ds=ds-C...
+00037190: 0909 0909 0963 5f74 656d 702e 6472 6f70  .....c_temp.drop
+000371a0: 2863 6f6c 2c61 7869 733d 312c 696e 706c  (col,axis=1,inpl
+000371b0: 6163 653d 5472 7565 290d 0a09 0909 0909  ace=True).......
+000371c0: 7265 3d66 696c 6c5f 696e 7428 6473 3d64  re=fill_int(ds=d
+000371d0: 732c 633d 635f 7465 6d70 2c20 7265 7475  s,c=c_temp, retu
+000371e0: 726e 5f73 6861 7065 7320 3d20 6475 6d70  rn_shapes = dump
+000371f0: 5f73 6861 7065 7329 0d0a 0909 0909 6966  _shapes)......if
+00037200: 2066 696e 616c 3a0d 0a09 0909 0909 6966   final:.......if
+00037210: 2069 3d3d 303a 0d0a 0909 0909 0909 7265   i==0:........re
+00037220: 5b27 4441 4327 5d2e 636f 6c75 6d6e 733d  ['DAC'].columns=
+00037230: 632e 636f 6c75 6d6e 732e 7661 6c75 6573  c.columns.values
+00037240: 0d0a 0909 0909 0909 7265 5b27 6327 5d2e  ........re['c'].
+00037250: 636f 6c75 6d6e 733d 632e 636f 6c75 6d6e  columns=c.column
+00037260: 732e 7661 6c75 6573 0d0a 0909 0909 0909  s.values........
+00037270: 6966 206e 6f74 2065 7874 5f73 7065 6374  if not ext_spect
+00037280: 7261 2069 7320 4e6f 6e65 3a0d 0a09 0909  ra is None:.....
+00037290: 0909 0909 666f 7220 636f 6c20 696e 2065  ....for col in e
+000372a0: 7874 5f73 7065 6374 7261 2e63 6f6c 756d  xt_spectra.colum
+000372b0: 6e73 3a0d 0a09 0909 0909 0909 0972 655b  ns:..........re[
+000372c0: 2744 4143 275d 5b63 6f6c 5d3d 6578 745f  'DAC'][col]=ext_
+000372d0: 7370 6563 7472 612e 6c6f 635b 3a2c 636f  spectra.loc[:,co
+000372e0: 6c5d 2e76 616c 7565 730d 0a09 0909 0909  l].values.......
+000372f0: 0909 0972 655b 2763 275d 5b63 6f6c 5d3d  ...re['c'][col]=
+00037300: 632e 6c6f 635b 3a2c 636f 6c5d 2e76 616c  c.loc[:,col].val
+00037310: 7565 730d 0a09 0909 0909 0909 0941 2c42  ues..........A,B
+00037320: 3d6e 702e 6d65 7368 6772 6964 2863 2e6c  =np.meshgrid(c.l
+00037330: 6f63 5b3a 2c63 6f6c 5d2e 7661 6c75 6573  oc[:,col].values
+00037340: 2c65 7874 5f73 7065 6374 7261 2e6c 6f63  ,ext_spectra.loc
+00037350: 5b3a 2c63 6f6c 5d2e 7661 6c75 6573 290d  [:,col].values).
+00037360: 0a09 0909 0909 0909 0943 3d70 616e 6461  .........C=panda
+00037370: 732e 4461 7461 4672 616d 6528 2841 2a42  s.DataFrame((A*B
+00037380: 292e 542c 696e 6465 783d 632e 696e 6465  ).T,index=c.inde
+00037390: 782c 636f 6c75 6d6e 733d 6578 745f 7370  x,columns=ext_sp
+000373a0: 6563 7472 612e 696e 6465 782e 7661 6c75  ectra.index.valu
+000373b0: 6573 290d 0a09 0909 0909 0909 0972 655b  es)..........re[
+000373c0: 2741 275d 3d72 655b 2741 275d 2b43 0d0a  'A']=re['A']+C..
+000373d0: 0909 0909 0909 0909 7265 5b27 4143 275d  ........re['AC']
+000373e0: 3d72 655b 2741 4327 5d2b 4309 0d0a 0909  =re['AC']+C.....
+000373f0: 0909 0909 7265 5f66 696e 616c 3d72 652e  ....re_final=re.
+00037400: 636f 7079 2829 0d0a 0909 0909 0965 7272  copy().......err
+00037410: 6f72 5f6c 6973 7465 6e2e 6170 7065 6e64  or_listen.append
+00037420: 2872 655b 2765 7272 6f72 275d 290d 0a09  (re['error'])...
+00037430: 0909 0909 7232 5f6c 6973 7465 6e2e 6170  ....r2_listen.ap
+00037440: 7065 6e64 2831 2d72 655b 2765 7272 6f72  pend(1-re['error
+00037450: 275d 2f28 2872 655b 2741 275d 2d72 655b  ']/((re['A']-re[
+00037460: 2741 275d 2e6d 6561 6e28 292e 6d65 616e  'A'].mean().mean
+00037470: 2829 292a 2a32 292e 7375 6d28 292e 7375  ())**2).sum().su
+00037480: 6d28 2929 0d0a 0909 0909 656c 7365 3a0d  m())......else:.
+00037490: 0a09 0909 0909 6966 2064 756d 705f 7368  ......if dump_sh
+000374a0: 6170 6573 3a0d 0a09 0909 0909 0972 655b  apes:........re[
+000374b0: 2763 275d 2e74 6f5f 6373 7628 7061 7468  'c'].to_csv(path
+000374c0: 5f6f 725f 6275 663d 6669 6c65 6e61 6d65  _or_buf=filename
+000374d0: 202b 2027 5f63 2729 0d0a 0909 0909 0909   + '_c')........
+000374e0: 7265 5b27 4441 4327 5d2e 746f 5f63 7376  re['DAC'].to_csv
+000374f0: 2870 6174 685f 6f72 5f62 7566 3d66 696c  (path_or_buf=fil
+00037500: 656e 616d 6520 2b20 275f 4441 4327 290d  ename + '_DAC').
+00037510: 0a09 0909 0909 6572 726f 725f 6c69 7374  ......error_list
+00037520: 656e 2e61 7070 656e 6428 7265 5b27 6572  en.append(re['er
+00037530: 726f 7227 5d29 0d0a 0909 6966 206e 6f74  ror'])....if not
+00037540: 2077 6569 6768 7473 2069 7320 4e6f 6e65   weights is None
+00037550: 3a0d 0a09 0909 6966 206c 656e 2877 6569  :.....if len(wei
+00037560: 6768 7473 293d 3d6c 656e 2865 7272 6f72  ghts)==len(error
+00037570: 5f6c 6973 7465 6e29 2d31 3a0d 0a09 0909  _listen)-1:.....
+00037580: 0977 6569 6768 7473 3d6c 6973 7428 7765  .weights=list(we
+00037590: 6967 6874 7329 0d0a 0909 0909 7765 6967  ights)......weig
+000375a0: 6874 732e 696e 7365 7274 2830 2c31 290d  hts.insert(0,1).
+000375b0: 0a09 0909 656c 6966 206c 656e 2877 6569  ....elif len(wei
+000375c0: 6768 7473 2921 3d6c 656e 2865 7272 6f72  ghts)!=len(error
+000375d0: 5f6c 6973 7465 6e29 3a0d 0a09 0909 0945  _listen):......E
+000375e0: 7820 3d20 5661 6c75 6545 7272 6f72 2829  x = ValueError()
+000375f0: 0d0a 0909 0909 4578 2e73 7472 6572 726f  ......Ex.strerro
+00037600: 723d 2754 6865 206e 756d 6265 7220 6f66  r='The number of
+00037610: 2065 6e74 7269 6573 2069 2074 6865 206c   entries i the l
+00037620: 6973 7420 6d75 7374 2065 6974 6865 7220  ist must either 
+00037630: 6265 2074 6865 206e 756d 6265 7220 6f66  be the number of
+00037640: 2061 6c6c 2065 6c65 6d65 6e74 7320 2869   all elements (i
+00037650: 6e63 6c75 6469 6e67 205c 2254 415c 2220  ncluding \"TA\" 
+00037660: 6f72 2074 6865 206e 756d 6265 7220 6f66  or the number of
+00037670: 2065 6c65 6d65 6e74 7320 696e 206f 7468   elements in oth
+00037680: 6572 2e20 496e 2074 6869 7320 6361 7365  er. In this case
+00037690: 2074 6865 2065 6c65 6d65 6e74 2074 6120   the element ta 
+000376a0: 6765 7473 2074 6865 2077 6569 6768 743d  gets the weight=
+000376b0: 3127 0d0a 0909 0909 7261 6973 6520 4578  1'......raise Ex
+000376c0: 0d0a 0909 0963 6f6d 6269 6e65 645f 6572  .....combined_er
+000376d0: 726f 723d 6e70 2e73 7172 7428 2828 6e70  ror=np.sqrt(((np
+000376e0: 2e61 7272 6179 2865 7272 6f72 5f6c 6973  .array(error_lis
+000376f0: 7465 6e29 2a6e 702e 6172 7261 7928 7765  ten)*np.array(we
+00037700: 6967 6874 7329 292a 2a32 292e 6d65 616e  ights))**2).mean
+00037710: 2829 290d 0a09 0909 6966 2066 696e 616c  ()).....if final
+00037720: 3a0d 0a09 0909 0963 6f6d 6269 6e65 645f  :......combined_
+00037730: 7232 3d6e 702e 7371 7274 2828 286e 702e  r2=np.sqrt(((np.
+00037740: 6172 7261 7928 7232 5f6c 6973 7465 6e29  array(r2_listen)
+00037750: 2a6e 702e 6172 7261 7928 7765 6967 6874  *np.array(weight
+00037760: 7329 292a 2a32 292e 6d65 616e 2829 290d  s))**2).mean()).
+00037770: 0a09 0965 6c73 653a 0d0a 0909 0963 6f6d  ...else:.....com
+00037780: 6269 6e65 645f 6572 726f 723d 6e70 2e73  bined_error=np.s
+00037790: 7172 7428 286e 702e 6172 7261 7928 6572  qrt((np.array(er
+000377a0: 726f 725f 6c69 7374 656e 292a 2a32 292e  ror_listen)**2).
+000377b0: 6d65 616e 2829 290d 0a09 0909 6966 2066  mean()).....if f
+000377c0: 696e 616c 3a0d 0a09 0909 0963 6f6d 6269  inal:......combi
+000377d0: 6e65 645f 7232 3d6e 702e 7371 7274 2828  ned_r2=np.sqrt((
+000377e0: 286e 702e 6172 7261 7928 7232 5f6c 6973  (np.array(r2_lis
+000377f0: 7465 6e29 292a 2a32 292e 6d65 616e 2829  ten))**2).mean()
+00037800: 290d 0a09 0969 6620 6669 6e61 6c3a 0d0a  )....if final:..
+00037810: 0909 0972 655f 6669 6e61 6c5b 2765 7272  ...re_final['err
+00037820: 6f72 275d 3d63 6f6d 6269 6e65 645f 6572  or']=combined_er
+00037830: 726f 720d 0a09 0909 7265 5f66 696e 616c  ror.....re_final
+00037840: 5b27 7232 275d 3d63 6f6d 6269 6e65 645f  ['r2']=combined_
+00037850: 7232 0d0a 0909 6966 2064 756d 705f 7061  r2....if dump_pa
+00037860: 7261 733a 0d0a 0909 0974 7279 3a0d 0a09  ras:.....try:...
+00037870: 0909 0970 6172 6466 2e6c 6f63 5b27 6572  ...pardf.loc['er
+00037880: 726f 7227 2c27 7661 6c75 6527 5d3d 636f  ror','value']=co
+00037890: 6d62 696e 6564 5f65 7272 6f72 0d0a 0909  mbined_error....
+000378a0: 0965 7863 6570 743a 0d0a 0909 0909 7061  .except:......pa
+000378b0: 7373 0d0a 0909 0974 7279 3a0d 0a09 0909  ss.....try:.....
+000378c0: 0970 6172 6466 2e6c 6f63 5b27 7232 272c  .pardf.loc['r2',
+000378d0: 2776 616c 7565 275d 3d63 6f6d 6269 6e65  'value']=combine
+000378e0: 645f 7232 0d0a 0909 0965 7863 6570 743a  d_r2.....except:
+000378f0: 0d0a 0909 0909 7061 7373 0d0a 0909 0974  ......pass.....t
+00037900: 7279 3a0d 0a09 0909 0969 6620 6669 6c65  ry:......if file
+00037910: 6e61 6d65 2069 7320 4e6f 6e65 3a0d 0a09  name is None:...
+00037920: 0909 0909 7374 6f72 655f 6e61 6d65 3d27  ....store_name='
+00037930: 6d69 6e69 6d61 6c5f 6475 6d70 5f70 6172  minimal_dump_par
+00037940: 6173 2e70 6172 270d 0a09 0909 0965 6c73  as.par'......els
+00037950: 653a 0d0a 0909 0909 0973 746f 7265 5f6e  e:.......store_n
+00037960: 616d 653d 276d 696e 696d 616c 5f64 756d  ame='minimal_dum
+00037970: 705f 7061 7261 735f 2573 2e70 6172 2725  p_paras_%s.par'%
+00037980: 6669 6c65 6e61 6d65 0d0a 0909 0909 6d69  filename......mi
+00037990: 6e5f 6466 3d70 616e 6461 732e 7265 6164  n_df=pandas.read
+000379a0: 5f63 7376 2873 746f 7265 5f6e 616d 652c  _csv(store_name,
+000379b0: 7365 703d 272c 272c 6865 6164 6572 3d4e  sep=',',header=N
+000379c0: 6f6e 652c 736b 6970 726f 7773 3d31 290d  one,skiprows=1).
+000379d0: 0a09 0909 0969 6620 666c 6f61 7428 6d69  .....if float(mi
+000379e0: 6e5f 6466 2e69 6c6f 635b 2d31 2c31 5d29  n_df.iloc[-1,1])
+000379f0: 3e66 6c6f 6174 2863 6f6d 6269 6e65 645f  >float(combined_
+00037a00: 6572 726f 7229 3a0d 0a09 0909 0909 7061  error):.......pa
+00037a10: 7264 662e 746f 5f63 7376 2873 746f 7265  rdf.to_csv(store
+00037a20: 5f6e 616d 6529 0d0a 0909 0965 7863 6570  _name).....excep
+00037a30: 743a 0d0a 0909 0909 7061 7373 0d0a 0909  t:......pass....
+00037a40: 0969 6620 6669 6c65 6e61 6d65 2069 7320  .if filename is 
+00037a50: 4e6f 6e65 3a0d 0a09 0909 0973 746f 7265  None:......store
+00037a60: 5f6e 616d 653d 2764 756d 705f 7061 7261  _name='dump_para
+00037a70: 732e 7061 7227 0d0a 0909 0965 6c73 653a  s.par'.....else:
+00037a80: 0d0a 0909 0909 7374 6f72 655f 6e61 6d65  ......store_name
+00037a90: 3d27 6475 6d70 5f70 6172 6173 5f25 732e  ='dump_paras_%s.
+00037aa0: 7061 7227 2566 696c 656e 616d 650d 0a09  par'%filename...
+00037ab0: 0909 7472 793a 0d0a 0909 0909 7061 7264  ..try:......pard
+00037ac0: 662e 746f 5f63 7376 2873 746f 7265 5f6e  f.to_csv(store_n
+00037ad0: 616d 6529 0d0a 0909 0965 7863 6570 743a  ame).....except:
+00037ae0: 0d0a 0909 0909 7072 696e 7428 2753 6176  ......print('Sav
+00037af0: 696e 6720 6f66 2025 7320 6661 696c 6564  ing of %s failed
+00037b00: 2725 7374 6f72 655f 6e61 6d65 290d 0a09  '%store_name)...
+00037b10: 0969 6620 6e6f 7420 6d6f 6420 696e 205b  .if not mod in [
+00037b20: 2770 6172 616c 272c 2765 7870 6f6e 656e  'paral','exponen
+00037b30: 7469 616c 272c 2763 6f6e 7365 6375 7469  tial','consecuti
+00037b40: 7665 275d 3a0d 0a09 0909 7072 696e 7428  ve']:.....print(
+00037b50: 636f 6d62 696e 6564 5f65 7272 6f72 290d  combined_error).
+00037b60: 0a09 0969 6620 6669 6e61 6c3a 0d0a 0909  ...if final:....
+00037b70: 0972 6574 7572 6e20 7265 5f66 696e 616c  .return re_final
+00037b80: 0d0a 0909 656c 7365 3a0d 0a09 0909 7265  ....else:.....re
+00037b90: 7475 726e 2063 6f6d 6269 6e65 645f 6572  turn combined_er
+00037ba0: 726f 720d 0a0d 0a0d 0a64 6566 2070 6172  ror......def par
+00037bb0: 5f74 6f5f 7061 7264 6628 7061 7229 3a0d  _to_pardf(par):.
+00037bc0: 0a09 2727 2766 756e 6374 696f 6e20 746f  ..'''function to
+00037bd0: 2063 6f6e 7665 7274 2061 2070 6172 616d   convert a param
+00037be0: 6574 6572 7320 6f62 6a65 6374 2069 6e74  eters object int
+00037bf0: 6f20 6120 7072 6574 7479 2044 6174 6146  o a pretty DataF
+00037c00: 7261 6d65 2c20 6974 2065 7870 6563 7473  rame, it expects
+00037c10: 2070 6172 2074 6f20 6265 2061 206c 6d66   par to be a lmf
+00037c20: 6974 2070 6172 616d 6574 6572 7320 6f62  it parameters ob
+00037c30: 6a65 6374 2061 6e64 206c 6f6f 7073 2074  ject and loops t
+00037c40: 6872 6f75 6768 2074 6865 206b 6579 7327  hrough the keys'
+00037c50: 2727 0d0a 096f 7574 5f64 6963 7465 6e3d  ''...out_dicten=
+00037c60: 7b7d 0d0a 0966 6f72 206b 6579 2069 6e20  {}...for key in 
+00037c70: 7061 722e 6b65 7973 2829 3a0d 0a09 096f  par.keys():....o
+00037c80: 7574 5f64 6963 7465 6e5b 6b65 795d 3d7b  ut_dicten[key]={
+00037c90: 2776 616c 7565 273a 7061 725b 6b65 795d  'value':par[key]
+00037ca0: 2e76 616c 7565 7d0d 0a09 0969 6620 6b65  .value}....if ke
+00037cb0: 795b 305d 203d 3d20 276b 273a 2369 7473  y[0] == 'k':#its
+00037cc0: 2061 2074 696d 6520 7061 7261 6d65 7465   a time paramete
+00037cd0: 720d 0a09 0909 6f75 745f 6469 6374 656e  r.....out_dicten
+00037ce0: 5b6b 6579 5d5b 2769 735f 7261 7465 275d  [key]['is_rate']
+00037cf0: 3d54 7275 650d 0a09 0965 6c73 653a 0d0a  =True....else:..
+00037d00: 0909 096f 7574 5f64 6963 7465 6e5b 6b65  ...out_dicten[ke
+00037d10: 795d 5b27 6973 5f72 6174 6527 5d3d 4661  y]['is_rate']=Fa
+00037d20: 6c73 650d 0a09 096f 7574 5f64 6963 7465  lse....out_dicte
+00037d30: 6e5b 6b65 795d 5b27 6d69 6e27 5d3d 7061  n[key]['min']=pa
+00037d40: 725b 6b65 795d 2e6d 696e 0d0a 0909 6f75  r[key].min....ou
+00037d50: 745f 6469 6374 656e 5b6b 6579 5d5b 276d  t_dicten[key]['m
+00037d60: 6178 275d 3d70 6172 5b6b 6579 5d2e 6d61  ax']=par[key].ma
+00037d70: 780d 0a09 096f 7574 5f64 6963 7465 6e5b  x....out_dicten[
+00037d80: 6b65 795d 5b27 7661 7279 275d 3d70 6172  key]['vary']=par
+00037d90: 5b6b 6579 5d2e 7661 7279 0d0a 0909 6f75  [key].vary....ou
+00037da0: 745f 6469 6374 656e 5b6b 6579 5d5b 2765  t_dicten[key]['e
+00037db0: 7870 7227 5d3d 7061 725b 6b65 795d 2e65  xpr']=par[key].e
+00037dc0: 7870 720d 0a09 7265 7475 726e 2070 616e  xpr...return pan
+00037dd0: 6461 732e 4461 7461 4672 616d 6528 6f75  das.DataFrame(ou
+00037de0: 745f 6469 6374 656e 292e 540d 0a0d 0a0d  t_dicten).T.....
+00037df0: 0a64 6566 2070 6172 6466 5f74 6f5f 7061  .def pardf_to_pa
+00037e00: 7228 7061 725f 6466 293a 0d0a 0927 2727  r(par_df):...'''
+00037e10: 636f 6e76 6572 7473 2061 2064 6174 6166  converts a dataf
+00037e20: 7261 6d65 2074 6f20 6c6d 6669 7420 6f62  rame to lmfit ob
+00037e30: 6a65 6374 0d0a 0973 6574 2876 616c 7565  ject...set(value
+00037e40: 3d4e 6f6e 652c 2076 6172 793d 4e6f 6e65  =None, vary=None
+00037e50: 2c20 6d69 6e3d 4e6f 6e65 2c20 6d61 783d  , min=None, max=
+00037e60: 4e6f 6e65 2c20 6578 7072 3d4e 6f6e 652c  None, expr=None,
+00037e70: 2062 7275 7465 5f73 7465 703d 4e6f 6e65   brute_step=None
+00037e80: 2927 2727 0d0a 0970 6172 3d6c 6d66 6974  )'''...par=lmfit
+00037e90: 2e50 6172 616d 6574 6572 7328 290d 0a09  .Parameters()...
+00037ea0: 666f 7220 6b65 7920 696e 2070 6172 5f64  for key in par_d
+00037eb0: 662e 696e 6465 782e 7661 6c75 6573 3a0d  f.index.values:.
+00037ec0: 0a09 0970 6172 2e61 6464 286b 6579 2c20  ...par.add(key, 
+00037ed0: 7661 6c75 653d 7061 725f 6466 2e6c 6f63  value=par_df.loc
+00037ee0: 5b6b 6579 2c27 7661 6c75 6527 5d2c 2076  [key,'value'], v
+00037ef0: 6172 793d 7061 725f 6466 2e6c 6f63 5b6b  ary=par_df.loc[k
+00037f00: 6579 2c27 7661 7279 275d 2c20 6d69 6e3d  ey,'vary'], min=
+00037f10: 7061 725f 6466 2e6c 6f63 5b6b 6579 2c27  par_df.loc[key,'
+00037f20: 6d69 6e27 5d2c 206d 6178 3d70 6172 5f64  min'], max=par_d
+00037f30: 662e 6c6f 635b 6b65 792c 276d 6178 275d  f.loc[key,'max']
+00037f40: 2c20 6578 7072 3d70 6172 5f64 662e 6c6f  , expr=par_df.lo
+00037f50: 635b 6b65 792c 2765 7870 7227 5d29 0909  c[key,'expr'])..
+00037f60: 0909 0909 0909 0909 0909 0909 0920 0d0a  ............. ..
+00037f70: 0972 6574 7572 6e20 7061 720d 0a09 0d0a  .return par.....
+00037f80: 090d 0a64 6566 2070 6172 6466 5f74 6f5f  ...def pardf_to_
+00037f90: 7469 6d65 6466 2870 6172 6466 293a 0d0a  timedf(pardf):..
+00037fa0: 0927 2727 696e 7665 7274 7320 616c 6c20  .'''inverts all 
+00037fb0: 7468 6520 7261 7465 7320 746f 2074 696d  the rates to tim
+00037fc0: 6573 2069 6e20 6120 6461 7461 6672 616d  es in a datafram
+00037fd0: 6527 2727 0d0a 0974 696d 6564 663d 7061  e'''...timedf=pa
+00037fe0: 7264 662e 636f 7079 2829 0d0a 0969 6620  rdf.copy()...if 
+00037ff0: 2775 7070 6572 5f6c 696d 6974 2720 696e  'upper_limit' in
+00038000: 2070 6172 6466 2e6b 6579 7328 293a 0d0a   pardf.keys():..
+00038010: 0909 666f 7220 6b65 7920 696e 205b 2769  ..for key in ['i
+00038020: 6e69 745f 7661 6c75 6527 2c27 7661 6c75  nit_value','valu
+00038030: 6527 2c27 6d69 6e27 2c27 6d61 7827 2c27  e','min','max','
+00038040: 6c6f 7765 725f 6c69 6d69 7427 2c27 7570  lower_limit','up
+00038050: 7065 725f 6c69 6d69 7427 5d3a 0d0a 0909  per_limit']:....
+00038060: 0966 6f72 2072 6f77 2069 6e20 7061 7264  .for row in pard
+00038070: 662e 696e 6465 782e 7661 6c75 6573 3a0d  f.index.values:.
+00038080: 0a09 0909 0969 6620 7469 6d65 6466 2e6c  .....if timedf.l
+00038090: 6f63 5b72 6f77 2c27 6973 5f72 6174 6527  oc[row,'is_rate'
+000380a0: 5d3a 0d0a 0909 0909 0969 6620 6b65 7920  ]:.......if key 
+000380b0: 3d3d 2027 6d69 6e27 3a6b 6579 5f69 6e3d  == 'min':key_in=
+000380c0: 276d 6178 270d 0a09 0909 0909 656c 6966  'max'.......elif
+000380d0: 206b 6579 203d 3d20 276d 6178 273a 6b65   key == 'max':ke
+000380e0: 795f 696e 3d27 6d69 6e27 0d0a 0909 0909  y_in='min'......
+000380f0: 0965 6c69 6620 6b65 7920 3d3d 2027 6c6f  .elif key == 'lo
+00038100: 7765 725f 6c69 6d69 7427 3a6b 6579 5f69  wer_limit':key_i
+00038110: 6e3d 2775 7070 6572 5f6c 696d 6974 270d  n='upper_limit'.
+00038120: 0a09 0909 0909 656c 6966 206b 6579 203d  ......elif key =
+00038130: 3d20 2775 7070 6572 5f6c 696d 6974 273a  = 'upper_limit':
+00038140: 6b65 795f 696e 3d27 6c6f 7765 725f 6c69  key_in='lower_li
+00038150: 6d69 7427 0d0a 0909 0909 0965 6c73 653a  mit'.......else:
+00038160: 6b65 795f 696e 3d6b 6579 0d0a 0909 0909  key_in=key......
+00038170: 0974 7279 3a0d 0a09 0909 0909 0969 6620  .try:........if 
+00038180: 7061 7264 662e 6c6f 635b 726f 772c 6b65  pardf.loc[row,ke
+00038190: 795d 2021 3d30 3a0d 0a09 0909 0909 0909  y] !=0:.........
+000381a0: 7469 6d65 6466 2e6c 6f63 5b72 6f77 2c6b  timedf.loc[row,k
+000381b0: 6579 5f69 6e5d 3d31 2f70 6172 6466 2e6c  ey_in]=1/pardf.l
+000381c0: 6f63 5b72 6f77 2c6b 6579 5d20 0d0a 0909  oc[row,key] ....
+000381d0: 0909 0909 656c 7365 3a0d 0a09 0909 0909  ....else:.......
+000381e0: 0909 7469 6d65 6466 2e6c 6f63 5b72 6f77  ..timedf.loc[row
+000381f0: 2c6b 6579 5f69 6e5d 3d27 696e 6627 0d0a  ,key_in]='inf'..
+00038200: 0909 0909 0965 7863 6570 743a 0d0a 0909  .....except:....
+00038210: 0909 0909 6966 206b 6579 203d 3d20 2769  ....if key == 'i
+00038220: 6e69 745f 7661 6c75 6527 3a70 6173 7323  nit_value':pass#
+00038230: 7765 2064 6f6e 2774 2073 6176 6520 7468  we don't save th
+00038240: 6520 696e 6974 2076 616c 7565 732c 2073  e init values, s
+00038250: 6f20 7765 2067 6574 2061 6e20 6572 726f  o we get an erro
+00038260: 7220 7768 656e 2063 6f6e 7665 7274 696e  r when convertin
+00038270: 6720 7468 6520 7361 7665 6420 6669 6c65  g the saved file
+00038280: 0d0a 0909 0909 0909 656c 6966 2070 6172  ........elif par
+00038290: 6466 2e6c 6f63 5b72 6f77 2c6b 6579 5d20  df.loc[row,key] 
+000382a0: 6973 204e 6f6e 653a 636f 6e74 696e 7565  is None:continue
+000382b0: 0d0a 0909 0909 0909 656c 7365 3a70 7269  ........else:pri
+000382c0: 6e74 2827 636f 6e76 6572 7369 6f6e 206f  nt('conversion o
+000382d0: 6620 7468 6973 206b 6579 2066 6169 6c65  f this key faile
+000382e0: 643a 2025 7320 2573 2725 2872 6f77 2c6b  d: %s %s'%(row,k
+000382f0: 6579 2929 0d0a 0965 6c73 653a 0d0a 0909  ey))...else:....
+00038300: 666f 7220 6b65 7920 696e 205b 2769 6e69  for key in ['ini
+00038310: 745f 7661 6c75 6527 2c27 7661 6c75 6527  t_value','value'
+00038320: 2c27 6d69 6e27 2c27 6d61 7827 5d3a 0d0a  ,'min','max']:..
+00038330: 0909 0969 6620 6b65 7920 3d3d 2027 6d69  ...if key == 'mi
+00038340: 6e27 3a6b 6579 5f69 6e3d 276d 6178 2709  n':key_in='max'.
+00038350: 0920 0d0a 0909 0965 6c69 6620 6b65 7920  . .....elif key 
+00038360: 3d3d 2027 6d61 7827 3a6b 6579 5f69 6e3d  == 'max':key_in=
+00038370: 276d 696e 270d 0a09 0909 656c 7365 3a6b  'min'.....else:k
+00038380: 6579 5f69 6e3d 6b65 790d 0a09 0909 7472  ey_in=key.....tr
+00038390: 793a 0d0a 0909 0909 7469 6d65 6466 2e6c  y:......timedf.l
+000383a0: 6f63 5b70 6172 6466 2e69 735f 7261 7465  oc[pardf.is_rate
+000383b0: 2c6b 6579 5f69 6e5d 3d70 6172 6466 2e6c  ,key_in]=pardf.l
+000383c0: 6f63 5b70 6172 6466 2e69 735f 7261 7465  oc[pardf.is_rate
+000383d0: 2c6b 6579 5d2e 6170 706c 7928 6c61 6d62  ,key].apply(lamb
+000383e0: 6461 2078 3a20 312f 7820 6966 2078 213d  da x: 1/x if x!=
+000383f0: 3020 2065 6c73 6520 2769 6e66 2729 0d0a  0  else 'inf')..
+00038400: 0909 0965 7863 6570 743a 0d0a 0909 0909  ...except:......
+00038410: 6966 206b 6579 203d 3d20 2769 6e69 745f  if key == 'init_
+00038420: 7661 6c75 6527 3a70 6173 7323 7765 2064  value':pass#we d
+00038430: 6f6e 2774 2073 6176 6520 7468 6520 696e  on't save the in
+00038440: 6974 2076 616c 7565 732c 2073 6f20 7765  it values, so we
+00038450: 2067 6574 2061 6e20 6572 726f 7220 7768   get an error wh
+00038460: 656e 2063 6f6e 7665 7274 696e 6720 7468  en converting th
+00038470: 6520 7361 7665 6420 6669 6c65 0d0a 0909  e saved file....
+00038480: 0909 656c 7365 3a70 7269 6e74 2827 636f  ..else:print('co
+00038490: 6e76 6572 7369 6f6e 206f 6620 7468 6973  nversion of this
+000384a0: 206b 6579 2066 6169 6c65 643a 2720 2b20   key failed:' + 
+000384b0: 6b65 7929 0d0a 0972 6574 7572 6e20 7469  key)...return ti
+000384c0: 6d65 6466 0d0a 0d0a 0d0a 636c 6173 7320  medf......class 
+000384d0: 5441 2829 3a09 2320 6f62 6a65 6374 2077  TA():.# object w
+000384e0: 7261 7070 6572 2066 6f72 2074 6865 2077  rapper for the w
+000384f0: 686f 6c65 0d0a 0964 6566 205f 5f69 6e69  hole...def __ini
+00038500: 745f 5f28 7365 6c66 2c20 6669 6c65 6e61  t__(self, filena
+00038510: 6d65 2c20 7061 7468 203d 204e 6f6e 652c  me, path = None,
+00038520: 2073 6570 203d 2022 5c74 222c 2064 6563   sep = "\t", dec
+00038530: 696d 616c 203d 2027 2e27 2c20 696e 6465  imal = '.', inde
+00038540: 785f 6973 5f65 6e65 7267 7920 3d20 4661  x_is_energy = Fa
+00038550: 6c73 652c 2074 7261 6e73 706f 7365 203d  lse, transpose =
+00038560: 2046 616c 7365 2c0d 0a09 0909 0973 6f72   False,......sor
+00038570: 745f 696e 6465 7865 7320 3d20 4661 6c73  t_indexes = Fals
+00038580: 652c 2064 6976 6964 655f 7469 6d65 735f  e, divide_times_
+00038590: 6279 203d 204e 6f6e 652c 2073 6869 6674  by = None, shift
+000385a0: 5f74 696d 6573 5f62 7920 3d20 4e6f 6e65  _times_by = None
+000385b0: 2c20 6578 7465 726e 616c 5f74 696d 6520  , external_time 
+000385c0: 3d20 4e6f 6e65 2c20 6578 7465 726e 616c  = None, external
+000385d0: 5f77 6176 6520 3d20 4e6f 6e65 2c20 0d0a  _wave = None, ..
+000385e0: 0909 0909 7573 655f 7361 6d65 5f6e 616d  ....use_same_nam
+000385f0: 6520 3d20 5472 7565 2c20 6461 7461 5f74  e = True, data_t
+00038600: 7970 6520 3d20 4e6f 6e65 202c 2075 6e69  ype = None , uni
+00038610: 7473 203d 204e 6f6e 652c 2062 6173 6575  ts = None, baseu
+00038620: 6e69 7420 3d20 4e6f 6e65 2c20 6473 203d  nit = None, ds =
+00038630: 204e 6f6e 652c 2063 6f6e 7665 7273 696f   None, conversio
+00038640: 6e5f 6675 6e63 7469 6f6e 203d 204e 6f6e  n_function = Non
+00038650: 6529 3a09 0920 0d0a 0909 2727 2746 756e  e):.. ....'''Fun
+00038660: 6374 696f 6e20 7468 6174 206f 7065 6e73  ction that opens
+00038670: 2061 6e64 2069 6d70 6f72 7473 2064 6174   and imports dat
+00038680: 6120 696e 746f 2061 6e20 5441 206f 626a  a into an TA obj
+00038690: 6563 740d 0a09 0969 7420 6973 2064 6573  ect....it is des
+000386a0: 6967 6e65 6420 746f 206f 7065 6e20 636f  igned to open co
+000386b0: 6d62 696e 6564 2066 696c 6573 2074 6861  mbined files tha
+000386c0: 7420 636f 6e74 6169 6e20 626f 7468 2074  t contain both t
+000386d0: 6865 2077 6176 656c 656e 6774 6820 616e  he wavelength an
+000386e0: 6420 7468 6520 7469 6d65 2e20 2865 2e67  d the time. (e.g
+000386f0: 2e20 5349 4120 6669 6c65 7320 6173 2072  . SIA files as r
+00038700: 6563 6f72 6465 6420 6279 2050 6173 6368  ecorded by Pasch
+00038710: 6572 2069 6e73 7472 756d 656e 7473 2073  er instruments s
+00038720: 6f66 7477 6172 6529 206f 7220 6864 6635  oftware) or hdf5
+00038730: 2070 726f 6a65 6374 7320 7361 7665 6420   projects saved 
+00038740: 6279 2074 6869 7320 736f 6674 7761 7265  by this software
+00038750: 0d0a 0909 5468 6572 6520 6172 6520 686f  ....There are ho
+00038760: 7765 7665 7220 6120 6c6f 7420 6f66 2061  wever a lot of a
+00038770: 6464 6974 696f 6e61 6c20 6f70 7469 6f6e  dditional option
+00038780: 7320 746f 206f 7065 6e20 6f74 6865 7220  s to open other 
+00038790: 6173 6369 6920 7479 7065 2066 696c 6573  ascii type files
+000387a0: 2061 6e64 2061 6461 7074 2074 6865 6972   and adapt their
+000387b0: 2066 6f72 6d61 7420 696e 7465 726e 616c   format internal
+000387c0: 6c79 0d0a 0909 4174 7465 6e74 696f 6e20  ly....Attention 
+000387d0: 7469 6d65 7320 7769 7468 204e 616e 2077  times with Nan w
+000387e0: 696c 6c20 6265 2063 6f6d 706c 6574 656c  ill be completel
+000387f0: 7920 7265 6d6f 7665 6420 6475 7269 6e67  y removed during
+00038800: 2074 6865 2069 6d70 6f72 740d 0a09 090d   the import.....
+00038810: 0a09 0950 6172 616d 6574 6572 730d 0a09  ...Parameters...
+00038820: 092d 2d2d 2d2d 2d2d 2d2d 2d0d 0a09 090d  .----------.....
+00038830: 0a09 0966 696c 656e 616d 6520 3a20 7374  ...filename : st
+00038840: 720d 0a09 0909 0d0a 0909 092a 2065 7870  r..........* exp
+00038850: 6563 7473 2061 2066 696c 656e 616d 6520  ects a filename 
+00038860: 696e 2073 7472 696e 6720 666f 726d 2066  in string form f
+00038870: 6f72 206f 7065 6e69 6e67 2061 2073 696e  or opening a sin
+00038880: 676c 6520 6669 6c65 2e20 0d0a 0909 092a  gle file. .....*
+00038890: 2061 6c74 6572 6e61 7469 7665 6c79 2027   alternatively '
+000388a0: 6775 6927 2063 616e 2062 6520 7365 7420  gui' can be set 
+000388b0: 6173 2066 696c 656e 616d 652c 2074 6865  as filename, the
+000388c0: 6e20 6120 544b 696e 7465 7220 6775 6920  n a TKinter gui 
+000388d0: 6973 206f 7065 6e65 6420 666f 7220 7365  is opened for se
+000388e0: 6c65 6374 2e0d 0a09 0909 2a20 616c 7465  lect......* alte
+000388f0: 726e 6174 6976 656c 7920 2772 6563 656e  rnatively 'recen
+00038900: 7427 2063 616e 2067 6976 656e 2061 7320  t' can given as 
+00038910: 6b65 7920 776f 7264 2e20 696e 2074 6869  key word. in thi
+00038920: 7320 6361 7365 2069 7420 7472 6965 7320  s case it tries 
+00038930: 746f 2066 696e 6420 6120 7465 7874 2066  to find a text f
+00038940: 696c 6520 6e61 6d65 6420 2272 6563 656e  ile named "recen
+00038950: 742e 6461 7422 2074 6861 7420 7368 6f75  t.dat" that shou
+00038960: 6c64 2063 6f6e 7461 696e 2074 6865 2070  ld contain the p
+00038970: 6174 6820 746f 2074 6865 206c 6173 7420  ath to the last 
+00038980: 6669 6c65 206f 7065 6e65 6420 7769 7468  file opened with
+00038990: 2074 6865 2047 5549 2e20 7468 6973 2066   the GUI. this f
+000389a0: 696c 6520 6973 2074 6865 6e20 6f70 656e  ile is then open
+000389b0: 6564 2e20 6966 2074 6869 7320 6669 6c65  ed. if this file
+000389c0: 2069 7320 6e6f 7420 666f 756e 6420 7468   is not found th
+000389d0: 6520 4755 4920 6973 206f 7065 6e65 6420  e GUI is opened 
+000389e0: 696e 7374 6561 640d 0a09 090d 0a09 0970  instead........p
+000389f0: 6174 6820 3a20 7374 7220 6f72 2070 6174  ath : str or pat
+00038a00: 6820 6f62 6a65 6374 2028 6f70 7469 6f6e  h object (option
+00038a10: 616c 290d 0a09 0909 6966 2070 6174 6820  al).....if path 
+00038a20: 6973 2061 2073 7472 696e 6720 7769 7468  is a string with
+00038a30: 6f75 7420 7468 6520 6f70 6572 6174 696f  out the operatio
+00038a40: 6e20 7379 7374 656d 2064 6570 656e 6465  n system depende
+00038a50: 6e74 2073 6570 6172 6174 6f72 2c20 6974  nt separator, it
+00038a60: 2069 7320 7472 6561 7465 6420 6173 2061   is treated as a
+00038a70: 2072 656c 6174 6976 6520 7061 7468 2c20   relative path, 
+00038a80: 0d0a 0909 0965 2e67 2e20 6461 7461 2077  .....e.g. data w
+00038a90: 696c 6c20 6c6f 6f6b 2066 726f 6d20 7468  ill look from th
+00038aa0: 6520 776f 726b 696e 6720 6469 7265 6374  e working direct
+00038ab0: 6f72 7920 696e 2074 6865 2073 7562 2064  ory in the sub d
+00038ac0: 6972 6563 746f 7220 6461 7461 2e20 4f74  irector data. Ot
+00038ad0: 6865 7277 6973 6520 7468 6973 2068 6173  herwise this has
+00038ae0: 2074 6f20 6265 2061 200d 0a09 0909 6675   to be a .....fu
+00038af0: 6c6c 2070 6174 6820 696e 2065 6974 6865  ll path in eithe
+00038b00: 7220 7374 726f 6e67 206f 7220 7061 7468  r strong or path
+00038b10: 206f 626a 6563 7420 666f 726d 2e0d 0a09   object form....
+00038b20: 090d 0a09 0973 6570 203a 2073 7472 2028  .....sep : str (
+00038b30: 6f70 7469 6f6e 616c 290d 0a09 0909 6973  optional).....is
+00038b40: 2074 6865 2073 6570 6172 6174 6f72 2062   the separator b
+00038b50: 6574 7765 656e 2064 6966 6665 7265 6e74  etween different
+00038b60: 206e 756d 6265 7273 2c20 7479 7069 6361   numbers, typica
+00038b70: 6c20 6172 6520 7461 7020 2842 6163 6b73  l are tap (Backs
+00038b80: 6c61 7368 2074 2920 2844 6566 6175 6c74  lash t) (Default
+00038b90: 2920 2c6f 6e65 206f 7220 0d0a 0909 096d  ) ,one or .....m
+00038ba0: 756c 7469 706c 6520 7768 6974 6520 7370  ultiple white sp
+00038bb0: 6163 6573 2027 6261 636b 736c 6173 6820  aces 'backslash 
+00038bc0: 732b 2720 6f72 2063 6f6d 6d61 2027 2c27  s+' or comma ','
+00038bd0: 2e0d 0a09 090d 0a09 0964 6563 696d 616c  .........decimal
+00038be0: 203a 2073 7472 2028 6f70 7469 6f6e 616c   : str (optional
+00038bf0: 2920 0d0a 0909 0973 6574 7320 7468 6520  ) .....sets the 
+00038c00: 6173 6369 6920 7379 6d62 6f6c 2074 6861  ascii symbol tha
+00038c10: 7420 6973 2075 7365 6420 666f 7220 7468  t is used for th
+00038c20: 6520 6465 6369 6d61 6c20 7369 676e 2e20  e decimal sign. 
+00038c30: 496e 206d 6f73 7420 636f 756e 7472 6965  In most countrie
+00038c40: 7320 7468 6973 2069 7320 272e 2728 4465  s this is '.'(De
+00038c50: 6661 756c 7429 200d 0a09 0909 6275 7420  fault) .....but 
+00038c60: 6974 2063 616e 2062 6520 272c 2720 696e  it can be ',' in
+00038c70: 2063 6f75 6e74 7269 6573 206c 696b 6520   countries like 
+00038c80: 5377 6564 656e 206f 7220 4765 726d 616e  Sweden or German
+00038c90: 790d 0a09 090d 0a09 0969 6e64 6578 5f69  y........index_i
+00038ca0: 735f 656e 6572 6779 203a 2062 6f6f 6c20  s_energy : bool 
+00038cb0: 286f 7074 696f 6e61 6c29 0d0a 0909 0973  (optional).....s
+00038cc0: 7769 7463 6865 7320 6966 2074 6865 2077  witches if the w
+00038cd0: 6176 656c 656e 6774 6820 6973 2067 6976  avelength is giv
+00038ce0: 656e 2069 6e20 6e6d 2028 4465 6661 756c  en in nm (Defaul
+00038cf0: 7429 206f 7220 696e 2065 5620 2869 6620  t) or in eV (if 
+00038d00: 5472 7565 292c 2063 7572 7265 6e74 6c79  True), currently
+00038d10: 2065 7665 7279 7468 696e 6720 0d0a 0909   everything ....
+00038d20: 0969 7320 6861 6e64 6c65 6420 6173 2077  .is handled as w
+00038d30: 6176 656c 656e 6774 6820 696e 206e 6d20  avelength in nm 
+00038d40: 696e 7465 726e 616c 6c79 0d0a 0909 0d0a  internally......
+00038d50: 0909 6461 7461 5f74 7970 653a 2073 7472  ..data_type: str
+00038d60: 2028 6f70 7469 6f6e 616c 290d 0a09 0909   (optional).....
+00038d70: 6461 7461 5f74 7970 6520 6973 2074 6865  data_type is the
+00038d80: 2073 7472 696e 6720 7468 6174 2072 6570   string that rep
+00038d90: 7265 7365 6e74 7320 7468 6520 696e 7465  resents the inte
+00038da0: 6e73 6974 7920 6d65 6173 7572 656d 656e  nsity measuremen
+00038db0: 7473 2e20 5573 7561 6c6c 7920 7468 6973  ts. Usually this
+00038dc0: 2063 6f6e 7461 696e 7320 6966 2061 6273   contains if abs
+00038dd0: 6f6c 7574 6520 0d0a 0909 096f 6620 6469  olute .....of di
+00038de0: 6666 6572 656e 7469 616c 2064 6174 612e  fferential data.
+00038df0: 2054 6869 7320 6973 2075 7365 6420 666f   This is used fo
+00038e00: 7220 7468 6520 636f 6c6f 7220 696e 7465  r the color inte
+00038e10: 6e73 6974 7920 696e 2074 6865 2032 6420  nsity in the 2d 
+00038e20: 706c 6f74 7320 616e 6420 7468 6520 792d  plots and the y-
+00038e30: 6178 6973 2066 6f72 2074 6865 2031 6420  axis for the 1d 
+00038e40: 706c 6f74 730d 0a09 0909 0d0a 0909 756e  plots.........un
+00038e50: 6974 733a 2073 7472 2028 6f70 7469 6f6e  its: str (option
+00038e60: 616c 290d 0a09 0909 7468 6973 2069 7320  al).....this is 
+00038e70: 7573 6564 2074 6f20 6964 656e 7469 6679  used to identify
+00038e80: 2074 6865 2075 6e69 7473 206f 6e20 7468   the units on th
+00038e90: 6520 656e 6572 6779 2061 7869 7320 616e  e energy axis an
+00038ea0: 6420 746f 206c 6162 656c 2074 6865 2073  d to label the s
+00038eb0: 6c69 6365 732c 2072 6563 6f67 6e69 7a65  lices, recognize
+00038ec0: 6420 6973 2027 6e6d 272c 2027 6556 2720  d is 'nm', 'eV' 
+00038ed0: 616e 6420 276b 6556 2720 0d0a 0909 0962  and 'keV' .....b
+00038ee0: 7574 2069 6620 616e 6f74 6865 7220 756e  ut if another un
+00038ef0: 6974 206c 696b 6520 2763 6d5e 2d31 2720  it like 'cm^-1' 
+00038f00: 6973 2075 7365 6420 6974 2077 696c 6c20  is used it will 
+00038f10: 7374 6174 6520 656e 6572 6779 2069 6e20  state energy in 
+00038f20: 2763 6d5e 2d31 272e 2050 6c65 6173 206f  'cm^-1'. Pleas o
+00038f30: 6273 6572 7665 2074 6861 7420 6966 2079  bserve that if y
+00038f40: 6f75 2075 7365 2074 6865 2069 6e64 6578  ou use the index
+00038f50: 5f69 735f 656e 6572 6779 0d0a 0909 0973  _is_energy.....s
+00038f60: 7769 7463 6820 7468 6520 7072 6f67 7261  witch the progra
+00038f70: 6d20 7472 6965 7320 746f 2063 6f6e 7665  m tries to conve
+00038f80: 7274 2074 6869 7320 656e 6572 6779 2069  rt this energy i
+00038f90: 6e74 6f20 7761 7665 6c65 6e67 7468 2e20  nto wavelength. 
+00038fa0: 0d0a 0909 090d 0a09 0962 6173 6575 6e69  .........baseuni
+00038fb0: 743a 2073 7472 2028 6f70 7469 6f6e 616c  t: str (optional
+00038fc0: 290d 0a09 0909 7468 6973 2069 7320 7573  ).....this is us
+00038fd0: 6564 2074 6f20 6964 656e 7469 6679 2074  ed to identify t
+00038fe0: 6865 2075 6e69 7473 206f 6e20 7468 6520  he units on the 
+00038ff0: 6465 7665 6c6f 7069 6e67 2f74 696d 6520  developing/time 
+00039000: 6178 6973 2e20 5468 6973 2069 7320 6e61  axis. This is na
+00039010: 6d65 2074 6861 7420 6973 2061 7474 6163  me that is attac
+00039020: 6865 6420 746f 2074 6865 2069 6e64 6578  hed to the index
+00039030: 206f 6620 7468 6520 6461 7461 6672 616d   of the datafram
+00039040: 652e 200d 0a09 0909 7365 7474 696e 6720  e. .....setting 
+00039050: 7468 6973 2064 7572 696e 6720 696d 706f  this during impo
+00039060: 7274 2069 7320 6571 7569 7661 6c65 6e74  rt is equivalent
+00039070: 2074 6f20 7461 2e62 6173 6575 6e69 740d   to ta.baseunit.
+00039080: 0a09 090d 0a09 0974 7261 6e73 706f 7365  .......transpose
+00039090: 203a 2062 6f6f 6c20 286f 7074 696f 6e61   : bool (optiona
+000390a0: 6c29 0d0a 0909 0969 6620 7468 6973 2073  l).....if this s
+000390b0: 7769 7463 6820 6973 2046 616c 7365 2028  witch is False (
+000390c0: 4465 6661 756c 7429 2074 6865 2077 6176  Default) the wav
+000390d0: 656c 656e 6774 6820 6172 6520 7468 6520  elength are the 
+000390e0: 636f 6c75 6d6e 7320 616e 6420 7468 6520  columns and the 
+000390f0: 726f 7773 2074 6865 2074 696d 6573 2e0d  rows the times..
+00039100: 0a09 090d 0a09 0973 6f72 745f 696e 6465  .......sort_inde
+00039110: 7865 7320 3a20 626f 6f6c 2028 6f70 7469  xes : bool (opti
+00039120: 6f6e 616c 290d 0a09 0909 466f 7220 4661  onal).....For Fa
+00039130: 6c73 6520 2844 6566 6175 6c74 2920 4920  lse (Default) I 
+00039140: 6173 7375 6d65 2074 6861 7420 7468 6520  assume that the 
+00039150: 7469 6d65 7320 616e 6420 656e 6572 6769  times and energi
+00039160: 6573 2061 7265 2061 6c72 6561 6479 2069  es are already i
+00039170: 6e20 6120 7269 7369 6e67 206f 7264 6572  n a rising order
+00039180: 2e20 0d0a 0909 0977 6974 6820 7468 6973  . .....with this
+00039190: 2073 7769 7463 682c 2062 6f74 6820 6172   switch, both ar
+000391a0: 6520 736f 7274 6564 2061 6761 696e 2e20  e sorted again. 
+000391b0: 0d0a 0909 0d0a 0909 6469 7669 6465 5f74  ........divide_t
+000391c0: 696d 6573 5f62 7920 3a20 4e6f 6e65 206f  imes_by : None o
+000391d0: 7220 666c 6f61 7420 286f 7074 696f 6e61  r float (optiona
+000391e0: 6c29 200d 0a09 0909 6865 7265 2061 206e  l) .....here a n
+000391f0: 756d 6265 7220 6361 6e20 6265 2067 6976  umber can be giv
+00039200: 656e 2074 6861 7420 7363 616c 6573 2074  en that scales t
+00039210: 6865 2074 696d 6520 6279 2061 6e20 6172  he time by an ar
+00039220: 6269 7461 7279 2066 6163 746f 722e 2054  bitary factor. T
+00039230: 6869 7320 6973 2061 6374 7561 6c6c 7920  his is actually 
+00039240: 6469 7669 6469 6e67 0d0a 0909 0974 6865  dividing.....the
+00039250: 2074 696d 6573 2062 7920 7468 6973 2076   times by this v
+00039260: 616c 7565 2e20 416c 7465 726e 6174 6976  alue. Alternativ
+00039270: 656c 7920 7468 6572 6520 6973 2074 6865  ely there is the
+00039280: 2076 6172 6961 626c 6520 7365 6c66 2e62   variable self.b
+00039290: 6173 6575 6e69 742e 2054 6865 206c 6174  aseunit. The lat
+000392a0: 7465 7220 6f6e 6c79 2061 6666 6563 7473  ter only affects
+000392b0: 200d 0a09 0909 7768 6174 2069 7320 7772   .....what is wr
+000392c0: 6974 7465 6e20 6f6e 2074 6865 2061 7869  itten on the axi
+000392d0: 732c 2077 6869 6c65 2074 6869 7320 7661  s, while this va
+000392e0: 6c75 6520 6973 2061 6374 7561 6c6c 7920  lue is actually 
+000392f0: 7573 6564 2074 6f20 7363 616c 6520 7468  used to scale th
+00039300: 6520 7469 6d65 732e 204e 6f6e 6520 2844  e times. None (D
+00039310: 6566 6175 6c74 2920 0d0a 0909 0969 676e  efault) .....ign
+00039320: 6f72 6573 2074 6869 730d 0a09 090d 0a09  ores this.......
+00039330: 0973 6869 6674 5f74 696d 6573 5f62 7920  .shift_times_by 
+00039340: 3a20 4e6f 6e65 2c20 666c 6f61 7420 286f  : None, float (o
+00039350: 7074 696f 6e61 6c29 0d0a 0909 0954 6869  ptional).....Thi
+00039360: 7320 6120 7661 6c75 6520 6279 2077 6869  s a value by whi
+00039370: 6368 2074 6865 2074 696d 6520 6178 6973  ch the time axis
+00039380: 2069 7320 7368 6966 7465 6420 6475 7269   is shifted duri
+00039390: 6e67 2069 6d70 6f72 742e 2054 6869 7320  ng import. This 
+000393a0: 6973 2061 2075 7365 6675 6c20 6f70 7469  is a useful opti
+000393b0: 6f6e 206f 6620 652e 672e 200d 0a09 0909  on of e.g. .....
+000393c0: 7468 6520 7265 636f 7264 696e 6720 736f  the recording so
+000393d0: 6674 7761 7265 2064 6f65 7320 6e6f 7420  ftware does not 
+000393e0: 636f 6d70 656e 7361 7465 2066 6f72 2074  compensate for t
+000393f0: 3020 616e 6420 7468 6520 6461 7461 2069  0 and the data i
+00039400: 7320 616c 7761 7973 2073 6869 6674 6564  s always shifted
+00039410: 2e20 0d0a 0909 094e 6f6e 6520 2844 6566  . .....None (Def
+00039420: 6175 6c74 2920 6967 6e6f 7265 7320 7468  ault) ignores th
+00039430: 6973 2073 6574 7469 6e67 0d0a 0909 0d0a  is setting......
+00039440: 0909 6461 7461 5f74 7970 6520 3a20 7374  ..data_type : st
+00039450: 722c 204e 6f6e 650d 0a09 0909 7468 6973  r, None.....this
+00039460: 2069 7320 7468 6520 6461 7461 7479 7065   is the datatype
+00039470: 2061 6e64 2065 6666 6563 7469 7665 6c79   and effectively
+00039480: 2074 6865 2075 6e69 7420 7075 7420 6f6e   the unit put on
+00039490: 2074 6865 2069 6e74 656e 7369 7479 2061   the intensity a
+000394a0: 7869 7320 0d0a 0909 0928 4465 6661 756c  xis .....(Defaul
+000394b0: 7429 2764 6966 6665 7265 6e74 6961 6c20  t)'differential 
+000394c0: 4162 736f 7270 7469 6f6e 2069 6e20 245c  Absorption in $\
+000394d0: 6d61 7468 7265 6775 6c61 727b 5c44 656c  mathregular{\Del
+000394e0: 7461 204f 447d 240d 0a09 090d 0a09 0965  ta OD}$........e
+000394f0: 7874 6572 6e61 6c5f 7469 6d65 203a 204e  xternal_time : N
+00039500: 6f6e 6520 6f72 2073 7472 2028 6f70 7469  one or str (opti
+00039510: 6f6e 616c 290d 0a09 0909 4865 7265 2061  onal).....Here a
+00039520: 2066 696c 656e 616d 6520 6578 7465 6e73   filename extens
+00039530: 696f 6e20 2873 7472 696e 6729 2063 616e  ion (string) can
+00039540: 2062 6520 6769 7665 6e20 7468 6174 2063   be given that c
+00039550: 6f6e 7461 696e 7320 7468 6520 7469 6d65  ontains the time
+00039560: 2076 6563 746f 722e 200d 0a09 0909 5468   vector. .....Th
+00039570: 6520 6669 6c65 2069 7320 6173 7375 6d65  e file is assume
+00039580: 6420 746f 2062 6520 6174 2074 6865 2073  d to be at the s
+00039590: 616d 6520 7061 7468 2061 7320 7468 6520  ame path as the 
+000395a0: 6461 7461 2061 6e64 2074 6f20 636f 6e74  data and to cont
+000395b0: 6169 6e20 6120 7369 6e67 6c65 200d 0a09  ain a single ...
+000395c0: 0909 7479 7065 206f 6620 7365 7061 7261  ..type of separa
+000395d0: 7465 6420 6461 7461 2077 6974 686f 7574  ted data without
+000395e0: 2068 6561 6465 722e 200d 0a09 0909 4966   header. .....If
+000395f0: 2075 7365 5f73 616d 655f 6e61 6d65 203d   use_same_name =
+00039600: 2054 7275 6520 2864 6566 6175 6c74 290d   True (default).
+00039610: 0a09 0909 4974 2061 7373 756d 6573 2074  ....It assumes t
+00039620: 6861 7420 7468 6973 2069 7320 7468 6520  hat this is the 
+00039630: 656e 6469 6e67 2066 6f72 2074 6865 2066  ending for the f
+00039640: 696c 652e 2054 6865 2066 696c 656e 616d  ile. The filenam
+00039650: 6520 6974 7365 6c66 2069 7320 7461 6b65  e itself is take
+00039660: 6e20 6672 6f6d 2074 6865 2066 696c 656e  n from the filen
+00039670: 616d 652e 200d 0a09 0909 652e 672e 2069  ame. .....e.g. i
+00039680: 6620 7361 6d70 312e 7478 7420 6973 2074  f samp1.txt is t
+00039690: 6865 2066 696c 656e 616d 6520 616e 6420  he filename and 
+000396a0: 6578 7465 726e 616c 5f74 696d 653d 272e  external_time='.
+000396b0: 7469 6427 2074 6865 2070 726f 6772 616d  tid' the program
+000396c0: 2073 6561 7263 6865 7320 0d0a 0909 0973   searches .....s
+000396d0: 616d 7031 2e74 6964 2066 6f72 2074 6865  amp1.tid for the
+000396e0: 2074 696d 6573 2e20 5468 6520 7472 616e   times. The tran
+000396f0: 7370 6f73 6520 7365 7474 696e 6720 6973  spose setting is
+00039700: 2061 7070 6c69 6564 2061 6e64 2073 6574   applied and set
+00039710: 7320 7768 6572 6520 7468 6520 7469 6d65  s where the time
+00039720: 7320 6172 6520 0d0a 0909 0974 6f20 6265  s are .....to be
+00039730: 2069 6e73 6572 7465 6420 2872 6f77 206f   inserted (row o
+00039740: 7220 636f 6c75 6d6e 2069 6e64 6578 6573  r column indexes
+00039750: 290d 0a09 0909 4966 2075 7365 5f73 616d  ).....If use_sam
+00039760: 655f 6e61 6d65 203d 2046 616c 7365 2074  e_name = False t
+00039770: 6869 7320 7368 6f75 6c64 2062 6520 7468  his should be th
+00039780: 6520 6669 6c65 2063 6f6e 7461 696e 696e  e file containin
+00039790: 6720 7468 6520 7665 6374 6f72 2066 6f72  g the vector for
+000397a0: 2074 6865 2074 696d 6520 2869 6e20 7468   the time (in th
+000397b0: 6520 7361 6d65 2066 6f72 6d61 7420 6173  e same format as
+000397c0: 2074 6865 206d 6169 6e20 6669 6c65 290d   the main file).
+000397d0: 0a09 0909 0d0a 0909 6578 7465 726e 616c  ........external
+000397e0: 5f77 6176 6520 3a20 4e6f 6e65 206f 7220  _wave : None or 
+000397f0: 7374 7220 286f 7074 696f 6e61 6c29 200d  str (optional) .
+00039800: 0a09 0909 4865 7265 2061 2066 696c 656e  ....Here a filen
+00039810: 616d 6520 6578 7465 6e73 696f 6e20 2873  ame extension (s
+00039820: 7472 696e 6729 2063 616e 2062 6520 6769  tring) can be gi
+00039830: 7665 6e20 7468 6174 2063 6f6e 7461 696e  ven that contain
+00039840: 7320 7468 6520 7761 7665 6c65 6e67 7468  s the wavelength
+00039850: 2076 6563 746f 722e 200d 0a09 0909 4966   vector. .....If
+00039860: 2075 7365 5f73 616d 655f 6e61 6d65 203d   use_same_name =
+00039870: 2054 7275 6520 2864 6566 6175 6c74 290d   True (default).
+00039880: 0a09 0909 5468 6520 6669 6c65 2069 7320  ....The file is 
+00039890: 6173 7375 6d65 6420 746f 2062 6520 6174  assumed to be at
+000398a0: 2074 6865 2073 616d 6520 7061 7468 2061   the same path a
+000398b0: 7320 7468 6520 6461 7461 2061 6e64 2074  s the data and t
+000398c0: 6f20 636f 6e74 6169 6e20 6120 7369 6e67  o contain a sing
+000398d0: 6c65 2074 7970 6520 0d0a 0909 096f 6620  le type .....of 
+000398e0: 7365 7061 7261 7465 6420 6461 7461 2077  separated data w
+000398f0: 6974 686f 7574 2068 6561 6465 722e 2054  ithout header. T
+00039900: 6869 7320 6973 2074 6865 2065 6e64 696e  his is the endin
+00039910: 6720 666f 7220 7468 6520 6669 6c65 2e20  g for the file. 
+00039920: 5468 6520 6669 6c65 6e61 6d65 2069 7473  The filename its
+00039930: 656c 6620 0d0a 0909 0969 7320 7461 6b65  elf .....is take
+00039940: 6e20 6672 6f6d 2074 6865 2066 696c 656e  n from the filen
+00039950: 616d 652e 2065 2e67 2e20 6966 2073 616d  ame. e.g. if sam
+00039960: 7031 2e74 7874 2069 7320 7468 6520 6669  p1.txt is the fi
+00039970: 6c65 6e61 6d65 2061 6e64 2065 7874 6572  lename and exter
+00039980: 6e61 6c5f 7761 7665 3d27 2e77 6176 2720  nal_wave='.wav' 
+00039990: 0d0a 0909 0974 6865 6e20 7468 6520 7072  .....then the pr
+000399a0: 6f67 7261 6d20 7365 6172 6368 6573 2073  ogram searches s
+000399b0: 616d 7031 2e77 6176 2066 6f72 2074 6865  amp1.wav for the
+000399c0: 2077 6176 656c 656e 6774 682e 2054 6865   wavelength. The
+000399d0: 2074 7261 6e73 706f 7365 2073 6574 7469   transpose setti
+000399e0: 6e67 2069 7320 6170 706c 6965 6420 0d0a  ng is applied ..
+000399f0: 0909 0961 6e64 2073 6574 7320 7768 6572  ...and sets wher
+00039a00: 6520 7468 6520 7761 7665 6c65 6e67 7468  e the wavelength
+00039a10: 2061 7265 2074 6f20 6265 2069 6e73 6572   are to be inser
+00039a20: 7465 6420 2863 6f6c 756d 6e73 206f 7220  ted (columns or 
+00039a30: 726f 7720 696e 6465 7865 7329 0d0a 0909  row indexes)....
+00039a40: 0949 6620 7573 655f 7361 6d65 5f6e 616d  .If use_same_nam
+00039a50: 6520 3d20 4661 6c73 650d 0a09 0909 7468  e = False.....th
+00039a60: 6973 2073 686f 756c 6420 6265 2061 2066  is should be a f
+00039a70: 756c 6c20 6669 6c65 6e61 6d65 2074 6861  ull filename tha
+00039a80: 7420 636f 6e74 6169 6e73 2074 6865 2076  t contains the v
+00039a90: 6563 746f 720d 0a09 0909 0d0a 0909 7573  ector.........us
+00039aa0: 655f 7361 6d65 5f6e 616d 6520 3a20 626f  e_same_name : bo
+00039ab0: 6f6c 2c20 6f70 7469 6f6e 616c 0d0a 0909  ol, optional....
+00039ac0: 0974 6869 7320 7377 6974 6368 6573 2069  .this switches i
+00039ad0: 6620 7468 6520 6578 7465 726e 616c 2066  f the external f
+00039ae0: 696c 656e 616d 6520 696e 636c 7564 6564  ilename included
+00039af0: 2074 6865 206c 6f61 6465 6420 6669 6c65   the loaded file
+00039b00: 6e61 6d65 206f 7220 6973 2061 2073 6570  name or is a sep
+00039b10: 6172 6174 6520 6669 6c65 2054 7275 6528  arate file True(
+00039b20: 6465 6661 756c 7429 0d0a 0909 090d 0a09  default)........
+00039b30: 0964 733a 2070 616e 6461 732e 4461 7461  .ds: pandas.Data
+00039b40: 4672 616d 6520 286f 7074 696f 6e61 6c29  Frame (optional)
+00039b50: 0d0a 0909 0966 6565 6420 696e 2061 6e20  .....feed in an 
+00039b60: 6578 7465 726e 616c 2064 6174 6166 7261  external datafra
+00039b70: 6d65 2069 6e73 7465 6164 206f 6620 6f70  me instead of op
+00039b80: 656e 696e 6720 6120 6669 6c65 0d0a 0909  ening a file....
+00039b90: 090d 0a09 0963 6f6e 7665 7273 696f 6e5f  .....conversion_
+00039ba0: 6675 6e63 7469 6f6e 3a20 6675 6e63 7469  function: functi
+00039bb0: 6f6e 286f 7074 696f 6e61 6c29 0d0a 0909  on(optional)....
+00039bc0: 0966 756e 6374 696f 6e20 7468 6174 2072  .function that r
+00039bd0: 6563 6569 7665 7320 7368 6f75 6c64 2068  eceives should h
+00039be0: 6176 6520 7468 6520 7368 6170 653a 0d0a  ave the shape:..
+00039bf0: 0909 0972 6574 7572 6e20 7061 6e64 6173  ...return pandas
+00039c00: 2044 6174 6166 7261 6d65 2077 6974 6820   Dataframe with 
+00039c10: 7469 6d65 2f66 7261 6d65 7320 2069 6e20  time/frames  in 
+00039c20: 726f 7773 2061 6e64 2077 6176 656c 656e  rows and wavelen
+00039c30: 6774 682f 656e 6572 6779 2069 6e20 636f  gth/energy in co
+00039c40: 6c75 6d6e 732c 0d0a 0909 0954 6865 2066  lumns,.....The f
+00039c50: 756e 6374 696f 6e20 6973 2074 6573 7465  unction is teste
+00039c60: 6420 746f 2061 6363 6570 7420 2869 6e20  d to accept (in 
+00039c70: 7468 6174 206f 7264 6572 2920 6120 0d0a  that order) a ..
+00039c80: 0909 096d 795f 6675 6e63 7469 6f6e 2866  ...my_function(f
+00039c90: 696c 656e 616d 652c 2065 7874 6572 6e61  ilename, externa
+00039ca0: 6c5f 7469 6d65 2c65 7874 6572 6e61 6c5f  l_time,external_
+00039cb0: 7761 7665 292c 200d 0a09 0909 6d79 5f66  wave), .....my_f
+00039cc0: 756e 6374 696f 6e28 6669 6c65 6e61 6d65  unction(filename
+00039cd0: 2c20 6578 7465 726e 616c 5f74 696d 6529  , external_time)
+00039ce0: 2c20 0d0a 0909 096d 795f 6675 6e63 7469  , .....my_functi
+00039cf0: 6f6e 2866 696c 656e 616d 652c 6578 7465  on(filename,exte
+00039d00: 726e 616c 5f77 6176 6529 2c20 0d0a 0909  rnal_wave), ....
+00039d10: 096d 795f 6675 6e63 7469 6f6e 2866 696c  .my_function(fil
+00039d20: 656e 616d 6529 2061 6e64 200d 0a09 0909  ename) and .....
+00039d30: 7265 7475 726e 3a20 7468 6520 6461 7461  return: the data
+00039d40: 6672 616d 6520 6473 2077 6974 6820 7468  frame ds with th
+00039d50: 6520 7469 6d65 5f61 7869 7320 6173 2072  e time_axis as r
+00039d60: 6f77 7320 616e 6420 7370 6563 7472 616c  ows and spectral
+00039d70: 2061 7869 7320 6173 2063 6f6c 756d 6e73   axis as columns
+00039d80: 200d 0a09 0909 6966 2074 6865 2064 732e   .....if the ds.
+00039d90: 696e 6465 782e 6e61 6d65 2069 6120 6e6f  index.name ia no
+00039da0: 7420 656d 7074 7920 7468 6520 2274 696d  t empty the "tim
+00039db0: 6520 6178 6973 2220 6973 2069 6e20 746f  e axis" is in to
+00039dc0: 2074 6861 7420 6e61 6d65 2074 6865 2073   that name the s
+00039dd0: 7065 6374 7261 6c20 6178 6973 2069 7320  pectral axis is 
+00039de0: 696e 2064 732e 636f 6c75 6d6e 732e 6e61  in ds.columns.na
+00039df0: 6d65 0d0a 0909 0974 6865 2072 6574 7572  me.....the retur
+00039e00: 6e20 6973 2069 6e76 6573 7469 6761 7465  n is investigate
+00039e10: 6420 6966 2069 7420 6973 206f 6e65 2c20  d if it is one, 
+00039e20: 7477 6f2c 206f 7220 7468 7265 6520 7468  two, or three th
+00039e30: 696e 6773 2e20 0d0a 0909 0969 6620 7477  ings. .....if tw
+00039e40: 6f20 6172 6520 7265 7475 726e 6564 2074  o are returned t
+00039e50: 6865 6e20 7468 6520 7365 636f 6e64 206d  hen the second m
+00039e60: 7573 7420 6265 2074 6865 206e 616d 6520  ust be the name 
+00039e70: 6f66 2077 6861 7420 7468 6520 696e 7465  of what the inte
+00039e80: 6e73 6974 7920 6178 6973 2069 732e 2054  nsity axis is. T
+00039e90: 6869 7320 7661 6c75 6520 7769 6c6c 2074  his value will t
+00039ea0: 6865 6e20 6265 2073 6574 2074 6f20 6461  hen be set to da
+00039eb0: 7461 5f74 7970 650d 0a09 0909 6966 2074  ta_type.....if t
+00039ec0: 6872 6565 2061 7265 2072 6574 7572 6e65  hree are returne
+00039ed0: 6420 7468 6520 7468 6972 6420 6973 2074  d the third is t
+00039ee0: 6865 2062 6173 6575 6e69 7420 2866 6f72  he baseunit (for
+00039ef0: 2074 6865 2074 696d 6520 6178 6973 2920   the time axis) 
+00039f00: 7468 6973 2061 6c6c 6f77 7320 746f 2075  this allows to u
+00039f10: 7365 2074 6865 2061 7574 6f6d 6174 6963  se the automatic
+00039f20: 206e 616d 696e 6720 696e 2070 7320 6f72   naming in ps or
+00039f30: 206e 616e 6f73 6563 6f6e 640d 0a09 0909   nanosecond.....
+00039f40: 4966 2074 6865 2076 616c 7565 7320 756e  If the values un
+00039f50: 6974 732c 2064 6174 615f 7479 7065 206f  its, data_type o
+00039f60: 7220 6261 7365 756e 6974 2061 7265 2028  r baseunit are (
+00039f70: 6d61 6e75 616c 6c79 2920 7365 7420 696e  manually) set in
+00039f80: 2074 6865 2069 6d70 6f72 7420 6675 6e63   the import func
+00039f90: 7469 6f6e 2074 6865 2063 6f72 7265 7370  tion the corresp
+00039fa0: 6f6e 6469 6e67 2065 6e74 7269 6573 2069  onding entries i
+00039fb0: 6e0d 0a09 0909 6461 7461 6672 616d 2077  n.....datafram w
+00039fc0: 696c 6c20 6265 206f 7665 7277 7269 7474  ill be overwritt
+00039fd0: 656e 0d0a 0909 0973 6869 6674 5f74 696d  en.....shift_tim
+00039fe0: 6573 5f62 7920 616e 6420 6469 7669 6465  es_by and divide
+00039ff0: 5f74 696d 6573 5f62 7920 7769 6c6c 2062  _times_by will b
+0003a000: 6520 6170 706c 6965 6420 6966 206e 6f74  e applied if not
+0003a010: 204e 6f6e 6520 2875 7365 6675 6c20 746f   None (useful to
+0003a020: 2061 646a 7573 7420 666f 7220 6f66 6673   adjust for offs
+0003a030: 6574 2062 6566 6f72 6520 6368 6972 7020  et before chirp 
+0003a040: 636f 7272 6563 7469 6f6e 290d 0a09 0909  correction).....
+0003a050: 200d 0a09 0909 0d0a 0909 090d 0a09 0952   ..............R
+0003a060: 6574 7572 6e73 0d0a 0909 2d2d 2d2d 2d2d  eturns....------
+0003a070: 2d0d 0a09 090d 0a09 0941 2054 4120 6f62  -........A TA ob
+0003a080: 6a65 6374 2077 6974 6820 616c 6c20 7061  ject with all pa
+0003a090: 7261 6d65 7465 7220 696e 6974 6961 6c69  rameter initiali
+0003a0a0: 7a65 640d 0a09 090d 0a09 0945 7861 6d70  zed........Examp
+0003a0b0: 6c65 730d 0a09 092d 2d2d 2d2d 2d2d 2d2d  les....---------
+0003a0c0: 2d2d 2d2d 2d0d 0a09 090d 0a09 0954 7970  -----........Typ
+0003a0d0: 6963 616c 2075 7365 6167 653a 0d0a 0909  ical useage:....
+0003a0e0: 0d0a 0909 3e3e 3e20 696d 706f 7274 2070  ....>>> import p
+0003a0f0: 6c6f 745f 6675 6e63 2061 7320 7066 2023  lot_func as pf #
+0003a100: 696d 706f 7274 2074 6865 206d 6f64 756c  import the modul
+0003a110: 6520 616e 6420 6769 7665 2069 7420 6120  e and give it a 
+0003a120: 7368 6f72 7465 7220 6e61 6d65 0d0a 0909  shorter name....
+0003a130: 3e3e 3e20 7461 3d70 662e 5441 2827 6775  >>> ta=pf.TA('gu
+0003a140: 6927 2920 2375 7365 2061 2047 5549 2074  i') #use a GUI t
+0003a150: 6f20 6f70 656e 0d0a 0909 3e3e 3e20 7461  o open....>>> ta
+0003a160: 3d70 662e 5441 2827 7361 6d70 6c65 5f31  =pf.TA('sample_1
+0003a170: 2e53 4941 2729 2023 7573 6520 6120 6669  .SIA') #use a fi
+0003a180: 6c65 6e61 6d65 2069 6e20 7468 6520 7361  lename in the sa
+0003a190: 6d65 2066 6f6c 6465 720d 0a09 093e 3e3e  me folder....>>>
+0003a1a0: 2074 613d 7066 2e54 4128 2773 616d 706c   ta=pf.TA('sampl
+0003a1b0: 655f 312e 6864 6635 272c 7061 7468 3d27  e_1.hdf5',path='
+0003a1c0: 4461 7461 2729 2023 7573 6520 6120 6669  Data') #use a fi
+0003a1d0: 6c65 6e61 6d65 2069 6e20 7468 6520 666f  lename in the fo
+0003a1e0: 6c64 6572 2027 4461 7461 270d 0a09 090d  lder 'Data'.....
+0003a1f0: 0a09 094f 7065 6e69 6e67 2061 206c 6973  ...Opening a lis
+0003a200: 7420 6f66 2066 696c 6573 2077 6974 6820  t of files with 
+0003a210: 6578 7465 726e 616c 2074 696d 6520 7665  external time ve
+0003a220: 6374 6f72 2028 6f66 2074 6865 2073 616d  ctor (of the sam
+0003a230: 6520 6e61 6d65 2920 736f 2069 7420 6c6f  e name) so it lo
+0003a240: 6f6b 7320 666f 7220 6120 6461 7461 0d0a  oks for a data..
+0003a250: 0909 6669 6c65 2022 6669 7465 312e 7478  ..file "fite1.tx
+0003a260: 7422 2061 6e64 2061 2066 696c 6520 7769  t" and a file wi
+0003a270: 7468 2074 6865 2074 696d 6520 696e 666f  th the time info
+0003a280: 726d 6174 696f 6e20 2266 696c 6531 2e74  rmation "file1.t
+0003a290: 6964 220d 0a09 090d 0a09 093e 3e3e 7461  id"........>>>ta
+0003a2a0: 3d70 662e 5441 2827 6669 6c65 312e 7478  =pf.TA('file1.tx
+0003a2b0: 7427 2c20 6578 7465 726e 616c 5f74 696d  t', external_tim
+0003a2c0: 6520 3d20 2774 6964 2729 0d0a 0909 0d0a  e = 'tid')......
+0003a2d0: 0909 2727 270d 0a09 090d 0a09 090d 0a09  ..'''...........
+0003a2e0: 090d 0a09 0973 656c 662e 7061 7468 3d63  .....self.path=c
+0003a2f0: 6865 636b 5f66 6f6c 6465 7228 7061 7468  heck_folder(path
+0003a300: 3d70 6174 682c 6375 7272 656e 745f 7061  =path,current_pa
+0003a310: 7468 3d6f 732e 6765 7463 7764 2829 290d  th=os.getcwd()).
+0003a320: 0a09 0973 656c 662e 6669 6c65 6e61 6d65  ...self.filename
+0003a330: 3d66 696c 656e 616d 650d 0a09 0969 6620  =filename....if 
+0003a340: 6473 2069 7320 6e6f 7420 4e6f 6e65 3a0d  ds is not None:.
+0003a350: 0a09 0909 6966 2066 696c 656e 616d 6520  ....if filename 
+0003a360: 6973 204e 6f6e 653a 0d0a 0909 0909 6669  is None:......fi
+0003a370: 6c65 6e61 6d65 203d 2027 6578 7465 726e  lename = 'extern
+0003a380: 616c 270d 0a09 0909 0973 656c 662e 6669  al'......self.fi
+0003a390: 6c65 6e61 6d65 3d27 6578 7465 726e 616c  lename='external
+0003a3a0: 270d 0a09 0969 6620 6669 6c65 6e61 6d65  '....if filename
+0003a3b0: 203d 3d20 2767 7569 273a 0d0a 0909 0972   == 'gui':.....r
+0003a3c0: 6f6f 745f 7769 6e64 6f77 203d 2074 6b69  oot_window = tki
+0003a3d0: 6e74 6572 2e54 6b28 2909 0909 0d0a 0909  nter.Tk().......
+0003a3e0: 0972 6f6f 745f 7769 6e64 6f77 2e77 6974  .root_window.wit
+0003a3f0: 6864 7261 7728 290d 0a09 0909 726f 6f74  hdraw().....root
+0003a400: 5f77 696e 646f 772e 6174 7472 6962 7574  _window.attribut
+0003a410: 6573 2827 2d74 6f70 6d6f 7374 272c 5472  es('-topmost',Tr
+0003a420: 7565 290d 0a09 0909 726f 6f74 5f77 696e  ue).....root_win
+0003a430: 646f 772e 6166 7465 7228 3130 3030 2c20  dow.after(1000, 
+0003a440: 6c61 6d62 6461 3a20 726f 6f74 5f77 696e  lambda: root_win
+0003a450: 646f 772e 666f 6375 735f 666f 7263 6528  dow.focus_force(
+0003a460: 2929 0d0a 0909 0963 6f6d 706c 6574 655f  )).....complete_
+0003a470: 7061 7468 203d 2066 696c 6564 6961 6c6f  path = filedialo
+0003a480: 672e 6173 6b6f 7065 6e66 696c 656e 616d  g.askopenfilenam
+0003a490: 6528 696e 6974 6961 6c64 6972 3d6f 732e  e(initialdir=os.
+0003a4a0: 6765 7463 7764 2829 290d 0a09 0909 6c69  getcwd()).....li
+0003a4b0: 7374 656e 3d6f 732e 7061 7468 2e73 706c  sten=os.path.spl
+0003a4c0: 6974 2863 6f6d 706c 6574 655f 7061 7468  it(complete_path
+0003a4d0: 290d 0a09 0909 7061 7468 3d6f 732e 7061  ).....path=os.pa
+0003a4e0: 7468 2e6e 6f72 6d70 6174 6828 6c69 7374  th.normpath(list
+0003a4f0: 656e 5b30 5d29 0d0a 0909 0973 656c 662e  en[0]).....self.
+0003a500: 7061 7468 3d70 6174 680d 0a09 0909 6669  path=path.....fi
+0003a510: 6c65 6e61 6d65 3d6c 6973 7465 6e5b 315d  lename=listen[1]
+0003a520: 0d0a 0909 0973 656c 662e 6669 6c65 6e61  .....self.filena
+0003a530: 6d65 3d66 696c 656e 616d 650d 0a09 0909  me=filename.....
+0003a540: 7769 7468 206f 7065 6e28 2772 6563 656e  with open('recen
+0003a550: 742e 6461 7427 2c27 7727 2920 6173 2066  t.dat','w') as f
+0003a560: 3a0d 0a09 0909 0966 2e77 7269 7465 2863  :......f.write(c
+0003a570: 6f6d 706c 6574 655f 7061 7468 290d 0a09  omplete_path)...
+0003a580: 0965 6c69 6620 6669 6c65 6e61 6d65 203d  .elif filename =
+0003a590: 3d20 2772 6563 656e 7427 3a0d 0a09 0909  = 'recent':.....
+0003a5a0: 7472 793a 0d0a 0909 0909 7769 7468 206f  try:......with o
+0003a5b0: 7065 6e28 2772 6563 656e 742e 6461 7427  pen('recent.dat'
+0003a5c0: 2c27 7227 2920 6173 2066 3a0d 0a09 0909  ,'r') as f:.....
+0003a5d0: 0909 636f 6d70 6c65 7465 5f70 6174 6820  ..complete_path 
+0003a5e0: 3d20 662e 7265 6164 6c69 6e65 2829 0d0a  = f.readline()..
+0003a5f0: 0909 0909 096c 6973 7465 6e3d 6f73 2e70  .....listen=os.p
+0003a600: 6174 682e 7370 6c69 7428 636f 6d70 6c65  ath.split(comple
+0003a610: 7465 5f70 6174 6829 0d0a 0909 0909 0970  te_path).......p
+0003a620: 6174 683d 6f73 2e70 6174 682e 6e6f 726d  ath=os.path.norm
+0003a630: 7061 7468 286c 6973 7465 6e5b 305d 290d  path(listen[0]).
+0003a640: 0a09 0909 0909 7365 6c66 2e70 6174 683d  ......self.path=
+0003a650: 7061 7468 0d0a 0909 0909 0966 696c 656e  path.......filen
+0003a660: 616d 653d 6c69 7374 656e 5b31 5d0d 0a09  ame=listen[1]...
+0003a670: 0909 0909 7365 6c66 2e66 696c 656e 616d  ....self.filenam
+0003a680: 653d 6669 6c65 6e61 6d65 0d0a 0909 0965  e=filename.....e
+0003a690: 7863 6570 743a 0d0a 0909 0909 726f 6f74  xcept:......root
+0003a6a0: 5f77 696e 646f 7720 3d20 746b 696e 7465  _window = tkinte
+0003a6b0: 722e 546b 2829 0d0a 0909 0909 726f 6f74  r.Tk()......root
+0003a6c0: 5f77 696e 646f 772e 7769 7468 6472 6177  _window.withdraw
+0003a6d0: 2829 0d0a 0909 0909 726f 6f74 5f77 696e  ()......root_win
+0003a6e0: 646f 772e 6174 7472 6962 7574 6573 2827  dow.attributes('
+0003a6f0: 2d74 6f70 6d6f 7374 272c 5472 7565 290d  -topmost',True).
+0003a700: 0a09 0909 0972 6f6f 745f 7769 6e64 6f77  .....root_window
+0003a710: 2e61 6674 6572 2831 3030 302c 206c 616d  .after(1000, lam
+0003a720: 6264 613a 2072 6f6f 745f 7769 6e64 6f77  bda: root_window
+0003a730: 2e66 6f63 7573 5f66 6f72 6365 2829 290d  .focus_force()).
+0003a740: 0a09 0909 0963 6f6d 706c 6574 655f 7061  .....complete_pa
+0003a750: 7468 203d 2066 696c 6564 6961 6c6f 672e  th = filedialog.
+0003a760: 6173 6b6f 7065 6e66 696c 656e 616d 6528  askopenfilename(
+0003a770: 696e 6974 6961 6c64 6972 3d6f 732e 6765  initialdir=os.ge
+0003a780: 7463 7764 2829 290d 0a09 0909 096c 6973  tcwd())......lis
+0003a790: 7465 6e3d 6f73 2e70 6174 682e 7370 6c69  ten=os.path.spli
+0003a7a0: 7428 636f 6d70 6c65 7465 5f70 6174 6829  t(complete_path)
+0003a7b0: 0d0a 0909 0909 7061 7468 3d6f 732e 7061  ......path=os.pa
+0003a7c0: 7468 2e6e 6f72 6d70 6174 6828 6c69 7374  th.normpath(list
+0003a7d0: 656e 5b30 5d29 0d0a 0909 0909 7365 6c66  en[0])......self
+0003a7e0: 2e70 6174 683d 7061 7468 0d0a 0909 0909  .path=path......
+0003a7f0: 6669 6c65 6e61 6d65 3d6c 6973 7465 6e5b  filename=listen[
+0003a800: 315d 0d0a 0909 0909 7365 6c66 2e66 696c  1]......self.fil
+0003a810: 656e 616d 653d 6669 6c65 6e61 6d65 0d0a  ename=filename..
+0003a820: 0909 0909 7769 7468 206f 7065 6e28 2772  ....with open('r
+0003a830: 6563 656e 742e 6461 7427 2c27 7727 2920  ecent.dat','w') 
+0003a840: 6173 2066 3a0d 0a09 0909 0909 662e 7772  as f:.......f.wr
+0003a850: 6974 6528 636f 6d70 6c65 7465 5f70 6174  ite(complete_pat
+0003a860: 6829 0d0a 0d0a 0909 6966 2066 696c 656e  h)......if filen
+0003a870: 616d 6520 3d3d 2027 6578 7465 726e 616c  ame == 'external
+0003a880: 273a 2375 7365 2061 2070 726f 7669 6465  ':#use a provide
+0003a890: 6420 6461 7461 6672 616d 6520 2864 7329  d dataframe (ds)
+0003a8a0: 2069 6e73 7465 6164 0d0a 0909 0969 6620   instead.....if 
+0003a8b0: 6461 7461 5f74 7970 6520 6973 206e 6f74  data_type is not
+0003a8c0: 204e 6f6e 653a 0d0a 0909 0909 7365 6c66   None:......self
+0003a8d0: 2e64 6174 615f 7479 7065 203d 2064 6174  .data_type = dat
+0003a8e0: 615f 7479 7065 0d0a 0909 0969 6620 756e  a_type.....if un
+0003a8f0: 6974 7320 6973 206e 6f74 204e 6f6e 653a  its is not None:
+0003a900: 0d0a 0909 0909 7365 6c66 2e75 6e69 7473  ......self.units
+0003a910: 203d 2075 6e69 7473 0d0a 0909 0909 7472   = units......tr
+0003a920: 793a 0d0a 0909 0909 0969 6620 6c65 6e28  y:.......if len(
+0003a930: 6473 2e63 6f6c 756d 6e73 2e6e 616d 6529  ds.columns.name)
+0003a940: 3d3d 303a 0d0a 0909 0909 0909 6473 2e63  ==0:........ds.c
+0003a950: 6f6c 756d 6e73 2e6e 616d 653d 2075 6e69  olumns.name= uni
+0003a960: 7473 0d0a 0909 0909 6578 6365 7074 3a0d  ts......except:.
+0003a970: 0a09 0909 0909 7061 7373 0d0a 0909 0965  ......pass.....e
+0003a980: 6c73 653a 0d0a 0909 0909 7472 793a 0d0a  lse:......try:..
+0003a990: 0909 0909 0969 6620 6c65 6e28 6473 2e63  .....if len(ds.c
+0003a9a0: 6f6c 756d 6e73 2e6e 616d 6529 213d 303a  olumns.name)!=0:
+0003a9b0: 0d0a 0909 0909 0909 7365 6c66 2e75 6e69  ........self.uni
+0003a9c0: 7473 203d 2064 732e 636f 6c75 6d6e 732e  ts = ds.columns.
+0003a9d0: 6e61 6d65 200d 0a09 0909 0965 7863 6570  name ......excep
+0003a9e0: 743a 0d0a 0909 0909 0970 6173 730d 0a09  t:.......pass...
+0003a9f0: 0909 6966 2062 6173 6575 6e69 7420 6973  ..if baseunit is
+0003aa00: 206e 6f74 204e 6f6e 653a 0d0a 0909 0909   not None:......
+0003aa10: 7365 6c66 2e62 6173 6575 6e69 7420 3d20  self.baseunit = 
+0003aa20: 6261 7365 756e 6974 0d0a 0909 0909 7472  baseunit......tr
+0003aa30: 793a 0d0a 0909 0909 0969 6620 6c65 6e28  y:.......if len(
+0003aa40: 6473 2e69 6e64 6578 2e6e 616d 6529 3d3d  ds.index.name)==
+0003aa50: 303a 0d0a 0909 0909 0909 6966 2028 6261  0:........if (ba
+0003aa60: 7365 756e 6974 203d 3d20 2770 7327 2920  seunit == 'ps') 
+0003aa70: 6f72 2028 6261 7365 756e 6974 203d 3d20  or (baseunit == 
+0003aa80: 276e 7327 293a 0d0a 0909 0909 0909 0964  'ns'):.........d
+0003aa90: 732e 696e 6465 782e 6e61 6d65 3d27 5469  s.index.name='Ti
+0003aaa0: 6d65 2069 6e20 2573 2725 6261 7365 756e  me in %s'%baseun
+0003aab0: 6974 0d0a 0909 0909 0909 656c 7365 3a0d  it........else:.
+0003aac0: 0a09 0909 0909 0909 6473 2e69 6e64 6578  ........ds.index
+0003aad0: 2e6e 616d 653d 2062 6173 6575 6e69 740d  .name= baseunit.
+0003aae0: 0a09 0909 0965 7863 6570 743a 0d0a 0909  .....except:....
+0003aaf0: 0909 0970 6173 730d 0a09 0909 656c 7365  ...pass.....else
+0003ab00: 3a0d 0a09 0909 0974 7279 3a0d 0a09 0909  :......try:.....
+0003ab10: 0909 6966 206c 656e 2864 732e 696e 6465  ..if len(ds.inde
+0003ab20: 782e 6e61 6d65 2921 3d30 3a0d 0a09 0909  x.name)!=0:.....
+0003ab30: 0909 0973 656c 662e 6261 7365 756e 6974  ...self.baseunit
+0003ab40: 203d 2064 732e 696e 6465 782e 6e61 6d65   = ds.index.name
+0003ab50: 0d0a 0909 0909 6578 6365 7074 3a0d 0a09  ......except:...
+0003ab60: 0909 0909 0970 6173 730d 0a09 0909 7365  .....pass.....se
+0003ab70: 6c66 2e64 735f 6f72 693d 6473 0d0a 0909  lf.ds_ori=ds....
+0003ab80: 0973 656c 662e 6473 3d64 730d 0a09 0909  .self.ds=ds.....
+0003ab90: 7365 6c66 2e5f 5f6d 616b 655f 7374 616e  self.__make_stan
+0003aba0: 6461 7264 5f70 6172 616d 6574 6572 2829  dard_parameter()
+0003abb0: 0d0a 0909 656c 6966 2028 2768 6466 3527  ....elif ('hdf5'
+0003abc0: 2069 6e20 6669 6c65 6e61 6d65 2920 616e   in filename) an
+0003abd0: 6420 2863 6f6e 7665 7273 696f 6e5f 6675  d (conversion_fu
+0003abe0: 6e63 7469 6f6e 2069 7320 4e6f 6e65 293a  nction is None):
+0003abf0: 2377 6520 6c6f 6164 2061 2063 6f6e 7665  #we load a conve
+0003ac00: 7273 696f 6e20 6675 6e63 7469 6f6e 2074  rsion function t
+0003ac10: 6f20 6465 616c 2077 6974 6820 7468 6520  o deal with the 
+0003ac20: 6669 6c65 3a23 7765 2072 6561 6420 696e  file:#we read in
+0003ac30: 2064 6174 6120 6672 6f6d 2070 7265 7669   data from previ
+0003ac40: 6f75 7320 7275 6e0d 0a09 0909 7365 6c66  ous run.....self
+0003ac50: 2e5f 5f72 6561 645f 7072 6f6a 6563 7428  .__read_project(
+0003ac60: 7361 7665 645f 7072 6f6a 6563 743d 6368  saved_project=ch
+0003ac70: 6563 6b5f 666f 6c64 6572 2870 6174 683d  eck_folder(path=
+0003ac80: 7365 6c66 2e70 6174 682c 6669 6c65 6e61  self.path,filena
+0003ac90: 6d65 3d73 656c 662e 6669 6c65 6e61 6d65  me=self.filename
+0003aca0: 2929 0d0a 0909 0973 656c 662e 5f5f 6d61  )).....self.__ma
+0003acb0: 6b65 5f73 7461 6e64 6172 645f 7061 7261  ke_standard_para
+0003acc0: 6d65 7465 7228 290d 0a09 0909 7365 6c66  meter().....self
+0003acd0: 2e43 6f72 5f43 6869 7270 2866 6974 636f  .Cor_Chirp(fitco
+0003ace0: 6566 663d 7365 6c66 2e66 6974 636f 6566  eff=self.fitcoef
+0003acf0: 6629 0d0a 0909 656c 7365 3a23 7765 2072  f)....else:#we r
+0003ad00: 6561 6420 696e 2072 6177 2064 6174 6120  ead in raw data 
+0003ad10: 6672 6f6d 2073 6961 2046 696c 650d 0a09  from sia File...
+0003ad20: 0909 6966 2063 6f6e 7665 7273 696f 6e5f  ..if conversion_
+0003ad30: 6675 6e63 7469 6f6e 2069 7320 6e6f 7420  function is not 
+0003ad40: 4e6f 6e65 3a0d 0a09 0909 0966 696c 656e  None:......filen
+0003ad50: 616d 653d 6368 6563 6b5f 666f 6c64 6572  ame=check_folder
+0003ad60: 2870 6174 683d 7365 6c66 2e70 6174 682c  (path=self.path,
+0003ad70: 6669 6c65 6e61 6d65 3d66 696c 656e 616d  filename=filenam
+0003ad80: 6529 0909 0909 0909 0909 0909 2020 200d  e)..........   .
+0003ad90: 0a09 0909 0974 7279 3a0d 0a09 0909 0909  .....try:.......
+0003ada0: 7265 743d 636f 6e76 6572 7369 6f6e 5f66  ret=conversion_f
+0003adb0: 756e 6374 696f 6e28 6669 6c65 6e61 6d65  unction(filename
+0003adc0: 203d 2066 696c 656e 616d 652c 2065 7874   = filename, ext
+0003add0: 6572 6e61 6c5f 7469 6d65 203d 2065 7874  ernal_time = ext
+0003ade0: 6572 6e61 6c5f 7469 6d65 2c20 6578 7465  ernal_time, exte
+0003adf0: 726e 616c 5f77 6176 6520 3d20 6578 7465  rnal_wave = exte
+0003ae00: 726e 616c 5f77 6176 6529 0d0a 0909 0909  rnal_wave)......
+0003ae10: 6578 6365 7074 3a0d 0a09 0909 0909 7472  except:.......tr
+0003ae20: 793a 0d0a 0909 0909 0909 7265 743d 636f  y:........ret=co
+0003ae30: 6e76 6572 7369 6f6e 5f66 756e 6374 696f  nversion_functio
+0003ae40: 6e28 6669 6c65 6e61 6d65 203d 2066 696c  n(filename = fil
+0003ae50: 656e 616d 652c 2065 7874 6572 6e61 6c5f  ename, external_
+0003ae60: 7469 6d65 203d 2065 7874 6572 6e61 6c5f  time = external_
+0003ae70: 7469 6d65 290d 0a09 0909 0909 6578 6365  time).......exce
+0003ae80: 7074 3a0d 0a09 0909 0909 0974 7279 3a0d  pt:........try:.
+0003ae90: 0a09 0909 0909 0909 7265 743d 636f 6e76  ........ret=conv
+0003aea0: 6572 7369 6f6e 5f66 756e 6374 696f 6e28  ersion_function(
+0003aeb0: 6669 6c65 6e61 6d65 203d 2066 696c 656e  filename = filen
+0003aec0: 616d 652c 2065 7874 6572 6e61 6c5f 7761  ame, external_wa
+0003aed0: 7665 203d 2065 7874 6572 6e61 6c5f 7761  ve = external_wa
+0003aee0: 7665 290d 0a09 0909 0909 0965 7863 6570  ve)........excep
+0003aef0: 743a 0d0a 0909 0909 0909 0974 7279 3a0d  t:.........try:.
+0003af00: 0a09 0909 0909 0909 0972 6574 3d63 6f6e  .........ret=con
+0003af10: 7665 7273 696f 6e5f 6675 6e63 7469 6f6e  version_function
+0003af20: 2866 696c 656e 616d 6520 3d20 6669 6c65  (filename = file
+0003af30: 6e61 6d65 290d 0a09 0909 0909 0909 6578  name).........ex
+0003af40: 6365 7074 2045 7863 6570 7469 6f6e 2061  cept Exception a
+0003af50: 7320 653a 0d0a 0909 0909 0909 0909 7072  s e:..........pr
+0003af60: 696e 7428 6529 0d0a 0909 0909 0909 0909  int(e)..........
+0003af70: 7265 7475 726e 2046 616c 7365 0d0a 0909  return False....
+0003af80: 0909 6966 2069 7369 6e73 7461 6e63 6528  ..if isinstance(
+0003af90: 7265 742c 7061 6e64 6173 2e44 6174 6146  ret,pandas.DataF
+0003afa0: 7261 6d65 293a 0d0a 0909 0909 0923 2369  rame):.......##i
+0003afb0: 6d70 6f72 7420 6973 2077 6861 7420 7765  mport is what we
+0003afc0: 2077 616e 7465 640d 0a09 0909 0909 6473   wanted.......ds
+0003afd0: 3d72 6574 0d0a 0909 0909 656c 6966 2069  =ret......elif i
+0003afe0: 7369 6e73 7461 6e63 6528 7265 742c 7061  sinstance(ret,pa
+0003aff0: 6e64 6173 2e53 6572 6965 7329 3a0d 0a09  ndas.Series):...
+0003b000: 0909 0909 6473 3d72 6574 2e61 735f 6672  ....ds=ret.as_fr
+0003b010: 616d 6528 290d 0a09 0909 0965 6c73 653a  ame()......else:
+0003b020: 0d0a 0909 0909 0969 6620 6c65 6e28 7265  .......if len(re
+0003b030: 7429 203d 3d20 323a 0d0a 0909 0909 0909  t) == 2:........
+0003b040: 6966 2064 6174 615f 7479 7065 2069 7320  if data_type is 
+0003b050: 4e6f 6e65 3a0d 0a09 0909 0909 0909 6473  None:.........ds
+0003b060: 2c64 6174 615f 7479 7065 3d72 6574 0d0a  ,data_type=ret..
+0003b070: 0909 0909 0909 656c 7365 3a0d 0a09 0909  ......else:.....
+0003b080: 0909 0909 6473 2c5f 3d72 6574 0d0a 0909  ....ds,_=ret....
+0003b090: 0909 0965 6c69 6620 6c65 6e28 7265 7429  ...elif len(ret)
+0003b0a0: 203d 3d20 333a 0d0a 0909 0909 0909 6966   == 3:........if
+0003b0b0: 2064 6174 615f 7479 7065 2069 7320 4e6f   data_type is No
+0003b0c0: 6e65 3a0d 0a09 0909 0909 0909 6473 2c64  ne:.........ds,d
+0003b0d0: 6174 615f 7479 7065 2c62 6173 6575 6e69  ata_type,baseuni
+0003b0e0: 743d 7265 740d 0a09 0909 0909 0965 6c73  t=ret........els
+0003b0f0: 653a 0d0a 0909 0909 0909 0964 732c 5f2c  e:.........ds,_,
+0003b100: 6261 7365 756e 6974 3d72 6574 0d0a 0909  baseunit=ret....
+0003b110: 0909 0965 6c73 653a 0d0a 0909 0909 0909  ...else:........
+0003b120: 7072 696e 7428 2773 6f72 7279 2074 6865  print('sorry the
+0003b130: 2072 6574 7572 6e20 666f 726d 6174 206f   return format o
+0003b140: 6620 7468 6520 636f 6e76 6572 7369 6f6e  f the conversion
+0003b150: 5f66 756e 6374 696f 6e20 7761 7320 6e6f  _function was no
+0003b160: 7420 756e 6465 7273 746f 6f64 2729 0d0a  t understood')..
+0003b170: 0909 0909 0909 7072 696e 7428 2772 6574  ......print('ret
+0003b180: 7572 6e3a 2074 6865 2064 6174 6166 7261  urn: the datafra
+0003b190: 6d65 2064 7320 7769 7468 2074 6865 2074  me ds with the t
+0003b1a0: 696d 655f 6178 6973 2061 7320 726f 7773  ime_axis as rows
+0003b1b0: 2061 6e64 2073 7065 6374 7261 6c20 6178   and spectral ax
+0003b1c0: 6973 2061 7320 636f 6c75 6d6e 735c 6e27  is as columns\n'
+0003b1d0: 290d 0a09 0909 0909 0970 7269 6e74 2827  )........print('
+0003b1e0: 6966 2074 6865 2064 732e 696e 6465 782e  if the ds.index.
+0003b1f0: 6e61 6d65 2069 6120 6e6f 7420 656d 7074  name ia not empt
+0003b200: 7920 7468 6520 2274 696d 6520 6178 6973  y the "time axis
+0003b210: 2220 6973 2069 6e20 746f 2074 6861 7420  " is in to that 
+0003b220: 6e61 6d65 2074 6865 2073 7065 6374 7261  name the spectra
+0003b230: 6c20 6178 6973 2069 7320 696e 2064 732e  l axis is in ds.
+0003b240: 636f 6c75 6d6e 732e 6e61 6d65 5c6e 2729  columns.name\n')
+0003b250: 0d0a 0909 0909 0909 7072 696e 7428 2774  ........print('t
+0003b260: 6865 2072 6574 7572 6e20 6973 2069 6e76  he return is inv
+0003b270: 6573 7469 6761 7465 6420 6966 2069 7420  estigated if it 
+0003b280: 6973 206f 6e65 2c20 7477 6f2c 206f 7220  is one, two, or 
+0003b290: 7468 7265 6520 7468 696e 6773 2e5c 6e20  three things.\n 
+0003b2a0: 2729 0d0a 0909 0909 0909 7072 696e 7428  ')........print(
+0003b2b0: 2769 6620 7477 6f20 6172 6520 7265 7475  'if two are retu
+0003b2c0: 726e 6564 2074 6865 6e20 7468 6520 7365  rned then the se
+0003b2d0: 636f 6e64 206d 7573 7420 6265 2074 6865  cond must be the
+0003b2e0: 206e 616d 6520 6f66 2077 6861 7420 7468   name of what th
+0003b2f0: 6520 696e 7465 6e73 6974 7920 6178 6973  e intensity axis
+0003b300: 2069 732e 2054 6869 7320 7661 6c75 6520   is. This value 
+0003b310: 7769 6c6c 2074 6865 6e20 6265 2073 6574  will then be set
+0003b320: 2074 6f20 6461 7461 5f74 7970 655c 6e27   to data_type\n'
+0003b330: 290d 0a09 0909 0909 0970 7269 6e74 2827  )........print('
+0003b340: 6966 2074 6872 6565 2061 7265 2072 6574  if three are ret
+0003b350: 7572 6e65 6420 7468 6520 7468 6972 6420  urned the third 
+0003b360: 6973 2074 6865 2062 6173 6575 6e69 7420  is the baseunit 
+0003b370: 2866 6f72 2074 6865 2074 696d 6520 6178  (for the time ax
+0003b380: 6973 2920 7468 6973 2061 6c6c 6f77 7320  is) this allows 
+0003b390: 746f 2075 7365 2074 6865 2061 7574 6f6d  to use the autom
+0003b3a0: 6174 6963 206e 616d 696e 6720 696e 2070  atic naming in p
+0003b3b0: 7320 6f72 206e 7320 2720 290d 0a09 0909  s or ns ' ).....
+0003b3c0: 0909 0972 6574 7572 6e20 4661 6c73 650d  ...return False.
+0003b3d0: 0a09 0909 0923 2320 7365 6520 6966 2077  .....## see if w
+0003b3e0: 6520 6861 7665 2074 6865 206e 616d 6520  e have the name 
+0003b3f0: 6120 6461 7461 2074 7970 6573 2069 6e20  a data types in 
+0003b400: 7468 6520 6461 7461 200d 0a09 0909 0969  the data ......i
+0003b410: 6620 6461 7461 5f74 7970 6520 6973 206e  f data_type is n
+0003b420: 6f74 204e 6f6e 653a 0d0a 0909 0909 0973  ot None:.......s
+0003b430: 656c 662e 6461 7461 5f74 7970 6520 3d20  elf.data_type = 
+0003b440: 6461 7461 5f74 7970 650d 0a09 0909 0969  data_type......i
+0003b450: 6620 756e 6974 7320 6973 206e 6f74 204e  f units is not N
+0003b460: 6f6e 653a 0d0a 0909 0909 0973 656c 662e  one:.......self.
+0003b470: 756e 6974 7320 3d20 756e 6974 730d 0a09  units = units...
+0003b480: 0909 0909 7472 793a 0d0a 0909 0909 0909  ....try:........
+0003b490: 6966 206c 656e 2864 732e 636f 6c75 6d6e  if len(ds.column
+0003b4a0: 732e 6e61 6d65 293d 3d30 3a0d 0a09 0909  s.name)==0:.....
+0003b4b0: 0909 0909 6473 2e63 6f6c 756d 6e73 2e6e  ....ds.columns.n
+0003b4c0: 616d 653d 2075 6e69 7473 0d0a 0909 0909  ame= units......
+0003b4d0: 0965 7863 6570 743a 0d0a 0909 0909 0909  .except:........
+0003b4e0: 7061 7373 0d0a 0909 0909 656c 7365 3a0d  pass......else:.
+0003b4f0: 0a09 0909 0909 7472 793a 0d0a 0909 0909  ......try:......
+0003b500: 0909 6966 206c 656e 2864 732e 636f 6c75  ..if len(ds.colu
+0003b510: 6d6e 732e 6e61 6d65 2921 3d30 3a0d 0a09  mns.name)!=0:...
+0003b520: 0909 0909 0909 7365 6c66 2e75 6e69 7473  ......self.units
+0003b530: 203d 2064 732e 636f 6c75 6d6e 732e 6e61   = ds.columns.na
+0003b540: 6d65 200d 0a09 0909 0909 6578 6365 7074  me .......except
+0003b550: 3a0d 0a09 0909 0909 0970 6173 730d 0a09  :........pass...
+0003b560: 0909 0969 6620 6261 7365 756e 6974 2069  ...if baseunit i
+0003b570: 7320 6e6f 7420 4e6f 6e65 3a0d 0a09 0909  s not None:.....
+0003b580: 0909 7365 6c66 2e62 6173 6575 6e69 7420  ..self.baseunit 
+0003b590: 3d20 6261 7365 756e 6974 0d0a 0909 0909  = baseunit......
+0003b5a0: 0974 7279 3a0d 0a09 0909 0909 0969 6620  .try:........if 
+0003b5b0: 6c65 6e28 6473 2e69 6e64 6578 2e6e 616d  len(ds.index.nam
+0003b5c0: 6529 3d3d 303a 0d0a 0909 0909 0909 0969  e)==0:.........i
+0003b5d0: 6620 2862 6173 6575 6e69 7420 3d3d 2027  f (baseunit == '
+0003b5e0: 7073 2729 206f 7220 2862 6173 6575 6e69  ps') or (baseuni
+0003b5f0: 7420 3d3d 2027 6e73 2729 3a0d 0a09 0909  t == 'ns'):.....
+0003b600: 0909 0909 0964 732e 696e 6465 782e 6e61  .....ds.index.na
+0003b610: 6d65 3d27 5469 6d65 2069 6e20 2573 2725  me='Time in %s'%
+0003b620: 6261 7365 756e 6974 0d0a 0909 0909 0909  baseunit........
+0003b630: 0965 6c73 653a 0d0a 0909 0909 0909 0909  .else:..........
+0003b640: 6473 2e69 6e64 6578 2e6e 616d 653d 2062  ds.index.name= b
+0003b650: 6173 6575 6e69 740d 0a09 0909 0909 6578  aseunit.......ex
+0003b660: 6365 7074 3a0d 0a09 0909 0909 0970 6173  cept:........pas
+0003b670: 730d 0a09 0909 0965 6c73 653a 0d0a 0909  s......else:....
+0003b680: 0909 0974 7279 3a0d 0a09 0909 0909 0969  ...try:........i
+0003b690: 6620 6c65 6e28 6473 2e69 6e64 6578 2e6e  f len(ds.index.n
+0003b6a0: 616d 6529 213d 303a 0d0a 0909 0909 0909  ame)!=0:........
+0003b6b0: 0973 656c 662e 6261 7365 756e 6974 203d  .self.baseunit =
+0003b6c0: 2064 732e 696e 6465 782e 6e61 6d65 0d0a   ds.index.name..
+0003b6d0: 0909 0909 0965 7863 6570 743a 0d0a 0909  .....except:....
+0003b6e0: 0909 0909 0970 6173 730d 0a09 0909 0969  .....pass......i
+0003b6f0: 6620 7368 6966 745f 7469 6d65 735f 6279  f shift_times_by
+0003b700: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a09   is not None:...
+0003b710: 0909 0909 6473 2e69 6e64 6578 3d64 732e  ....ds.index=ds.
+0003b720: 696e 6465 782e 7661 6c75 6573 2b73 6869  index.values+shi
+0003b730: 6674 5f74 696d 6573 5f62 790d 0a09 0909  ft_times_by.....
+0003b740: 0969 6620 6469 7669 6465 5f74 696d 6573  .if divide_times
+0003b750: 5f62 7920 6973 206e 6f74 204e 6f6e 653a  _by is not None:
+0003b760: 0d0a 0909 0909 0964 732e 696e 6465 783d  .......ds.index=
+0003b770: 6473 2e69 6e64 6578 2e76 616c 7565 732f  ds.index.values/
+0003b780: 6469 7669 6465 5f74 696d 6573 5f62 790d  divide_times_by.
+0003b790: 0a09 0909 0973 656c 662e 6473 5f6f 7269  .....self.ds_ori
+0003b7a0: 3d64 730d 0a09 0909 0973 656c 662e 6473  =ds......self.ds
+0003b7b0: 3d64 730d 0a09 0909 656c 7365 3a0d 0a09  =ds.....else:...
+0003b7c0: 0909 0973 656c 662e 5f5f 7265 6164 5f61  ...self.__read_a
+0003b7d0: 7363 6969 5f64 6174 6128 7365 7020 3d20  scii_data(sep = 
+0003b7e0: 7365 702c 2064 6563 696d 616c 203d 2064  sep, decimal = d
+0003b7f0: 6563 696d 616c 2c20 696e 6465 785f 6973  ecimal, index_is
+0003b800: 5f65 6e65 7267 7920 3d20 696e 6465 785f  _energy = index_
+0003b810: 6973 5f65 6e65 7267 792c 200d 0a09 0909  is_energy, .....
+0003b820: 0909 0909 0909 7472 616e 7370 6f73 6520  ......transpose 
+0003b830: 3d20 7472 616e 7370 6f73 652c 2073 6f72  = transpose, sor
+0003b840: 745f 696e 6465 7865 7320 3d20 736f 7274  t_indexes = sort
+0003b850: 5f69 6e64 6578 6573 2c20 0d0a 0909 0909  _indexes, ......
+0003b860: 0909 0909 0964 6976 6964 655f 7469 6d65  .....divide_time
+0003b870: 735f 6279 203d 2064 6976 6964 655f 7469  s_by = divide_ti
+0003b880: 6d65 735f 6279 2c20 7368 6966 745f 7469  mes_by, shift_ti
+0003b890: 6d65 735f 6279 203d 2073 6869 6674 5f74  mes_by = shift_t
+0003b8a0: 696d 6573 5f62 792c 200d 0a09 0909 0909  imes_by, .......
+0003b8b0: 0909 0909 6578 7465 726e 616c 5f74 696d  ....external_tim
+0003b8c0: 6520 3d20 6578 7465 726e 616c 5f74 696d  e = external_tim
+0003b8d0: 652c 2065 7874 6572 6e61 6c5f 7761 7665  e, external_wave
+0003b8e0: 203d 2065 7874 6572 6e61 6c5f 7761 7665   = external_wave
+0003b8f0: 2c20 0d0a 0909 0909 0909 0909 0975 7365  , ...........use
+0003b900: 5f73 616d 655f 6e61 6d65 203d 2075 7365  _same_name = use
+0003b910: 5f73 616d 655f 6e61 6d65 2c20 6461 7461  _same_name, data
+0003b920: 5f74 7970 6520 3d20 6461 7461 5f74 7970  _type = data_typ
+0003b930: 652c 2075 6e69 7473 203d 2075 6e69 7473  e, units = units
+0003b940: 2c20 200d 0a09 0909 0909 0909 0909 6261  ,  ...........ba
+0003b950: 7365 756e 6974 203d 2062 6173 6575 6e69  seunit = baseuni
+0003b960: 7429 0d0a 0909 0973 656c 662e 5f5f 6d61  t).....self.__ma
+0003b970: 6b65 5f73 7461 6e64 6172 645f 7061 7261  ke_standard_para
+0003b980: 6d65 7465 7228 290d 0a09 0909 6966 206c  meter().....if l
+0003b990: 656e 2873 656c 662e 6473 2e63 6f6c 756d  en(self.ds.colum
+0003b9a0: 6e73 2e76 616c 7565 7329 3c32 3a0d 0a09  ns.values)<2:...
+0003b9b0: 0909 0973 656c 662e 7265 6c5f 7761 7665  ...self.rel_wave
+0003b9c0: 3d5b 7365 6c66 2e64 732e 636f 6c75 6d6e  =[self.ds.column
+0003b9d0: 732e 7661 6c75 6573 5b30 5d5d 0909 0909  s.values[0]]....
+0003b9e0: 0909 0909 090d 0a0d 0a0d 0a09 6465 6620  ............def 
+0003b9f0: 5f5f 7265 6164 5f61 7363 6969 5f64 6174  __read_ascii_dat
+0003ba00: 6128 7365 6c66 2c20 7365 7020 3d20 225c  a(self, sep = "\
+0003ba10: 7422 2c20 6465 6369 6d61 6c20 3d20 272e  t", decimal = '.
+0003ba20: 272c 2069 6e64 6578 5f69 735f 656e 6572  ', index_is_ener
+0003ba30: 6779 203d 2046 616c 7365 2c20 7472 616e  gy = False, tran
+0003ba40: 7370 6f73 6520 3d20 4661 6c73 652c 0d0a  spose = False,..
+0003ba50: 0909 0909 0909 0973 6f72 745f 696e 6465  .......sort_inde
+0003ba60: 7865 7320 3d20 4661 6c73 652c 2064 6976  xes = False, div
+0003ba70: 6964 655f 7469 6d65 735f 6279 203d 204e  ide_times_by = N
+0003ba80: 6f6e 652c 2073 6869 6674 5f74 696d 6573  one, shift_times
+0003ba90: 5f62 7920 3d20 4e6f 6e65 2c20 0d0a 0909  _by = None, ....
+0003baa0: 0909 0909 0965 7874 6572 6e61 6c5f 7469  .....external_ti
+0003bab0: 6d65 203d 204e 6f6e 652c 2065 7874 6572  me = None, exter
+0003bac0: 6e61 6c5f 7761 7665 203d 204e 6f6e 652c  nal_wave = None,
+0003bad0: 2075 7365 5f73 616d 655f 6e61 6d65 203d   use_same_name =
+0003bae0: 2054 7275 652c 2063 6f72 7265 6374 5f61   True, correct_a
+0003baf0: 7363 6969 5f65 7272 6f72 7320 3d20 5472  scii_errors = Tr
+0003bb00: 7565 2c0d 0a09 0909 0909 0909 6461 7461  ue,.........data
+0003bb10: 5f74 7970 6520 3d20 4e6f 6e65 2c20 756e  _type = None, un
+0003bb20: 6974 7320 3d20 4e6f 6e65 2c20 2062 6173  its = None,  bas
+0003bb30: 6575 6e69 7420 3d20 4e6f 6e65 293a 0d0a  eunit = None):..
+0003bb40: 0909 2727 2746 616e 6379 2066 756e 6374  ..'''Fancy funct
+0003bb50: 696f 6e20 7468 6174 2068 616e 646c 6573  ion that handles
+0003bb60: 2074 6865 2069 6d70 6f72 7420 6f66 2070   the import of p
+0003bb70: 7572 6520 6173 6369 6920 6669 6c65 732e  ure ascii files.
+0003bb80: 0d0a 0909 0d0a 0909 5061 7261 6d65 7465  ........Paramete
+0003bb90: 7273 0d0a 0909 2d2d 2d2d 2d2d 2d2d 2d2d  rs....----------
+0003bba0: 0d0a 0909 0d0a 0909 7365 7020 3a20 7374  ........sep : st
+0003bbb0: 7220 286f 7074 696f 6e61 6c29 0d0a 0909  r (optional)....
+0003bbc0: 0969 7320 7468 6520 7365 7061 7261 746f  .is the separato
+0003bbd0: 7220 6265 7477 6565 6e20 6469 6666 6572  r between differ
+0003bbe0: 656e 7420 6e75 6d62 6572 732c 2074 7970  ent numbers, typ
+0003bbf0: 6963 616c 2061 7265 2074 6170 2028 4261  ical are tap (Ba
+0003bc00: 636b 736c 6173 6820 7429 2028 4465 6661  ckslash t) (Defa
+0003bc10: 756c 7429 202c 6f6e 6520 6f72 200d 0a09  ult) ,one or ...
+0003bc20: 0909 6d75 6c74 6970 6c65 2077 6869 7465  ..multiple white
+0003bc30: 2073 7061 6365 7320 2762 6163 6b73 6c61   spaces 'backsla
+0003bc40: 7368 2073 2b27 206f 7220 636f 6d6d 6120  sh s+' or comma 
+0003bc50: 272c 272e 0d0a 0909 0d0a 0909 6465 6369  ','.........deci
+0003bc60: 6d61 6c20 3a20 7374 7220 286f 7074 696f  mal : str (optio
+0003bc70: 6e61 6c29 200d 0a09 0909 7365 7473 2074  nal) .....sets t
+0003bc80: 6865 2061 7363 6969 2073 796d 626f 6c20  he ascii symbol 
+0003bc90: 7468 6174 2069 7320 7573 6564 2066 6f72  that is used for
+0003bca0: 2074 6865 2064 6563 696d 616c 2073 6967   the decimal sig
+0003bcb0: 6e2e 2049 6e20 6d6f 7374 2063 6f75 6e74  n. In most count
+0003bcc0: 7269 6573 2074 6869 7320 6973 2027 2e27  ries this is '.'
+0003bcd0: 2844 6566 6175 6c74 2920 0d0a 0909 0962  (Default) .....b
+0003bce0: 7574 2069 7420 6361 6e20 6265 2027 2c27  ut it can be ','
+0003bcf0: 2069 6e20 636f 756e 7472 6965 7320 6c69   in countries li
+0003bd00: 6b65 2053 7765 6465 6e20 6f72 2047 6572  ke Sweden or Ger
+0003bd10: 6d61 6e79 0d0a 0909 0d0a 0909 696e 6465  many........inde
+0003bd20: 785f 6973 5f65 6e65 7267 7920 3a20 626f  x_is_energy : bo
+0003bd30: 6f6c 2028 6f70 7469 6f6e 616c 290d 0a09  ol (optional)...
+0003bd40: 0909 7377 6974 6368 6573 2069 6620 7468  ..switches if th
+0003bd50: 6520 7761 7665 6c65 6e67 7468 2069 7320  e wavelength is 
+0003bd60: 6769 7665 6e20 696e 206e 6d20 2844 6566  given in nm (Def
+0003bd70: 6175 6c74 2920 6f72 2069 6e20 6556 2028  ault) or in eV (
+0003bd80: 6966 2054 7275 6529 2c20 6375 7272 656e  if True), curren
+0003bd90: 746c 7920 6576 6572 7974 6869 6e67 200d  tly everything .
+0003bda0: 0a09 0909 6973 2068 616e 646c 6564 2061  ....is handled a
+0003bdb0: 7320 7761 7665 6c65 6e67 7468 2069 6e20  s wavelength in 
+0003bdc0: 6e6d 2069 6e74 6572 6e61 6c6c 790d 0a09  nm internally...
+0003bdd0: 090d 0a09 0964 6174 615f 7479 7065 3a20  .....data_type: 
+0003bde0: 7374 7220 286f 7074 696f 6e61 6c29 0d0a  str (optional)..
+0003bdf0: 0909 0964 6174 615f 7479 7065 2069 7320  ...data_type is 
+0003be00: 7468 6520 7374 7269 6e67 2074 6861 7420  the string that 
+0003be10: 7265 7072 6573 656e 7473 2074 6865 2069  represents the i
+0003be20: 6e74 656e 7369 7479 206d 6561 7375 7265  ntensity measure
+0003be30: 6d65 6e74 732e 2055 7375 616c 6c79 2074  ments. Usually t
+0003be40: 6869 7320 636f 6e74 6169 6e73 2069 6620  his contains if 
+0003be50: 6162 736f 6c75 7465 200d 0a09 0909 6f66  absolute .....of
+0003be60: 2064 6966 6665 7265 6e74 6961 6c20 6461   differential da
+0003be70: 7461 2e20 5468 6973 2069 7320 7573 6564  ta. This is used
+0003be80: 2066 6f72 2074 6865 2063 6f6c 6f72 2069   for the color i
+0003be90: 6e74 656e 7369 7479 2069 6e20 7468 6520  ntensity in the 
+0003bea0: 3264 2070 6c6f 7473 2061 6e64 2074 6865  2d plots and the
+0003beb0: 2079 2d61 7869 7320 666f 7220 7468 6520   y-axis for the 
+0003bec0: 3164 2070 6c6f 7473 0d0a 0909 0d0a 0909  1d plots........
+0003bed0: 756e 6974 733a 2073 7472 2028 6f70 7469  units: str (opti
+0003bee0: 6f6e 616c 290d 0a09 0909 7468 6973 2069  onal).....this i
+0003bef0: 7320 7573 6564 2074 6f20 6964 656e 7469  s used to identi
+0003bf00: 6679 2074 6865 2075 6e69 7473 206f 6e20  fy the units on 
+0003bf10: 7468 6520 656e 6572 6779 2061 7869 7320  the energy axis 
+0003bf20: 616e 6420 746f 206c 6162 656c 2074 6865  and to label the
+0003bf30: 2073 6c69 6365 732c 2072 6563 6f67 6e69   slices, recogni
+0003bf40: 7a65 6420 6973 2027 6e6d 272c 2027 6556  zed is 'nm', 'eV
+0003bf50: 2720 616e 6420 276b 6556 2720 0d0a 0909  ' and 'keV' ....
+0003bf60: 0962 7574 2069 6620 616e 6f74 6865 7220  .but if another 
+0003bf70: 756e 6974 206c 696b 6520 2763 6d5e 2d31  unit like 'cm^-1
+0003bf80: 2720 6973 2075 7365 6420 6974 2077 696c  ' is used it wil
+0003bf90: 6c20 7374 6174 6520 656e 6572 6779 2069  l state energy i
+0003bfa0: 6e20 2763 6d5e 2d31 272e 2050 6c65 6173  n 'cm^-1'. Pleas
+0003bfb0: 206f 6273 6572 7665 2074 6861 7420 6966   observe that if
+0003bfc0: 2079 6f75 2075 7365 2074 6865 2069 6e64   you use the ind
+0003bfd0: 6578 5f69 735f 656e 6572 6779 0d0a 0909  ex_is_energy....
+0003bfe0: 0973 7769 7463 6820 7468 6520 7072 6f67  .switch the prog
+0003bff0: 7261 6d20 7472 6965 7320 746f 2063 6f6e  ram tries to con
+0003c000: 7665 7274 2074 6869 7320 656e 6572 6779  vert this energy
+0003c010: 2069 6e74 6f20 7761 7665 6c65 6e67 7468   into wavelength
+0003c020: 2e20 0d0a 0909 0d0a 0909 6261 7365 756e  . ........baseun
+0003c030: 6974 3a20 7374 7220 286f 7074 696f 6e61  it: str (optiona
+0003c040: 6c29 0d0a 0909 0974 6869 7320 6973 2075  l).....this is u
+0003c050: 7365 6420 746f 2069 6465 6e74 6966 7920  sed to identify 
+0003c060: 7468 6520 756e 6974 7320 6f6e 2074 6865  the units on the
+0003c070: 2064 6576 656c 6f70 696e 672f 7469 6d65   developing/time
+0003c080: 2061 7869 732e 2054 6869 7320 6973 206e   axis. This is n
+0003c090: 616d 6520 7468 6174 2069 7320 6174 7461  ame that is atta
+0003c0a0: 6368 6564 2074 6f20 7468 6520 696e 6465  ched to the inde
+0003c0b0: 7820 6f66 2074 6865 2064 6174 6166 7261  x of the datafra
+0003c0c0: 6d65 2e20 0d0a 0909 0973 6574 7469 6e67  me. .....setting
+0003c0d0: 2074 6869 7320 6475 7269 6e67 2069 6d70   this during imp
+0003c0e0: 6f72 7420 6973 2065 7175 6976 616c 656e  ort is equivalen
+0003c0f0: 7420 746f 2074 612e 6261 7365 756e 6974  t to ta.baseunit
+0003c100: 0d0a 0909 0d0a 0909 7472 616e 7370 6f73  ........transpos
+0003c110: 6520 3a20 626f 6f6c 2028 6f70 7469 6f6e  e : bool (option
+0003c120: 616c 290d 0a09 0909 6966 2074 6869 7320  al).....if this 
+0003c130: 7377 6974 6368 2069 7320 4661 6c73 6520  switch is False 
+0003c140: 2844 6566 6175 6c74 2920 7468 6520 7761  (Default) the wa
+0003c150: 7665 6c65 6e67 7468 2061 7265 2074 6865  velength are the
+0003c160: 2063 6f6c 756d 6e73 2061 6e64 2074 6865   columns and the
+0003c170: 2072 6f77 7320 7468 6520 7469 6d65 732e   rows the times.
+0003c180: 0d0a 0909 0d0a 0909 736f 7274 5f69 6e64  ........sort_ind
+0003c190: 6578 6573 203a 2062 6f6f 6c20 286f 7074  exes : bool (opt
+0003c1a0: 696f 6e61 6c29 0d0a 0909 0946 6f72 2046  ional).....For F
+0003c1b0: 616c 7365 2028 4465 6661 756c 7429 2049  alse (Default) I
+0003c1c0: 2061 7373 756d 6520 7468 6174 2074 6865   assume that the
+0003c1d0: 2074 696d 6573 2061 6e64 2065 6e65 7267   times and energ
+0003c1e0: 6965 7320 6172 6520 616c 7265 6164 7920  ies are already 
+0003c1f0: 696e 2061 2072 6973 696e 6720 6f72 6465  in a rising orde
+0003c200: 722e 200d 0a09 0909 7769 7468 2074 6869  r. .....with thi
+0003c210: 7320 7377 6974 6368 2c20 626f 7468 2061  s switch, both a
+0003c220: 7265 2073 6f72 7465 6420 6167 6169 6e2e  re sorted again.
+0003c230: 200d 0a09 090d 0a09 0964 6976 6964 655f   ........divide_
+0003c240: 7469 6d65 735f 6279 203a 204e 6f6e 6520  times_by : None 
+0003c250: 6f72 2066 6c6f 6174 2028 6f70 7469 6f6e  or float (option
+0003c260: 616c 2920 0d0a 0909 0968 6572 6520 6120  al) .....here a 
+0003c270: 6e75 6d62 6572 2063 616e 2062 6520 6769  number can be gi
+0003c280: 7665 6e20 7468 6174 2073 6361 6c65 7320  ven that scales 
+0003c290: 7468 6520 7469 6d65 2062 7920 616e 2061  the time by an a
+0003c2a0: 7262 6974 6172 7920 6661 6374 6f72 2e20  rbitary factor. 
+0003c2b0: 5468 6973 2069 7320 6163 7475 616c 6c79  This is actually
+0003c2c0: 2064 6976 6964 696e 670d 0a09 0909 7468   dividing.....th
+0003c2d0: 6520 7469 6d65 7320 6279 2074 6869 7320  e times by this 
+0003c2e0: 7661 6c75 652e 2041 6c74 6572 6e61 7469  value. Alternati
+0003c2f0: 7665 6c79 2074 6865 7265 2069 7320 7468  vely there is th
+0003c300: 6520 7661 7269 6162 6c65 2073 656c 662e  e variable self.
+0003c310: 6261 7365 756e 6974 2e20 5468 6520 6c61  baseunit. The la
+0003c320: 7474 6572 206f 6e6c 7920 6166 6665 6374  tter only affect
+0003c330: 7320 0d0a 0909 0977 6861 7420 6973 2077  s .....what is w
+0003c340: 7269 7474 656e 206f 6e20 7468 6520 6178  ritten on the ax
+0003c350: 6973 2c20 7768 696c 6520 7468 6973 2076  is, while this v
+0003c360: 616c 7565 2069 7320 6163 7475 616c 6c79  alue is actually
+0003c370: 2075 7365 6420 746f 2073 6361 6c65 2074   used to scale t
+0003c380: 6865 2074 696d 6573 2e20 4e6f 6e65 2028  he times. None (
+0003c390: 4465 6661 756c 7429 200d 0a09 0909 6967  Default) .....ig
+0003c3a0: 6e6f 7265 7320 7468 6973 0d0a 0909 0d0a  nores this......
+0003c3b0: 0909 7368 6966 745f 7469 6d65 735f 6279  ..shift_times_by
+0003c3c0: 203a 204e 6f6e 652c 2066 6c6f 6174 2028   : None, float (
+0003c3d0: 6f70 7469 6f6e 616c 290d 0a09 0909 5468  optional).....Th
+0003c3e0: 6973 2061 2076 616c 7565 2062 7920 7768  is a value by wh
+0003c3f0: 6963 6820 7468 6520 7469 6d65 2061 7869  ich the time axi
+0003c400: 7320 6973 2073 6869 6674 6564 2064 7572  s is shifted dur
+0003c410: 696e 6720 696d 706f 7274 2e20 5468 6973  ing import. This
+0003c420: 2069 7320 6120 7573 6566 756c 206f 7074   is a useful opt
+0003c430: 696f 6e20 6f66 2065 2e67 2e20 0d0a 0909  ion of e.g. ....
+0003c440: 0974 6865 2072 6563 6f72 6469 6e67 2073  .the recording s
+0003c450: 6f66 7477 6172 6520 646f 6573 206e 6f74  oftware does not
+0003c460: 2063 6f6d 7065 6e73 6174 6520 666f 7220   compensate for 
+0003c470: 7430 2061 6e64 2074 6865 2064 6174 6120  t0 and the data 
+0003c480: 6973 2061 6c77 6179 7320 7368 6966 7465  is always shifte
+0003c490: 642e 200d 0a09 0909 4e6f 6e65 2028 4465  d. .....None (De
+0003c4a0: 6661 756c 7429 2069 676e 6f72 6573 2074  fault) ignores t
+0003c4b0: 6869 7320 7365 7474 696e 670d 0a09 090d  his setting.....
+0003c4c0: 0a09 0965 7874 6572 6e61 6c5f 7469 6d65  ...external_time
+0003c4d0: 203a 204e 6f6e 6520 6f72 2073 7472 2028   : None or str (
+0003c4e0: 6f70 7469 6f6e 616c 290d 0a09 0909 4865  optional).....He
+0003c4f0: 7265 2061 2066 696c 656e 616d 6520 6578  re a filename ex
+0003c500: 7465 6e73 696f 6e20 2873 7472 696e 6729  tension (string)
+0003c510: 2063 616e 2062 6520 6769 7665 6e20 7468   can be given th
+0003c520: 6174 2063 6f6e 7461 696e 7320 7468 6520  at contains the 
+0003c530: 7469 6d65 2076 6563 746f 722e 200d 0a09  time vector. ...
+0003c540: 0909 5468 6520 6669 6c65 2069 7320 6173  ..The file is as
+0003c550: 7375 6d65 6420 746f 2062 6520 6174 2074  sumed to be at t
+0003c560: 6865 2073 616d 6520 7061 7468 2061 7320  he same path as 
+0003c570: 7468 6520 6461 7461 2061 6e64 2074 6f20  the data and to 
+0003c580: 636f 6e74 6169 6e20 6120 7369 6e67 6c65  contain a single
+0003c590: 200d 0a09 0909 7479 7065 206f 6620 7365   .....type of se
+0003c5a0: 7061 7261 7465 6420 6461 7461 2077 6974  parated data wit
+0003c5b0: 686f 7574 2068 6561 6465 722e 200d 0a09  hout header. ...
+0003c5c0: 0909 4966 2075 7365 5f73 616d 655f 6e61  ..If use_same_na
+0003c5d0: 6d65 203d 2054 7275 6520 2864 6566 6175  me = True (defau
+0003c5e0: 6c74 290d 0a09 0909 4974 2061 7373 756d  lt).....It assum
+0003c5f0: 6573 2074 6861 7420 7468 6973 2069 7320  es that this is 
+0003c600: 7468 6520 656e 6469 6e67 2066 6f72 2074  the ending for t
+0003c610: 6865 2066 696c 652e 2054 6865 2066 696c  he file. The fil
+0003c620: 656e 616d 6520 6974 7365 6c66 2069 7320  ename itself is 
+0003c630: 7461 6b65 6e20 6672 6f6d 2074 6865 2066  taken from the f
+0003c640: 696c 656e 616d 652e 200d 0a09 0909 652e  ilename. .....e.
+0003c650: 672e 2069 6620 7361 6d70 312e 7478 7420  g. if samp1.txt 
+0003c660: 6973 2074 6865 2066 696c 656e 616d 6520  is the filename 
+0003c670: 616e 6420 6578 7465 726e 616c 5f74 696d  and external_tim
+0003c680: 653d 272e 7469 6427 2074 6865 2070 726f  e='.tid' the pro
+0003c690: 6772 616d 2073 6561 7263 6865 7320 0d0a  gram searches ..
+0003c6a0: 0909 0973 616d 7031 2e74 6964 2066 6f72  ...samp1.tid for
+0003c6b0: 2074 6865 2074 696d 6573 2e20 5468 6520   the times. The 
+0003c6c0: 7472 616e 7370 6f73 6520 7365 7474 696e  transpose settin
+0003c6d0: 6720 6973 2061 7070 6c69 6564 2061 6e64  g is applied and
+0003c6e0: 2073 6574 7320 7768 6572 6520 7468 6520   sets where the 
+0003c6f0: 7469 6d65 7320 6172 6520 0d0a 0909 0974  times are .....t
+0003c700: 6f20 6265 2069 6e73 6572 7465 6420 2872  o be inserted (r
+0003c710: 6f77 206f 7220 636f 6c75 6d6e 2069 6e64  ow or column ind
+0003c720: 6578 6573 290d 0a09 0909 4966 2075 7365  exes).....If use
+0003c730: 5f73 616d 655f 6e61 6d65 203d 2046 616c  _same_name = Fal
+0003c740: 7365 2074 6869 7320 7368 6f75 6c64 2062  se this should b
+0003c750: 6520 7468 6520 6669 6c65 2063 6f6e 7461  e the file conta
+0003c760: 696e 696e 6720 7468 6520 7665 6374 6f72  ining the vector
+0003c770: 2066 6f72 2074 6865 2074 696d 6520 2869   for the time (i
+0003c780: 6e20 7468 6520 7361 6d65 2066 6f72 6d61  n the same forma
+0003c790: 7420 6173 2074 6865 206d 6169 6e20 6669  t as the main fi
+0003c7a0: 6c65 290d 0a09 090d 0a09 0965 7874 6572  le)........exter
+0003c7b0: 6e61 6c5f 7761 7665 203a 204e 6f6e 6520  nal_wave : None 
+0003c7c0: 6f72 2073 7472 2028 6f70 7469 6f6e 616c  or str (optional
+0003c7d0: 2920 0d0a 0909 0948 6572 6520 6120 6669  ) .....Here a fi
+0003c7e0: 6c65 6e61 6d65 2065 7874 656e 7369 6f6e  lename extension
+0003c7f0: 2028 7374 7269 6e67 2920 6361 6e20 6265   (string) can be
+0003c800: 2067 6976 656e 2074 6861 7420 636f 6e74   given that cont
+0003c810: 6169 6e73 2074 6865 2077 6176 656c 656e  ains the wavelen
+0003c820: 6774 6820 7665 6374 6f72 2e20 0d0a 0909  gth vector. ....
+0003c830: 0949 6620 7573 655f 7361 6d65 5f6e 616d  .If use_same_nam
+0003c840: 6520 3d20 5472 7565 2028 6465 6661 756c  e = True (defaul
+0003c850: 7429 0d0a 0909 0954 6865 2066 696c 6520  t).....The file 
+0003c860: 6973 2061 7373 756d 6564 2074 6f20 6265  is assumed to be
+0003c870: 2061 7420 7468 6520 7361 6d65 2070 6174   at the same pat
+0003c880: 6820 6173 2074 6865 2064 6174 6120 616e  h as the data an
+0003c890: 6420 746f 2063 6f6e 7461 696e 2061 2073  d to contain a s
+0003c8a0: 696e 676c 6520 7479 7065 200d 0a09 0909  ingle type .....
+0003c8b0: 6f66 2073 6570 6172 6174 6564 2064 6174  of separated dat
+0003c8c0: 6120 7769 7468 6f75 7420 6865 6164 6572  a without header
+0003c8d0: 2e20 5468 6973 2069 7320 7468 6520 656e  . This is the en
+0003c8e0: 6469 6e67 2066 6f72 2074 6865 2066 696c  ding for the fil
+0003c8f0: 652e 2054 6865 2066 696c 656e 616d 6520  e. The filename 
+0003c900: 6974 7365 6c66 200d 0a09 0909 6973 2074  itself .....is t
+0003c910: 616b 656e 2066 726f 6d20 7468 6520 6669  aken from the fi
+0003c920: 6c65 6e61 6d65 2e20 652e 672e 2069 6620  lename. e.g. if 
+0003c930: 7361 6d70 312e 7478 7420 6973 2074 6865  samp1.txt is the
+0003c940: 2066 696c 656e 616d 6520 616e 6420 6578   filename and ex
+0003c950: 7465 726e 616c 5f77 6176 653d 272e 7761  ternal_wave='.wa
+0003c960: 7627 200d 0a09 0909 7468 656e 2074 6865  v' .....then the
+0003c970: 2070 726f 6772 616d 2073 6561 7263 6865   program searche
+0003c980: 7320 7361 6d70 312e 7761 7620 666f 7220  s samp1.wav for 
+0003c990: 7468 6520 7761 7665 6c65 6e67 7468 2e20  the wavelength. 
+0003c9a0: 5468 6520 7472 616e 7370 6f73 6520 7365  The transpose se
+0003c9b0: 7474 696e 6720 6973 2061 7070 6c69 6564  tting is applied
+0003c9c0: 200d 0a09 0909 616e 6420 7365 7473 2077   .....and sets w
+0003c9d0: 6865 7265 2074 6865 2077 6176 656c 656e  here the wavelen
+0003c9e0: 6774 6820 6172 6520 746f 2062 6520 696e  gth are to be in
+0003c9f0: 7365 7274 6564 2028 636f 6c75 6d6e 7320  serted (columns 
+0003ca00: 6f72 2072 6f77 2069 6e64 6578 6573 290d  or row indexes).
+0003ca10: 0a09 0909 4966 2075 7365 5f73 616d 655f  ....If use_same_
+0003ca20: 6e61 6d65 203d 2046 616c 7365 0d0a 0909  name = False....
+0003ca30: 0974 6869 7320 7368 6f75 6c64 2062 6520  .this should be 
+0003ca40: 6120 6675 6c6c 2066 696c 656e 616d 6520  a full filename 
+0003ca50: 7468 6174 2063 6f6e 7461 696e 7320 7468  that contains th
+0003ca60: 6520 7665 6374 6f72 0d0a 0909 0d0a 0909  e vector........
+0003ca70: 7573 655f 7361 6d65 5f6e 616d 6520 3a20  use_same_name : 
+0003ca80: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0d0a  bool, optional..
+0003ca90: 0909 0974 6869 7320 7377 6974 6368 6573  ...this switches
+0003caa0: 2069 6620 7468 6520 6578 7465 726e 616c   if the external
+0003cab0: 2066 696c 656e 616d 6520 696e 636c 7564   filename includ
+0003cac0: 6564 2074 6865 206c 6f61 6465 6420 6669  ed the loaded fi
+0003cad0: 6c65 6e61 6d65 206f 7220 6973 2061 2073  lename or is a s
+0003cae0: 6570 6172 6174 6520 6669 6c65 0d0a 0909  eparate file....
+0003caf0: 0d0a 0909 636f 7272 6563 745f 6173 6369  ....correct_asci
+0003cb00: 695f 6572 726f 7273 203a 2020 626f 6f6c  i_errors :  bool
+0003cb10: 2028 6f70 7469 6f6e 616c 290d 0a09 0909   (optional).....
+0003cb20: 4966 2054 7275 6520 2844 6566 6175 6c74  If True (Default
+0003cb30: 2920 7468 656e 2074 6865 2063 6f64 6520  ) then the code 
+0003cb40: 7472 6965 7320 746f 2063 6174 6368 2073  tries to catch s
+0003cb50: 6f6d 6520 7374 7566 6620 6c69 6b65 2064  ome stuff like d
+0003cb60: 6f75 626c 6520 6d69 6e75 7320 7369 676e  ouble minus sign
+0003cb70: 7320 616e 6420 646f 7562 6c65 2064 6f74  s and double dot
+0003cb80: 730d 0a09 0909 0d0a 0909 2727 270d 0a09  s.........'''...
+0003cb90: 090d 0a09 0973 656c 662e 6473 5f6f 7269  .....self.ds_ori
+0003cba0: 3d70 616e 6461 732e 7265 6164 5f63 7376  =pandas.read_csv
+0003cbb0: 2863 6865 636b 5f66 6f6c 6465 7228 7061  (check_folder(pa
+0003cbc0: 7468 3d73 656c 662e 7061 7468 2c66 696c  th=self.path,fil
+0003cbd0: 656e 616d 653d 7365 6c66 2e66 696c 656e  ename=self.filen
+0003cbe0: 616d 6529 2c20 7365 703d 7365 702c 2069  ame), sep=sep, i
+0003cbf0: 6e64 6578 5f63 6f6c 3d30 290d 0a09 0969  ndex_col=0)....i
+0003cc00: 6620 636f 7272 6563 745f 6173 6369 695f  f correct_ascii_
+0003cc10: 6572 726f 7273 3a0d 0a09 0909 6966 2028  errors:.....if (
+0003cc20: 7365 6c66 2e64 735f 6f72 692e 6170 706c  self.ds_ori.appl
+0003cc30: 796d 6170 2874 7970 6529 203d 3d20 666c  ymap(type) == fl
+0003cc40: 6f61 7429 2e61 6c6c 2829 2e61 6c6c 2829  oat).all().all()
+0003cc50: 3a0d 0a09 0909 0970 6173 7323 616c 6c20  :......pass#all 
+0003cc60: 636f 6c75 6d6e 7320 7765 7265 2063 6f6e  columns were con
+0003cc70: 7665 7274 6564 2074 6f20 666c 6f61 742c  verted to float,
+0003cc80: 6e69 6365 0d0a 0909 0965 6c73 653a 0d0a  nice.....else:..
+0003cc90: 0909 0909 7072 696e 7428 2773 6f6d 6520  ....print('some 
+0003cca0: 6461 7461 2062 6164 2c20 7472 7920 6669  data bad, try fi
+0003ccb0: 6c74 6572 696e 6727 290d 0a09 0909 0974  ltering')......t
+0003ccc0: 7279 3a23 2074 7279 2066 6f72 6365 6420  ry:# try forced 
+0003ccd0: 636f 6e76 6572 7369 6f6e 0d0a 0909 0909  conversion......
+0003cce0: 0973 656c 662e 6473 5f6f 7269 3d73 656c  .self.ds_ori=sel
+0003ccf0: 662e 6473 5f6f 7269 2e61 7070 6c79 6d61  f.ds_ori.applyma
+0003cd00: 7028 6c61 6d62 6461 2078 3a20 2072 652e  p(lambda x:  re.
+0003cd10: 7375 6228 272d 2d27 2c20 272d 272c 7829  sub('--', '-',x)
+0003cd20: 2069 6620 7479 7065 2878 2920 6973 2073   if type(x) is s
+0003cd30: 7472 2065 6c73 6520 7829 0d0a 0909 0909  tr else x)......
+0003cd40: 0973 656c 662e 6473 5f6f 7269 3d73 656c  .self.ds_ori=sel
+0003cd50: 662e 6473 5f6f 7269 2e61 7070 6c79 6d61  f.ds_ori.applyma
+0003cd60: 7028 6c61 6d62 6461 2078 3a20 7265 2e73  p(lambda x: re.s
+0003cd70: 7562 2872 275c 2e2b 272c 2027 2e27 2c78  ub(r'\.+', '.',x
+0003cd80: 2920 6966 2074 7970 6528 7829 2069 7320  ) if type(x) is 
+0003cd90: 7374 7220 656c 7365 2078 290d 0a09 0909  str else x).....
+0003cda0: 0909 7365 6c66 2e64 735f 6f72 693d 7365  ..self.ds_ori=se
+0003cdb0: 6c66 2e64 735f 6f72 692e 6173 7479 7065  lf.ds_ori.astype
+0003cdc0: 286e 702e 666c 6f61 7436 3429 0d0a 0909  (np.float64)....
+0003cdd0: 0909 6578 6365 7074 2045 7863 6570 7469  ..except Excepti
+0003cde0: 6f6e 2061 7320 653a 0d0a 0909 0909 0970  on as e:.......p
+0003cdf0: 7269 6e74 2827 666f 7263 6520 636c 6561  rint('force clea
+0003ce00: 6e69 6e67 2077 656e 7420 7772 6f6e 6720  ning went wrong 
+0003ce10: 616e 6420 7468 6520 6669 6c65 2025 7320  and the file %s 
+0003ce20: 6361 6e20 6e6f 7420 6265 2072 6561 642e  can not be read.
+0003ce30: 2045 7272 6f72 206d 6573 7361 6765 2069   Error message i
+0003ce40: 733a 2725 7365 6c66 2e66 696c 656e 616d  s:'%self.filenam
+0003ce50: 6529 0d0a 0909 0909 0970 7269 6e74 2865  e).......print(e
+0003ce60: 290d 0a09 0909 0909 7265 7475 726e 2046  ).......return F
+0003ce70: 616c 7365 0d0a 0909 6966 2065 7874 6572  alse....if exter
+0003ce80: 6e61 6c5f 7469 6d65 2069 7320 6e6f 7420  nal_time is not 
+0003ce90: 4e6f 6e65 3a0d 0a09 0909 6966 2075 7365  None:.....if use
+0003cea0: 5f73 616d 655f 6e61 6d65 3a0d 0a09 0909  _same_name:.....
+0003ceb0: 0974 696d 655f 6669 6c65 3d63 6865 636b  .time_file=check
+0003cec0: 5f66 6f6c 6465 7228 7061 7468 3d73 656c  _folder(path=sel
+0003ced0: 662e 7061 7468 2c66 696c 656e 616d 653d  f.path,filename=
+0003cee0: 7365 6c66 2e66 696c 656e 616d 652e 7370  self.filename.sp
+0003cef0: 6c69 7428 272e 2729 5b30 5d2b 272e 272b  lit('.')[0]+'.'+
+0003cf00: 6578 7465 726e 616c 5f74 696d 6529 0d0a  external_time)..
+0003cf10: 0909 0965 6c73 653a 0d0a 0909 0909 7469  ...else:......ti
+0003cf20: 6d65 5f66 696c 653d 6368 6563 6b5f 666f  me_file=check_fo
+0003cf30: 6c64 6572 2870 6174 683d 7365 6c66 2e70  lder(path=self.p
+0003cf40: 6174 682c 6669 6c65 6e61 6d65 3d65 7874  ath,filename=ext
+0003cf50: 6572 6e61 6c5f 7469 6d65 290d 0a09 0969  ernal_time)....i
+0003cf60: 6620 6578 7465 726e 616c 5f77 6176 6520  f external_wave 
+0003cf70: 6973 206e 6f74 204e 6f6e 653a 0d0a 0909  is not None:....
+0003cf80: 0969 6620 7573 655f 7361 6d65 5f6e 616d  .if use_same_nam
+0003cf90: 653a 0d0a 0909 0909 7761 7665 5f66 696c  e:......wave_fil
+0003cfa0: 653d 6368 6563 6b5f 666f 6c64 6572 2870  e=check_folder(p
+0003cfb0: 6174 683d 7365 6c66 2e70 6174 682c 6669  ath=self.path,fi
+0003cfc0: 6c65 6e61 6d65 3d73 656c 662e 6669 6c65  lename=self.file
+0003cfd0: 6e61 6d65 2e73 706c 6974 2827 2e27 295b  name.split('.')[
+0003cfe0: 305d 2b27 2e27 2b65 7874 6572 6e61 6c5f  0]+'.'+external_
+0003cff0: 7761 7665 290d 0a09 0909 656c 7365 3a0d  wave).....else:.
+0003d000: 0a09 0909 0977 6176 655f 6669 6c65 3d63  .....wave_file=c
+0003d010: 6865 636b 5f66 6f6c 6465 7228 7061 7468  heck_folder(path
+0003d020: 3d73 656c 662e 7061 7468 2c66 696c 656e  =self.path,filen
+0003d030: 616d 653d 6578 7465 726e 616c 5f77 6176  ame=external_wav
+0003d040: 6529 0d0a 0909 0d0a 0909 6966 2065 7874  e)........if ext
+0003d050: 6572 6e61 6c5f 7469 6d65 2069 7320 6e6f  ernal_time is no
+0003d060: 7420 4e6f 6e65 3a0d 0a09 0909 6461 7461  t None:.....data
+0003d070: 5f66 696c 655f 6e61 6d65 3d63 6865 636b  _file_name=check
+0003d080: 5f66 6f6c 6465 7228 7061 7468 3d73 656c  _folder(path=sel
+0003d090: 662e 7061 7468 2c66 696c 656e 616d 653d  f.path,filename=
+0003d0a0: 7365 6c66 2e66 696c 656e 616d 6529 0d0a  self.filename)..
+0003d0b0: 0909 0974 696d 6573 3d70 616e 6461 732e  ...times=pandas.
+0003d0c0: 7265 6164 5f63 7376 2874 696d 655f 6669  read_csv(time_fi
+0003d0d0: 6c65 2c68 6561 6465 723d 4e6f 6e65 2c64  le,header=None,d
+0003d0e0: 6563 696d 616c 3d64 6563 696d 616c 292e  ecimal=decimal).
+0003d0f0: 7661 6c75 6573 2e72 6176 656c 2829 0d0a  values.ravel()..
+0003d100: 0909 0969 6620 7472 616e 7370 6f73 653a  ...if transpose:
+0003d110: 0d0a 0909 0909 6966 2065 7874 6572 6e61  ......if externa
+0003d120: 6c5f 7761 7665 2069 7320 6e6f 7420 4e6f  l_wave is not No
+0003d130: 6e65 3a0d 0a09 0909 0909 7365 6c66 2e64  ne:.......self.d
+0003d140: 735f 6f72 693d 7061 6e64 6173 2e72 6561  s_ori=pandas.rea
+0003d150: 645f 6373 7628 6368 6563 6b5f 666f 6c64  d_csv(check_fold
+0003d160: 6572 2870 6174 683d 7365 6c66 2e70 6174  er(path=self.pat
+0003d170: 682c 6669 6c65 6e61 6d65 3d73 656c 662e  h,filename=self.
+0003d180: 6669 6c65 6e61 6d65 292c 2073 6570 3d73  filename), sep=s
+0003d190: 6570 202c 2064 6563 696d 616c 3d64 6563  ep , decimal=dec
+0003d1a0: 696d 616c 2c20 6865 6164 6572 3d4e 6f6e  imal, header=Non
+0003d1b0: 6529 0d0a 0909 0909 0977 6176 6573 3d70  e).......waves=p
+0003d1c0: 616e 6461 732e 7265 6164 5f63 7376 2877  andas.read_csv(w
+0003d1d0: 6176 655f 6669 6c65 2c68 6561 6465 723d  ave_file,header=
+0003d1e0: 4e6f 6e65 2c64 6563 696d 616c 3d64 6563  None,decimal=dec
+0003d1f0: 696d 616c 292e 7661 6c75 6573 2e72 6176  imal).values.rav
+0003d200: 656c 2829 0d0a 0909 0909 0973 656c 662e  el().......self.
+0003d210: 6473 5f6f 7269 2e69 6e64 6578 3d77 6176  ds_ori.index=wav
+0003d220: 6573 0d0a 0909 0909 656c 7365 3a0d 0a09  es......else:...
+0003d230: 0909 0909 7365 6c66 2e64 735f 6f72 693d  ....self.ds_ori=
+0003d240: 7061 6e64 6173 2e72 6561 645f 6373 7628  pandas.read_csv(
+0003d250: 6368 6563 6b5f 666f 6c64 6572 2870 6174  check_folder(pat
+0003d260: 683d 7365 6c66 2e70 6174 682c 6669 6c65  h=self.path,file
+0003d270: 6e61 6d65 3d73 656c 662e 6669 6c65 6e61  name=self.filena
+0003d280: 6d65 292c 2073 6570 3d73 6570 202c 2064  me), sep=sep , d
+0003d290: 6563 696d 616c 3d64 6563 696d 616c 2c20  ecimal=decimal, 
+0003d2a0: 696e 6465 785f 636f 6c3d 302c 6865 6164  index_col=0,head
+0003d2b0: 6572 3d4e 6f6e 6529 0d0a 0909 0909 7365  er=None)......se
+0003d2c0: 6c66 2e64 735f 6f72 692e 636f 6c75 6d6e  lf.ds_ori.column
+0003d2d0: 733d 7469 6d65 730d 0a09 0909 656c 7365  s=times.....else
+0003d2e0: 3a0d 0a09 0909 0969 6620 6578 7465 726e  :......if extern
+0003d2f0: 616c 5f77 6176 6520 6973 206e 6f74 204e  al_wave is not N
+0003d300: 6f6e 653a 0d0a 0909 0909 0973 656c 662e  one:.......self.
+0003d310: 6473 5f6f 7269 3d70 616e 6461 732e 7265  ds_ori=pandas.re
+0003d320: 6164 5f63 7376 2863 6865 636b 5f66 6f6c  ad_csv(check_fol
+0003d330: 6465 7228 7061 7468 3d73 656c 662e 7061  der(path=self.pa
+0003d340: 7468 2c66 696c 656e 616d 653d 7365 6c66  th,filename=self
+0003d350: 2e66 696c 656e 616d 6529 2c20 7365 703d  .filename), sep=
+0003d360: 7365 702c 2064 6563 696d 616c 3d64 6563  sep, decimal=dec
+0003d370: 696d 616c 2c68 6561 6465 723d 4e6f 6e65  imal,header=None
+0003d380: 290d 0a09 0909 0909 7761 7665 733d 7061  ).......waves=pa
+0003d390: 6e64 6173 2e72 6561 645f 6373 7628 7761  ndas.read_csv(wa
+0003d3a0: 7665 5f66 696c 652c 6865 6164 6572 3d4e  ve_file,header=N
+0003d3b0: 6f6e 652c 6465 6369 6d61 6c3d 6465 6369  one,decimal=deci
+0003d3c0: 6d61 6c29 2e76 616c 7565 732e 7261 7665  mal).values.rave
+0003d3d0: 6c28 290d 0a09 0909 0909 7365 6c66 2e64  l().......self.d
+0003d3e0: 735f 6f72 692e 636f 6c75 6d6e 733d 7761  s_ori.columns=wa
+0003d3f0: 7665 730d 0a09 0909 0965 6c73 653a 0d0a  ves......else:..
+0003d400: 0909 0909 0973 656c 662e 6473 5f6f 7269  .....self.ds_ori
+0003d410: 3d70 616e 6461 732e 7265 6164 5f63 7376  =pandas.read_csv
+0003d420: 2863 6865 636b 5f66 6f6c 6465 7228 7061  (check_folder(pa
+0003d430: 7468 3d73 656c 662e 7061 7468 2c66 696c  th=self.path,fil
+0003d440: 656e 616d 653d 7365 6c66 2e66 696c 656e  ename=self.filen
+0003d450: 616d 6529 2c20 7365 703d 7365 702c 2064  ame), sep=sep, d
+0003d460: 6563 696d 616c 3d64 6563 696d 616c 290d  ecimal=decimal).
+0003d470: 0a09 0909 0973 656c 662e 6473 5f6f 7269  .....self.ds_ori
+0003d480: 2e69 6e64 6578 3d74 696d 6573 0d0a 0909  .index=times....
+0003d490: 656c 6966 2065 7874 6572 6e61 6c5f 7761  elif external_wa
+0003d4a0: 7665 2069 7320 6e6f 7420 4e6f 6e65 3a0d  ve is not None:.
+0003d4b0: 0a09 0909 6461 7461 5f66 696c 655f 6e61  ....data_file_na
+0003d4c0: 6d65 3d63 6865 636b 5f66 6f6c 6465 7228  me=check_folder(
+0003d4d0: 7061 7468 3d73 656c 662e 7061 7468 2c66  path=self.path,f
+0003d4e0: 696c 656e 616d 653d 7365 6c66 2e66 696c  ilename=self.fil
+0003d4f0: 656e 616d 6529 0d0a 0909 0977 6176 6573  ename).....waves
+0003d500: 3d70 616e 6461 732e 7265 6164 5f63 7376  =pandas.read_csv
+0003d510: 2877 6176 655f 6669 6c65 2c68 6561 6465  (wave_file,heade
+0003d520: 723d 4e6f 6e65 2c64 6563 696d 616c 3d64  r=None,decimal=d
+0003d530: 6563 696d 616c 292e 7661 6c75 6573 2e72  ecimal).values.r
+0003d540: 6176 656c 2829 0d0a 0909 0969 6620 7472  avel().....if tr
+0003d550: 616e 7370 6f73 653a 0d0a 0909 0909 7365  anspose:......se
+0003d560: 6c66 2e64 735f 6f72 693d 7061 6e64 6173  lf.ds_ori=pandas
+0003d570: 2e72 6561 645f 6373 7628 6368 6563 6b5f  .read_csv(check_
+0003d580: 666f 6c64 6572 2870 6174 683d 7365 6c66  folder(path=self
+0003d590: 2e70 6174 682c 6669 6c65 6e61 6d65 3d73  .path,filename=s
+0003d5a0: 656c 662e 6669 6c65 6e61 6d65 292c 2073  elf.filename), s
+0003d5b0: 6570 3d73 6570 2c20 6465 6369 6d61 6c3d  ep=sep, decimal=
+0003d5c0: 6465 6369 6d61 6c29 0d0a 0909 0909 7365  decimal)......se
+0003d5d0: 6c66 2e64 735f 6f72 692e 696e 6465 783d  lf.ds_ori.index=
+0003d5e0: 7761 7665 730d 0a09 0909 656c 7365 3a0d  waves.....else:.
+0003d5f0: 0a09 0909 0973 656c 662e 6473 5f6f 7269  .....self.ds_ori
+0003d600: 3d70 616e 6461 732e 7265 6164 5f63 7376  =pandas.read_csv
+0003d610: 2863 6865 636b 5f66 6f6c 6465 7228 7061  (check_folder(pa
+0003d620: 7468 3d73 656c 662e 7061 7468 2c66 696c  th=self.path,fil
+0003d630: 656e 616d 653d 7365 6c66 2e66 696c 656e  ename=self.filen
+0003d640: 616d 6529 2c20 7365 703d 7365 702c 2064  ame), sep=sep, d
+0003d650: 6563 696d 616c 3d64 6563 696d 616c 2c69  ecimal=decimal,i
+0003d660: 6e64 6578 5f63 6f6c 3d30 2c68 6561 6465  ndex_col=0,heade
+0003d670: 723d 4e6f 6e65 290d 0a09 0909 0973 656c  r=None)......sel
+0003d680: 662e 6473 5f6f 7269 2e63 6f6c 756d 6e73  f.ds_ori.columns
+0003d690: 3d77 6176 6573 0d0a 0909 7365 6c66 2e64  =waves....self.d
+0003d6a0: 735f 6f72 692e 636f 6c75 6d6e 733d 7365  s_ori.columns=se
+0003d6b0: 6c66 2e64 735f 6f72 692e 636f 6c75 6d6e  lf.ds_ori.column
+0003d6c0: 732e 6173 7479 7065 2827 666c 6f61 7427  s.astype('float'
+0003d6d0: 2923 4d61 6b65 2063 6f6c 756d 6e73 2069  )#Make columns i
+0003d6e0: 6e64 6578 6573 206e 756d 6265 7273 0d0a  ndexes numbers..
+0003d6f0: 0909 7365 6c66 2e64 735f 6f72 692e 696e  ..self.ds_ori.in
+0003d700: 6465 783d 7365 6c66 2e64 735f 6f72 692e  dex=self.ds_ori.
+0003d710: 696e 6465 782e 6173 7479 7065 2827 666c  index.astype('fl
+0003d720: 6f61 7427 2923 4d61 6b65 2072 6f77 2069  oat')#Make row i
+0003d730: 6e64 6578 6573 206e 756d 6265 7273 0d0a  ndexes numbers..
+0003d740: 0909 6966 2069 6e64 6578 5f69 735f 656e  ..if index_is_en
+0003d750: 6572 6779 3a0d 0a09 0909 7365 6c66 2e64  ergy:.....self.d
+0003d760: 735f 6f72 692e 696e 6465 783d 7363 6970  s_ori.index=scip
+0003d770: 792e 636f 6e73 7461 6e74 732e 682a 7363  y.constants.h*sc
+0003d780: 6970 792e 636f 6e73 7461 6e74 732e 632f  ipy.constants.c/
+0003d790: 2873 656c 662e 6473 5f6f 7269 2e69 6e64  (self.ds_ori.ind
+0003d7a0: 6578 2a31 652d 392a 7363 6970 792e 636f  ex*1e-9*scipy.co
+0003d7b0: 6e73 7461 6e74 732e 656c 6563 7472 6f6e  nstants.electron
+0003d7c0: 5f76 6f6c 7429 0d0a 0909 0909 0909 0909  _volt)..........
+0003d7d0: 0909 0909 0909 0920 200d 0a09 0969 6620  .......  ....if 
+0003d7e0: 7472 616e 7370 6f73 653a 0d0a 0909 0973  transpose:.....s
+0003d7f0: 656c 662e 6473 5f6f 7269 3d73 656c 662e  elf.ds_ori=self.
+0003d800: 6473 5f6f 7269 2e54 0d0a 0909 6966 2073  ds_ori.T....if s
+0003d810: 6f72 745f 696e 6465 7865 733a 0d0a 0909  ort_indexes:....
+0003d820: 0973 656c 662e 6473 5f6f 7269 2e73 6f72  .self.ds_ori.sor
+0003d830: 745f 696e 6465 7828 6178 6973 3d30 2c69  t_index(axis=0,i
+0003d840: 6e70 6c61 6365 3d54 7275 6529 0d0a 0909  nplace=True)....
+0003d850: 0973 656c 662e 6473 5f6f 7269 2e73 6f72  .self.ds_ori.sor
+0003d860: 745f 696e 6465 7828 6178 6973 3d31 2c69  t_index(axis=1,i
+0003d870: 6e70 6c61 6365 3d54 7275 6529 0d0a 0909  nplace=True)....
+0003d880: 6966 2073 6869 6674 5f74 696d 6573 5f62  if shift_times_b
+0003d890: 7920 6973 206e 6f74 204e 6f6e 653a 0d0a  y is not None:..
+0003d8a0: 0909 0973 656c 662e 6473 5f6f 7269 2e69  ...self.ds_ori.i
+0003d8b0: 6e64 6578 3d73 656c 662e 6473 5f6f 7269  ndex=self.ds_ori
+0003d8c0: 2e69 6e64 6578 2e76 616c 7565 732b 7368  .index.values+sh
+0003d8d0: 6966 745f 7469 6d65 735f 6279 0d0a 0909  ift_times_by....
+0003d8e0: 6966 2064 6976 6964 655f 7469 6d65 735f  if divide_times_
+0003d8f0: 6279 2069 7320 6e6f 7420 4e6f 6e65 3a0d  by is not None:.
+0003d900: 0a09 0909 7365 6c66 2e64 735f 6f72 692e  ....self.ds_ori.
+0003d910: 696e 6465 783d 7365 6c66 2e64 735f 6f72  index=self.ds_or
+0003d920: 692e 696e 6465 782e 7661 6c75 6573 2f64  i.index.values/d
+0003d930: 6976 6964 655f 7469 6d65 735f 6279 0d0a  ivide_times_by..
+0003d940: 0909 6966 2064 6174 615f 7479 7065 2069  ..if data_type i
+0003d950: 7320 6e6f 7420 4e6f 6e65 3a0d 0a09 0909  s not None:.....
+0003d960: 7365 6c66 2e64 6174 615f 7479 7065 203d  self.data_type =
+0003d970: 2064 6174 615f 7479 7065 0d0a 0909 6966   data_type....if
+0003d980: 2075 6e69 7473 2069 7320 6e6f 7420 4e6f   units is not No
+0003d990: 6e65 3a0d 0a09 0909 7365 6c66 2e75 6e69  ne:.....self.uni
+0003d9a0: 7473 203d 2075 6e69 7473 0d0a 0909 6966  ts = units....if
+0003d9b0: 2062 6173 6575 6e69 7420 6973 206e 6f74   baseunit is not
+0003d9c0: 204e 6f6e 653a 0d0a 0909 0973 656c 662e   None:.....self.
+0003d9d0: 6261 7365 756e 6974 203d 2062 6173 6575  baseunit = baseu
+0003d9e0: 6e69 740d 0a0d 0a09 090d 0a09 6465 6620  nit.........def 
+0003d9f0: 5f5f 6d61 6b65 5f73 7461 6e64 6172 645f  __make_standard_
+0003da00: 7061 7261 6d65 7465 7228 7365 6c66 293a  parameter(self):
+0003da10: 0d0a 0909 2727 2766 756e 6374 696f 6e20  ....'''function 
+0003da20: 7468 6174 2073 6574 7320 7468 6520 7374  that sets the st
+0003da30: 616e 6461 7264 2070 6172 616d 6574 6572  andard parameter
+0003da40: 2e20 5468 6520 6675 6e63 7469 6f6e 2074  . The function t
+0003da50: 616b 6573 206e 6f20 696e 7075 742c 2062  akes no input, b
+0003da60: 7574 2077 6520 7573 6520 7468 6973 2064  ut we use this d
+0003da70: 6f63 7374 7269 6e67 2074 6f20 6578 706c  ocstring to expl
+0003da80: 6169 6e20 7468 6520 7061 7261 6d65 7465  ain the paramete
+0003da90: 722e 0d0a 0d0a 0909 5061 7261 6d65 7465  r.......Paramete
+0003daa0: 7273 0d0a 0909 2d2d 2d2d 2d2d 2d2d 2d2d  rs....----------
+0003dab0: 2d2d 2d0d 0a0d 0a09 096c 6f67 5f73 6361  ---......log_sca
+0003dac0: 6c65 203a 2062 6f6f 6c2c 206f 7074 696f  le : bool, optio
+0003dad0: 6e61 6c0d 0a09 0909 4966 2046 616c 7365  nal.....If False
+0003dae0: 2028 4465 6661 756c 7429 2c20 5468 6520   (Default), The 
+0003daf0: 3244 2070 6c6f 7473 2028 4d61 7472 6978  2D plots (Matrix
+0003db00: 2920 6973 2070 6c6f 7474 6564 2077 6974  ) is plotted wit
+0003db10: 6820 6120 7073 6575 646f 206c 6f67 6172  h a pseudo logar
+0003db20: 6974 686d 6963 2069 6e74 656e 7369 7479  ithmic intensity
+0003db30: 2073 6361 6c65 2e20 0d0a 0909 0954 6869   scale. .....Thi
+0003db40: 7320 7573 7561 6c6c 7920 646f 6573 206e  s usually does n
+0003db50: 6f74 2067 6976 6520 676f 6f64 2072 6573  ot give good res
+0003db60: 756c 7473 2075 6e6c 6573 7320 7468 6520  ults unless the 
+0003db70: 696e 7465 6e73 6974 7920 7363 616c 6520  intensity scale 
+0003db80: 6973 2073 796d 6d65 7472 6963 200d 0a09  is symmetric ...
+0003db90: 0973 656c 662e 636d 6170 2020 3a20 6d61  .self.cmap  : ma
+0003dba0: 7470 6c6f 746c 6962 2e63 6d0d 0a09 0909  tplotlib.cm.....
+0003dbb0: 2844 6566 6175 6c74 2920 2073 7461 6e64  (Default)  stand
+0003dbc0: 6172 645f 6d61 7020 2d20 676c 6f62 616c  ard_map - global
+0003dbd0: 2070 6172 616d 6574 6572 0d0a 0909 0963   parameter.....c
+0003dbe0: 6d61 7020 6973 2061 2070 6f77 6572 6675  map is a powerfu
+0003dbf0: 6c6c 2076 6172 6961 626c 6520 7468 6174  ll variable that
+0003dc00: 2063 686f 6f73 6573 2074 6865 2063 6f6c   chooses the col
+0003dc10: 6f75 7220 6d61 7020 6170 706c 6965 6420  our map applied 
+0003dc20: 666f 7220 616c 6c20 706c 6f74 732e 2049  for all plots. I
+0003dc30: 6620 7365 7420 746f 200d 0a09 0909 4e6f  f set to .....No
+0003dc40: 6e65 2028 4465 6661 756c 7429 2074 6865  ne (Default) the
+0003dc50: 6e20 7468 6520 7365 6c66 2e63 6d61 7020  n the self.cmap 
+0003dc60: 6973 2075 7365 642e 0d0a 0909 0941 7320  is used......As 
+0003dc70: 7374 616e 6461 7264 2049 2075 7365 2074  standard I use t
+0003dc80: 6865 2063 6f6c 6f72 206d 6170 2022 6a65  he color map "je
+0003dc90: 7422 2066 726f 6d20 6d61 7470 6c6f 746c  t" from matplotl
+0003dca0: 6962 2e20 5468 6572 6520 6172 6520 6120  ib. There are a 
+0003dcb0: 7661 7269 6574 7920 6f66 2063 6f6c 6f72  variety of color
+0003dcc0: 6d61 7073 200d 0a09 0909 6176 6169 6c61  maps .....availa
+0003dcd0: 626c 6520 7468 6174 2061 7265 2076 6572  ble that are ver
+0003dce0: 7920 7573 6566 756c 6c2e 2042 6573 6964  y usefull. Besid
+0003dcf0: 6520 226a 6574 222c 2022 7669 7269 6469  e "jet", "viridi
+0003dd00: 7322 2069 7320 6120 676f 6f64 2063 686f  s" is a good cho
+0003dd10: 6963 6520 6173 2069 7420 6973 2077 656c  ice as it is wel
+0003dd20: 6c20 0d0a 0909 0976 6973 6962 6c65 2075  l .....visible u
+0003dd30: 6e64 6572 2072 6564 2d67 7265 656e 2062  nder red-green b
+0003dd40: 6c69 6e64 6e65 7373 2e20 4f74 6865 7220  lindness. Other 
+0003dd50: 7573 6566 756c 206d 6170 7320 6172 6520  useful maps are 
+0003dd60: 2270 7269 736d 2220 666f 7220 6869 6768  "prism" for high
+0003dd70: 2066 6c75 6374 7561 7469 6f6e 7320 0d0a   fluctuations ..
+0003dd80: 0909 096f 7220 6469 7665 7267 696e 6720  ...or diverging 
+0003dd90: 636f 6c6f 7220 6d61 7073 206c 696b 6520  color maps like 
+0003dda0: 2273 6569 736d 6963 222e 200d 0a09 0909  "seismic". .....
+0003ddb0: 5365 6520 6874 7470 733a 2f2f 6d61 7470  See https://matp
+0003ddc0: 6c6f 746c 6962 2e6f 7267 2f33 2e31 2e30  lotlib.org/3.1.0
+0003ddd0: 2f74 7574 6f72 6961 6c73 2f63 6f6c 6f72  /tutorials/color
+0003dde0: 732f 636f 6c6f 726d 6170 732e 6874 6d6c  s/colormaps.html
+0003ddf0: 2066 6f72 2061 2063 6f6d 7072 6568 656e   for a comprehen
+0003de00: 7369 7665 200d 0a09 0909 7365 6c65 6374  sive .....select
+0003de10: 696f 6e2e 2049 6e20 7468 6520 636f 6465  ion. In the code
+0003de20: 2074 6865 2063 6f6c 6f72 6d61 7073 2061   the colormaps a
+0003de30: 7265 2069 6d70 6f72 7465 6420 736f 2069  re imported so i
+0003de40: 6620 706c 6f74 5f66 756e 6320 6973 2069  f plot_func is i
+0003de50: 6d70 6f72 7465 6420 6173 2070 6620 7468  mported as pf th
+0003de60: 656e 200d 0a09 0909 7365 6c66 2e63 6d61  en .....self.cma
+0003de70: 703d 7066 2e63 6d2e 7669 7269 6469 7320  p=pf.cm.viridis 
+0003de80: 7365 7473 2076 6972 6964 6973 2061 7320  sets viridis as 
+0003de90: 7468 6520 6d61 7020 746f 2075 7365 2e20  the map to use. 
+0003dea0: 496e 7465 726e 616c 6c79 2074 6865 2063  Internally the c
+0003deb0: 6f6c 6f72 7320 6172 6520 6368 6f73 656e  olors are chosen
+0003dec0: 200d 0a09 0909 7769 7468 2074 6865 2022   .....with the "
+0003ded0: 636f 6c6d 2220 6675 6e63 7469 6f6e 2e20  colm" function. 
+0003dee0: 5468 6520 3264 2070 6c6f 7473 2072 6571  The 2d plots req
+0003def0: 7569 7265 2061 2063 6f6e 7469 6e75 6f75  uire a continuou
+0003df00: 7320 636f 6c6f 7220 6d61 7020 736f 2069  s color map so i
+0003df10: 6620 736f 6d65 7468 696e 6720 0d0a 0909  f something ....
+0003df20: 0965 6c73 6520 6973 2067 6976 6520 3264  .else is give 2d
+0003df30: 2070 6c6f 7473 2061 7265 2073 686f 776e   plots are shown
+0003df40: 2061 7574 6f6d 6174 6963 616c 6c79 2077   automatically w
+0003df50: 6974 6820 226a 6574 222e 2046 6f72 2061  ith "jet". For a
+0003df60: 6c6c 206f 6620 7468 6520 3164 2070 6c6f  ll of the 1d plo
+0003df70: 7473 2068 6f77 6576 6572 200d 0a09 0909  ts however .....
+0003df80: 4920 6669 7273 7420 7365 6c65 6374 2061  I first select a
+0003df90: 206e 756d 6265 7220 6f66 2063 6f6c 6f72   number of color
+0003dfa0: 7320 6265 666f 7265 2065 6163 6820 706c  s before each pl
+0003dfb0: 6f74 2e20 4966 2063 6d61 7020 6973 2061  ot. If cmap is a
+0003dfc0: 2063 6f6e 7469 6e6f 7573 206d 6170 2074   continous map t
+0003dfd0: 6865 6e20 7468 6573 650d 0a09 0909 6172  hen these.....ar
+0003dfe0: 6520 7361 6d70 6c65 6420 6576 656e 6c79  e sampled evenly
+0003dff0: 206f 7665 7220 7468 6520 636f 6c6f 7572   over the colour
+0003e000: 6d61 702e 204d 616e 7561 6c20 6974 6572  map. Manual iter
+0003e010: 6162 6c65 7320 6f66 2063 6f6c 6f75 7273  ables of colours
+0003e020: 200d 0a09 0909 636d 6170 3d5b 2831 2c30   .....cmap=[(1,0
+0003e030: 2c30 292c 2830 2c31 2c30 292c 2830 2c30  ,0),(0,1,0),(0,0
+0003e040: 2c31 292c 2e2e 2e5d 2061 7265 2061 6c73  ,1),...] are als
+0003e050: 6f20 6163 6365 7074 6564 2c20 6173 2061  o accepted, as a
+0003e060: 7265 2076 6563 746f 7273 206f 7220 6461  re vectors or da
+0003e070: 7461 6672 616d 6573 2074 6861 7420 0d0a  taframes that ..
+0003e080: 0909 0963 6f6e 7461 696e 2061 7320 726f  ...contain as ro
+0003e090: 7773 2074 6865 2063 6f6c 6f72 732e 2054  ws the colors. T
+0003e0a0: 6865 7265 206d 7573 7420 6265 206f 6620  here must be of 
+0003e0b0: 636f 7572 7365 2073 7566 6669 6369 656e  course sufficien
+0003e0c0: 7420 636f 6c6f 7273 2070 7265 7365 6e74  t colors present
+0003e0d0: 2066 6f72 200d 0a09 0909 7468 6520 6e75   for .....the nu
+0003e0e0: 6d62 6572 7320 6f66 206c 696e 6573 2074  mbers of lines t
+0003e0f0: 6861 7420 7769 6c6c 2062 6520 706c 6f74  hat will be plot
+0003e100: 7465 642e 2053 6f20 4920 7265 636f 6d6d  ted. So I recomm
+0003e110: 656e 6420 746f 2070 726f 7669 6465 2061  end to provide a
+0003e120: 7420 6c65 6173 7420 3130 2063 6f6c 6f75  t least 10 colou
+0003e130: 7273 200d 0a09 0909 2865 2e67 2e7e 796f  rs .....(e.g.~yo
+0003e140: 7572 2075 6e69 7665 7273 6974 7920 636f  ur university co
+0003e150: 6c6f 7273 292e 2063 6f6c 6f75 7273 2061  lors). colours a
+0003e160: 7265 2061 6c77 6179 7320 6769 7665 6e20  re always given 
+0003e170: 6173 2061 2c20 6c69 7374 206f 7220 7475  as a, list or tu
+0003e180: 706c 6520 7769 7468 2052 4741 206f 7220  ple with RGA or 
+0003e190: 5247 4241 0d0a 0909 0928 7769 7468 2074  RGBA.....(with t
+0003e1a0: 6865 206c 6173 7420 4120 6265 6569 6e67  he last A beeing
+0003e1b0: 2074 6865 2041 6c70 6861 3d74 7261 6e73   the Alpha=trans
+0003e1c0: 7061 7265 6e63 792e 2041 6c6c 206e 756d  parency. All num
+0003e1d0: 6265 7273 2061 7265 2062 6574 7765 656e  bers are between
+0003e1e0: 2030 2061 6e64 2031 2e20 0d0a 0909 0949   0 and 1. .....I
+0003e1f0: 6620 6120 6c69 7374 2f76 6563 746f 722f  f a list/vector/
+0003e200: 4461 7461 4672 616d 6520 6973 2067 6976  DataFrame is giv
+0003e210: 656e 2066 6f72 2074 6865 2063 6f6c 6f75  en for the colou
+0003e220: 7273 2074 6865 7920 7769 6c6c 2062 6520  rs they will be 
+0003e230: 7573 6564 2069 6e20 7468 6520 6f72 6465  used in the orde
+0003e240: 7220 7072 6f76 6964 6564 2e0d 0a09 0973  r provided.....s
+0003e250: 656c 662e 6c69 6e74 7265 7368 203a 2066  elf.lintresh : f
+0003e260: 6c6f 6174 0d0a 0909 0954 6865 2070 7365  loat.....The pse
+0003e270: 7564 6f20 6c6f 6772 6174 6968 6d69 6320  udo logratihmic 
+0003e280: 7261 6e67 6520 2273 796d 6c6f 6722 2069  range "symlog" i
+0003e290: 7320 7573 6564 2066 6f72 206d 6f73 7420  s used for most 
+0003e2a0: 7469 6d65 2061 7869 732e 2053 796d 6c6f  time axis. Symlo
+0003e2b0: 6720 706c 6f74 7320 6120 7261 6e67 6520  g plots a range 
+0003e2c0: 6172 6f75 6e64 0d0a 0909 0974 696d 6520  around.....time 
+0003e2d0: 7a65 726f 206c 696e 6561 7220 616e 6420  zero linear and 
+0003e2e0: 6265 796f 6e64 2074 6869 7320 6c69 6e65  beyond this line
+0003e2f0: 6172 2074 7265 7368 6f6c 6420 276c 696e  ar treshold 'lin
+0003e300: 7472 6573 6827 206f 6e20 6120 6c6f 6761  tresh' on a loga
+0003e310: 7269 7468 6d69 6320 7363 616c 652e 2028  rithmic scale. (
+0003e320: 4465 6661 756c 7429 2030 2e33 200d 0a09  Default) 0.3 ...
+0003e330: 0973 656c 662e 6c6f 675f 6669 7420 203a  .self.log_fit  :
+0003e340: 200d 0a09 0909 2844 6566 6175 6c74 2920   .....(Default) 
+0003e350: 2046 616c 7365 5c6e 0d0a 0909 0954 7261   False\n.....Tra
+0003e360: 6e73 6665 7220 616c 6c20 7468 6520 7469  nsfer all the ti
+0003e370: 6d65 2d66 6974 7469 6e67 2070 6172 616d  me-fitting param
+0003e380: 6574 6572 7320 696e 746f 206c 6f67 2d73  eters into log-s
+0003e390: 7061 6365 2062 6566 6f72 6520 7468 6520  pace before the 
+0003e3a0: 6669 740d 0a09 0973 656c 662e 6967 6e6f  fit....self.igno
+0003e3b0: 7265 5f74 696d 655f 7265 6769 6f6e 2020  re_time_region  
+0003e3c0: 3a20 4e6f 6e65 206f 7220 6c69 7374 2028  : None or list (
+0003e3d0: 6f66 2074 776f 2066 6c6f 6174 7320 6f72  of two floats or
+0003e3e0: 206f 6620 6c69 7374 7329 0d0a 0909 0928   of lists).....(
+0003e3f0: 4465 6661 756c 7429 2020 4e6f 6e65 0d0a  Default)  None..
+0003e400: 0909 0963 7574 2073 6574 2061 2074 696d  ...cut set a tim
+0003e410: 6520 7261 6e67 6520 7769 7468 2061 206c  e range with a l
+0003e420: 6f77 2061 6e64 2068 6967 6820 6c69 6d69  ow and high limi
+0003e430: 7420 6672 6f6d 2074 6865 2066 6974 732e  t from the fits.
+0003e440: 2028 4465 6661 756c 7429 204e 6f6e 6520   (Default) None 
+0003e450: 6e6f 7468 696e 6720 6861 7070 656e 730d  nothing happens.
+0003e460: 0a09 0909 5468 6520 7265 6769 6f6e 2077  ....The region w
+0003e470: 696c 6c20 6265 2072 656d 6f76 6564 2064  ill be removed d
+0003e480: 7572 696e 6720 7468 6520 6669 7474 696e  uring the fittin
+0003e490: 6720 7072 6f63 6573 7320 2861 6e64 2077  g process (and w
+0003e4a0: 696c 6c20 6265 206d 6973 7369 6e67 2069  ill be missing i
+0003e4b0: 6e20 7468 6520 6669 742d 7265 7375 6c74  n the fit-result
+0003e4c0: 0d0a 0909 0970 6c6f 7473 295c 6e0d 0a09  .....plots)\n...
+0003e4d0: 0909 5573 6167 6520 7369 6e67 6c65 2072  ..Usage single r
+0003e4e0: 6567 696f 6e3a 205b 6c6f 7765 7220 7265  egion: [lower re
+0003e4f0: 6769 6f6e 206c 696d 6974 2c75 7070 6572  gion limit,upper
+0003e500: 2072 6567 696f 6e20 6c69 6d69 745d 5c6e   region limit]\n
+0003e510: 0d0a 0909 0975 7365 2066 6f72 206d 756c  .....use for mul
+0003e520: 7469 706c 6520 7265 6769 6f6e 733a 5b5b  tiple regions:[[
+0003e530: 6c6f 7765 7220 6c69 6d69 7420 312c 7570  lower limit 1,up
+0003e540: 7065 7220 6c69 6d69 7420 315d 2c5b 6c6f  per limit 1],[lo
+0003e550: 7765 7220 6c69 6d69 7420 322c 7570 7065  wer limit 2,uppe
+0003e560: 7220 6c69 6d69 7420 325d 2c2e 2e2e 5d0d  r limit 2],...].
+0003e570: 0a09 0973 656c 662e 6572 726f 725f 6d61  ...self.error_ma
+0003e580: 7472 6978 5f61 6d70 6c69 6669 6361 7469  trix_amplificati
+0003e590: 6f6e 2020 3a20 0d0a 0909 0928 4465 6661  on  : .....(Defa
+0003e5a0: 756c 7429 2020 3130 0d0a 0909 7365 6c66  ult)  10....self
+0003e5b0: 2e72 656c 5f77 6176 6520 203a 2066 6c6f  .rel_wave  : flo
+0003e5c0: 6174 206f 7220 6c69 7374 2028 6f66 2066  at or list (of f
+0003e5d0: 6c6f 6174 7329 200d 0a09 0909 2844 6566  loats) .....(Def
+0003e5e0: 6175 6c74 2920 206e 702e 6172 616e 6765  ault)  np.arange
+0003e5f0: 2833 3030 2c31 3030 302c 3130 3029 5c6e  (300,1000,100)\n
+0003e600: 0d0a 0909 0927 7265 6c5f 7761 7665 2720  .....'rel_wave' 
+0003e610: 616e 6420 2777 6964 7468 2720 2869 6e20  and 'width' (in 
+0003e620: 7468 6520 6f62 6a65 6374 2063 616c 6c65  the object calle
+0003e630: 6420 2777 6176 656c 656e 6774 685f 6269  d 'wavelength_bi
+0003e640: 6e27 2077 6f72 6b20 746f 6765 7468 6572  n' work together
+0003e650: 2066 6f72 2074 6865 2063 7265 6174 696f   for the creatio
+0003e660: 6e20 0d0a 0909 096f 6620 6b69 6e65 7469  n .....of kineti
+0003e670: 6320 706c 6f74 732e 2057 6865 6e20 706c  c plots. When pl
+0003e680: 6f74 7469 6e67 206b 696e 6574 6963 2073  otting kinetic s
+0003e690: 7065 6374 7261 206f 6e65 206c 696e 6520  pectra one line 
+0003e6a0: 7769 6c6c 2062 6520 706c 6f74 7465 6420  will be plotted 
+0003e6b0: 666f 7220 6561 6368 2065 6e74 7261 6e63  for each entranc
+0003e6c0: 650d 0a09 0909 696e 2074 6865 206c 6973  e.....in the lis
+0003e6d0: 742f 7665 6374 6f72 2072 656c 5f77 6176  t/vector rel_wav
+0003e6e0: 652e 2044 7572 696e 6720 6f62 6a65 6374  e. During object
+0003e6f0: 2067 656e 6572 6174 696f 6e20 7468 6520   generation the 
+0003e700: 7665 6374 6f72 206e 702e 6172 616e 6765  vector np.arange
+0003e710: 2833 3030 2c31 3030 302c 3130 3029 200d  (300,1000,100) .
+0003e720: 0a09 0909 6973 2073 6574 2061 7320 7374  ....is set as st
+0003e730: 616e 6461 7264 2e20 416e 6f74 6865 7220  andard. Another 
+0003e740: 7479 7069 6361 6c20 7573 696e 6720 7374  typical using st
+0003e750: 796c 6520 776f 756c 6420 6265 2074 6f20  yle would be to 
+0003e760: 6465 6669 6e65 2061 206c 6973 7420 6f66  define a list of
+0003e770: 2069 6e74 6572 6573 7469 6e67 200d 0a09   interesting ...
+0003e780: 0909 7761 7665 6c65 6e67 7468 2061 7420  ..wavelength at 
+0003e790: 7768 6963 6820 6120 6b69 6e65 7469 6320  which a kinetic 
+0003e7a0: 6465 7665 6c6f 706d 656e 7420 6973 2074  development is t
+0003e7b0: 6f20 6265 2070 6c6f 7474 6564 2e20 4174  o be plotted. At
+0003e7c0: 2065 6163 6820 7365 6c65 6374 6564 2077   each selected w
+0003e7d0: 6176 656c 656e 6774 6820 0d0a 0909 0974  avelength .....t
+0003e7e0: 6865 2064 6174 6120 6265 7477 6565 6e20  he data between 
+0003e7f0: 7761 7665 6c65 6e67 7468 2b74 612e 7761  wavelength+ta.wa
+0003e800: 7665 6c65 6e67 7468 5f62 696e 2061 6e64  velength_bin and
+0003e810: 2077 6176 656c 656e 6774 682d 7461 2e77   wavelength-ta.w
+0003e820: 6176 656c 656e 6774 685f 6269 6e20 6973  avelength_bin is
+0003e830: 2061 7665 7261 6765 6420 0d0a 0909 0966   averaged .....f
+0003e840: 6f72 2065 6163 6820 7469 6d65 706f 696e  or each timepoin
+0003e850: 7420 7265 7475 726e 6564 200d 0a09 0973  t returned ....s
+0003e860: 656c 662e 7265 6c5f 7469 6d65 2020 3a20  elf.rel_time  : 
+0003e870: 666c 6f61 7420 6f72 206c 6973 742f 7665  float or list/ve
+0003e880: 6374 6f72 2028 6f66 2066 6c6f 6174 7329  ctor (of floats)
+0003e890: 0d0a 0909 0928 4465 6661 756c 7429 2020  .....(Default)  
+0003e8a0: 5b30 2e32 2c30 2e33 2c30 2e35 2c31 2c33  [0.2,0.3,0.5,1,3
+0003e8b0: 2c31 302c 3330 2c31 3030 2c33 3030 2c31  ,10,30,100,300,1
+0003e8c0: 3030 302c 3330 3030 2c39 3030 305d 5c6e  000,3000,9000]\n
+0003e8d0: 0d0a 0909 0946 6f72 2065 6163 6820 656e  .....For each en
+0003e8e0: 7472 7920 696e 2072 656c 5f74 696d 6520  try in rel_time 
+0003e8f0: 6120 7370 6563 7472 756d 2069 7320 706c  a spectrum is pl
+0003e900: 6f74 7465 642e 2049 6620 7469 6d65 5f77  otted. If time_w
+0003e910: 6964 7468 5f70 6572 6365 6e74 3d30 2028  idth_percent=0 (
+0003e920: 4465 6661 756c 7429 2074 6865 200d 0a09  Default) the ...
+0003e930: 0909 6e65 6172 6573 7420 6d65 6173 7572  ..nearest measur
+0003e940: 6564 2074 696d 6570 6f69 6e74 2069 7320  ed timepoint is 
+0003e950: 6368 6f73 656e 2e20 466f 7220 6f74 6865  chosen. For othe
+0003e960: 7220 7661 6c75 6573 2073 6565 2027 7469  r values see 'ti
+0003e970: 6d65 5f77 6964 7468 5f70 6572 6365 6e74  me_width_percent
+0003e980: 270d 0a09 0973 656c 662e 7469 6d65 5f77  '....self.time_w
+0003e990: 6964 7468 5f70 6572 6365 6e74 2020 3a20  idth_percent  : 
+0003e9a0: 666c 6f61 740d 0a09 0909 2844 6566 6175  float.....(Defau
+0003e9b0: 6c74 2920 2030 2022 7265 6c5f 7469 6d65  lt)  0 "rel_time
+0003e9c0: 2220 616e 6420 2274 696d 655f 7769 6474  " and "time_widt
+0003e9d0: 685f 7065 7263 656e 7422 2077 6f72 6b20  h_percent" work 
+0003e9e0: 746f 6765 7468 6572 2066 6f72 200d 0a09  together for ...
+0003e9f0: 0909 6372 6561 7469 6e67 2073 7065 6374  ..creating spect
+0003ea00: 7261 6c20 706c 6f74 7320 6174 2073 7065  ral plots at spe
+0003ea10: 6369 6669 6320 7469 6d65 706f 696e 7473  cific timepoints
+0003ea20: 2e20 466f 7220 6561 6368 2065 6e74 7279  . For each entry
+0003ea30: 200d 0a09 0909 696e 2072 656c 5f74 696d   .....in rel_tim
+0003ea40: 6520 6120 7370 6563 7472 756d 2069 7320  e a spectrum is 
+0003ea50: 706c 6f74 7465 642e 2049 6620 686f 7765  plotted. If howe
+0003ea60: 7665 7220 652e 672e 2074 696d 655f 7769  ver e.g. time_wi
+0003ea70: 6474 685f 7065 7263 656e 743d 3130 200d  dth_percent=10 .
+0003ea80: 0a09 0909 7468 6520 7265 6769 6f6e 2062  ....the region b
+0003ea90: 6574 7765 656e 2074 6865 2074 696d 6570  etween the timep
+0003eaa0: 6f69 6e74 2063 6c6f 7365 7374 2074 6f20  oint closest to 
+0003eab0: 7468 6520 2031 2e31 2078 2074 696d 6570  the  1.1 x timep
+0003eac0: 6f69 6e74 200d 0a09 0909 616e 6420 302e  oint .....and 0.
+0003ead0: 3920 7820 7469 6d65 706f 696e 7420 6973  9 x timepoint is
+0003eae0: 2061 7665 7261 6765 6420 616e 6420 7368   averaged and sh
+0003eaf0: 6f77 6e20 2861 6e64 2074 6865 206c 6567  own (and the leg
+0003eb00: 656e 6420 6164 6a75 7374 6564 2061 6363  end adjusted acc
+0003eb10: 6f72 6469 6e67 6c79 292e 200d 0a09 0909  ordingly). .....
+0003eb20: 5468 6973 2069 7320 7061 7274 6963 756c  This is particul
+0003eb30: 6172 6c79 2075 7365 6675 6c20 666f 7220  arly useful for 
+0003eb40: 7468 6520 6465 6e73 6c79 0d0a 0909 0973  the densly.....s
+0003eb50: 616d 706c 6564 2072 6567 696f 6e20 636c  ampled region cl
+0003eb60: 6f73 6520 746f 2074 3d30 2e20 5479 7069  ose to t=0. Typi
+0003eb70: 6361 6c6c 7920 666f 7220 6120 6c6f 6761  cally for a loga
+0003eb80: 7269 7468 6d69 6320 7265 636f 7264 6564  rithmic recorded
+0003eb90: 206b 696e 6574 6963 732c 2074 6865 200d   kinetics, the .
+0003eba0: 0a09 0909 7469 6d65 706f 696e 7473 2061  ....timepoints a
+0003ebb0: 7420 6c61 7465 7220 7469 6d65 7320 7769  t later times wi
+0003ebc0: 6c6c 2062 6520 6675 7274 6865 7220 6170  ll be further ap
+0003ebd0: 7061 7274 2074 6861 6e20 3130 2070 6572  part than 10 per
+0003ebe0: 6365 6e74 206f 6620 7468 6520 7661 6c75  cent of the valu
+0003ebf0: 652c 200d 0a09 0909 6275 7420 7468 6973  e, .....but this
+0003ec00: 2061 6c6c 6f77 7320 746f 2065 6c65 6761   allows to elega
+0003ec10: 6e74 6c79 2063 6f6d 6269 6e65 2076 616c  ntly combine val
+0003ec20: 7565 7320 6172 6f75 6e64 2074 696d 653d  ues around time=
+0003ec30: 3020 666f 7220 6265 7474 6572 2073 7461  0 for better sta
+0003ec40: 7469 7374 6963 732e 200d 0a09 0909 5468  tistics. .....Th
+0003ec50: 6973 2061 7665 7261 6769 6e67 2069 7320  is averaging is 
+0003ec60: 6f6e 6c79 2061 7070 6c69 6564 2066 6f72  only applied for
+0003ec70: 2074 6865 2070 6c6f 7474 696e 6720 6675   the plotting fu
+0003ec80: 6e63 7469 6f6e 2061 6e64 206e 6f74 2066  nction and not f
+0003ec90: 6f72 2074 6865 2066 6974 732e 0d0a 0909  or the fits.....
+0003eca0: 7365 6c66 2e62 6173 6575 6e69 7420 203a  self.baseunit  :
+0003ecb0: 2073 7472 0d0a 0909 0928 4465 6661 756c   str.....(Defaul
+0003ecc0: 7429 2020 2770 7327 5c6e 0d0a 0909 0962  t)  'ps'\n.....b
+0003ecd0: 6173 6575 6e69 7420 6973 2061 206e 6561  aseunit is a nea
+0003ece0: 7420 7761 7920 746f 2063 6861 6e67 6520  t way to change 
+0003ecf0: 7468 6520 756e 6974 206f 6e20 7468 6520  the unit on the 
+0003ed00: 7469 6d65 2061 7869 7320 6f66 2074 6865  time axis of the
+0003ed10: 2070 6c6f 7473 2e20 2844 6566 6175 6c74   plots. (Default
+0003ed20: 2920 2770 7327 2c20 6275 7420 7468 6579  ) 'ps', but they
+0003ed30: 200d 0a09 0909 6361 6e20 6265 2066 7261   .....can be fra
+0003ed40: 6d65 7320 6f72 2073 6f6d 6574 6869 6e67  mes or something
+0003ed50: 2073 696d 696c 6172 6c79 2e20 5468 6973   similarly. This
+0003ed60: 2069 7320 6368 616e 6769 6e67 206f 6e6c   is changing onl
+0003ed70: 7920 7468 6520 6c61 6265 6c20 6f66 2074  y the label of t
+0003ed80: 6865 2061 7869 732e 200d 0a09 0909 4475  he axis. .....Du
+0003ed90: 7269 6e67 2074 6865 2069 6d70 6f72 7420  ring the import 
+0003eda0: 7468 6572 6520 6973 2074 6865 206f 7074  there is the opt
+0003edb0: 696f 6e20 746f 2064 6976 6964 6520 7468  ion to divide th
+0003edc0: 6520 6e75 6d62 6572 7320 6279 2061 2066  e numbers by a f
+0003edd0: 6163 746f 722e 200d 0a09 0909 4920 6861  actor. .....I ha
+0003ede0: 7665 2061 6c73 6f20 7573 6564 2066 7261  ve also used fra
+0003edf0: 6d65 7320 6f72 2066 7320 6173 2075 6e69  mes or fs as uni
+0003ee00: 7473 2e20 496d 706f 7274 616e 7420 6973  ts. Important is
+0003ee10: 2074 6861 7420 616c 6c20 7469 6d65 2075   that all time u
+0003ee20: 6e69 7473 2077 696c 6c20 6265 206c 6162  nits will be lab
+0003ee30: 656c 6564 2077 6974 680d 0a09 0909 7468  eled with.....th
+0003ee40: 6973 2075 6e69 742e 0d0a 0909 7365 6c66  is unit.....self
+0003ee50: 2e6d 6f64 2020 3a20 0d0a 0909 0928 4465  .mod  : .....(De
+0003ee60: 6661 756c 7429 2020 2765 7870 6f6e 656e  fault)  'exponen
+0003ee70: 7469 616c 275c 6e0d 0a09 0909 5468 6973  tial'\n.....This
+0003ee80: 2069 7320 7468 6520 6465 6661 756c 7420   is the default 
+0003ee90: 6669 7474 696e 6720 6675 6e63 7469 6f6e  fitting function
+0003eea0: 2c20 696e 2067 656e 6572 616c 2074 6869  , in general thi
+0003eeb0: 7320 6973 2064 6973 6375 7373 6564 2069  s is discussed i
+0003eec0: 6e20 7468 6520 6669 7474 696e 6720 7365  n the fitting se
+0003eed0: 6374 696f 6e0d 0a09 0973 656c 662e 7363  ction....self.sc
+0003eee0: 6174 7465 7263 7574 2020 3a20 4e6f 6e65  attercut  : None
+0003eef0: 206f 7220 6974 6572 6162 6c65 2028 6f66   or iterable (of
+0003ef00: 2066 6c6f 6174 7320 6f72 206f 7468 6572   floats or other
+0003ef10: 2069 7465 7261 626c 652c 2061 6c77 6179   iterable, alway
+0003ef20: 7320 7061 6972 7321 290d 0a09 0909 2844  s pairs!).....(D
+0003ef30: 6566 6175 6c74 2920 204e 6f6e 655c 6e0d  efault)  None\n.
+0003ef40: 0a09 0909 696e 7465 6e74 6564 2074 6f20  ....intented to 
+0003ef50: 2263 7574 2220 6f6e 6520 6f72 206d 756c  "cut" one or mul
+0003ef60: 7469 706c 6520 7363 6174 7465 7220 7265  tiple scatter re
+0003ef70: 6769 6f6e 732e 2028 6966 2028 4465 6661  gions. (if (Defa
+0003ef80: 756c 7429 204e 6f6e 6520 6e6f 7468 696e  ult) None nothin
+0003ef90: 670d 0a09 0909 6861 7070 656e 7329 2049  g.....happens) I
+0003efa0: 6620 6974 2069 7320 7365 7420 7468 6520  f it is set the 
+0003efb0: 7370 6563 7472 616c 2072 6567 696f 6e20  spectral region 
+0003efc0: 6265 7477 6565 6e20 7468 6520 6c69 6d69  between the limi
+0003efd0: 7473 2069 7320 7365 7420 746f 207a 6572  ts is set to zer
+0003efe0: 6f2e 200d 0a09 0909 5573 6167 6520 7369  o. .....Usage si
+0003eff0: 6e67 6c65 2072 6567 696f 6e3a 205b 6c6f  ngle region: [lo
+0003f000: 7765 7220 7265 6769 6f6e 206c 696d 6974  wer region limit
+0003f010: 2c75 7070 6572 2072 6567 696f 6e20 6c69  ,upper region li
+0003f020: 6d69 745d 2c20 0d0a 0909 0975 7365 2066  mit], .....use f
+0003f030: 6f72 206d 756c 7469 706c 6520 7265 6769  or multiple regi
+0003f040: 6f6e 733a 5b5b 6c6f 7765 7220 6c69 6d69  ons:[[lower limi
+0003f050: 7420 312c 7570 7065 7220 6c69 6d69 7420  t 1,upper limit 
+0003f060: 315d 2c5b 6c6f 7765 7220 6c69 6d69 7420  1],[lower limit 
+0003f070: 322c 7570 7065 7220 6c69 6d69 7420 325d  2,upper limit 2]
+0003f080: 2c2e 2e2e 5d0d 0a09 0973 656c 662e 626f  ,...]....self.bo
+0003f090: 7264 6572 6375 7420 203a 204e 6f6e 6520  rdercut  : None 
+0003f0a0: 6f72 2069 7465 7261 626c 6520 2877 6974  or iterable (wit
+0003f0b0: 6820 7477 6f20 666c 6f61 7473 290d 0a09  h two floats)...
+0003f0c0: 0909 2844 6566 6175 6c74 2920 204e 6f6e  ..(Default)  Non
+0003f0d0: 655c 6e0d 0a09 0909 6375 7420 7370 6563  e\n.....cut spec
+0003f0e0: 7472 6120 6174 2074 6865 206c 6f77 2061  tra at the low a
+0003f0f0: 6e64 2068 6967 6820 7761 7665 6c65 6e67  nd high waveleng
+0003f100: 7468 206c 696d 6974 2e20 2844 6566 6175  th limit. (Defau
+0003f110: 6c74 2920 4e6f 6e65 200d 0a09 0909 7573  lt) None .....us
+0003f120: 6573 2074 6865 206c 696d 6974 7320 6f66  es the limits of
+0003f130: 206d 6561 7375 7265 6d65 6e74 200d 0a09   measurement ...
+0003f140: 0973 656c 662e 7469 6d65 5f62 696e 2020  .self.time_bin  
+0003f150: 3a20 4e6f 6e65 206f 7220 696e 740d 0a09  : None or int...
+0003f160: 0909 2844 6566 6175 6c74 2920 204e 6f6e  ..(Default)  Non
+0003f170: 650d 0a09 0909 6973 2064 6976 6964 696e  e.....is dividin
+0003f180: 6720 7468 6520 706f 696e 7473 206f 6e20  g the points on 
+0003f190: 7468 6520 7469 6d65 2d61 7869 7320 696e  the time-axis in
+0003f1a0: 2065 7665 6e20 6269 6e73 2061 6e64 2061   even bins and a
+0003f1b0: 7665 7261 6765 7320 7468 6520 666f 756e  verages the foun
+0003f1c0: 6420 7661 6c75 6573 2069 6e20 6265 7477  d values in betw
+0003f1d0: 6565 6e2e 200d 0a09 0909 5468 6973 2069  een. .....This i
+0003f1e0: 7320 6120 6861 7264 2061 7070 726f 6163  s a hard approac
+0003f1f0: 6820 7468 6174 2061 6c73 6f20 6166 6665  h that also affe
+0003f200: 6374 7320 7468 6520 6669 7473 2e20 4920  cts the fits. I 
+0003f210: 646f 2072 6563 6f6d 6d65 6e64 2074 6f20  do recommend to 
+0003f220: 7573 6520 7468 6973 2063 6172 6566 756c  use this careful
+0003f230: 6c79 2c20 0d0a 0909 0969 7420 6973 206d  ly, .....it is m
+0003f240: 6f73 7420 7573 6566 756c 2066 6f72 206d  ost useful for m
+0003f250: 6f64 756c 6174 6564 2064 6174 612e 2041  odulated data. A
+0003f260: 2062 6574 7465 7220 6368 6f69 6365 2066   better choice f
+0003f270: 6f72 2074 7261 6e73 6965 6e74 2061 6273  or transient abs
+0003f280: 6f72 7074 696f 6e20 7468 6174 206f 6e6c  orption that onl
+0003f290: 7920 0d0a 0909 0961 6666 6563 7473 2074  y .....affects t
+0003f2a0: 6865 206b 696e 6574 6963 7320 6973 2027  he kinetics is '
+0003f2b0: 7469 6d65 5f77 6964 7468 5f70 6572 6365  time_width_perce
+0003f2c0: 6e74 270d 0a09 0973 656c 662e 7469 6d65  nt'....self.time
+0003f2d0: 6c69 6d69 7473 2020 3a20 4e6f 6e65 206f  limits  : None o
+0003f2e0: 7220 6c69 7374 2028 6f66 2032 2066 6c6f  r list (of 2 flo
+0003f2f0: 6174 7329 0d0a 0909 0928 4465 6661 756c  ats).....(Defaul
+0003f300: 7429 2020 4e6f 6e65 5c6e 0d0a 0909 0963  t)  None\n.....c
+0003f310: 7574 2074 696d 6573 2061 7420 7468 6520  ut times at the 
+0003f320: 6c6f 7720 616e 6420 6869 6768 2074 696d  low and high tim
+0003f330: 6520 6c69 6d69 742e 2028 4465 6661 756c  e limit. (Defaul
+0003f340: 7429 204e 6f6e 6520 7573 6573 2074 6865  t) None uses the
+0003f350: 206c 696d 6974 7320 6f66 206d 6561 7375   limits of measu
+0003f360: 7265 6d65 6e74 0d0a 0909 0949 6d70 6f72  rement.....Impor
+0003f370: 7461 6e74 3a20 4966 2065 6974 6865 7220  tant: If either 
+0003f380: 7468 6520 6261 636b 6772 6f75 6e64 206f  the background o
+0003f390: 7220 7468 6520 6368 6972 7020 6973 2074  r the chirp is t
+0003f3a0: 6f20 6265 2066 6974 2074 6869 7320 6d75  o be fit this mu
+0003f3b0: 7374 2069 6e63 6c75 6465 2074 6865 200d  st include the .
+0003f3c0: 0a09 0909 7469 6d65 2062 6566 6f72 6520  ....time before 
+0003f3d0: 7a65 726f 2120 5573 6566 756c 3a20 4974  zero! Useful: It
+0003f3e0: 2069 7320 7573 6566 756c 2074 6f20 776f   is useful to wo
+0003f3f0: 726b 206f 6e20 6469 6666 6572 656e 7420  rk on different 
+0003f400: 7265 6769 6f6e 732c 2073 7461 7274 696e  regions, startin
+0003f410: 6720 7769 7468 0d0a 0909 0974 6865 206c  g with.....the l
+0003f420: 6f6e 6765 7374 2028 7468 656e 2075 7365  ongest (then use
+0003f430: 2074 6865 2074 612e 4261 636b 676f 756e   the ta.Backgoun
+0003f440: 6420 6675 6e63 7469 6f6e 2070 7269 6f72  d function prior
+0003f450: 2074 6f20 6669 7429 2061 6e64 2065 7870   to fit) and exp
+0003f460: 616e 6420 6672 6f6d 2074 6865 7265 0d0a  and from there..
+0003f470: 0909 6461 7461 5f74 7970 6520 3a20 7374  ..data_type : st
+0003f480: 720d 0a09 0909 7468 6973 2069 7320 7468  r.....this is th
+0003f490: 6520 6461 7461 7479 7065 2061 6e64 2065  e datatype and e
+0003f4a0: 6666 6563 7469 7665 6c79 2074 6865 2075  ffectively the u
+0003f4b0: 6e69 7420 7075 7420 6f6e 2074 6865 2069  nit put on the i
+0003f4c0: 6e74 656e 7369 7479 2061 7869 7320 0d0a  ntensity axis ..
+0003f4d0: 0909 0928 4465 6661 756c 7429 2764 6966  ...(Default)'dif
+0003f4e0: 6665 7265 6e74 6961 6c20 4162 736f 7270  ferential Absorp
+0003f4f0: 7469 6f6e 2069 6e20 245c 6d61 7468 7265  tion in $\mathre
+0003f500: 6775 6c61 727b 5c44 656c 7461 204f 447d  gular{\Delta OD}
+0003f510: 240d 0a09 0973 656c 662e 7761 7665 5f6e  $....self.wave_n
+0003f520: 6d5f 6269 6e20 203a 204e 6f6e 6520 6f72  m_bin  : None or
+0003f530: 2066 6c6f 6174 200d 0a09 0909 2844 6566   float .....(Def
+0003f540: 6175 6c74 2920 204e 6f6e 655c 6e0d 0a09  ault)  None\n...
+0003f550: 0909 7265 6269 6e73 2074 6865 206f 7269  ..rebins the ori
+0003f560: 6769 6e61 6c20 6461 7461 2069 6e74 6f20  ginal data into 
+0003f570: 6576 656e 2069 6e74 6572 7661 6c73 2e20  even intervals. 
+0003f580: 4966 2073 6574 2074 6f20 4e6f 6e65 2074  If set to None t
+0003f590: 6865 206f 7269 6769 6e61 6c20 6461 7461  he original data
+0003f5a0: 2077 696c 6c20 6265 2075 7365 642e 200d   will be used. .
+0003f5b0: 0a09 0909 4966 2073 6574 2074 6f20 6120  ....If set to a 
+0003f5c0: 7769 6474 6820 2865 2e67 2e20 326e 6d29  width (e.g. 2nm)
+0003f5d0: 2c20 7468 6520 7761 7665 6c65 6e67 7468  , the wavelength
+0003f5e0: 2061 7869 7320 7769 6c6c 2062 6520 6469   axis will be di
+0003f5f0: 7669 6465 6420 696e 746f 2073 7465 7073  vided into steps
+0003f600: 206f 6620 7468 6973 2073 697a 650d 0a09   of this size...
+0003f610: 0909 616e 6420 7468 6520 6d65 616e 206f  ..and the mean o
+0003f620: 6620 616c 6c20 6d65 6173 7572 656d 656e  f all measuremen
+0003f630: 7473 2069 6e20 7468 6520 696e 7465 7276  ts in the interv
+0003f640: 616c 2069 7320 7461 6b65 6e2e 2054 6865  al is taken. The
+0003f650: 2072 652d 6269 6e6e 696e 6720 7374 6f70   re-binning stop
+0003f660: 7320 6173 2073 6f6f 6e20 6173 0d0a 0909  s as soon as....
+0003f670: 0974 6865 206d 6561 7375 7265 6420 7374  .the measured st
+0003f680: 6570 7369 7a65 2069 7320 7769 6465 7220  epsize is wider 
+0003f690: 7468 616e 2067 6976 656e 2068 6572 652c  than given here,
+0003f6a0: 2074 6865 6e20 7468 6520 6f72 6967 696e   then the origin
+0003f6b0: 616c 2062 696e 7320 6172 6520 7573 6564  al bins are used
+0003f6c0: 2e20 0d0a 0909 0954 6869 7320 6675 6e63  . .....This func
+0003f6d0: 7469 6f6e 2069 7320 7061 7274 6963 756c  tion is particul
+0003f6e0: 6172 6c79 2075 7365 6675 6c20 666f 7220  arly useful for 
+0003f6f0: 7370 6563 7472 6f6d 6574 6572 2077 6974  spectrometer wit
+0003f700: 6820 6e6f 6e2d 6c69 6e65 6172 2064 6973  h non-linear dis
+0003f710: 7065 7273 696f 6e2c 200d 0a09 0909 6c69  persion, .....li
+0003f720: 6b65 2061 2070 7269 736d 2069 6e20 7468  ke a prism in th
+0003f730: 6520 696e 6672 6172 6564 2e0d 0a09 0973  e infrared.....s
+0003f740: 656c 662e 7761 7665 6c65 6e67 7468 5f62  elf.wavelength_b
+0003f750: 696e 2020 3a20 2066 6c6f 6174 2c20 6f70  in  :  float, op
+0003f760: 7469 6f6e 616c 0d0a 0909 0928 4465 6661  tional.....(Defa
+0003f770: 756c 7429 2020 3130 6e6d 2074 6865 2077  ult)  10nm the w
+0003f780: 6964 7468 2075 7365 6420 696e 206b 696e  idth used in kin
+0003f790: 6574 6963 732c 2073 6565 2062 656c 6f77  etics, see below
+0003f7a0: 0d0a 0909 7365 6c66 2e69 6e74 656e 7369  ....self.intensi
+0003f7b0: 7479 5f72 616e 6765 2020 3a20 4e6f 6e65  ty_range  : None
+0003f7c0: 2c20 666c 6f61 7420 6f72 206c 6973 7420  , float or list 
+0003f7d0: 5b6f 6620 7477 6f20 666c 6f61 7473 5d0d  [of two floats].
+0003f7e0: 0a09 0909 2844 6566 6175 6c74 2920 204e  ....(Default)  N
+0003f7f0: 6f6e 6520 2d20 696e 7465 6e73 6974 795f  one - intensity_
+0003f800: 7261 6e67 6520 6973 2061 2067 656e 6572  range is a gener
+0003f810: 616c 2073 7769 7463 6820 7468 6174 2067  al switch that g
+0003f820: 6f76 6572 6e73 2077 6861 7420 696e 7465  overns what inte
+0003f830: 6e73 6974 7920 7261 6e67 6520 7468 6520  nsity range the 
+0003f840: 706c 6f74 7320 7368 6f77 2e20 0d0a 0909  plots show. ....
+0003f850: 0946 6f72 2074 6865 2031 6420 706c 6f74  .For the 1d plot
+0003f860: 7320 7468 6973 2069 7320 7468 6520 792d  s this is the y-
+0003f870: 6178 6973 2066 6f72 2074 6865 2032 642d  axis for the 2d-
+0003f880: 706c 6f74 7320 7468 6973 2069 7320 7468  plots this is th
+0003f890: 6520 636f 6c6f 7572 2073 6361 6c65 2e20  e colour scale. 
+0003f8a0: 0d0a 0909 0954 6869 7320 7061 7261 6d65  .....This parame
+0003f8b0: 7465 7220 7265 636f 676e 697a 6573 2074  ter recognizes t
+0003f8c0: 6872 6565 2073 6574 7469 6e67 732e 2049  hree settings. I
+0003f8d0: 6620 7365 7420 746f 2022 4e6f 6e65 2220  f set to "None" 
+0003f8e0: 2844 6566 6175 6c74 2920 7468 6973 2075  (Default) this u
+0003f8f0: 7365 7320 7468 6520 6d69 6e69 6d75 6d20  ses the minimum 
+0003f900: 616e 640d 0a09 0909 6d61 7869 6d75 6d20  and.....maximum 
+0003f910: 6f66 2074 6865 2064 6174 612e 2041 2073  of the data. A s
+0003f920: 696e 676c 6520 7661 6c75 6520 6c69 6b65  ingle value like
+0003f930: 2069 6e20 7468 6520 6578 616d 706c 6520   in the example 
+0003f940: 6265 6c6f 7720 616e 6420 7468 6520 696e  below and the in
+0003f950: 7465 6e64 6564 2075 7365 2069 7320 7468  tended use is th
+0003f960: 6520 7379 6d6d 6574 7269 630d 0a09 0909  e symmetric.....
+0003f970: 7363 616c 6520 7768 696c 6520 6120 6c69  scale while a li
+0003f980: 7374 2077 6974 6820 7477 6f20 656e 7472  st with two entr
+0003f990: 6965 7320 616e 2061 7373 796d 6d65 7472  ies an assymmetr
+0003f9a0: 6963 2073 6361 6c65 2065 2e67 2e20 0d0a  ic scale e.g. ..
+0003f9b0: 0909 0969 6e74 656e 7369 7479 5f72 616e  ...intensity_ran
+0003f9c0: 6765 3d33 652d 3320 6973 2063 6f6e 7665  ge=3e-3 is conve
+0003f9d0: 7274 6564 2069 6e74 6f20 696e 7465 6e73  rted into intens
+0003f9e0: 6974 795f 7261 6e67 653d 5b2d 3365 2d33  ity_range=[-3e-3
+0003f9f0: 2c33 652d 335d 0d0a 0909 7365 6c66 2e64  ,3e-3]....self.d
+0003fa00: 735f 6f72 692e 636f 6c75 6d6e 732e 6e61  s_ori.columns.na
+0003fa10: 6d65 203a 2073 7472 2c20 6f70 7469 6f6e  me : str, option
+0003fa20: 616c 200d 0a09 0909 2844 6566 6175 6c74  al .....(Default
+0003fa30: 2920 2027 5761 7665 6c65 6e67 7468 2069  )  'Wavelength i
+0003fa40: 6e20 6e6d 275c 6e0d 0a09 0909 5468 6973  n nm'\n.....This
+0003fa50: 2069 7320 7468 6520 6765 6e65 7261 6c20   is the general 
+0003fa60: 656e 6572 6779 2061 7869 732e 2068 6572  energy axis. her
+0003fa70: 6520 7765 2064 6566 696e 6520 6974 2077  e we define it w
+0003fa80: 6974 6820 7468 6520 756e 6974 2e20 4368  ith the unit. Ch
+0003fa90: 616e 6765 2074 6869 7320 746f 2065 6e65  ange this to ene
+0003faa0: 7267 7920 666f 7220 7573 6520 696e 2065  rgy for use in e
+0003fab0: 2e67 2078 2d72 6179 2073 6369 656e 6365  .g x-ray science
+0003fac0: 0d0a 0909 7365 6c66 2e64 735f 6f72 692e  ....self.ds_ori.
+0003fad0: 696e 6465 782e 6e61 6d65 203a 2073 7472  index.name : str
+0003fae0: 2c20 6f70 7469 6f6e 616c 0d0a 0909 0953  , optional.....S
+0003faf0: 7461 6e64 6172 6420 2754 696d 6520 696e  tandard 'Time in
+0003fb00: 2025 7327 2025 2073 656c 662e 6261 7365   %s' % self.base
+0003fb10: 756e 6974 200d 0a09 0973 656c 662e 6461  unit ....self.da
+0003fb20: 7461 5f74 7970 653a 2073 7472 2028 6f70  ta_type: str (op
+0003fb30: 7469 6f6e 616c 290d 0a09 0909 7365 6c66  tional).....self
+0003fb40: 2e64 6174 615f 7479 7065 3d27 6469 6666  .data_type='diff
+0003fb50: 2e20 4162 736f 7270 7469 6f6e 2069 6e20  . Absorption in 
+0003fb60: 245c 6d61 7468 7265 6775 6c61 727b 5c44  $\mathregular{\D
+0003fb70: 656c 7461 204f 447d 2427 0d0a 0909 7365  elta OD}$'....se
+0003fb80: 6c66 2e66 6974 636f 6566 6620 3a20 6c69  lf.fitcoeff : li
+0003fb90: 7374 2028 3520 666c 6f61 7473 290d 0a09  st (5 floats)...
+0003fba0: 0909 6368 6972 7020 636f 7272 6563 7469  ..chirp correcti
+0003fbb0: 6f6e 2070 6f6c 796e 6f6d 0d0a 0909 7365  on polynom....se
+0003fbc0: 6c66 2e63 6869 7270 5f66 696c 6520 3a20  lf.chirp_file : 
+0003fbd0: 7374 720d 0a09 0909 6966 2074 6865 7265  str.....if there
+0003fbe0: 2069 7320 6120 6669 6c65 2077 6974 6874   is a file witht
+0003fbf0: 6865 2072 6967 6874 206e 616d 6520 7772  he right name wr
+0003fc00: 6974 6520 6974 2068 6572 652c 206f 7468  ite it here, oth
+0003fc10: 6572 7769 7365 204e 6f6e 650d 0a09 0973  erwise None....s
+0003fc20: 656c 662e 6669 6775 7265 5f70 6174 6820  elf.figure_path 
+0003fc30: 3a20 7374 720d 0a09 0909 5061 7468 2066  : str.....Path f
+0003fc40: 6f72 2073 6176 696e 6720 6669 6775 7265  or saving figure
+0003fc50: 732c 2069 6620 7365 740d 0a09 0973 656c  s, if set....sel
+0003fc60: 662e 7361 7665 5f66 6967 7572 6573 5f74  f.save_figures_t
+0003fc70: 6f5f 666f 6c64 6572 203a 2062 6f6f 6c0d  o_folder : bool.
+0003fc80: 0a09 0909 6966 2054 7275 6520 616c 6c20  ....if True all 
+0003fc90: 6669 6775 7265 7320 6172 6520 6175 746f  figures are auto
+0003fca0: 6d61 7469 6361 6c6c 7920 7361 7665 6420  matically saved 
+0003fcb0: 7768 656e 2061 6e79 2070 6c6f 7466 756e  when any plotfun
+0003fcc0: 6374 696f 6e20 6973 2063 616c 6c65 640d  ction is called.
+0003fcd0: 0a0d 0a09 0945 7861 6d70 6c65 730d 0a09  .....Examples...
+0003fce0: 092d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 0d0a  .-----------....
+0003fcf0: 0909 3e3e 3e20 7461 2e62 6f72 6465 7263  ..>>> ta.borderc
+0003fd00: 7574 3d5b 3335 302c 3132 3030 5d20 2023  ut=[350,1200]  #
+0003fd10: 7265 6d6f 7665 2061 6c6c 2064 6174 6120  remove all data 
+0003fd20: 6f75 7473 6964 6520 7468 6973 206c 696d  outside this lim
+0003fd30: 6974 0d0a 0909 3e3e 3e20 7461 2e73 6361  it....>>> ta.sca
+0003fd40: 7474 6572 6375 743d 5b35 3232 2c36 3035  ttercut=[522,605
+0003fd50: 5d20 2023 7365 7420 6461 7461 2069 6e73  ]  #set data ins
+0003fd60: 6964 6520 7468 6973 206c 696d 6974 2074  ide this limit t
+0003fd70: 6f20 7a65 726f 0d0a 0909 3e3e 3e20 7461  o zero....>>> ta
+0003fd80: 2e74 696d 656c 696d 6974 733d 5b30 2e32  .timelimits=[0.2
+0003fd90: 2c35 3030 305d 2020 2372 656d 6f76 6520  ,5000]  #remove 
+0003fda0: 616c 6c20 6461 7461 206f 7574 7369 6465  all data outside
+0003fdb0: 2074 6869 7320 6c69 6d69 740d 0a09 093e   this limit....>
+0003fdc0: 3e3e 2074 612e 7761 7665 5f6e 6d5f 6269  >> ta.wave_nm_bi
+0003fdd0: 6e3d 3520 2023 7265 6269 6e20 7468 6520  n=5  #rebin the 
+0003fde0: 6461 7461 2074 6f20 7468 6973 2077 6964  data to this wid
+0003fdf0: 7468 0d0a 0909 3e3e 3e20 7461 2e69 6e74  th....>>> ta.int
+0003fe00: 656e 7369 7479 5f72 616e 6765 3d33 652d  ensity_range=3e-
+0003fe10: 3320 2023 6571 7569 7661 6c65 6e74 2074  3  #equivalent t
+0003fe20: 6f20 5b2d 3365 2d33 2c33 652d 335d 0d0a  o [-3e-3,3e-3]..
+0003fe30: 0909 3e3e 3e20 7461 2e69 6e74 656e 7369  ..>>> ta.intensi
+0003fe40: 7479 5f72 616e 6765 3d5b 2d31 652d 332c  ty_range=[-1e-3,
+0003fe50: 3365 2d33 5d20 2023 696e 7465 6e73 6974  3e-3]  #intensit
+0003fe60: 7920 7468 6174 2069 7320 706c 6f74 7465  y that is plotte
+0003fe70: 6420 696e 2032 6420 706c 6f74 2061 6e64  d in 2d plot and
+0003fe80: 2079 2d61 7869 7320 696e 2031 6420 706c   y-axis in 1d pl
+0003fe90: 6f74 730d 0a09 093e 3e3e 2074 612e 636d  ots....>>> ta.cm
+0003fea0: 6170 3d6d 6174 706c 6f74 6c69 622e 636d  ap=matplotlib.cm
+0003feb0: 2e70 7269 736d 2020 2363 686f 6f73 6520  .prism  #choose 
+0003fec0: 6469 6666 6572 656e 7420 636f 6c6f 7572  different colour
+0003fed0: 206d 6170 0d0a 0909 3e3e 3e20 7461 2e69   map....>>> ta.i
+0003fee0: 676e 6f72 655f 7469 6d65 5f72 6567 696f  gnore_time_regio
+0003fef0: 6e3d 5b2d 302e 312c 302e 315d 2023 6967  n=[-0.1,0.1] #ig
+0003ff00: 6e6f 7265 202d 302e 3170 7320 746f 2030  nore -0.1ps to 0
+0003ff10: 2e31 7073 0d0a 0d0a 0d0a 0909 2727 270d  .1ps........'''.
+0003ff20: 0a09 0973 656c 662e 6c6f 675f 7363 616c  ...self.log_scal
+0003ff30: 6520 3d20 4661 6c73 6520 6966 206e 6f74  e = False if not
+0003ff40: 2068 6173 6174 7472 2873 656c 662c 2027   hasattr(self, '
+0003ff50: 6c6f 675f 7363 616c 6527 2920 656c 7365  log_scale') else
+0003ff60: 2073 656c 662e 6c6f 675f 7363 616c 650d   self.log_scale.
+0003ff70: 0a09 0973 656c 662e 636d 6170 203d 2073  ...self.cmap = s
+0003ff80: 7461 6e64 6172 645f 6d61 7020 6966 206e  tandard_map if n
+0003ff90: 6f74 2068 6173 6174 7472 2873 656c 662c  ot hasattr(self,
+0003ffa0: 2027 636d 6170 2729 2065 6c73 6520 7365   'cmap') else se
+0003ffb0: 6c66 2e63 6d61 700d 0a09 0973 656c 662e  lf.cmap....self.
+0003ffc0: 6c69 6e74 7265 7368 203d 2030 2e33 2069  lintresh = 0.3 i
+0003ffd0: 6620 6e6f 7420 6861 7361 7474 7228 7365  f not hasattr(se
+0003ffe0: 6c66 2c20 276c 696e 7472 6573 6827 2920  lf, 'lintresh') 
+0003fff0: 656c 7365 2073 656c 662e 6c69 6e74 7265  else self.lintre
+00040000: 7368 0d0a 0909 7365 6c66 2e6c 6f67 5f66  sh....self.log_f
+00040010: 6974 203d 2046 616c 7365 2069 6620 6e6f  it = False if no
+00040020: 7420 6861 7361 7474 7228 7365 6c66 2c20  t hasattr(self, 
+00040030: 276c 6f67 5f66 6974 2729 2065 6c73 6520  'log_fit') else 
+00040040: 7365 6c66 2e6c 6f67 5f66 6974 0d0a 0909  self.log_fit....
+00040050: 7365 6c66 2e69 676e 6f72 655f 7469 6d65  self.ignore_time
+00040060: 5f72 6567 696f 6e20 3d20 4e6f 6e65 2069  _region = None i
+00040070: 6620 6e6f 7420 6861 7361 7474 7228 7365  f not hasattr(se
+00040080: 6c66 2c20 2769 676e 6f72 655f 7469 6d65  lf, 'ignore_time
+00040090: 5f72 6567 696f 6e27 2920 656c 7365 2073  _region') else s
+000400a0: 656c 662e 6967 6e6f 7265 5f74 696d 655f  elf.ignore_time_
+000400b0: 7265 6769 6f6e 0d0a 0909 7365 6c66 2e65  region....self.e
+000400c0: 7272 6f72 5f6d 6174 7269 785f 616d 706c  rror_matrix_ampl
+000400d0: 6966 6963 6174 696f 6e20 3d20 3130 2069  ification = 10 i
+000400e0: 6620 6e6f 7420 6861 7361 7474 7228 7365  f not hasattr(se
+000400f0: 6c66 2c20 2765 7272 6f72 5f6d 6174 7269  lf, 'error_matri
+00040100: 785f 616d 706c 6966 6963 6174 696f 2729  x_amplificatio')
+00040110: 2065 6c73 6520 7365 6c66 2e65 7272 6f72   else self.error
+00040120: 5f6d 6174 7269 785f 616d 706c 6966 6963  _matrix_amplific
+00040130: 6174 696f 6e0d 0a09 0974 7279 3a0d 0a09  ation....try:...
+00040140: 0909 7365 6c66 2e72 656c 5f77 6176 6520  ..self.rel_wave 
+00040150: 3d20 7365 6c66 2e72 656c 5f77 6176 650d  = self.rel_wave.
+00040160: 0a09 0965 7863 6570 743a 0d0a 0909 0973  ...except:.....s
+00040170: 656c 662e 7265 6c5f 7761 7665 203d 206e  elf.rel_wave = n
+00040180: 702e 6172 616e 6765 2833 3030 2c31 3030  p.arange(300,100
+00040190: 302c 3130 3029 2069 6620 6e6f 7420 6861  0,100) if not ha
+000401a0: 7361 7474 7228 7365 6c66 2c20 2772 656c  sattr(self, 'rel
+000401b0: 5f77 6176 6527 2920 656c 7365 2073 656c  _wave') else sel
+000401c0: 662e 7265 6c5f 7761 7665 0d0a 0909 7365  f.rel_wave....se
+000401d0: 6c66 2e72 656c 5f74 696d 6520 3d20 5b30  lf.rel_time = [0
+000401e0: 2e32 2c30 2e33 2c30 2e35 2c31 2c33 2c31  .2,0.3,0.5,1,3,1
+000401f0: 302c 3330 2c31 3030 2c33 3030 2c31 3030  0,30,100,300,100
+00040200: 302c 3330 3030 2c39 3030 305d 2069 6620  0,3000,9000] if 
+00040210: 6e6f 7420 6861 7361 7474 7228 7365 6c66  not hasattr(self
+00040220: 2c20 2772 656c 5f74 696d 6527 2920 656c  , 'rel_time') el
+00040230: 7365 2073 656c 662e 7265 6c5f 7469 6d65  se self.rel_time
+00040240: 0d0a 0909 7365 6c66 2e74 696d 655f 7769  ....self.time_wi
+00040250: 6474 685f 7065 7263 656e 7420 3d20 3020  dth_percent = 0 
+00040260: 6966 206e 6f74 2068 6173 6174 7472 2873  if not hasattr(s
+00040270: 656c 662c 2027 7469 6d65 5f77 6964 7468  elf, 'time_width
+00040280: 5f70 6572 6365 6e74 2729 2065 6c73 6520  _percent') else 
+00040290: 7365 6c66 2e74 696d 655f 7769 6474 685f  self.time_width_
+000402a0: 7065 7263 656e 740d 0a09 0973 656c 662e  percent....self.
+000402b0: 6261 7365 756e 6974 203d 2027 7073 2720  baseunit = 'ps' 
+000402c0: 6966 206e 6f74 2068 6173 6174 7472 2873  if not hasattr(s
+000402d0: 656c 662c 2027 6261 7365 756e 6974 2729  elf, 'baseunit')
+000402e0: 2065 6c73 6520 7365 6c66 2e62 6173 6575   else self.baseu
+000402f0: 6e69 740d 0a09 0973 656c 662e 6d6f 6420  nit....self.mod 
+00040300: 3d20 2765 7870 6f6e 656e 7469 616c 2720  = 'exponential' 
+00040310: 6966 206e 6f74 2068 6173 6174 7472 2873  if not hasattr(s
+00040320: 656c 662c 2027 6d6f 6427 2920 656c 7365  elf, 'mod') else
+00040330: 2073 656c 662e 6d6f 640d 0a09 0973 656c   self.mod....sel
+00040340: 662e 7363 6174 7465 7263 7574 203d 204e  f.scattercut = N
+00040350: 6f6e 6520 6966 206e 6f74 2068 6173 6174  one if not hasat
+00040360: 7472 2873 656c 662c 2027 7363 6174 7465  tr(self, 'scatte
+00040370: 7263 7574 2729 2065 6c73 6520 7365 6c66  rcut') else self
+00040380: 2e73 6361 7474 6572 6375 740d 0a09 0973  .scattercut....s
+00040390: 656c 662e 626f 7264 6572 6375 7420 3d20  elf.bordercut = 
+000403a0: 4e6f 6e65 2069 6620 6e6f 7420 6861 7361  None if not hasa
+000403b0: 7474 7228 7365 6c66 2c20 2762 6f72 6465  ttr(self, 'borde
+000403c0: 7263 7574 2729 2065 6c73 6520 7365 6c66  rcut') else self
+000403d0: 2e62 6f72 6465 7263 7574 0d0a 0909 7365  .bordercut....se
+000403e0: 6c66 2e74 696d 655f 6269 6e20 3d20 4e6f  lf.time_bin = No
+000403f0: 6e65 2069 6620 6e6f 7420 6861 7361 7474  ne if not hasatt
+00040400: 7228 7365 6c66 2c20 2774 696d 655f 6269  r(self, 'time_bi
+00040410: 6e27 2920 656c 7365 2073 656c 662e 7469  n') else self.ti
+00040420: 6d65 5f62 696e 0d0a 0909 7365 6c66 2e74  me_bin....self.t
+00040430: 696d 656c 696d 6974 7320 3d20 4e6f 6e65  imelimits = None
+00040440: 2069 6620 6e6f 7420 6861 7361 7474 7228   if not hasattr(
+00040450: 7365 6c66 2c20 2774 696d 656c 696d 6974  self, 'timelimit
+00040460: 7327 2920 656c 7365 2073 656c 662e 7469  s') else self.ti
+00040470: 6d65 6c69 6d69 7473 0d0a 0909 7365 6c66  melimits....self
+00040480: 2e77 6176 655f 6e6d 5f62 696e 203d 204e  .wave_nm_bin = N
+00040490: 6f6e 6520 6966 206e 6f74 2068 6173 6174  one if not hasat
+000404a0: 7472 2873 656c 662c 2027 7761 7665 5f6e  tr(self, 'wave_n
+000404b0: 6d5f 6269 6e27 2920 656c 7365 2073 656c  m_bin') else sel
+000404c0: 662e 7761 7665 5f6e 6d5f 6269 6e0d 0a09  f.wave_nm_bin...
+000404d0: 0973 656c 662e 7761 7665 6c65 6e67 7468  .self.wavelength
+000404e0: 5f62 696e 203d 2031 3020 6966 206e 6f74  _bin = 10 if not
+000404f0: 2068 6173 6174 7472 2873 656c 662c 2027   hasattr(self, '
+00040500: 7761 7665 6c65 6e67 7468 5f62 696e 2729  wavelength_bin')
+00040510: 2065 6c73 6520 7365 6c66 2e77 6176 656c   else self.wavel
+00040520: 656e 6774 685f 6269 6e0d 0a09 0973 656c  ength_bin....sel
+00040530: 662e 7361 7665 5f66 6967 7572 6573 5f74  f.save_figures_t
+00040540: 6f5f 666f 6c64 6572 203d 2046 616c 7365  o_folder = False
+00040550: 2069 6620 6e6f 7420 6861 7361 7474 7228   if not hasattr(
+00040560: 7365 6c66 2c20 2773 6176 655f 6669 6775  self, 'save_figu
+00040570: 7265 735f 746f 5f66 6f6c 6465 7227 2920  res_to_folder') 
+00040580: 656c 7365 2073 656c 662e 7361 7665 5f66  else self.save_f
+00040590: 6967 7572 6573 5f74 6f5f 666f 6c64 6572  igures_to_folder
+000405a0: 0d0a 0909 7365 6c66 2e69 6e74 656e 7369  ....self.intensi
+000405b0: 7479 5f72 616e 6765 203d 204e 6f6e 6520  ty_range = None 
+000405c0: 6966 206e 6f74 2068 6173 6174 7472 2873  if not hasattr(s
+000405d0: 656c 662c 2027 696e 7465 6e73 6974 795f  elf, 'intensity_
+000405e0: 7261 6e67 6527 2920 656c 7365 2073 656c  range') else sel
+000405f0: 662e 696e 7465 6e73 6974 795f 7261 6e67  f.intensity_rang
+00040600: 650d 0a09 0973 656c 662e 6473 5f6f 7269  e....self.ds_ori
+00040610: 2e69 6e64 6578 2e6e 616d 6520 3d20 2754  .index.name = 'T
+00040620: 696d 6520 696e 2025 7327 2025 2073 656c  ime in %s' % sel
+00040630: 662e 6261 7365 756e 6974 2069 6620 6e6f  f.baseunit if no
+00040640: 7420 6861 7361 7474 7228 7365 6c66 2c20  t hasattr(self, 
+00040650: 2764 735f 6f72 692e 696e 6465 782e 6e61  'ds_ori.index.na
+00040660: 6d65 2729 2065 6c73 6520 7365 6c66 2e64  me') else self.d
+00040670: 735f 6f72 692e 696e 6465 782e 6e61 6d65  s_ori.index.name
+00040680: 0d0a 0909 7365 6c66 2e65 7175 616c 5f65  ....self.equal_e
+00040690: 6e65 7267 795f 6269 6e20 3d20 4e6f 6e65  nergy_bin = None
+000406a0: 2069 6620 6e6f 7420 6861 7361 7474 7228   if not hasattr(
+000406b0: 7365 6c66 2c20 2765 7175 616c 5f65 6e65  self, 'equal_ene
+000406c0: 7267 795f 6269 6e27 2920 656c 7365 2073  rgy_bin') else s
+000406d0: 656c 662e 6571 7561 6c5f 656e 6572 6779  elf.equal_energy
+000406e0: 5f62 696e 0d0a 0909 7365 6c66 2e75 6e69  _bin....self.uni
+000406f0: 7473 3d27 6e6d 2720 6966 206e 6f74 2068  ts='nm' if not h
+00040700: 6173 6174 7472 2873 656c 662c 2027 756e  asattr(self, 'un
+00040710: 6974 7327 2920 656c 7365 2073 656c 662e  its') else self.
+00040720: 756e 6974 730d 0a09 0969 6620 7365 6c66  units....if self
+00040730: 2e75 6e69 7473 203d 3d20 276e 6d27 3a0d  .units == 'nm':.
+00040740: 0a09 0909 7365 6c66 2e64 735f 6f72 692e  ....self.ds_ori.
+00040750: 636f 6c75 6d6e 732e 6e61 6d65 203d 2027  columns.name = '
+00040760: 5761 7665 6c65 6e67 7468 2069 6e20 2573  Wavelength in %s
+00040770: 2725 7365 6c66 2e75 6e69 7473 2069 6620  '%self.units if 
+00040780: 6e6f 7420 6861 7361 7474 7228 7365 6c66  not hasattr(self
+00040790: 2c20 2764 735f 6f72 692e 636f 6c75 6d6e  , 'ds_ori.column
+000407a0: 732e 6e61 6d65 2729 2065 6c73 6520 7365  s.name') else se
+000407b0: 6c66 2e64 735f 6f72 692e 636f 6c75 6d6e  lf.ds_ori.column
+000407c0: 732e 6e61 6d65 0d0a 0909 656c 6966 2073  s.name....elif s
+000407d0: 656c 662e 756e 6974 7320 3d3d 2027 6556  elf.units == 'eV
+000407e0: 273a 0d0a 0909 0973 656c 662e 6473 5f6f  ':.....self.ds_o
+000407f0: 7269 2e63 6f6c 756d 6e73 2e6e 616d 6520  ri.columns.name 
+00040800: 3d20 2745 6e65 7267 7920 696e 2025 7327  = 'Energy in %s'
+00040810: 2573 656c 662e 756e 6974 7320 6966 206e  %self.units if n
+00040820: 6f74 2068 6173 6174 7472 2873 656c 662c  ot hasattr(self,
+00040830: 2027 6473 5f6f 7269 2e63 6f6c 756d 6e73   'ds_ori.columns
+00040840: 2e6e 616d 6527 2920 656c 7365 2073 656c  .name') else sel
+00040850: 662e 6473 5f6f 7269 2e63 6f6c 756d 6e73  f.ds_ori.columns
+00040860: 2e6e 616d 650d 0a09 0965 6c69 6620 7365  .name....elif se
+00040870: 6c66 2e75 6e69 7473 203d 3d20 276b 6556  lf.units == 'keV
+00040880: 273a 0d0a 0909 0973 656c 662e 6473 5f6f  ':.....self.ds_o
+00040890: 7269 2e63 6f6c 756d 6e73 2e6e 616d 6520  ri.columns.name 
+000408a0: 3d20 2745 6e65 7267 7920 696e 2025 7327  = 'Energy in %s'
+000408b0: 2573 656c 662e 756e 6974 7320 6966 206e  %self.units if n
+000408c0: 6f74 2068 6173 6174 7472 2873 656c 662c  ot hasattr(self,
+000408d0: 2027 6473 5f6f 7269 2e63 6f6c 756d 6e73   'ds_ori.columns
+000408e0: 2e6e 616d 6527 2920 656c 7365 2073 656c  .name') else sel
+000408f0: 662e 6473 5f6f 7269 2e63 6f6c 756d 6e73  f.ds_ori.columns
+00040900: 2e6e 616d 650d 0a09 0965 6c73 653a 0d0a  .name....else:..
+00040910: 0909 0973 656c 662e 6473 5f6f 7269 2e63  ...self.ds_ori.c
+00040920: 6f6c 756d 6e73 2e6e 616d 6520 3d20 2745  olumns.name = 'E
+00040930: 6e65 7267 7920 696e 2025 7327 2573 656c  nergy in %s'%sel
+00040940: 662e 756e 6974 7320 6966 206e 6f74 2068  f.units if not h
+00040950: 6173 6174 7472 2873 656c 662c 2027 6473  asattr(self, 'ds
+00040960: 5f6f 7269 2e63 6f6c 756d 6e73 2e6e 616d  _ori.columns.nam
+00040970: 6527 2920 656c 7365 2073 656c 662e 6473  e') else self.ds
+00040980: 5f6f 7269 2e63 6f6c 756d 6e73 2e6e 616d  _ori.columns.nam
+00040990: 650d 0a09 0973 656c 662e 6461 7461 5f74  e....self.data_t
+000409a0: 7970 653d 2027 6469 6666 2e20 4162 736f  ype= 'diff. Abso
+000409b0: 7270 7469 6f6e 2069 6e20 245c 6d61 7468  rption in $\math
+000409c0: 7265 6775 6c61 727b 5c44 656c 7461 204f  regular{\Delta O
+000409d0: 447d 2427 2069 6620 6e6f 7420 6861 7361  D}$' if not hasa
+000409e0: 7474 7228 7365 6c66 2c20 2764 6174 615f  ttr(self, 'data_
+000409f0: 7479 7065 2729 2065 6c73 6520 7365 6c66  type') else self
+00040a00: 2e64 6174 615f 7479 7065 0d0a 0909 0d0a  .data_type......
+00040a10: 0909 7472 793a 2373 656c 662e 6669 7463  ..try:#self.fitc
+00040a20: 6f65 6666 0d0a 0909 0973 656c 662e 6669  oeff.....self.fi
+00040a30: 7463 6f65 6666 0d0a 0909 0969 6620 6c65  tcoeff.....if le
+00040a40: 6e28 6c69 7374 2873 656c 662e 6669 7463  n(list(self.fitc
+00040a50: 6f65 6666 2929 3c35 3a72 6169 7365 0d0a  oeff))<5:raise..
+00040a60: 0909 6578 6365 7074 3a0d 0a09 0909 7365  ..except:.....se
+00040a70: 6c66 2e66 6974 636f 6566 663d 5b30 2c30  lf.fitcoeff=[0,0
+00040a80: 2c30 2c30 2c30 5d20 233a 2074 6573 7420  ,0,0,0] #: test 
+00040a90: 636f 6d6d 656e 7420 6865 7265 0d0a 0909  comment here....
+00040aa0: 7472 793a 2373 656c 662e 6368 6972 705f  try:#self.chirp_
+00040ab0: 6669 6c65 0d0a 0909 0973 656c 662e 6368  file.....self.ch
+00040ac0: 6972 705f 6669 6c65 0d0a 0909 6578 6365  irp_file....exce
+00040ad0: 7074 3a0d 0a09 0909 6966 206f 732e 7061  pt:.....if os.pa
+00040ae0: 7468 2e69 7366 696c 6528 6368 6563 6b5f  th.isfile(check_
+00040af0: 666f 6c64 6572 2870 6174 683d 7365 6c66  folder(path=self
+00040b00: 2e70 6174 682c 6669 6c65 6e61 6d65 3d73  .path,filename=s
+00040b10: 656c 662e 6669 6c65 6e61 6d65 2e73 706c  elf.filename.spl
+00040b20: 6974 2827 2e27 295b 305d 202b 2027 5f63  it('.')[0] + '_c
+00040b30: 6869 7270 2e64 6174 2729 293a 0d0a 0909  hirp.dat')):....
+00040b40: 0909 7365 6c66 2e63 6869 7270 5f66 696c  ..self.chirp_fil
+00040b50: 653d 7365 6c66 2e66 696c 656e 616d 652e  e=self.filename.
+00040b60: 7370 6c69 7428 272e 2729 5b30 5d20 2b20  split('.')[0] + 
+00040b70: 275f 6368 6972 702e 6461 7427 0d0a 0909  '_chirp.dat'....
+00040b80: 0965 6c73 653a 0d0a 0909 0909 7365 6c66  .else:......self
+00040b90: 2e63 6869 7270 5f66 696c 653d 4661 6c73  .chirp_file=Fals
+00040ba0: 650d 0a09 0974 7279 3a23 7365 6c66 2e66  e....try:#self.f
+00040bb0: 6967 7572 655f 7061 7468 0d0a 0909 0973  igure_path.....s
+00040bc0: 656c 662e 6669 6775 7265 5f70 6174 680d  elf.figure_path.
+00040bd0: 0a09 0965 7863 6570 743a 0d0a 0909 0969  ...except:.....i
+00040be0: 6620 7365 6c66 2e73 6176 655f 6669 6775  f self.save_figu
+00040bf0: 7265 735f 746f 5f66 6f6c 6465 723a 0d0a  res_to_folder:..
+00040c00: 0909 0909 7365 6c66 2e66 6967 7572 655f  ....self.figure_
+00040c10: 7061 7468 3d63 6865 636b 5f66 6f6c 6465  path=check_folde
+00040c20: 7228 7061 7468 3d22 7265 7375 6c74 5f66  r(path="result_f
+00040c30: 6967 7572 6573 222c 6375 7272 656e 745f  igures",current_
+00040c40: 7061 7468 3d70 6174 6829 0d0a 0909 0965  path=path).....e
+00040c50: 6c73 653a 0d0a 0909 0909 7365 6c66 2e66  lse:......self.f
+00040c60: 6967 7572 655f 7061 7468 3d4e 6f6e 650d  igure_path=None.
+00040c70: 0a0d 0a09 0973 656c 662e 6473 3d73 656c  .....self.ds=sel
+00040c80: 662e 6473 5f6f 7269 2e63 6f70 7928 290d  f.ds_ori.copy().
+00040c90: 0a0d 0a09 0d0a 0964 6566 2046 696c 7465  .......def Filte
+00040ca0: 725f 6461 7461 2873 656c 662c 2064 733d  r_data(self, ds=
+00040cb0: 4e6f 6e65 2c20 6375 745f 6261 645f 7469  None, cut_bad_ti
+00040cc0: 6d65 7320 3d20 4661 6c73 652c 2072 6570  mes = False, rep
+00040cd0: 6c61 6365 5f62 6164 5f76 616c 7565 7320  lace_bad_values 
+00040ce0: 3d20 302c 2076 616c 7565 203d 2032 302c  = 0, value = 20,
+00040cf0: 2075 7070 6572 7661 6c75 6520 3d20 4e6f   uppervalue = No
+00040d00: 6e65 2c20 6c6f 7765 7276 616c 7565 203d  ne, lowervalue =
+00040d10: 204e 6f6e 652c 2075 7070 6572 5f6d 6174   None, upper_mat
+00040d20: 7269 7820 3d20 4e6f 6e65 2c20 6c6f 7765  rix = None, lowe
+00040d30: 725f 6d61 7472 6978 203d 204e 6f6e 6529  r_matrix = None)
+00040d40: 3a0d 0a09 0927 2727 4669 6c74 6572 6573  :....'''Filteres
+00040d50: 2074 6865 2064 6174 6120 6279 2061 7070   the data by app
+00040d60: 6c79 696e 6720 6861 7264 2072 6570 6c61  lying hard repla
+00040d70: 6365 6d65 6e74 732e 2069 6620 626f 7468  cements. if both
+00040d80: 2072 6570 6c61 6365 5f62 6164 5f76 616c   replace_bad_val
+00040d90: 7565 7320 616e 6420 0d0a 0909 6375 745f  ues and ....cut_
+00040da0: 6261 645f 7469 6d65 7320 6172 6520 6661  bad_times are fa
+00040db0: 6c73 6520 6f72 204e 6f6e 652c 2074 6865  lse or None, the
+00040dc0: 2074 696d 6573 2061 626f 7665 2022 7661   times above "va
+00040dd0: 6c75 6522 2061 7265 2072 6570 6c61 6365  lue" are replace
+00040de0: 6420 6279 207a 6572 6f0d 0a09 090d 0a09  d by zero.......
+00040df0: 0950 6172 616d 6574 6572 730d 0a09 092d  .Parameters....-
+00040e00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a09 090d  -----------.....
+00040e10: 0a09 0964 7320 3a20 7061 6e64 6173 2044  ...ds : pandas D
+00040e20: 6174 6166 7261 6d65 2c20 6f70 7469 6f6e  ataframe, option
+00040e30: 616c 0d0a 0909 0969 6620 7468 6973 2069  al.....if this i
+00040e40: 7320 4e6f 6e65 2028 6465 6661 756c 7429  s None (default)
+00040e50: 2074 6865 6e20 7468 6520 7365 6c66 2e64   then the self.d
+00040e60: 7320 616e 6420 7365 6c66 2e64 735f 6f72  s and self.ds_or
+00040e70: 6920 7769 6c20 6265 2066 696c 7465 7265  i wil be filtere
+00040e80: 640d 0a09 090d 0a09 0976 616c 7565 203a  d........value :
+00040e90: 2066 6c6f 6174 2c20 6f70 7469 6f6e 616c   float, optional
+00040ea0: 0d0a 0909 0961 6c6c 2076 616c 7565 7320  .....all values 
+00040eb0: 6162 6f76 6520 7468 6973 2028 6162 736f  above this (abso
+00040ec0: 6c75 7465 2920 7661 6c75 6520 6172 6520  lute) value are 
+00040ed0: 636f 6e73 6964 6572 6564 2074 6f20 6265  considered to be
+00040ee0: 2063 6f72 7275 7074 6564 2e20 2844 6566   corrupted. (Def
+00040ef0: 6175 6c74 2032 3029 2061 7320 636c 6173  ault 20) as clas
+00040f00: 7369 6361 6c6c 7920 7468 6520 7365 7475  sically the setu
+00040f10: 7020 0d0a 0909 0972 6570 6f72 7473 206f  p .....reports o
+00040f20: 7074 6963 616c 2044 456e 7369 7479 2c20  ptical DEnsity, 
+00040f30: 616e 204f 4420 6f66 2032 3020 776f 756c  an OD of 20 woul
+00040f40: 6420 6265 2066 6172 2061 626f 7665 2074  d be far above t
+00040f50: 6865 2074 7970 6963 616c 6c79 2065 7870  he typically exp
+00040f60: 6563 7465 640d 0a09 0909 4f44 2031 652d  ected.....OD 1e-
+00040f70: 332e 2050 6173 6368 6572 2069 6e73 7472  3. Pascher instr
+00040f80: 756d 656e 7420 736f 6674 7761 7265 2075  ument software u
+00040f90: 7365 7320 6120 7661 6c75 6520 6f66 2032  ses a value of 2
+00040fa0: 3120 746f 2069 6e64 6963 6174 6520 616e  1 to indicate an
+00040fb0: 2065 7272 6f72 2e0d 0a09 090d 0a09 0975   error.........u
+00040fc0: 7070 6572 7661 6c75 6520 3a20 666c 6f61  ppervalue : floa
+00040fd0: 742c 206f 7074 696f 6e61 6c0d 0a09 0909  t, optional.....
+00040fe0: 616c 6c20 7661 6c75 6573 2061 626f 7665  all values above
+00040ff0: 2074 6869 7320 6e75 6d62 6572 2061 7265   this number are
+00041000: 2063 6f6e 7369 6465 7265 6420 746f 2062   considered to b
+00041010: 6520 636f 7272 7570 7465 642e 2028 4465  e corrupted. (De
+00041020: 6661 756c 7420 3230 2920 6173 2063 6c61  fault 20) as cla
+00041030: 7373 6963 616c 6c79 2074 6865 2073 6574  ssically the set
+00041040: 7570 200d 0a09 0909 7265 706f 7274 7320  up .....reports 
+00041050: 6f70 7469 6361 6c20 4445 6e73 6974 792c  optical DEnsity,
+00041060: 2061 6e20 4f44 206f 6620 3230 2077 6f75   an OD of 20 wou
+00041070: 6c64 2062 6520 6661 7220 6162 6f76 6520  ld be far above 
+00041080: 7468 6520 7479 7069 6361 6c6c 7920 6578  the typically ex
+00041090: 7065 6374 6564 0d0a 0909 094f 4420 3165  pected.....OD 1e
+000410a0: 2d33 2e20 5061 7363 6865 7220 696e 7374  -3. Pascher inst
+000410b0: 7275 6d65 6e74 2073 6f66 7477 6172 6520  rument software 
+000410c0: 7573 6573 2061 2076 616c 7565 206f 6620  uses a value of 
+000410d0: 3231 2074 6f20 696e 6469 6361 7465 2061  21 to indicate a
+000410e0: 6e20 6572 726f 722e 0d0a 0909 0d0a 0909  n error.........
+000410f0: 6c6f 7765 7276 616c 7565 203a 2066 6c6f  lowervalue : flo
+00041100: 6174 2c20 6f70 7469 6f6e 616c 0d0a 0909  at, optional....
+00041110: 0961 6c6c 2076 616c 7565 7320 6265 6c6f  .all values belo
+00041120: 7720 7468 6973 206e 756d 6265 7220 6172  w this number ar
+00041130: 6520 636f 6e73 6964 6572 6564 2074 6f20  e considered to 
+00041140: 6265 2063 6f72 7275 7074 6564 2e20 2844  be corrupted. (D
+00041150: 6566 6175 6c74 202d 3230 2920 6173 2063  efault -20) as c
+00041160: 6c61 7373 6963 616c 6c79 2074 6865 2073  lassically the s
+00041170: 6574 7570 200d 0a09 0909 7265 706f 7274  etup .....report
+00041180: 7320 6f70 7469 6361 6c20 4445 6e73 6974  s optical DEnsit
+00041190: 792c 2061 6e20 4f44 206f 6620 2d32 3020  y, an OD of -20 
+000411a0: 776f 756c 6420 6265 2066 6172 2061 626f  would be far abo
+000411b0: 7665 2074 6865 2074 7970 6963 616c 6c79  ve the typically
+000411c0: 2065 7870 6563 7465 640d 0a09 0909 4f44   expected.....OD
+000411d0: 2031 652d 332e 2050 6173 6368 6572 2069   1e-3. Pascher i
+000411e0: 6e73 7472 756d 656e 7420 736f 6674 7761  nstrument softwa
+000411f0: 7265 2075 7365 7320 6120 7661 6c75 6520  re uses a value 
+00041200: 6f66 2032 3120 746f 2069 6e64 6963 6174  of 21 to indicat
+00041210: 6520 616e 2065 7272 6f72 2e0d 0a09 090d  e an error......
+00041220: 0a09 0972 6570 6c61 6365 5f62 6164 5f76  ...replace_bad_v
+00041230: 616c 7565 7320 3a20 4e6f 6e65 206f 6620  alues : None of 
+00041240: 666c 6f61 742c 206f 7074 696f 6e61 6c0d  float, optional.
+00041250: 0a09 0909 7661 6c75 6573 2061 626f 7665  ....values above
+00041260: 2074 6865 2074 7265 7368 6f6c 6420 6172   the treshold ar
+00041270: 6520 7265 706c 6163 6564 2077 6974 6820  e replaced with 
+00041280: 7468 6973 2076 616c 7565 2e20 4967 6e6f  this value. Igno
+00041290: 7265 6420 6f66 204e 6f6e 6520 2844 6566  red of None (Def
+000412a0: 6175 6c74 290d 0a09 0909 0d0a 0909 6375  ault).........cu
+000412b0: 745f 6261 645f 7469 6d65 7320 3d20 626f  t_bad_times = bo
+000412c0: 6f6c 2c20 6f70 7469 6f6e 616c 0d0a 0909  ol, optional....
+000412d0: 0954 7275 6520 2844 6566 6175 6c74 3d46  .True (Default=F
+000412e0: 616c 7365 2920 7265 6d6f 7665 7320 7468  alse) removes th
+000412f0: 6520 7768 6f6c 6520 7469 6d65 2077 6865  e whole time whe
+00041300: 7265 2074 6869 7320 6973 2074 7275 650d  re this is true.
+00041310: 0a09 090d 0a09 0975 7070 6572 5f6d 6174  .......upper_mat
+00041320: 7269 7820 3a20 5061 6e64 6173 2044 6174  rix : Pandas Dat
+00041330: 6146 7261 6d65 2c20 6f70 7469 6f6e 616c  aFrame, optional
+00041340: 0d0a 0909 0961 6c6c 2076 616c 7565 7320  .....all values 
+00041350: 6162 6f76 6520 7468 6973 2074 7265 7368  above this tresh
+00041360: 6f6c 6420 7769 6c6c 2062 6520 7075 7420  old will be put 
+00041370: 4e2f 4120 6f72 2072 6570 6c61 6365 2062  N/A or replace b
+00041380: 7920 7468 6520 7661 6c75 6520 696e 2072  y the value in r
+00041390: 6570 6c61 6365 5f62 6164 5f76 616c 7565  eplace_bad_value
+000413a0: 730d 0a09 090d 0a09 096c 6f77 6572 5f6d  s........lower_m
+000413b0: 6174 7269 7820 5061 6e64 6173 2044 6174  atrix Pandas Dat
+000413c0: 6146 7261 6d65 2c20 6f70 7469 6f6e 616c  aFrame, optional
+000413d0: 0d0a 0909 0961 6c6c 2076 616c 7565 7320  .....all values 
+000413e0: 6265 6c6f 7720 7468 6973 2074 7265 7368  below this tresh
+000413f0: 6f6c 6420 7769 6c6c 2062 6520 7075 7420  old will be put 
+00041400: 4e2f 4120 6f72 2072 6570 6c61 6365 2062  N/A or replace b
+00041410: 7920 7468 6520 7661 6c75 6520 696e 2072  y the value in r
+00041420: 6570 6c61 6365 5f62 6164 5f76 616c 7565  eplace_bad_value
+00041430: 730d 0a09 090d 0a09 0974 6865 2076 616c  s........the val
+00041440: 7565 2069 7320 7468 6520 7570 7065 7220  ue is the upper 
+00041450: 626f 756e 642e 2065 7665 7279 7468 696e  bound. everythin
+00041460: 6720 0d0a 0909 6162 6f76 6520 7769 6c6c  g ....above will
+00041470: 2062 6520 6669 6c74 6572 6564 2e20 5374   be filtered. St
+00041480: 616e 6461 7264 2069 7320 746f 2064 726f  andard is to dro
+00041490: 7020 7468 6520 726f 7773 283d 7469 6d65  p the rows(=time
+000414a0: 7329 2077 6865 7265 2073 6f6d 6574 6869  s) where somethi
+000414b0: 6e67 2077 656e 7420 7772 6f6e 670d 0a09  ng went wrong...
+000414c0: 090d 0a09 0945 7861 6d70 6c65 730d 0a09  .....Examples...
+000414d0: 092d 2d2d 2d2d 2d2d 2d2d 0d0a 0909 0d0a  .---------......
+000414e0: 0909 7479 7069 6361 6c20 7573 6167 650d  ..typical usage.
+000414f0: 0a09 090d 0a09 093e 3e3e 2069 6d70 6f72  .......>>> impor
+00041500: 7420 706c 6f74 6675 6e63 2061 7320 7066  t plotfunc as pf
+00041510: 0d0a 0909 3e3e 3e20 7461 3d70 662e 5441  ....>>> ta=pf.TA
+00041520: 2827 7465 7374 6669 6c65 2e53 4941 2729  ('testfile.SIA')
+00041530: 0d0a 0909 3e3e 3e20 7461 2e46 696c 7465  ....>>> ta.Filte
+00041540: 725f 6461 7461 2829 0d0a 0909 3e3e 3e20  r_data()....>>> 
+00041550: 7461 2e46 696c 7465 725f 6461 7461 2876  ta.Filter_data(v
+00041560: 616c 7565 3d31 2920 2374 6f20 6669 6c74  alue=1) #to filt
+00041570: 6572 2074 696d 6573 2077 6974 6820 6174  er times with at
+00041580: 206c 6561 7374 206f 6e65 2070 6f69 6e74   least one point
+00041590: 2077 6974 6820 4f44 2031 0d0a 0909 0d0a   with OD 1......
+000415a0: 0909 2727 270d 0a09 0969 6620 7570 7065  ..'''....if uppe
+000415b0: 7276 616c 7565 2069 7320 4e6f 6e65 3a20  rvalue is None: 
+000415c0: 7570 7065 7276 616c 7565 203d 206e 702e  uppervalue = np.
+000415d0: 6162 7328 7661 6c75 6529 0d0a 0909 6966  abs(value)....if
+000415e0: 206c 6f77 6572 7661 6c75 6520 6973 204e   lowervalue is N
+000415f0: 6f6e 653a 206c 6f77 6572 7661 6c75 6520  one: lowervalue 
+00041600: 3d20 2d6e 702e 6162 7328 7661 6c75 6529  = -np.abs(value)
+00041610: 0d0a 0909 0d0a 0909 6966 2072 6570 6c61  ........if repla
+00041620: 6365 5f62 6164 5f76 616c 7565 7320 6973  ce_bad_values is
+00041630: 206e 6f74 204e 6f6e 653a 0d0a 0909 0963   not None:.....c
+00041640: 7574 5f62 6164 5f74 696d 6573 3d46 616c  ut_bad_times=Fal
+00041650: 7365 0d0a 0909 0d0a 0909 6966 2064 7320  se........if ds 
+00041660: 6973 204e 6f6e 653a 0d0a 0909 0966 696c  is None:.....fil
+00041670: 7465 7269 6e67 3d5b 7365 6c66 2e64 732c  tering=[self.ds,
+00041680: 7365 6c66 2e64 735f 6f72 695d 0d0a 0909  self.ds_ori]....
+00041690: 656c 7365 3a0d 0a09 0909 6669 6c74 6572  else:.....filter
+000416a0: 696e 673d 5b64 735d 0d0a 0909 0d0a 0909  ing=[ds]........
+000416b0: 666f 7220 6461 7461 7365 7420 696e 2066  for dataset in f
+000416c0: 696c 7465 7269 6e67 3a0d 0a09 0909 6966  iltering:.....if
+000416d0: 2061 6e79 285b 7365 6c66 2e69 676e 6f72   any([self.ignor
+000416e0: 655f 7469 6d65 5f72 6567 696f 6e20 6973  e_time_region is
+000416f0: 206e 6f74 204e 6f6e 652c 2073 656c 662e   not None, self.
+00041700: 7363 6174 7465 7263 7574 2069 7320 6e6f  scattercut is no
+00041710: 7420 4e6f 6e65 2c20 7365 6c66 2e62 6f72  t None, self.bor
+00041720: 6465 7263 7574 2069 7320 6e6f 7420 4e6f  dercut is not No
+00041730: 6e65 2c20 7365 6c66 2e74 696d 656c 696d  ne, self.timelim
+00041740: 6974 7320 6973 206e 6f74 204e 6f6e 655d  its is not None]
+00041750: 293a 0d0a 0909 0909 6461 7461 7365 743d  ):......dataset=
+00041760: 7375 625f 6473 2864 6174 6173 6574 2c20  sub_ds(dataset, 
+00041770: 6967 6e6f 7265 5f74 696d 655f 7265 6769  ignore_time_regi
+00041780: 6f6e 203d 2073 656c 662e 6967 6e6f 7265  on = self.ignore
+00041790: 5f74 696d 655f 7265 6769 6f6e 2c20 7363  _time_region, sc
+000417a0: 6174 7465 7263 7574 203d 2073 656c 662e  attercut = self.
+000417b0: 7363 6174 7465 7263 7574 2c20 626f 7264  scattercut, bord
+000417c0: 6572 6375 7420 3d20 7365 6c66 2e62 6f72  ercut = self.bor
+000417d0: 6465 7263 7574 2c20 7469 6d65 6c69 6d69  dercut, timelimi
+000417e0: 7473 203d 2073 656c 662e 7469 6d65 6c69  ts = self.timeli
+000417f0: 6d69 7473 290d 0a09 0909 6966 2063 7574  mits).....if cut
+00041800: 5f62 6164 5f74 696d 6573 3a20 2374 696d  _bad_times: #tim
+00041810: 6570 6f69 6e74 2066 696c 7465 722c 2064  epoint filter, d
+00041820: 656c 6574 6520 7468 6520 7469 6d65 706f  elete the timepo
+00041830: 696e 7473 2077 6865 7265 2076 616c 7565  ints where value
+00041840: 2069 7320 7374 7570 6964 0d0a 0909 0909   is stupid......
+00041850: 6d61 7472 6978 5f73 697a 653d 6c65 6e28  matrix_size=len(
+00041860: 6461 7461 7365 742e 696e 6465 782e 7661  dataset.index.va
+00041870: 6c75 6573 290d 0a09 0909 0969 6620 7570  lues)......if up
+00041880: 7065 725f 6d61 7472 6978 2069 7320 4e6f  per_matrix is No
+00041890: 6e65 3a0d 0a09 0909 0909 6461 6d61 6765  ne:.......damage
+000418a0: 645f 7469 6d65 733d 6461 7461 7365 745b  d_times=dataset[
+000418b0: 6e70 2e61 6e79 2864 6174 6173 6574 2e76  np.any(dataset.v
+000418c0: 616c 7565 733e 7570 7065 7276 616c 7565  alues>uppervalue
+000418d0: 2c61 7869 733d 3129 5d2e 696e 6465 780d  ,axis=1)].index.
+000418e0: 0a09 0909 0965 6c73 653a 0d0a 0909 0909  .....else:......
+000418f0: 0964 616d 6167 6564 5f74 696d 6573 3d64  .damaged_times=d
+00041900: 6174 6173 6574 5b6e 702e 616e 7928 6461  ataset[np.any(da
+00041910: 7461 7365 742e 7661 6c75 6573 3e75 7070  taset.values>upp
+00041920: 6572 5f6d 6174 7269 782c 6178 6973 3d31  er_matrix,axis=1
+00041930: 295d 2e69 6e64 6578 0d0a 0909 0909 6461  )].index......da
+00041940: 7461 7365 742e 6472 6f70 2864 616d 6167  taset.drop(damag
+00041950: 6564 5f74 696d 6573 2c69 6e70 6c61 6365  ed_times,inplace
+00041960: 203d 2054 7275 6529 0d0a 0909 0909 6966   = True)......if
+00041970: 206c 6f77 6572 5f6d 6174 7269 7820 6973   lower_matrix is
+00041980: 204e 6f6e 653a 0d0a 0909 0909 0964 616d   None:.......dam
+00041990: 6167 6564 5f74 696d 6573 3d64 6174 6173  aged_times=datas
+000419a0: 6574 5b6e 702e 616e 7928 6461 7461 7365  et[np.any(datase
+000419b0: 742e 7661 6c75 6573 3c6c 6f77 6572 7661  t.values<lowerva
+000419c0: 6c75 652c 6178 6973 3d31 295d 2e69 6e64  lue,axis=1)].ind
+000419d0: 6578 0d0a 0909 0909 656c 7365 3a0d 0a09  ex......else:...
+000419e0: 0909 0909 6461 6d61 6765 645f 7469 6d65  ....damaged_time
+000419f0: 733d 6461 7461 7365 745b 6e70 2e61 6e79  s=dataset[np.any
+00041a00: 2864 6174 6173 6574 2e76 616c 7565 733c  (dataset.values<
+00041a10: 6c6f 7765 725f 6d61 7472 6978 2c61 7869  lower_matrix,axi
+00041a20: 733d 3129 5d2e 696e 6465 780d 0a09 0909  s=1)].index.....
+00041a30: 0964 6174 6173 6574 2e64 726f 7028 6461  .dataset.drop(da
+00041a40: 6d61 6765 645f 7469 6d65 732c 696e 706c  maged_times,inpl
+00041a50: 6163 6520 3d20 5472 7565 290d 0a09 0909  ace = True).....
+00041a60: 0969 6620 6c65 6e28 6461 7461 7365 742e  .if len(dataset.
+00041a70: 696e 6465 782e 7661 6c75 6573 293c 6d61  index.values)<ma
+00041a80: 7472 6978 5f73 697a 652a 302e 383a 0d0a  trix_size*0.8:..
+00041a90: 0909 0909 0970 7269 6e74 2827 6174 7465  .....print('atte
+00041aa0: 6e74 696f 6e2c 206d 6f72 6520 7468 616e  ntion, more than
+00041ab0: 2032 3025 206f 6620 7468 6520 6461 7461   20% of the data
+00041ac0: 2077 6173 2072 656d 6f76 6564 2062 7920   was removed by 
+00041ad0: 7468 6973 2066 696c 7465 722e 2729 200d  this filter.') .
+00041ae0: 0a09 0909 0909 7072 696e 7428 2750 6c65  ......print('Ple
+00041af0: 6173 6520 6368 6563 6b20 7769 7468 2069  ase check with i
+00041b00: 6620 7468 6520 7370 6563 7461 6c20 626f  f the spectal bo
+00041b10: 7264 6572 7320 636f 6e74 6169 6e20 7265  rders contain re
+00041b20: 6769 6f6e 7320 7769 7468 6f75 7420 6c69  gions without li
+00041b30: 6768 7420 2861 6e64 2068 6967 6820 6e6f  ght (and high no
+00041b40: 6973 6529 2729 0d0a 0909 0909 0970 7269  ise)').......pri
+00041b50: 6e74 2827 5365 7474 696e 6720 6120 626f  nt('Setting a bo
+00041b60: 7264 6572 6375 7420 616e 6420 7363 6174  rdercut and scat
+00041b70: 7465 7263 7574 2062 6566 6f72 6520 7468  tercut before th
+00041b80: 6520 6669 6c74 6572 696e 6720 6d69 6768  e filtering migh
+00041b90: 7420 6265 2075 7365 6675 6c27 290d 0a09  t be useful')...
+00041ba0: 0909 656c 7365 3a20 0d0a 0909 0909 6966  ..else: ......if
+00041bb0: 2072 6570 6c61 6365 5f62 6164 5f76 616c   replace_bad_val
+00041bc0: 7565 7320 6973 204e 6f6e 653a 2023 696e  ues is None: #in
+00041bd0: 6469 7669 6475 616c 2064 6174 6120 6669  dividual data fi
+00041be0: 6c74 6572 0d0a 0909 0909 0972 6570 6c61  lter.......repla
+00041bf0: 6365 5f62 6164 5f76 616c 7565 733d 6e70  ce_bad_values=np
+00041c00: 2e6e 616e 0d0a 0909 0909 6966 2075 7070  .nan......if upp
+00041c10: 6572 5f6d 6174 7269 7820 6973 204e 6f6e  er_matrix is Non
+00041c20: 653a 0d0a 0909 0909 0964 6174 6173 6574  e:.......dataset
+00041c30: 2e76 616c 7565 735b 6461 7461 7365 742e  .values[dataset.
+00041c40: 7661 6c75 6573 3e75 7070 6572 7661 6c75  values>uppervalu
+00041c50: 655d 3d72 6570 6c61 6365 5f62 6164 5f76  e]=replace_bad_v
+00041c60: 616c 7565 730d 0a09 0909 0965 6c73 653a  alues......else:
+00041c70: 0d0a 0909 0909 0964 6174 6173 6574 2e76  .......dataset.v
+00041c80: 616c 7565 735b 6461 7461 7365 742e 7661  alues[dataset.va
+00041c90: 6c75 6573 3e75 7070 6572 5f6d 6174 7269  lues>upper_matri
+00041ca0: 785d 3d72 6570 6c61 6365 5f62 6164 5f76  x]=replace_bad_v
+00041cb0: 616c 7565 730d 0a09 0909 0969 6620 6c6f  alues......if lo
+00041cc0: 7765 725f 6d61 7472 6978 2069 7320 4e6f  wer_matrix is No
+00041cd0: 6e65 3a0d 0a09 0909 0909 6461 7461 7365  ne:.......datase
+00041ce0: 742e 7661 6c75 6573 5b64 6174 6173 6574  t.values[dataset
+00041cf0: 2e76 616c 7565 733c 6c6f 7765 7276 616c  .values<lowerval
+00041d00: 7565 5d3d 7265 706c 6163 655f 6261 645f  ue]=replace_bad_
+00041d10: 7661 6c75 6573 0d0a 0909 0909 656c 7365  values......else
+00041d20: 3a0d 0a09 0909 0909 6461 7461 7365 742e  :.......dataset.
+00041d30: 7661 6c75 6573 5b64 6174 6173 6574 2e76  values[dataset.v
+00041d40: 616c 7565 733c 6c6f 7765 725f 6d61 7472  alues<lower_matr
+00041d50: 6978 5d3d 7265 706c 6163 655f 6261 645f  ix]=replace_bad_
+00041d60: 7661 6c75 6573 0d0a 0909 0909 6966 2072  values......if r
+00041d70: 6570 6c61 6365 5f62 6164 5f76 616c 7565  eplace_bad_value
+00041d80: 7320 3d3d 206e 702e 6e61 6e3a 200d 0a09  s == np.nan: ...
+00041d90: 0909 0909 6966 2064 6174 6173 6574 2e69  ....if dataset.i
+00041da0: 736e 6128 292e 7375 6d28 292e 7375 6d28  sna().sum().sum(
+00041db0: 293e 302e 3220 2a20 6461 7461 7365 742e  )>0.2 * dataset.
+00041dc0: 6e6f 746e 6128 292e 7375 6d28 292e 7375  notna().sum().su
+00041dd0: 6d28 293a 0d0a 0909 0909 0909 7072 696e  m():........prin
+00041de0: 7428 2761 7474 656e 7469 6f6e 2c20 6d6f  t('attention, mo
+00041df0: 7265 2074 6861 6e20 3230 2520 6f66 2074  re than 20% of t
+00041e00: 6865 2064 6174 6120 7761 7320 7265 6d6f  he data was remo
+00041e10: 7665 6420 6279 2074 6869 7320 6669 6c74  ved by this filt
+00041e20: 6572 2e27 2920 0d0a 0909 0909 0909 7072  er.') ........pr
+00041e30: 696e 7428 2750 6c65 6173 6520 6368 6563  int('Please chec
+00041e40: 6b20 7769 7468 2069 6620 7468 6520 7370  k with if the sp
+00041e50: 6563 7461 6c20 626f 7264 6572 7320 636f  ectal borders co
+00041e60: 6e74 6169 6e20 7265 6769 6f6e 7320 7769  ntain regions wi
+00041e70: 7468 6f75 7420 6c69 6768 7420 2861 6e64  thout light (and
+00041e80: 2068 6967 6820 6e6f 6973 6529 2729 0d0a   high noise)')..
+00041e90: 0909 0909 0909 7072 696e 7428 2753 6574  ......print('Set
+00041ea0: 7469 6e67 2061 2062 6f72 6465 7263 7574  ting a bordercut
+00041eb0: 2061 6e64 2073 6361 7474 6572 6375 7420   and scattercut 
+00041ec0: 6265 666f 7265 2074 6865 2066 696c 7465  before the filte
+00041ed0: 7269 6e67 206d 6967 6874 2062 6520 7573  ring might be us
+00041ee0: 6566 756c 2729 0d0a 0909 0909 656c 7365  eful')......else
+00041ef0: 3a0d 0a09 0909 0909 6966 2064 6174 6173  :.......if datas
+00041f00: 6574 5b64 6174 6173 6574 3d3d 7265 706c  et[dataset==repl
+00041f10: 6163 655f 6261 645f 7661 6c75 6573 5d2e  ace_bad_values].
+00041f20: 6e6f 746e 6128 292e 7375 6d28 292e 7375  notna().sum().su
+00041f30: 6d28 293e 2030 2e32 2a20 6461 7461 7365  m()> 0.2* datase
+00041f40: 745b 6461 7461 7365 7421 3d72 6570 6c61  t[dataset!=repla
+00041f50: 6365 5f62 6164 5f76 616c 7565 735d 2e6e  ce_bad_values].n
+00041f60: 6f74 6e61 2829 2e73 756d 2829 2e73 756d  otna().sum().sum
+00041f70: 2829 3a0d 0a09 0909 0909 0970 7269 6e74  ():........print
+00041f80: 2827 6174 7465 6e74 696f 6e2c 206d 6f72  ('attention, mor
+00041f90: 6520 7468 616e 2032 3025 206f 6620 7468  e than 20% of th
+00041fa0: 6520 6461 7461 2077 6173 2072 656d 6f76  e data was remov
+00041fb0: 6564 2062 7920 7468 6973 2066 696c 7465  ed by this filte
+00041fc0: 722e 2729 200d 0a09 0909 0909 0970 7269  r.') ........pri
+00041fd0: 6e74 2827 506c 6561 7365 2063 6865 636b  nt('Please check
+00041fe0: 2077 6974 6820 6966 2074 6865 2073 7065   with if the spe
+00041ff0: 6374 616c 2062 6f72 6465 7273 2063 6f6e  ctal borders con
+00042000: 7461 696e 2072 6567 696f 6e73 2077 6974  tain regions wit
+00042010: 686f 7574 206c 6967 6874 2028 616e 6420  hout light (and 
+00042020: 6869 6768 206e 6f69 7365 2927 290d 0a09  high noise)')...
+00042030: 0909 0909 0970 7269 6e74 2827 5365 7474  .....print('Sett
+00042040: 696e 6720 6120 626f 7264 6572 6375 7420  ing a bordercut 
+00042050: 616e 6420 7363 6174 7465 7263 7574 2062  and scattercut b
+00042060: 6566 6f72 6520 7468 6520 6669 6c74 6572  efore the filter
+00042070: 696e 6720 6d69 6768 7420 6265 2075 7365  ing might be use
+00042080: 6675 6c27 290d 0a09 090d 0a09 0969 6620  ful')........if 
+00042090: 6473 2069 7320 6e6f 7420 4e6f 6e65 3a72  ds is not None:r
+000420a0: 6574 7572 6e20 6669 6c74 6572 696e 675b  eturn filtering[
+000420b0: 305d 0d0a 0d0a 090d 0a09 0d0a 0964 6566  0]...........def
+000420c0: 2042 6163 6b67 726f 756e 6428 7365 6c66   Background(self
+000420d0: 2c20 6c6f 776c 696d 6974 3d4e 6f6e 652c  , lowlimit=None,
+000420e0: 7570 6c69 6d69 743d 2d31 2c20 7573 655f  uplimit=-1, use_
+000420f0: 6d65 6469 616e 3d46 616c 7365 2c20 6473  median=False, ds
+00042100: 3d4e 6f6e 652c 2063 6f72 7265 6374 696f  =None, correctio
+00042110: 6e3d 4e6f 6e65 293a 0d0a 0909 2727 2754  n=None):....'''T
+00042120: 6869 7320 6973 2074 6865 2062 6163 6b67  his is the backg
+00042130: 726f 756e 6420 636f 7272 6563 7469 6f6e  round correction
+00042140: 2e20 496e 2067 656e 6572 616c 2069 7420  . In general it 
+00042150: 666f 7220 6561 6368 206d 6561 7375 7265  for each measure
+00042160: 6420 0d0a 0909 7761 7665 6c65 6e67 7468  d ....wavelength
+00042170: 2061 7665 7261 6765 7320 7468 6520 7661   averages the va
+00042180: 6c75 6573 2066 726f 6d20 276c 6f77 6c69  lues from 'lowli
+00042190: 6d69 7427 2074 6f20 2775 706c 696d 6974  mit' to 'uplimit
+000421a0: 2720 616e 6420 0d0a 0909 7375 6274 7261  ' and ....subtra
+000421b0: 6374 7320 6974 2066 726f 6d20 7468 6520  cts it from the 
+000421c0: 6461 7461 2e20 4974 2072 756e 6420 6f6e  data. It rund on
+000421d0: 2074 6865 206f 626a 6563 7420 2867 6c6f   the object (glo
+000421e0: 6261 6c29 206f 7220 6966 200d 0a09 0967  bal) or if ....g
+000421f0: 6976 656e 2061 2073 7065 6369 6669 6320  iven a specific 
+00042200: 6473 206c 6f63 616c 2e20 0d0a 0909 5468  ds local. ....Th
+00042210: 6520 6c6f 7720 616e 6420 7570 6c69 6d69  e low and uplimi
+00042220: 7420 6361 6e20 6265 2073 6574 2061 6e79  t can be set any
+00042230: 7768 6572 6520 746f 2073 7562 7374 7261  where to substra
+00042240: 6374 2061 6e79 2062 6163 6b67 726f 756e  ct any backgroun
+00042250: 642e 0d0a 0909 4974 2069 7320 696d 706f  d.....It is impo
+00042260: 7274 616e 7420 746f 206e 6f74 6520 7468  rtant to note th
+00042270: 6174 206d 616e 7920 7072 6f62 6c65 6d73  at many problems
+00042280: 2064 7572 696e 6720 6d65 6173 7572 656d   during measurem
+00042290: 656e 7473 206d 6967 6874 0d0a 0909 6265  ents might....be
+000422a0: 2076 6973 6962 6c65 2069 6e20 7468 6520   visible in the 
+000422b0: 6461 7461 2062 6566 6f72 6520 7469 6d65  data before time
+000422c0: 207a 6572 6f2e 2053 6f20 4920 7265 636f   zero. So I reco
+000422d0: 6d6d 656e 6420 746f 2066 6972 7374 0d0a  mmend to first..
+000422e0: 0909 706c 6f74 2077 6974 686f 7574 2062  ..plot without b
+000422f0: 6163 6b67 726f 756e 6420 636f 7272 6563  ackground correc
+00042300: 7469 6f6e 2061 6e64 206f 6e6c 7920 6166  tion and only af
+00042310: 7465 7220 7468 6973 2069 6e73 7065 6374  ter this inspect
+00042320: 696f 6e20 0d0a 0909 6170 706c 7920 7468  ion ....apply th
+00042330: 6520 6261 636b 6772 6f75 6e64 2063 6f72  e background cor
+00042340: 7265 6374 696f 6e2e 200d 0a09 0954 6865  rection. ....The
+00042350: 2066 6974 2066 756e 6374 696f 6e20 6861   fit function ha
+00042360: 7320 6974 7320 6f77 6e20 7761 7920 746f  s its own way to
+00042370: 2063 616c 6375 6c63 6174 6520 616e 6420   calculcate and 
+00042380: 6170 706c 7920 6120 6261 636b 6772 6f75  apply a backgrou
+00042390: 6e64 200d 0a09 0954 6861 7420 636f 756c  nd ....That coul
+000423a0: 6420 6265 2075 7365 6420 696e 7374 6561  d be used instea
+000423b0: 6420 2862 7574 206d 616b 696e 6720 7468  d (but making th
+000423c0: 6520 6669 7420 6c65 7373 2073 7461 626c  e fit less stabl
+000423d0: 6529 200d 0a09 090d 0a09 0950 6172 616d  e) ........Param
+000423e0: 6574 6572 730d 0a09 092d 2d2d 2d2d 2d2d  eters....-------
+000423f0: 2d2d 2d2d 2d0d 0a09 090d 0a09 096c 6f77  -----........low
+00042400: 6c69 6d69 7420 3a20 4e6f 6e65 206f 7220  limit : None or 
+00042410: 666c 6f61 742c 206f 7074 696f 6e61 6c0d  float, optional.
+00042420: 0a09 0909 7468 6973 2069 7320 7468 6520  ....this is the 
+00042430: 6c6f 7765 7220 6c69 6d69 7420 6672 6f6d  lower limit from
+00042440: 2077 6869 6368 2074 6865 2061 7665 7261   which the avera
+00042450: 6765 2028 6f72 206d 6564 6961 6e29 2069  ge (or median) i
+00042460: 7320 7461 6b65 6e0d 0a09 0909 2844 6566  s taken.....(Def
+00042470: 6175 6c74 2920 6973 204e 6f6e 652c 2069  ault) is None, i
+00042480: 6e20 7768 6963 6820 6361 7365 2074 6865  n which case the
+00042490: 206c 6f77 6572 206c 696d 6974 206f 6620   lower limit of 
+000424a0: 7468 6520 6461 7461 2069 7320 7573 6564  the data is used
+000424b0: 2e0d 0a09 090d 0a09 0975 706c 696d 6974  .........uplimit
+000424c0: 203a 204e 6f6e 6520 6f72 2066 6c6f 6174   : None or float
+000424d0: 2c20 6f70 7469 6f6e 616c 200d 0a09 0909  , optional .....
+000424e0: 7468 6973 2069 7320 7468 6520 7570 7065  this is the uppe
+000424f0: 7220 6c69 6d69 7420 756e 7469 6c20 7768  r limit until wh
+00042500: 6963 6820 7468 6520 6176 6572 6167 6520  ich the average 
+00042510: 286f 7220 6d65 6469 616e 2920 6973 2074  (or median) is t
+00042520: 616b 656e 0d0a 0909 0928 4465 6661 756c  aken.....(Defaul
+00042530: 7429 2069 7320 2d31 2028 7573 7561 6c6c  t) is -1 (usuall
+00042540: 7920 7073 292c 2069 6e20 7768 6963 6820  y ps), in which 
+00042550: 6361 7365 2074 6865 206c 6f77 6572 206c  case the lower l
+00042560: 696d 6974 206f 6620 7468 6520 6461 7461  imit of the data
+00042570: 2069 7320 7573 6564 2e0d 0a09 090d 0a09   is used........
+00042580: 0975 7365 5f6d 6564 6961 6e20 3a20 626f  .use_median : bo
+00042590: 6f6c 2c20 6f70 7469 6f6e 616c 0d0a 0909  ol, optional....
+000425a0: 0974 6865 204d 6564 6961 6e20 6973 2061  .the Median is a
+000425b0: 206d 6f72 6520 6f75 746c 6965 7220 7265   more outlier re
+000425c0: 7369 7374 616e 7420 6d65 7472 6963 2069  sistant metric i
+000425d0: 6e20 636f 6d70 6172 6973 696f 6e20 746f  n comparision to
+000425e0: 200d 0a09 0909 7468 6520 4d65 616e 2028   .....the Mean (
+000425f0: 4176 6572 6167 6529 2e20 486f 7765 7665  Average). Howeve
+00042600: 7220 7468 6520 7661 6c75 6573 2061 7265  r the values are
+00042610: 206e 6f74 2071 7569 7465 2061 7320 636c   not quite as cl
+00042620: 6f73 6520 0d0a 0909 0974 6f20 7468 6520  ose .....to the 
+00042630: 6469 7374 7269 6275 7469 6f6e 2063 656e  distribution cen
+00042640: 7465 7220 696e 2063 6173 6520 6f66 2076  ter in case of v
+00042650: 6572 7920 6665 7720 7661 6c75 6573 2e20  ery few values. 
+00042660: 4661 6c73 6520 0d0a 0909 0928 4465 6661  False .....(Defa
+00042670: 756c 7429 206d 6561 6e73 2074 6865 204d  ult) means the M
+00042680: 6561 6e20 6973 2075 7365 640d 0a09 0909  ean is used.....
+00042690: 0d0a 0909 6473 203a 204e 6f6e 6520 6f72  ....ds : None or
+000426a0: 2044 6174 6146 7261 6d65 2c20 6f70 7469   DataFrame, opti
+000426b0: 6f6e 616c 0d0a 0909 0969 6620 4e6f 6e65  onal.....if None
+000426c0: 2028 4465 6661 756c 7429 2074 6865 2069   (Default) the i
+000426d0: 6e74 6572 6e61 6c20 4461 7461 6672 616d  nternal Datafram
+000426e0: 6520 7365 6c66 2e64 7320 6973 2075 7365  e self.ds is use
+000426f0: 642c 200d 0a09 0909 6f74 6865 7277 6973  d, .....otherwis
+00042700: 6520 7468 6520 7061 6e64 6173 2044 6174  e the pandas Dat
+00042710: 6146 7261 6d65 2064 7320 6973 2063 6f72  aFrame ds is cor
+00042720: 7265 6374 6564 2061 6e64 2072 6574 7572  rected and retur
+00042730: 6e65 640d 0a09 0909 0d0a 0909 636f 7272  ned.........corr
+00042740: 6563 7469 6f6e 203a 204e 6f6e 6520 6f72  ection : None or
+00042750: 2044 6174 6146 7261 6d65 2c20 6f70 7469   DataFrame, opti
+00042760: 6f6e 616c 0d0a 0909 0974 6869 7320 6973  onal.....this is
+00042770: 2074 6865 2063 6f72 7265 6374 696f 6e20   the correction 
+00042780: 6170 706c 6965 642e 2049 7420 6d75 7374  applied. It must
+00042790: 2062 6520 6120 4461 7461 4672 616d 6520   be a DataFrame 
+000427a0: 7769 7468 200d 0a09 0909 7468 6520 7361  with .....the sa
+000427b0: 6d65 206e 756d 6265 7273 206f 6620 636f  me numbers of co
+000427c0: 6c75 6d6e 7320 2873 7065 6374 7261 6c20  lumns (spectral 
+000427d0: 706f 696e 7473 2920 6173 2074 6865 2075  points) as the u
+000427e0: 7365 6420 6473 0d0a 0909 0d0a 0909 4578  sed ds........Ex
+000427f0: 616d 706c 6573 0d0a 0909 2d2d 2d2d 2d2d  amples....------
+00042800: 2d2d 0d0a 0909 6966 2074 6865 206f 626a  --....if the obj
+00042810: 6563 7420 7365 6c66 2068 6173 2074 6865  ect self has the
+00042820: 206e 616d 6520 2274 6122 0d0a 0909 0d0a   name "ta"......
+00042830: 0909 7479 7069 6361 6c20 7573 6561 6765  ..typical useage
+00042840: 3a20 2009 090d 0a09 0909 090d 0a09 093e  :  ............>
+00042850: 3e3e 2074 612e 4261 636b 6772 6f75 6e64  >> ta.Background
+00042860: 2829 0d0a 0909 0d0a 0909 7370 6563 6966  ()........specif
+00042870: 7920 696e 6567 7261 7465 6420 6172 6520  y inegrated are 
+00042880: 746f 202d 2069 6e66 2028 4465 6661 756c  to - inf (Defaul
+00042890: 7429 2075 7020 746f 202d 302e 3570 7320  t) up to -0.5ps 
+000428a0: 616e 6420 7573 6520 7468 6520 4d65 6469  and use the Medi
+000428b0: 616e 2066 6f72 2063 6f6d 7075 7461 7469  an for computati
+000428c0: 6f6e 090d 0a09 090d 0a09 093e 3e3e 2074  on.........>>> t
+000428d0: 612e 4261 636b 6772 6f75 6e64 2875 706c  a.Background(upl
+000428e0: 696d 6974 203d 202d 302e 352c 2075 7365  imit = -0.5, use
+000428f0: 5f6d 6564 6961 6e20 3d20 5472 7565 290d  _median = True).
+00042900: 0a09 090d 0a09 0927 2727 0d0a 0909 6966  .......'''....if
+00042910: 2064 7320 6973 204e 6f6e 653a 0d0a 0909   ds is None:....
+00042920: 0972 756e 5f67 6c6f 6261 6c3d 5472 7565  .run_global=True
+00042930: 0d0a 0909 0964 733d 7365 6c66 2e64 730d  .....ds=self.ds.
+00042940: 0a09 0965 6c73 653a 0d0a 0909 0972 756e  ...else:.....run
+00042950: 5f67 6c6f 6261 6c3d 4661 6c73 650d 0a09  _global=False...
+00042960: 0909 6966 2063 6f72 7265 6374 696f 6e20  ..if correction 
+00042970: 6973 204e 6f6e 653a 7261 6973 6520 5661  is None:raise Va
+00042980: 6c75 6545 7272 6f72 2827 5765 206d 7573  lueError('We mus
+00042990: 7420 6861 7665 2063 6f72 7265 6374 696f  t have correctio
+000429a0: 6e20 6769 7665 6e2c 2074 6f20 736c 6f77  n given, to slow
+000429b0: 206f 7468 6572 6877 6973 6527 290d 0a09   otherhwise')...
+000429c0: 0969 6620 286c 6f77 6c69 6d69 7420 6973  .if (lowlimit is
+000429d0: 204e 6f6e 6529 2061 6e64 2028 636f 7272   None) and (corr
+000429e0: 6563 7469 6f6e 2069 7320 4e6f 6e65 293a  ection is None):
+000429f0: 0d0a 0909 0969 6620 7573 655f 6d65 6469  .....if use_medi
+00042a00: 616e 3a0d 0a09 0909 0963 6f72 7265 6374  an:......correct
+00042a10: 696f 6e3d 6473 5b3a 7570 6c69 6d69 745d  ion=ds[:uplimit]
+00042a20: 2e6d 6564 6961 6e28 6178 6973 3d30 290d  .median(axis=0).
+00042a30: 0a09 0909 656c 7365 3a0d 0a09 0909 0963  ....else:......c
+00042a40: 6f72 7265 6374 696f 6e3d 6473 5b3a 7570  orrection=ds[:up
+00042a50: 6c69 6d69 745d 2e6d 6561 6e28 6178 6973  limit].mean(axis
+00042a60: 3d30 290d 0a09 0965 6c69 6620 286c 6f77  =0)....elif (low
+00042a70: 6c69 6d69 7420 6973 206e 6f74 204e 6f6e  limit is not Non
+00042a80: 6529 2061 6e64 2028 636f 7272 6563 7469  e) and (correcti
+00042a90: 6f6e 2069 7320 4e6f 6e65 293a 0d0a 0909  on is None):....
+00042aa0: 0969 6620 7573 655f 6d65 6469 616e 3a0d  .if use_median:.
+00042ab0: 0a09 0909 0963 6f72 7265 6374 696f 6e3d  .....correction=
+00042ac0: 6473 5b6c 6f77 6c69 6d69 743a 7570 6c69  ds[lowlimit:upli
+00042ad0: 6d69 745d 2e6d 6564 6961 6e28 6178 6973  mit].median(axis
+00042ae0: 3d30 290d 0a09 0909 656c 7365 3a0d 0a09  =0).....else:...
+00042af0: 0909 0963 6f72 7265 6374 696f 6e3d 6473  ...correction=ds
+00042b00: 5b6c 6f77 6c69 6d69 743a 7570 6c69 6d69  [lowlimit:uplimi
+00042b10: 745d 2e6d 6561 6e28 6178 6973 3d30 290d  t].mean(axis=0).
+00042b20: 0a09 0969 6620 7275 6e5f 676c 6f62 616c  ...if run_global
+00042b30: 3a0d 0a09 0909 7365 6c66 2e64 733d 6473  :.....self.ds=ds
+00042b40: 2d63 6f72 7265 6374 696f 6e0d 0a09 0909  -correction.....
+00042b50: 7365 6c66 2e62 6163 6b67 726f 756e 645f  self.background_
+00042b60: 7061 723d 5b6c 6f77 6c69 6d69 742c 7570  par=[lowlimit,up
+00042b70: 6c69 6d69 742c 7573 655f 6d65 6469 616e  limit,use_median
+00042b80: 2c63 6f72 7265 6374 696f 6e5d 0d0a 0909  ,correction]....
+00042b90: 656c 7365 3a0d 0a09 0909 7265 7475 726e  else:.....return
+00042ba0: 2064 732d 636f 7272 6563 7469 6f6e 0d0a   ds-correction..
+00042bb0: 0d0a 0d0a 0964 6566 204d 616e 5f43 6869  .....def Man_Chi
+00042bc0: 7270 2873 656c 662c 7368 6f77 6e5f 7769  rp(self,shown_wi
+00042bd0: 6e64 6f77 3d5b 2d31 2c31 5d2c 7061 7468  ndow=[-1,1],path
+00042be0: 3d4e 6f6e 652c 6d61 785f 706f 696e 7473  =None,max_points
+00042bf0: 3d34 302c 636d 6170 3d63 6d2e 7072 6973  =40,cmap=cm.pris
+00042c00: 6d2c 6473 3d4e 6f6e 6529 3a0d 0a09 0927  m,ds=None):....'
+00042c10: 2727 5472 6967 6765 7269 6e67 206f 6620  ''Triggering of 
+00042c20: 4d61 6e75 656c 2046 6978 5f43 6869 7270  Manuel Fix_Chirp
+00042c30: 2e20 7573 7561 6c6c 7920 7573 6564 2077  . usually used w
+00042c40: 6865 6e20 436f 725f 4368 6972 7020 6861  hen Cor_Chirp ha
+00042c50: 7320 7275 6e20 616c 7265 6164 792e 200d  s run already. .
+00042c60: 0a09 0941 6c74 6572 6e61 7469 7665 6c79  ...Alternatively
+00042c70: 2064 656c 6574 6520 7468 6520 6368 6972   delete the chir
+00042c80: 7020 6669 6c65 2e20 5468 6973 2046 756e  p file. This Fun
+00042c90: 6374 696f 6e20 6f70 656e 7320 6120 706c  ction opens a pl
+00042ca0: 6f74 2069 6e20 7768 6963 6820 7468 6520  ot in which the 
+00042cb0: 7573 6572 206d 616e 7561 6c6c 7920 7365  user manually se
+00042cc0: 6c65 6374 7320 6120 6e75 6d62 6572 206f  lects a number o
+00042cd0: 6620 706f 696e 7473 0d0a 0909 5468 6573  f points....Thes
+00042ce0: 6520 706f 696e 7473 2077 696c 6c20 7468  e points will th
+00042cf0: 656e 2062 6520 696e 7465 7270 6f6c 6174  en be interpolat
+00042d00: 6564 2077 6974 6820 6120 3474 6820 6f72  ed with a 4th or
+00042d10: 6465 7220 706f 6c79 6e6f 6d69 616c 0d0a  der polynomial..
+00042d20: 0909 5468 6520 7573 6572 2063 616e 2074  ..The user can t
+00042d30: 6865 6e20 7365 6c65 6374 2061 206e 6577  hen select a new
+00042d40: 2074 3d30 2070 6f69 6e74 2e20 0d0a 0909   t=0 point. ....
+00042d50: 5468 6520 6669 7273 7420 6f70 7469 6f6e  The first option
+00042d60: 2061 6c6c 6f77 7320 746f 2066 696e 6520   allows to fine 
+00042d70: 7365 6c65 6374 2061 6e20 696e 7465 6e73  select an intens
+00042d80: 6974 7920 7365 7474 696e 6720 666f 7220  ity setting for 
+00042d90: 7468 6973 2063 6869 7270 2063 6f72 7265  this chirp corre
+00042da0: 6374 696f 6e2e 0d0a 0909 486f 7765 7665  ction.....Howeve
+00042db0: 7220 736f 6d65 7469 6d65 7320 7370 696b  r sometimes spik
+00042dc0: 6573 2061 7265 206d 616b 696e 6720 7468  es are making th
+00042dd0: 6973 2074 6869 6e67 7320 6469 6666 6963  is things diffic
+00042de0: 756c 742e 2049 6e20 7468 6973 2063 6173  ult. In this cas
+00042df0: 6520 7365 7420 6120 6775 6573 7365 6420  e set a guessed 
+00042e00: 696e 7465 6e73 6974 7920 7769 7468 2073  intensity with s
+00042e10: 656c 662e 696e 7465 6e73 6974 795f 7261  elf.intensity_ra
+00042e20: 6e67 653d 3165 2d33 0d0a 0909 0d0a 0909  nge=1e-3........
+00042e30: 5061 7261 6d65 7465 7273 0d0a 0909 2d2d  Parameters....--
+00042e40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a09 0920  -----------.... 
+00042e50: 2020 0d0a 0909 7061 7468 203a 2073 7472    ....path : str
+00042e60: 206f 7220 7061 7468 206f 626a 6563 7420   or path object 
+00042e70: 286f 7074 696f 6e61 6c29 0d0a 0909 0969  (optional).....i
+00042e80: 6620 7061 7468 2069 7320 6120 7374 7269  f path is a stri
+00042e90: 6e67 2077 6974 686f 7574 2074 6865 206f  ng without the o
+00042ea0: 7065 7261 7469 6f6e 2073 7973 7465 6d20  peration system 
+00042eb0: 6465 7065 6e64 656e 7420 7365 7061 7261  dependent separa
+00042ec0: 746f 722c 2069 7420 6973 2074 7265 6174  tor, it is treat
+00042ed0: 6564 2061 7320 6120 7265 6c61 7469 7665  ed as a relative
+00042ee0: 2070 6174 682c 200d 0a09 0909 652e 672e   path, .....e.g.
+00042ef0: 2064 6174 6120 7769 6c6c 206c 6f6f 6b20   data will look 
+00042f00: 6672 6f6d 2074 6865 2077 6f72 6b69 6e67  from the working
+00042f10: 2064 6972 6563 746f 7279 2069 6e20 7468   directory in th
+00042f20: 6520 7375 6220 6469 7265 6374 6f72 2064  e sub director d
+00042f30: 6174 612e 204f 7468 6572 7769 7365 2074  ata. Otherwise t
+00042f40: 6869 7320 6861 7320 746f 2062 6520 6120  his has to be a 
+00042f50: 0d0a 0909 0966 756c 6c20 7061 7468 2069  .....full path i
+00042f60: 6e20 6569 7468 6572 2073 7472 6f6e 6720  n either strong 
+00042f70: 6f72 2070 6174 6820 6f62 6a65 6374 2066  or path object f
+00042f80: 6f72 6d2e 0d0a 0909 0d0a 0909 7368 6f77  orm.........show
+00042f90: 6e5f 7769 6e64 6f77 203a 206c 6973 7420  n_window : list 
+00042fa0: 2877 6974 6820 7477 6f20 666c 6f61 7473  (with two floats
+00042fb0: 292c 206f 7074 696f 6e61 6c0d 0a09 0909  ), optional.....
+00042fc0: 4465 6669 6e65 7320 7468 6520 7769 6e64  Defines the wind
+00042fd0: 6f77 2074 6861 7420 6973 2073 686f 776e  ow that is shown
+00042fe0: 2064 7572 696e 6720 6368 6972 7020 636f   during chirp co
+00042ff0: 7272 6563 7469 6f6e 2e20 4966 2074 6865  rrection. If the
+00043000: 2074 3d30 2069 7320 6e6f 7420 7669 7369   t=0 is not visi
+00043010: 626c 652c 2061 646a 7573 7420 7468 6973  ble, adjust this
+00043020: 2070 6172 616d 6574 6572 0d0a 0909 0974   parameter.....t
+00043030: 6f20 7375 6974 2074 6865 2065 7870 6572  o suit the exper
+00043040: 696d 656e 742e 2049 6620 7072 6f62 6c65  iment. If proble
+00043050: 6d73 2061 7269 7365 2c20 4920 7265 636f  ms arise, I reco
+00043060: 6d6d 656e 7420 746f 2075 7365 2050 6c6f  mment to use Plo
+00043070: 745f 5261 7720 746f 2063 6865 636b 2077  t_Raw to check w
+00043080: 6865 7265 2074 3d30 2069 7320 6c6f 6361  here t=0 is loca
+00043090: 7465 640d 0a0d 0a09 096d 6178 5f70 6f69  ted......max_poi
+000430a0: 6e74 7320 3a20 696e 742c 206f 7074 696f  nts : int, optio
+000430b0: 6e61 6c0d 0a09 0909 4465 6661 756c 7420  nal.....Default 
+000430c0: 3d20 3430 206d 6178 206e 756d 6265 7273  = 40 max numbers
+000430d0: 206f 6620 706f 696e 7473 2074 6f20 7573   of points to us
+000430e0: 6520 696e 2047 7569 2073 656c 6563 7469  e in Gui selecti
+000430f0: 6f6e 2e20 5573 6566 756c 206f 7074 696f  on. Useful optio
+00043100: 6e20 696e 2063 6173 6520 6e6f 206d 6964  n in case no mid
+00043110: 646c 6520 6d6f 7573 6520 6275 7474 6f6e  dle mouse button
+00043120: 0d0a 0909 0969 7320 6176 6169 6c61 626c  .....is availabl
+00043130: 652e 2028 652e 672e 2074 6f75 6368 7061  e. (e.g. touchpa
+00043140: 6429 0d0a 0909 0d0a 0909 636d 6170 203a  d)........cmap :
+00043150: 206d 6174 706c 6f74 6c69 6220 636f 6c6f   matplotlib colo
+00043160: 7572 6d61 702c 206f 7074 696f 6e61 6c0d  urmap, optional.
+00043170: 0a09 0909 436f 6c6f 7572 6d61 7020 746f  ....Colourmap to
+00043180: 2062 6520 7573 6564 2066 6f72 2074 6865   be used for the
+00043190: 2063 6869 7270 2063 6f72 7265 6374 696f   chirp correctio
+000431a0: 6e2e 2057 6869 6c65 2074 6865 7265 2069  n. While there i
+000431b0: 7320 6120 6c61 7267 6520 7365 6c65 6374  s a large select
+000431c0: 696f 6e20 6865 7265 2049 2072 6563 6f6d  ion here I recom
+000431d0: 6d65 6e64 2074 6f20 6368 6f6f 7365 0d0a  mend to choose..
+000431e0: 0909 0961 2064 6966 6665 7265 6e74 206d  ...a different m
+000431f0: 6170 2074 6861 6e20 6973 2075 7365 6420  ap than is used 
+00043200: 666f 7220 7468 6520 6e6f 726d 616c 2032  for the normal 2
+00043210: 6420 706c 6f74 7469 6e67 2e5c 6e0d 0a09  d plotting.\n...
+00043220: 0909 636d 2e70 7269 736d 2028 4465 6661  ..cm.prism (Defa
+00043230: 756c 7429 2068 6173 2070 726f 6f66 656e  ult) has proofen
+00043240: 2074 6f20 6265 2076 6572 7920 7573 6566   to be very usef
+00043250: 756c 6c0d 0a09 090d 0a09 0964 733a 2070  ull........ds: p
+00043260: 616e 6461 7320 6461 7461 6672 616d 652c  andas dataframe,
+00043270: 6f70 7469 6f6e 616c 0d0a 0909 0974 6869  optional.....thi
+00043280: 7320 616c 6c6f 7773 2074 6f20 6861 6e64  s allows to hand
+00043290: 2069 6e20 616e 2065 7874 6572 6e61 6c20   in an external 
+000432a0: 6473 2c20 6966 2074 6869 7320 6973 2064  ds, if this is d
+000432b0: 6f6e 6520 7468 656e 2074 6865 206f 6e20  one then the on 
+000432c0: 6469 736b 2073 6176 6564 2066 6974 636f  disk saved fitco
+000432d0: 6566 6620 6172 6520 7468 6520 6e65 7720  eff are the new 
+000432e0: 6f6e 6573 206f 6e6c 7920 616e 6420 7468  ones only and th
+000432f0: 6520 0d0a 0909 0966 756e 6374 696f 6e20  e .....function 
+00043300: 7265 7475 726e 7320 7468 6520 6e65 7720  returns the new 
+00043310: 6669 7463 6f65 6666 2061 6e64 2074 6865  fitcoeff and the
+00043320: 2063 6f6d 6269 6e65 6420 6669 7463 6f65   combined fitcoe
+00043330: 6666 2c20 7365 6c66 2061 6c73 6f20 6861  ff, self also ha
+00043340: 7320 6120 6e65 7720 7661 7269 6162 6c65  s a new variable
+00043350: 2063 616c 6c65 6420 7365 6c66 2e63 6f6d   called self.com
+00043360: 6269 6e65 645f 6669 7463 6f65 6666 0d0a  bined_fitcoeff..
+00043370: 0909 0974 6865 206f 7269 6769 6e61 6c20  ...the original 
+00043380: 6669 6c65 206f 6e20 6469 7320 616e 6420  file on dis and 
+00043390: 7365 6c66 2e66 6974 636f 6566 6620 6172  self.fitcoeff ar
+000433a0: 6520 4e4f 5420 6f76 6572 7772 6974 7465  e NOT overwritte
+000433b0: 6e20 2861 7265 2074 6865 206f 6c64 206f  n (are the old o
+000433c0: 6e65 7329 0d0a 0909 0974 6865 2073 656c  nes).....the sel
+000433d0: 662e 6473 2069 7320 7468 6520 4e45 5720  f.ds is the NEW 
+000433e0: 6f6e 6520 2877 6974 6820 7468 6520 636f  one (with the co
+000433f0: 7272 6563 7469 6f6e 2061 7070 6c69 6564  rrection applied
+00043400: 290d 0a09 0909 746f 2072 6576 6572 7365  ).....to reverse
+00043410: 2073 696d 706c 7920 7275 6e20 436f 725f   simply run Cor_
+00043420: 4368 6972 7028 290d 0a09 0909 746f 2070  Chirp().....to p
+00043430: 6572 6d61 6e65 6e74 6c79 2061 7070 6c79  ermanently apply
+00043440: 2063 6861 6e67 6520 7365 6c66 2e66 6974   change self.fit
+00043450: 636f 6566 6620 7769 7468 2073 656c 662e  coeff with self.
+00043460: 636f 6d62 696e 6564 5f66 6974 636f 6566  combined_fitcoef
+00043470: 6620 616e 6420 7265 6e61 6d65 2074 6865  f and rename the
+00043480: 2066 696c 6520 7769 7468 2027 6669 6c65   file with 'file
+00043490: 6e61 6d65 5f73 6563 6f6e 645f 6368 6972  name_second_chir
+000434a0: 7027 2074 6f20 6669 6c65 6e61 6d65 5f63  p' to filename_c
+000434b0: 6869 7270 0d0a 0909 2727 270d 0a09 0969  hirp....'''....i
+000434c0: 6620 6473 2069 7320 4e6f 6e65 3a0d 0a09  f ds is None:...
+000434d0: 0909 6473 3d73 656c 662e 6473 5f6f 7269  ..ds=self.ds_ori
+000434e0: 0d0a 0909 096f 7269 6769 6e61 6c3d 5472  .....original=Tr
+000434f0: 7565 0d0a 0909 656c 7365 3a0d 0a09 0909  ue....else:.....
+00043500: 6f72 6967 696e 616c 3d46 616c 7365 0d0a  original=False..
+00043510: 0909 6966 206f 7269 6769 6e61 6c3a 0d0a  ..if original:..
+00043520: 0909 0974 656d 705f 6473 203d 2046 6978  ...temp_ds = Fix
+00043530: 5f43 6869 7270 2864 732c 2063 6d61 7020  _Chirp(ds, cmap 
+00043540: 3d20 636d 6170 2c20 7361 7665 5f66 696c  = cmap, save_fil
+00043550: 6520 3d20 4e6f 6e65 2c20 696e 7465 6e73  e = None, intens
+00043560: 6974 795f 7261 6e67 6520 3d20 7365 6c66  ity_range = self
+00043570: 2e69 6e74 656e 7369 7479 5f72 616e 6765  .intensity_range
+00043580: 2c20 0d0a 0909 0909 0909 0909 7761 7665  , ..........wave
+00043590: 5f6e 6d5f 6269 6e20 3d20 3130 2c20 7368  _nm_bin = 10, sh
+000435a0: 6f77 6e5f 7769 6e64 6f77 203d 2073 686f  own_window = sho
+000435b0: 776e 5f77 696e 646f 772c 2066 696c 656e  wn_window, filen
+000435c0: 616d 6520 3d20 7365 6c66 2e66 696c 656e  ame = self.filen
+000435d0: 616d 652c 200d 0a09 0909 0909 0909 0973  ame, ..........s
+000435e0: 6361 7474 6572 6375 7420 3d20 7365 6c66  cattercut = self
+000435f0: 2e73 6361 7474 6572 6375 742c 2062 6f72  .scattercut, bor
+00043600: 6465 7263 7574 203d 2073 656c 662e 626f  dercut = self.bo
+00043610: 7264 6572 6375 742c 200d 0a09 0909 0909  rdercut, .......
+00043620: 0909 0970 6174 6820 3d20 6368 6563 6b5f  ...path = check_
+00043630: 666f 6c64 6572 2870 6174 6820 3d20 7061  folder(path = pa
+00043640: 7468 2c20 6375 7272 656e 745f 7061 7468  th, current_path
+00043650: 203d 2073 656c 662e 7061 7468 292c 206d   = self.path), m
+00043660: 6178 5f70 6f69 6e74 7320 3d20 6d61 785f  ax_points = max_
+00043670: 706f 696e 7473 290d 0a09 0965 6c73 653a  points)....else:
+00043680: 0d0a 0909 0974 656d 705f 6473 203d 2046  .....temp_ds = F
+00043690: 6978 5f43 6869 7270 2864 732c 2063 6d61  ix_Chirp(ds, cma
+000436a0: 7020 3d20 636d 6170 2c20 7361 7665 5f66  p = cmap, save_f
+000436b0: 696c 6520 3d20 4e6f 6e65 2c20 696e 7465  ile = None, inte
+000436c0: 6e73 6974 795f 7261 6e67 6520 3d20 7365  nsity_range = se
+000436d0: 6c66 2e69 6e74 656e 7369 7479 5f72 616e  lf.intensity_ran
+000436e0: 6765 2c20 0d0a 0909 0909 0909 0909 7761  ge, ..........wa
+000436f0: 7665 5f6e 6d5f 6269 6e20 3d20 3130 2c20  ve_nm_bin = 10, 
+00043700: 7368 6f77 6e5f 7769 6e64 6f77 203d 2073  shown_window = s
+00043710: 686f 776e 5f77 696e 646f 772c 2066 696c  hown_window, fil
+00043720: 656e 616d 6520 3d20 7365 6c66 2e66 696c  ename = self.fil
+00043730: 656e 616d 652b 275f 7365 636f 6e64 5f63  ename+'_second_c
+00043740: 6869 7270 272c 200d 0a09 0909 0909 0909  hirp', .........
+00043750: 0973 6361 7474 6572 6375 7420 3d20 7365  .scattercut = se
+00043760: 6c66 2e73 6361 7474 6572 6375 742c 2062  lf.scattercut, b
+00043770: 6f72 6465 7263 7574 203d 2073 656c 662e  ordercut = self.
+00043780: 626f 7264 6572 6375 742c 200d 0a09 0909  bordercut, .....
+00043790: 0909 0909 0970 6174 6820 3d20 6368 6563  .....path = chec
+000437a0: 6b5f 666f 6c64 6572 2870 6174 6820 3d20  k_folder(path = 
+000437b0: 7061 7468 2c20 6375 7272 656e 745f 7061  path, current_pa
+000437c0: 7468 203d 2073 656c 662e 7061 7468 292c  th = self.path),
+000437d0: 206d 6178 5f70 6f69 6e74 7320 3d20 6d61   max_points = ma
+000437e0: 785f 706f 696e 7473 290d 0a09 0969 6620  x_points)....if 
+000437f0: 6973 696e 7374 616e 6365 2874 656d 705f  isinstance(temp_
+00043800: 6473 2c70 616e 6461 732e 4461 7461 4672  ds,pandas.DataFr
+00043810: 616d 6529 3a0d 0a09 0909 7365 6c66 2e64  ame):.....self.d
+00043820: 733d 7465 6d70 5f64 730d 0a09 0909 7365  s=temp_ds.....se
+00043830: 6c66 2e63 6869 7270 5f66 696c 653d 7365  lf.chirp_file=se
+00043840: 6c66 2e66 696c 656e 616d 652e 7370 6c69  lf.filename.spli
+00043850: 7428 272e 2729 5b30 5d20 2b20 275f 6368  t('.')[0] + '_ch
+00043860: 6972 702e 6461 7427 0d0a 0909 0969 6620  irp.dat'.....if 
+00043870: 6f72 6967 696e 616c 3a23 7765 2068 6176  original:#we hav
+00043880: 6520 7275 6e20 6672 6f6d 2073 6372 6174  e run from scrat
+00043890: 6368 0d0a 0909 0909 7365 6c66 2e43 6f72  ch......self.Cor
+000438a0: 5f43 6869 7270 2870 6174 683d 7061 7468  _Chirp(path=path
+000438b0: 290d 0a09 0909 656c 7365 3a0d 0a09 0909  ).....else:.....
+000438c0: 0970 7269 6e74 2827 796f 7520 7072 6f76  .print('you prov
+000438d0: 6964 6564 2061 2073 6570 6172 6174 6520  ided a separate 
+000438e0: 6473 2066 696c 652e 2072 6574 7572 6e65  ds file. returne
+000438f0: 6420 6172 6520 7468 6520 6e65 7720 6669  d are the new fi
+00043900: 7463 6f65 6666 2061 6e64 2074 6865 2063  tcoeff and the c
+00043910: 6f6d 6269 6e65 6420 6669 7463 6f65 6666  ombined fitcoeff
+00043920: 2c20 7461 2061 6c73 6f20 6861 7320 6120  , ta also has a 
+00043930: 6e65 7720 7661 7269 6162 6c65 2063 616c  new variable cal
+00043940: 6c65 6420 7461 2e63 6f6d 6269 6e65 645f  led ta.combined_
+00043950: 6669 7463 6f65 6666 2729 0d0a 0909 0909  fitcoeff')......
+00043960: 7361 7665 5f66 696c 653d 6368 6563 6b5f  save_file=check_
+00043970: 666f 6c64 6572 2870 6174 683d 7061 7468  folder(path=path
+00043980: 2c63 7572 7265 6e74 5f70 6174 6820 3d20  ,current_path = 
+00043990: 7365 6c66 2e70 6174 682c 2066 696c 656e  self.path, filen
+000439a0: 616d 653d 7365 6c66 2e66 696c 656e 616d  ame=self.filenam
+000439b0: 652b 275f 7365 636f 6e64 5f63 6869 7270  e+'_second_chirp
+000439c0: 2729 0d0a 0909 0909 7769 7468 206f 7065  ')......with ope
+000439d0: 6e28 7361 7665 5f66 696c 652c 2772 2729  n(save_file,'r')
+000439e0: 2061 7320 663a 0d0a 0909 0909 096e 6577   as f:.......new
+000439f0: 5f66 6974 636f 6566 663d 662e 7265 6164  _fitcoeff=f.read
+00043a00: 6c69 6e65 2829 0d0a 0909 0909 6e65 775f  line()......new_
+00043a10: 6669 7463 6f65 6666 3d6e 702e 6172 7261  fitcoeff=np.arra
+00043a20: 7928 6e65 775f 6669 7463 6f65 6666 2e73  y(new_fitcoeff.s
+00043a30: 706c 6974 2827 2c27 292c 6474 7970 653d  plit(','),dtype=
+00043a40: 2766 6c6f 6174 2729 0d0a 0909 0909 7365  'float')......se
+00043a50: 6c66 2e63 6f6d 6269 6e65 645f 6669 7463  lf.combined_fitc
+00043a60: 6f65 6666 3d73 656c 662e 6669 7463 6f65  oeff=self.fitcoe
+00043a70: 6666 2b6e 6577 5f66 6974 636f 6566 660d  ff+new_fitcoeff.
+00043a80: 0a09 0909 0972 6574 7572 6e20 6e65 775f  .....return new_
+00043a90: 6669 7463 6f65 6666 2c73 656c 662e 636f  fitcoeff,self.co
+00043aa0: 6d62 696e 6564 5f66 6974 636f 6566 660d  mbined_fitcoeff.
+00043ab0: 0a09 0965 6c73 653a 0d0a 0909 0972 6169  ...else:.....rai
+00043ac0: 7365 2057 6172 6e69 6e67 2827 4d61 6e20  se Warning('Man 
+00043ad0: 4368 6972 7020 696e 7465 7272 7570 7465  Chirp interrupte
+00043ae0: 6427 290d 0a0d 0a0d 0a09 6465 6620 436f  d').......def Co
+00043af0: 725f 4368 6972 7028 7365 6c66 2c20 6368  r_Chirp(self, ch
+00043b00: 6972 705f 6669 6c65 203d 204e 6f6e 652c  irp_file = None,
+00043b10: 2070 6174 6820 3d20 4e6f 6e65 2c20 7368   path = None, sh
+00043b20: 6f77 6e5f 7769 6e64 6f77 203d 205b 2d31  own_window = [-1
+00043b30: 2c20 315d 2c20 6669 7463 6f65 6666 203d  , 1], fitcoeff =
+00043b40: 204e 6f6e 652c 206d 6178 5f70 6f69 6e74   None, max_point
+00043b50: 7320 3d20 3430 2c20 636d 6170 203d 2063  s = 40, cmap = c
+00043b60: 6d2e 7072 6973 6d29 3a0d 0a09 0927 2727  m.prism):....'''
+00043b70: 2a43 6f72 5f43 6869 7270 2a20 6973 2061  *Cor_Chirp* is a
+00043b80: 2070 6f77 6572 6675 6c20 4675 6e63 7469   powerful Functi
+00043b90: 6f6e 2074 6f20 636f 7272 6563 7420 666f  on to correct fo
+00043ba0: 7220 6120 6469 6666 6572 656e 7420 6172  r a different ar
+00043bb0: 7269 7661 6c20 7469 6d65 7320 6f66 200d  rival times of .
+00043bc0: 0a09 0964 6966 6665 7265 6e74 2077 6176  ...different wav
+00043bd0: 656c 656e 6774 6820 2873 6f6d 6574 696d  elength (sometim
+00043be0: 6573 2063 616c 6c20 6368 6972 7029 2e20  es call chirp). 
+00043bf0: 0d0a 0909 496e 2067 656e 6572 616c 2069  ....In general i
+00043c00: 6620 6120 6669 6c65 2069 7320 6f70 656e  f a file is open
+00043c10: 6564 2066 6f72 2074 6865 2066 6972 7374  ed for the first
+00043c20: 2074 696d 6520 7468 6973 2066 756e 6374   time this funct
+00043c30: 696f 6e20 6973 206f 7065 6e69 6e67 200d  ion is opening .
+00043c40: 0a09 0961 2070 6c6f 7420 616e 6420 616c  ...a plot and al
+00043c50: 6c6f 7773 2074 6865 2075 7365 7220 746f  lows the user to
+00043c60: 2073 656c 6563 7420 6120 6e75 6d62 6572   select a number
+00043c70: 206f 6620 706f 696e 7473 2c20 7768 6963   of points, whic
+00043c80: 6820 6172 6520 7468 656e 200d 0a09 0961  h are then ....a
+00043c90: 7070 726f 7869 6d61 7465 6420 7769 7468  pproximated with
+00043ca0: 2061 2034 7468 206f 7264 6572 2070 6f6c   a 4th order pol
+00043cb0: 796e 6f6d 6961 6c20 616e 6420 6669 6e61  ynomial and fina
+00043cc0: 6c6c 7920 746f 2073 656c 6563 7420 6120  lly to select a 
+00043cd0: 706f 696e 7420 0d0a 0909 7468 6174 2069  point ....that i
+00043ce0: 7320 6465 636c 6172 6564 2061 7320 7469  s declared as ti
+00043cf0: 6d65 207a 6572 6f2e 2054 6865 206f 6273  me zero. The obs
+00043d00: 6572 7665 6420 7769 6e64 6f77 2061 7320  erved window as 
+00043d10: 7765 6c6c 2061 7320 7468 6520 696e 7465  well as the inte
+00043d20: 6e73 6974 6965 7320 0d0a 0909 616e 6420  nsities ....and 
+00043d30: 7468 6520 636f 6c6f 7572 206d 6170 2063  the colour map c
+00043d40: 616e 2062 6520 6368 6f73 656e 2074 6f20  an be chosen to 
+00043d50: 656e 6162 6c65 2061 2067 6f6f 6420 636f  enable a good co
+00043d60: 7272 6563 7469 6f6e 2e20 4865 7265 2061  rrection. Here a
+00043d70: 2066 6173 7420 0d0a 0909 6974 6572 6174   fast ....iterat
+00043d80: 696e 6720 636f 6c6f 7572 2073 6368 656d  ing colour schem
+00043d90: 6520 7375 6368 2061 7320 2270 7269 736d  e such as "prism
+00043da0: 2220 6973 206f 6674 656e 2061 2067 6f6f  " is often a goo
+00043db0: 6420 6368 6f69 6365 2e20 496e 2061 6c6c  d choice. In all
+00043dc0: 206f 6620 7468 6520 0d0a 0909 7365 6c65   of the ....sele
+00043dd0: 6374 696f 6e73 2061 206c 6566 7420 636c  ctions a left cl
+00043de0: 6963 6b20 7365 6c65 6374 732c 2061 2072  ick selects, a r
+00043df0: 6967 6874 2063 6c69 636b 2072 656d 6f76  ight click remov
+00043e00: 6573 2074 6865 206c 6173 7420 706f 696e  es the last poin
+00043e10: 7420 616e 6420 0d0a 0909 6120 6d69 6464  t and ....a midd
+00043e20: 6c65 2063 6c69 636b 2028 736f 6d65 7469  le click (someti
+00043e30: 6d65 2061 7070 7265 7669 6174 6564 2062  me appreviated b
+00043e40: 7920 636c 6963 6b69 6e67 206c 6566 7420  y clicking left 
+00043e50: 616e 6420 7269 6768 7420 746f 6765 7468  and right togeth
+00043e60: 6572 2920 0d0a 0909 6669 6e69 7368 6573  er) ....finishes
+00043e70: 2074 6865 2073 656c 6563 7469 6f6e 2e20   the selection. 
+00043e80: 4966 206e 6f20 6d69 6464 6c65 2063 6c69  If no middle cli
+00043e90: 636b 2065 7869 7374 732c 2074 6865 2070  ck exists, the p
+00043ea0: 726f 6365 7373 0d0a 0909 6175 746f 6d61  rocess....automa
+00043eb0: 7469 6361 6c6c 7920 656e 6473 2061 6674  tically ends aft
+00043ec0: 6572 206d 6178 5f70 6f69 6e74 7320 2834  er max_points (4
+00043ed0: 3020 7072 6573 6574 292e 0d0a 0909 0d0a  0 preset).......
+00043ee0: 0909 5468 6520 6669 7273 7420 6f70 7469  ..The first opti
+00043ef0: 6f6e 2061 6c6c 6f77 7320 746f 2066 696e  on allows to fin
+00043f00: 6520 7365 6c65 6374 2061 6e20 696e 7465  e select an inte
+00043f10: 6e73 6974 7920 7365 7474 696e 6720 666f  nsity setting fo
+00043f20: 7220 7468 6973 2063 6869 7270 2063 6f72  r this chirp cor
+00043f30: 7265 6374 696f 6e2e 0d0a 0909 486f 7765  rection.....Howe
+00043f40: 7665 7220 736f 6d65 7469 6d65 7320 7370  ver sometimes sp
+00043f50: 696b 6573 2061 7265 206d 616b 696e 6720  ikes are making 
+00043f60: 7468 6973 2074 6869 6e67 7320 6469 6666  this things diff
+00043f70: 6963 756c 742e 200d 0a09 0949 6e20 7468  icult. ....In th
+00043f80: 6973 2063 6173 6520 7365 7420 6120 6775  is case set a gu
+00043f90: 6573 7365 6420 696e 7465 6e73 6974 7920  essed intensity 
+00043fa0: 7769 7468 2073 656c 662e 696e 7465 6e73  with self.intens
+00043fb0: 6974 795f 7261 6e67 653d 3165 2d33 5c6e  ity_range=1e-3\n
+00043fc0: 200d 0a09 094e 6f74 6520 7468 6174 2073   ....Note that s
+00043fd0: 6361 7474 6572 6375 742c 2062 6f72 6465  cattercut, borde
+00043fe0: 7263 7574 2061 6e64 2069 6e74 656e 7369  rcut and intensi
+00043ff0: 7479 5f72 616e 6765 2063 616e 2062 6520  ty_range can be 
+00044000: 7573 6564 0d0a 0d0a 0909 4166 7465 7220  used......After 
+00044010: 7468 6520 6669 7273 7420 7275 6e20 7468  the first run th
+00044020: 6520 706f 6c79 6e6f 6d20 6973 2073 746f  e polynom is sto
+00044030: 7265 6420 696e 2073 656c 662e 6669 7463  red in self.fitc
+00044040: 6f65 6666 2c20 6120 6e65 7720 6d61 7472  oeff, a new matr
+00044050: 6978 200d 0a09 0963 616c 6375 6c61 7465  ix ....calculate
+00044060: 6420 6672 6f6d 2073 656c 662e 6473 5f6f  d from self.ds_o
+00044070: 7269 2074 6861 7420 6973 2073 746f 7265  ri that is store
+00044080: 6420 6173 2073 656c 662e 6473 2061 6e64  d as self.ds and
+00044090: 2061 2066 696c 6520 7374 6f72 6564 2069   a file stored i
+000440a0: 6e20 7468 6520 0d0a 0909 7361 6d65 206c  n the ....same l
+000440b0: 6f63 6174 696f 6e20 6173 2074 6865 206f  ocation as the o
+000440c0: 7269 6769 6e61 6c20 6461 7461 2e20 5468  riginal data. Th
+000440d0: 6520 7365 636f 6e64 2074 696d 6520 7468  e second time th
+000440e0: 6520 6675 6e63 7469 6f6e 202a 436f 725f  e function *Cor_
+000440f0: 4368 6972 702a 2069 7320 0d0a 0909 7275  Chirp* is ....ru
+00044100: 6e20 7468 6520 6675 6e63 7469 6f6e 2077  n the function w
+00044110: 696c 6c20 6669 6e64 2074 6865 2066 696c  ill find the fil
+00044120: 6520 616e 6420 6170 706c 7920 7468 6520  e and apply the 
+00044130: 6368 6972 7020 636f 7272 6563 7469 6f6e  chirp correction
+00044140: 2061 7574 6f6d 6174 6963 616c 6c79 2e0d   automatically..
+00044150: 0a0d 0a09 0949 6620 6f6e 6520 646f 6573  .....If one does
+00044160: 2077 616e 7420 746f 2072 652d 7275 6e20   want to re-run 
+00044170: 7468 6520 6368 6972 7020 636f 7272 6563  the chirp correc
+00044180: 7469 6f6e 2074 6865 2066 756e 6374 696f  tion the functio
+00044190: 6e20 2a4d 616e 5f43 6869 7270 2a20 646f  n *Man_Chirp* do
+000441a0: 6573 0d0a 0909 6e6f 7420 6c6f 6f6b 2066  es....not look f
+000441b0: 6f72 2074 6869 7320 6669 6c65 2c20 6275  or this file, bu
+000441c0: 7420 6372 6561 7465 7320 6166 7465 7220  t creates after 
+000441d0: 6669 6e69 7368 696e 6720 6120 6e65 7720  finishing a new 
+000441e0: 6669 6c65 2e0d 0a0d 0a09 0941 6c74 6572  file.......Alter
+000441f0: 6e61 7469 7665 6c79 2074 6865 2070 6f6c  natively the pol
+00044200: 796e 6f6d 206f 7220 6120 6669 6c65 6e61  ynom or a filena
+00044210: 6d65 2063 616e 2062 6520 6769 7665 6e20  me can be given 
+00044220: 7468 6174 206c 6f61 6420 6120 6368 6972  that load a chir
+00044230: 7020 636f 7272 6563 7469 6f6e 0d0a 0909  p correction....
+00044240: 2865 2e67 2e20 6672 6f6d 2061 2064 6966  (e.g. from a dif
+00044250: 6665 7265 6e74 2072 756e 2077 6974 6820  ferent run with 
+00044260: 7468 6520 7361 6d65 2073 616d 706c 6529  the same sample)
+00044270: 2e0d 0a09 0954 6865 2066 756e 6374 696f  .....The functio
+00044280: 6e20 2a43 6f72 5f43 6869 7270 2a20 7365  n *Cor_Chirp* se
+00044290: 6c65 6374 7320 696e 2074 6865 206f 7264  lects in the ord
+000442a0: 6572 3a20 0d0a 0d0a 0909 2320 2266 6974  er: ......# "fit
+000442b0: 636f 6566 6622 0d0a 0909 2320 226f 7468  coeff"....# "oth
+000442c0: 6572 2066 696c 6573 220d 0a09 0923 2022  er files"....# "
+000442d0: 7374 6f72 6564 5f66 696c 6522 0d0a 0909  stored_file"....
+000442e0: 2320 6361 6c6c 204d 616e 5f43 6869 7270  # call Man_Chirp
+000442f0: 2028 636c 6963 6b69 6e67 2062 7920 6861   (clicking by ha
+00044300: 6e64 290d 0a09 090d 0a0d 0a09 090d 0a09  nd).............
+00044310: 0950 6172 616d 6574 6572 730d 0a09 092d  .Parameters....-
+00044320: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 0909  ------------....
+00044330: 0d0a 0909 6368 6972 702d 6669 6c65 203a  ....chirp-file :
+00044340: 204e 6f6e 6520 6f72 2073 7472 2c20 6f70   None or str, op
+00044350: 7469 6f6e 616c 0d0a 0909 2020 2049 6620  tional....   If 
+00044360: 6120 7261 7720 6669 6c65 2077 6173 2072  a raw file was r
+00044370: 6561 6428 652e 672e 2022 6461 7461 2e53  ead(e.g. "data.S
+00044380: 4941 2229 2061 6e64 2074 6865 2063 6869  IA") and the chi
+00044390: 7270 2063 6f72 7265 6374 696f 6e20 7761  rp correction wa
+000443a0: 730d 0a09 0920 2020 636f 6d70 6c65 7465  s....   complete
+000443b0: 642c 2061 2066 696c 6520 7769 7468 2074  d, a file with t
+000443c0: 6865 2061 7474 6163 6865 6420 776f 7264  he attached word
+000443d0: 2022 6368 6972 7022 2069 7320 6372 6561   "chirp" is crea
+000443e0: 7465 6420 616e 640d 0a09 0920 2020 7374  ted and....   st
+000443f0: 6f72 6564 2069 6e20 7468 6520 7361 6d65  ored in the same
+00044400: 206c 6f63 6174 696f 6e2e 2028 2264 6174   location. ("dat
+00044410: 615f 6368 6972 702e 6461 7422 2920 5468  a_chirp.dat") Th
+00044420: 6973 2066 696c 6520 636f 6e74 6169 6e73  is file contains
+00044430: 0d0a 0909 2020 2074 6865 2035 2076 616c  ....   the 5 val
+00044440: 7565 7320 6f66 2074 6865 2063 6869 7270  ues of the chirp
+00044450: 2063 6f72 7265 6374 696f 6e2e 2042 7920   correction. By 
+00044460: 7365 6c65 6374 696e 6720 7375 6368 2061  selecting such a
+00044470: 2066 696c 650d 0a09 0920 2020 2865 2e67   file....   (e.g
+00044480: 2ec2 a066 726f 6d20 616e 6f74 6865 7220  ...from another 
+00044490: 7261 7720 6461 7461 2920 6120 7370 6563  raw data) a spec
+000444a0: 6966 6963 2063 6869 7270 2069 7320 6170  ific chirp is ap
+000444b0: 706c 6965 642e 2049 6620 610d 0a09 0920  plied. If a.... 
+000444c0: 2020 7370 6563 6966 6963 206e 616d 6520    specific name 
+000444d0: 6973 2067 6976 656e 2077 6974 6820 2a2a  is given with **
+000444e0: 6368 6972 705f 6669 6c65 2a2a 2028 616e  chirp_file** (an
+000444f0: 6420 6f70 7469 6f6e 616c 202a 2a70 6174  d optional **pat
+00044500: 682a 2a29 0d0a 0909 2020 2074 6865 6e20  h**)....   then 
+00044510: 7468 6973 2066 696c 6520 6973 2075 7365  this file is use
+00044520: 642e 5c6e 0d0a 0909 2020 2047 5549 5c6e  d.\n....   GUI\n
+00044530: 0d0a 0909 2020 2054 6865 2077 6f72 6420  ....   The word 
+00044540: 2a27 6775 6927 2a20 6361 6e20 6265 2075  *'gui'* can be u
+00044550: 7365 6420 696e 7374 6561 6420 6f66 2061  sed instead of a
+00044560: 2066 696c 656e 616d 6520 746f 206f 7065   filename to ope
+00044570: 6e20 6120 6775 6920 7468 6174 0d0a 0909  n a gui that....
+00044580: 2020 2061 6c6c 6f77 7320 7468 6520 7365     allows the se
+00044590: 6c65 6374 696f 6e20 6f66 2061 2063 6872  lection of a chr
+000445a0: 6970 2066 696c 650d 0a09 0920 2020 0d0a  ip file....   ..
+000445b0: 0909 7061 7468 203a 2073 7472 206f 7220  ..path : str or 
+000445c0: 7061 7468 206f 626a 6563 7420 286f 7074  path object (opt
+000445d0: 696f 6e61 6c29 0d0a 0909 0969 6620 7061  ional).....if pa
+000445e0: 7468 2069 7320 6120 7374 7269 6e67 2077  th is a string w
+000445f0: 6974 686f 7574 2074 6865 206f 7065 7261  ithout the opera
+00044600: 7469 6f6e 2073 7973 7465 6d20 6465 7065  tion system depe
+00044610: 6e64 656e 7420 7365 7061 7261 746f 722c  ndent separator,
+00044620: 2069 7420 6973 2074 7265 6174 6564 2061   it is treated a
+00044630: 7320 6120 7265 6c61 7469 7665 2070 6174  s a relative pat
+00044640: 682c 200d 0a09 0909 652e 672e 2064 6174  h, .....e.g. dat
+00044650: 6120 7769 6c6c 206c 6f6f 6b20 6672 6f6d  a will look from
+00044660: 2074 6865 2077 6f72 6b69 6e67 2064 6972   the working dir
+00044670: 6563 746f 7279 2069 6e20 7468 6520 7375  ectory in the su
+00044680: 6220 6469 7265 6374 6f72 2064 6174 612e  b director data.
+00044690: 204f 7468 6572 7769 7365 2074 6869 7320   Otherwise this 
+000446a0: 6861 7320 746f 2062 6520 6120 0d0a 0909  has to be a ....
+000446b0: 0966 756c 6c20 7061 7468 2069 6e20 6569  .full path in ei
+000446c0: 7468 6572 2073 7472 6f6e 6720 6f72 2070  ther strong or p
+000446d0: 6174 6820 6f62 6a65 6374 2066 6f72 6d2e  ath object form.
+000446e0: 0d0a 0909 0d0a 0909 7368 6f77 6e5f 7769  ........shown_wi
+000446f0: 6e64 6f77 203a 206c 6973 7420 2877 6974  ndow : list (wit
+00044700: 6820 7477 6f20 666c 6f61 7473 292c 206f  h two floats), o
+00044710: 7074 696f 6e61 6c0d 0a09 0909 4465 6669  ptional.....Defi
+00044720: 6e65 7320 7468 6520 7769 6e64 6f77 2074  nes the window t
+00044730: 6861 7420 6973 2073 686f 776e 2064 7572  hat is shown dur
+00044740: 696e 6720 6368 6972 7020 636f 7272 6563  ing chirp correc
+00044750: 7469 6f6e 2e20 4966 2074 6865 2074 3d30  tion. If the t=0
+00044760: 2069 7320 6e6f 7420 7669 7369 626c 652c   is not visible,
+00044770: 2061 646a 7573 7420 7468 6973 2070 6172   adjust this par
+00044780: 616d 6574 6572 0d0a 0909 0974 6f20 7375  ameter.....to su
+00044790: 6974 2074 6865 2065 7870 6572 696d 656e  it the experimen
+000447a0: 742e 2049 6620 7072 6f62 6c65 6d73 2061  t. If problems a
+000447b0: 7269 7365 2c20 4920 7265 636f 6d6d 656e  rise, I recommen
+000447c0: 7420 746f 2075 7365 2050 6c6f 745f 5261  t to use Plot_Ra
+000447d0: 7720 746f 2063 6865 636b 2077 6865 7265  w to check where
+000447e0: 2074 3d30 2069 7320 6c6f 6361 7465 640d   t=0 is located.
+000447f0: 0a09 0909 0d0a 0909 6669 7463 6f65 6666  ........fitcoeff
+00044800: 203a 206c 6973 7420 6f72 2076 6563 746f   : list or vecto
+00044810: 7220 2835 2066 6c6f 6174 7329 2c20 6f70  r (5 floats), op
+00044820: 7469 6f6e 616c 0d0a 0909 094f 6e65 2063  tional.....One c
+00044830: 616e 2067 6976 6520 6120 7665 6374 6f72  an give a vector
+00044840: 2f6c 6973 7420 7769 7468 2035 206e 756d  /list with 5 num
+00044850: 6265 7273 2072 6570 7265 7365 6e74 696e  bers representin
+00044860: 6720 7468 6520 7061 7261 6d65 7465 720d  g the parameter.
+00044870: 0a09 0909 6f66 2061 2034 7468 206f 7264  ....of a 4th ord
+00044880: 6572 2070 6f6c 796e 6f6d 6961 6c20 2869  er polynomial (i
+00044890: 6e20 7468 6520 6f72 6465 720d 0a09 0909  n the order.....
+000448a0: 3a6d 6174 683a 6028 6134 2a78 5e34 202b  :math:`(a4*x^4 +
+000448b0: 2061 332a 785e 332b 6132 2a78 5e32 2b61   a3*x^3+a2*x^2+a
+000448c0: 312a 7831 2b61 3029 602e 2054 6865 2063  1*x1+a0)`. The c
+000448d0: 6869 7270 2070 6172 616d 6574 6572 2061  hirp parameter a
+000448e0: 7265 0d0a 0909 0973 746f 7265 6420 696e  re.....stored in
+000448f0: 2074 612e 6669 7463 6f65 6666 2061 6e64   ta.fitcoeff and
+00044900: 2063 616e 2074 6875 7320 6265 2075 7365   can thus be use
+00044910: 6420 696e 206f 7468 6572 2054 4120 6f62  d in other TA ob
+00044920: 6a65 6374 732e 2054 6869 730d 0a09 0909  jects. This.....
+00044930: 7665 6374 6f72 2069 7320 616c 736f 2073  vector is also s
+00044940: 746f 7265 6420 7769 7468 2074 6865 2066  tored with the f
+00044950: 696c 6520 616e 6420 6175 746f 6d61 7469  ile and automati
+00044960: 6361 6c6c 7920 6170 706c 6965 6420 6475  cally applied du
+00044970: 7269 6e67 0d0a 0909 0972 652d 6c6f 6164  ring.....re-load
+00044980: 696e 6720 6f66 2061 2068 6466 352d 6f62  ing of a hdf5-ob
+00044990: 6a65 6374 0d0a 0d0a 0909 6d61 785f 706f  ject......max_po
+000449a0: 696e 7473 203a 2069 6e74 2c20 6f70 7469  ints : int, opti
+000449b0: 6f6e 616c 0d0a 0909 0944 6566 6175 6c74  onal.....Default
+000449c0: 203d 2034 3020 6d61 7820 6e75 6d62 6572   = 40 max number
+000449d0: 7320 6f66 2070 6f69 6e74 7320 746f 2075  s of points to u
+000449e0: 7365 2069 6e20 4775 6920 7365 6c65 6374  se in Gui select
+000449f0: 696f 6e2e 2055 7365 6675 6c20 6f70 7469  ion. Useful opti
+00044a00: 6f6e 2069 6e20 6361 7365 206e 6f20 6d69  on in case no mi
+00044a10: 6464 6c65 206d 6f75 7365 2062 7574 746f  ddle mouse butto
+00044a20: 6e0d 0a09 0909 6973 2061 7661 696c 6162  n.....is availab
+00044a30: 6c65 2e20 2865 2e67 2e20 746f 7563 6870  le. (e.g. touchp
+00044a40: 6164 290d 0a09 090d 0a09 0963 6d61 7020  ad)........cmap 
+00044a50: 3a20 6d61 7470 6c6f 746c 6962 2063 6f6c  : matplotlib col
+00044a60: 6f75 726d 6170 2c20 6f70 7469 6f6e 616c  ourmap, optional
+00044a70: 0d0a 0909 0943 6f6c 6f75 726d 6170 2074  .....Colourmap t
+00044a80: 6f20 6265 2075 7365 6420 666f 7220 7468  o be used for th
+00044a90: 6520 6368 6972 7020 636f 7272 6563 7469  e chirp correcti
+00044aa0: 6f6e 2e20 5768 696c 6520 7468 6572 6520  on. While there 
+00044ab0: 6973 2061 206c 6172 6765 2073 656c 6563  is a large selec
+00044ac0: 7469 6f6e 2068 6572 6520 4920 7265 636f  tion here I reco
+00044ad0: 6d6d 656e 6420 746f 2063 686f 6f73 650d  mmend to choose.
+00044ae0: 0a09 0909 6120 6469 6666 6572 656e 7420  ....a different 
+00044af0: 6d61 7020 7468 616e 2069 7320 7573 6564  map than is used
+00044b00: 2066 6f72 2074 6865 206e 6f72 6d61 6c20   for the normal 
+00044b10: 3264 2070 6c6f 7474 696e 672e 5c6e 0d0a  2d plotting.\n..
+00044b20: 0909 0963 6d2e 7072 6973 6d20 2844 6566  ...cm.prism (Def
+00044b30: 6175 6c74 2920 6861 7320 7072 6f6f 6665  ault) has proofe
+00044b40: 6e20 746f 2062 6520 7665 7279 2075 7365  n to be very use
+00044b50: 6675 6c6c 0d0a 0d0a 0909 4578 616d 706c  full......Exampl
+00044b60: 6573 0d0a 0909 2d2d 2d2d 2d2d 2d2d 2d2d  es....----------
+00044b70: 0d0a 0909 0d0a 0909 496e 206d 6f73 7420  ........In most 
+00044b80: 6361 7365 733a 0d0a 0909 0d0a 0909 3e3e  cases:........>>
+00044b90: 3e20 696d 706f 7274 2070 6c6f 745f 6675  > import plot_fu
+00044ba0: 6e63 2061 7320 7066 0d0a 0909 3e3e 3e20  nc as pf....>>> 
+00044bb0: 7461 203d 2070 662e 5441 2827 7465 7374  ta = pf.TA('test
+00044bc0: 312e 5349 4127 2920 236f 7065 6e20 7468  1.SIA') #open th
+00044bd0: 6520 6f72 6967 696e 616c 2070 726f 6a65  e original proje
+00044be0: 6374 2c20 0d0a 0909 3e3e 3e20 7461 2e43  ct, ....>>> ta.C
+00044bf0: 6f72 5f43 6869 7270 2829 0d0a 0909 0d0a  or_Chirp()......
+00044c00: 0909 5365 6c65 6374 696e 6720 6120 7370  ..Selecting a sp
+00044c10: 6563 6966 6963 2063 6f72 7265 6374 696f  ecific correctio
+00044c20: 6e0d 0a09 090d 0a09 093e 3e3e 2074 612e  n........>>> ta.
+00044c30: 436f 725f 4368 6972 7028 e280 9867 7569  Cor_Chirp(...gui
+00044c40: e280 9929 0d0a 0909 3e3e 3e20 7461 2e43  ...)....>>> ta.C
+00044c50: 6f72 5f43 6869 7270 2863 6869 7270 5f66  or_Chirp(chirp_f
+00044c60: 696c 6520 3d20 276f 6c64 6572 5f64 6174  ile = 'older_dat
+00044c70: 615f 6368 6972 702e 6461 7427 290d 0a09  a_chirp.dat')...
+00044c80: 093e 3e3e 2023 7573 6520 7468 6520 636f  .>>> #use the co
+00044c90: 6566 6669 6369 656e 7473 2066 726f 6d20  efficients from 
+00044ca0: 6120 6469 6666 6572 656e 7420 7072 6f6a  a different proj
+00044cb0: 6563 740d 0a09 093e 3e3e 2074 612e 436f  ect....>>> ta.Co
+00044cc0: 725f 4368 6972 7028 6669 7463 6f65 6666  r_Chirp(fitcoeff
+00044cd0: 203d 2074 615f 6f6c 642e 6669 7463 6f65   = ta_old.fitcoe
+00044ce0: 6666 2920 2375 7365 2074 6865 2063 6f65  ff) #use the coe
+00044cf0: 6666 6963 6965 6e74 7320 6672 6f6d 2061  fficients from a
+00044d00: 2064 6966 6665 7265 6e74 2070 726f 6a65   different proje
+00044d10: 6374 0d0a 0909 0d0a 0909 2727 270d 0a09  ct........'''...
+00044d20: 090d 0a09 0969 6620 6368 6972 705f 6669  .....if chirp_fi
+00044d30: 6c65 2069 7320 4e6f 6e65 3a0d 0a09 0909  le is None:.....
+00044d40: 6368 6972 705f 6669 6c65 3d73 656c 662e  chirp_file=self.
+00044d50: 6368 6972 705f 6669 6c65 0d0a 0909 656c  chirp_file....el
+00044d60: 6966 2027 6775 6927 2069 6e20 6368 6972  if 'gui' in chir
+00044d70: 705f 6669 6c65 3a0d 0a09 0909 726f 6f74  p_file:.....root
+00044d80: 5f77 696e 646f 7720 3d20 746b 696e 7465  _window = tkinte
+00044d90: 722e 546b 2829 0d0a 0909 0972 6f6f 745f  r.Tk().....root_
+00044da0: 7769 6e64 6f77 2e77 6974 6864 7261 7728  window.withdraw(
+00044db0: 290d 0a09 0909 726f 6f74 5f77 696e 646f  ).....root_windo
+00044dc0: 772e 6174 7472 6962 7574 6573 2827 2d74  w.attributes('-t
+00044dd0: 6f70 6d6f 7374 272c 5472 7565 290d 0a09  opmost',True)...
+00044de0: 0909 726f 6f74 5f77 696e 646f 772e 6166  ..root_window.af
+00044df0: 7465 7228 3130 3030 2c20 6c61 6d62 6461  ter(1000, lambda
+00044e00: 3a20 726f 6f74 5f77 696e 646f 772e 666f  : root_window.fo
+00044e10: 6375 735f 666f 7263 6528 2929 0d0a 0909  cus_force())....
+00044e20: 0963 6f6d 706c 6574 655f 7061 7468 203d  .complete_path =
+00044e30: 2066 696c 6564 6961 6c6f 672e 6173 6b6f   filedialog.asko
+00044e40: 7065 6e66 696c 656e 616d 6528 696e 6974  penfilename(init
+00044e50: 6961 6c64 6972 3d6f 732e 6765 7463 7764  ialdir=os.getcwd
+00044e60: 2829 290d 0a09 0909 6c69 7374 656e 3d6f  ()).....listen=o
+00044e70: 732e 7061 7468 2e73 706c 6974 2863 6f6d  s.path.split(com
+00044e80: 706c 6574 655f 7061 7468 290d 0a09 0909  plete_path).....
+00044e90: 7061 7468 3d6f 732e 7061 7468 2e6e 6f72  path=os.path.nor
+00044ea0: 6d70 6174 6828 6c69 7374 656e 5b30 5d29  mpath(listen[0])
+00044eb0: 0d0a 0909 0963 6869 7270 5f66 696c 653d  .....chirp_file=
+00044ec0: 6c69 7374 656e 5b31 5d0d 0a09 0970 6174  listen[1]....pat
+00044ed0: 683d 6368 6563 6b5f 666f 6c64 6572 2870  h=check_folder(p
+00044ee0: 6174 682c 7365 6c66 2e70 6174 6829 0d0a  ath,self.path)..
+00044ef0: 0909 6966 2066 6974 636f 6566 6620 6973  ..if fitcoeff is
+00044f00: 206e 6f74 204e 6f6e 653a 2377 6520 7573   not None:#we us
+00044f10: 6520 6120 7374 6f72 6564 2070 726f 6a65  e a stored proje
+00044f20: 6374 0d0a 0909 0974 7279 3a0d 0a09 0909  ct.....try:.....
+00044f30: 0969 6620 6c65 6e28 6669 7463 6f65 6666  .if len(fitcoeff
+00044f40: 293d 3d35 206f 7220 6c65 6e28 6669 7463  )==5 or len(fitc
+00044f50: 6f65 6666 293d 3d36 3a23 7765 2070 726f  oeff)==6:#we pro
+00044f60: 7669 6465 2061 2076 616c 6964 206c 6973  vide a valid lis
+00044f70: 742f 7665 6374 6f72 0d0a 0909 0909 0969  t/vector.......i
+00044f80: 6620 616c 6c28 656c 656d 203d 3d20 3020  f all(elem == 0 
+00044f90: 666f 7220 656c 656d 2069 6e20 6669 7463  for elem in fitc
+00044fa0: 6f65 6666 293a 0d0a 0909 0909 0909 7365  oeff):........se
+00044fb0: 6c66 2e64 733d 7365 6c66 2e64 735f 6f72  lf.ds=self.ds_or
+00044fc0: 690d 0a09 0909 0909 0970 7269 6e74 2827  i........print('
+00044fd0: 616c 6c20 6368 6972 7020 636f 6566 6669  all chirp coeffi
+00044fe0: 6369 656e 7473 2061 7265 207a 6572 6f20  cients are zero 
+00044ff0: 736f 206e 6f20 6368 6972 7020 636f 7272  so no chirp corr
+00045000: 6563 7469 6f6e 2061 7070 6c69 6564 2729  ection applied')
+00045010: 0d0a 0909 0909 0965 6c73 653a 090d 0a09  .......else:....
+00045020: 0909 0909 0973 656c 662e 6473 3d46 6978  .....self.ds=Fix
+00045030: 5f43 6869 7270 2873 656c 662e 6473 5f6f  _Chirp(self.ds_o
+00045040: 7269 2c66 6974 636f 6566 663d 6669 7463  ri,fitcoeff=fitc
+00045050: 6f65 6666 290d 0a09 0909 0909 7365 6c66  oeff).......self
+00045060: 2e66 6974 636f 6566 663d 6669 7463 6f65  .fitcoeff=fitcoe
+00045070: 6666 2023 7765 2063 616d 6520 746f 2068  ff #we came to h
+00045080: 6572 6520 736f 2066 6974 636f 6566 6620  ere so fitcoeff 
+00045090: 6d75 7374 2062 6520 7269 6768 740d 0a09  must be right...
+000450a0: 0909 0965 6c73 653a 0d0a 0909 0909 0972  ...else:.......r
+000450b0: 6169 7365 0d0a 0909 0965 7863 6570 743a  aise.....except:
+000450c0: 0d0a 0909 0909 7365 6c66 2e64 733d 7365  ......self.ds=se
+000450d0: 6c66 2e64 735f 6f72 690d 0a09 0920 200d  lf.ds_ori....  .
+000450e0: 0a09 0909 0970 7269 6e74 2827 736f 6d65  .....print('some
+000450f0: 7468 696e 6720 7765 6e74 2077 726f 6e67  thing went wrong
+00045100: 2077 6974 6820 7468 6520 7072 6f76 6964   with the provid
+00045110: 6564 2066 6974 636f 6566 662e 2054 6869  ed fitcoeff. Thi
+00045120: 7320 7368 6f75 6c64 2062 6520 6569 7468  s should be eith
+00045130: 6572 2061 206c 6973 742f 6172 7261 7920  er a list/array 
+00045140: 7769 7468 2035 2d36 2070 6172 616d 6574  with 5-6 paramet
+00045150: 6572 206f 7220 7468 6520 6f62 6a65 6374  er or the object
+00045160: 2073 686f 756c 6420 636f 6e74 6169 6e20   should contain 
+00045170: 7468 6520 7061 7261 6d65 7465 7227 290d  the parameter').
+00045180: 0a09 0909 0970 7269 6e74 2827 6669 7463  .....print('fitc
+00045190: 6f65 6666 2069 7320 6375 7272 656e 746c  oeff is currentl
+000451a0: 793a 2720 2b20 6669 7463 6f65 6666 290d  y:' + fitcoeff).
+000451b0: 0a09 0965 6c73 653a 0d0a 0909 0974 7279  ...else:.....try
+000451c0: 3a0d 0a09 0909 0973 656c 662e 6473 3d46  :......self.ds=F
+000451d0: 6978 5f43 6869 7270 2873 656c 662e 6473  ix_Chirp(self.ds
+000451e0: 5f6f 7269 2c63 6d61 703d 636d 6170 2c73  _ori,cmap=cmap,s
+000451f0: 6176 655f 6669 6c65 3d63 6865 636b 5f66  ave_file=check_f
+00045200: 6f6c 6465 7228 7061 7468 3d70 6174 682c  older(path=path,
+00045210: 6669 6c65 6e61 6d65 3d63 6869 7270 5f66  filename=chirp_f
+00045220: 696c 6529 2c73 6361 7474 6572 6375 743d  ile),scattercut=
+00045230: 7365 6c66 2e73 6361 7474 6572 6375 742c  self.scattercut,
+00045240: 626f 7264 6572 6375 743d 7365 6c66 2e62  bordercut=self.b
+00045250: 6f72 6465 7263 7574 2c69 6e74 656e 7369  ordercut,intensi
+00045260: 7479 5f72 616e 6765 3d73 656c 662e 696e  ty_range=self.in
+00045270: 7465 6e73 6974 795f 7261 6e67 652c 7761  tensity_range,wa
+00045280: 7665 5f6e 6d5f 6269 6e3d 3130 2c73 686f  ve_nm_bin=10,sho
+00045290: 776e 5f77 696e 646f 773d 7368 6f77 6e5f  wn_window=shown_
+000452a0: 7769 6e64 6f77 2c66 6974 636f 6566 663d  window,fitcoeff=
+000452b0: 6669 7463 6f65 6666 2c6d 6178 5f70 6f69  fitcoeff,max_poi
+000452c0: 6e74 733d 6d61 785f 706f 696e 7473 290d  nts=max_points).
+000452d0: 0a09 0909 0977 6974 6820 6f70 656e 2863  .....with open(c
+000452e0: 6865 636b 5f66 6f6c 6465 7228 7061 7468  heck_folder(path
+000452f0: 3d70 6174 682c 6669 6c65 6e61 6d65 3d63  =path,filename=c
+00045300: 6869 7270 5f66 696c 6529 2c27 7227 2920  hirp_file),'r') 
+00045310: 6173 2066 3a0d 0a09 0909 0909 7365 6c66  as f:.......self
+00045320: 2e66 6974 636f 6566 663d 5b66 6c6f 6174  .fitcoeff=[float
+00045330: 2861 2920 666f 7220 6120 696e 2066 2e72  (a) for a in f.r
+00045340: 6561 646c 696e 6528 292e 7370 6c69 7428  eadline().split(
+00045350: 272c 2729 5d0d 0a09 0909 6578 6365 7074  ',')].....except
+00045360: 3a0d 0a09 0909 0970 7269 6e74 2863 6865  :......print(che
+00045370: 636b 5f66 6f6c 6465 7228 7061 7468 3d73  ck_folder(path=s
+00045380: 656c 662e 7061 7468 2c66 696c 656e 616d  elf.path,filenam
+00045390: 653d 7365 6c66 2e66 696c 656e 616d 652e  e=self.filename.
+000453a0: 7370 6c69 7428 272e 2729 5b30 5d20 2b20  split('.')[0] + 
+000453b0: 275f 6368 6972 702e 6461 7427 2929 0d0a  '_chirp.dat'))..
+000453c0: 0909 0909 6966 206f 732e 7061 7468 2e69  ....if os.path.i
+000453d0: 7366 696c 6528 6368 6563 6b5f 666f 6c64  sfile(check_fold
+000453e0: 6572 2870 6174 683d 7365 6c66 2e70 6174  er(path=self.pat
+000453f0: 682c 6669 6c65 6e61 6d65 3d73 656c 662e  h,filename=self.
+00045400: 6669 6c65 6e61 6d65 2e73 706c 6974 2827  filename.split('
+00045410: 2e27 295b 305d 202b 2027 5f63 6869 7270  .')[0] + '_chirp
+00045420: 2e64 6174 2729 293a 0d0a 0909 0909 0970  .dat')):.......p
+00045430: 7269 6e74 2827 736f 6d65 6874 696e 6720  rint('somehting 
+00045440: 6973 2077 726f 6e67 2c20 7472 7920 6465  is wrong, try de
+00045450: 6c65 7469 6e67 206f 6c64 2063 6869 7270  leting old chirp
+00045460: 2066 696c 6527 290d 0a09 0909 0909 7261   file').......ra
+00045470: 6973 650d 0a09 0909 0965 6c73 653a 0d0a  ise......else:..
+00045480: 0909 0909 0970 7269 6e74 2827 4e6f 206f  .....print('No o
+00045490: 6c64 2063 6869 7270 2066 696c 6527 290d  ld chirp file').
+000454a0: 0a09 0909 0909 7365 6c66 2e4d 616e 5f43  ......self.Man_C
+000454b0: 6869 7270 2870 6174 683d 7061 7468 2c63  hirp(path=path,c
+000454c0: 6d61 703d 636d 6170 2c73 686f 776e 5f77  map=cmap,shown_w
+000454d0: 696e 646f 773d 7368 6f77 6e5f 7769 6e64  indow=shown_wind
+000454e0: 6f77 2c6d 6178 5f70 6f69 6e74 733d 6d61  ow,max_points=ma
+000454f0: 785f 706f 696e 7473 290d 0a09 0909 0909  x_points).......
+00045500: 6368 6972 705f 6669 6c65 3d73 656c 662e  chirp_file=self.
+00045510: 6368 6972 705f 6669 6c65 0d0a 0909 0909  chirp_file......
+00045520: 0977 6974 6820 6f70 656e 2863 6865 636b  .with open(check
+00045530: 5f66 6f6c 6465 7228 7061 7468 3d70 6174  _folder(path=pat
+00045540: 682c 6669 6c65 6e61 6d65 3d63 6869 7270  h,filename=chirp
+00045550: 5f66 696c 6529 2c27 7227 2920 6173 2066  _file),'r') as f
+00045560: 3a0d 0a09 0909 0909 0973 656c 662e 6669  :........self.fi
+00045570: 7463 6f65 6666 3d5b 666c 6f61 7428 6129  tcoeff=[float(a)
+00045580: 2066 6f72 2061 2069 6e20 662e 7265 6164   for a in f.read
+00045590: 6c69 6e65 2829 2e73 706c 6974 2827 2c27  line().split(','
+000455a0: 295d 0d0a 0909 7365 6c66 2e64 732e 636f  )]....self.ds.co
+000455b0: 6c75 6d6e 732e 6e61 6d65 3d73 656c 662e  lumns.name=self.
+000455c0: 6473 5f6f 7269 2e63 6f6c 756d 6e73 2e6e  ds_ori.columns.n
+000455d0: 616d 650d 0a09 0973 656c 662e 6473 2e69  ame....self.ds.i
+000455e0: 6e64 6578 2e6e 616d 653d 7365 6c66 2e64  ndex.name=self.d
+000455f0: 735f 6f72 692e 696e 6465 782e 6e61 6d65  s_ori.index.name
+00045600: 0d0a 0d0a 0964 6566 2050 6c6f 745f 496e  .....def Plot_In
+00045610: 7465 7261 6374 6976 6528 7365 6c66 2c20  teractive(self, 
+00045620: 6669 7474 6564 203d 2046 616c 7365 2c20  fitted = False, 
+00045630: 6473 203d 204e 6f6e 652c 2063 6d61 7020  ds = None, cmap 
+00045640: 3d20 4e6f 6e65 2c20 706c 6f74 5f6f 6e5f  = None, plot_on_
+00045650: 6d6f 7665 203d 2046 616c 7365 293a 0d0a  move = False):..
+00045660: 0909 2727 2769 6e74 6572 6163 7469 7665  ..'''interactive
+00045670: 2070 6c6f 7474 696e 6720 6675 6e63 7469   plotting functi
+00045680: 6f6e 2e20 6974 2070 6c6f 7473 2074 6865  on. it plots the
+00045690: 206d 6174 7269 7820 696e 2074 6865 206d   matrix in the m
+000456a0: 6964 646c 6520 616e 6420 7477 6f20 736c  iddle and two sl
+000456b0: 6963 6573 2074 6861 7420 6172 6520 7365  ices that are se
+000456c0: 6c65 6374 6564 2062 7920 7468 6520 6d6f  lected by the mo
+000456d0: 7573 6520 2863 6c69 636b 2920 0d0a 0909  use (click) ....
+000456e0: 0d0a 0909 5061 7261 6d65 7465 7273 0d0a  ....Parameters..
+000456f0: 0909 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ..--------------
+00045700: 2d0d 0a09 0966 6974 7465 6420 3a20 626f  -....fitted : bo
+00045710: 6f6c 2c20 6f70 7469 6f6e 616c 0d0a 0909  ol, optional....
+00045720: 0974 6869 7320 7377 6974 6368 2064 6563  .this switch dec
+00045730: 6964 6573 2069 6620 7468 6520 6669 7474  ides if the fitt
+00045740: 6564 206f 7220 7468 6520 5241 5720 6461  ed or the RAW da
+00045750: 7461 2069 7320 706c 6f74 7465 6420 7769  ta is plotted wi
+00045760: 7468 2074 6869 7320 7769 6467 6574 2074  th this widget t
+00045770: 6f20 0d0a 0909 0969 6e73 7065 6374 2074  o .....inspect t
+00045780: 6865 2064 6174 6120 6461 7461 2e20 4966  he data data. If
+00045790: 2066 6974 7465 6420 6973 2046 616c 7365   fitted is False
+000457a0: 2028 4465 6661 756c 7429 2074 6865 6e20   (Default) then 
+000457b0: 7468 6520 7261 7720 6461 7461 2061 6e64  the raw data and
+000457c0: 2061 6e20 696e 7465 7270 6f6c 6174 696f   an interpolatio
+000457d0: 6e20 0d0a 0909 0969 7320 7573 6564 2074  n .....is used t
+000457e0: 6f20 706c 6f74 2e20 0d0a 0909 0d0a 0909  o plot. ........
+000457f0: 636d 6170 203a 204e 6f6e 6520 6f72 206d  cmap : None or m
+00045800: 6174 706c 6f74 6c69 6220 636f 6c6f 7220  atplotlib color 
+00045810: 6d61 702c 206f 7074 696f 6e61 6c0d 0a09  map, optional...
+00045820: 0909 6973 2061 2070 6f77 6572 6675 6c6c  ..is a powerfull
+00045830: 2076 6172 6961 626c 6520 7468 6174 2063   variable that c
+00045840: 686f 6f73 6573 2074 6865 2063 6f6c 6f75  hooses the colou
+00045850: 7220 6d61 7020 6170 706c 6965 6420 666f  r map applied fo
+00045860: 7220 616c 6c20 706c 6f74 732e 2049 6620  r all plots. If 
+00045870: 7365 7420 746f 200d 0a09 0909 4e6f 6e65  set to .....None
+00045880: 2028 4465 6661 756c 7429 2074 6865 6e20   (Default) then 
+00045890: 7468 6520 7365 6c66 2e63 6d61 7020 6973  the self.cmap is
+000458a0: 2075 7365 642e 0d0a 0909 0941 7320 7374   used......As st
+000458b0: 616e 6461 7264 2049 2075 7365 2074 6865  andard I use the
+000458c0: 2063 6f6c 6f72 206d 6170 2022 6a65 7422   color map "jet"
+000458d0: 2066 726f 6d20 6d61 7470 6c6f 746c 6962   from matplotlib
+000458e0: 2e20 5468 6572 6520 6172 6520 6120 7661  . There are a va
+000458f0: 7269 6574 7920 6f66 2063 6f6c 6f72 6d61  riety of colorma
+00045900: 7073 200d 0a09 0909 6176 6169 6c61 626c  ps .....availabl
+00045910: 6520 7468 6174 2061 7265 2076 6572 7920  e that are very 
+00045920: 7573 6566 756c 6c2e 2042 6573 6964 6520  usefull. Beside 
+00045930: 226a 6574 222c 2022 7669 7269 6469 7322  "jet", "viridis"
+00045940: 2069 7320 6120 676f 6f64 2063 686f 6963   is a good choic
+00045950: 6520 6173 2069 7420 6973 2077 656c 6c20  e as it is well 
+00045960: 0d0a 0909 0976 6973 6962 6c65 2075 6e64  .....visible und
+00045970: 6572 2072 6564 2d67 7265 656e 2062 6c69  er red-green bli
+00045980: 6e64 6e65 7373 2e20 4f74 6865 7220 7573  ndness. Other us
+00045990: 6566 756c 206d 6170 7320 6172 6520 2270  eful maps are "p
+000459a0: 7269 736d 2220 666f 7220 6869 6768 2066  rism" for high f
+000459b0: 6c75 6374 7561 7469 6f6e 7320 0d0a 0909  luctuations ....
+000459c0: 096f 7220 6469 7665 7267 696e 6720 636f  .or diverging co
+000459d0: 6c6f 7220 6d61 7073 206c 696b 6520 2273  lor maps like "s
+000459e0: 6569 736d 6963 222e 200d 0a09 0909 5365  eismic". .....Se
+000459f0: 6520 6874 7470 733a 2f2f 6d61 7470 6c6f  e https://matplo
+00045a00: 746c 6962 2e6f 7267 2f33 2e31 2e30 2f74  tlib.org/3.1.0/t
+00045a10: 7574 6f72 6961 6c73 2f63 6f6c 6f72 732f  utorials/colors/
+00045a20: 636f 6c6f 726d 6170 732e 6874 6d6c 2066  colormaps.html f
+00045a30: 6f72 2061 2063 6f6d 7072 6568 656e 7369  or a comprehensi
+00045a40: 7665 200d 0a09 0909 7365 6c65 6374 696f  ve .....selectio
+00045a50: 6e2e 2049 6e20 7468 6520 636f 6465 2074  n. In the code t
+00045a60: 6865 2063 6f6c 6f72 6d61 7073 2061 7265  he colormaps are
+00045a70: 2069 6d70 6f72 7465 6420 736f 2069 6620   imported so if 
+00045a80: 706c 6f74 5f66 756e 6320 6973 2069 6d70  plot_func is imp
+00045a90: 6f72 7465 6420 6173 2070 6620 7468 656e  orted as pf then
+00045aa0: 200d 0a09 0909 7365 6c66 2e63 6d61 703d   .....self.cmap=
+00045ab0: 7066 2e63 6d2e 7669 7269 6469 7320 7365  pf.cm.viridis se
+00045ac0: 7473 2076 6972 6964 6973 2061 7320 7468  ts viridis as th
+00045ad0: 6520 6d61 7020 746f 2075 7365 2e20 496e  e map to use. In
+00045ae0: 7465 726e 616c 6c79 2074 6865 2063 6f6c  ternally the col
+00045af0: 6f72 7320 6172 6520 6368 6f73 656e 200d  ors are chosen .
+00045b00: 0a09 0909 7769 7468 2074 6865 2022 636f  ....with the "co
+00045b10: 6c6d 2220 6675 6e63 7469 6f6e 2e20 5468  lm" function. Th
+00045b20: 6520 3264 2070 6c6f 7473 2072 6571 7569  e 2d plots requi
+00045b30: 7265 2061 2063 6f6e 7469 6e75 6f75 7320  re a continuous 
+00045b40: 636f 6c6f 7220 6d61 7020 736f 2069 6620  color map so if 
+00045b50: 736f 6d65 7468 696e 6720 0d0a 0909 0965  something .....e
+00045b60: 6c73 6520 6973 2067 6976 6520 3264 2070  lse is give 2d p
+00045b70: 6c6f 7473 2061 7265 2073 686f 776e 2061  lots are shown a
+00045b80: 7574 6f6d 6174 6963 616c 6c79 2077 6974  utomatically wit
+00045b90: 6820 226a 6574 222e 2046 6f72 2061 6c6c  h "jet". For all
+00045ba0: 206f 6620 7468 6520 3164 2070 6c6f 7473   of the 1d plots
+00045bb0: 2068 6f77 6576 6572 200d 0a09 0909 4920   however .....I 
+00045bc0: 6669 7273 7420 7365 6c65 6374 2061 206e  first select a n
+00045bd0: 756d 6265 7220 6f66 2063 6f6c 6f72 7320  umber of colors 
+00045be0: 6265 666f 7265 2065 6163 6820 706c 6f74  before each plot
+00045bf0: 2e20 4966 2063 6d61 7020 6973 2061 2063  . If cmap is a c
+00045c00: 6f6e 7469 6e6f 7573 206d 6170 2074 6865  ontinous map the
+00045c10: 6e20 7468 6573 650d 0a09 0909 6172 6520  n these.....are 
+00045c20: 7361 6d70 6c65 6420 6576 656e 6c79 206f  sampled evenly o
+00045c30: 7665 7220 7468 6520 636f 6c6f 7572 6d61  ver the colourma
+00045c40: 702e 204d 616e 7561 6c20 6974 6572 6162  p. Manual iterab
+00045c50: 6c65 7320 6f66 2063 6f6c 6f75 7273 200d  les of colours .
+00045c60: 0a09 0909 636d 6170 3d5b 2831 2c30 2c30  ....cmap=[(1,0,0
+00045c70: 292c 2830 2c31 2c30 292c 2830 2c30 2c31  ),(0,1,0),(0,0,1
+00045c80: 292c 2e2e 2e5d 2061 7265 2061 6c73 6f20  ),...] are also 
+00045c90: 6163 6365 7074 6564 2c20 6173 2061 7265  accepted, as are
+00045ca0: 2076 6563 746f 7273 206f 7220 6461 7461   vectors or data
+00045cb0: 6672 616d 6573 2074 6861 7420 0d0a 0909  frames that ....
+00045cc0: 0963 6f6e 7461 696e 2061 7320 726f 7773  .contain as rows
+00045cd0: 2074 6865 2063 6f6c 6f72 732e 2054 6865   the colors. The
+00045ce0: 7265 206d 7573 7420 6265 206f 6620 636f  re must be of co
+00045cf0: 7572 7365 2073 7566 6669 6369 656e 7420  urse sufficient 
+00045d00: 636f 6c6f 7273 2070 7265 7365 6e74 2066  colors present f
+00045d10: 6f72 200d 0a09 0909 7468 6520 6e75 6d62  or .....the numb
+00045d20: 6572 7320 6f66 206c 696e 6573 2074 6861  ers of lines tha
+00045d30: 7420 7769 6c6c 2062 6520 706c 6f74 7465  t will be plotte
+00045d40: 642e 2053 6f20 4920 7265 636f 6d6d 656e  d. So I recommen
+00045d50: 6420 746f 2070 726f 7669 6465 2061 7420  d to provide at 
+00045d60: 6c65 6173 7420 3130 2063 6f6c 6f75 7273  least 10 colours
+00045d70: 200d 0a09 0909 2865 2e67 2e7e 796f 7572   .....(e.g.~your
+00045d80: 2075 6e69 7665 7273 6974 7920 636f 6c6f   university colo
+00045d90: 7273 292e 2063 6f6c 6f75 7273 2061 7265  rs). colours are
+00045da0: 2061 6c77 6179 7320 6769 7665 6e20 6173   always given as
+00045db0: 2061 2c20 6c69 7374 206f 7220 7475 706c   a, list or tupl
+00045dc0: 6520 7769 7468 2052 4741 206f 7220 5247  e with RGA or RG
+00045dd0: 4241 0d0a 0909 0928 7769 7468 2074 6865  BA.....(with the
+00045de0: 206c 6173 7420 4120 6265 6569 6e67 2074   last A beeing t
+00045df0: 6865 2041 6c70 6861 3d74 7261 6e73 7061  he Alpha=transpa
+00045e00: 7265 6e63 792e 2041 6c6c 206e 756d 6265  rency. All numbe
+00045e10: 7273 2061 7265 2062 6574 7765 656e 2030  rs are between 0
+00045e20: 2061 6e64 2031 2e20 0d0a 0909 0949 6620   and 1. .....If 
+00045e30: 6120 6c69 7374 2f76 6563 746f 722f 4461  a list/vector/Da
+00045e40: 7461 4672 616d 6520 6973 2067 6976 656e  taFrame is given
+00045e50: 2066 6f72 2074 6865 2063 6f6c 6f75 7273   for the colours
+00045e60: 2074 6865 7920 7769 6c6c 2062 6520 7573   they will be us
+00045e70: 6564 2069 6e20 7468 6520 6f72 6465 7220  ed in the order 
+00045e80: 7072 6f76 6964 6564 2e09 090d 0a09 090d  provided........
+00045e90: 0a09 0964 7320 3a20 4461 7461 4672 616d  ...ds : DataFram
+00045ea0: 652c 206f 7074 696f 6e61 6c0d 0a09 0909  e, optional.....
+00045eb0: 6966 204e 6f6e 6520 2844 6566 6175 6c74  if None (Default
+00045ec0: 292c 2074 6865 2070 726f 6772 616d 2066  ), the program f
+00045ed0: 6972 7374 2074 6573 7473 2073 656c 662e  irst tests self.
+00045ee0: 6473 2061 6e64 2069 6620 7468 6973 2069  ds and if this i
+00045ef0: 7320 6e6f 7420 7468 6572 6520 7468 656e  s not there then
+00045f00: 2073 656c 662e 6473 5f6f 7269 2e0d 0a09   self.ds_ori....
+00045f10: 0909 5468 6973 206f 7074 696f 6e20 7761  ..This option wa
+00045f20: 7320 696e 7472 6f64 7563 6564 2074 6f20  s introduced to 
+00045f30: 616c 6c6f 7720 706c 6f74 7469 6e67 206f  allow plotting o
+00045f40: 6620 6f74 6865 7220 6d61 7472 6978 6573  f other matrixes
+00045f50: 2077 6974 6820 7468 6520 7361 6d65 2070   with the same p
+00045f60: 6172 616d 6574 6572 0d0a 0909 090d 0a09  arameter........
+00045f70: 0970 6c6f 745f 6f6e 5f6d 6f76 6520 3a20  .plot_on_move : 
+00045f80: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0d0a  bool, optional..
+00045f90: 0909 0944 6566 6175 6c74 3a20 4661 6c73  ...Default: Fals
+00045fa0: 6520 706c 6f74 7320 7468 6520 736c 6963  e plots the slic
+00045fb0: 6573 2061 6674 6572 2063 6c69 636b 2c20  es after click, 
+00045fc0: 6f6e 2054 7275 6520 7468 6520 706c 6f74  on True the plot
+00045fd0: 2063 6f6e 7374 616e 746c 7920 7265 736c   constantly resl
+00045fe0: 6963 6573 2061 6e64 206f 6e20 636c 6963  ices and on clic
+00045ff0: 6b20 0d0a 0909 0954 6865 2063 7572 7265  k .....The curre
+00046000: 6e74 2070 6f73 6974 696f 6e20 6973 2077  nt position is w
+00046010: 7269 7474 656e 2064 6f77 6e2e 0d0a 0909  ritten down.....
+00046020: 090d 0a09 0920 2727 270d 0a09 0966 726f  ..... '''....fro
+00046030: 6d20 6d61 7470 6c6f 746c 6962 2e77 6964  m matplotlib.wid
+00046040: 6765 7473 2069 6d70 6f72 7420 4375 7273  gets import Curs
+00046050: 6f72 0d0a 0909 6966 2063 6d61 7020 6973  or....if cmap is
+00046060: 204e 6f6e 653a 636d 6170 3d73 656c 662e   None:cmap=self.
+00046070: 636d 6170 0d0a 0909 6966 2064 7320 6973  cmap....if ds is
+00046080: 204e 6f6e 653a 0d0a 0909 0969 6620 6e6f   None:.....if no
+00046090: 7420 6669 7474 6564 3a0d 0a09 0909 0969  t fitted:......i
+000460a0: 6620 7365 6c66 2e64 7320 6973 204e 6f6e  f self.ds is Non
+000460b0: 653a 0d0a 0909 0909 0964 733d 7365 6c66  e:.......ds=self
+000460c0: 2e64 735f 6f72 692e 636f 7079 2829 0d0a  .ds_ori.copy()..
+000460d0: 0909 0909 656c 7365 3a0d 0a09 0909 0909  ....else:.......
+000460e0: 6473 3d73 656c 662e 6473 2e63 6f70 7928  ds=self.ds.copy(
+000460f0: 290d 0a09 0909 656c 7365 3a0d 0a09 0909  ).....else:.....
+00046100: 0964 733d 7365 6c66 2e72 655b 2741 275d  .ds=self.re['A']
+00046110: 0d0a 0909 0909 6d6f 6465 6c6c 6564 3d73  ......modelled=s
+00046120: 656c 662e 7265 5b27 4143 275d 0d0a 0909  elf.re['AC']....
+00046130: 696e 7465 6e73 6974 795f 7261 6e67 653d  intensity_range=
+00046140: 7365 6c66 2e69 6e74 656e 7369 7479 5f72  self.intensity_r
+00046150: 616e 6765 0d0a 0909 6966 2069 6e74 656e  ange....if inten
+00046160: 7369 7479 5f72 616e 6765 2069 7320 4e6f  sity_range is No
+00046170: 6e65 3a0d 0a09 0909 7472 793a 0d0a 0909  ne:.....try:....
+00046180: 0909 6d61 7869 6d3d 6d61 7828 5b61 6273  ..maxim=max([abs
+00046190: 2864 732e 7661 6c75 6573 2e6d 696e 2829  (ds.values.min()
+000461a0: 292c 6162 7328 6473 2e76 616c 7565 732e  ),abs(ds.values.
+000461b0: 6d61 7828 2929 5d29 0d0a 0909 0909 696e  max())])......in
+000461c0: 7465 6e73 6974 795f 7261 6e67 653d 5b2d  tensity_range=[-
+000461d0: 6d61 7869 6d2c 6d61 7869 6d5d 0d0a 0909  maxim,maxim]....
+000461e0: 0965 7863 6570 743a 0d0a 0909 0909 696e  .except:......in
+000461f0: 7465 6e73 6974 795f 7261 6e67 653d 5b2d  tensity_range=[-
+00046200: 3165 2d32 2c31 652d 325d 0d0a 0909 656c  1e-2,1e-2]....el
+00046210: 7365 3a0d 0a09 0909 6966 206e 6f74 2068  se:.....if not h
+00046220: 6173 6174 7472 2869 6e74 656e 7369 7479  asattr(intensity
+00046230: 5f72 616e 6765 2c27 5f5f 6974 6572 5f5f  _range,'__iter__
+00046240: 2729 3a23 6c65 7473 2068 6176 6520 616e  '):#lets have an
+00046250: 206c 617a 7920 6f70 7469 6f6e 0d0a 0909   lazy option....
+00046260: 0909 696e 7465 6e73 6974 795f 7261 6e67  ..intensity_rang
+00046270: 653d 5b2d 696e 7465 6e73 6974 795f 7261  e=[-intensity_ra
+00046280: 6e67 652c 696e 7465 6e73 6974 795f 7261  nge,intensity_ra
+00046290: 6e67 655d 0d0a 0909 636c 6173 7320 4d6f  nge]....class Mo
+000462a0: 7573 654d 6f76 653a 0d0a 0909 0923 2069  useMove:.....# i
+000462b0: 6e69 7469 616c 697a 6174 696f 6e0d 0a09  nitialization...
+000462c0: 0909 6465 6620 5f5f 696e 6974 5f5f 2873  ..def __init__(s
+000462d0: 656c 662c 2064 732c 2063 6d61 702c 2069  elf, ds, cmap, i
+000462e0: 6e74 656e 7369 7479 5f72 616e 6765 2c20  ntensity_range, 
+000462f0: 6c6f 675f 7363 616c 652c 2062 6173 6575  log_scale, baseu
+00046300: 6e69 742c 200d 0a09 0909 0909 0909 7469  nit, .........ti
+00046310: 6d65 6c69 6d69 7473 2c20 7363 6174 7465  melimits, scatte
+00046320: 7263 7574 2c20 626f 7264 6572 6375 742c  rcut, bordercut,
+00046330: 2077 6176 655f 6e6d 5f62 696e 2c20 6571   wave_nm_bin, eq
+00046340: 7561 6c5f 656e 6572 6779 5f62 696e 2c20  ual_energy_bin, 
+00046350: 6967 6e6f 7265 5f74 696d 655f 7265 6769  ignore_time_regi
+00046360: 6f6e 2c0d 0a09 0909 0909 0909 7469 6d65  on,.........time
+00046370: 5f62 696e 2c20 6c69 6e74 7265 7368 2c20  _bin, lintresh, 
+00046380: 6461 7461 5f74 7970 652c 2077 6964 7468  data_type, width
+00046390: 2c20 7469 6d65 5f77 6964 7468 5f70 6572  , time_width_per
+000463a0: 6365 6e74 293a 0d0a 0909 0909 6669 6720  cent):......fig 
+000463b0: 3d20 706c 742e 6669 6775 7265 2874 6967  = plt.figure(tig
+000463c0: 6874 5f6c 6179 6f75 743d 5472 7565 2c66  ht_layout=True,f
+000463d0: 6967 7369 7a65 3d28 3134 2c38 2929 0d0a  igsize=(14,8))..
+000463e0: 0909 0909 6773 203d 2047 7269 6453 7065  ....gs = GridSpe
+000463f0: 6328 352c 2034 290d 0a09 0909 0973 656c  c(5, 4)......sel
+00046400: 662e 6178 3d20 6669 672e 6164 645f 7375  f.ax= fig.add_su
+00046410: 6270 6c6f 7428 6773 5b31 3a2c 203a 335d  bplot(gs[1:, :3]
+00046420: 290d 0a09 0909 0973 656c 662e 6473 3d64  )......self.ds=d
+00046430: 730d 0a09 0909 0973 656c 662e 636d 6170  s......self.cmap
+00046440: 3d63 6d61 700d 0a09 0909 0973 656c 662e  =cmap......self.
+00046450: 696e 7465 6e73 6974 795f 7261 6e67 653d  intensity_range=
+00046460: 696e 7465 6e73 6974 795f 7261 6e67 650d  intensity_range.
+00046470: 0a09 0909 0973 656c 662e 6c6f 675f 7363  .....self.log_sc
+00046480: 616c 653d 6c6f 675f 7363 616c 650d 0a09  ale=log_scale...
+00046490: 0909 0973 656c 662e 6261 7365 756e 6974  ...self.baseunit
+000464a0: 3d62 6173 6575 6e69 740d 0a09 0909 0973  =baseunit......s
+000464b0: 656c 662e 7469 6d65 6c69 6d69 7473 3d74  elf.timelimits=t
+000464c0: 696d 656c 696d 6974 730d 0a09 0909 0973  imelimits......s
+000464d0: 656c 662e 7363 6174 7465 7263 7574 3d73  elf.scattercut=s
+000464e0: 6361 7474 6572 6375 740d 0a09 0909 0973  cattercut......s
+000464f0: 656c 662e 626f 7264 6572 6375 743d 626f  elf.bordercut=bo
+00046500: 7264 6572 6375 740d 0a09 0909 0973 656c  rdercut......sel
+00046510: 662e 7761 7665 5f6e 6d5f 6269 6e3d 7761  f.wave_nm_bin=wa
+00046520: 7665 5f6e 6d5f 6269 6e0d 0a09 0909 0973  ve_nm_bin......s
+00046530: 656c 662e 6571 7561 6c5f 656e 6572 6779  elf.equal_energy
+00046540: 5f62 696e 3d65 7175 616c 5f65 6e65 7267  _bin=equal_energ
+00046550: 795f 6269 6e0d 0a09 0909 0973 656c 662e  y_bin......self.
+00046560: 6967 6e6f 7265 5f74 696d 655f 7265 6769  ignore_time_regi
+00046570: 6f6e 3d69 676e 6f72 655f 7469 6d65 5f72  on=ignore_time_r
+00046580: 6567 696f 6e0d 0a09 0909 0973 656c 662e  egion......self.
+00046590: 7469 6d65 5f62 696e 3d74 696d 655f 6269  time_bin=time_bi
+000465a0: 6e0d 0a09 0909 0973 656c 662e 6461 7461  n......self.data
+000465b0: 5f74 7970 653d 6461 7461 5f74 7970 650d  _type=data_type.
+000465c0: 0a09 0909 0973 656c 662e 7769 6474 683d  .....self.width=
+000465d0: 7769 6474 680d 0a09 0909 0973 656c 662e  width......self.
+000465e0: 6c69 6e74 7265 7368 3d6c 696e 7472 6573  lintresh=lintres
+000465f0: 680d 0a09 0909 0973 656c 662e 7469 6d65  h......self.time
+00046600: 5f77 6964 7468 5f70 6572 6365 6e74 3d74  _width_percent=t
+00046610: 696d 655f 7769 6474 685f 7065 7263 656e  ime_width_percen
+00046620: 740d 0a09 0909 090d 0a09 0909 090d 0a09  t...............
+00046630: 0909 0973 656c 662e 6178 203d 2070 6c6f  ...self.ax = plo
+00046640: 7432 6428 6473 3d64 732c 2061 783d 7365  t2d(ds=ds, ax=se
+00046650: 6c66 2e61 782c 2063 6d61 703d 636d 6170  lf.ax, cmap=cmap
+00046660: 2c20 696e 7465 6e73 6974 795f 7261 6e67  , intensity_rang
+00046670: 653d 7365 6c66 2e69 6e74 656e 7369 7479  e=self.intensity
+00046680: 5f72 616e 6765 2c20 0d0a 0909 0909 096c  _range, .......l
+00046690: 6f67 5f73 6361 6c65 3d73 656c 662e 6c6f  og_scale=self.lo
+000466a0: 675f 7363 616c 652c 2062 6173 6575 6e69  g_scale, baseuni
+000466b0: 743d 7365 6c66 2e62 6173 6575 6e69 742c  t=self.baseunit,
+000466c0: 2074 696d 656c 696d 6974 733d 7365 6c66   timelimits=self
+000466d0: 2e74 696d 656c 696d 6974 732c 200d 0a09  .timelimits, ...
+000466e0: 0909 0909 7363 6174 7465 7263 7574 3d73  ....scattercut=s
+000466f0: 656c 662e 7363 6174 7465 7263 7574 2c20  elf.scattercut, 
+00046700: 626f 7264 6572 6375 743d 7365 6c66 2e62  bordercut=self.b
+00046710: 6f72 6465 7263 7574 2c20 7761 7665 5f6e  ordercut, wave_n
+00046720: 6d5f 6269 6e3d 7365 6c66 2e77 6176 655f  m_bin=self.wave_
+00046730: 6e6d 5f62 696e 2c20 6571 7561 6c5f 656e  nm_bin, equal_en
+00046740: 6572 6779 5f62 696e 3d73 656c 662e 6571  ergy_bin=self.eq
+00046750: 7561 6c5f 656e 6572 6779 5f62 696e 2c0d  ual_energy_bin,.
+00046760: 0a09 0909 0909 6967 6e6f 7265 5f74 696d  ......ignore_tim
+00046770: 655f 7265 6769 6f6e 3d73 656c 662e 6967  e_region=self.ig
+00046780: 6e6f 7265 5f74 696d 655f 7265 6769 6f6e  nore_time_region
+00046790: 2c20 7469 6d65 5f62 696e 3d73 656c 662e  , time_bin=self.
+000467a0: 7469 6d65 5f62 696e 2c20 0d0a 0909 0909  time_bin, ......
+000467b0: 096c 696e 7472 6573 683d 7365 6c66 2e6c  .lintresh=self.l
+000467c0: 696e 7472 6573 682c 2064 6174 615f 7479  intresh, data_ty
+000467d0: 7065 203d 2073 656c 662e 6461 7461 5f74  pe = self.data_t
+000467e0: 7970 652c 2075 7365 5f63 6f6c 6f72 6261  ype, use_colorba
+000467f0: 7220 3d20 4661 6c73 6529 0d0a 0909 0909  r = False)......
+00046800: 7365 6c66 2e61 785f 7469 6d65 3d20 6669  self.ax_time= fi
+00046810: 672e 6164 645f 7375 6270 6c6f 7428 6773  g.add_subplot(gs
+00046820: 5b30 2c20 3a33 5d2c 7368 6172 6578 3d73  [0, :3],sharex=s
+00046830: 656c 662e 6178 290d 0a09 0909 0973 656c  elf.ax)......sel
+00046840: 662e 6178 5f6b 696e 6574 6963 3d20 6669  f.ax_kinetic= fi
+00046850: 672e 6164 645f 7375 6270 6c6f 7428 6773  g.add_subplot(gs
+00046860: 5b31 3a2c 202d 315d 2c73 6861 7265 793d  [1:, -1],sharey=
+00046870: 7365 6c66 2e61 7829 0d0a 0909 0909 706c  self.ax)......pl
+00046880: 742e 7375 6270 6c6f 7473 5f61 646a 7573  t.subplots_adjus
+00046890: 7428 7773 7061 6365 3d30 2c68 7370 6163  t(wspace=0,hspac
+000468a0: 653d 3029 0d0a 0909 0909 6966 2070 6c6f  e=0)......if plo
+000468b0: 745f 6f6e 5f6d 6f76 653a 0d0a 0909 0909  t_on_move:......
+000468c0: 0966 6967 2e63 616e 7661 732e 6d70 6c5f  .fig.canvas.mpl_
+000468d0: 636f 6e6e 6563 7428 276d 6f74 696f 6e5f  connect('motion_
+000468e0: 6e6f 7469 6679 5f65 7665 6e74 272c 2073  notify_event', s
+000468f0: 656c 662e 6d6f 7665 290d 0a09 0909 0909  elf.move).......
+00046900: 6669 672e 6361 6e76 6173 2e6d 706c 5f63  fig.canvas.mpl_c
+00046910: 6f6e 6e65 6374 2827 6275 7474 6f6e 5f70  onnect('button_p
+00046920: 7265 7373 5f65 7665 6e74 272c 2073 656c  ress_event', sel
+00046930: 662e 636c 6963 6b29 0d0a 0909 0909 656c  f.click)......el
+00046940: 7365 3a0d 0a09 0909 0909 6669 672e 6361  se:.......fig.ca
+00046950: 6e76 6173 2e6d 706c 5f63 6f6e 6e65 6374  nvas.mpl_connect
+00046960: 2827 6275 7474 6f6e 5f70 7265 7373 5f65  ('button_press_e
+00046970: 7665 6e74 272c 2073 656c 662e 6d6f 7665  vent', self.move
+00046980: 290d 0a09 0909 0d0a 0909 0964 6566 2063  )..........def c
+00046990: 6c69 636b 2873 656c 662c 2065 7665 6e74  lick(self, event
+000469a0: 293a 0d0a 0909 0909 0d0a 0909 0909 782c  ):............x,
+000469b0: 2079 203d 2065 7665 6e74 2e78 6461 7461   y = event.xdata
+000469c0: 2c20 6576 656e 742e 7964 6174 610d 0a09  , event.ydata...
+000469d0: 0909 0969 6620 7365 6c66 2e65 7175 616c  ...if self.equal
+000469e0: 5f65 6e65 7267 795f 6269 6e20 6973 206e  _energy_bin is n
+000469f0: 6f74 204e 6f6e 653a 0d0a 0909 0909 0978  ot None:.......x
+00046a00: 3d73 6369 7079 2e63 6f6e 7374 616e 7473  =scipy.constants
+00046a10: 2e68 2a73 6369 7079 2e63 6f6e 7374 616e  .h*scipy.constan
+00046a20: 7473 2e63 2f28 782a 3165 2d39 2a73 6369  ts.c/(x*1e-9*sci
+00046a30: 7079 2e63 6f6e 7374 616e 7473 2e65 6c65  py.constants.ele
+00046a40: 6374 726f 6e5f 766f 6c74 2920 0d0a 0909  ctron_volt) ....
+00046a50: 0909 7072 696e 7428 2778 3d25 672c 2079  ..print('x=%g, y
+00046a60: 3d25 675c 6e27 2528 782c 7929 290d 0a09  =%g\n'%(x,y))...
+00046a70: 0909 0d0a 0909 0964 6566 206d 6f76 6528  .......def move(
+00046a80: 7365 6c66 2c20 6576 656e 7429 3a0d 0a09  self, event):...
+00046a90: 0909 0978 2c20 7920 3d20 6576 656e 742e  ...x, y = event.
+00046aa0: 7864 6174 612c 2065 7665 6e74 2e79 6461  xdata, event.yda
+00046ab0: 7461 0d0a 0909 0909 6966 2073 656c 662e  ta......if self.
+00046ac0: 6571 7561 6c5f 656e 6572 6779 5f62 696e  equal_energy_bin
+00046ad0: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a09   is not None:...
+00046ae0: 0909 0909 783d 7363 6970 792e 636f 6e73  ....x=scipy.cons
+00046af0: 7461 6e74 732e 682a 7363 6970 792e 636f  tants.h*scipy.co
+00046b00: 6e73 7461 6e74 732e 632f 2878 2a31 652d  nstants.c/(x*1e-
+00046b10: 392a 7363 6970 792e 636f 6e73 7461 6e74  9*scipy.constant
+00046b20: 732e 656c 6563 7472 6f6e 5f76 6f6c 7429  s.electron_volt)
+00046b30: 200d 0a09 0909 0974 7279 3a0d 0a09 0909   ......try:.....
+00046b40: 0909 7365 6c66 2e61 785f 7469 6d65 2e63  ..self.ax_time.c
+00046b50: 6c61 2829 0d0a 0909 0909 6578 6365 7074  la()......except
+00046b60: 3a0d 0a09 0909 0909 7061 7373 0d0a 0909  :.......pass....
+00046b70: 0909 090d 0a09 0909 0969 6620 6e6f 7420  .........if not 
+00046b80: 6669 7474 6564 3a09 0d0a 0909 0909 0964  fitted:........d
+00046b90: 735f 7465 6d70 3120 3d20 7375 625f 6473  s_temp1 = sub_ds
+00046ba0: 2864 7320 3d20 4672 616d 655f 676f 6c61  (ds = Frame_gola
+00046bb0: 7928 6473 2c35 2c33 292c 2074 696d 6573  y(ds,5,3), times
+00046bc0: 203d 2079 2c20 7469 6d65 5f77 6964 7468   = y, time_width
+00046bd0: 5f70 6572 6365 6e74 203d 2073 656c 662e  _percent = self.
+00046be0: 7469 6d65 5f77 6964 7468 5f70 6572 6365  time_width_perce
+00046bf0: 6e74 2c20 0d0a 0909 0909 0909 0909 0973  nt, ...........s
+00046c00: 6361 7474 6572 6375 7420 3d20 7365 6c66  cattercut = self
+00046c10: 2e73 6361 7474 6572 6375 742c 2064 726f  .scattercut, dro
+00046c20: 705f 7363 6174 7465 723d 5472 7565 2c20  p_scatter=True, 
+00046c30: 626f 7264 6572 6375 7420 3d20 7365 6c66  bordercut = self
+00046c40: 2e62 6f72 6465 7263 7574 2c20 0d0a 0909  .bordercut, ....
+00046c50: 0909 0909 0909 0969 676e 6f72 655f 7469  .......ignore_ti
+00046c60: 6d65 5f72 6567 696f 6e20 3d20 7365 6c66  me_region = self
+00046c70: 2e69 676e 6f72 655f 7469 6d65 5f72 6567  .ignore_time_reg
+00046c80: 696f 6e2c 2077 6176 655f 6e6d 5f62 696e  ion, wave_nm_bin
+00046c90: 203d 2073 656c 662e 7761 7665 5f6e 6d5f   = self.wave_nm_
+00046ca0: 6269 6e2c 2065 7175 616c 5f65 6e65 7267  bin, equal_energ
+00046cb0: 795f 6269 6e3d 7365 6c66 2e65 7175 616c  y_bin=self.equal
+00046cc0: 5f65 6e65 7267 795f 6269 6e2c 0d0a 0909  _energy_bin,....
+00046cd0: 0909 0909 0909 0977 6176 656c 656e 6774  .......wavelengt
+00046ce0: 685f 6269 6e20 3d20 7365 6c66 2e77 6964  h_bin = self.wid
+00046cf0: 7468 290d 0a09 0909 0909 6473 5f74 656d  th).......ds_tem
+00046d00: 7031 2e70 6c6f 7428 6178 3d73 656c 662e  p1.plot(ax=self.
+00046d10: 6178 5f74 696d 652c 7374 796c 653d 272d  ax_time,style='-
+00046d20: 272c 636f 6c6f 723d 2772 6564 2729 0d0a  ',color='red')..
+00046d30: 0909 0909 090d 0a09 0909 0965 6c73 653a  ...........else:
+00046d40: 0d0a 0909 0909 0964 735f 7465 6d70 3120  .......ds_temp1 
+00046d50: 3d20 7375 625f 6473 2864 7320 3d20 6d6f  = sub_ds(ds = mo
+00046d60: 6465 6c6c 6564 2c20 7469 6d65 7320 3d20  delled, times = 
+00046d70: 792c 2074 696d 655f 7769 6474 685f 7065  y, time_width_pe
+00046d80: 7263 656e 7420 3d20 7365 6c66 2e74 696d  rcent = self.tim
+00046d90: 655f 7769 6474 685f 7065 7263 656e 742c  e_width_percent,
+00046da0: 200d 0a09 0909 0909 0909 0909 7363 6174   ...........scat
+00046db0: 7465 7263 7574 203d 2073 656c 662e 7363  tercut = self.sc
+00046dc0: 6174 7465 7263 7574 2c20 6472 6f70 5f73  attercut, drop_s
+00046dd0: 6361 7474 6572 3d54 7275 652c 2062 6f72  catter=True, bor
+00046de0: 6465 7263 7574 203d 2073 656c 662e 626f  dercut = self.bo
+00046df0: 7264 6572 6375 742c 200d 0a09 0909 0909  rdercut, .......
+00046e00: 0909 0909 6967 6e6f 7265 5f74 696d 655f  ....ignore_time_
+00046e10: 7265 6769 6f6e 203d 2073 656c 662e 6967  region = self.ig
+00046e20: 6e6f 7265 5f74 696d 655f 7265 6769 6f6e  nore_time_region
+00046e30: 2c20 7761 7665 5f6e 6d5f 6269 6e20 3d20  , wave_nm_bin = 
+00046e40: 7365 6c66 2e77 6176 655f 6e6d 5f62 696e  self.wave_nm_bin
+00046e50: 2c20 2065 7175 616c 5f65 6e65 7267 795f  ,  equal_energy_
+00046e60: 6269 6e3d 7365 6c66 2e65 7175 616c 5f65  bin=self.equal_e
+00046e70: 6e65 7267 795f 6269 6e2c 0d0a 0909 0909  nergy_bin,......
+00046e80: 0909 0909 0977 6176 656c 656e 6774 685f  .....wavelength_
+00046e90: 6269 6e20 3d20 7365 6c66 2e77 6964 7468  bin = self.width
+00046ea0: 290d 0a09 0909 0909 6473 5f74 656d 7031  ).......ds_temp1
+00046eb0: 2e70 6c6f 7428 6178 3d73 656c 662e 6178  .plot(ax=self.ax
+00046ec0: 5f74 696d 652c 7374 796c 653d 272d 272c  _time,style='-',
+00046ed0: 636f 6c6f 723d 2772 6564 2729 0d0a 0909  color='red')....
+00046ee0: 0909 090d 0a09 0909 0964 735f 7465 6d70  .........ds_temp
+00046ef0: 203d 2073 7562 5f64 7328 6473 203d 2064   = sub_ds(ds = d
+00046f00: 732c 2074 696d 6573 203d 2079 2c20 7469  s, times = y, ti
+00046f10: 6d65 5f77 6964 7468 5f70 6572 6365 6e74  me_width_percent
+00046f20: 203d 2073 656c 662e 7469 6d65 5f77 6964   = self.time_wid
+00046f30: 7468 5f70 6572 6365 6e74 2c20 0d0a 0909  th_percent, ....
+00046f40: 0909 0909 0909 0973 6361 7474 6572 6375  .......scattercu
+00046f50: 7420 3d20 7365 6c66 2e73 6361 7474 6572  t = self.scatter
+00046f60: 6375 742c 2064 726f 705f 7363 6174 7465  cut, drop_scatte
+00046f70: 723d 5472 7565 2c20 626f 7264 6572 6375  r=True, bordercu
+00046f80: 7420 3d20 7365 6c66 2e62 6f72 6465 7263  t = self.borderc
+00046f90: 7574 2c20 0d0a 0909 0909 0909 0909 0969  ut, ...........i
+00046fa0: 676e 6f72 655f 7469 6d65 5f72 6567 696f  gnore_time_regio
+00046fb0: 6e20 3d20 7365 6c66 2e69 676e 6f72 655f  n = self.ignore_
+00046fc0: 7469 6d65 5f72 6567 696f 6e2c 2077 6176  time_region, wav
+00046fd0: 655f 6e6d 5f62 696e 203d 2073 656c 662e  e_nm_bin = self.
+00046fe0: 7761 7665 5f6e 6d5f 6269 6e2c 2020 6571  wave_nm_bin,  eq
+00046ff0: 7561 6c5f 656e 6572 6779 5f62 696e 3d73  ual_energy_bin=s
+00047000: 656c 662e 6571 7561 6c5f 656e 6572 6779  elf.equal_energy
+00047010: 5f62 696e 2c0d 0a09 0909 0909 0909 0909  _bin,...........
+00047020: 7761 7665 6c65 6e67 7468 5f62 696e 203d  wavelength_bin =
+00047030: 2073 656c 662e 7769 6474 6829 0d0a 0909   self.width)....
+00047040: 0909 6473 5f74 656d 702e 706c 6f74 2861  ..ds_temp.plot(a
+00047050: 783d 7365 6c66 2e61 785f 7469 6d65 2c73  x=self.ax_time,s
+00047060: 7479 6c65 3d27 2a27 2c63 6f6c 6f72 3d27  tyle='*',color='
+00047070: 626c 6163 6b27 290d 0a09 0909 0973 656c  black')......sel
+00047080: 662e 6178 5f74 696d 652e 706c 6f74 2873  f.ax_time.plot(s
+00047090: 656c 662e 6178 5f74 696d 652e 6765 745f  elf.ax_time.get_
+000470a0: 786c 696d 2829 2c5b 302c 305d 2c27 6772  xlim(),[0,0],'gr
+000470b0: 6179 2729 0d0a 0909 0909 6966 206e 6f74  ay')......if not
+000470c0: 2066 6974 7465 643a 0d0a 0909 0909 0973   fitted:.......s
+000470d0: 656c 662e 6178 5f74 696d 652e 6c65 6765  elf.ax_time.lege
+000470e0: 6e64 285b 2725 2e33 6720 2573 2073 6d6f  nd(['%.3g %s smo
+000470f0: 6f74 6865 6427 2528 792c 7365 6c66 2e62  othed'%(y,self.b
+00047100: 6173 6575 6e69 7429 5d29 0d0a 0909 0909  aseunit)])......
+00047110: 656c 7365 3a0d 0a09 0909 0909 7365 6c66  else:.......self
+00047120: 2e61 785f 7469 6d65 2e6c 6567 656e 6428  .ax_time.legend(
+00047130: 5b27 252e 3367 2025 7320 6669 7474 6564  ['%.3g %s fitted
+00047140: 2725 2879 2c73 656c 662e 6261 7365 756e  '%(y,self.baseun
+00047150: 6974 295d 290d 0a09 0909 0973 656c 662e  it)])......self.
+00047160: 6178 5f74 696d 652e 7365 745f 7974 6963  ax_time.set_ytic
+00047170: 6b73 2873 656c 662e 6178 5f74 696d 652e  ks(self.ax_time.
+00047180: 6765 745f 796c 696d 2829 290d 0a09 0909  get_ylim()).....
+00047190: 0973 656c 662e 6178 5f74 696d 652e 7365  .self.ax_time.se
+000471a0: 745f 7974 6963 6b6c 6162 656c 7328 5b27  t_yticklabels(['
+000471b0: 252e 3165 2725 6620 666f 7220 6620 696e  %.1e'%f for f in
+000471c0: 2073 656c 662e 6178 5f74 696d 652e 6765   self.ax_time.ge
+000471d0: 745f 796c 696d 2829 5d29 0d0a 0909 0909  t_ylim()])......
+000471e0: 0d0a 0909 0909 666f 7220 6920 696e 2072  ......for i in r
+000471f0: 616e 6765 2833 293a 0d0a 0909 0909 0974  ange(3):.......t
+00047200: 7279 3a0d 0a09 0909 0909 0973 656c 662e  ry:........self.
+00047210: 6178 5f6b 696e 6574 6963 2e6c 696e 6573  ax_kinetic.lines
+00047220: 2e70 6f70 2830 290d 0a09 0909 0909 6578  .pop(0).......ex
+00047230: 6365 7074 3a0d 0a09 0909 0909 0970 6173  cept:........pas
+00047240: 730d 0a09 0909 0969 6620 7365 6c66 2e77  s......if self.w
+00047250: 6964 7468 2069 7320 4e6f 6e65 3a0d 0a09  idth is None:...
+00047260: 0909 0909 7365 6c66 2e77 6964 7468 203d  ....self.width =
+00047270: 2031 300d 0a09 0909 090d 0a09 0909 0969   10............i
+00047280: 6620 6e6f 7420 6669 7474 6564 3a0d 0a09  f not fitted:...
+00047290: 0909 0909 6473 5f74 656d 7031 203d 2073  ....ds_temp1 = s
+000472a0: 7562 5f64 7328 6473 203d 2046 7261 6d65  ub_ds(ds = Frame
+000472b0: 5f67 6f6c 6179 2864 7329 2c20 7761 7665  _golay(ds), wave
+000472c0: 6c65 6e67 7468 203d 2078 2c20 7363 6174  length = x, scat
+000472d0: 7465 7263 7574 203d 2073 656c 662e 7363  tercut = self.sc
+000472e0: 6174 7465 7263 7574 2c20 6472 6f70 5f73  attercut, drop_s
+000472f0: 6361 7474 6572 3d54 7275 652c 200d 0a09  catter=True, ...
+00047300: 0909 0909 0909 0962 6f72 6465 7263 7574  .......bordercut
+00047310: 203d 2073 656c 662e 626f 7264 6572 6375   = self.bordercu
+00047320: 742c 2069 676e 6f72 655f 7469 6d65 5f72  t, ignore_time_r
+00047330: 6567 696f 6e20 3d20 7365 6c66 2e69 676e  egion = self.ign
+00047340: 6f72 655f 7469 6d65 5f72 6567 696f 6e2c  ore_time_region,
+00047350: 200d 0a09 0909 0909 0909 0977 6176 655f   ..........wave_
+00047360: 6e6d 5f62 696e 203d 2073 656c 662e 7761  nm_bin = self.wa
+00047370: 7665 5f6e 6d5f 6269 6e2c 7761 7665 6c65  ve_nm_bin,wavele
+00047380: 6e67 7468 5f62 696e 203d 2073 656c 662e  ngth_bin = self.
+00047390: 7769 6474 6829 0d0a 0909 0909 0973 656c  width).......sel
+000473a0: 662e 6178 5f6b 696e 6574 6963 2e70 6c6f  f.ax_kinetic.plo
+000473b0: 7428 6473 5f74 656d 7031 2e76 616c 7565  t(ds_temp1.value
+000473c0: 732c 6473 5f74 656d 7031 2e69 6e64 6578  s,ds_temp1.index
+000473d0: 2e76 616c 7565 732c 272d 272c 6c61 6265  .values,'-',labe
+000473e0: 6c3d 2725 2e30 6620 736d 6f6f 7468 6564  l='%.0f smoothed
+000473f0: 2725 782c 636f 6c6f 723d 2772 6564 2729  '%x,color='red')
+00047400: 0d0a 0909 0909 656c 7365 3a0d 0a09 0909  ......else:.....
+00047410: 0909 6473 5f74 656d 7031 203d 2073 7562  ..ds_temp1 = sub
+00047420: 5f64 7328 6473 203d 206d 6f64 656c 6c65  _ds(ds = modelle
+00047430: 642c 2077 6176 656c 656e 6774 6820 3d20  d, wavelength = 
+00047440: 782c 2073 6361 7474 6572 6375 7420 3d20  x, scattercut = 
+00047450: 7365 6c66 2e73 6361 7474 6572 6375 742c  self.scattercut,
+00047460: 2064 726f 705f 7363 6174 7465 723d 5472   drop_scatter=Tr
+00047470: 7565 2c20 0d0a 0909 0909 0909 0909 626f  ue, ..........bo
+00047480: 7264 6572 6375 7420 3d20 7365 6c66 2e62  rdercut = self.b
+00047490: 6f72 6465 7263 7574 2c20 6967 6e6f 7265  ordercut, ignore
+000474a0: 5f74 696d 655f 7265 6769 6f6e 203d 2073  _time_region = s
+000474b0: 656c 662e 6967 6e6f 7265 5f74 696d 655f  elf.ignore_time_
+000474c0: 7265 6769 6f6e 2c20 0d0a 0909 0909 0909  region, ........
+000474d0: 0909 7761 7665 5f6e 6d5f 6269 6e20 3d20  ..wave_nm_bin = 
+000474e0: 7365 6c66 2e77 6176 655f 6e6d 5f62 696e  self.wave_nm_bin
+000474f0: 2c20 7761 7665 6c65 6e67 7468 5f62 696e  , wavelength_bin
+00047500: 203d 2073 656c 662e 7769 6474 6829 0d0a   = self.width)..
+00047510: 0909 0909 0973 656c 662e 6178 5f6b 696e  .....self.ax_kin
+00047520: 6574 6963 2e70 6c6f 7428 6473 5f74 656d  etic.plot(ds_tem
+00047530: 7031 2e76 616c 7565 732c 6473 5f74 656d  p1.values,ds_tem
+00047540: 7031 2e69 6e64 6578 2e76 616c 7565 732c  p1.index.values,
+00047550: 272d 272c 6c61 6265 6c3d 2725 2e30 6620  '-',label='%.0f 
+00047560: 6669 7474 6564 2725 782c 636f 6c6f 723d  fitted'%x,color=
+00047570: 2772 6564 2729 0d0a 0909 0909 0d0a 0909  'red')..........
+00047580: 0909 6473 5f74 656d 7020 3d20 7375 625f  ..ds_temp = sub_
+00047590: 6473 2864 7320 3d20 6473 2c20 7761 7665  ds(ds = ds, wave
+000475a0: 6c65 6e67 7468 203d 2078 2c20 7363 6174  length = x, scat
+000475b0: 7465 7263 7574 203d 2073 656c 662e 7363  tercut = self.sc
+000475c0: 6174 7465 7263 7574 2c20 6472 6f70 5f73  attercut, drop_s
+000475d0: 6361 7474 6572 3d54 7275 652c 200d 0a09  catter=True, ...
+000475e0: 0909 0909 0909 0962 6f72 6465 7263 7574  .......bordercut
+000475f0: 203d 2073 656c 662e 626f 7264 6572 6375   = self.bordercu
+00047600: 742c 2069 676e 6f72 655f 7469 6d65 5f72  t, ignore_time_r
+00047610: 6567 696f 6e20 3d20 7365 6c66 2e69 676e  egion = self.ign
+00047620: 6f72 655f 7469 6d65 5f72 6567 696f 6e2c  ore_time_region,
+00047630: 200d 0a09 0909 0909 0909 0977 6176 655f   ..........wave_
+00047640: 6e6d 5f62 696e 203d 2073 656c 662e 7761  nm_bin = self.wa
+00047650: 7665 5f6e 6d5f 6269 6e2c 2077 6176 656c  ve_nm_bin, wavel
+00047660: 656e 6774 685f 6269 6e20 3d20 7365 6c66  ength_bin = self
+00047670: 2e77 6964 7468 290d 0a09 0909 090d 0a09  .width).........
+00047680: 0909 0973 656c 662e 6178 5f6b 696e 6574  ...self.ax_kinet
+00047690: 6963 2e73 6574 5f78 6c69 6d28 6d69 6e28  ic.set_xlim(min(
+000476a0: 5b30 2c6d 696e 2864 735f 7465 6d70 2e76  [0,min(ds_temp.v
+000476b0: 616c 7565 7329 5d29 2c6d 6178 285b 6d61  alues)]),max([ma
+000476c0: 7828 6473 5f74 656d 702e 7661 6c75 6573  x(ds_temp.values
+000476d0: 292c 305d 2929 0d0a 0d0a 0909 0909 7365  ),0]))........se
+000476e0: 6c66 2e61 785f 6b69 6e65 7469 632e 706c  lf.ax_kinetic.pl
+000476f0: 6f74 2864 735f 7465 6d70 2e76 616c 7565  ot(ds_temp.value
+00047700: 732c 6473 5f74 656d 702e 696e 6465 782e  s,ds_temp.index.
+00047710: 7661 6c75 6573 2c27 2a27 2c6c 6162 656c  values,'*',label
+00047720: 3d27 252e 3066 2725 782c 2063 6f6c 6f72  ='%.0f'%x, color
+00047730: 3d27 626c 6163 6b27 290d 0a09 0909 0973  ='black')......s
+00047740: 656c 662e 6178 5f6b 696e 6574 6963 2e70  elf.ax_kinetic.p
+00047750: 6c6f 7428 5b30 2c30 5d2c 7365 6c66 2e61  lot([0,0],self.a
+00047760: 785f 6b69 6e65 7469 632e 6765 745f 796c  x_kinetic.get_yl
+00047770: 696d 2829 2c27 6772 6179 2729 0d0a 0909  im(),'gray')....
+00047780: 0909 7365 6c66 2e61 785f 6b69 6e65 7469  ..self.ax_kineti
+00047790: 632e 6c65 6765 6e64 285b 2725 2e30 6627  c.legend(['%.0f'
+000477a0: 2578 5d29 0909 0909 0d0a 0909 0909 7365  %x])..........se
+000477b0: 6c66 2e61 785f 6b69 6e65 7469 632e 7365  lf.ax_kinetic.se
+000477c0: 745f 7874 6963 6b73 2873 656c 662e 6178  t_xticks(self.ax
+000477d0: 5f6b 696e 6574 6963 2e67 6574 5f78 6c69  _kinetic.get_xli
+000477e0: 6d28 2929 0d0a 0909 0909 7365 6c66 2e61  m())......self.a
+000477f0: 785f 6b69 6e65 7469 632e 7365 745f 7874  x_kinetic.set_xt
+00047800: 6963 6b6c 6162 656c 7328 5b27 252e 3165  icklabels(['%.1e
+00047810: 2725 6620 666f 7220 6620 696e 2073 656c  '%f for f in sel
+00047820: 662e 6178 5f6b 696e 6574 6963 2e67 6574  f.ax_kinetic.get
+00047830: 5f78 6c69 6d28 295d 290d 0a09 0909 0973  _xlim()])......s
+00047840: 656c 662e 6178 5f6b 696e 6574 6963 2e73  elf.ax_kinetic.s
+00047850: 6574 5f79 7469 636b 6c61 6265 6c73 2873  et_yticklabels(s
+00047860: 656c 662e 6178 2e67 6574 5f79 7469 636b  elf.ax.get_ytick
+00047870: 6c61 6265 6c73 2829 290d 0a09 0909 0970  labels())......p
+00047880: 6c74 2e73 7562 706c 6f74 735f 6164 6a75  lt.subplots_adju
+00047890: 7374 2877 7370 6163 653d 302c 6873 7061  st(wspace=0,hspa
+000478a0: 6365 3d30 290d 0a09 0909 090d 0a09 0965  ce=0)..........e
+000478b0: 7665 3d4d 6f75 7365 4d6f 7665 2864 732c  ve=MouseMove(ds,
+000478c0: 2063 6d61 702c 2073 656c 662e 696e 7465   cmap, self.inte
+000478d0: 6e73 6974 795f 7261 6e67 652c 2073 656c  nsity_range, sel
+000478e0: 662e 6c6f 675f 7363 616c 652c 2073 656c  f.log_scale, sel
+000478f0: 662e 6261 7365 756e 6974 2c20 7365 6c66  f.baseunit, self
+00047900: 2e74 696d 656c 696d 6974 732c 200d 0a09  .timelimits, ...
+00047910: 0909 0909 0973 656c 662e 7363 6174 7465  .....self.scatte
+00047920: 7263 7574 2c20 7365 6c66 2e62 6f72 6465  rcut, self.borde
+00047930: 7263 7574 2c20 7365 6c66 2e77 6176 655f  rcut, self.wave_
+00047940: 6e6d 5f62 696e 2c20 7365 6c66 2e65 7175  nm_bin, self.equ
+00047950: 616c 5f65 6e65 7267 795f 6269 6e2c 2073  al_energy_bin, s
+00047960: 656c 662e 6967 6e6f 7265 5f74 696d 655f  elf.ignore_time_
+00047970: 7265 6769 6f6e 2c0d 0a09 0909 0909 0973  region,........s
+00047980: 656c 662e 7469 6d65 5f62 696e 2c20 7365  elf.time_bin, se
+00047990: 6c66 2e6c 696e 7472 6573 682c 2073 656c  lf.lintresh, sel
+000479a0: 662e 6461 7461 5f74 7970 652c 2073 656c  f.data_type, sel
+000479b0: 662e 7761 7665 6c65 6e67 7468 5f62 696e  f.wavelength_bin
+000479c0: 2c20 7365 6c66 2e74 696d 655f 7769 6474  , self.time_widt
+000479d0: 685f 7065 7263 656e 7429 0d0a 0909 6375  h_percent)....cu
+000479e0: 7273 6f72 203d 2043 7572 736f 7228 6576  rsor = Cursor(ev
+000479f0: 652e 6178 2c20 7573 6562 6c69 743d 5472  e.ax, useblit=Tr
+00047a00: 7565 2c20 636f 6c6f 723d 2772 6564 272c  ue, color='red',
+00047a10: 206c 696e 6577 6964 7468 3d32 290d 0a09   linewidth=2)...
+00047a20: 0972 6574 7572 6e20 6576 652c 6375 7273  .return eve,curs
+00047a30: 6f72 0d0a 0909 0d0a 0d0a 0d0a 0964 6566  or...........def
+00047a40: 2050 6c6f 745f 5241 5728 7365 6c66 2c20   Plot_RAW(self, 
+00047a50: 706c 6f74 7469 6e67 203d 2072 616e 6765  plotting = range
+00047a60: 2834 292c 2074 6974 6c65 203d 204e 6f6e  (4), title = Non
+00047a70: 652c 2073 6361 6c65 5f74 7970 6520 3d20  e, scale_type = 
+00047a80: 2773 796d 6c6f 6727 2c20 7469 6d65 7320  'symlog', times 
+00047a90: 3d20 4e6f 6e65 2c0d 0a09 0909 0963 6d61  = None,......cma
+00047aa0: 7020 3d20 4e6f 6e65 2c20 6669 6c65 6e61  p = None, filena
+00047ab0: 6d65 203d 204e 6f6e 652c 2070 6174 6820  me = None, path 
+00047ac0: 3d20 2272 6573 756c 745f 6669 6775 7265  = "result_figure
+00047ad0: 7322 2c20 7361 7665 7479 7065 203d 2027  s", savetype = '
+00047ae0: 706e 6727 202c 2070 7269 6e74 5f63 6c69  png' , print_cli
+00047af0: 636b 5f70 6f73 6974 696f 6e20 3d20 4661  ck_position = Fa
+00047b00: 6c73 652c 0d0a 0909 0909 706c 6f74 5f73  lse,......plot_s
+00047b10: 6563 6f6e 645f 6173 5f65 6e65 7267 7920  econd_as_energy 
+00047b20: 3d20 5472 7565 2c20 6473 203d 204e 6f6e  = True, ds = Non
+00047b30: 6529 3a0d 0a09 0927 2727 5468 6973 2069  e):....'''This i
+00047b40: 7320 6120 7772 6170 7065 7220 6675 6e63  s a wrapper func
+00047b50: 7469 6f6e 2074 6861 7420 7472 6967 6765  tion that trigge
+00047b60: 7273 2074 6865 2070 6c6f 7474 696e 6720  rs the plotting 
+00047b70: 6f66 2076 6172 696f 7573 2052 4157 2028  of various RAW (
+00047b80: 6e6f 6e20 6669 7474 6564 2920 706c 6f74  non fitted) plot
+00047b90: 732e 200d 0a09 0954 6865 2073 6861 7069  s. ....The shapi
+00047ba0: 6e67 2070 6172 616d 6574 6572 2061 7265  ng parameter are
+00047bb0: 2074 616b 656e 2066 726f 6d20 7468 6520   taken from the 
+00047bc0: 6f62 6a65 6374 2061 6e64 2073 686f 756c  object and shoul
+00047bd0: 6420 6265 2064 6566 696e 6564 2062 6566  d be defined bef
+00047be0: 6f72 652e 0d0a 0909 5468 6520 7061 7261  ore.....The para
+00047bf0: 6d65 7465 7220 696e 2074 6869 7320 706c  meter in this pl
+00047c00: 6f74 2063 616c 6c20 6172 6520 746f 2063  ot call are to c
+00047c10: 6f6e 7472 6f6c 2074 6865 2067 656e 6572  ontrol the gener
+00047c20: 616c 206c 6f6f 6b20 616e 6420 6665 6174  al look and feat
+00047c30: 7572 6573 206f 6620 7468 6520 706c 6f74  ures of the plot
+00047c40: 2e0d 0a09 0957 6869 6368 2070 6c6f 7473  .....Which plots
+00047c50: 2061 7265 2070 7269 6e74 6564 2069 7320   are printed is 
+00047c60: 6465 6669 6e65 6420 6279 7420 7468 6520  defined byt the 
+00047c70: 6669 7273 7420 636f 6d6d 616e 6420 2870  first command (p
+00047c80: 6c6f 7474 696e 6729 0d0a 0909 5468 6520  lotting)....The 
+00047c90: 706c 6f74 7320 6172 6520 6765 6e65 7261  plots are genera
+00047ca0: 7465 6420 6f6e 2074 6865 2066 6c79 2075  ted on the fly u
+00047cb0: 7369 6e67 2073 656c 662e 6473 2061 6e64  sing self.ds and
+00047cc0: 2061 6c6c 2074 6865 2073 6861 7069 6e67   all the shaping
+00047cd0: 2070 6172 616d 6574 6572 0d0a 0909 496e   parameter....In
+00047ce0: 2061 6c6c 2070 6c6f 7473 2074 6865 2052   all plots the R
+00047cf0: 4157 2064 6174 6120 6973 2070 6c6f 7474  AW data is plott
+00047d00: 6564 2061 7320 646f 7473 2061 6e64 2069  ed as dots and i
+00047d10: 6e74 6572 706f 6c61 7465 6420 7769 7468  nterpolated with
+00047d20: 206c 696e 6573 200d 0a09 0928 7573 696e   lines ....(usin
+00047d30: 6720 5361 7669 747a 6b79 2d47 6f6c 6179  g Savitzky-Golay
+00047d40: 2077 696e 646f 773d 352c 206f 7264 6572   window=5, order
+00047d50: 3d33 2069 6e74 6572 706f 6c61 7469 6f6e  =3 interpolation
+00047d60: 292e 2041 7320 6465 6669 6e65 6420 6279  ). As defined by
+00047d70: 2074 6865 2069 6e74 6572 6e61 6c20 7061   the internal pa
+00047d80: 7261 6d65 7465 7273 200d 0a09 0961 7420  rameters ....at 
+00047d90: 7365 6c65 6374 6564 2074 696d 652d 706f  selected time-po
+00047da0: 696e 7473 2061 6e64 2074 6865 206b 696e  ints and the kin
+00047db0: 6574 6963 7320 666f 7220 7365 6c65 6374  etics for select
+00047dc0: 6564 2077 6176 656c 656e 6774 6820 6172  ed wavelength ar
+00047dd0: 6520 7368 6170 6564 2062 7920 7468 6520  e shaped by the 
+00047de0: 0d0a 0909 6f62 6a65 6374 2070 6172 616d  ....object param
+00047df0: 6574 6572 2e20 5468 6520 5356 4420 6973  eter. The SVD is
+00047e00: 2070 6572 666f 726d 6564 2075 7369 6e67   performed using
+00047e10: 2074 6865 2073 616d 6520 7368 6170 696e   the same shapin
+00047e20: 6720 7061 7261 6d65 7465 7220 616e 6420  g parameter and 
+00047e30: 6973 2063 6f6d 6d6f 6e6c 7920 0d0a 0909  is commonly ....
+00047e40: 7573 6564 2061 7320 616e 206f 7269 656e  used as an orien
+00047e50: 7461 7469 6f6e 2066 6f72 2074 6865 206e  tation for the n
+00047e60: 756d 6265 7220 6f66 2063 6f6d 706f 6e65  umber of compone
+00047e70: 6e74 7320 696e 2074 6865 2064 6174 612e  nts in the data.
+00047e80: 0d0a 0909 4576 6572 7974 6869 6e67 2069  ....Everything i
+00047e90: 7320 6861 6e64 6564 206f 7665 7220 746f  s handed over to
+00047ea0: 2027 706c 6f74 5f72 6177 2720 6675 6e63   'plot_raw' func
+00047eb0: 7469 6f6e 2074 6861 7420 6361 6e20 6265  tion that can be
+00047ec0: 2075 7365 6420 666f 7220 6578 7465 6e64   used for extend
+00047ed0: 6564 2052 4157 2070 6c6f 7474 696e 672e  ed RAW plotting.
+00047ee0: 0d0a 0909 0d0a 0909 5061 7261 6d65 7465  ........Paramete
+00047ef0: 7273 0d0a 0909 2d2d 2d2d 2d2d 2d2d 2d2d  rs....----------
+00047f00: 2d2d 2d2d 2d0d 0a09 090d 0a09 0970 6c6f  -----........plo
+00047f10: 7474 696e 6720 3a20 696e 7420 6f72 2069  tting : int or i
+00047f20: 7465 7261 626c 6520 286f 6620 696e 7465  terable (of inte
+00047f30: 6765 7273 292c 206f 7074 696f 6e61 6c0d  gers), optional.
+00047f40: 0a09 0909 5468 6973 2070 6172 616d 6574  ....This paramet
+00047f50: 6572 2064 6574 6572 6d69 6e65 7320 7768  er determines wh
+00047f60: 6963 6820 6669 6775 7265 7320 6172 6520  ich figures are 
+00047f70: 706c 6f74 7465 6420 0d0a 0909 0974 6865  plotted .....the
+00047f80: 2066 6967 7572 6573 2063 616e 2062 6520   figures can be 
+00047f90: 6361 6c6c 6564 2073 6570 6172 6174 656c  called separatel
+00047fa0: 7920 7769 7468 2070 6c6f 7474 696e 6720  y with plotting 
+00047fb0: 3d20 310d 0a09 0909 6f72 2077 6974 6820  = 1.....or with 
+00047fc0: 6120 6c69 7374 206f 6620 706c 6f74 7320  a list of plots 
+00047fd0: 2844 6566 6175 6c74 2920 652e 672e 2070  (Default) e.g. p
+00047fe0: 6c6f 7474 696e 673d 7261 6e67 6528 3429  lotting=range(4)
+00047ff0: 2063 616c 6c73 2070 6c6f 7473 2030 2c31   calls plots 0,1
+00048000: 2c32 2c33 2e0d 0a09 0909 5468 6520 706c  ,2,3......The pl
+00048010: 6f74 7320 6861 7665 2074 6865 2066 6f6c  ots have the fol
+00048020: 6c6f 7769 6e67 206e 756d 6265 7273 3a20  lowing numbers: 
+00048030: 0d0a 0909 090d 0a09 0909 0930 2e20 4d61  ...........0. Ma
+00048040: 7472 6978 0d0a 0909 0909 312e 204b 696e  trix......1. Kin
+00048050: 6574 6963 730d 0a09 0909 0932 2e20 5370  etics......2. Sp
+00048060: 6563 7472 610d 0a09 0909 0933 2e20 5356  ectra......3. SV
+00048070: 4420 0d0a 0909 090d 0a09 0909 5468 6520  D ..........The 
+00048080: 706c 6f74 7469 6e67 2074 616b 6573 2061  plotting takes a
+00048090: 6c6c 2070 6172 616d 6574 6572 2066 726f  ll parameter fro
+000480a0: 6d20 7468 6520 2274 6122 206f 626a 6563  m the "ta" objec
+000480b0: 742e 0d0a 0909 0d0a 0909 7469 746c 6520  t.........title 
+000480c0: 3a20 4e6f 6e65 206f 7220 7374 720d 0a09  : None or str...
+000480d0: 0909 7469 746c 6520 746f 2062 6520 7573  ..title to be us
+000480e0: 6564 206f 6e20 746f 7020 6f66 2065 6163  ed on top of eac
+000480f0: 6820 706c 6f74 0d0a 0909 0954 6865 2028  h plot.....The (
+00048100: 4465 6661 756c 7429 204e 6f6e 6520 7472  Default) None tr
+00048110: 6967 6765 7273 2020 7365 6c66 2e66 696c  iggers  self.fil
+00048120: 656e 616d 6520 746f 2062 6520 7573 6564  ename to be used
+00048130: 2e20 5365 7474 696e 6720 6120 7370 6563  . Setting a spec
+00048140: 6966 6963 2074 6974 6c65 2061 7320 7374  ific title as st
+00048150: 7269 6e67 2077 696c 6c2e 0d0a 0909 0962  ring will......b
+00048160: 6520 7573 6564 2069 6e20 616c 6c20 706c  e used in all pl
+00048170: 6f74 732e 2054 6f20 7265 6d6f 7665 2074  ots. To remove t
+00048180: 6865 2074 6974 6c65 2061 6c6c 2074 6f67  he title all tog
+00048190: 6574 6865 7220 7365 7420 616e 2065 6d70  ether set an emp
+000481a0: 7479 2073 7472 696e 6720 7769 7468 2074  ty string with t
+000481b0: 6869 7320 636f 6d6d 616e 6420 7469 746c  his command titl
+000481c0: 653d 2222 202e 0d0a 0909 0d0a 0909 5363  e="" .........Sc
+000481d0: 616c 655f 7479 7065 203a 204e 6f6e 6520  ale_type : None 
+000481e0: 6f72 2073 7472 0d0a 0909 0969 7320 6120  or str.....is a 
+000481f0: 6765 6e65 7261 6c20 7365 7474 696e 6720  general setting 
+00048200: 7468 6174 2063 616e 2069 6e66 6c75 656e  that can influen
+00048210: 6365 7320 7768 6174 2074 696d 6520 6178  ces what time ax
+00048220: 6973 2077 696c 6c20 6265 2075 7365 6420  is will be used 
+00048230: 666f 7220 7468 6520 706c 6f74 732e 200d  for the plots. .
+00048240: 0a09 0909 2273 796d 6c6f 6722 2028 6c69  ...."symlog" (li
+00048250: 6e65 6172 2061 726f 756e 6420 7a65 726f  near around zero
+00048260: 2061 6e64 206c 6f67 6172 6974 686d 6963   and logarithmic
+00048270: 206f 7468 6572 7769 7365 2920 226c 696e   otherwise) "lin
+00048280: 2220 616e 6420 226c 6f67 2220 6172 6520  " and "log" are 
+00048290: 7661 6c69 6420 6f70 7469 6f6e 732e 0d0a  valid options...
+000482a0: 0909 0d0a 0909 7469 6d65 7320 3a20 696e  ......times : in
+000482b0: 740d 0a09 0909 6172 6520 7468 6520 6e75  t.....are the nu
+000482c0: 6d62 6572 206f 6620 636f 6d70 6f6e 656e  mber of componen
+000482d0: 7473 2074 6f20 6265 2075 7365 6420 696e  ts to be used in
+000482e0: 2074 6865 2053 5644 2028 4465 6661 756c   the SVD (Defaul
+000482f0: 7429 2069 7320 362e 0d0a 0909 0d0a 0909  t) is 6.........
+00048300: 636d 6170 203a 204e 6f6e 6520 6f72 206d  cmap : None or m
+00048310: 6174 706c 6f74 6c69 6220 636f 6c6f 7220  atplotlib color 
+00048320: 6d61 702c 206f 7074 696f 6e61 6c0d 0a09  map, optional...
+00048330: 0909 6973 2061 2070 6f77 6572 6675 6c6c  ..is a powerfull
+00048340: 2076 6172 6961 626c 6520 7468 6174 2063   variable that c
+00048350: 686f 6f73 6573 2074 6865 2063 6f6c 6f75  hooses the colou
+00048360: 7220 6d61 7020 6170 706c 6965 6420 666f  r map applied fo
+00048370: 7220 616c 6c20 706c 6f74 732e 2049 6620  r all plots. If 
+00048380: 7365 7420 746f 200d 0a09 0909 4e6f 6e65  set to .....None
+00048390: 2028 4465 6661 756c 7429 2074 6865 6e20   (Default) then 
+000483a0: 7468 6520 7365 6c66 2e63 6d61 7020 6973  the self.cmap is
+000483b0: 2075 7365 642e 0d0a 0909 0941 7320 7374   used......As st
+000483c0: 616e 6461 7264 2049 2075 7365 2074 6865  andard I use the
+000483d0: 2063 6f6c 6f72 206d 6170 2022 6a65 7422   color map "jet"
+000483e0: 2066 726f 6d20 6d61 7470 6c6f 746c 6962   from matplotlib
+000483f0: 2e20 5468 6572 6520 6172 6520 6120 7661  . There are a va
+00048400: 7269 6574 7920 6f66 2063 6f6c 6f72 6d61  riety of colorma
+00048410: 7073 200d 0a09 0909 6176 6169 6c61 626c  ps .....availabl
+00048420: 6520 7468 6174 2061 7265 2076 6572 7920  e that are very 
+00048430: 7573 6566 756c 6c2e 2042 6573 6964 6520  usefull. Beside 
+00048440: 226a 6574 222c 2022 7669 7269 6469 7322  "jet", "viridis"
+00048450: 2069 7320 6120 676f 6f64 2063 686f 6963   is a good choic
+00048460: 6520 6173 2069 7420 6973 2077 656c 6c20  e as it is well 
+00048470: 0d0a 0909 0976 6973 6962 6c65 2075 6e64  .....visible und
+00048480: 6572 2072 6564 2d67 7265 656e 2062 6c69  er red-green bli
+00048490: 6e64 6e65 7373 2e20 4f74 6865 7220 7573  ndness. Other us
+000484a0: 6566 756c 206d 6170 7320 6172 6520 2270  eful maps are "p
+000484b0: 7269 736d 2220 666f 7220 6869 6768 2066  rism" for high f
+000484c0: 6c75 6374 7561 7469 6f6e 7320 0d0a 0909  luctuations ....
+000484d0: 096f 7220 6469 7665 7267 696e 6720 636f  .or diverging co
+000484e0: 6c6f 7220 6d61 7073 206c 696b 6520 2273  lor maps like "s
+000484f0: 6569 736d 6963 222e 200d 0a09 0909 5365  eismic". .....Se
+00048500: 6520 6874 7470 733a 2f2f 6d61 7470 6c6f  e https://matplo
+00048510: 746c 6962 2e6f 7267 2f33 2e31 2e30 2f74  tlib.org/3.1.0/t
+00048520: 7574 6f72 6961 6c73 2f63 6f6c 6f72 732f  utorials/colors/
+00048530: 636f 6c6f 726d 6170 732e 6874 6d6c 2066  colormaps.html f
+00048540: 6f72 2061 2063 6f6d 7072 6568 656e 7369  or a comprehensi
+00048550: 7665 200d 0a09 0909 7365 6c65 6374 696f  ve .....selectio
+00048560: 6e2e 2049 6e20 7468 6520 636f 6465 2074  n. In the code t
+00048570: 6865 2063 6f6c 6f72 6d61 7073 2061 7265  he colormaps are
+00048580: 2069 6d70 6f72 7465 6420 736f 2069 6620   imported so if 
+00048590: 706c 6f74 5f66 756e 6320 6973 2069 6d70  plot_func is imp
+000485a0: 6f72 7465 6420 6173 2070 6620 7468 656e  orted as pf then
+000485b0: 200d 0a09 0909 7365 6c66 2e63 6d61 703d   .....self.cmap=
+000485c0: 7066 2e63 6d2e 7669 7269 6469 7320 7365  pf.cm.viridis se
+000485d0: 7473 2076 6972 6964 6973 2061 7320 7468  ts viridis as th
+000485e0: 6520 6d61 7020 746f 2075 7365 2e20 496e  e map to use. In
+000485f0: 7465 726e 616c 6c79 2074 6865 2063 6f6c  ternally the col
+00048600: 6f72 7320 6172 6520 6368 6f73 656e 200d  ors are chosen .
+00048610: 0a09 0909 7769 7468 2074 6865 2022 636f  ....with the "co
+00048620: 6c6d 2220 6675 6e63 7469 6f6e 2e20 5468  lm" function. Th
+00048630: 6520 3264 2070 6c6f 7473 2072 6571 7569  e 2d plots requi
+00048640: 7265 2061 2063 6f6e 7469 6e75 6f75 7320  re a continuous 
+00048650: 636f 6c6f 7220 6d61 7020 736f 2069 6620  color map so if 
+00048660: 736f 6d65 7468 696e 6720 0d0a 0909 0965  something .....e
+00048670: 6c73 6520 6973 2067 6976 6520 3264 2070  lse is give 2d p
+00048680: 6c6f 7473 2061 7265 2073 686f 776e 2061  lots are shown a
+00048690: 7574 6f6d 6174 6963 616c 6c79 2077 6974  utomatically wit
+000486a0: 6820 226a 6574 222e 2046 6f72 2061 6c6c  h "jet". For all
+000486b0: 206f 6620 7468 6520 3164 2070 6c6f 7473   of the 1d plots
+000486c0: 2068 6f77 6576 6572 200d 0a09 0909 4920   however .....I 
+000486d0: 6669 7273 7420 7365 6c65 6374 2061 206e  first select a n
+000486e0: 756d 6265 7220 6f66 2063 6f6c 6f72 7320  umber of colors 
+000486f0: 6265 666f 7265 2065 6163 6820 706c 6f74  before each plot
+00048700: 2e20 4966 2063 6d61 7020 6973 2061 2063  . If cmap is a c
+00048710: 6f6e 7469 6e6f 7573 206d 6170 2074 6865  ontinous map the
+00048720: 6e20 7468 6573 650d 0a09 0909 6172 6520  n these.....are 
+00048730: 7361 6d70 6c65 6420 6576 656e 6c79 206f  sampled evenly o
+00048740: 7665 7220 7468 6520 636f 6c6f 7572 6d61  ver the colourma
+00048750: 702e 204d 616e 7561 6c20 6974 6572 6162  p. Manual iterab
+00048760: 6c65 7320 6f66 2063 6f6c 6f75 7273 200d  les of colours .
+00048770: 0a09 0909 636d 6170 3d5b 2831 2c30 2c30  ....cmap=[(1,0,0
+00048780: 292c 2830 2c31 2c30 292c 2830 2c30 2c31  ),(0,1,0),(0,0,1
+00048790: 292c 2e2e 2e5d 2061 7265 2061 6c73 6f20  ),...] are also 
+000487a0: 6163 6365 7074 6564 2c20 6173 2061 7265  accepted, as are
+000487b0: 2076 6563 746f 7273 206f 7220 6461 7461   vectors or data
+000487c0: 6672 616d 6573 2074 6861 7420 0d0a 0909  frames that ....
+000487d0: 0963 6f6e 7461 696e 2061 7320 726f 7773  .contain as rows
+000487e0: 2074 6865 2063 6f6c 6f72 732e 2054 6865   the colors. The
+000487f0: 7265 206d 7573 7420 6265 206f 6620 636f  re must be of co
+00048800: 7572 7365 2073 7566 6669 6369 656e 7420  urse sufficient 
+00048810: 636f 6c6f 7273 2070 7265 7365 6e74 2066  colors present f
+00048820: 6f72 200d 0a09 0909 7468 6520 6e75 6d62  or .....the numb
+00048830: 6572 7320 6f66 206c 696e 6573 2074 6861  ers of lines tha
+00048840: 7420 7769 6c6c 2062 6520 706c 6f74 7465  t will be plotte
+00048850: 642e 2053 6f20 4920 7265 636f 6d6d 656e  d. So I recommen
+00048860: 6420 746f 2070 726f 7669 6465 2061 7420  d to provide at 
+00048870: 6c65 6173 7420 3130 2063 6f6c 6f75 7273  least 10 colours
+00048880: 200d 0a09 0909 2865 2e67 2e7e 796f 7572   .....(e.g.~your
+00048890: 2075 6e69 7665 7273 6974 7920 636f 6c6f   university colo
+000488a0: 7273 292e 2063 6f6c 6f75 7273 2061 7265  rs). colours are
+000488b0: 2061 6c77 6179 7320 6769 7665 6e20 6173   always given as
+000488c0: 2061 2c20 6c69 7374 206f 7220 7475 706c   a, list or tupl
+000488d0: 6520 7769 7468 2052 4741 206f 7220 5247  e with RGA or RG
+000488e0: 4241 0d0a 0909 0928 7769 7468 2074 6865  BA.....(with the
+000488f0: 206c 6173 7420 4120 6265 6569 6e67 2074   last A beeing t
+00048900: 6865 2041 6c70 6861 3d74 7261 6e73 7061  he Alpha=transpa
+00048910: 7265 6e63 792e 2041 6c6c 206e 756d 6265  rency. All numbe
+00048920: 7273 2061 7265 2062 6574 7765 656e 2030  rs are between 0
+00048930: 2061 6e64 2031 2e20 0d0a 0909 0949 6620   and 1. .....If 
+00048940: 6120 6c69 7374 2f76 6563 746f 722f 4461  a list/vector/Da
+00048950: 7461 4672 616d 6520 6973 2067 6976 656e  taFrame is given
+00048960: 2066 6f72 2074 6865 2063 6f6c 6f75 7273   for the colours
+00048970: 2074 6865 7920 7769 6c6c 2062 6520 7573   they will be us
+00048980: 6564 2069 6e20 7468 6520 6f72 6465 7220  ed in the order 
+00048990: 7072 6f76 6964 6564 2e09 090d 0a09 090d  provided........
+000489a0: 0a09 0966 696c 656e 616d 6520 3a20 7374  ...filename : st
+000489b0: 722c 206f 7074 696f 6e61 6c0d 0a09 0909  r, optional.....
+000489c0: 6f66 6665 7273 2074 6f20 7265 706c 6163  offers to replac
+000489d0: 6520 7468 6520 6261 7365 2d6e 616d 6520  e the base-name 
+000489e0: 7573 6564 2066 6f72 2061 6c6c 2070 6c6f  used for all plo
+000489f0: 7473 2028 746f 2065 2e67 2e7e 7370 6563  ts (to e.g.~spec
+00048a00: 6966 7920 7768 6174 2073 616d 706c 6520  ify what sample 
+00048a10: 7761 7320 7573 6564 292e 200d 0a09 0909  was used). .....
+00048a20: 6966 2028 4465 6661 756c 7429 204e 6f6e  if (Default) Non
+00048a30: 6520 6973 2075 7365 642c 2074 6865 2073  e is used, the s
+00048a40: 656c 662e 6669 6c65 6e61 6d65 2069 7320  elf.filename is 
+00048a50: 7573 6564 2061 7320 6120 6261 7365 206e  used as a base n
+00048a60: 616d 652e 2054 6865 2066 696c 656e 616d  ame. The filenam
+00048a70: 6520 706c 6179 7320 6f6e 6c79 2061 200d  e plays only a .
+00048a80: 0a09 0909 726f 6c65 2064 7572 696e 6720  ....role during 
+00048a90: 7361 7669 6e67 2c20 6173 2064 6f65 7320  saving, as does 
+00048aa0: 7468 6520 7061 7468 2061 6e64 2073 6176  the path and sav
+00048ab0: 6574 7970 652e 0d0a 0909 0d0a 0909 7061  etype.........pa
+00048ac0: 7468 203a 204e 6f6e 6520 6f72 2073 7472  th : None or str
+00048ad0: 206f 7220 7061 7468 206f 626a 6563 742c   or path object,
+00048ae0: 206f 7074 696f 6e61 6c0d 0a09 0909 5468   optional.....Th
+00048af0: 6973 2064 6566 696e 6573 2077 6865 7265  is defines where
+00048b00: 2074 6865 2066 696c 6573 2061 7265 2073   the files are s
+00048b10: 6176 6564 2069 6620 7468 6520 7361 6665  aved if the safe
+00048b20: 5f66 6967 7572 6573 5f74 6f5f 666f 6c64  _figures_to_fold
+00048b30: 6572 2070 6172 616d 6574 6572 2069 7320  er parameter is 
+00048b40: 5472 7565 2c20 0d0a 0909 0971 7569 7465  True, .....quite
+00048b50: 2075 7365 6675 6c20 6966 2061 206c 6f74   useful if a lot
+00048b60: 206f 6620 6461 7461 2073 6574 7320 6172   of data sets ar
+00048b70: 6520 746f 2062 6520 7072 696e 7465 6420  e to be printed 
+00048b80: 6661 7374 2e20 0d0a 0909 0949 6620 6120  fast. .....If a 
+00048b90: 7061 7468 2069 7320 6769 7665 6e2c 2074  path is given, t
+00048ba0: 6869 7320 6973 2075 7365 642e 2049 6620  his is used. If 
+00048bb0: 6120 7374 7269 6e67 206c 696b 6520 7468  a string like th
+00048bc0: 6520 2844 6566 6175 6c74 2920 2272 6573  e (Default) "res
+00048bd0: 756c 745f 6669 6775 7265 7322 2069 7320  ult_figures" is 
+00048be0: 6769 7665 6e2c 200d 0a09 0909 7468 656e  given, .....then
+00048bf0: 2061 2073 7562 666f 6c64 6572 206f 6620   a subfolder of 
+00048c00: 7468 6973 206e 616d 6520 7769 6c6c 2062  this name will b
+00048c10: 6520 7573 6564 2028 616e 2067 656e 6572  e used (an gener
+00048c20: 6174 6564 2069 6620 6e65 6365 7373 6172  ated if necessar
+00048c30: 7929 200d 0a09 0909 7265 6c61 7469 7665  y) .....relative
+00048c40: 2074 6f20 7365 6c66 2e70 6174 682e 2055   to self.path. U
+00048c50: 7365 2061 6e64 2065 6d70 7479 2073 7472  se and empty str
+00048c60: 696e 6720 746f 2075 7365 2074 6865 2073  ing to use the s
+00048c70: 656c 662e 7061 7468 0d0a 0909 0949 6620  elf.path.....If 
+00048c80: 7365 7420 746f 204e 6f6e 652c 2074 6865  set to None, the
+00048c90: 206c 6f63 6174 696f 6e20 6f66 2074 6865   location of the
+00048ca0: 2070 6c6f 745f 6675 6e63 2077 696c 6c20   plot_func will 
+00048cb0: 6265 2075 7365 6420 616e 640d 0a09 0909  be used and.....
+00048cc0: 6120 7375 6266 6f6c 6465 7220 7769 7468  a subfolder with
+00048cd0: 2074 6974 6c65 2022 7265 7375 6c74 5f66   title "result_f
+00048ce0: 6967 7572 6573 2220 6265 2067 656e 6572  igures" be gener
+00048cf0: 6174 6564 2068 6572 652e 0d0a 0909 0d0a  ated here.......
+00048d00: 0909 7361 7665 7479 7065 203a 2073 7472  ..savetype : str
+00048d10: 206f 7220 6974 6572 6162 6c65 2028 6f66   or iterable (of
+00048d20: 2073 7472 292c 206f 7074 696f 6e61 6c20   str), optional 
+00048d30: 0d0a 0909 096d 6174 706c 6f74 6c69 6220  .....matplotlib 
+00048d40: 616c 6c6f 7773 2074 6865 2073 6176 696e  allows the savin
+00048d50: 6720 6f66 2066 6967 7572 6573 2069 6e20  g of figures in 
+00048d60: 7661 7269 6f75 7320 666f 726d 6174 732e  various formats.
+00048d70: 2028 4465 6661 756c 7429 2022 706e 6722   (Default) "png"
+00048d80: 2c20 0d0a 0909 0974 7970 6963 616c 2061  , .....typical a
+00048d90: 6e64 2072 6563 6f6d 6d65 6e64 6162 6c65  nd recommendable
+00048da0: 206f 7074 696f 6e73 2061 7265 2022 7376   options are "sv
+00048db0: 6722 2061 6e64 2022 7064 6622 2e20 200d  g" and "pdf".  .
+00048dc0: 0a09 0909 0d0a 0909 7072 696e 745f 636c  ........print_cl
+00048dd0: 6963 6b5f 706f 7369 7469 6f6e 203a 2062  ick_position : b
+00048de0: 6f6f 6c2c 206f 7074 696f 6e61 6c0d 0a09  ool, optional...
+00048df0: 0909 6966 2054 7275 6520 7468 656e 2074  ..if True then t
+00048e00: 6865 2063 6c69 636b 2070 6f73 6974 696f  he click positio
+00048e10: 6e20 6973 2070 7269 6e74 6564 2066 6f72  n is printed for
+00048e20: 2074 6865 2073 7065 6374 7261 6c20 706c   the spectral pl
+00048e30: 6f74 7320 0d0a 0909 090d 0a09 0964 7320  ots .........ds 
+00048e40: 3a20 4461 7461 4672 616d 652c 206f 7074  : DataFrame, opt
+00048e50: 696f 6e61 6c0d 0a09 0909 6966 204e 6f6e  ional.....if Non
+00048e60: 6520 2844 6566 6175 6c74 292c 2074 6865  e (Default), the
+00048e70: 2070 726f 6772 616d 2066 6972 7374 2074   program first t
+00048e80: 6573 7473 2073 656c 662e 6473 2061 6e64  ests self.ds and
+00048e90: 2069 6620 7468 6973 2069 7320 6e6f 7420   if this is not 
+00048ea0: 7468 6572 6520 7468 656e 2073 656c 662e  there then self.
+00048eb0: 6473 5f6f 7269 2e0d 0a09 0909 5468 6973  ds_ori......This
+00048ec0: 206f 7074 696f 6e20 7761 7320 696e 7472   option was intr
+00048ed0: 6f64 7563 6564 2074 6f20 616c 6c6f 7720  oduced to allow 
+00048ee0: 706c 6f74 7469 6e67 206f 6620 6f74 6865  plotting of othe
+00048ef0: 7220 6d61 7472 6978 6573 2077 6974 6820  r matrixes with 
+00048f00: 7468 6520 7361 6d65 2070 6172 616d 6574  the same paramet
+00048f10: 6572 0d0a 0909 0d0a 0909 4578 616d 706c  er........Exampl
+00048f20: 6573 0d0a 0909 2d2d 2d2d 2d2d 2d2d 2d2d  es....----------
+00048f30: 2d2d 0d0a 0909 0d0a 0909 5479 7069 6361  --........Typica
+00048f40: 6c6c 7920 6f6e 6520 776f 756c 6420 6361  lly one would ca
+00048f50: 6c6c 2074 6869 7320 6675 6e63 7469 6f6e  ll this function
+00048f60: 2065 6d70 7479 2066 6f72 2061 6e20 6f76   empty for an ov
+00048f70: 6572 7669 6577 2e20 5765 206e 616d 6520  erview. We name 
+00048f80: 7468 6520 6f62 6a65 6374 2022 7461 2220  the object "ta" 
+00048f90: 736f 2077 6974 680d 0a09 090d 0a09 093e  so with........>
+00048fa0: 3e3e 2074 613d 7066 2e54 4128 2774 6573  >> ta=pf.TA('tes
+00048fb0: 7466 696c 652e 5349 4127 2920 0d0a 0909  tfile.SIA') ....
+00048fc0: 0d0a 0909 5468 6973 2077 6f75 6c64 2074  ....This would t
+00048fd0: 7269 6767 6572 2074 6865 2070 6c6f 7474  rigger the plott
+00048fe0: 696e 6720 6f66 2074 6865 2034 206d 6179  ing of the 4 may
+00048ff0: 6f72 2070 6c6f 7473 2066 6f72 2061 6e20  or plots for an 
+00049000: 6f76 6572 7669 6577 2e0d 0a09 090d 0a09  overview........
+00049010: 093e 3e3e 2074 612e 506c 6f74 5f52 4157  .>>> ta.Plot_RAW
+00049020: 2829 0d0a 0909 0d0a 0909 5468 6973 2077  ()........This w
+00049030: 6f75 6c64 2070 6c6f 7420 6f6e 6c79 2074  ould plot only t
+00049040: 6865 206b 696e 6574 6963 732e 0d0a 0909  he kinetics.....
+00049050: 0d0a 0909 3e3e 3e20 7461 2e50 6c6f 745f  ....>>> ta.Plot_
+00049060: 5241 5728 3129 0d0a 0909 3e3e 3e20 7461  RAW(1)....>>> ta
+00049070: 2e50 6c6f 745f 5241 5728 706c 6f74 7469  .Plot_RAW(plotti
+00049080: 6e67 203d 2031 290d 0a20 0d0a 0909 2727  ng = 1).. ....''
+00049090: 270d 0a09 090d 0a09 0970 6174 683d 6368  '........path=ch
+000490a0: 6563 6b5f 666f 6c64 6572 2870 6174 683d  eck_folder(path=
+000490b0: 7061 7468 2c63 7572 7265 6e74 5f70 6174  path,current_pat
+000490c0: 683d 7365 6c66 2e70 6174 6829 0d0a 0909  h=self.path)....
+000490d0: 6966 2073 656c 662e 7361 7665 5f66 6967  if self.save_fig
+000490e0: 7572 6573 5f74 6f5f 666f 6c64 6572 3a0d  ures_to_folder:.
+000490f0: 0a09 0909 7365 6c66 2e66 6967 7572 655f  ....self.figure_
+00049100: 7061 7468 3d70 6174 680d 0a09 0969 6620  path=path....if 
+00049110: 636d 6170 2069 7320 4e6f 6e65 3a63 6d61  cmap is None:cma
+00049120: 703d 7365 6c66 2e63 6d61 700d 0a09 0969  p=self.cmap....i
+00049130: 6620 6473 2069 7320 4e6f 6e65 3a0d 0a09  f ds is None:...
+00049140: 0909 6966 2073 656c 662e 6473 2069 7320  ..if self.ds is 
+00049150: 4e6f 6e65 3a0d 0a09 0909 0964 733d 7365  None:......ds=se
+00049160: 6c66 2e64 735f 6f72 692e 636f 7079 2829  lf.ds_ori.copy()
+00049170: 0d0a 0909 0965 6c73 653a 0d0a 0909 0909  .....else:......
+00049180: 6473 3d73 656c 662e 6473 2e63 6f70 7928  ds=self.ds.copy(
+00049190: 290d 0a09 0969 6620 6669 6c65 6e61 6d65  )....if filename
+000491a0: 2069 7320 4e6f 6e65 3a20 6669 6c65 6e61   is None: filena
+000491b0: 6d65 3d73 656c 662e 6669 6c65 6e61 6d65  me=self.filename
+000491c0: 0d0a 0909 6966 206e 6f74 2068 6173 6174  ....if not hasat
+000491d0: 7472 2870 6c6f 7474 696e 672c 225f 5f69  tr(plotting,"__i
+000491e0: 7465 725f 5f22 293a 706c 6f74 7469 6e67  ter__"):plotting
+000491f0: 3d5b 706c 6f74 7469 6e67 5d0d 0a09 0969  =[plotting]....i
+00049200: 6620 7469 746c 6520 6973 204e 6f6e 653a  f title is None:
+00049210: 0d0a 0909 0969 6620 6669 6c65 6e61 6d65  .....if filename
+00049220: 2069 7320 4e6f 6e65 3a0d 0a09 0909 0974   is None:......t
+00049230: 6974 6c65 3d73 656c 662e 6669 6c65 6e61  itle=self.filena
+00049240: 6d65 0d0a 0909 0965 6c73 653a 0d0a 0909  me.....else:....
+00049250: 0909 7469 746c 653d 6669 6c65 6e61 6d65  ..title=filename
+00049260: 0d0a 0909 706c 6f74 5f72 6177 2864 733d  ....plot_raw(ds=
+00049270: 6473 2c20 706c 6f74 7469 6e67 3d70 6c6f  ds, plotting=plo
+00049280: 7474 696e 672c 2063 6d61 703d 636d 6170  tting, cmap=cmap
+00049290: 2c20 7469 746c 653d 7469 746c 652c 2070  , title=title, p
+000492a0: 6174 683d 7061 7468 2c20 6669 6c65 6e61  ath=path, filena
+000492b0: 6d65 3d66 696c 656e 616d 652c 200d 0a09  me=filename, ...
+000492c0: 0909 0969 6e74 656e 7369 7479 5f72 616e  ...intensity_ran
+000492d0: 6765 3d73 656c 662e 696e 7465 6e73 6974  ge=self.intensit
+000492e0: 795f 7261 6e67 652c 206c 6f67 5f73 6361  y_range, log_sca
+000492f0: 6c65 3d73 656c 662e 6c6f 675f 7363 616c  le=self.log_scal
+00049300: 652c 2062 6173 6575 6e69 743d 7365 6c66  e, baseunit=self
+00049310: 2e62 6173 6575 6e69 742c 200d 0a09 0909  .baseunit, .....
+00049320: 0974 696d 656c 696d 6974 733d 7365 6c66  .timelimits=self
+00049330: 2e74 696d 656c 696d 6974 732c 2073 6361  .timelimits, sca
+00049340: 7474 6572 6375 743d 7365 6c66 2e73 6361  ttercut=self.sca
+00049350: 7474 6572 6375 742c 2062 6f72 6465 7263  ttercut, borderc
+00049360: 7574 3d73 656c 662e 626f 7264 6572 6375  ut=self.bordercu
+00049370: 742c 200d 0a09 0909 0977 6176 655f 6e6d  t, ......wave_nm
+00049380: 5f62 696e 3d73 656c 662e 7761 7665 5f6e  _bin=self.wave_n
+00049390: 6d5f 6269 6e2c 2072 656c 5f77 6176 653d  m_bin, rel_wave=
+000493a0: 7365 6c66 2e72 656c 5f77 6176 652c 2077  self.rel_wave, w
+000493b0: 6964 7468 3d73 656c 662e 7761 7665 6c65  idth=self.wavele
+000493c0: 6e67 7468 5f62 696e 2c20 0d0a 0909 0909  ngth_bin, ......
+000493d0: 7469 6d65 5f77 6964 7468 5f70 6572 6365  time_width_perce
+000493e0: 6e74 3d73 656c 662e 7469 6d65 5f77 6964  nt=self.time_wid
+000493f0: 7468 5f70 6572 6365 6e74 2c20 6967 6e6f  th_percent, igno
+00049400: 7265 5f74 696d 655f 7265 6769 6f6e 3d73  re_time_region=s
+00049410: 656c 662e 6967 6e6f 7265 5f74 696d 655f  elf.ignore_time_
+00049420: 7265 6769 6f6e 2c20 0d0a 0909 0909 7469  region, ......ti
+00049430: 6d65 5f62 696e 3d73 656c 662e 7469 6d65  me_bin=self.time
+00049440: 5f62 696e 2c20 7265 6c5f 7469 6d65 3d73  _bin, rel_time=s
+00049450: 656c 662e 7265 6c5f 7469 6d65 2c20 7361  elf.rel_time, sa
+00049460: 7665 5f66 6967 7572 6573 5f74 6f5f 666f  ve_figures_to_fo
+00049470: 6c64 6572 3d73 656c 662e 7361 7665 5f66  lder=self.save_f
+00049480: 6967 7572 6573 5f74 6f5f 666f 6c64 6572  igures_to_folder
+00049490: 2c20 0d0a 0909 0909 7361 7665 7479 7065  , ......savetype
+000494a0: 3d73 6176 6574 7970 652c 706c 6f74 5f74  =savetype,plot_t
+000494b0: 7970 653d 7363 616c 655f 7479 7065 2c6c  ype=scale_type,l
+000494c0: 696e 7472 6573 683d 7365 6c66 2e6c 696e  intresh=self.lin
+000494d0: 7472 6573 682c 2074 696d 6573 3d74 696d  tresh, times=tim
+000494e0: 6573 2c20 0d0a 0909 0909 7072 696e 745f  es, ......print_
+000494f0: 636c 6963 6b5f 706f 7369 7469 6f6e 203d  click_position =
+00049500: 2070 7269 6e74 5f63 6c69 636b 5f70 6f73   print_click_pos
+00049510: 6974 696f 6e2c 2064 6174 615f 7479 7065  ition, data_type
+00049520: 203d 2073 656c 662e 6461 7461 5f74 7970   = self.data_typ
+00049530: 652c 200d 0a09 0909 0970 6c6f 745f 7365  e, ......plot_se
+00049540: 636f 6e64 5f61 735f 656e 6572 6779 203d  cond_as_energy =
+00049550: 2070 6c6f 745f 7365 636f 6e64 5f61 735f   plot_second_as_
+00049560: 656e 6572 6779 2c20 756e 6974 733d 7365  energy, units=se
+00049570: 6c66 2e75 6e69 7473 2c20 6571 7561 6c5f  lf.units, equal_
+00049580: 656e 6572 6779 5f62 696e 203d 2073 656c  energy_bin = sel
+00049590: 662e 6571 7561 6c5f 656e 6572 6779 5f62  f.equal_energy_b
+000495a0: 696e 290d 0a0d 0a0d 0a09 6465 6620 5361  in).......def Sa
+000495b0: 7665 5f50 6c6f 7473 2873 656c 662c 2070  ve_Plots(self, p
+000495c0: 6174 6820 3d20 2772 6573 756c 745f 6669  ath = 'result_fi
+000495d0: 6775 7265 7327 2c20 7361 7665 7479 7065  gures', savetype
+000495e0: 203d 204e 6f6e 652c 2074 6974 6c65 203d   = None, title =
+000495f0: 204e 6f6e 652c 2066 696c 656e 616d 6520   None, filename 
+00049600: 3d20 4e6f 6e65 2c20 7363 616c 655f 7479  = None, scale_ty
+00049610: 7065 203d 2027 7379 6d6c 6f67 272c 200d  pe = 'symlog', .
+00049620: 0a09 0909 0909 7061 7463 6865 7320 3d20  ......patches = 
+00049630: 4661 6c73 652c 2063 6d61 7020 3d20 4e6f  False, cmap = No
+00049640: 6e65 293a 0d0a 0909 2727 2743 6f6e 7665  ne):....'''Conve
+00049650: 6e69 656e 6365 2066 756e 6374 696f 6e20  nience function 
+00049660: 7468 6174 2073 6574 7320 7361 7665 5f70  that sets save_p
+00049670: 6c6f 7473 5f74 6f5f 666f 6c64 6572 2074  lots_to_folder t
+00049680: 656d 706f 7261 7269 6c79 2074 6f20 7472  emporarily to tr
+00049690: 7565 2061 6e64 2072 6570 6c6f 7473 2065  ue and replots e
+000496a0: 7665 7279 7468 696e 670d 0a09 090d 0a09  verything.......
+000496b0: 0950 6172 616d 6574 6572 730d 0a09 092d  .Parameters....-
+000496c0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a09 090d 0a09  ---------.......
+000496d0: 0970 6174 6820 3a20 4e6f 6e65 2c20 7374  .path : None, st
+000496e0: 7220 6f72 2070 6174 682c 206f 7074 696f  r or path, optio
+000496f0: 6e61 6c0d 0a09 0909 2844 6566 6175 6c74  nal.....(Default
+00049700: 2920 4e6f 6e65 2c20 6966 206c 6566 7420  ) None, if left 
+00049710: 6f6e 204e 6f6e 652c 2074 6865 6e20 6120  on None, then a 
+00049720: 666f 6c64 6572 2022 7265 7375 6c74 5f66  folder "result_f
+00049730: 6967 7572 6573 2220 6973 2063 7265 6174  igures" is creat
+00049740: 6564 2069 6e20 7468 6520 666f 6c64 6572  ed in the folder
+00049750: 200d 0a09 0909 6f66 2074 6865 2064 6174   .....of the dat
+00049760: 6120 2873 656c 662e 7061 7468 290d 0a09  a (self.path)...
+00049770: 090d 0a09 0973 6176 6574 7970 6520 3a20  .....savetype : 
+00049780: 7374 7220 6f72 2069 7465 7261 626c 6520  str or iterable 
+00049790: 286f 6620 7374 7229 2c20 6f70 7469 6f6e  (of str), option
+000497a0: 616c 200d 0a09 0909 6d61 7470 6c6f 746c  al .....matplotl
+000497b0: 6962 2061 6c6c 6f77 7320 7468 6520 7361  ib allows the sa
+000497c0: 7669 6e67 206f 6620 6669 6775 7265 7320  ving of figures 
+000497d0: 696e 2076 6172 696f 7573 2066 6f72 6d61  in various forma
+000497e0: 7473 2e20 2844 6566 6175 6c74 2920 2270  ts. (Default) "p
+000497f0: 6e67 222c 200d 0a09 0909 7479 7069 6361  ng", .....typica
+00049800: 6c20 616e 6420 7265 636f 6d6d 656e 6461  l and recommenda
+00049810: 626c 6520 6f70 7469 6f6e 7320 6172 6520  ble options are 
+00049820: 2273 7667 2220 616e 6420 2270 6466 222e  "svg" and "pdf".
+00049830: 200d 0a09 0909 0d0a 0909 7469 746c 6520   .........title 
+00049840: 3a20 4e6f 6e65 206f 7220 7374 722c 206f  : None or str, o
+00049850: 7074 696f 6e61 6c0d 0a09 0909 2844 6566  ptional.....(Def
+00049860: 6175 6c74 2920 4e6f 6e65 2c20 5573 6520  ault) None, Use 
+00049870: 7468 6973 2074 6974 6c65 206f 6e20 616c  this title on al
+00049880: 6c20 706c 6f74 732e 2069 6620 4e6f 6e65  l plots. if None
+00049890: 2c20 7573 6520 7365 6c66 2e66 696c 656e  , use self.filen
+000498a0: 616d 650d 0a09 0909 0d0a 0909 6669 6c65  ame.........file
+000498b0: 6e61 6d65 203a 2073 7472 2c20 6f70 7469  name : str, opti
+000498c0: 6f6e 616c 0d0a 0909 0928 4465 6661 756c  onal.....(Defaul
+000498d0: 7429 204e 6f6e 652c 2042 6173 6520 6e61  t) None, Base na
+000498e0: 6d65 2066 6f72 2061 6c6c 2070 6c6f 7473  me for all plots
+000498f0: 2e20 4966 204e 6f6e 652c 2074 6865 6e20  . If None, then 
+00049900: 7365 6c66 2e66 696c 656e 616d 6520 7769  self.filename wi
+00049910: 6c6c 2062 6520 7573 6564 0d0a 0909 090d  ll be used......
+00049920: 0a09 0973 6361 6c65 5f74 7970 6520 3a20  ...scale_type : 
+00049930: 7374 722c 206f 7074 696f 6e61 6c0d 0a09  str, optional...
+00049940: 0909 2273 796d 6c6f 6722 2028 4465 6661  .."symlog" (Defa
+00049950: 756c 7429 2c20 226c 696e 6561 7222 2c20  ult), "linear", 
+00049960: 226c 6f67 2220 7469 6d65 2061 7869 730d  "log" time axis.
+00049970: 0a09 0909 0d0a 0909 7061 7463 6865 7320  ........patches 
+00049980: 3a20 626f 6f6c 2c20 6f70 7469 6f6e 616c  : bool, optional
+00049990: 0d0a 0909 0946 6f72 2074 7275 6520 7573  .....For true us
+000499a0: 6520 7768 6974 6520 7061 7463 6865 7320  e white patches 
+000499b0: 746f 206c 6162 656c 2074 6869 6e67 7320  to label things 
+000499c0: 696e 2074 6865 2032 6420 6d61 7472 6978  in the 2d matrix
+000499d0: 6573 2c20 746f 2073 6166 650d 0a09 0909  es, to safe.....
+000499e0: 7370 6163 6520 666f 7220 7075 626c 6963  space for public
+000499f0: 6174 696f 6e0d 0a09 0909 0d0a 0909 636d  ation.........cm
+00049a00: 6170 203a 204e 6f6e 6520 6f72 206d 6174  ap : None or mat
+00049a10: 706c 6f74 6c69 6220 636f 6c6f 7220 6d61  plotlib color ma
+00049a20: 702c 206f 7074 696f 6e61 6c0d 0a09 0909  p, optional.....
+00049a30: 6973 2061 2070 6f77 6572 6675 6c6c 2076  is a powerfull v
+00049a40: 6172 6961 626c 6520 7468 6174 2063 686f  ariable that cho
+00049a50: 6f73 6573 2074 6865 2063 6f6c 6f75 7220  oses the colour 
+00049a60: 6d61 7020 6170 706c 6965 6420 666f 7220  map applied for 
+00049a70: 616c 6c20 706c 6f74 732e 2049 6620 7365  all plots. If se
+00049a80: 7420 746f 200d 0a09 0909 4e6f 6e65 2028  t to .....None (
+00049a90: 4465 6661 756c 7429 2074 6865 6e20 7468  Default) then th
+00049aa0: 6520 7365 6c66 2e63 6d61 7020 6973 2075  e self.cmap is u
+00049ab0: 7365 642e 0d0a 0909 0941 7320 7374 616e  sed......As stan
+00049ac0: 6461 7264 2049 2075 7365 2074 6865 2063  dard I use the c
+00049ad0: 6f6c 6f72 206d 6170 2022 6a65 7422 2066  olor map "jet" f
+00049ae0: 726f 6d20 6d61 7470 6c6f 746c 6962 2e20  rom matplotlib. 
+00049af0: 5468 6572 6520 6172 6520 6120 7661 7269  There are a vari
+00049b00: 6574 7920 6f66 2063 6f6c 6f72 6d61 7073  ety of colormaps
+00049b10: 200d 0a09 0909 6176 6169 6c61 626c 6520   .....available 
+00049b20: 7468 6174 2061 7265 2076 6572 7920 7573  that are very us
+00049b30: 6566 756c 6c2e 2042 6573 6964 6520 226a  efull. Beside "j
+00049b40: 6574 222c 2022 7669 7269 6469 7322 2069  et", "viridis" i
+00049b50: 7320 6120 676f 6f64 2063 686f 6963 6520  s a good choice 
+00049b60: 6173 2069 7420 6973 2077 656c 6c20 0d0a  as it is well ..
+00049b70: 0909 0976 6973 6962 6c65 2075 6e64 6572  ...visible under
+00049b80: 2072 6564 2d67 7265 656e 2062 6c69 6e64   red-green blind
+00049b90: 6e65 7373 2e20 4f74 6865 7220 7573 6566  ness. Other usef
+00049ba0: 756c 206d 6170 7320 6172 6520 2270 7269  ul maps are "pri
+00049bb0: 736d 2220 666f 7220 6869 6768 2066 6c75  sm" for high flu
+00049bc0: 6374 7561 7469 6f6e 7320 0d0a 0909 096f  ctuations .....o
+00049bd0: 7220 6469 7665 7267 696e 6720 636f 6c6f  r diverging colo
+00049be0: 7220 6d61 7073 206c 696b 6520 2273 6569  r maps like "sei
+00049bf0: 736d 6963 222e 200d 0a09 0909 5365 6520  smic". .....See 
+00049c00: 6874 7470 733a 2f2f 6d61 7470 6c6f 746c  https://matplotl
+00049c10: 6962 2e6f 7267 2f33 2e31 2e30 2f74 7574  ib.org/3.1.0/tut
+00049c20: 6f72 6961 6c73 2f63 6f6c 6f72 732f 636f  orials/colors/co
+00049c30: 6c6f 726d 6170 732e 6874 6d6c 2066 6f72  lormaps.html for
+00049c40: 2061 2063 6f6d 7072 6568 656e 7369 7665   a comprehensive
+00049c50: 200d 0a09 0909 7365 6c65 6374 696f 6e2e   .....selection.
+00049c60: 2049 6e20 7468 6520 636f 6465 2074 6865   In the code the
+00049c70: 2063 6f6c 6f72 6d61 7073 2061 7265 2069   colormaps are i
+00049c80: 6d70 6f72 7465 6420 736f 2069 6620 706c  mported so if pl
+00049c90: 6f74 5f66 756e 6320 6973 2069 6d70 6f72  ot_func is impor
+00049ca0: 7465 6420 6173 2070 6620 7468 656e 200d  ted as pf then .
+00049cb0: 0a09 0909 7365 6c66 2e63 6d61 703d 7066  ....self.cmap=pf
+00049cc0: 2e63 6d2e 7669 7269 6469 7320 7365 7473  .cm.viridis sets
+00049cd0: 2076 6972 6964 6973 2061 7320 7468 6520   viridis as the 
+00049ce0: 6d61 7020 746f 2075 7365 2e20 496e 7465  map to use. Inte
+00049cf0: 726e 616c 6c79 2074 6865 2063 6f6c 6f72  rnally the color
+00049d00: 7320 6172 6520 6368 6f73 656e 200d 0a09  s are chosen ...
+00049d10: 0909 7769 7468 2074 6865 2022 636f 6c6d  ..with the "colm
+00049d20: 2220 6675 6e63 7469 6f6e 2e20 5468 6520  " function. The 
+00049d30: 3264 2070 6c6f 7473 2072 6571 7569 7265  2d plots require
+00049d40: 2061 2063 6f6e 7469 6e75 6f75 7320 636f   a continuous co
+00049d50: 6c6f 7220 6d61 7020 736f 2069 6620 736f  lor map so if so
+00049d60: 6d65 7468 696e 6720 0d0a 0909 0965 6c73  mething .....els
+00049d70: 6520 6973 2067 6976 6520 3264 2070 6c6f  e is give 2d plo
+00049d80: 7473 2061 7265 2073 686f 776e 2061 7574  ts are shown aut
+00049d90: 6f6d 6174 6963 616c 6c79 2077 6974 6820  omatically with 
+00049da0: 226a 6574 222e 2046 6f72 2061 6c6c 206f  "jet". For all o
+00049db0: 6620 7468 6520 3164 2070 6c6f 7473 2068  f the 1d plots h
+00049dc0: 6f77 6576 6572 200d 0a09 0909 4920 6669  owever .....I fi
+00049dd0: 7273 7420 7365 6c65 6374 2061 206e 756d  rst select a num
+00049de0: 6265 7220 6f66 2063 6f6c 6f72 7320 6265  ber of colors be
+00049df0: 666f 7265 2065 6163 6820 706c 6f74 2e20  fore each plot. 
+00049e00: 4966 2063 6d61 7020 6973 2061 2063 6f6e  If cmap is a con
+00049e10: 7469 6e6f 7573 206d 6170 2074 6865 6e20  tinous map then 
+00049e20: 7468 6573 650d 0a09 0909 6172 6520 7361  these.....are sa
+00049e30: 6d70 6c65 6420 6576 656e 6c79 206f 7665  mpled evenly ove
+00049e40: 7220 7468 6520 636f 6c6f 7572 6d61 702e  r the colourmap.
+00049e50: 204d 616e 7561 6c20 6974 6572 6162 6c65   Manual iterable
+00049e60: 7320 6f66 2063 6f6c 6f75 7273 200d 0a09  s of colours ...
+00049e70: 0909 636d 6170 3d5b 2831 2c30 2c30 292c  ..cmap=[(1,0,0),
+00049e80: 2830 2c31 2c30 292c 2830 2c30 2c31 292c  (0,1,0),(0,0,1),
+00049e90: 2e2e 2e5d 2061 7265 2061 6c73 6f20 6163  ...] are also ac
+00049ea0: 6365 7074 6564 2c20 6173 2061 7265 2076  cepted, as are v
+00049eb0: 6563 746f 7273 206f 7220 6461 7461 6672  ectors or datafr
+00049ec0: 616d 6573 2074 6861 7420 0d0a 0909 0963  ames that .....c
+00049ed0: 6f6e 7461 696e 2061 7320 726f 7773 2074  ontain as rows t
+00049ee0: 6865 2063 6f6c 6f72 732e 2054 6865 7265  he colors. There
+00049ef0: 206d 7573 7420 6265 206f 6620 636f 7572   must be of cour
+00049f00: 7365 2073 7566 6669 6369 656e 7420 636f  se sufficient co
+00049f10: 6c6f 7273 2070 7265 7365 6e74 2066 6f72  lors present for
+00049f20: 200d 0a09 0909 7468 6520 6e75 6d62 6572   .....the number
+00049f30: 7320 6f66 206c 696e 6573 2074 6861 7420  s of lines that 
+00049f40: 7769 6c6c 2062 6520 706c 6f74 7465 642e  will be plotted.
+00049f50: 2053 6f20 4920 7265 636f 6d6d 656e 6420   So I recommend 
+00049f60: 746f 2070 726f 7669 6465 2061 7420 6c65  to provide at le
+00049f70: 6173 7420 3130 2063 6f6c 6f75 7273 200d  ast 10 colours .
+00049f80: 0a09 0909 2865 2e67 2e7e 796f 7572 2075  ....(e.g.~your u
+00049f90: 6e69 7665 7273 6974 7920 636f 6c6f 7273  niversity colors
+00049fa0: 292e 2063 6f6c 6f75 7273 2061 7265 2061  ). colours are a
+00049fb0: 6c77 6179 7320 6769 7665 6e20 6173 2061  lways given as a
+00049fc0: 2c20 6c69 7374 206f 7220 7475 706c 6520  , list or tuple 
+00049fd0: 7769 7468 2052 4741 206f 7220 5247 4241  with RGA or RGBA
+00049fe0: 0d0a 0909 0928 7769 7468 2074 6865 206c  .....(with the l
+00049ff0: 6173 7420 4120 6265 6569 6e67 2074 6865  ast A beeing the
+0004a000: 2041 6c70 6861 3d74 7261 6e73 7061 7265   Alpha=transpare
+0004a010: 6e63 792e 2041 6c6c 206e 756d 6265 7273  ncy. All numbers
+0004a020: 2061 7265 2062 6574 7765 656e 2030 2061   are between 0 a
+0004a030: 6e64 2031 2e20 0d0a 0909 0949 6620 6120  nd 1. .....If a 
+0004a040: 6c69 7374 2f76 6563 746f 722f 4461 7461  list/vector/Data
+0004a050: 4672 616d 6520 6973 2067 6976 656e 2066  Frame is given f
+0004a060: 6f72 2074 6865 2063 6f6c 6f75 7273 2074  or the colours t
+0004a070: 6865 7920 7769 6c6c 2062 6520 7573 6564  hey will be used
+0004a080: 2069 6e20 7468 6520 6f72 6465 7220 7072   in the order pr
+0004a090: 6f76 6964 6564 2e0d 0a09 090d 0a09 0945  ovided.........E
+0004a0a0: 7861 6d70 6c65 730d 0a09 092d 2d2d 2d2d  xamples....-----
+0004a0b0: 2d2d 2d2d 0d0a 0909 0d0a 0909 3e3e 3e20  ----........>>> 
+0004a0c0: 7461 2e53 6176 655f 506c 6f74 7328 290d  ta.Save_Plots().
+0004a0d0: 0a09 093e 3e3e 2074 612e 5361 7665 5f50  ...>>> ta.Save_P
+0004a0e0: 6c6f 7473 2870 6174 6368 6573 203d 2054  lots(patches = T
+0004a0f0: 7275 6529 0d0a 0909 0d0a 0909 2727 270d  rue)........'''.
+0004a100: 0a09 0969 6620 636d 6170 2069 7320 4e6f  ...if cmap is No
+0004a110: 6e65 3a63 6d61 703d 7365 6c66 2e63 6d61  ne:cmap=self.cma
+0004a120: 700d 0a09 0969 6620 7361 7665 7479 7065  p....if savetype
+0004a130: 2069 7320 4e6f 6e65 3a0d 0a09 0909 7361   is None:.....sa
+0004a140: 7665 7479 7065 3d5b 2770 6e67 275d 0d0a  vetype=['png']..
+0004a150: 0909 656c 6966 2073 6176 6574 7970 6520  ..elif savetype 
+0004a160: 696e 205b 2770 6e67 272c 2770 6466 272c  in ['png','pdf',
+0004a170: 2773 7667 275d 3a73 6176 6574 7970 653d  'svg']:savetype=
+0004a180: 5b73 6176 6574 7970 655d 0d0a 0909 656c  [savetype]....el
+0004a190: 6966 2068 6173 6174 7472 2873 6176 6574  if hasattr(savet
+0004a1a0: 7970 652c 225f 5f69 7465 725f 5f22 293a  ype,"__iter__"):
+0004a1b0: 7361 7665 7479 7065 3d6c 6973 7428 7361  savetype=list(sa
+0004a1c0: 7665 7479 7065 290d 0a09 0965 6c73 653a  vetype)....else:
+0004a1d0: 0d0a 0909 0970 7269 6e74 2827 506c 6561  .....print('Plea
+0004a1e0: 7365 2073 7065 6369 6679 2061 2073 696e  se specify a sin
+0004a1f0: 676c 6520 6669 6c65 7479 7065 2066 726f  gle filetype fro
+0004a200: 6d20 5c27 706e 675c 272c 5c27 7064 665c  m \'png\',\'pdf\
+0004a210: 272c 5c27 7376 675c 2720 6f72 2061 206c  ',\'svg\' or a l
+0004a220: 6973 7420 6f66 2074 686f 7365 2e20 4e6f  ist of those. No
+0004a230: 7468 696e 6720 7761 7320 7361 7665 6427  thing was saved'
+0004a240: 290d 0a09 0909 7265 7475 726e 2046 616c  ).....return Fal
+0004a250: 7365 0d0a 0909 6966 2063 6d61 7020 6973  se....if cmap is
+0004a260: 204e 6f6e 653a 636d 6170 3d73 7461 6e64   None:cmap=stand
+0004a270: 6172 645f 6d61 700d 0a09 096f 7269 6769  ard_map....origi
+0004a280: 6e3d 7365 6c66 2e73 6176 655f 6669 6775  n=self.save_figu
+0004a290: 7265 735f 746f 5f66 6f6c 6465 720d 0a09  res_to_folder...
+0004a2a0: 0973 656c 662e 7361 7665 5f66 6967 7572  .self.save_figur
+0004a2b0: 6573 5f74 6f5f 666f 6c64 6572 3d54 7275  es_to_folder=Tru
+0004a2c0: 650d 0a09 0974 7279 3a0d 0a09 0909 666f  e....try:.....fo
+0004a2d0: 7220 7420 696e 2073 6176 6574 7970 653a  r t in savetype:
+0004a2e0: 0d0a 0909 0909 706c 742e 636c 6f73 6528  ......plt.close(
+0004a2f0: 2761 6c6c 2729 0d0a 0909 0909 7365 6c66  'all')......self
+0004a300: 2e50 6c6f 745f 5241 5728 7361 7665 7479  .Plot_RAW(savety
+0004a310: 7065 203d 2074 2c20 7061 7468 203d 2070  pe = t, path = p
+0004a320: 6174 682c 2063 6d61 7020 3d20 636d 6170  ath, cmap = cmap
+0004a330: 2c20 7469 746c 6520 3d20 7469 746c 652c  , title = title,
+0004a340: 200d 0a09 0909 0909 0909 0973 6361 6c65   ..........scale
+0004a350: 5f74 7970 6520 3d20 7363 616c 655f 7479  _type = scale_ty
+0004a360: 7065 2c20 6669 6c65 6e61 6d65 203d 2066  pe, filename = f
+0004a370: 696c 656e 616d 652c 2075 6e69 7473 3d73  ilename, units=s
+0004a380: 656c 662e 756e 6974 732c 200d 0a09 0909  elf.units, .....
+0004a390: 0909 0909 0965 7175 616c 5f65 6e65 7267  .....equal_energ
+0004a3a0: 795f 6269 6e20 3d20 7365 6c66 2e65 7175  y_bin = self.equ
+0004a3b0: 616c 5f65 6e65 7267 795f 6269 6e29 0d0a  al_energy_bin)..
+0004a3c0: 0909 0909 706c 742e 636c 6f73 6528 2761  ....plt.close('a
+0004a3d0: 6c6c 2729 0d0a 0909 0909 7072 696e 7428  ll')......print(
+0004a3e0: 2773 6176 6564 2052 4157 2070 6c6f 7473  'saved RAW plots
+0004a3f0: 2074 7970 6520 2573 2074 6f20 2573 2725   type %s to %s'%
+0004a400: 2874 2c63 6865 636b 5f66 6f6c 6465 7228  (t,check_folder(
+0004a410: 7061 7468 3d70 6174 682c 6375 7272 656e  path=path,curren
+0004a420: 745f 7061 7468 3d73 656c 662e 7061 7468  t_path=self.path
+0004a430: 2929 290d 0a09 0965 7863 6570 743a 0d0a  )))....except:..
+0004a440: 0909 0970 7269 6e74 2827 5361 7669 6e67  ...print('Saving
+0004a450: 206f 6620 5261 7720 706c 6f74 7320 666f   of Raw plots fo
+0004a460: 7220 6669 6c65 7479 7065 2025 7320 6661  r filetype %s fa
+0004a470: 696c 6564 2725 7429 0d0a 0909 7472 793a  iled'%t)....try:
+0004a480: 0d0a 0909 0966 6f72 2074 2069 6e20 7361  .....for t in sa
+0004a490: 7665 7479 7065 3a0d 0a09 0909 0970 6c74  vetype:......plt
+0004a4a0: 2e63 6c6f 7365 2827 616c 6c27 290d 0a09  .close('all')...
+0004a4b0: 0909 0973 656c 662e 506c 6f74 5f66 6974  ...self.Plot_fit
+0004a4c0: 5f6f 7574 7075 7428 7361 7665 7479 7065  _output(savetype
+0004a4d0: 3d74 2c70 6174 683d 7061 7468 2c63 6d61  =t,path=path,cma
+0004a4e0: 703d 636d 6170 2c74 6974 6c65 3d74 6974  p=cmap,title=tit
+0004a4f0: 6c65 2c73 6361 6c65 5f74 7970 653d 7363  le,scale_type=sc
+0004a500: 616c 655f 7479 7065 2c70 6174 6368 6573  ale_type,patches
+0004a510: 3d70 6174 6368 6573 2c66 696c 656e 616d  =patches,filenam
+0004a520: 653d 6669 6c65 6e61 6d65 290d 0a09 0909  e=filename).....
+0004a530: 0970 6c74 2e63 6c6f 7365 2827 616c 6c27  .plt.close('all'
+0004a540: 290d 0a09 0909 0970 7269 6e74 2827 5361  )......print('Sa
+0004a550: 7665 6420 4669 7420 706c 6f74 7320 6f66  ved Fit plots of
+0004a560: 2074 7970 6520 2573 2074 6f20 2573 2725   type %s to %s'%
+0004a570: 2874 2c63 6865 636b 5f66 6f6c 6465 7228  (t,check_folder(
+0004a580: 7061 7468 3d70 6174 682c 6375 7272 656e  path=path,curren
+0004a590: 745f 7061 7468 3d73 656c 662e 7061 7468  t_path=self.path
+0004a5a0: 2929 290d 0a09 0965 7863 6570 743a 0d0a  )))....except:..
+0004a5b0: 0909 0970 7269 6e74 2827 5361 7669 6e67  ...print('Saving
+0004a5c0: 206f 6620 4669 7420 706c 6f74 7320 666f   of Fit plots fo
+0004a5d0: 7220 6669 6c65 7479 7065 2025 7320 6661  r filetype %s fa
+0004a5e0: 696c 6564 2725 7429 0d0a 0909 7365 6c66  iled'%t)....self
+0004a5f0: 2e73 6176 655f 6669 6775 7265 735f 746f  .save_figures_to
+0004a600: 5f66 6f6c 6465 723d 6f72 6967 696e 0d0a  _folder=origin..
+0004a610: 0d0a 0d0a 0964 6566 205f 5f46 6974 5f43  .....def __Fit_C
+0004a620: 6869 7270 5f69 6e6e 6572 2809 7365 6c66  hirp_inner(.self
+0004a630: 2c20 6f70 745f 636f 6566 662c 2069 6e69  , opt_coeff, ini
+0004a640: 7469 616c 5f66 6974 5f63 6f65 6666 203d  tial_fit_coeff =
+0004a650: 204e 6f6e 652c 2070 6172 616d 7320 3d20   None, params = 
+0004a660: 4e6f 6e65 2c20 7363 6174 7465 7263 7574  None, scattercut
+0004a670: 203d 204e 6f6e 652c 2062 6f72 6465 7263   = None, borderc
+0004a680: 7574 203d 204e 6f6e 652c 200d 0a09 0909  ut = None, .....
+0004a690: 0909 0909 7469 6d65 6c69 6d69 7473 203d  ....timelimits =
+0004a6a0: 204e 6f6e 652c 2077 6176 655f 6e6d 5f62   None, wave_nm_b
+0004a6b0: 696e 203d 204e 6f6e 652c 2074 696d 655f  in = None, time_
+0004a6c0: 6269 6e20 3d20 4e6f 6e65 2c20 6d6f 6420  bin = None, mod 
+0004a6d0: 3d20 4e6f 6e65 2c20 6c6f 675f 6669 7420  = None, log_fit 
+0004a6e0: 3d20 4e6f 6e65 2c20 6473 5f62 6163 6b5f  = None, ds_back_
+0004a6f0: 636f 7272 203d 204e 6f6e 6529 3a0d 0a09  corr = None):...
+0004a700: 0927 2727 2046 756e 6374 696f 6e20 746f  .''' Function to
+0004a710: 2063 616c 6375 6c61 7465 2061 206e 6577   calculate a new
+0004a720: 2063 6869 7270 2063 6f72 7265 6374 6564   chirp corrected
+0004a730: 206d 6174 7269 7820 616e 6420 7265 7475   matrix and retu
+0004a740: 726e 2061 6e20 6572 726f 7220 7661 6c75  rn an error valu
+0004a750: 652c 2020 5468 6520 2263 6f73 7420 6675  e,  The "cost fu
+0004a760: 6e63 7469 6f6e 2220 666f 7220 7468 6520  nction" for the 
+0004a770: 6368 6972 7020 6f70 7469 6d69 7a61 7469  chirp optimizati
+0004a780: 6f6e 200d 0a09 0927 2727 0d0a 0909 6669  on ....'''....fi
+0004a790: 7463 6f65 6666 203d 206e 702e 6172 7261  tcoeff = np.arra
+0004a7a0: 7928 5b6f 7074 5f63 6f65 6666 5b27 7034  y([opt_coeff['p4
 0004a7b0: 275d 2e76 616c 7565 2c20 6f70 745f 636f  '].value, opt_co
-0004a7c0: 6566 665b 2770 3127 5d2e 7661 6c75 652c  eff['p1'].value,
-0004a7d0: 206f 7074 5f63 6f65 6666 5b27 7030 275d   opt_coeff['p0']
-0004a7e0: 2e76 616c 7565 5d29 0d0a 0909 2366 6974  .value])....#fit
-0004a7f0: 636f 6566 6620 3d20 5f5f 7368 6966 745f  coeff = __shift_
-0004a800: 706f 6c79 6e6f 6d28 6669 7463 6f65 6666  polynom(fitcoeff
-0004a810: 2c20 2d35 3030 2920 2374 6869 7320 7761  , -500) #this wa
-0004a820: 7320 616e 2061 7262 6974 7261 7279 2073  s an arbitrary s
-0004a830: 6869 6674 206f 6620 7468 6520 6461 7461  hift of the data
-0004a840: 2062 7920 3530 3020 746f 206d 616b 6520   by 500 to make 
-0004a850: 7468 6520 6368 6972 7020 7061 7261 6d65  the chirp parame
-0004a860: 7465 7220 0d0a 0909 7469 6d65 203d 2064  ter ....time = d
-0004a870: 735f 6261 636b 5f63 6f72 722e 696e 6465  s_back_corr.inde
-0004a880: 782e 7661 6c75 6573 2e61 7374 7970 6528  x.values.astype(
-0004a890: 2766 6c6f 6174 2729 2365 7874 7261 6374  'float')#extract
-0004a8a0: 2074 6865 2074 696d 650d 0a09 0964 735f   the time....ds_
-0004a8b0: 6e65 7720 3d20 6473 5f62 6163 6b5f 636f  new = ds_back_co
-0004a8c0: 7272 2e61 7070 6c79 286c 616d 6264 6120  rr.apply(lambda 
-0004a8d0: 783a 6e70 2e69 6e74 6572 7028 7820 3d20  x:np.interp(x = 
-0004a8e0: 7469 6d65 2b6e 702e 706f 6c79 7661 6c28  time+np.polyval(
-0004a8f0: 6669 7463 6f65 6666 2c20 782e 6e61 6d65  fitcoeff, x.name
-0004a900: 292c 2078 7020 3d20 7469 6d65 2c20 6670  ), xp = time, fp
-0004a910: 203d 2078 292c 2061 7869 7320 3d20 302c   = x), axis = 0,
-0004a920: 2072 6177 203d 2046 616c 7365 290d 0a09   raw = False)...
-0004a930: 0972 6520 3d20 6572 725f 6675 6e63 2870  .re = err_func(p
-0004a940: 6172 6173 203d 2070 6172 616d 732c 2064  aras = params, d
-0004a950: 7320 3d20 6473 5f6e 6577 2c20 6d6f 6420  s = ds_new, mod 
-0004a960: 3d20 6d6f 642c 2066 696e 616c 203d 2046  = mod, final = F
-0004a970: 616c 7365 2c20 6c6f 675f 6669 7420 3d20  alse, log_fit = 
-0004a980: 6c6f 675f 6669 7429 0d0a 0909 7265 7475  log_fit)....retu
-0004a990: 726e 2072 650d 0a09 090d 0a09 090d 0a09  rn re...........
-0004a9a0: 6465 6620 5f5f 4669 745f 4368 6972 705f  def __Fit_Chirp_
-0004a9b0: 6f75 7465 7228 7365 6c66 2c20 7061 7264  outer(self, pard
-0004a9c0: 662c 2072 6573 756c 7473 2c20 6669 745f  f, results, fit_
-0004a9d0: 6473 2c20 6669 745f 6368 6972 705f 6974  ds, fit_chirp_it
-0004a9e0: 6572 6174 696f 6e73 2c20 6d6f 642c 2064  erations, mod, d
-0004a9f0: 6565 705f 6974 6572 6174 696f 6e20 3d20  eep_iteration = 
-0004aa00: 4661 6c73 6529 3a0d 0a09 0927 2727 4272  False):....'''Br
-0004aa10: 6f6b 656e 206f 7574 2043 6869 7270 206f  oken out Chirp o
-0004aa20: 7074 696d 697a 6174 696f 6e2c 2020 7461  ptimization,  ta
-0004aa30: 6b65 7320 7468 6520 6669 7474 6564 2070  kes the fitted p
-0004aa40: 6172 616d 6574 6572 7320 616e 6420 7065  arameters and pe
-0004aa50: 7266 6f72 6d73 2027 6669 745f 6368 6972  rforms 'fit_chir
-0004aa60: 705f 6974 6572 6174 696f 6e73 2720 7469  p_iterations' ti
-0004aa70: 6d65 7320 7468 6520 6c6f 6f70 2c20 200d  mes the loop,  .
-0004aa80: 0a09 0928 6f70 7469 6d69 7365 2063 6869  ...(optimise chi
-0004aa90: 7270 202b 206f 7074 696d 697a 6520 676c  rp + optimize gl
-0004aaa0: 6f62 616c 2920 6166 7465 7220 6561 6368  obal) after each
-0004aab0: 2067 6c6f 6261 6c20 6974 6572 6174 696f   global iteratio
-0004aac0: 6e20 7468 6520 6572 726f 7220 6973 2063  n the error is c
-0004aad0: 6f6d 7061 7265 6420 746f 2074 6865 2070  ompared to the p
-0004aae0: 7265 7669 6f75 732e 2049 7420 636f 6e74  revious. It cont
-0004aaf0: 696e 7565 7320 756e 7469 6c20 6e6f 2069  inues until no i
-0004ab00: 6d70 726f 7665 6d65 6e74 2069 7320 6d61  mprovement is ma
-0004ab10: 6465 206f 7220 0d0a 0909 756e 7469 6c20  de or ....until 
-0004ab20: 7468 6520 2766 6974 5f63 6869 7270 5f69  the 'fit_chirp_i
-0004ab30: 7465 7261 7469 6f6e 7327 2069 7320 7265  terations' is re
-0004ab40: 6163 6865 642e 2049 6620 7468 6520 6572  ached. If the er
-0004ab50: 726f 7220 6973 2072 6564 7563 6564 2062  ror is reduced b
-0004ab60: 7920 6d6f 7265 2074 6861 6e20 6120 6661  y more than a fa
-0004ab70: 6374 6f72 206f 6620 3130 3020 696e 2061  ctor of 100 in a
-0004ab80: 2073 696e 676c 6520 7374 6570 2c20 2069   single step,  i
-0004ab90: 7420 6973 2061 7373 756d 6564 2074 6861  t is assumed tha
-0004aba0: 7420 736f 6d65 7468 696e 6720 6669 7368  t something fish
-0004abb0: 7920 6973 2067 6f69 6e67 206f 6e20 616e  y is going on an
-0004abc0: 6420 7765 2072 6573 7461 7274 2074 6865  d we restart the
-0004abd0: 2066 6974 2c20 2062 7574 2077 6974 6820   fit,  but with 
-0004abe0: 6120 3130 7820 736d 616c 6c65 7220 7369  a 10x smaller si
-0004abf0: 6d70 6c65 7820 7374 6570 7369 7a65 2061  mplex stepsize a
-0004ac00: 6e64 2064 6565 705f 6974 6572 6163 7469  nd deep_iteracti
-0004ac10: 6f6e 2046 416c 7365 0d0a 0909 0d0a 0909  on FAlse........
-0004ac20: 5061 7261 6d65 7465 7273 0d0a 0909 2d2d  Parameters....--
-0004ac30: 2d2d 2d2d 2d2d 2d2d 2d0d 0a09 0970 6172  ---------....par
-0004ac40: 6466 0d0a 0909 0909 0923 2064 6565 705f  df.......# deep_
-0004ac50: 6974 6572 6174 696f 6e20 7573 6573 2074  iteration uses t
-0004ac60: 6865 2070 7265 7669 6f75 7320 6b69 6e65  he previous kine
-0004ac70: 7469 6320 6f70 7469 6d69 7a65 6420 7061  tic optimized pa
-0004ac80: 7261 6d65 7465 7220 6173 2074 6865 2069  rameter as the i
-0004ac90: 6e70 7574 2069 6e74 6f20 7468 6520 6e65  nput into the ne
-0004aca0: 7874 2066 6974 2e20 0d0a 0909 0923 4361  xt fit. .....#Ca
-0004acb0: 6e20 6265 2067 7265 6174 2062 7574 2063  n be great but c
-0004acc0: 616e 2061 6c73 6f20 7275 6e20 6177 6179  an also run away
-0004acd0: 2c20 696e 2067 656e 6572 616c 206e 6f74  , in general not
-0004ace0: 206e 6565 6465 6420 616e 6420 6361 6e20   needed and can 
-0004acf0: 6265 2074 7269 6767 6572 6564 2062 7920  be triggered by 
-0004ad00: 6665 6564 696e 6720 7468 6520 0d0a 0909  feeding the ....
-0004ad10: 0923 7265 7375 6c74 7320 6261 636b 2069  .#results back i
-0004ad20: 6e74 6f20 7468 6520 676c 6f62 616c 2066  nto the global f
-0004ad30: 6974 2727 270d 0a09 0969 6620 7061 7264  it'''....if pard
-0004ad40: 662e 7661 7279 2e61 6e79 2829 3a0d 0a09  f.vary.any():...
-0004ad50: 0909 696e 6974 6961 6c5f 6572 726f 7220  ..initial_error 
-0004ad60: 3d20 5b72 6573 756c 7473 2e72 6573 6964  = [results.resid
-0004ad70: 7561 6c5b 305d 5d0d 0a09 0909 7061 725f  ual[0]].....par_
-0004ad80: 696e 746f 5f63 6869 7270 6669 7420 3d20  into_chirpfit = 
-0004ad90: 7265 7375 6c74 732e 7061 7261 6d73 0d0a  results.params..
-0004ada0: 0909 656c 7365 3a0d 0a09 0909 696e 6974  ..else:.....init
-0004adb0: 6961 6c5f 6572 726f 7220 3d20 5b65 7272  ial_error = [err
-0004adc0: 5f66 756e 6328 7061 7261 7320 3d20 7365  _func(paras = se
-0004add0: 6c66 2e70 6172 5f66 6974 2c20 6473 203d  lf.par_fit, ds =
-0004ade0: 2066 6974 5f64 732c 206d 6f64 203d 2073   fit_ds, mod = s
-0004adf0: 656c 662e 6d6f 642c 2066 696e 616c 203d  elf.mod, final =
-0004ae00: 2046 616c 7365 2c20 6c6f 675f 6669 7420   False, log_fit 
-0004ae10: 3d20 7365 6c66 2e6c 6f67 5f66 6974 295d  = self.log_fit)]
-0004ae20: 0d0a 0909 0970 6172 5f69 6e74 6f5f 6368  .....par_into_ch
-0004ae30: 6972 7066 6974 203d 2073 656c 662e 7061  irpfit = self.pa
-0004ae40: 720d 0a09 0970 6172 5f69 6e74 6f5f 6368  r....par_into_ch
-0004ae50: 6972 7066 6974 5b27 7430 275d 2e76 6172  irpfit['t0'].var
-0004ae60: 7920 3d20 4661 6c73 650d 0a09 0969 6e69  y = False....ini
-0004ae70: 7469 616c 5f66 6974 5f63 6f65 6666 203d  tial_fit_coeff =
-0004ae80: 2073 656c 662e 6669 7463 6f65 6666 0d0a   self.fitcoeff..
-0004ae90: 0909 6966 206c 656e 2869 6e69 7469 616c  ..if len(initial
-0004aea0: 5f66 6974 5f63 6f65 6666 2920 3d3d 2036  _fit_coeff) == 6
-0004aeb0: 3a0d 0a09 0909 696e 6974 6961 6c5f 6669  :.....initial_fi
-0004aec0: 745f 636f 6566 665b 345d 203d 2073 656c  t_coeff[4] = sel
-0004aed0: 662e 6669 7463 6f65 6666 5b34 5d2b 7365  f.fitcoeff[4]+se
-0004aee0: 6c66 2e66 6974 636f 6566 665b 355d 0d0a  lf.fitcoeff[5]..
-0004aef0: 0909 0969 6e69 7469 616c 5f66 6974 5f63  ...initial_fit_c
-0004af00: 6f65 6666 203d 2069 6e69 7469 616c 5f66  oeff = initial_f
-0004af10: 6974 5f63 6f65 6666 5b3a 355d 0d0a 0909  it_coeff[:5]....
-0004af20: 6368 6972 705f 7061 7220 3d20 6c6d 6669  chirp_par = lmfi
-0004af30: 742e 5061 7261 6d65 7465 7273 2829 0d0a  t.Parameters()..
-0004af40: 0909 0909 0909 0909 0909 0909 0909 0920  ............... 
-0004af50: 2020 0d0a 0909 666f 7220 6920 696e 2072    ....for i in r
-0004af60: 616e 6765 2835 293a 0d0a 0909 0963 6869  ange(5):.....chi
-0004af70: 7270 5f70 6172 2e61 6464 2827 7025 6927  rp_par.add('p%i'
-0004af80: 2528 342d 6929 2c20 7661 6c75 6520 3d20  %(4-i), value = 
-0004af90: 696e 6974 6961 6c5f 6669 745f 636f 6566  initial_fit_coef
-0004afa0: 665b 695d 290d 0a09 0963 6869 7270 5f70  f[i])....chirp_p
-0004afb0: 6172 5b27 7034 275d 2e73 6574 286d 696e  ar['p4'].set(min
-0004afc0: 203d 2063 6869 7270 5f70 6172 5b27 7034   = chirp_par['p4
-0004afd0: 275d 2d30 2e35 2c20 6d61 7820 3d20 6368  ']-0.5, max = ch
-0004afe0: 6972 705f 7061 725b 2770 3427 5d2b 302e  irp_par['p4']+0.
-0004aff0: 3529 0d0a 0909 7472 793a 236c 6574 7320  5)....try:#lets 
-0004b000: 7365 6e64 2069 6e20 7468 6520 6261 636b  send in the back
-0004b010: 6772 6f75 6e64 2063 6f72 7265 6374 6564  ground corrected
-0004b020: 206d 6174 7269 7820 6661 696c 7320 6966   matrix fails if
-0004b030: 206e 6f20 7072 696f 7220 6261 636b 6772   no prior backgr
-0004b040: 6f75 6e64 2077 6173 2064 6f6e 650d 0a09  ound was done...
-0004b050: 0909 636f 7272 6563 7469 6f6e 203d 2073  ..correction = s
-0004b060: 656c 662e 6261 636b 6772 6f75 6e64 5f70  elf.background_p
-0004b070: 6172 5b33 5d0d 0a09 0909 6473 5f62 6163  ar[3].....ds_bac
-0004b080: 6b5f 636f 7272 203d 2073 656c 662e 6473  k_corr = self.ds
-0004b090: 5f6f 7269 2d63 6f72 7265 6374 696f 6e0d  _ori-correction.
-0004b0a0: 0a09 0965 7863 6570 743a 0d0a 0909 0964  ...except:.....d
-0004b0b0: 735f 6261 636b 5f63 6f72 7220 3d20 7365  s_back_corr = se
-0004b0c0: 6c66 2e64 735f 6f72 690d 0a09 0964 735f  lf.ds_ori....ds_
-0004b0d0: 6261 636b 5f63 6f72 7220 3d20 7375 625f  back_corr = sub_
-0004b0e0: 6473 2864 7320 3d20 6473 5f62 6163 6b5f  ds(ds = ds_back_
-0004b0f0: 636f 7272 2c20 7363 6174 7465 7263 7574  corr, scattercut
-0004b100: 203d 2073 656c 662e 7363 6174 7465 7263   = self.scatterc
-0004b110: 7574 2c20 626f 7264 6572 6375 7420 3d20  ut, bordercut = 
-0004b120: 7365 6c66 2e62 6f72 6465 7263 7574 2c20  self.bordercut, 
-0004b130: 0d0a 0909 0909 0909 0909 7469 6d65 6c69  ..........timeli
-0004b140: 6d69 7473 203d 2073 656c 662e 7469 6d65  mits = self.time
-0004b150: 6c69 6d69 7473 2c20 7761 7665 5f6e 6d5f  limits, wave_nm_
-0004b160: 6269 6e20 3d20 7365 6c66 2e77 6176 655f  bin = self.wave_
-0004b170: 6e6d 5f62 696e 2c20 7469 6d65 5f62 696e  nm_bin, time_bin
-0004b180: 203d 2073 656c 662e 7469 6d65 5f62 696e   = self.time_bin
-0004b190: 2c20 0d0a 0909 0909 0909 0909 6571 7561  , ..........equa
-0004b1a0: 6c5f 656e 6572 6779 5f62 696e 203d 2073  l_energy_bin = s
-0004b1b0: 656c 662e 6571 7561 6c5f 656e 6572 6779  elf.equal_energy
-0004b1c0: 5f62 696e 2909 0909 0909 0909 0909 0909  _bin)...........
-0004b1d0: 0909 0909 0909 2020 200d 0a09 0970 7269  ......   ....pri
-0004b1e0: 6e74 2827 4265 666f 7265 2063 6869 7270  nt('Before chirp
-0004b1f0: 6669 7420 7468 6520 6572 726f 7220 6973  fit the error is
-0004b200: 3a7b 3a2e 3665 7d27 2e66 6f72 6d61 7428  :{:.6e}'.format(
-0004b210: 696e 6974 6961 6c5f 6572 726f 725b 2d31  initial_error[-1
-0004b220: 5d29 290d 0a09 090d 0a09 0923 2323 2323  ]))........#####
-0004b230: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004b240: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004b250: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004a7c0: 6566 665b 2770 3327 5d2e 7661 6c75 652c  eff['p3'].value,
+0004a7d0: 206f 7074 5f63 6f65 6666 5b27 7032 275d   opt_coeff['p2']
+0004a7e0: 2e76 616c 7565 2c20 6f70 745f 636f 6566  .value, opt_coef
+0004a7f0: 665b 2770 3127 5d2e 7661 6c75 652c 206f  f['p1'].value, o
+0004a800: 7074 5f63 6f65 6666 5b27 7030 275d 2e76  pt_coeff['p0'].v
+0004a810: 616c 7565 5d29 0d0a 0909 2366 6974 636f  alue])....#fitco
+0004a820: 6566 6620 3d20 5f5f 7368 6966 745f 706f  eff = __shift_po
+0004a830: 6c79 6e6f 6d28 6669 7463 6f65 6666 2c20  lynom(fitcoeff, 
+0004a840: 2d35 3030 2920 2374 6869 7320 7761 7320  -500) #this was 
+0004a850: 616e 2061 7262 6974 7261 7279 2073 6869  an arbitrary shi
+0004a860: 6674 206f 6620 7468 6520 6461 7461 2062  ft of the data b
+0004a870: 7920 3530 3020 746f 206d 616b 6520 7468  y 500 to make th
+0004a880: 6520 6368 6972 7020 7061 7261 6d65 7465  e chirp paramete
+0004a890: 7220 0d0a 0909 7469 6d65 203d 2064 735f  r ....time = ds_
+0004a8a0: 6261 636b 5f63 6f72 722e 696e 6465 782e  back_corr.index.
+0004a8b0: 7661 6c75 6573 2e61 7374 7970 6528 2766  values.astype('f
+0004a8c0: 6c6f 6174 2729 2365 7874 7261 6374 2074  loat')#extract t
+0004a8d0: 6865 2074 696d 650d 0a09 0964 735f 6e65  he time....ds_ne
+0004a8e0: 7720 3d20 6473 5f62 6163 6b5f 636f 7272  w = ds_back_corr
+0004a8f0: 2e61 7070 6c79 286c 616d 6264 6120 783a  .apply(lambda x:
+0004a900: 6e70 2e69 6e74 6572 7028 7820 3d20 7469  np.interp(x = ti
+0004a910: 6d65 2b6e 702e 706f 6c79 7661 6c28 6669  me+np.polyval(fi
+0004a920: 7463 6f65 6666 2c20 782e 6e61 6d65 292c  tcoeff, x.name),
+0004a930: 2078 7020 3d20 7469 6d65 2c20 6670 203d   xp = time, fp =
+0004a940: 2078 292c 2061 7869 7320 3d20 302c 2072   x), axis = 0, r
+0004a950: 6177 203d 2046 616c 7365 290d 0a09 0972  aw = False)....r
+0004a960: 6520 3d20 6572 725f 6675 6e63 2870 6172  e = err_func(par
+0004a970: 6173 203d 2070 6172 616d 732c 2064 7320  as = params, ds 
+0004a980: 3d20 6473 5f6e 6577 2c20 6d6f 6420 3d20  = ds_new, mod = 
+0004a990: 6d6f 642c 2066 696e 616c 203d 2046 616c  mod, final = Fal
+0004a9a0: 7365 2c20 6c6f 675f 6669 7420 3d20 6c6f  se, log_fit = lo
+0004a9b0: 675f 6669 7429 0d0a 0909 7265 7475 726e  g_fit)....return
+0004a9c0: 2072 650d 0a09 090d 0a09 090d 0a09 6465   re...........de
+0004a9d0: 6620 5f5f 4669 745f 4368 6972 705f 6f75  f __Fit_Chirp_ou
+0004a9e0: 7465 7228 7365 6c66 2c20 7061 7264 662c  ter(self, pardf,
+0004a9f0: 2072 6573 756c 7473 2c20 6669 745f 6473   results, fit_ds
+0004aa00: 2c20 6669 745f 6368 6972 705f 6974 6572  , fit_chirp_iter
+0004aa10: 6174 696f 6e73 2c20 6d6f 642c 2064 6565  ations, mod, dee
+0004aa20: 705f 6974 6572 6174 696f 6e20 3d20 4661  p_iteration = Fa
+0004aa30: 6c73 6529 3a0d 0a09 0927 2727 4272 6f6b  lse):....'''Brok
+0004aa40: 656e 206f 7574 2043 6869 7270 206f 7074  en out Chirp opt
+0004aa50: 696d 697a 6174 696f 6e2c 2020 7461 6b65  imization,  take
+0004aa60: 7320 7468 6520 6669 7474 6564 2070 6172  s the fitted par
+0004aa70: 616d 6574 6572 7320 616e 6420 7065 7266  ameters and perf
+0004aa80: 6f72 6d73 2027 6669 745f 6368 6972 705f  orms 'fit_chirp_
+0004aa90: 6974 6572 6174 696f 6e73 2720 7469 6d65  iterations' time
+0004aaa0: 7320 7468 6520 6c6f 6f70 2c20 200d 0a09  s the loop,  ...
+0004aab0: 0928 6f70 7469 6d69 7365 2063 6869 7270  .(optimise chirp
+0004aac0: 202b 206f 7074 696d 697a 6520 676c 6f62   + optimize glob
+0004aad0: 616c 2920 6166 7465 7220 6561 6368 2067  al) after each g
+0004aae0: 6c6f 6261 6c20 6974 6572 6174 696f 6e20  lobal iteration 
+0004aaf0: 7468 6520 6572 726f 7220 6973 2063 6f6d  the error is com
+0004ab00: 7061 7265 6420 746f 2074 6865 2070 7265  pared to the pre
+0004ab10: 7669 6f75 732e 2049 7420 636f 6e74 696e  vious. It contin
+0004ab20: 7565 7320 756e 7469 6c20 6e6f 2069 6d70  ues until no imp
+0004ab30: 726f 7665 6d65 6e74 2069 7320 6d61 6465  rovement is made
+0004ab40: 206f 7220 0d0a 0909 756e 7469 6c20 7468   or ....until th
+0004ab50: 6520 2766 6974 5f63 6869 7270 5f69 7465  e 'fit_chirp_ite
+0004ab60: 7261 7469 6f6e 7327 2069 7320 7265 6163  rations' is reac
+0004ab70: 6865 642e 2049 6620 7468 6520 6572 726f  hed. If the erro
+0004ab80: 7220 6973 2072 6564 7563 6564 2062 7920  r is reduced by 
+0004ab90: 6d6f 7265 2074 6861 6e20 6120 6661 6374  more than a fact
+0004aba0: 6f72 206f 6620 3130 3020 696e 2061 2073  or of 100 in a s
+0004abb0: 696e 676c 6520 7374 6570 2c20 2069 7420  ingle step,  it 
+0004abc0: 6973 2061 7373 756d 6564 2074 6861 7420  is assumed that 
+0004abd0: 736f 6d65 7468 696e 6720 6669 7368 7920  something fishy 
+0004abe0: 6973 2067 6f69 6e67 206f 6e20 616e 6420  is going on and 
+0004abf0: 7765 2072 6573 7461 7274 2074 6865 2066  we restart the f
+0004ac00: 6974 2c20 2062 7574 2077 6974 6820 6120  it,  but with a 
+0004ac10: 3130 7820 736d 616c 6c65 7220 7369 6d70  10x smaller simp
+0004ac20: 6c65 7820 7374 6570 7369 7a65 2061 6e64  lex stepsize and
+0004ac30: 2064 6565 705f 6974 6572 6163 7469 6f6e   deep_iteraction
+0004ac40: 2046 416c 7365 0d0a 0909 0d0a 0909 5061   FAlse........Pa
+0004ac50: 7261 6d65 7465 7273 0d0a 0909 2d2d 2d2d  rameters....----
+0004ac60: 2d2d 2d2d 2d2d 2d0d 0a09 0970 6172 6466  -------....pardf
+0004ac70: 0d0a 0909 0909 0923 2064 6565 705f 6974  .......# deep_it
+0004ac80: 6572 6174 696f 6e20 7573 6573 2074 6865  eration uses the
+0004ac90: 2070 7265 7669 6f75 7320 6b69 6e65 7469   previous kineti
+0004aca0: 6320 6f70 7469 6d69 7a65 6420 7061 7261  c optimized para
+0004acb0: 6d65 7465 7220 6173 2074 6865 2069 6e70  meter as the inp
+0004acc0: 7574 2069 6e74 6f20 7468 6520 6e65 7874  ut into the next
+0004acd0: 2066 6974 2e20 0d0a 0909 0923 4361 6e20   fit. .....#Can 
+0004ace0: 6265 2067 7265 6174 2062 7574 2063 616e  be great but can
+0004acf0: 2061 6c73 6f20 7275 6e20 6177 6179 2c20   also run away, 
+0004ad00: 696e 2067 656e 6572 616c 206e 6f74 206e  in general not n
+0004ad10: 6565 6465 6420 616e 6420 6361 6e20 6265  eeded and can be
+0004ad20: 2074 7269 6767 6572 6564 2062 7920 6665   triggered by fe
+0004ad30: 6564 696e 6720 7468 6520 0d0a 0909 0923  eding the .....#
+0004ad40: 7265 7375 6c74 7320 6261 636b 2069 6e74  results back int
+0004ad50: 6f20 7468 6520 676c 6f62 616c 2066 6974  o the global fit
+0004ad60: 2727 270d 0a09 0969 6620 7061 7264 662e  '''....if pardf.
+0004ad70: 7661 7279 2e61 6e79 2829 3a0d 0a09 0909  vary.any():.....
+0004ad80: 696e 6974 6961 6c5f 6572 726f 7220 3d20  initial_error = 
+0004ad90: 5b72 6573 756c 7473 2e72 6573 6964 7561  [results.residua
+0004ada0: 6c5b 305d 5d0d 0a09 0909 7061 725f 696e  l[0]].....par_in
+0004adb0: 746f 5f63 6869 7270 6669 7420 3d20 7265  to_chirpfit = re
+0004adc0: 7375 6c74 732e 7061 7261 6d73 0d0a 0909  sults.params....
+0004add0: 656c 7365 3a0d 0a09 0909 696e 6974 6961  else:.....initia
+0004ade0: 6c5f 6572 726f 7220 3d20 5b65 7272 5f66  l_error = [err_f
+0004adf0: 756e 6328 7061 7261 7320 3d20 7365 6c66  unc(paras = self
+0004ae00: 2e70 6172 5f66 6974 2c20 6473 203d 2066  .par_fit, ds = f
+0004ae10: 6974 5f64 732c 206d 6f64 203d 2073 656c  it_ds, mod = sel
+0004ae20: 662e 6d6f 642c 2066 696e 616c 203d 2046  f.mod, final = F
+0004ae30: 616c 7365 2c20 6c6f 675f 6669 7420 3d20  alse, log_fit = 
+0004ae40: 7365 6c66 2e6c 6f67 5f66 6974 295d 0d0a  self.log_fit)]..
+0004ae50: 0909 0970 6172 5f69 6e74 6f5f 6368 6972  ...par_into_chir
+0004ae60: 7066 6974 203d 2073 656c 662e 7061 720d  pfit = self.par.
+0004ae70: 0a09 0970 6172 5f69 6e74 6f5f 6368 6972  ...par_into_chir
+0004ae80: 7066 6974 5b27 7430 275d 2e76 6172 7920  pfit['t0'].vary 
+0004ae90: 3d20 4661 6c73 650d 0a09 0969 6e69 7469  = False....initi
+0004aea0: 616c 5f66 6974 5f63 6f65 6666 203d 2073  al_fit_coeff = s
+0004aeb0: 656c 662e 6669 7463 6f65 6666 0d0a 0909  elf.fitcoeff....
+0004aec0: 6966 206c 656e 2869 6e69 7469 616c 5f66  if len(initial_f
+0004aed0: 6974 5f63 6f65 6666 2920 3d3d 2036 3a0d  it_coeff) == 6:.
+0004aee0: 0a09 0909 696e 6974 6961 6c5f 6669 745f  ....initial_fit_
+0004aef0: 636f 6566 665b 345d 203d 2073 656c 662e  coeff[4] = self.
+0004af00: 6669 7463 6f65 6666 5b34 5d2b 7365 6c66  fitcoeff[4]+self
+0004af10: 2e66 6974 636f 6566 665b 355d 0d0a 0909  .fitcoeff[5]....
+0004af20: 0969 6e69 7469 616c 5f66 6974 5f63 6f65  .initial_fit_coe
+0004af30: 6666 203d 2069 6e69 7469 616c 5f66 6974  ff = initial_fit
+0004af40: 5f63 6f65 6666 5b3a 355d 0d0a 0909 6368  _coeff[:5]....ch
+0004af50: 6972 705f 7061 7220 3d20 6c6d 6669 742e  irp_par = lmfit.
+0004af60: 5061 7261 6d65 7465 7273 2829 0d0a 0909  Parameters()....
+0004af70: 0909 0909 0909 0909 0909 0909 0920 2020  .............   
+0004af80: 0d0a 0909 666f 7220 6920 696e 2072 616e  ....for i in ran
+0004af90: 6765 2835 293a 0d0a 0909 0963 6869 7270  ge(5):.....chirp
+0004afa0: 5f70 6172 2e61 6464 2827 7025 6927 2528  _par.add('p%i'%(
+0004afb0: 342d 6929 2c20 7661 6c75 6520 3d20 696e  4-i), value = in
+0004afc0: 6974 6961 6c5f 6669 745f 636f 6566 665b  itial_fit_coeff[
+0004afd0: 695d 290d 0a09 0963 6869 7270 5f70 6172  i])....chirp_par
+0004afe0: 5b27 7034 275d 2e73 6574 286d 696e 203d  ['p4'].set(min =
+0004aff0: 2063 6869 7270 5f70 6172 5b27 7034 275d   chirp_par['p4']
+0004b000: 2d30 2e35 2c20 6d61 7820 3d20 6368 6972  -0.5, max = chir
+0004b010: 705f 7061 725b 2770 3427 5d2b 302e 3529  p_par['p4']+0.5)
+0004b020: 0d0a 0909 7472 793a 236c 6574 7320 7365  ....try:#lets se
+0004b030: 6e64 2069 6e20 7468 6520 6261 636b 6772  nd in the backgr
+0004b040: 6f75 6e64 2063 6f72 7265 6374 6564 206d  ound corrected m
+0004b050: 6174 7269 7820 6661 696c 7320 6966 206e  atrix fails if n
+0004b060: 6f20 7072 696f 7220 6261 636b 6772 6f75  o prior backgrou
+0004b070: 6e64 2077 6173 2064 6f6e 650d 0a09 0909  nd was done.....
+0004b080: 636f 7272 6563 7469 6f6e 203d 2073 656c  correction = sel
+0004b090: 662e 6261 636b 6772 6f75 6e64 5f70 6172  f.background_par
+0004b0a0: 5b33 5d0d 0a09 0909 6473 5f62 6163 6b5f  [3].....ds_back_
+0004b0b0: 636f 7272 203d 2073 656c 662e 6473 5f6f  corr = self.ds_o
+0004b0c0: 7269 2d63 6f72 7265 6374 696f 6e0d 0a09  ri-correction...
+0004b0d0: 0965 7863 6570 743a 0d0a 0909 0964 735f  .except:.....ds_
+0004b0e0: 6261 636b 5f63 6f72 7220 3d20 7365 6c66  back_corr = self
+0004b0f0: 2e64 735f 6f72 690d 0a09 0964 735f 6261  .ds_ori....ds_ba
+0004b100: 636b 5f63 6f72 7220 3d20 7375 625f 6473  ck_corr = sub_ds
+0004b110: 2864 7320 3d20 6473 5f62 6163 6b5f 636f  (ds = ds_back_co
+0004b120: 7272 2c20 7363 6174 7465 7263 7574 203d  rr, scattercut =
+0004b130: 2073 656c 662e 7363 6174 7465 7263 7574   self.scattercut
+0004b140: 2c20 626f 7264 6572 6375 7420 3d20 7365  , bordercut = se
+0004b150: 6c66 2e62 6f72 6465 7263 7574 2c20 0d0a  lf.bordercut, ..
+0004b160: 0909 0909 0909 0909 7469 6d65 6c69 6d69  ........timelimi
+0004b170: 7473 203d 2073 656c 662e 7469 6d65 6c69  ts = self.timeli
+0004b180: 6d69 7473 2c20 7761 7665 5f6e 6d5f 6269  mits, wave_nm_bi
+0004b190: 6e20 3d20 7365 6c66 2e77 6176 655f 6e6d  n = self.wave_nm
+0004b1a0: 5f62 696e 2c20 7469 6d65 5f62 696e 203d  _bin, time_bin =
+0004b1b0: 2073 656c 662e 7469 6d65 5f62 696e 2c20   self.time_bin, 
+0004b1c0: 0d0a 0909 0909 0909 0909 6571 7561 6c5f  ..........equal_
+0004b1d0: 656e 6572 6779 5f62 696e 203d 2073 656c  energy_bin = sel
+0004b1e0: 662e 6571 7561 6c5f 656e 6572 6779 5f62  f.equal_energy_b
+0004b1f0: 696e 2909 0909 0909 0909 0909 0909 0909  in).............
+0004b200: 0909 0909 2020 200d 0a09 0970 7269 6e74  ....   ....print
+0004b210: 2827 4265 666f 7265 2063 6869 7270 6669  ('Before chirpfi
+0004b220: 7420 7468 6520 6572 726f 7220 6973 3a7b  t the error is:{
+0004b230: 3a2e 3665 7d27 2e66 6f72 6d61 7428 696e  :.6e}'.format(in
+0004b240: 6974 6961 6c5f 6572 726f 725b 2d31 5d29  itial_error[-1])
+0004b250: 290d 0a09 090d 0a09 0923 2323 2323 2323  )........#######
 0004b260: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004b270: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004b280: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004b290: 2323 2323 2323 2323 2323 2323 0d0a 0909  ############....
-0004b2a0: 232d 2d2d 2d43 6869 7270 2066 6974 206c  #----Chirp fit l
-0004b2b0: 6f6f 702d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  oop-------------
-0004b2c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0004b2d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0004b2e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0004b290: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004b2a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004b2b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004b2c0: 2323 2323 2323 2323 2323 0d0a 0909 232d  ##########....#-
+0004b2d0: 2d2d 2d43 6869 7270 2066 6974 206c 6f6f  ---Chirp fit loo
+0004b2e0: 702d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  p---------------
 0004b2f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0004b300: 2d2d 2d2d 0d0a 0909 2323 2323 2323 2323  ----....########
-0004b310: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004b320: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004b330: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004b300: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0004b310: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0004b320: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0004b330: 2d2d 0d0a 0909 2323 2323 2323 2323 2323  --....##########
 0004b340: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004b350: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004b360: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004b370: 2323 2323 2323 2323 230d 0a09 090d 0a09  #########.......
-0004b380: 0966 6f72 206c 6f6f 7020 696e 2072 616e  .for loop in ran
-0004b390: 6765 2866 6974 5f63 6869 7270 5f69 7465  ge(fit_chirp_ite
-0004b3a0: 7261 7469 6f6e 7329 3a0d 0a09 0909 0d0a  rations):.......
-0004b3b0: 0909 0963 6869 7270 6d69 6e69 2020 3d20  ...chirpmini  = 
-0004b3c0: 206c 6d66 6974 2e4d 696e 696d 697a 6572   lmfit.Minimizer
-0004b3d0: 2873 656c 662e 5f5f 4669 745f 4368 6972  (self.__Fit_Chir
-0004b3e0: 705f 696e 6e65 722c 2063 6869 7270 5f70  p_inner, chirp_p
-0004b3f0: 6172 2c20 0d0a 0909 0909 0909 0909 0909  ar, ............
-0004b400: 0966 636e 5f6b 7773 203d 207b 2764 735f  .fcn_kws = {'ds_
-0004b410: 6261 636b 5f63 6f72 7227 3a64 735f 6261  back_corr':ds_ba
-0004b420: 636b 5f63 6f72 722e 636f 7079 2829 2c20  ck_corr.copy(), 
-0004b430: 2769 6e69 7469 616c 5f66 6974 5f63 6f65  'initial_fit_coe
-0004b440: 6666 273a 696e 6974 6961 6c5f 6669 745f  ff':initial_fit_
-0004b450: 636f 6566 662c 200d 0a09 0909 0909 0909  coeff, .........
-0004b460: 0909 0909 0909 0927 7061 7261 6d73 273a  .......'params':
-0004b470: 7061 725f 696e 746f 5f63 6869 7270 6669  par_into_chirpfi
-0004b480: 742c 2027 6d6f 6427 3a73 656c 662e 6d6f  t, 'mod':self.mo
-0004b490: 642c 2027 6c6f 675f 6669 7427 3a73 656c  d, 'log_fit':sel
-0004b4a0: 662e 6c6f 675f 6669 742c 200d 0a09 0909  f.log_fit, .....
-0004b4b0: 0909 0909 0909 0909 0909 0927 7363 6174  ...........'scat
-0004b4c0: 7465 7263 7574 273a 7365 6c66 2e73 6361  tercut':self.sca
-0004b4d0: 7474 6572 6375 742c 2027 626f 7264 6572  ttercut, 'border
-0004b4e0: 6375 7427 3a73 656c 662e 626f 7264 6572  cut':self.border
-0004b4f0: 6375 742c 200d 0a09 0909 0909 0909 0909  cut, ...........
-0004b500: 0909 0909 0927 7469 6d65 6c69 6d69 7473  .....'timelimits
-0004b510: 273a 7365 6c66 2e74 696d 656c 696d 6974  ':self.timelimit
-0004b520: 732c 2027 7761 7665 5f6e 6d5f 6269 6e27  s, 'wave_nm_bin'
-0004b530: 3a73 656c 662e 7761 7665 5f6e 6d5f 6269  :self.wave_nm_bi
-0004b540: 6e2c 200d 0a09 0909 0909 0909 0909 0909  n, .............
-0004b550: 0909 0927 7469 6d65 5f62 696e 273a 7365  ...'time_bin':se
-0004b560: 6c66 2e74 696d 655f 6269 6e7d 2920 0d0a  lf.time_bin}) ..
-0004b570: 0909 0973 7465 705f 7369 7a65 203d 2035  ...step_size = 5
-0004b580: 652d 320d 0a09 0909 7472 793a 0d0a 0909  e-2.....try:....
-0004b590: 0909 7374 6172 7420 203d 2020 746d 2e74  ..start  =  tm.t
-0004b5a0: 696d 6528 290d 0a09 0909 0973 696d 7020  ime()......simp 
-0004b5b0: 3d20 6e70 2e61 7272 6179 285b 6368 6972  = np.array([chir
-0004b5c0: 705f 7061 725b 2770 3427 5d2e 7661 6c75  p_par['p4'].valu
-0004b5d0: 652c 2063 6869 7270 5f70 6172 5b27 7033  e, chirp_par['p3
-0004b5e0: 275d 2e76 616c 7565 2c20 6368 6972 705f  '].value, chirp_
-0004b5f0: 7061 725b 2770 3227 5d2e 7661 6c75 652c  par['p2'].value,
-0004b600: 2063 6869 7270 5f70 6172 5b27 7031 275d   chirp_par['p1']
+0004b370: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004b380: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004b390: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004b3a0: 2323 2323 2323 230d 0a09 090d 0a09 0966  #######........f
+0004b3b0: 6f72 206c 6f6f 7020 696e 2072 616e 6765  or loop in range
+0004b3c0: 2866 6974 5f63 6869 7270 5f69 7465 7261  (fit_chirp_itera
+0004b3d0: 7469 6f6e 7329 3a0d 0a09 0909 0d0a 0909  tions):.........
+0004b3e0: 0963 6869 7270 6d69 6e69 2020 3d20 206c  .chirpmini  =  l
+0004b3f0: 6d66 6974 2e4d 696e 696d 697a 6572 2873  mfit.Minimizer(s
+0004b400: 656c 662e 5f5f 4669 745f 4368 6972 705f  elf.__Fit_Chirp_
+0004b410: 696e 6e65 722c 2063 6869 7270 5f70 6172  inner, chirp_par
+0004b420: 2c20 0d0a 0909 0909 0909 0909 0909 0966  , .............f
+0004b430: 636e 5f6b 7773 203d 207b 2764 735f 6261  cn_kws = {'ds_ba
+0004b440: 636b 5f63 6f72 7227 3a64 735f 6261 636b  ck_corr':ds_back
+0004b450: 5f63 6f72 722e 636f 7079 2829 2c20 2769  _corr.copy(), 'i
+0004b460: 6e69 7469 616c 5f66 6974 5f63 6f65 6666  nitial_fit_coeff
+0004b470: 273a 696e 6974 6961 6c5f 6669 745f 636f  ':initial_fit_co
+0004b480: 6566 662c 200d 0a09 0909 0909 0909 0909  eff, ...........
+0004b490: 0909 0909 0927 7061 7261 6d73 273a 7061  .....'params':pa
+0004b4a0: 725f 696e 746f 5f63 6869 7270 6669 742c  r_into_chirpfit,
+0004b4b0: 2027 6d6f 6427 3a73 656c 662e 6d6f 642c   'mod':self.mod,
+0004b4c0: 2027 6c6f 675f 6669 7427 3a73 656c 662e   'log_fit':self.
+0004b4d0: 6c6f 675f 6669 742c 200d 0a09 0909 0909  log_fit, .......
+0004b4e0: 0909 0909 0909 0909 0927 7363 6174 7465  .........'scatte
+0004b4f0: 7263 7574 273a 7365 6c66 2e73 6361 7474  rcut':self.scatt
+0004b500: 6572 6375 742c 2027 626f 7264 6572 6375  ercut, 'bordercu
+0004b510: 7427 3a73 656c 662e 626f 7264 6572 6375  t':self.bordercu
+0004b520: 742c 200d 0a09 0909 0909 0909 0909 0909  t, .............
+0004b530: 0909 0927 7469 6d65 6c69 6d69 7473 273a  ...'timelimits':
+0004b540: 7365 6c66 2e74 696d 656c 696d 6974 732c  self.timelimits,
+0004b550: 2027 7761 7665 5f6e 6d5f 6269 6e27 3a73   'wave_nm_bin':s
+0004b560: 656c 662e 7761 7665 5f6e 6d5f 6269 6e2c  elf.wave_nm_bin,
+0004b570: 200d 0a09 0909 0909 0909 0909 0909 0909   ...............
+0004b580: 0927 7469 6d65 5f62 696e 273a 7365 6c66  .'time_bin':self
+0004b590: 2e74 696d 655f 6269 6e7d 2920 0d0a 0909  .time_bin}) ....
+0004b5a0: 0973 7465 705f 7369 7a65 203d 2035 652d  .step_size = 5e-
+0004b5b0: 320d 0a09 0909 7472 793a 0d0a 0909 0909  2.....try:......
+0004b5c0: 7374 6172 7420 203d 2020 746d 2e74 696d  start  =  tm.tim
+0004b5d0: 6528 290d 0a09 0909 0973 696d 7020 3d20  e()......simp = 
+0004b5e0: 6e70 2e61 7272 6179 285b 6368 6972 705f  np.array([chirp_
+0004b5f0: 7061 725b 2770 3427 5d2e 7661 6c75 652c  par['p4'].value,
+0004b600: 2063 6869 7270 5f70 6172 5b27 7033 275d   chirp_par['p3']
 0004b610: 2e76 616c 7565 2c20 6368 6972 705f 7061  .value, chirp_pa
-0004b620: 725b 2770 3027 5d2e 7661 6c75 655d 290d  r['p0'].value]).
-0004b630: 0a09 0909 0973 696d 7020 3d20 6e70 2e74  .....simp = np.t
-0004b640: 696c 6528 7369 6d70 2e72 6573 6861 7065  ile(simp.reshape
-0004b650: 2835 2c20 3129 2c20 3629 2e54 0d0a 0909  (5, 1), 6).T....
-0004b660: 0909 666f 7220 6920 696e 2072 616e 6765  ..for i in range
-0004b670: 2835 293a 0d0a 0909 0909 0969 6620 7369  (5):.......if si
-0004b680: 6d70 5b69 2b31 2c20 695d 2021 3d20 303a  mp[i+1, i] != 0:
-0004b690: 0d0a 0909 0909 0909 6966 2069 3c34 3a0d  ........if i<4:.
-0004b6a0: 0a09 0909 0909 0909 7369 6d70 5b69 2b31  ........simp[i+1
-0004b6b0: 2c20 695d 203d 2073 696d 705b 692b 312c  , i] = simp[i+1,
-0004b6c0: 2069 5d2a 2873 7465 705f 7369 7a65 290d   i]*(step_size).
-0004b6d0: 0a09 0909 0909 0965 6c73 653a 0d0a 0909  .......else:....
-0004b6e0: 0909 0909 0973 696d 705b 692b 312c 2069  .....simp[i+1, i
-0004b6f0: 5d20 3d20 7369 6d70 5b69 2b31 2c20 695d  ] = simp[i+1, i]
-0004b700: 2b30 2e31 0d0a 0909 0909 0965 6c73 653a  +0.1.......else:
-0004b710: 0d0a 0909 0909 0909 7369 6d70 5b69 2b31  ........simp[i+1
-0004b720: 2c20 695d 203d 2031 652d 3409 0d0a 0909  , i] = 1e-4.....
-0004b730: 0909 2377 6520 7374 6172 7420 6279 206f  ..#we start by o
-0004b740: 7074 696d 697a 696e 6720 7468 6520 6368  ptimizing the ch
-0004b750: 6972 7020 7769 7468 2066 6978 6564 2047  irp with fixed G
-0004b760: 6c6f 6261 6c20 6669 740d 0a09 0909 0963  lobal fit......c
-0004b770: 6869 7270 5f72 6573 756c 7473 2020 3d20  hirp_results  = 
-0004b780: 2063 6869 7270 6d69 6e69 2e6d 696e 696d   chirpmini.minim
-0004b790: 697a 6528 276e 656c 6465 7227 2c20 206f  ize('nelder',  o
-0004b7a0: 7074 696f 6e73 203d 207b 276d 6178 6665  ptions = {'maxfe
-0004b7b0: 7627 3a31 6534 2c20 2766 6174 6f6c 273a  v':1e4, 'fatol':
-0004b7c0: 696e 6974 6961 6c5f 6572 726f 725b 2d31  initial_error[-1
-0004b7d0: 5d2a 3165 2d36 2c20 2769 6e69 7469 616c  ]*1e-6, 'initial
-0004b7e0: 5f73 696d 706c 6578 273a 7369 6d70 7d29  _simplex':simp})
-0004b7f0: 0d0a 0909 0909 656e 6420 203d 2020 746d  ......end  =  tm
-0004b800: 2e74 696d 6528 290d 0a09 0909 096f 7074  .time()......opt
-0004b810: 5f63 6f65 6666 203d 2063 6869 7270 5f72  _coeff = chirp_r
-0004b820: 6573 756c 7473 2e70 6172 616d 730d 0a09  esults.params...
-0004b830: 0909 0974 656d 7020 3d20 6e70 2e61 7272  ...temp = np.arr
-0004b840: 6179 285b 6f70 745f 636f 6566 665b 2770  ay([opt_coeff['p
-0004b850: 3427 5d2e 7661 6c75 652c 206f 7074 5f63  4'].value, opt_c
-0004b860: 6f65 6666 5b27 7033 275d 2e76 616c 7565  oeff['p3'].value
-0004b870: 2c20 6f70 745f 636f 6566 665b 2770 3227  , opt_coeff['p2'
+0004b620: 725b 2770 3227 5d2e 7661 6c75 652c 2063  r['p2'].value, c
+0004b630: 6869 7270 5f70 6172 5b27 7031 275d 2e76  hirp_par['p1'].v
+0004b640: 616c 7565 2c20 6368 6972 705f 7061 725b  alue, chirp_par[
+0004b650: 2770 3027 5d2e 7661 6c75 655d 290d 0a09  'p0'].value])...
+0004b660: 0909 0973 696d 7020 3d20 6e70 2e74 696c  ...simp = np.til
+0004b670: 6528 7369 6d70 2e72 6573 6861 7065 2835  e(simp.reshape(5
+0004b680: 2c20 3129 2c20 3629 2e54 0d0a 0909 0909  , 1), 6).T......
+0004b690: 666f 7220 6920 696e 2072 616e 6765 2835  for i in range(5
+0004b6a0: 293a 0d0a 0909 0909 0969 6620 7369 6d70  ):.......if simp
+0004b6b0: 5b69 2b31 2c20 695d 2021 3d20 303a 0d0a  [i+1, i] != 0:..
+0004b6c0: 0909 0909 0909 6966 2069 3c34 3a0d 0a09  ......if i<4:...
+0004b6d0: 0909 0909 0909 7369 6d70 5b69 2b31 2c20  ......simp[i+1, 
+0004b6e0: 695d 203d 2073 696d 705b 692b 312c 2069  i] = simp[i+1, i
+0004b6f0: 5d2a 2873 7465 705f 7369 7a65 290d 0a09  ]*(step_size)...
+0004b700: 0909 0909 0965 6c73 653a 0d0a 0909 0909  .....else:......
+0004b710: 0909 0973 696d 705b 692b 312c 2069 5d20  ...simp[i+1, i] 
+0004b720: 3d20 7369 6d70 5b69 2b31 2c20 695d 2b30  = simp[i+1, i]+0
+0004b730: 2e31 0d0a 0909 0909 0965 6c73 653a 0d0a  .1.......else:..
+0004b740: 0909 0909 0909 7369 6d70 5b69 2b31 2c20  ......simp[i+1, 
+0004b750: 695d 203d 2031 652d 3409 0d0a 0909 0909  i] = 1e-4.......
+0004b760: 2377 6520 7374 6172 7420 6279 206f 7074  #we start by opt
+0004b770: 696d 697a 696e 6720 7468 6520 6368 6972  imizing the chir
+0004b780: 7020 7769 7468 2066 6978 6564 2047 6c6f  p with fixed Glo
+0004b790: 6261 6c20 6669 740d 0a09 0909 0963 6869  bal fit......chi
+0004b7a0: 7270 5f72 6573 756c 7473 2020 3d20 2063  rp_results  =  c
+0004b7b0: 6869 7270 6d69 6e69 2e6d 696e 696d 697a  hirpmini.minimiz
+0004b7c0: 6528 276e 656c 6465 7227 2c20 206f 7074  e('nelder',  opt
+0004b7d0: 696f 6e73 203d 207b 276d 6178 6665 7627  ions = {'maxfev'
+0004b7e0: 3a31 6534 2c20 2766 6174 6f6c 273a 696e  :1e4, 'fatol':in
+0004b7f0: 6974 6961 6c5f 6572 726f 725b 2d31 5d2a  itial_error[-1]*
+0004b800: 3165 2d36 2c20 2769 6e69 7469 616c 5f73  1e-6, 'initial_s
+0004b810: 696d 706c 6578 273a 7369 6d70 7d29 0d0a  implex':simp})..
+0004b820: 0909 0909 656e 6420 203d 2020 746d 2e74  ....end  =  tm.t
+0004b830: 696d 6528 290d 0a09 0909 096f 7074 5f63  ime()......opt_c
+0004b840: 6f65 6666 203d 2063 6869 7270 5f72 6573  oeff = chirp_res
+0004b850: 756c 7473 2e70 6172 616d 730d 0a09 0909  ults.params.....
+0004b860: 0974 656d 7020 3d20 6e70 2e61 7272 6179  .temp = np.array
+0004b870: 285b 6f70 745f 636f 6566 665b 2770 3427  ([opt_coeff['p4'
 0004b880: 5d2e 7661 6c75 652c 206f 7074 5f63 6f65  ].value, opt_coe
-0004b890: 6666 5b27 7031 275d 2e76 616c 7565 2c20  ff['p1'].value, 
-0004b8a0: 6f70 745f 636f 6566 665b 2770 3027 5d2e  opt_coeff['p0'].
-0004b8b0: 7661 6c75 655d 290d 0a09 0909 0923 4372  value])......#Cr
-0004b8c0: 6561 7465 2074 6865 206e 6577 2063 6869  eate the new chi
-0004b8d0: 7270 2063 6f72 7265 6374 6564 2064 6174  rp corrected dat
-0004b8e0: 610d 0a09 0909 0974 696d 6520 3d20 6473  a......time = ds
-0004b8f0: 5f62 6163 6b5f 636f 7272 2e69 6e64 6578  _back_corr.index
-0004b900: 2e76 616c 7565 732e 6173 7479 7065 2827  .values.astype('
-0004b910: 666c 6f61 7427 2923 6578 7472 6163 7420  float')#extract 
-0004b920: 7468 6520 7469 6d65 0909 200d 0a09 0909  the time.. .....
-0004b930: 096e 6577 5f64 7320 3d20 6473 5f62 6163  .new_ds = ds_bac
-0004b940: 6b5f 636f 7272 2e63 6f70 7928 292e 6170  k_corr.copy().ap
-0004b950: 706c 7928 6c61 6d62 6461 2078 3a6e 702e  ply(lambda x:np.
-0004b960: 696e 7465 7270 2878 203d 2074 696d 652b  interp(x = time+
-0004b970: 6e70 2e70 6f6c 7976 616c 2874 656d 702c  np.polyval(temp,
-0004b980: 2066 6c6f 6174 2878 2e6e 616d 6529 292c   float(x.name)),
-0004b990: 2078 7020 3d20 7469 6d65 2c20 6670 203d   xp = time, fp =
-0004b9a0: 2078 292c 2061 7869 7320 3d20 302c 2072   x), axis = 0, r
-0004b9b0: 6177 203d 2046 616c 7365 290d 0a09 0909  aw = False).....
-0004b9c0: 0923 4e65 7720 476c 6f62 616c 2046 6974  .#New Global Fit
-0004b9d0: 0d0a 0909 0909 6669 745f 6473 5f6c 6f6f  ......fit_ds_loo
-0004b9e0: 7020 3d20 7375 625f 6473 2864 7320 3d20  p = sub_ds(ds = 
-0004b9f0: 6e65 775f 6473 2c20 7363 6174 7465 7263  new_ds, scatterc
-0004ba00: 7574 203d 2073 656c 662e 7363 6174 7465  ut = self.scatte
-0004ba10: 7263 7574 2c20 626f 7264 6572 6375 7420  rcut, bordercut 
-0004ba20: 3d20 7365 6c66 2e62 6f72 6465 7263 7574  = self.bordercut
-0004ba30: 2c20 7469 6d65 6c69 6d69 7473 203d 2073  , timelimits = s
-0004ba40: 656c 662e 7469 6d65 6c69 6d69 7473 2c20  elf.timelimits, 
-0004ba50: 7761 7665 5f6e 6d5f 6269 6e20 3d20 7365  wave_nm_bin = se
-0004ba60: 6c66 2e77 6176 655f 6e6d 5f62 696e 2c20  lf.wave_nm_bin, 
-0004ba70: 6571 7561 6c5f 656e 6572 6779 5f62 696e  equal_energy_bin
-0004ba80: 203d 2073 656c 662e 6571 7561 6c5f 656e   = self.equal_en
-0004ba90: 6572 6779 5f62 696e 2c20 7469 6d65 5f62  ergy_bin, time_b
-0004baa0: 696e 203d 2073 656c 662e 7469 6d65 5f62  in = self.time_b
-0004bab0: 696e 2909 0d0a 0909 0909 6966 2070 6172  in).......if par
-0004bac0: 6466 2e76 6172 792e 616e 7928 293a 0909  df.vary.any():..
-0004bad0: 0909 0909 0920 0d0a 0909 0909 096d 696e  ..... .......min
-0004bae0: 6920 203d 2020 6c6d 6669 742e 4d69 6e69  i  =  lmfit.Mini
-0004baf0: 6d69 7a65 7228 6572 725f 6675 6e63 2c20  mizer(err_func, 
-0004bb00: 7061 725f 696e 746f 5f63 6869 7270 6669  par_into_chirpfi
-0004bb10: 742c 2066 636e 5f6b 7773 203d 207b 2764  t, fcn_kws = {'d
-0004bb20: 7327 3a66 6974 5f64 735f 6c6f 6f70 2c20  s':fit_ds_loop, 
-0004bb30: 276d 6f64 273a 6d6f 642c 2027 6c6f 675f  'mod':mod, 'log_
-0004bb40: 6669 7427 3a73 656c 662e 6c6f 675f 6669  fit':self.log_fi
-0004bb50: 742c 2027 6669 6e61 6c27 3a46 616c 7365  t, 'final':False
-0004bb60: 7d29 0d0a 0909 0909 0972 6573 756c 7473  }).......results
-0004bb70: 5f69 6e5f 6368 6972 7020 203d 2020 6d69  _in_chirp  =  mi
-0004bb80: 6e69 2e6d 696e 696d 697a 6528 276e 656c  ni.minimize('nel
-0004bb90: 6465 7227 2c20 6f70 7469 6f6e 7320 3d20  der', options = 
-0004bba0: 7b27 6d61 7869 7465 7227 3a31 6535 7d29  {'maxiter':1e5})
-0004bbb0: 0d0a 0909 0909 0969 6e69 7469 616c 5f65  .......initial_e
-0004bbc0: 7272 6f72 2e61 7070 656e 6428 7265 7375  rror.append(resu
-0004bbd0: 6c74 735f 696e 5f63 6869 7270 2e72 6573  lts_in_chirp.res
-0004bbe0: 6964 7561 6c5b 305d 290d 0a09 0909 0965  idual[0])......e
-0004bbf0: 6c73 653a 0d0a 0909 0909 0969 6e69 7469  lse:.......initi
-0004bc00: 616c 5f65 7272 6f72 2e61 7070 656e 6428  al_error.append(
-0004bc10: 6572 725f 6675 6e63 2870 6172 6173 203d  err_func(paras =
-0004bc20: 2070 6172 5f69 6e74 6f5f 6368 6972 7066   par_into_chirpf
-0004bc30: 6974 2c20 6473 203d 2066 6974 5f64 735f  it, ds = fit_ds_
-0004bc40: 6c6f 6f70 2c20 6d6f 6420 3d20 6d6f 642c  loop, mod = mod,
-0004bc50: 2066 696e 616c 203d 2046 616c 7365 2c20   final = False, 
-0004bc60: 6c6f 675f 6669 7420 3d20 7365 6c66 2e6c  log_fit = self.l
-0004bc70: 6f67 5f66 6974 2929 090d 0a09 0909 0969  og_fit)).......i
-0004bc80: 6620 696e 6974 6961 6c5f 6572 726f 725b  f initial_error[
-0004bc90: 2d31 5d3c 696e 6974 6961 6c5f 6572 726f  -1]<initial_erro
-0004bca0: 725b 2d32 5d3a 0d0a 0909 0909 0969 6620  r[-2]:.......if 
-0004bcb0: 696e 6974 6961 6c5f 6572 726f 725b 2d32  initial_error[-2
-0004bcc0: 5d2f 696e 6974 6961 6c5f 6572 726f 725b  ]/initial_error[
-0004bcd0: 2d31 5d3e 3130 303a 2373 6f6d 6574 6869  -1]>100:#somethi
-0004bce0: 6e67 2066 6973 6879 2067 6f69 6e67 206f  ng fishy going o
-0004bcf0: 6e2e 206c 6574 7320 7472 7920 6167 6169  n. lets try agai
-0004bd00: 6e0d 0a09 0909 0909 0970 7269 6e74 2827  n........print('
-0004bd10: 4368 6972 705f 6c6f 6f70 207b 3a30 3264  Chirp_loop {:02d
-0004bd20: 7d20 7374 7261 6e67 6520 6465 6372 6561  } strange decrea
-0004bd30: 7365 2073 7465 7020 7369 7a65 272e 666f  se step size'.fo
-0004bd40: 726d 6174 286c 6f6f 702b 3129 290d 0a09  rmat(loop+1))...
-0004bd50: 0909 0909 0969 6e69 7469 616c 5f65 7272  .....initial_err
-0004bd60: 6f72 5b2d 315d 203d 2069 6e69 7469 616c  or[-1] = initial
-0004bd70: 5f65 7272 6f72 5b2d 325d 0d0a 0909 0909  _error[-2]......
-0004bd80: 0909 7374 6570 5f73 697a 6520 3d20 7374  ..step_size = st
-0004bd90: 6570 5f73 697a 652f 3130 300d 0a09 0909  ep_size/100.....
-0004bda0: 0909 0969 6620 6c65 6e28 696e 6974 6961  ...if len(initia
-0004bdb0: 6c5f 6572 726f 7229 3e34 3a0d 0a09 0909  l_error)>4:.....
-0004bdc0: 0909 0909 6966 2069 6e69 7469 616c 5f65  ....if initial_e
-0004bdd0: 7272 6f72 5b2d 345d 203d 3d20 696e 6974  rror[-4] == init
-0004bde0: 6961 6c5f 6572 726f 725b 2d31 5d3a 2377  ial_error[-1]:#w
-0004bdf0: 6520 6861 7665 2072 756e 2074 6869 7320  e have run this 
-0004be00: 7472 6963 6b20 6e6f 7720 7468 7265 6520  trick now three 
-0004be10: 7469 6d65 732c 2020 7469 6d65 2074 6f20  times,  time to 
-0004be20: 6272 6561 6b0d 0a09 0909 0909 0909 0972  break..........r
-0004be30: 6169 7365 2053 746f 7049 7465 7261 7469  aise StopIterati
-0004be40: 6f6e 0d0a 0909 0909 0909 6465 6570 5f69  on........deep_i
-0004be50: 7465 7261 7469 6f6e 3d46 616c 7365 0d0a  teration=False..
-0004be60: 0909 0909 0965 6c73 653a 0d0a 0909 0909  .....else:......
-0004be70: 0909 7072 696e 7428 2743 6869 7270 5f6c  ..print('Chirp_l
-0004be80: 6f6f 7020 7b3a 3032 647d 2072 6573 756c  oop {:02d} resul
-0004be90: 7465 6420 696e 2020 203a 7b3a 2e38 657d  ted in   :{:.8e}
-0004bea0: 272e 666f 726d 6174 286c 6f6f 702b 312c  '.format(loop+1,
-0004beb0: 2069 6e69 7469 616c 5f65 7272 6f72 5b2d   initial_error[-
-0004bec0: 315d 2929 0d0a 0909 0909 0909 6966 2064  1]))........if d
-0004bed0: 6565 705f 6974 6572 6174 696f 6e3a 0909  eep_iteration:..
-0004bee0: 0923 5468 6973 2072 6573 756c 7473 2069  .#This results i
-0004bef0: 6e20 6120 7665 7279 2064 6565 7020 6974  n a very deep it
-0004bf00: 6572 6174 696f 6e20 6f66 2074 6865 2073  eration of the s
-0004bf10: 7461 7274 696e 6720 7061 7261 6d65 7465  tarting paramete
-0004bf20: 720d 0a09 0909 0909 0909 6966 2070 6172  r.........if par
-0004bf30: 6466 2e76 6172 792e 616e 7928 293a 0d0a  df.vary.any():..
-0004bf40: 0909 0909 0909 0909 7061 725f 696e 746f  ........par_into
-0004bf50: 5f63 6869 7270 6669 7420 3d20 7265 7375  _chirpfit = resu
-0004bf60: 6c74 735f 696e 5f63 6869 7270 2e70 6172  lts_in_chirp.par
-0004bf70: 616d 7309 0909 090d 0a09 0909 0909 0963  ams............c
-0004bf80: 6869 7270 5f70 6172 203d 2063 6869 7270  hirp_par = chirp
-0004bf90: 5f72 6573 756c 7473 2e70 6172 616d 730d  _results.params.
-0004bfa0: 0a09 0909 0965 6c73 653a 0d0a 0909 0909  .....else:......
-0004bfb0: 0972 6169 7365 2053 746f 7049 7465 7261  .raise StopItera
-0004bfc0: 7469 6f6e 0d0a 0909 0965 7863 6570 7420  tion.....except 
-0004bfd0: 5374 6f70 4974 6572 6174 696f 6e3a 0d0a  StopIteration:..
-0004bfe0: 0909 0909 7072 696e 7428 2769 7465 7261  ....print('itera
-0004bff0: 7469 6f6e 2069 7320 6e6f 7420 736d 616c  tion is not smal
-0004c000: 6c65 7220 6669 6e69 7368 6564 2063 6869  ler finished chi
-0004c010: 7270 206c 6f6f 7069 6e67 2729 0d0a 0909  rp looping')....
-0004c020: 0909 6272 6561 6b0d 0a09 0909 6578 6365  ..break.....exce
-0004c030: 7074 3a0d 0a09 0909 0970 7269 6e74 2827  pt:......print('
-0004c040: 6661 696c 7572 6520 696e 2063 6869 7270  failure in chirp
-0004c050: 206f 7074 696d 6973 6174 696f 6e20 696e   optimisation in
-0004c060: 2069 7465 7261 7469 6f6e 2025 6927 2528   iteration %i'%(
-0004c070: 6c6f 6f70 2b31 2929 0d0a 0909 0909 696d  loop+1))......im
-0004c080: 706f 7274 2073 7973 0d0a 0909 0909 7072  port sys......pr
-0004c090: 696e 7428 2255 6e65 7870 6563 7465 6420  int("Unexpected 
-0004c0a0: 6572 726f 723a 222c 2020 7379 732e 6578  error:",  sys.ex
-0004c0b0: 635f 696e 666f 2829 5b30 5d29 0d0a 0909  c_info()[0])....
-0004c0c0: 0909 696e 6974 6961 6c5f 6572 726f 722e  ..initial_error.
-0004c0d0: 6170 7065 6e64 2869 6e69 7469 616c 5f65  append(initial_e
-0004c0e0: 7272 6f72 5b30 5d29 2374 6f20 6176 6f69  rror[0])#to avoi
-0004c0f0: 6420 7468 6174 206e 756d 6265 7273 2061  d that numbers a
-0004c100: 7265 2077 7269 7474 656e 0d0a 0909 0909  re written......
-0004c110: 6272 6561 6b0d 0a09 090d 0a09 0923 2323  break........###
-0004c120: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c130: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c140: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004b890: 6666 5b27 7033 275d 2e76 616c 7565 2c20  ff['p3'].value, 
+0004b8a0: 6f70 745f 636f 6566 665b 2770 3227 5d2e  opt_coeff['p2'].
+0004b8b0: 7661 6c75 652c 206f 7074 5f63 6f65 6666  value, opt_coeff
+0004b8c0: 5b27 7031 275d 2e76 616c 7565 2c20 6f70  ['p1'].value, op
+0004b8d0: 745f 636f 6566 665b 2770 3027 5d2e 7661  t_coeff['p0'].va
+0004b8e0: 6c75 655d 290d 0a09 0909 0923 4372 6561  lue])......#Crea
+0004b8f0: 7465 2074 6865 206e 6577 2063 6869 7270  te the new chirp
+0004b900: 2063 6f72 7265 6374 6564 2064 6174 610d   corrected data.
+0004b910: 0a09 0909 0974 696d 6520 3d20 6473 5f62  .....time = ds_b
+0004b920: 6163 6b5f 636f 7272 2e69 6e64 6578 2e76  ack_corr.index.v
+0004b930: 616c 7565 732e 6173 7479 7065 2827 666c  alues.astype('fl
+0004b940: 6f61 7427 2923 6578 7472 6163 7420 7468  oat')#extract th
+0004b950: 6520 7469 6d65 0909 200d 0a09 0909 096e  e time.. ......n
+0004b960: 6577 5f64 7320 3d20 6473 5f62 6163 6b5f  ew_ds = ds_back_
+0004b970: 636f 7272 2e63 6f70 7928 292e 6170 706c  corr.copy().appl
+0004b980: 7928 6c61 6d62 6461 2078 3a6e 702e 696e  y(lambda x:np.in
+0004b990: 7465 7270 2878 203d 2074 696d 652b 6e70  terp(x = time+np
+0004b9a0: 2e70 6f6c 7976 616c 2874 656d 702c 2066  .polyval(temp, f
+0004b9b0: 6c6f 6174 2878 2e6e 616d 6529 292c 2078  loat(x.name)), x
+0004b9c0: 7020 3d20 7469 6d65 2c20 6670 203d 2078  p = time, fp = x
+0004b9d0: 292c 2061 7869 7320 3d20 302c 2072 6177  ), axis = 0, raw
+0004b9e0: 203d 2046 616c 7365 290d 0a09 0909 0923   = False)......#
+0004b9f0: 4e65 7720 476c 6f62 616c 2046 6974 0d0a  New Global Fit..
+0004ba00: 0909 0909 6669 745f 6473 5f6c 6f6f 7020  ....fit_ds_loop 
+0004ba10: 3d20 7375 625f 6473 2864 7320 3d20 6e65  = sub_ds(ds = ne
+0004ba20: 775f 6473 2c20 7363 6174 7465 7263 7574  w_ds, scattercut
+0004ba30: 203d 2073 656c 662e 7363 6174 7465 7263   = self.scatterc
+0004ba40: 7574 2c20 626f 7264 6572 6375 7420 3d20  ut, bordercut = 
+0004ba50: 7365 6c66 2e62 6f72 6465 7263 7574 2c20  self.bordercut, 
+0004ba60: 7469 6d65 6c69 6d69 7473 203d 2073 656c  timelimits = sel
+0004ba70: 662e 7469 6d65 6c69 6d69 7473 2c20 7761  f.timelimits, wa
+0004ba80: 7665 5f6e 6d5f 6269 6e20 3d20 7365 6c66  ve_nm_bin = self
+0004ba90: 2e77 6176 655f 6e6d 5f62 696e 2c20 6571  .wave_nm_bin, eq
+0004baa0: 7561 6c5f 656e 6572 6779 5f62 696e 203d  ual_energy_bin =
+0004bab0: 2073 656c 662e 6571 7561 6c5f 656e 6572   self.equal_ener
+0004bac0: 6779 5f62 696e 2c20 7469 6d65 5f62 696e  gy_bin, time_bin
+0004bad0: 203d 2073 656c 662e 7469 6d65 5f62 696e   = self.time_bin
+0004bae0: 2909 0d0a 0909 0909 6966 2070 6172 6466  ).......if pardf
+0004baf0: 2e76 6172 792e 616e 7928 293a 0909 0909  .vary.any():....
+0004bb00: 0909 0920 0d0a 0909 0909 096d 696e 6920  ... .......mini 
+0004bb10: 203d 2020 6c6d 6669 742e 4d69 6e69 6d69   =  lmfit.Minimi
+0004bb20: 7a65 7228 6572 725f 6675 6e63 2c20 7061  zer(err_func, pa
+0004bb30: 725f 696e 746f 5f63 6869 7270 6669 742c  r_into_chirpfit,
+0004bb40: 2066 636e 5f6b 7773 203d 207b 2764 7327   fcn_kws = {'ds'
+0004bb50: 3a66 6974 5f64 735f 6c6f 6f70 2c20 276d  :fit_ds_loop, 'm
+0004bb60: 6f64 273a 6d6f 642c 2027 6c6f 675f 6669  od':mod, 'log_fi
+0004bb70: 7427 3a73 656c 662e 6c6f 675f 6669 742c  t':self.log_fit,
+0004bb80: 2027 6669 6e61 6c27 3a46 616c 7365 7d29   'final':False})
+0004bb90: 0d0a 0909 0909 0972 6573 756c 7473 5f69  .......results_i
+0004bba0: 6e5f 6368 6972 7020 203d 2020 6d69 6e69  n_chirp  =  mini
+0004bbb0: 2e6d 696e 696d 697a 6528 276e 656c 6465  .minimize('nelde
+0004bbc0: 7227 2c20 6f70 7469 6f6e 7320 3d20 7b27  r', options = {'
+0004bbd0: 6d61 7869 7465 7227 3a31 6535 7d29 0d0a  maxiter':1e5})..
+0004bbe0: 0909 0909 0969 6e69 7469 616c 5f65 7272  .....initial_err
+0004bbf0: 6f72 2e61 7070 656e 6428 7265 7375 6c74  or.append(result
+0004bc00: 735f 696e 5f63 6869 7270 2e72 6573 6964  s_in_chirp.resid
+0004bc10: 7561 6c5b 305d 290d 0a09 0909 0965 6c73  ual[0])......els
+0004bc20: 653a 0d0a 0909 0909 0969 6e69 7469 616c  e:.......initial
+0004bc30: 5f65 7272 6f72 2e61 7070 656e 6428 6572  _error.append(er
+0004bc40: 725f 6675 6e63 2870 6172 6173 203d 2070  r_func(paras = p
+0004bc50: 6172 5f69 6e74 6f5f 6368 6972 7066 6974  ar_into_chirpfit
+0004bc60: 2c20 6473 203d 2066 6974 5f64 735f 6c6f  , ds = fit_ds_lo
+0004bc70: 6f70 2c20 6d6f 6420 3d20 6d6f 642c 2066  op, mod = mod, f
+0004bc80: 696e 616c 203d 2046 616c 7365 2c20 6c6f  inal = False, lo
+0004bc90: 675f 6669 7420 3d20 7365 6c66 2e6c 6f67  g_fit = self.log
+0004bca0: 5f66 6974 2929 090d 0a09 0909 0969 6620  _fit)).......if 
+0004bcb0: 696e 6974 6961 6c5f 6572 726f 725b 2d31  initial_error[-1
+0004bcc0: 5d3c 696e 6974 6961 6c5f 6572 726f 725b  ]<initial_error[
+0004bcd0: 2d32 5d3a 0d0a 0909 0909 0969 6620 696e  -2]:.......if in
+0004bce0: 6974 6961 6c5f 6572 726f 725b 2d32 5d2f  itial_error[-2]/
+0004bcf0: 696e 6974 6961 6c5f 6572 726f 725b 2d31  initial_error[-1
+0004bd00: 5d3e 3130 303a 2373 6f6d 6574 6869 6e67  ]>100:#something
+0004bd10: 2066 6973 6879 2067 6f69 6e67 206f 6e2e   fishy going on.
+0004bd20: 206c 6574 7320 7472 7920 6167 6169 6e0d   lets try again.
+0004bd30: 0a09 0909 0909 0970 7269 6e74 2827 4368  .......print('Ch
+0004bd40: 6972 705f 6c6f 6f70 207b 3a30 3264 7d20  irp_loop {:02d} 
+0004bd50: 7374 7261 6e67 6520 6465 6372 6561 7365  strange decrease
+0004bd60: 2073 7465 7020 7369 7a65 272e 666f 726d   step size'.form
+0004bd70: 6174 286c 6f6f 702b 3129 290d 0a09 0909  at(loop+1)).....
+0004bd80: 0909 0969 6e69 7469 616c 5f65 7272 6f72  ...initial_error
+0004bd90: 5b2d 315d 203d 2069 6e69 7469 616c 5f65  [-1] = initial_e
+0004bda0: 7272 6f72 5b2d 325d 0d0a 0909 0909 0909  rror[-2]........
+0004bdb0: 7374 6570 5f73 697a 6520 3d20 7374 6570  step_size = step
+0004bdc0: 5f73 697a 652f 3130 300d 0a09 0909 0909  _size/100.......
+0004bdd0: 0969 6620 6c65 6e28 696e 6974 6961 6c5f  .if len(initial_
+0004bde0: 6572 726f 7229 3e34 3a0d 0a09 0909 0909  error)>4:.......
+0004bdf0: 0909 6966 2069 6e69 7469 616c 5f65 7272  ..if initial_err
+0004be00: 6f72 5b2d 345d 203d 3d20 696e 6974 6961  or[-4] == initia
+0004be10: 6c5f 6572 726f 725b 2d31 5d3a 2377 6520  l_error[-1]:#we 
+0004be20: 6861 7665 2072 756e 2074 6869 7320 7472  have run this tr
+0004be30: 6963 6b20 6e6f 7720 7468 7265 6520 7469  ick now three ti
+0004be40: 6d65 732c 2020 7469 6d65 2074 6f20 6272  mes,  time to br
+0004be50: 6561 6b0d 0a09 0909 0909 0909 0972 6169  eak..........rai
+0004be60: 7365 2053 746f 7049 7465 7261 7469 6f6e  se StopIteration
+0004be70: 0d0a 0909 0909 0909 6465 6570 5f69 7465  ........deep_ite
+0004be80: 7261 7469 6f6e 3d46 616c 7365 0d0a 0909  ration=False....
+0004be90: 0909 0965 6c73 653a 0d0a 0909 0909 0909  ...else:........
+0004bea0: 7072 696e 7428 2743 6869 7270 5f6c 6f6f  print('Chirp_loo
+0004beb0: 7020 7b3a 3032 647d 2072 6573 756c 7465  p {:02d} resulte
+0004bec0: 6420 696e 2020 203a 7b3a 2e38 657d 272e  d in   :{:.8e}'.
+0004bed0: 666f 726d 6174 286c 6f6f 702b 312c 2069  format(loop+1, i
+0004bee0: 6e69 7469 616c 5f65 7272 6f72 5b2d 315d  nitial_error[-1]
+0004bef0: 2929 0d0a 0909 0909 0909 6966 2064 6565  ))........if dee
+0004bf00: 705f 6974 6572 6174 696f 6e3a 0909 0923  p_iteration:...#
+0004bf10: 5468 6973 2072 6573 756c 7473 2069 6e20  This results in 
+0004bf20: 6120 7665 7279 2064 6565 7020 6974 6572  a very deep iter
+0004bf30: 6174 696f 6e20 6f66 2074 6865 2073 7461  ation of the sta
+0004bf40: 7274 696e 6720 7061 7261 6d65 7465 720d  rting parameter.
+0004bf50: 0a09 0909 0909 0909 6966 2070 6172 6466  ........if pardf
+0004bf60: 2e76 6172 792e 616e 7928 293a 0d0a 0909  .vary.any():....
+0004bf70: 0909 0909 0909 7061 725f 696e 746f 5f63  ......par_into_c
+0004bf80: 6869 7270 6669 7420 3d20 7265 7375 6c74  hirpfit = result
+0004bf90: 735f 696e 5f63 6869 7270 2e70 6172 616d  s_in_chirp.param
+0004bfa0: 7309 0909 090d 0a09 0909 0909 0963 6869  s............chi
+0004bfb0: 7270 5f70 6172 203d 2063 6869 7270 5f72  rp_par = chirp_r
+0004bfc0: 6573 756c 7473 2e70 6172 616d 730d 0a09  esults.params...
+0004bfd0: 0909 0965 6c73 653a 0d0a 0909 0909 0972  ...else:.......r
+0004bfe0: 6169 7365 2053 746f 7049 7465 7261 7469  aise StopIterati
+0004bff0: 6f6e 0d0a 0909 0965 7863 6570 7420 5374  on.....except St
+0004c000: 6f70 4974 6572 6174 696f 6e3a 0d0a 0909  opIteration:....
+0004c010: 0909 7072 696e 7428 2769 7465 7261 7469  ..print('iterati
+0004c020: 6f6e 2069 7320 6e6f 7420 736d 616c 6c65  on is not smalle
+0004c030: 7220 6669 6e69 7368 6564 2063 6869 7270  r finished chirp
+0004c040: 206c 6f6f 7069 6e67 2729 0d0a 0909 0909   looping')......
+0004c050: 6272 6561 6b0d 0a09 0909 6578 6365 7074  break.....except
+0004c060: 3a0d 0a09 0909 0970 7269 6e74 2827 6661  :......print('fa
+0004c070: 696c 7572 6520 696e 2063 6869 7270 206f  ilure in chirp o
+0004c080: 7074 696d 6973 6174 696f 6e20 696e 2069  ptimisation in i
+0004c090: 7465 7261 7469 6f6e 2025 6927 2528 6c6f  teration %i'%(lo
+0004c0a0: 6f70 2b31 2929 0d0a 0909 0909 696d 706f  op+1))......impo
+0004c0b0: 7274 2073 7973 0d0a 0909 0909 7072 696e  rt sys......prin
+0004c0c0: 7428 2255 6e65 7870 6563 7465 6420 6572  t("Unexpected er
+0004c0d0: 726f 723a 222c 2020 7379 732e 6578 635f  ror:",  sys.exc_
+0004c0e0: 696e 666f 2829 5b30 5d29 0d0a 0909 0909  info()[0])......
+0004c0f0: 696e 6974 6961 6c5f 6572 726f 722e 6170  initial_error.ap
+0004c100: 7065 6e64 2869 6e69 7469 616c 5f65 7272  pend(initial_err
+0004c110: 6f72 5b30 5d29 2374 6f20 6176 6f69 6420  or[0])#to avoid 
+0004c120: 7468 6174 206e 756d 6265 7273 2061 7265  that numbers are
+0004c130: 2077 7269 7474 656e 0d0a 0909 0909 6272   written......br
+0004c140: 6561 6b0d 0a09 090d 0a09 0923 2323 2323  eak........#####
 0004c150: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004c160: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004c170: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c180: 2323 2323 2323 2323 2323 2323 2323 0d0a  ##############..
-0004c190: 0909 232d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ..#-------------
-0004c1a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0004c1b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 656e 6420  ------------end 
-0004c1c0: 6368 7269 7020 6669 7420 6c6f 6f70 2d2d  chrip fit loop--
+0004c180: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004c190: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004c1a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004c1b0: 2323 2323 2323 2323 2323 2323 0d0a 0909  ############....
+0004c1c0: 232d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  #---------------
 0004c1d0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0004c1e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0004c1f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d  ---------------.
-0004c200: 0a09 0923 2323 2323 2323 2323 2323 2323  ...#############
-0004c210: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c220: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c230: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004c1e0: 2d2d 2d2d 2d2d 2d2d 2d2d 656e 6420 6368  ----------end ch
+0004c1f0: 7269 7020 6669 7420 6c6f 6f70 2d2d 2d2d  rip fit loop----
+0004c200: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0004c210: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0004c220: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a09  -------------...
+0004c230: 0923 2323 2323 2323 2323 2323 2323 2323  .###############
 0004c240: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004c250: 2323 2323 2323 2323 2323 2323 2323 2323  ################
 0004c260: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004c270: 2323 2323 0d0a 0909 0d0a 0909 6966 2069  ####........if i
-0004c280: 6e69 7469 616c 5f65 7272 6f72 5b2d 315d  nitial_error[-1]
-0004c290: 3c69 6e69 7469 616c 5f65 7272 6f72 5b30  <initial_error[0
-0004c2a0: 5d3a 236c 6574 7320 6368 6563 6b20 6966  ]:#lets check if
-0004c2b0: 2077 6520 696d 7072 6f76 6564 2061 6e79   we improved any
-0004c2c0: 7468 696e 670d 0a09 0909 7072 696e 7428  thing.....print(
-0004c2d0: 2763 6869 7270 2066 6974 2069 6d70 726f  'chirp fit impro
-0004c2e0: 7665 6420 6572 726f 7220 6279 2025 2e32  ved error by %.2
-0004c2f0: 6720 7065 7263 656e 7427 2528 3130 302a  g percent'%(100*
-0004c300: 2831 2d69 6e69 7469 616c 5f65 7272 6f72  (1-initial_error
-0004c310: 5b2d 315d 2f69 6e69 7469 616c 5f65 7272  [-1]/initial_err
-0004c320: 6f72 5b30 5d29 2929 0d0a 0909 0969 6620  or[0]))).....if 
-0004c330: 6973 696e 7374 616e 6365 2874 656d 702c  isinstance(temp,
-0004c340: 206c 6973 7429 206f 7220 6973 696e 7374   list) or isinst
-0004c350: 616e 6365 2874 656d 702c 2074 7970 6528  ance(temp, type(
-0004c360: 6e70 2e61 7261 6e67 6528 3129 2929 3a0d  np.arange(1))):.
-0004c370: 0a09 0909 0973 656c 662e 6669 7463 6f65  .....self.fitcoe
-0004c380: 6666 203d 2074 656d 700d 0a09 0909 656c  ff = temp.....el
-0004c390: 7365 3a0d 0a09 0909 0972 6169 7365 0d0a  se:......raise..
-0004c3a0: 0909 0974 696d 6520 3d20 6473 5f62 6163  ...time = ds_bac
-0004c3b0: 6b5f 636f 7272 2e69 6e64 6578 2e76 616c  k_corr.index.val
-0004c3c0: 7565 732e 6173 7479 7065 2827 666c 6f61  ues.astype('floa
-0004c3d0: 7427 2923 6578 7472 6163 7420 7468 6520  t')#extract the 
-0004c3e0: 7469 6d65 0d0a 0909 0973 656c 662e 6473  time.....self.ds
-0004c3f0: 203d 2064 735f 6261 636b 5f63 6f72 722e   = ds_back_corr.
-0004c400: 6170 706c 7928 6c61 6d62 6461 2078 3a6e  apply(lambda x:n
-0004c410: 702e 696e 7465 7270 2878 203d 2074 696d  p.interp(x = tim
-0004c420: 652b 6e70 2e70 6f6c 7976 616c 2874 656d  e+np.polyval(tem
-0004c430: 702c 2066 6c6f 6174 2878 2e6e 616d 6529  p, float(x.name)
-0004c440: 292c 2078 7020 3d20 7469 6d65 2c20 6670  ), xp = time, fp
-0004c450: 203d 2078 292c 2061 7869 7320 3d20 302c   = x), axis = 0,
-0004c460: 2072 6177 203d 2046 616c 7365 2909 0909   raw = False)...
-0004c470: 200d 0a09 0909 6669 745f 6473 203d 2073   .....fit_ds = s
-0004c480: 7562 5f64 7328 6473 203d 2073 656c 662e  ub_ds(ds = self.
-0004c490: 6473 2c20 7363 6174 7465 7263 7574 203d  ds, scattercut =
-0004c4a0: 2073 656c 662e 7363 6174 7465 7263 7574   self.scattercut
-0004c4b0: 2c20 626f 7264 6572 6375 7420 3d20 7365  , bordercut = se
-0004c4c0: 6c66 2e62 6f72 6465 7263 7574 2c20 7469  lf.bordercut, ti
-0004c4d0: 6d65 6c69 6d69 7473 203d 2073 656c 662e  melimits = self.
-0004c4e0: 7469 6d65 6c69 6d69 7473 2c20 7761 7665  timelimits, wave
-0004c4f0: 5f6e 6d5f 6269 6e20 3d20 7365 6c66 2e77  _nm_bin = self.w
-0004c500: 6176 655f 6e6d 5f62 696e 2c20 6571 7561  ave_nm_bin, equa
-0004c510: 6c5f 656e 6572 6779 5f62 696e 203d 2073  l_energy_bin = s
-0004c520: 656c 662e 6571 7561 6c5f 656e 6572 6779  elf.equal_energy
-0004c530: 5f62 696e 2c20 7469 6d65 5f62 696e 203d  _bin, time_bin =
-0004c540: 2073 656c 662e 7469 6d65 5f62 696e 290d   self.time_bin).
-0004c550: 0a09 0909 6966 2070 6172 6466 2e76 6172  ....if pardf.var
-0004c560: 792e 616e 7928 293a 0d0a 0909 0909 7265  y.any():......re
-0004c570: 7375 6c74 732e 7061 7261 6d73 203d 2072  sults.params = r
-0004c580: 6573 756c 7473 5f69 6e5f 6368 6972 702e  esults_in_chirp.
-0004c590: 7061 7261 6d73 0d0a 0909 7265 7475 726e  params....return
-0004c5a0: 2072 6573 756c 7473 2c20 6669 745f 6473   results, fit_ds
-0004c5b0: 0d0a 0909 0d0a 0909 0d0a 0964 6566 2046  ...........def F
-0004c5c0: 6974 5f47 6c6f 6261 6c28 7365 6c66 2c20  it_Global(self, 
-0004c5d0: 7061 7220 3d20 4e6f 6e65 2c20 6d6f 6420  par = None, mod 
-0004c5e0: 3d20 4e6f 6e65 2c20 636f 6e66 6964 656e  = None, confiden
-0004c5f0: 6365 5f6c 6576 656c 203d 204e 6f6e 652c  ce_level = None,
-0004c600: 2075 7365 5f61 6d70 676f 203d 2046 616c   use_ampgo = Fal
-0004c610: 7365 2c20 6669 745f 6368 6972 7020 3d20  se, fit_chirp = 
-0004c620: 4661 6c73 652c 2066 6974 5f63 6869 7270  False, fit_chirp
-0004c630: 5f69 7465 7261 7469 6f6e 7320 3d20 3130  _iterations = 10
-0004c640: 2c20 0d0a 0909 0909 096d 756c 7469 5f70  , .......multi_p
-0004c650: 726f 6a65 6374 203d 204e 6f6e 652c 2075  roject = None, u
-0004c660: 6e69 7175 655f 7061 7261 6d65 7465 7220  nique_parameter 
-0004c670: 3d20 4e6f 6e65 2c20 7765 6967 6874 7320  = None, weights 
-0004c680: 3d20 4e6f 6e65 2c20 7361 6d65 5f44 4153  = None, same_DAS
-0004c690: 203d 2046 616c 7365 2c0d 0a09 0909 0909   = False,.......
-0004c6a0: 6475 6d70 5f70 6172 6173 203d 2046 616c  dump_paras = Fal
-0004c6b0: 7365 2c20 6475 6d70 5f73 6861 7065 7320  se, dump_shapes 
-0004c6c0: 3d20 4661 6c73 652c 2066 696c 656e 616d  = False, filenam
-0004c6d0: 6520 3d20 4e6f 6e65 2c20 6578 745f 7370  e = None, ext_sp
-0004c6e0: 6563 7472 6120 3d20 4e6f 6e65 293a 0d0a  ectra = None):..
-0004c6f0: 0909 2222 2254 6869 7320 6675 6e63 7469  .."""This functi
-0004c700: 6f6e 2069 7320 7065 7266 6f72 6d69 6e67  on is performing
-0004c710: 2061 2067 6c6f 6261 6c20 6669 7420 6f66   a global fit of
-0004c720: 2074 6865 2064 6174 612e 2041 7320 656d   the data. As em
-0004c730: 6265 6464 6564 206f 626a 6563 7420 6974  bedded object it
-0004c740: 2075 7365 7320 0d0a 0909 7468 6520 7061   uses ....the pa
-0004c750: 7261 6d65 7465 7220 636f 6e74 726f 6c20  rameter control 
-0004c760: 6f70 7469 6f6e 7320 6f66 2074 6865 206c  options of the l
-0004c770: 6d66 6974 2070 726f 6a65 6374 2061 7320  mfit project as 
-0004c780: 616e 2065 7373 656e 7469 616c 2074 6f6f  an essential too
-0004c790: 6c2e 200d 0a09 0928 6d79 2074 6861 6e6b  l. ....(my thank
-0004c7a0: 7320 746f 204d 6174 7468 6577 204e 6577  s to Matthew New
-0004c7b0: 7669 6c6c 6520 616e 6420 636f 6c6c 6561  ville and collea
-0004c7c0: 6775 6573 2066 6f72 2063 7265 6174 696e  gues for creatin
-0004c7d0: 6720 7468 6973 2070 6861 6e74 6173 7469  g this phantasti
-0004c7e0: 6320 746f 6f6c 2920 0d0a 0909 5b4d 2e20  c tool) ....[M. 
-0004c7f0: 4e65 7776 696c 6c65 2c20 542e 2053 7465  Newville, T. Ste
-0004c800: 6e73 6974 7a6b 692c 2044 2e20 422e 2041  nsitzki, D. B. A
-0004c810: 6c6c 656e 2c20 412e 2049 6e67 6172 6769  llen, A. Ingargi
-0004c820: 6f6c 612c 2032 3031 342e 2044 4f49 3a20  ola, 2014. DOI: 
-0004c830: 3130 2e35 3238 312f 5a45 4e4f 444f 2e31  10.5281/ZENODO.1
-0004c840: 3138 3133 2e5d 2e20 0d0a 0909 5468 6520  1813.]. ....The 
-0004c850: 7768 6174 2074 7970 6520 6f66 2066 6974  what type of fit
-0004c860: 7469 6e67 2069 7320 7065 7266 6f72 6d65  ting is performe
-0004c870: 6420 6973 2063 6f6e 7472 6f6c 6c65 6420  d is controlled 
-0004c880: 6279 2073 6574 7469 6e67 206f 6620 7468  by setting of th
-0004c890: 6520 7061 7261 6d65 7465 7220 6865 7265  e parameter here
-0004c8a0: 2e0d 0a09 090d 0a09 0954 6865 2067 656e  .........The gen
-0004c8b0: 6572 616c 2066 6974 7469 6e67 2066 6f6c  eral fitting fol
-0004c8c0: 6c6f 7773 2074 6869 7320 726f 7574 696e  lows this routin
-0004c8d0: 653a 0d0a 0909 0931 2e20 0963 7265 6174  e:.....1. .creat
-0004c8e0: 6520 6120 636f 7079 206f 6620 7468 6520  e a copy of the 
-0004c8f0: 4461 7461 2d4d 6174 7269 7820 7365 6c66  Data-Matrix self
-0004c900: 2e64 7320 6973 2063 7265 6174 6564 2077  .ds is created w
-0004c910: 6974 6820 7468 6520 7368 6170 696e 6720  ith the shaping 
-0004c920: 7061 7261 6d65 7465 7273 0d0a 0909 0932  parameters.....2
-0004c930: 2e20 0954 6865 6e20 6120 4d61 7472 6978  . .Then a Matrix
-0004c940: 2069 7320 6372 6561 7465 6420 7468 6174   is created that
-0004c950: 2072 6570 7265 7365 6e74 7320 7468 6520   represents the 
-0004c960: 6672 6163 7469 6f6e 616c 2070 6f70 756c  fractional popul
-0004c970: 6174 696f 6e20 6f66 2065 6163 6820 7370  ation of each sp
-0004c980: 6563 6965 7320 0d0a 0909 0909 286f 7220  ecies ......(or 
-0004c990: 7072 6f63 6573 7365 7320 696e 2063 6173  processes in cas
-0004c9a0: 6520 6f66 2074 6865 2070 6172 616c 206d  e of the paral m
-0004c9b0: 6f64 656c 292e 200d 0a09 0909 0954 6869  odel). ......Thi
-0004c9c0: 7320 4d61 7472 6978 2063 6f6e 7461 696e  s Matrix contain
-0004c9d0: 7320 6f6e 6520 656e 7472 7920 666f 7220  s one entry for 
-0004c9e0: 6561 6368 2074 696d 6570 6f69 6e74 2061  each timepoint a
-0004c9f0: 6e64 2072 6570 7265 7365 6e74 7320 7468  nd represents th
-0004ca00: 6520 6b69 6e65 7469 6320 6d6f 6465 6c20  e kinetic model 
-0004ca10: 0d0a 0909 0909 6261 7365 6420 7570 6f6e  ......based upon
-0004ca20: 2074 6865 2073 7461 7274 696e 6720 7061   the starting pa
-0004ca30: 7261 6d65 7465 722e 2028 7365 6520 6265  rameter. (see be
-0004ca40: 6c6f 7720 666f 7220 6120 6465 7363 7269  low for a descri
-0004ca50: 7074 696f 6e20 6f66 2074 6865 206d 6f64  ption of the mod
-0004ca60: 656c 7329 2e20 0d0a 0909 0909 5468 6973  els). ......This
-0004ca70: 206d 6f64 656c 2066 6f72 6d61 7469 6f6e   model formation
-0004ca80: 2063 616e 2062 7920 646f 6e65 2062 7920   can by done by 
-0004ca90: 7573 696e 6720 6120 6275 696c 6420 696e  using a build in
-0004caa0: 206f 7220 6120 7573 6572 2073 7570 706c   or a user suppl
-0004cab0: 6965 6420 6675 6e63 7469 6f6e 2e20 0d0a  ied function. ..
-0004cac0: 0909 0909 2868 616e 646c 6564 2069 6e20  ....(handled in 
-0004cad0: 7468 6520 6675 6e63 7469 6f6e 2022 7066  the function "pf
-0004cae0: 2e62 7569 6c64 5f63 2229 0d0a 0909 0909  .build_c")......
-0004caf0: 2d3e 2049 6620 616e 2065 7874 5f73 7065  -> If an ext_spe
-0004cb00: 6374 7261 2069 7320 7072 6f76 6964 6564  ctra is provided
-0004cb10: 2074 6869 7320 6974 7320 696e 7465 6e73   this its intens
-0004cb20: 6974 7920 6973 2073 7562 7374 6163 7465  ity is substacte
-0004cb30: 6420 6672 6f6d 2074 6865 206d 6174 7269  d from the matri
-0004cb40: 7820 286f 6e6c 7920 666f 7220 6578 7465  x (only for exte
-0004cb50: 726e 616c 206d 6f64 656c 7329 0d0a 0909  rnal models)....
-0004cb60: 0933 2e20 0954 6865 6e20 7468 6520 7072  .3. .Then the pr
-0004cb70: 6f63 6573 732f 7370 6563 6965 7320 6173  ocess/species as
-0004cb80: 736f 6369 6174 6564 2073 7065 6374 7261  sociated spectra
-0004cb90: 2066 6f72 2065 6163 6820 6f66 2074 6865   for each of the
-0004cba0: 2073 7065 6369 6573 2069 7320 6361 6c63   species is calc
-0004cbb0: 756c 6174 6564 200d 0a09 0909 0975 7369  ulated ......usi
-0004cbc0: 6e67 2074 6865 206c 696e 616c 672e 6c73  ng the linalg.ls
-0004cbd0: 7473 7120 616c 676f 7269 7468 6d20 6672  tsq algorithm fr
-0004cbe0: 6f6d 206e 756d 7079 200d 0a09 0909 0928  om numpy ......(
-0004cbf0: 6874 7470 733a 2f2f 6e75 6d70 792e 6f72  https://numpy.or
-0004cc00: 672f 646f 632f 7374 6162 6c65 2f72 6566  g/doc/stable/ref
-0004cc10: 6572 656e 6365 2f67 656e 6572 6174 6564  erence/generated
-0004cc20: 2f6e 756d 7079 2e6c 696e 616c 672e 6c73  /numpy.linalg.ls
-0004cc30: 7473 712e 6874 6d6c 290d 0a09 0909 342e  tsq.html).....4.
-0004cc40: 2009 4672 6f6d 2074 6865 2063 6f6e 766f   .From the convo
-0004cc50: 6c75 7465 6420 6361 6c63 756c 6174 6564  luted calculated
-0004cc60: 2073 7065 6369 6573 2063 6f6e 6365 6e74   species concent
-0004cc70: 7261 7469 6f6e 7320 616e 6420 7370 6563  rations and spec
-0004cc80: 7472 6120 6120 6361 6c63 756c 6174 6564  tra a calculated
-0004cc90: 206d 6174 7269 7820 0d0a 0909 0909 6973   matrix ......is
-0004cca0: 2066 6f72 6d65 6420 2868 616e 646c 6564   formed (handled
-0004ccb0: 2069 6e20 7468 6520 6675 6e63 7469 6f6e   in the function
-0004ccc0: 2022 7066 2e66 696c 6c5f 696e 7422 290d   "pf.fill_int").
-0004ccd0: 0a09 0909 352e 2009 5468 6520 6469 6666  ....5. .The diff
-0004cce0: 6572 656e 6365 2062 6574 7765 656e 2063  erence between c
-0004ccf0: 616c 6375 6c61 7465 6420 616e 6420 6d65  alculated and me
-0004cd00: 6173 7572 6564 2073 7065 6374 7261 2069  asured spectra i
-0004cd10: 7320 6361 6c63 756c 6174 6564 2c20 706f  s calculated, po
-0004cd20: 696e 742d 7769 7365 2073 7175 6172 6564  int-wise squared
-0004cd30: 200d 0a09 0909 0961 6e64 2073 756d 6d65   ......and summe
-0004cd40: 6420 746f 6765 7468 6572 2e20 2866 756e  d together. (fun
-0004cd50: 6374 696f 6e20 2265 7272 5f66 756e 6322  ction "err_func"
-0004cd60: 206f 7220 2265 7272 5f66 756e 635f 6d75   or "err_func_mu
-0004cd70: 6c74 6922 2069 6620 6d75 6c74 6970 6c65  lti" if multiple
-0004cd80: 2064 6174 6173 6574 7320 6172 6520 6669   datasets are fi
-0004cd90: 7474 6564 290d 0a09 0909 362e 2009 5468  tted).....6. .Th
-0004cda0: 6973 2064 6966 6665 7265 6e63 6520 6973  is difference is
-0004cdb0: 206d 696e 696d 697a 6564 2062 7920 6974   minimized by it
-0004cdc0: 6572 6174 696e 6720 322d 3420 7769 7468  erating 2-4 with
-0004cdd0: 2063 6861 6e67 696e 6720 7061 7261 6d65   changing parame
-0004cde0: 7465 7273 2075 7369 6e67 2061 6e20 0d0a  ters using an ..
-0004cdf0: 0909 0909 6f70 7469 6d69 7a61 7469 6f6e  ....optimization
-0004ce00: 2061 6c67 6f72 6974 686d 2028 6765 6e65   algorithm (gene
-0004ce10: 7261 6c6c 7920 6e65 6c64 6572 2d6d 6561  rally nelder-mea
-0004ce20: 6420 7369 6d70 6c65 7829 0d0a 0909 0937  d simplex).....7
-0004ce30: 2e20 0946 696e 616c 6c79 2069 6e20 6120  . .Finally in a 
-0004ce40: 6c61 7374 2072 756e 206f 6620 322d 3520  last run of 2-5 
-0004ce50: 7468 6520 6669 6e61 6c20 7370 6563 7472  the final spectr
-0004ce60: 6120 6172 6520 6361 6c63 756c 6174 6564  a are calculated
-0004ce70: 2028 7573 696e 6720 7468 6520 2266 696e   (using the "fin
-0004ce80: 616c 2220 666c 6167 2920 0d0a 0909 0909  al" flag) ......
-0004ce90: 616e 6420 7468 6520 6f70 7469 6d69 7a65  and the optimize
-0004cea0: 6420 7061 7261 6d65 7465 722c 2074 6865  d parameter, the
-0004ceb0: 206d 6174 7269 7865 7320 0d0a 0909 0909   matrixes ......
-0004cec0: 2822 4122 2d6d 6561 7375 7265 642c 2022  ("A"-measured, "
-0004ced0: 4143 2220 2d20 6361 6c63 756c 6174 6564  AC" - calculated
-0004cee0: 2c20 2241 4522 202d 206c 696e 6561 7220  , "AE" - linear 
-0004cef0: 6572 726f 7229 2c20 0d0a 0909 0909 7370  error), ......sp
-0004cf00: 6563 7472 6120 2861 6c77 6179 7320 6361  ectra (always ca
-0004cf10: 6c6c 6564 2022 4441 5322 2920 7468 6520  lled "DAS") the 
-0004cf20: 636f 6e63 656e 7472 6174 696f 6e73 2028  concentrations (
-0004cf30: 6361 6c6c 6564 2022 6322 2920 0d0a 0909  called "c") ....
-0004cf40: 0909 6172 6520 7772 6974 7465 6e20 696e  ..are written in
-0004cf50: 2074 6865 2064 6963 7469 6f6e 6172 7920   the dictionary 
-0004cf60: 2274 612e 7265 2220 746f 6765 7468 6572  "ta.re" together
-0004cf70: 2077 6974 6820 6120 6665 7720 7265 7375   with a few resu
-0004cf80: 6c74 2072 6570 7265 7365 6e74 6174 696f  lt representatio
-0004cf90: 6e73 200d 0a09 0909 0961 6e64 206f 7468  ns ......and oth
-0004cfa0: 6572 2066 6974 206f 7574 7075 7473 2e20  er fit outputs. 
-0004cfb0: 5468 6520 6f70 7469 6d69 7a65 6420 7061  The optimized pa
-0004cfc0: 7261 6d65 7465 7220 6172 6520 616c 736f  rameter are also
-0004cfd0: 2077 7269 7474 656e 2069 6e74 6f20 7461   written into ta
-0004cfe0: 2e70 6172 5f66 6974 200d 0a09 0909 0928  .par_fit ......(
-0004cff0: 6173 2061 6e20 7061 7261 6d65 7465 7220  as an parameter 
-0004d000: 6f62 6a65 6374 2920 7468 6174 2063 616e  object) that can
-0004d010: 2062 6520 7265 2d75 7365 6420 6173 2069   be re-used as i
-0004d020: 6e70 7574 2069 6e74 6f20 6675 7274 6865  nput into furthe
-0004d030: 7220 6f70 7469 6d69 7a61 7469 6f6e 2073  r optimization s
-0004d040: 7465 7073 2e0d 0a09 0909 090d 0a09 0941  teps...........A
-0004d050: 6c6c 206d 616e 6461 746f 7279 2070 6172  ll mandatory par
-0004d060: 616d 6574 6572 7320 6172 6520 696e 2067  ameters are in g
-0004d070: 656e 6572 616c 2074 616b 656e 2066 726f  eneral taken fro
-0004d080: 6d20 7468 6520 696e 7465 726e 616c 206f  m the internal o
-0004d090: 6a65 6374 2028 7365 6c66 2920 5468 6520  ject (self) The 
-0004d0a0: 6f70 7469 6f6e 616c 2070 6172 616d 6574  optional paramet
-0004d0b0: 6572 2063 6f6e 7472 6f6c 2074 6865 2062  er control the b
-0004d0c0: 6568 6176 696f 7572 206f 6620 7468 6520  ehaviour of the 
-0004d0d0: 6669 7474 696e 6720 6675 6e63 7469 6f6e  fitting function
-0004d0e0: 2020 0d0a 0909 0d0a 0909 5061 7261 6d65    ........Parame
-0004d0f0: 7465 7273 0d0a 0909 2d2d 2d2d 2d2d 2d2d  ters....--------
-0004d100: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 0909 090d  ----------......
-0004d110: 0a09 0909 7061 7220 3a20 6c6d 6669 7420  ....par : lmfit 
-0004d120: 7061 7261 6d65 7465 7220 6f6a 6563 742c  parameter oject,
-0004d130: 206f 7074 696f 6e61 6c0d 0a09 0909 0948   optional......H
-0004d140: 6572 6520 616e 6f74 6865 7220 7061 7261  ere another para
-0004d150: 6d65 7465 7220 6f62 6a65 6374 2063 6f75  meter object cou
-0004d160: 6c64 2062 6520 6769 7665 6e2c 6f76 6572  ld be given,over
-0004d170: 7772 6974 696e 6720 7468 6520 2844 6566  writing the (Def
-0004d180: 6175 6c74 2069 7320 7365 6c66 2e70 6172  ault is self.par
-0004d190: 2920 0d0a 0909 0909 0d0a 0909 096d 6f64  ) ...........mod
-0004d1a0: 203a 2073 7472 206f 7220 6675 6e63 7469   : str or functi
-0004d1b0: 6f6e 2c20 6f70 7469 6f6e 616c 0d0a 0909  on, optional....
-0004d1c0: 0909 4769 7665 2061 2065 7874 7261 206d  ..Give a extra m
-0004d1d0: 6f64 656c 2073 656c 6563 7469 6f6e 2028  odel selection (
-0004d1e0: 4465 6661 756c 7420 7573 6573 2073 656c  Default uses sel
-0004d1f0: 662e 6d6f 6429 0d0a 0909 0909 696e 7465  f.mod)......inte
-0004d200: 726e 616c 206d 6f64 656c 6c73 3a20 2770  rnal modells: 'p
-0004d210: 6172 616c 272c 2765 7870 6f6e 656e 7469  aral','exponenti
-0004d220: 616c 272c 2763 6f6e 7365 6375 7469 7665  al','consecutive
-0004d230: 272c 2766 756c 6c5f 636f 6e73 6563 7574  ','full_consecut
-0004d240: 6976 6527 0d0a 0909 0909 7365 6520 616c  ive'......see al
-0004d250: 736f 203a 6d65 7468 3a60 706c 6f74 5f66  so :meth:`plot_f
-0004d260: 756e 632e 6275 696c 645f 6360 2061 6e64  unc.build_c` and
-0004d270: 203a 6d65 7468 3a60 706c 6f74 5f66 756e   :meth:`plot_fun
-0004d280: 632e 6572 725f 6675 6e63 600d 0a09 0909  c.err_func`.....
-0004d290: 090d 0a09 0909 636f 6e66 6964 656e 6365  ......confidence
-0004d2a0: 5f6c 6576 656c 3a20 4e6f 6e65 206f 7220  _level: None or 
-0004d2b0: 666c 6f61 7420 2830 2e35 2d31 292c 206f  float (0.5-1), o
-0004d2c0: 7074 696f 6e61 6c0d 0a09 0909 0949 6620  ptional......If 
-0004d2d0: 7468 6973 2069 7320 6368 616e 6765 6420  this is changed 
-0004d2e0: 6672 6f6d 204e 6f6e 6520 2844 6566 6175  from None (Defau
-0004d2f0: 6c74 2920 746f 2061 2076 616c 7565 2062  lt) to a value b
-0004d300: 6574 7765 656e 2030 2e35 2061 6e64 2031  etween 0.5 and 1
-0004d310: 2074 6865 2063 6f64 6520 7769 6c6c 0d0a   the code will..
-0004d320: 0909 0909 7472 7920 746f 2063 616c 6375  ....try to calcu
-0004d330: 6c61 7465 2074 6865 2065 7272 6f72 206f  late the error o
-0004d340: 6620 7468 6520 7061 7261 6d65 7465 7220  f the parameter 
-0004d350: 666f 7220 7468 6520 6669 742e 2046 6f72  for the fit. For
-0004d360: 2065 6163 6820 7061 7261 6d65 7465 7220   each parameter 
-0004d370: 7468 6174 200d 0a09 0909 0963 616e 2076  that ......can v
-0004d380: 6172 7920 6120 7365 7061 7261 7465 206f  ary a separate o
-0004d390: 7074 696d 697a 6174 696f 6e20 6973 0970  ptimization is.p
-0004d3a0: 6572 666f 726d 6564 2c20 7468 6174 2061  erformed, that a
-0004d3b0: 7474 656d 7074 7320 746f 2066 696e 6420  ttempts to find 
-0004d3c0: 7468 6520 7570 7065 7220 0d0a 0909 0909  the upper ......
-0004d3d0: 616e 6420 6c6f 7765 7220 626f 756e 6420  and lower bound 
-0004d3e0: 6174 2077 6869 6368 2074 6865 2074 6f74  at which the tot
-0004d3f0: 616c 2065 7272 6f72 206f 6620 7468 6520  al error of the 
-0004d400: 7265 2d6f 7074 696d 697a 6564 2067 6c6f  re-optimized glo
-0004d410: 6261 6c6c 7920 6669 7474 6564 2072 6573  bally fitted res
-0004d420: 756c 7473 0d0a 0909 0909 7265 6163 6865  ults......reache
-0004d430: 7320 7468 6520 6279 2046 2d73 7461 7469  s the by F-stati
-0004d440: 7374 6963 7320 6465 6669 6e65 6420 636f  stics defined co
-0004d450: 6e66 6964 656e 6365 2062 6f75 6e64 2e20  nfidence bound. 
-0004d460: 5365 6520 3a6d 6574 683a 6070 6c6f 745f  See :meth:`plot_
-0004d470: 6675 6e63 2e73 325f 7673 5f73 6d69 6e32  func.s2_vs_smin2
-0004d480: 6020 666f 7220 6465 7461 696c 7320 0d0a  ` for details ..
-0004d490: 0909 0909 6f6e 2068 6f77 2074 6869 7320  ....on how this 
-0004d4a0: 6c65 7665 6c20 6973 2064 6574 6572 6d69  level is determi
-0004d4b0: 6e65 642e 2043 6172 6566 756c 2c20 7468  ned. Careful, th
-0004d4c0: 6973 206f 7074 696f 6e20 6d69 6768 7420  is option might 
-0004d4d0: 7275 6e20 666f 7220 7665 7279 206c 6f6e  run for very lon
-0004d4e0: 6720 7469 6d65 2e0d 0a09 0909 094d 6561  g time.......Mea
-0004d4f0: 6e69 6e67 2074 6861 7420 6974 2074 7970  ning that it typ
-0004d500: 6963 616c 6c79 2074 616b 6573 2035 3020  ically takes 50 
-0004d510: 6f70 7469 6d69 7a61 7469 6f6e 2070 6572  optimization per
-0004d520: 2076 6172 6961 626c 6520 7061 7261 6d65   variable parame
-0004d530: 7465 7220 2868 6172 6420 636f 6465 6420  ter (hard coded 
-0004d540: 6c69 6d69 7420 3230 3029 0d0a 0909 0909  limit 200)......
-0004d550: 5468 6520 636f 6e66 6964 656e 6365 206c  The confidence l
-0004d560: 6576 656c 2069 7320 746f 2062 6520 756e  evel is to be un
-0004d570: 6465 7273 746f 6f64 2074 6861 7420 6974  derstood that it
-0004d580: 2064 6566 696e 6573 2074 6865 2065 2e67   defines the e.g
-0004d590: 2e20 302e 3635 202a 2031 3030 5c25 2061  . 0.65 * 100\% a
-0004d5a0: 7265 6120 7468 6174 2074 6865 0d0a 0909  rea that the....
-0004d5b0: 0909 7061 7261 6d65 7465 7220 7769 7468  ..parameter with
-0004d5c0: 2074 6869 7320 7365 7420 6f66 2076 616c   this set of val
-0004d5d0: 7565 7320 6973 2077 6974 6869 6e20 7468  ues is within th
-0004d5e0: 6973 2062 6f75 6e64 732e 0d0a 0909 0909  is bounds.......
-0004d5f0: 4e6f 726d 616c 2062 6568 6176 696f 7572  Normal behaviour
-0004d600: 2066 6f72 2074 6869 7320 6973 2074 6f20   for this is to 
-0004d610: 7265 2d6f 7074 696d 6973 6520 7468 6520  re-optimise the 
-0004d620: 7061 7261 6d65 7465 7220 6475 7269 6e67  parameter during
-0004d630: 2074 6865 206f 7074 696d 697a 6174 696f   the optimizatio
-0004d640: 6e2e 2069 6620 7468 6520 7061 7261 6d65  n. if the parame
-0004d650: 7465 7220 0d0a 0909 0909 7061 725b 2765  ter ......par['e
-0004d660: 7272 6f72 5f70 6172 616d 5f66 6978 275d  rror_param_fix']
-0004d670: 2069 7320 7072 6573 656e 742c 2074 6869   is present, thi
-0004d680: 7320 7769 6c6c 2062 6520 7375 7070 7265  s will be suppre
-0004d690: 7373 6564 2e0d 0a09 0909 0d0a 0909 0975  ssed...........u
-0004d6a0: 7365 5f61 6d70 676f 203a 2062 6f6f 6c2c  se_ampgo : bool,
-0004d6b0: 206f 7074 696f 6e61 6c0d 0a09 0909 0928   optional......(
-0004d6c0: 4465 6661 756c 7429 2069 7320 4661 6c73  Default) is Fals
-0004d6d0: 650d 0a09 0909 0943 6861 6e67 6573 2074  e......Changes t
-0004d6e0: 6865 206f 7074 696d 697a 6572 2066 726f  he optimizer fro
-0004d6f0: 6d20 6120 7075 7265 204e 656c 6465 7220  m a pure Nelder 
-0004d700: 6d65 6164 2074 6f20 416d 7067 6f20 7769  mead to Ampgo wi
-0004d710: 7468 2061 206c 6f63 616c 204e 656c 6465  th a local Nelde
-0004d720: 7220 4d65 6164 2e20 0d0a 0909 0909 466f  r Mead. ......Fo
-0004d730: 7220 7573 696e 6720 7468 6973 2070 6f77  r using this pow
-0004d740: 6572 6675 6c6c 2074 6f6f 6c20 616c 6c20  erfull tool all 
-0004d750: 7061 7261 6d65 7465 7220 6e65 6564 2074  parameter need t
-0004d760: 6f20 6861 7665 2061 2022 6d69 6e22 2061  o have a "min" a
-0004d770: 6e64 2061 2022 6d61 7822 2073 6574 2e20  nd a "max" set. 
-0004d780: 0d0a 0909 0909 5479 7069 6361 6c6c 7920  ......Typically 
-0004d790: 7461 6b65 7320 3130 2d34 3078 206c 6f6e  takes 10-40x lon
-0004d7a0: 6765 7220 7468 616e 2061 2073 7461 6e64  ger than a stand
-0004d7b0: 6172 6420 6f70 7469 6d69 7a61 7469 6f6e  ard optimization
-0004d7c0: 2c20 6275 7420 6361 6e20 6475 6520 746f  , but can due to
-0004d7d0: 2069 7473 200d 0a09 0909 0974 756e 6e65   its ......tunne
-0004d7e0: 6c69 6e67 2061 6c67 6f72 6974 686d 206d  ling algorithm m
-0004d7f0: 6f72 6520 7265 6c69 6162 6c79 2066 696e  ore reliably fin
-0004d800: 6420 676c 6f62 616c 206d 696e 696d 612e  d global minima.
-0004d810: 200d 0a09 0909 0973 6565 3a68 7474 7073   ......see:https
-0004d820: 3a2f 2f6c 6d66 6974 2e67 6974 6875 622e  ://lmfit.github.
-0004d830: 696f 2f6c 6d66 6974 2d70 792f 6669 7474  io/lmfit-py/fitt
-0004d840: 696e 672e 6874 6d6c 2066 6f72 2066 7572  ing.html for fur
-0004d850: 7468 6572 2064 6574 6169 6c73 0d0a 0909  ther details....
-0004d860: 090d 0a09 0909 6669 745f 6368 6972 7020  ......fit_chirp 
-0004d870: 3a20 626f 6f6c 2c20 6f70 7469 6f6e 616c  : bool, optional
-0004d880: 0d0a 0909 0909 2844 6566 6175 6c74 2920  ......(Default) 
-0004d890: 6973 2046 616c 7365 0d0a 0909 0909 6120  is False......a 
-0004d8a0: 706f 7765 7266 756c 206f 7074 696d 697a  powerful optimiz
-0004d8b0: 6174 696f 6e20 6f66 2074 6865 2063 6869  ation of the chi
-0004d8c0: 7270 2070 6172 616d 6574 6572 2e20 466f  rp parameter. Fo
-0004d8d0: 7220 7468 6973 2074 6f20 776f 726b 2074  r this to work t
-0004d8e0: 6865 2064 6174 6120 0d0a 0909 0909 6e65  he data ......ne
-0004d8f0: 6564 7320 746f 2069 6e63 6c75 6465 2074  eds to include t
-0004d900: 696d 6570 6f69 6e74 7320 6265 666f 7265  imepoints before
-0004d910: 2061 6e64 2061 6674 6572 2074 3d30 2061   and after t=0 a
-0004d920: 6e64 206f 6e65 2073 686f 756c 6420 6861  nd one should ha
-0004d930: 7665 2072 6561 6368 6564 200d 0a09 0909  ve reached .....
-0004d940: 0961 2064 6563 656e 7420 6669 7420 6f66  .a decent fit of
-0004d950: 206d 6f73 7420 6665 6174 7572 6573 2069   most features i
-0004d960: 6e20 7468 6520 7370 6563 7472 756d 2e20  n the spectrum. 
-0004d970: 5765 2070 6572 666f 726d 2061 6e20 4e65  We perform an Ne
-0004d980: 6c64 6572 2d4d 6561 6420 6f70 7469 6d69  lder-Mead optimi
-0004d990: 7361 7469 6f6e 200d 0a09 0909 096f 6620  sation ......of 
-0004d9a0: 7468 6520 7061 7261 6d65 7465 7220 666f  the parameter fo
-0004d9b0: 6c6c 6f77 6564 2062 7920 6120 4e65 6c64  llowed by a Neld
-0004d9c0: 6572 2d4d 6561 6420 6f70 7469 6d69 7a61  er-Mead optimiza
-0004d9d0: 7469 6f6e 206f 6620 7468 6520 6368 6972  tion of the chir
-0004d9e0: 7020 7061 7261 6d65 7465 7220 0d0a 0909  p parameter ....
-0004d9f0: 0909 6173 206f 6e65 2069 7465 7261 7469  ..as one iterati
-0004da00: 6f6e 2e20 4166 7465 7220 6561 6368 2063  on. After each c
-0004da10: 6f6e 7365 6375 7469 7665 206f 7074 696d  onsecutive optim
-0004da20: 697a 6174 696f 6e20 6974 2069 7320 6368  ization it is ch
-0004da30: 6563 6b65 6420 6966 2074 6865 2074 6f74  ecked if the tot
-0004da40: 616c 2065 7272 6f72 200d 0a09 0909 0969  al error ......i
-0004da50: 6d70 726f 7665 642e 2049 6620 6e6f 7420  mproved. If not 
-0004da60: 7468 6520 6669 7420 6973 2065 6e64 6564  the fit is ended
-0004da70: 2c20 6966 2079 6573 2074 6865 206d 6178  , if yes the max
-0004da80: 696d 756d 206e 756d 6265 7220 6f66 2069  imum number of i
-0004da90: 7465 7261 7469 6f6e 7320 0d0a 0909 0909  terations ......
-0004daa0: 2766 6974 5f63 6869 7270 5f69 7465 7261  'fit_chirp_itera
-0004dab0: 7469 6f6e 7327 2069 7320 7065 7266 6f72  tions' is perfor
-0004dac0: 6d65 642e 2057 6172 6e69 6e67 2c20 7468  med. Warning, th
-0004dad0: 6973 2067 6f65 7320 7765 6c6c 2069 6e20  is goes well in 
-0004dae0: 6d61 6e79 2063 6173 6573 2c20 0d0a 0909  many cases, ....
-0004daf0: 0909 6275 7420 6361 6e20 6c65 6164 2074  ..but can lead t
-0004db00: 6f20 7665 7279 2073 7472 616e 6765 2072  o very strange r
-0004db10: 6573 756c 7473 2069 6e20 6f74 6865 7273  esults in others
-0004db20: 2c20 616c 7761 7973 2063 6172 6566 756c  , always careful
-0004db30: 6c79 2063 6865 636b 2074 6865 2072 6573  ly check the res
-0004db40: 756c 7473 2e0d 0a09 0909 0949 2072 6563  ults.......I rec
-0004db50: 6f6d 6d65 6e64 2074 6f20 6d61 6b65 2061  ommend to make a
-0004db60: 2063 6f70 7920 6f66 2074 6865 206f 626a   copy of the obj
-0004db70: 6563 7420 6265 666f 7265 2072 756e 6e6e  ect before runnn
-0004db80: 696e 6720 6120 6368 6972 7020 6f70 7469  ing a chirp opti
-0004db90: 6d69 7a61 7469 6f6e 2e0d 0a09 0909 0d0a  mization........
-0004dba0: 0909 0966 6974 5f63 6869 7270 5f69 7465  ...fit_chirp_ite
-0004dbb0: 7261 7469 6f6e 7320 3a20 696e 742c 206f  rations : int, o
-0004dbc0: 7074 696f 6e61 6c0d 0a09 0909 096d 6178  ptional......max
-0004dbd0: 696d 756d 206e 756d 6265 7220 6f66 2074  imum number of t
-0004dbe0: 696d 6573 2074 6865 2067 6c6f 6261 6c20  imes the global 
-0004dbf0: 2d20 6368 6972 7020 6c6f 6f70 2069 7320  - chirp loop is 
-0004dc00: 7265 7065 6174 6564 2e20 0d0a 0909 0909  repeated. ......
-0004dc10: 5479 7069 6361 6c6c 7920 7468 6973 2069  Typically this i
-0004dc20: 7465 7261 7469 6f6e 7320 7275 6e20 322d  terations run 2-
-0004dc30: 3520 7469 6d65 732c 2028 4465 6661 756c  5 times, (Defaul
-0004dc40: 7429 2069 7320 3130 0d0a 0909 090d 0a09  t) is 10........
-0004dc50: 0909 6475 6d70 5f70 6172 6173 203a 2062  ..dump_paras : b
-0004dc60: 6f6f 6c2c 206f 7074 696f 6e61 6c0d 0a09  ool, optional...
-0004dc70: 0909 0928 4465 6661 756c 7429 2069 7320  ...(Default) is 
-0004dc80: 4661 6c73 652c 2049 6620 5472 7565 2063  False, If True c
-0004dc90: 7265 6174 6573 2074 776f 2066 696c 6573  reates two files
-0004dca0: 2069 6e20 7468 6520 776f 726b 696e 6720   in the working 
-0004dcb0: 666f 6c64 6572 2c20 6f6e 6520 7769 7468  folder, one with
-0004dcc0: 2074 6865 200d 0a09 0909 0963 7572 7265   the ......curre
-0004dcd0: 6e74 6c79 2075 7365 6420 7061 7261 6d65  ntly used parame
-0004dce0: 7465 7220 6372 6561 7465 6420 6174 2074  ter created at t
-0004dcf0: 6865 2065 6e64 206f 6620 6561 6368 206f  he end of each o
-0004dd00: 7074 696d 6973 6174 696f 6e20 7374 6570  ptimisation step
-0004dd10: 2c20 616e 6420 6f6e 6520 7769 7468 0d0a  , and one with..
-0004dd20: 0909 0909 7468 6520 7365 7420 6f66 2070  ....the set of p
-0004dd30: 6172 616d 6574 6572 2074 6861 7420 7570  arameter that up
-0004dd40: 2074 6f20 6e6f 7720 6761 7665 2074 6865   to now gave the
-0004dd50: 206c 6f77 6573 7420 6572 726f 722e 2049   lowest error. I
-0004dd60: 6e74 656e 7465 6420 746f 2073 746f 7265  ntented to store
-0004dd70: 0d0a 0909 0909 7468 6520 6f70 7469 6d69  ......the optimi
-0004dd80: 7361 7469 6f6e 2072 6573 756c 7473 2069  sation results i
-0004dd90: 6620 7468 6520 6669 7420 6e65 6564 7320  f the fit needs 
-0004dda0: 746f 2062 6520 696e 7465 7272 7570 7465  to be interrupte
-0004ddb0: 6420 0d0a 0909 0909 2869 6620 652e 672e  d ......(if e.g.
-0004ddc0: 2041 6d70 676f 2073 696d 706c 7920 6e65   Ampgo simply ne
-0004ddd0: 6564 7320 746f 206c 6f6e 6720 746f 206f  eds to long to o
-0004dde0: 7074 696d 697a 652e 2920 7573 6566 756c  ptimize.) useful
-0004ddf0: 206f 7074 696f 6e20 6966 2074 6869 6e67   option if thing
-0004de00: 7320 6172 6520 736c 6f77 0d0a 0909 0909  s are slow......
-0004de10: 7468 6973 2070 6172 616d 6574 6572 2061  this parameter a
-0004de20: 6c73 6f20 7472 6967 6765 7273 2074 6865  lso triggers the
-0004de30: 2077 7269 7469 6e67 206f 6620 6669 746f   writing of fito
-0004de40: 7574 2074 6f20 6120 7465 7874 6669 6c65  ut to a textfile
-0004de50: 206f 6e20 6469 7363 0d0a 0909 0909 0d0a   on disc........
-0004de60: 0909 0964 756d 705f 7368 6170 6573 203a  ...dump_shapes :
-0004de70: 2062 6f6f 6c2c 206f 7074 696f 6e61 6c0d   bool, optional.
-0004de80: 0a09 0909 0974 6869 7320 6f70 7469 6f6e  .....this option
-0004de90: 2064 756d 7073 2074 6865 2063 6f6e 6365   dumps the conce
-0004dea0: 6e74 7261 746f 696e 206d 6174 7269 7820  ntratoin matrix 
-0004deb0: 616e 6420 7468 6520 4441 5320 6f6e 746f  and the DAS onto
-0004dec0: 2064 6973 6b20 666f 7220 6561 6368 2072   disk for each r
-0004ded0: 6f75 6e64 206f 6620 6f70 7469 6d69 7a61  ound of optimiza
-0004dee0: 7469 6f6e 2c0d 0a09 0909 096d 6f73 746c  tion,......mostl
-0004def0: 7920 7573 6566 756c 2066 6f72 206d 756c  y useful for mul
-0004df00: 7469 2d70 726f 6a65 6374 2066 6974 7469  ti-project fitti
-0004df10: 6e67 2074 6861 7420 7761 6e74 7320 746f  ng that wants to
-0004df20: 2075 7365 2074 6865 2073 7065 6374 7261   use the spectra
-0004df30: 6c20 6f72 2074 656d 706f 7261 6c20 696e  l or temporal in
-0004df40: 7465 6e73 6974 790d 0a09 0909 0d0a 0909  tensity.........
-0004df50: 0966 696c 656e 616d 6520 3a20 4e6f 6e65  .filename : None
-0004df60: 206f 7220 7374 722c 206f 7074 696f 6e61   or str, optiona
-0004df70: 6c0d 0a09 0909 094f 6e6c 7920 7573 6564  l......Only used
-0004df80: 2069 6e20 636f 6e6a 756e 6374 696f 6e20   in conjunction 
-0004df90: 7769 7468 2027 6475 6d70 5f70 6172 6173  with 'dump_paras
-0004dfa0: 272e 2054 6865 2070 726f 6772 616d 2075  '. The program u
-0004dfb0: 7365 7320 7468 6973 2066 696c 656e 616d  ses this filenam
-0004dfc0: 6520 746f 2064 756d 7020 7468 6520 0d0a  e to dump the ..
-0004dfd0: 0909 0909 7061 7261 6d65 7465 7220 746f  ....parameter to
-0004dfe0: 2064 6973 6b20 0d0a 0909 090d 0a09 0909   disk ..........
-0004dff0: 6d75 6c74 695f 7072 6f6a 6563 7420 3a20  multi_project : 
-0004e000: 4e6f 6e65 206f 7220 6c69 7374 2028 6f66  None or list (of
-0004e010: 2054 4120 7072 6f6a 6563 7473 292c 206f   TA projects), o
-0004e020: 7074 696f 6e61 6c0d 0a09 0909 0954 6869  ptional......Thi
-0004e030: 7320 7377 6974 6368 2069 7320 7472 6967  s switch is trig
-0004e040: 6765 7269 6e67 2074 6865 2073 696d 756c  gering the simul
-0004e050: 7461 6e65 6f75 7320 6f70 7469 6d69 7361  taneous optimisa
-0004e060: 7469 6f6e 206f 6620 6d75 6c74 6970 6c65  tion of multiple
-0004e070: 2064 6174 6173 6574 732e 2020 0d0a 0909   datasets.  ....
-0004e080: 0909 6d75 6c74 695f 7072 6f6a 6563 7420  ..multi_project 
-0004e090: 6973 2061 7320 2844 6566 6175 6c74 2920  is as (Default) 
-0004e0a0: 4e6f 6e65 2e20 6974 2065 7870 6563 7473  None. it expects
-0004e0b0: 2061 6e20 6974 6572 6162 6c65 2028 7479   an iterable (ty
-0004e0c0: 7069 6361 6c6c 7920 6c69 7374 2920 7769  pically list) wi
-0004e0d0: 7468 206f 7468 6572 200d 0a09 0909 0954  th other ......T
-0004e0e0: 4120 7072 6f6a 6563 7473 2028 6c69 6b65  A projects (like
-0004e0f0: 2074 6129 2074 6861 7420 6172 6520 7468   ta) that are th
-0004e100: 656e 206f 7074 696d 6973 6564 2077 6974  en optimised wit
-0004e110: 6820 7468 6520 7361 6d65 2070 6172 616d  h the same param
-0004e120: 6574 6572 2e20 0d0a 0909 0909 5468 6973  eter. ......This
-0004e130: 206d 6561 6e73 2074 6861 7420 616c 6c20   means that all 
-0004e140: 7072 6f6a 6563 7473 2067 6574 2074 6865  projects get the
-0004e150: 2073 616d 6520 7061 7261 6d65 7465 7220   same parameter 
-0004e160: 6f62 6a65 6374 2066 6f72 2065 6163 6820  object for each 
-0004e170: 6974 6572 6174 696f 6e20 0d0a 0909 0909  iteration ......
-0004e180: 6f66 2074 6865 2066 6974 2061 6e64 2072  of the fit and r
-0004e190: 6574 7572 6e20 7468 6569 7220 696e 6469  eturn their indi
-0004e1a0: 7669 6475 616c 2065 7272 6f72 2c20 7768  vidual error, wh
-0004e1b0: 6963 6820 6973 2073 756d 6d65 6420 6c69  ich is summed li
-0004e1c0: 6e65 6172 6c79 2e20 0d0a 0909 0909 5468  nearly. ......Th
-0004e1d0: 6520 2277 6569 6768 7473 2220 6f70 7469  e "weights" opti
-0004e1e0: 6f6e 2061 6c6c 6f77 7320 746f 2067 6976  on allows to giv
-0004e1f0: 6520 6561 6368 206d 756c 7469 5f70 726f  e each multi_pro
-0004e200: 6a65 6374 2061 2073 7065 6369 6669 6320  ject a specific 
-0004e210: 7765 6967 6874 2028 6e75 6d62 6572 2920  weight (number) 
-0004e220: 0d0a 0909 0909 7468 6174 2069 7320 6d75  ......that is mu
-0004e230: 6c74 6970 6c69 6564 2074 6f20 7468 6520  ltiplied to the 
-0004e240: 6572 726f 722e 2049 6620 7468 6520 7765  error. If the we
-0004e250: 6967 6874 206f 626a 6563 7420 6861 7320  ight object has 
-0004e260: 7468 6520 7361 6d65 206e 756d 6265 7220  the same number 
-0004e270: 6f66 2069 7465 6d73 200d 0a09 0909 0961  of items ......a
-0004e280: 7320 7468 6520 6d75 6c74 695f 7072 6f6a  s the multi_proj
-0004e290: 6563 7420 6974 2069 7320 6173 7375 6d65  ect it is assume
-0004e2a0: 6420 7468 6174 2074 6865 2074 7269 6767  d that the trigg
-0004e2b0: 6572 696e 6720 6f62 6a65 6374 2028 7468  ering object (th
-0004e2c0: 6520 656d 6265 6464 6564 2070 726f 6a65  e embedded proje
-0004e2d0: 6374 2920 0d0a 0909 0909 6861 7320 7468  ct) ......has th
-0004e2e0: 6520 7765 6967 6874 206f 6620 312c 206f  e weight of 1, o
-0004e2f0: 7468 6572 7769 7365 2074 6865 2066 6972  therwise the fir
-0004e300: 7374 2077 6569 6768 7420 6973 2066 6f72  st weight is for
-0004e310: 2074 6865 2065 6d62 6564 6465 6420 7072   the embedded pr
-0004e320: 6f6a 6563 742e 200d 0a09 0909 0954 6865  oject. ......The
-0004e330: 206f 7074 696f 6e20 2775 6e69 7175 655f   option 'unique_
-0004e340: 7061 7261 6d65 7465 7227 2074 616b 6573  parameter' takes
-0004e350: 2028 6120 6c69 7374 2920 6f66 2070 6172   (a list) of par
-0004e360: 616d 6574 6572 2074 6861 7420 6172 6520  ameter that are 
-0004e370: 6e6f 7420 0d0a 0909 0909 746f 2062 6520  not ......to be 
-0004e380: 7368 6172 6564 2062 6574 7765 656e 2074  shared between t
-0004e390: 6865 2070 726f 6a65 6374 7320 2861 6e64  he projects (and
-0004e3a0: 2074 6861 7420 6172 6520 6e6f 7420 6f70   that are not op
-0004e3b0: 7469 6d69 7a65 6420 6569 7468 6572 2920  timized either) 
-0004e3c0: 0d0a 0909 0909 5468 6520 696e 7465 6e64  ......The intend
-0004e3d0: 6564 2075 7365 206f 6620 7468 6973 2069  ed use of this i
-0004e3e0: 7320 746f 2067 6976 6520 652e 672e 2074  s to give e.g. t
-0004e3f0: 6865 2070 756d 7020 706f 7765 7220 666f  he pump power fo
-0004e400: 7220 6d75 6c74 6970 6c65 2065 7870 6572  r multiple exper
-0004e410: 696d 656e 7473 2074 6f20 0d0a 0909 0909  iments to ......
-0004e420: 7374 7564 7920 6e6f 6e20 6c69 6e65 6172  study non linear
-0004e430: 2062 6568 6176 696f 7572 2e20 5265 7475   behaviour. Retu
-0004e440: 726e 6564 2077 696c 6c20 6265 206f 6e6c  rned will be onl
-0004e450: 7920 7468 6520 7061 7261 6d65 7465 7220  y the parameter 
-0004e460: 7365 7420 666f 7220 7468 6520 6f70 7469  set for the opti
-0004e470: 6d69 756d 0d0a 0909 0909 636f 6d62 696e  mium......combin
-0004e480: 6174 696f 6e20 6f66 2061 6c6c 2070 6172  ation of all par
-0004e490: 616d 6574 6572 2e20 496e 7465 726e 616c  ameter. Internal
-0004e4a0: 6c79 2c20 7765 2069 7465 7261 7465 2074  ly, we iterate t
-0004e4b0: 6872 6f75 6768 2074 6865 2070 726f 6a65  hrough the proje
-0004e4c0: 6374 7320 616e 6420 6361 6c63 756c 6174  cts and calculat
-0004e4d0: 6520 0d0a 0909 0909 666f 7220 6561 6368  e ......for each
-0004e4e0: 2070 726f 6a65 6374 2074 6865 2065 7272   project the err
-0004e4f0: 6f72 2066 6f72 2065 6163 6820 6974 6572  or for each iter
-0004e500: 6174 696f 6e2e 2049 6d70 6f72 7461 6e74  ation. Important
-0004e510: 2074 6f20 6e6f 7465 2069 7320 7468 6174   to note is that
-0004e520: 2063 7572 7265 6e74 6c79 2074 6869 7320   currently this 
-0004e530: 0d0a 0909 0909 6d65 616e 7320 7468 6174  ......means that
-0004e540: 2065 6163 6820 4441 532f 5341 5320 6973   each DAS/SAS is
-0004e550: 2063 616c 6375 6c61 7465 6420 696e 6465   calculated inde
-0004e560: 7065 6e64 656e 746c 7921 2046 6f72 2070  pendently! For p
-0004e570: 6572 666f 726d 696e 6720 7468 6520 7361  erforming the sa
-0004e580: 6d65 2063 616c 6375 6c61 7469 6f6e 0d0a  me calculation..
-0004e590: 0909 0909 7769 7468 2061 2073 696e 676c  ....with a singl
-0004e5a0: 6520 4441 532c 2074 6865 204d 6174 7269  e DAS, the Matri
-0004e5b0: 7865 7320 6e65 6564 2074 6f20 6265 2063  xes need to be c
-0004e5c0: 6f6e 6361 7465 6e61 7465 6420 6265 666f  oncatenated befo
-0004e5d0: 7265 2074 6865 2072 756e 2061 6e64 2061  re the run and a
-0004e5e0: 6e20 6578 7465 726e 616c 0d0a 0909 0909  n external......
-0004e5f0: 6675 6e63 7469 6f6e 2075 7365 6420 746f  function used to
-0004e600: 2063 7265 6174 6520 6120 636f 6d62 696e   create a combin
-0004e610: 6564 206d 6f64 656c 2e20 4173 2074 6869  ed model. As thi
-0004e620: 7320 6973 2076 6572 7920 6469 6666 6963  s is very diffic
-0004e630: 756c 7420 746f 2069 6d70 6c65 6d65 6e74  ult to implement
-0004e640: 2072 656c 6961 626c 790d 0a09 0909 0946   reliably......F
-0004e650: 6f72 2067 656e 6572 616c 2075 7365 2028  or general use (
-0004e660: 7468 696e 6b20 652e 672e 2064 6966 6665  think e.g. diffe
-0004e670: 7265 6e74 2070 756d 7020 7761 7665 6c65  rent pump wavele
-0004e680: 6e67 7468 2920 7468 6973 2068 6173 2074  ngth) this has t
-0004e690: 6f20 6265 2064 6f6e 6520 6d61 6e75 616c  o be done manual
-0004e6a0: 6c79 2e20 0d0a 0909 090d 0a09 0909 756e  ly. ..........un
-0004e6b0: 6971 7565 5f70 6172 616d 6574 6572 203a  ique_parameter :
-0004e6c0: 204e 6f6e 6520 6f72 2073 7472 206f 7220   None or str or 
-0004e6d0: 6c69 7374 2028 6f66 2073 7472 696e 6773  list (of strings
-0004e6e0: 292c 206f 7074 696f 6e61 6c20 0d0a 0909  ), optional ....
-0004e6f0: 0909 6f6e 6c79 2075 7365 6420 696e 2063  ..only used in c
-0004e700: 6f6e 6a75 6e63 7469 6f6e 2077 6974 6820  onjunction with 
-0004e710: 276d 756c 7469 5f70 726f 6a65 6374 272c  'multi_project',
-0004e720: 2069 7420 7461 6b65 7320 2861 206c 6973   it takes (a lis
-0004e730: 7429 206f 6620 7061 7261 6d65 7465 7220  t) of parameter 
-0004e740: 7468 6174 200d 0a09 0909 0961 7265 206e  that ......are n
-0004e750: 6f74 2074 6f20 6265 2073 6861 7265 6420  ot to be shared 
-0004e760: 6265 7477 6565 6e20 7468 6520 7072 6f6a  between the proj
-0004e770: 6563 7473 2028 616e 6420 7468 6174 2061  ects (and that a
-0004e780: 7265 206e 6f74 206f 7074 696d 697a 6564  re not optimized
-0004e790: 2065 6974 6865 7229 200d 0a09 0909 0954   either) ......T
-0004e7a0: 6865 2069 6e74 656e 6465 6420 7573 6520  he intended use 
-0004e7b0: 6f66 2074 6869 7320 6973 2074 6f20 6769  of this is to gi
-0004e7c0: 7665 2065 2e67 2e20 7468 6520 7075 6d70  ve e.g. the pump
-0004e7d0: 2070 6f77 6572 2066 6f72 206d 756c 7469   power for multi
-0004e7e0: 706c 6520 6578 7065 7269 6d65 6e74 7320  ple experiments 
-0004e7f0: 0d0a 0909 0909 746f 2073 7475 6479 206e  ......to study n
-0004e800: 6f6e 206c 696e 6561 7220 6265 6861 7669  on linear behavi
-0004e810: 6f75 722e 2028 4465 6661 756c 7429 204e  our. (Default) N
-0004e820: 6f6e 650d 0a09 0909 0d0a 0909 0973 616d  one..........sam
-0004e830: 655f 4441 5320 3a20 626f 6f6c 2c6f 7074  e_DAS : bool,opt
-0004e840: 696f 6e61 6c0d 0a09 0909 0963 6861 6e67  ional......chang
-0004e850: 6573 2074 6865 2066 6974 2062 6568 6176  es the fit behav
-0004e860: 696f 7220 616e 6420 7573 6573 2074 6865  ior and uses the
-0004e870: 2073 616d 6520 4441 5320 666f 7220 7468   same DAS for th
-0004e880: 6520 6f70 7469 6d69 7a61 7469 6f6e 2e20  e optimization. 
-0004e890: 0d0a 0909 0909 5468 6973 206d 6561 6e73  ......This means
-0004e8a0: 2074 6861 7420 7468 6520 6473 2061 7265   that the ds are
-0004e8b0: 2073 7461 636b 6564 2062 6566 6f72 6520   stacked before 
-0004e8c0: 7468 6520 6669 6c6c 5f69 6e74 2072 6f75  the fill_int rou
-0004e8d0: 6e64 732e 2054 6869 7320 6f70 7469 6f6e  nds. This option
-0004e8e0: 2069 7320 6f6e 6c79 2075 7365 6420 696e   is only used in
-0004e8f0: 206d 756c 7469 2d70 726f 6a65 6374 2066   multi-project f
-0004e900: 6974 7469 6e67 0d0a 0909 090d 0a09 0909  itting..........
-0004e910: 7765 6967 6874 7320 3a20 6c69 7374 206f  weights : list o
-0004e920: 6620 666c 6f61 7473 2c20 6f70 7469 6f6e  f floats, option
-0004e930: 616c 0d0a 0909 0909 6f6e 6c79 2075 7365  al......only use
-0004e940: 6420 696e 2063 6f6e 6a75 6e63 7469 6f6e  d in conjunction
-0004e950: 2077 6974 6820 276d 756c 7469 5f70 726f   with 'multi_pro
-0004e960: 6a65 6374 272e 2054 6865 2022 7765 6967  ject'. The "weig
-0004e970: 6874 7322 206f 7074 696f 6e20 616c 6c6f  hts" option allo
-0004e980: 7773 2074 6f20 0d0a 0909 0909 6769 7665  ws to ......give
-0004e990: 2065 6163 6820 6d75 6c74 695c 5f70 726f   each multi\_pro
-0004e9a0: 6a65 6374 2061 2073 7065 6369 6669 6320  ject a specific 
-0004e9b0: 7765 6967 6874 2028 6e75 6d62 6572 2920  weight (number) 
-0004e9c0: 7468 6174 2069 7320 6d75 6c74 6970 6c69  that is multipli
-0004e9d0: 6564 2074 6f20 7468 6520 6572 726f 722e  ed to the error.
-0004e9e0: 200d 0a09 0909 0949 6620 7468 6520 7765   ......If the we
-0004e9f0: 6967 6874 206f 626a 6563 7420 6861 7320  ight object has 
-0004ea00: 7468 6520 7361 6d65 206e 756d 6265 7220  the same number 
-0004ea10: 6f66 2069 7465 6d73 2061 7320 7468 6520  of items as the 
-0004ea20: 276d 756c 7469 5f70 726f 6a65 6374 2720  'multi_project' 
-0004ea30: 6974 2069 7320 6173 7375 6d65 6420 0d0a  it is assumed ..
-0004ea40: 0909 0909 7468 6174 2074 6120 2874 6865  ....that ta (the
-0004ea50: 2065 6d62 6564 6465 6420 7072 6f6a 6563   embedded projec
-0004ea60: 7429 2068 6173 2074 6865 2077 6569 6768  t) has the weigh
-0004ea70: 7420 6f66 2031 2c20 6f74 6865 7277 6973  t of 1, otherwis
-0004ea80: 6520 7468 6520 6669 7273 7420 7765 6967  e the first weig
-0004ea90: 6874 2069 7320 666f 7220 7468 6520 0d0a  ht is for the ..
-0004eaa0: 0909 0909 656d 6265 6464 6564 206f 626a  ....embedded obj
-0004eab0: 6563 740d 0a09 0909 090d 0a09 0909 6578  ect...........ex
-0004eac0: 745f 7370 6563 7472 6120 3a20 4461 7461  t_spectra : Data
-0004ead0: 4672 616d 652c 206f 7074 696f 6e61 6c0d  Frame, optional.
-0004eae0: 0a09 0909 0928 4465 6661 756c 7429 2069  .....(Default) i
-0004eaf0: 7320 4e6f 6e65 2c20 6966 2067 6976 656e  s None, if given
-0004eb00: 2073 7562 7374 7261 6374 2074 6869 7320   substract this 
-0004eb10: 7370 6563 7472 6120 6672 6f6d 2074 6865  spectra from the
-0004eb20: 2044 6174 614d 6174 7269 7820 7573 696e   DataMatrix usin
-0004eb30: 6720 7468 6520 696e 7465 6e73 6974 7920  g the intensity 
-0004eb40: 0d0a 0909 0909 6769 7665 6e20 696e 2022  ......given in "
-0004eb50: 4328 7429 2220 7468 6973 2066 756e 6374  C(t)" this funct
-0004eb60: 696f 6e20 7769 6c6c 206f 6e6c 7920 776f  ion will only wo
-0004eb70: 726b 2066 6f72 2065 7874 6572 6e61 6c20  rk for external 
-0004eb80: 6d6f 6465 6c73 2e20 5468 6520 6e61 6d65  models. The name
-0004eb90: 206f 6620 7468 6520 7370 6563 7472 616c   of the spectral
-0004eba0: 2063 6f6c 756d 6e20 0d0a 0909 0909 6d75   column ......mu
-0004ebb0: 7374 2062 6520 7361 6d65 2061 7320 7468  st be same as th
-0004ebc0: 6520 6e61 6d65 206f 6620 7468 6520 636f  e name of the co
-0004ebd0: 6c75 6d6e 2075 7365 642e 2049 6620 6e6f  lumn used. If no
-0004ebe0: 7420 7468 6520 7370 6563 7472 756d 2077  t the spectrum w
-0004ebf0: 696c 6c20 6265 2069 676e 6f72 6564 2e20  ill be ignored. 
-0004ec00: 5468 6520 7370 6563 7472 756d 2077 696c  The spectrum wil
-0004ec10: 6c20 0d0a 0909 0909 6265 2069 6e74 6572  l ......be inter
-0004ec20: 706f 6c61 7465 6420 746f 2074 6865 2073  polated to the s
-0004ec30: 7065 6374 7261 6c20 706f 696e 7473 206f  pectral points o
-0004ec40: 6620 7468 6520 6d6f 6465 6c20 6473 2062  f the model ds b
-0004ec50: 6566 6f72 6520 7468 6520 7375 6273 7472  efore the substr
-0004ec60: 6163 7469 6f6e 2e20 0d0a 0d0a 0909 5265  action. ......Re
-0004ec70: 7475 726e 730d 0a09 092d 2d2d 2d2d 2d2d  turns....-------
-0004ec80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a09 090d  -----------.....
-0004ec90: 0a09 0972 6520 3a20 6469 6374 0d0a 0909  ...re : dict....
-0004eca0: 0974 6865 2064 6963 7469 6f6e 6172 7920  .the dictionary 
-0004ecb0: 2272 6522 2061 7474 6163 6865 6420 746f  "re" attached to
-0004ecc0: 2074 6865 206f 626a 6563 7420 636f 6e74   the object cont
-0004ecd0: 6169 6e69 6e67 2061 6c6c 2074 6865 206d  aining all the m
-0004ece0: 6174 7269 7865 7320 616e 6420 7061 7261  atrixes and para
-0004ecf0: 6d65 7465 722e 200d 0a09 0909 5468 6520  meter. .....The 
-0004ed00: 7573 7561 6c20 6b65 7973 2061 7265 3a0d  usual keys are:.
-0004ed10: 0a09 0909 2241 2220 5368 6170 6564 206d  ...."A" Shaped m
-0004ed20: 6561 7375 7265 6420 4d61 7472 6978 0d0a  easured Matrix..
-0004ed30: 0909 0922 4143 2220 5368 6170 6564 2063  ..."AC" Shaped c
-0004ed40: 616c 6375 6c61 7465 6420 4d61 7472 6978  alculated Matrix
-0004ed50: 200d 0a09 0909 2241 4522 2044 6966 6665   ....."AE" Diffe
-0004ed60: 7265 6e63 6520 6265 7477 6565 6e20 4120  rence between A 
-0004ed70: 616e 6420 4143 203d 206c 696e 6561 7220  and AC = linear 
-0004ed80: 6572 726f 7220 0d0a 0909 0922 4441 5322  error ....."DAS"
-0004ed90: 2044 4153 206f 7220 5341 532c 206c 6162   DAS or SAS, lab
-0004eda0: 656c 6564 2061 6674 6572 2074 6865 206e  eled after the n
-0004edb0: 616d 6573 2067 6976 656e 2069 6e20 7468  ames given in th
-0004edc0: 6520 6675 6e63 7469 6f6e 2028 7468 6520  e function (the 
-0004edd0: 636f 6c75 6d6e 7320 6f66 2063 2920 4361  columns of c) Ca
-0004ede0: 7265 206d 7573 7420 6265 2074 616b 656e  re must be taken
-0004edf0: 2074 6861 7420 7468 6973 206d 6573 7572   that this mesur
-0004ee00: 6564 2069 6e74 656e 7369 7479 2069 7320  ed intensity is 
-0004ee10: 4320 2a20 4441 532c 2074 6865 2070 726f  C * DAS, the pro
-0004ee20: 6475 6374 2e20 466f 7220 6578 706f 6e65  duct. For expone
-0004ee30: 6e74 6961 6c20 6d6f 6465 6c20 7468 6520  ntial model the 
-0004ee40: 636f 6e63 656e 7472 6174 696f 6e73 2061  concentrations a
-0004ee50: 7265 206e 6f72 6d61 6c69 7a65 640d 0a09  re normalized...
-0004ee60: 0909 2263 2220 5468 6520 436f 6e63 656e  .."c" The Concen
-0004ee70: 7472 6174 696f 6e73 2028 6d65 616e 696e  trations (meanin
-0004ee80: 6720 7468 6520 6576 6f6c 7574 696f 6e20  g the evolution 
-0004ee90: 6f66 2074 6865 2063 6f6e 6365 6e74 7261  of the concentra
-0004eea0: 7469 6f6e 7320 6f76 6572 2074 696d 652e  tions over time.
-0004eeb0: 2043 6172 6520 6d75 7374 2062 6520 7461   Care must be ta
-0004eec0: 6b65 6e20 7468 6174 2074 6869 7320 6d65  ken that this me
-0004eed0: 7375 7265 6420 696e 7465 6e73 6974 7920  sured intensity 
-0004eee0: 6973 2043 202a 2044 4153 2c20 7468 6520  is C * DAS, the 
-0004eef0: 7072 6f64 7563 742e 2046 6f72 2065 7870  product. For exp
-0004ef00: 6f6e 656e 7469 616c 206d 6f64 656c 2074  onential model t
-0004ef10: 6865 2063 6f6e 6365 6e74 7261 7469 6f6e  he concentration
-0004ef20: 7320 6172 6520 6e6f 726d 616c 697a 6564  s are normalized
-0004ef30: 0d0a 0909 0922 6669 745f 7265 7375 6c74  ....."fit_result
-0004ef40: 735f 7261 7465 7322 2044 6174 6146 7261  s_rates" DataFra
-0004ef50: 6d65 2077 6974 6820 7468 6520 6669 7474  me with the fitt
-0004ef60: 6564 2072 6174 6573 2028 616e 6420 7468  ed rates (and th
-0004ef70: 6520 636f 6e66 6964 656e 6365 2069 6e74  e confidence int
-0004ef80: 6572 7661 6c73 2069 6620 6361 6c63 756c  ervals if calcul
-0004ef90: 6174 6564 290d 0a09 0909 2266 6974 5f72  ated)....."fit_r
-0004efa0: 6573 756c 7473 5f74 696d 6573 2220 4461  esults_times" Da
-0004efb0: 7461 4672 616d 6520 7769 7468 2074 6865  taFrame with the
-0004efc0: 2066 6974 7465 6420 6465 6361 7920 7469   fitted decay ti
-0004efd0: 6d65 7320 2861 6e64 2074 6865 2063 6f6e  mes (and the con
-0004efe0: 6669 6465 6e63 6520 696e 7465 7276 616c  fidence interval
-0004eff0: 7320 6966 2063 616c 6375 6c61 7465 6429  s if calculated)
-0004f000: 0d0a 0909 0922 6669 745f 6f75 7470 7574  ....."fit_output
-0004f010: 2220 5468 6520 4669 7420 6f62 6a65 6374  " The Fit object
-0004f020: 2061 7320 7265 7475 726e 6564 2066 726f   as returned fro
-0004f030: 6d20 6c6d 6669 742e 2028 5468 6973 2069  m lmfit. (This i
-0004f040: 7320 6e6f 7420 7361 7665 6420 7769 7468  s not saved with
-0004f050: 2074 6865 2070 726f 6a65 6374 2129 0d0a   the project!)..
-0004f060: 0909 0922 6572 726f 7222 2069 7320 7468  ..."error" is th
-0004f070: 6520 5332 2c20 6d65 616e 696e 6720 4145  e S2, meaning AE
-0004f080: 2a2a 322e 7375 6d28 292e 7375 6d28 290d  **2.sum().sum().
-0004f090: 0a09 0909 2272 3222 3d31 2d22 6572 726f  ...."r2"=1-"erro
-0004f0a0: 7222 2f28 2827 4127 2d27 4127 2e6d 6561  r"/(('A'-'A'.mea
-0004f0b0: 6e28 2929 2a2a 3229 2e73 756d 2829 2c20  n())**2).sum(), 
-0004f0c0: 736f 2074 6865 2072 6573 6964 7561 6c73  so the residuals
-0004f0d0: 2073 6361 6c65 6420 7769 7468 2074 6865   scaled with the
-0004f0e0: 2073 6967 6e61 6c20 7369 7a65 0d0a 0909   signal size....
-0004f0f0: 0d0a 0909 7061 725f 6669 7420 3a20 6c6d  ....par_fit : lm
-0004f100: 6669 7420 7061 7261 6d65 7465 7220 6f62  fit parameter ob
-0004f110: 6a65 6374 0d0a 0909 0969 7320 7772 6974  ject.....is writ
-0004f120: 7465 6e20 696e 746f 2074 6865 206f 626a  ten into the obj
-0004f130: 6563 7420 6173 2061 206c 6d66 6974 2070  ect as a lmfit p
-0004f140: 6172 616d 6574 6572 206f 626a 6563 7420  arameter object 
-0004f150: 7769 7468 2074 6865 206f 7074 696d 697a  with the optimiz
-0004f160: 6564 2072 6573 756c 7473 2028 7468 6174  ed results (that
-0004f170: 2063 616e 2062 6520 7573 6520 6675 7274   can be use furt
-0004f180: 6865 7229 0d0a 0909 0d0a 0909 6669 7463  her)........fitc
-0004f190: 6f65 6666 203a 206c 6973 742c 2069 6620  oeff : list, if 
-0004f1a0: 6368 6972 7066 6974 2069 7320 646f 6e65  chirpfit is done
-0004f1b0: 0d0a 0909 0954 6865 2063 6869 7270 2070  .....The chirp p
-0004f1c0: 6172 616d 6574 6572 2061 7265 2075 7064  arameter are upd
-0004f1d0: 6174 6564 0d0a 0909 0d0a 0909 6473 203a  ated........ds :
-0004f1e0: 2044 6174 6146 7261 6d65 2c20 6966 2063   DataFrame, if c
-0004f1f0: 6869 7270 6669 7420 6973 2064 6f6e 650d  hirpfit is done.
-0004f200: 0a09 0909 4120 6e65 7720 6473 2069 7320  ....A new ds is 
-0004f210: 6361 6c63 756c 6174 6564 2066 6f72 6d20  calculated form 
-0004f220: 6473 5f6f 7269 2069 6620 4368 7269 7046  ds_ori if ChripF
-0004f230: 6974 2069 7320 646f 6e65 0d0a 0909 090d  it is done......
-0004f240: 0a09 0954 6865 2072 6573 7420 6973 206d  ...The rest is m
-0004f250: 6169 6e6c 7920 7072 696e 7465 6420 6f6e  ainly printed on
-0004f260: 2073 6372 6565 6e2e 0d0a 0909 0d0a 0909   screen.........
-0004f270: 0d0a 0909 4578 616d 706c 6573 0d0a 0909  ....Examples....
-0004f280: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0004f290: 2d2d 2d2d 0d0a 0909 0d0a 0909 4e6f 6e20  ----........Non 
-0004f2a0: 6f70 7469 6f6e 616c 3a0d 0a09 090d 0a09  optional:.......
-0004f2b0: 093e 3e3e 2074 613d 7066 2e54 4128 2774  .>>> ta=pf.TA('t
-0004f2c0: 6573 7466 696c 652e 5349 4127 2920 236c  estfile.SIA') #l
-0004f2d0: 6f61 6420 6461 7461 0d0a 2009 093e 3e3e  oad data.. ..>>>
-0004f2e0: 2074 612e 6d6f 643d 2765 7870 6f6e 656e   ta.mod='exponen
-0004f2f0: 7469 616c 2720 2020 2023 6465 6669 6e65  tial'    #define
-0004f300: 206d 6f64 656c 0d0a 0909 3e3e 3e20 7461   model....>>> ta
-0004f310: 2e70 6172 3d6c 6d66 6974 2e50 6172 616d  .par=lmfit.Param
-0004f320: 6574 6572 7328 2920 2023 6372 6561 7465  eters()  #create
-0004f330: 2065 6d70 7479 2070 6172 616d 6574 6572   empty parameter
-0004f340: 206f 626a 6563 740d 0a09 093e 3e3e 2074   object....>>> t
-0004f350: 612e 7061 722e 6164 6428 276b 3027 2c76  a.par.add('k0',v
-0004f360: 616c 7565 3d31 2f30 2e31 2c76 6172 793d  alue=1/0.1,vary=
-0004f370: 5472 7565 2920 2361 6464 2061 7420 6c65  True) #add at le
-0004f380: 6173 7420 6f6e 6520 7061 7261 6d65 7465  ast one paramete
-0004f390: 7220 746f 206f 7074 696d 697a 650d 0a09  r to optimize...
-0004f3a0: 0920 200d 0a09 0954 7269 6767 6572 2073  .  ....Trigger s
-0004f3b0: 696d 706c 6520 6669 743a 0d0a 0909 0d0a  imple fit:......
-0004f3c0: 0909 3e3e 3e20 7461 2e46 6974 5f47 6c6f  ..>>> ta.Fit_Glo
-0004f3d0: 6261 6c28 290d 0a09 090d 0a09 0954 7269  bal()........Tri
-0004f3e0: 6767 6572 2066 6974 2077 6974 6820 4368  gger fit with Ch
-0004f3f0: 7269 7020 4669 743a 0d0a 0909 0d0a 0909  rip Fit:........
-0004f400: 3e3e 3e20 7461 2e46 6974 5f47 6c6f 6261  >>> ta.Fit_Globa
-0004f410: 6c28 6669 745f 6368 6972 703d 5472 7565  l(fit_chirp=True
-0004f420: 290d 0a09 090d 0a09 0954 7269 6767 6572  )........Trigger
-0004f430: 2069 7465 7261 7469 7665 2043 6869 7270   iterative Chirp
-0004f440: 2066 6974 7469 6e67 2077 6974 6820 6672   fitting with fr
-0004f450: 6573 6820 7265 6669 6e65 6d65 6e74 206f  esh refinement o
-0004f460: 6620 7468 6520 476c 6f62 616c 206b 696e  f the Global kin
-0004f470: 6574 6963 2070 6172 616d 6574 6572 7366  etic parametersf
-0004f480: 6f72 2069 2069 6e20 7261 6e67 6528 3529  or i in range(5)
-0004f490: 3a0d 0a09 090d 0a09 093e 3e3e 2066 6f72  :........>>> for
-0004f4a0: 2069 2069 6e20 7261 6e67 6528 3529 3a0d   i in range(5):.
-0004f4b0: 0a09 093e 3e3e 2009 7374 6172 745f 6572  ...>>> .start_er
-0004f4c0: 726f 723d 7461 2e72 655b 2765 7272 6f72  ror=ta.re['error
-0004f4d0: 275d 0d0a 0909 3e3e 3e20 0974 612e 7061  ']....>>> .ta.pa
-0004f4e0: 723d 7461 2e70 6172 5f66 6974 0d0a 0909  r=ta.par_fit....
-0004f4f0: 3e3e 3e20 0974 612e 4669 745f 476c 6f62  >>> .ta.Fit_Glob
-0004f500: 616c 2866 6974 5f63 6869 7270 3d54 7275  al(fit_chirp=Tru
-0004f510: 6529 0d0a 0909 3e3e 3e20 0969 6620 6e6f  e)....>>> .if no
-0004f520: 7420 7461 2e72 655b 2765 7272 6f72 275d  t ta.re['error']
-0004f530: 203c 2073 7461 7274 5f65 7272 6f72 3a62   < start_error:b
-0004f540: 7265 616b 0d0a 0909 0d0a 0909 5472 6967  reak........Trig
-0004f550: 6765 7220 6669 7420 6669 7420 6572 726f  ger fit fit erro
-0004f560: 7220 6361 6c63 756c 6174 696f 6e73 0d0a  r calculations..
-0004f570: 0909 0d0a 0909 3e3e 3e20 7461 2e46 6974  ......>>> ta.Fit
-0004f580: 5f47 6c6f 6261 6c28 636f 6e66 6964 656e  _Global(confiden
-0004f590: 6365 5f6c 6576 656c 3d30 2e36 3629 0d0a  ce_level=0.66)..
-0004f5a0: 0909 0d0a 0909 5472 6967 6765 7220 6669  ......Trigger fi
-0004f5b0: 7420 6f66 206d 756c 7469 706c 6520 7072  t of multiple pr
-0004f5c0: 6f6a 6563 7473 0d0a 0909 2375 7365 2074  ojects....#use t
-0004f5d0: 6865 2047 5549 5f6f 7065 6e20 6675 6e63  he GUI_open func
-0004f5e0: 7469 6f6e 2074 6f20 6f70 656e 2061 206c  tion to open a l
-0004f5f0: 6973 7420 6f66 206f 626a 6563 7473 2028  ist of objects (
-0004f600: 6c65 6176 6520 656d 7074 7920 666f 7220  leave empty for 
-0004f610: 7573 696e 6720 7468 6520 4755 4929 0d0a  using the GUI)..
-0004f620: 0909 0d0a 0909 3e3e 3e20 6f74 6865 725f  ......>>> other_
-0004f630: 7072 6f6a 6563 7473 3d70 662e 4755 495f  projects=pf.GUI_
-0004f640: 6f70 656e 285b 2773 616d 706c 655f 312e  open(['sample_1.
-0004f650: 6864 6635 272c 2773 616d 706c 655f 322e  hdf5','sample_2.
-0004f660: 6864 6635 275d 2c70 6174 683d 2744 6174  hdf5'],path='Dat
-0004f670: 6127 290d 0a09 093e 3e3e 2074 612e 4669  a')....>>> ta.Fi
-0004f680: 745f 476c 6f62 616c 286d 756c 7469 5f70  t_Global(multi_p
-0004f690: 726f 6a65 6374 3d6f 7468 6572 5f70 726f  roject=other_pro
-0004f6a0: 6a65 6374 7329 0d0a 0909 0d0a 0909 0d0a  jects)..........
-0004f6b0: 0909 466f 7220 6d6f 7265 2065 7861 6d70  ..For more examp
-0004f6c0: 6c65 7320 706c 6561 7365 2073 6565 2074  les please see t
-0004f6d0: 6865 2063 6f6d 706c 6574 6520 646f 6375  he complete docu
-0004f6e0: 6d65 6e74 6174 696f 6e20 756e 6465 7220  mentation under 
-0004f6f0: 3a72 6566 3a60 4669 7474 696e 672c 2050  :ref:`Fitting, P
-0004f700: 6172 616d 6574 6572 206f 7074 696d 697a  arameter optimiz
-0004f710: 6174 696f 6e20 616e 6420 4572 726f 7220  ation and Error 
-0004f720: 6573 7469 6d61 7469 6f6e 600d 0a09 096f  estimation`....o
-0004f730: 7220 3a72 6566 3a60 4669 7474 696e 6720  r :ref:`Fitting 
-0004f740: 6d75 6c74 6970 6c65 206d 6561 7375 7265  multiple measure
-0004f750: 6420 6669 6c65 7320 6174 206f 6e63 6560  d files at once`
-0004f760: 0d0a 0909 2222 220d 0a0d 0a09 0969 6620  ...."""......if 
-0004f770: 7061 7220 6973 204e 6f6e 653a 7061 723d  par is None:par=
-0004f780: 7365 6c66 2e70 6172 0d0a 0909 6966 206d  self.par....if m
-0004f790: 6f64 2069 7320 4e6f 6e65 3a6d 6f64 3d73  od is None:mod=s
-0004f7a0: 656c 662e 6d6f 640d 0a09 0974 7279 3a0d  elf.mod....try:.
-0004f7b0: 0a09 0909 7430 3d70 6172 5b27 7430 275d  ....t0=par['t0']
-0004f7c0: 0d0a 0909 6578 6365 7074 3a0d 0a09 0909  ....except:.....
-0004f7d0: 7472 793a 0d0a 0909 0909 7061 722e 6164  try:......par.ad
-0004f7e0: 6428 2774 3027 2c76 616c 7565 3d30 2c6d  d('t0',value=0,m
-0004f7f0: 696e 3d2d 302e 352c 6d61 783d 302e 352c  in=-0.5,max=0.5,
-0004f800: 7661 7279 3d46 616c 7365 290d 0a09 0909  vary=False).....
-0004f810: 6578 6365 7074 3a0d 0a09 0909 0970 7269  except:......pri
-0004f820: 6e74 2822 556e 6578 7065 6374 6564 2065  nt("Unexpected e
-0004f830: 7272 6f72 3a22 2c20 7379 732e 6578 635f  rror:", sys.exc_
-0004f840: 696e 666f 2829 5b30 5d29 0d0a 0909 7472  info()[0])....tr
-0004f850: 793a 0d0a 0909 0972 6573 6f6c 7574 696f  y:.....resolutio
-0004f860: 6e3d 7061 725b 2772 6573 6f6c 7574 696f  n=par['resolutio
-0004f870: 6e27 5d0d 0a09 0965 7863 6570 743a 0d0a  n']....except:..
-0004f880: 0909 0974 7279 3a0d 0a09 0909 0970 6172  ...try:......par
-0004f890: 2e61 6464 2827 7265 736f 6c75 7469 6f6e  .add('resolution
-0004f8a0: 272c 7661 6c75 653d 302e 3038 362c 6d69  ',value=0.086,mi
-0004f8b0: 6e3d 302e 3034 2c6d 6178 3d30 2e35 2c76  n=0.04,max=0.5,v
-0004f8c0: 6172 793d 4661 6c73 6529 0d0a 0909 0965  ary=False).....e
-0004f8d0: 7863 6570 743a 0d0a 0909 0909 7072 696e  xcept:......prin
-0004f8e0: 7428 2255 6e65 7870 6563 7465 6420 6572  t("Unexpected er
-0004f8f0: 726f 723a 222c 2073 7973 2e65 7863 5f69  ror:", sys.exc_i
-0004f900: 6e66 6f28 295b 305d 290d 0a09 0974 7279  nfo()[0])....try
-0004f910: 3a0d 0a09 0909 7061 725b 2769 6e66 696e  :.....par['infin
-0004f920: 6974 6527 5d2e 7661 6c75 653d 310d 0a09  ite'].value=1...
-0004f930: 0909 7061 725b 2769 6e66 696e 6974 6527  ..par['infinite'
-0004f940: 5d2e 7661 7279 3d46 616c 7365 0d0a 0909  ].vary=False....
-0004f950: 6578 6365 7074 3a0d 0a09 0909 7061 7373  except:.....pass
-0004f960: 0d0a 0909 7472 793a 0d0a 0909 0970 6172  ....try:.....par
-0004f970: 5b27 6261 636b 6772 6f75 6e64 275d 2e76  ['background'].v
-0004f980: 616c 7565 3d31 0d0a 0909 0970 6172 5b27  alue=1.....par['
-0004f990: 6261 636b 6772 6f75 6e64 275d 2e76 6172  background'].var
-0004f9a0: 793d 4661 6c73 650d 0a09 0965 7863 6570  y=False....excep
-0004f9b0: 743a 0d0a 0909 0970 6173 730d 0a09 0974  t:.....pass....t
-0004f9c0: 7279 3a20 2320 7468 6973 2069 7320 6569  ry: # this is ei
-0004f9d0: 7468 6572 2066 7265 657a 696e 6720 6f72  ther freezing or
-0004f9e0: 2065 6e61 626c 696e 6720 7468 6520 7265   enabling the re
-0004f9f0: 2d6f 7074 696d 697a 6174 696f 6e20 6f66  -optimization of
-0004fa00: 2061 6c6c 206f 7468 6572 2070 6172 616d   all other param
-0004fa10: 6574 6572 2064 7572 696e 6720 636f 6e66  eter during conf
-0004fa20: 6964 656e 6365 2069 6e74 6572 7661 6c20  idence interval 
-0004fa30: 6361 6c63 756c 6174 696f 6e0d 0a09 0909  calculation.....
-0004fa40: 7061 725b 2765 7272 6f72 5f70 6172 616d  par['error_param
-0004fa50: 5f66 6978 275d 2e76 616c 7565 3d31 0d0a  _fix'].value=1..
-0004fa60: 0909 0970 6172 5b27 6572 726f 725f 7061  ...par['error_pa
-0004fa70: 7261 6d5f 6669 7827 5d2e 7661 7279 3d46  ram_fix'].vary=F
-0004fa80: 616c 7365 0d0a 0909 0976 6172 795f 6572  alse.....vary_er
-0004fa90: 726f 725f 7061 7261 6d65 7465 723d 4661  ror_parameter=Fa
-0004faa0: 6c73 650d 0a09 0965 7863 6570 743a 0d0a  lse....except:..
-0004fab0: 0909 0976 6172 795f 6572 726f 725f 7061  ...vary_error_pa
-0004fac0: 7261 6d65 7465 723d 5472 7565 0d0a 0909  rameter=True....
-0004fad0: 0d0a 0909 7061 7264 663d 7061 725f 746f  ....pardf=par_to
-0004fae0: 5f70 6172 6466 2870 6172 290d 0a09 0970  _pardf(par)....p
-0004faf0: 6172 6466 2e6c 6f63 5b6e 702e 6c6f 6769  ardf.loc[np.logi
-0004fb00: 6361 6c5f 616e 6428 7061 7264 662e 6c6f  cal_and(pardf.lo
-0004fb10: 635b 3a2c 276d 696e 275d 2e76 616c 7565  c[:,'min'].value
-0004fb20: 733c 302c 7061 7264 662e 6973 5f72 6174  s<0,pardf.is_rat
-0004fb30: 6529 2c27 6d69 6e27 5d3d 300d 0a09 0970  e),'min']=0....p
-0004fb40: 6172 6466 2e6c 6f63 5b6e 702e 6c6f 6769  ardf.loc[np.logi
-0004fb50: 6361 6c5f 616e 6428 7061 7264 662e 6c6f  cal_and(pardf.lo
-0004fb60: 635b 3a2c 276d 6178 275d 2e76 616c 7565  c[:,'max'].value
-0004fb70: 733c 302c 7061 7264 662e 6973 5f72 6174  s<0,pardf.is_rat
-0004fb80: 6529 2c27 6d61 7827 5d3d 300d 0a0d 0a09  e),'max']=0.....
-0004fb90: 0970 6172 6466 5b27 696e 6974 5f76 616c  .pardf['init_val
-0004fba0: 7565 275d 3d70 6172 6466 5b27 7661 6c75  ue']=pardf['valu
-0004fbb0: 6527 5d0d 0a09 0969 6620 6475 6d70 5f70  e']....if dump_p
-0004fbc0: 6172 6173 3a0d 0a09 0909 7061 7264 665f  aras:.....pardf_
-0004fbd0: 7465 6d70 3d70 6172 6466 2e63 6f70 7928  temp=pardf.copy(
-0004fbe0: 290d 0a09 0909 7061 7264 665f 7465 6d70  ).....pardf_temp
-0004fbf0: 2e6c 6f63 5b27 6572 726f 7227 2c27 7661  .loc['error','va
-0004fc00: 6c75 6527 5d3d 3130 3030 0d0a 0909 0970  lue']=1000.....p
-0004fc10: 6172 6466 5f74 656d 702e 746f 5f63 7376  ardf_temp.to_csv
-0004fc20: 2827 6d69 6e69 6d61 6c5f 6475 6d70 5f70  ('minimal_dump_p
-0004fc30: 6172 6173 2e70 6172 2729 0d0a 090d 0a09  aras.par')......
-0004fc40: 0969 6620 7365 6c66 2e6c 6f67 5f66 6974  .if self.log_fit
-0004fc50: 3a0d 0a09 0909 666f 7220 6b65 7920 696e  :.....for key in
-0004fc60: 205b 2776 616c 7565 272c 276d 696e 272c   ['value','min',
-0004fc70: 276d 6178 275d 3a0d 0a09 0909 0970 6172  'max']:......par
-0004fc80: 6466 2e6c 6f63 5b70 6172 6466 2e69 735f  df.loc[pardf.is_
-0004fc90: 7261 7465 2c6b 6579 5d3d 7061 7264 662e  rate,key]=pardf.
-0004fca0: 6c6f 635b 7061 7264 662e 6973 5f72 6174  loc[pardf.is_rat
-0004fcb0: 652c 6b65 795d 2e61 7070 6c79 286c 616d  e,key].apply(lam
-0004fcc0: 6264 6120 783a 206e 702e 6c6f 6731 3028  bda x: np.log10(
-0004fcd0: 7829 2909 0d0a 0909 0d0a 0909 2363 7265  x)).........#cre
-0004fce0: 6174 652d 7368 6170 6520 7468 6520 6461  ate-shape the da
-0004fcf0: 7461 2074 6f20 6265 2066 6974 7465 6409  ta to be fitted.
-0004fd00: 0d0a 0909 6669 745f 6473 203d 2073 7562  ....fit_ds = sub
-0004fd10: 5f64 7328 6473 203d 2073 656c 662e 6473  _ds(ds = self.ds
-0004fd20: 2e63 6f70 7928 292c 2073 6361 7474 6572  .copy(), scatter
-0004fd30: 6375 7420 3d20 7365 6c66 2e73 6361 7474  cut = self.scatt
-0004fd40: 6572 6375 742c 2062 6f72 6465 7263 7574  ercut, bordercut
-0004fd50: 203d 2073 656c 662e 626f 7264 6572 6375   = self.bordercu
-0004fd60: 742c 200d 0a09 0909 0909 0974 696d 656c  t, ........timel
-0004fd70: 696d 6974 7320 3d20 7365 6c66 2e74 696d  imits = self.tim
-0004fd80: 656c 696d 6974 732c 2077 6176 655f 6e6d  elimits, wave_nm
-0004fd90: 5f62 696e 203d 2073 656c 662e 7761 7665  _bin = self.wave
-0004fda0: 5f6e 6d5f 6269 6e2c 2065 7175 616c 5f65  _nm_bin, equal_e
-0004fdb0: 6e65 7267 795f 6269 6e20 3d20 7365 6c66  nergy_bin = self
-0004fdc0: 2e65 7175 616c 5f65 6e65 7267 795f 6269  .equal_energy_bi
-0004fdd0: 6e2c 200d 0a09 0909 0909 0974 696d 655f  n, ........time_
-0004fde0: 6269 6e20 3d20 7365 6c66 2e74 696d 655f  bin = self.time_
-0004fdf0: 6269 6e2c 2069 676e 6f72 655f 7469 6d65  bin, ignore_time
-0004fe00: 5f72 6567 696f 6e20 3d20 7365 6c66 2e69  _region = self.i
-0004fe10: 676e 6f72 655f 7469 6d65 5f72 6567 696f  gnore_time_regio
-0004fe20: 6e2c 2064 726f 705f 7363 6174 7465 7220  n, drop_scatter 
-0004fe30: 3d20 5472 7565 2c20 6472 6f70 5f69 676e  = True, drop_ign
-0004fe40: 6f72 6520 3d20 5472 7565 290d 0a09 0974  ore = True)....t
-0004fe50: 696d 655f 6c61 6265 6c3d 6669 745f 6473  ime_label=fit_ds
-0004fe60: 2e69 6e64 6578 2e6e 616d 650d 0a09 0965  .index.name....e
-0004fe70: 6e65 7267 795f 6c61 6265 6c3d 6669 745f  nergy_label=fit_
-0004fe80: 6473 2e63 6f6c 756d 6e73 2e6e 616d 650d  ds.columns.name.
-0004fe90: 0a09 090d 0a09 0923 2323 2323 2323 2323  .......#########
-0004fea0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004feb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004fec0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004c270: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004c280: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004c290: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004c2a0: 2323 0d0a 0909 0d0a 0909 6966 2069 6e69  ##........if ini
+0004c2b0: 7469 616c 5f65 7272 6f72 5b2d 315d 3c69  tial_error[-1]<i
+0004c2c0: 6e69 7469 616c 5f65 7272 6f72 5b30 5d3a  nitial_error[0]:
+0004c2d0: 236c 6574 7320 6368 6563 6b20 6966 2077  #lets check if w
+0004c2e0: 6520 696d 7072 6f76 6564 2061 6e79 7468  e improved anyth
+0004c2f0: 696e 670d 0a09 0909 7072 696e 7428 2763  ing.....print('c
+0004c300: 6869 7270 2066 6974 2069 6d70 726f 7665  hirp fit improve
+0004c310: 6420 6572 726f 7220 6279 2025 2e32 6720  d error by %.2g 
+0004c320: 7065 7263 656e 7427 2528 3130 302a 2831  percent'%(100*(1
+0004c330: 2d69 6e69 7469 616c 5f65 7272 6f72 5b2d  -initial_error[-
+0004c340: 315d 2f69 6e69 7469 616c 5f65 7272 6f72  1]/initial_error
+0004c350: 5b30 5d29 2929 0d0a 0909 0969 6620 6973  [0]))).....if is
+0004c360: 696e 7374 616e 6365 2874 656d 702c 206c  instance(temp, l
+0004c370: 6973 7429 206f 7220 6973 696e 7374 616e  ist) or isinstan
+0004c380: 6365 2874 656d 702c 2074 7970 6528 6e70  ce(temp, type(np
+0004c390: 2e61 7261 6e67 6528 3129 2929 3a0d 0a09  .arange(1))):...
+0004c3a0: 0909 0973 656c 662e 6669 7463 6f65 6666  ...self.fitcoeff
+0004c3b0: 203d 2074 656d 700d 0a09 0909 656c 7365   = temp.....else
+0004c3c0: 3a0d 0a09 0909 0972 6169 7365 0d0a 0909  :......raise....
+0004c3d0: 0974 696d 6520 3d20 6473 5f62 6163 6b5f  .time = ds_back_
+0004c3e0: 636f 7272 2e69 6e64 6578 2e76 616c 7565  corr.index.value
+0004c3f0: 732e 6173 7479 7065 2827 666c 6f61 7427  s.astype('float'
+0004c400: 2923 6578 7472 6163 7420 7468 6520 7469  )#extract the ti
+0004c410: 6d65 0d0a 0909 0973 656c 662e 6473 203d  me.....self.ds =
+0004c420: 2064 735f 6261 636b 5f63 6f72 722e 6170   ds_back_corr.ap
+0004c430: 706c 7928 6c61 6d62 6461 2078 3a6e 702e  ply(lambda x:np.
+0004c440: 696e 7465 7270 2878 203d 2074 696d 652b  interp(x = time+
+0004c450: 6e70 2e70 6f6c 7976 616c 2874 656d 702c  np.polyval(temp,
+0004c460: 2066 6c6f 6174 2878 2e6e 616d 6529 292c   float(x.name)),
+0004c470: 2078 7020 3d20 7469 6d65 2c20 6670 203d   xp = time, fp =
+0004c480: 2078 292c 2061 7869 7320 3d20 302c 2072   x), axis = 0, r
+0004c490: 6177 203d 2046 616c 7365 2909 0909 200d  aw = False)... .
+0004c4a0: 0a09 0909 6669 745f 6473 203d 2073 7562  ....fit_ds = sub
+0004c4b0: 5f64 7328 6473 203d 2073 656c 662e 6473  _ds(ds = self.ds
+0004c4c0: 2c20 7363 6174 7465 7263 7574 203d 2073  , scattercut = s
+0004c4d0: 656c 662e 7363 6174 7465 7263 7574 2c20  elf.scattercut, 
+0004c4e0: 626f 7264 6572 6375 7420 3d20 7365 6c66  bordercut = self
+0004c4f0: 2e62 6f72 6465 7263 7574 2c20 7469 6d65  .bordercut, time
+0004c500: 6c69 6d69 7473 203d 2073 656c 662e 7469  limits = self.ti
+0004c510: 6d65 6c69 6d69 7473 2c20 7761 7665 5f6e  melimits, wave_n
+0004c520: 6d5f 6269 6e20 3d20 7365 6c66 2e77 6176  m_bin = self.wav
+0004c530: 655f 6e6d 5f62 696e 2c20 6571 7561 6c5f  e_nm_bin, equal_
+0004c540: 656e 6572 6779 5f62 696e 203d 2073 656c  energy_bin = sel
+0004c550: 662e 6571 7561 6c5f 656e 6572 6779 5f62  f.equal_energy_b
+0004c560: 696e 2c20 7469 6d65 5f62 696e 203d 2073  in, time_bin = s
+0004c570: 656c 662e 7469 6d65 5f62 696e 290d 0a09  elf.time_bin)...
+0004c580: 0909 6966 2070 6172 6466 2e76 6172 792e  ..if pardf.vary.
+0004c590: 616e 7928 293a 0d0a 0909 0909 7265 7375  any():......resu
+0004c5a0: 6c74 732e 7061 7261 6d73 203d 2072 6573  lts.params = res
+0004c5b0: 756c 7473 5f69 6e5f 6368 6972 702e 7061  ults_in_chirp.pa
+0004c5c0: 7261 6d73 0d0a 0909 7265 7475 726e 2072  rams....return r
+0004c5d0: 6573 756c 7473 2c20 6669 745f 6473 0d0a  esults, fit_ds..
+0004c5e0: 0909 0d0a 0909 0d0a 0964 6566 2046 6974  .........def Fit
+0004c5f0: 5f47 6c6f 6261 6c28 7365 6c66 2c20 7061  _Global(self, pa
+0004c600: 7220 3d20 4e6f 6e65 2c20 6d6f 6420 3d20  r = None, mod = 
+0004c610: 4e6f 6e65 2c20 636f 6e66 6964 656e 6365  None, confidence
+0004c620: 5f6c 6576 656c 203d 204e 6f6e 652c 2075  _level = None, u
+0004c630: 7365 5f61 6d70 676f 203d 2046 616c 7365  se_ampgo = False
+0004c640: 2c20 6669 745f 6368 6972 7020 3d20 4661  , fit_chirp = Fa
+0004c650: 6c73 652c 2066 6974 5f63 6869 7270 5f69  lse, fit_chirp_i
+0004c660: 7465 7261 7469 6f6e 7320 3d20 3130 2c20  terations = 10, 
+0004c670: 0d0a 0909 0909 096d 756c 7469 5f70 726f  .......multi_pro
+0004c680: 6a65 6374 203d 204e 6f6e 652c 2075 6e69  ject = None, uni
+0004c690: 7175 655f 7061 7261 6d65 7465 7220 3d20  que_parameter = 
+0004c6a0: 4e6f 6e65 2c20 7765 6967 6874 7320 3d20  None, weights = 
+0004c6b0: 4e6f 6e65 2c20 7361 6d65 5f44 4153 203d  None, same_DAS =
+0004c6c0: 2046 616c 7365 2c0d 0a09 0909 0909 6475   False,.......du
+0004c6d0: 6d70 5f70 6172 6173 203d 2046 616c 7365  mp_paras = False
+0004c6e0: 2c20 6475 6d70 5f73 6861 7065 7320 3d20  , dump_shapes = 
+0004c6f0: 4661 6c73 652c 2066 696c 656e 616d 6520  False, filename 
+0004c700: 3d20 4e6f 6e65 2c20 6578 745f 7370 6563  = None, ext_spec
+0004c710: 7472 6120 3d20 4e6f 6e65 293a 0d0a 0909  tra = None):....
+0004c720: 2222 2254 6869 7320 6675 6e63 7469 6f6e  """This function
+0004c730: 2069 7320 7065 7266 6f72 6d69 6e67 2061   is performing a
+0004c740: 2067 6c6f 6261 6c20 6669 7420 6f66 2074   global fit of t
+0004c750: 6865 2064 6174 612e 2041 7320 656d 6265  he data. As embe
+0004c760: 6464 6564 206f 626a 6563 7420 6974 2075  dded object it u
+0004c770: 7365 7320 0d0a 0909 7468 6520 7061 7261  ses ....the para
+0004c780: 6d65 7465 7220 636f 6e74 726f 6c20 6f70  meter control op
+0004c790: 7469 6f6e 7320 6f66 2074 6865 206c 6d66  tions of the lmf
+0004c7a0: 6974 2070 726f 6a65 6374 2061 7320 616e  it project as an
+0004c7b0: 2065 7373 656e 7469 616c 2074 6f6f 6c2e   essential tool.
+0004c7c0: 200d 0a09 0928 6d79 2074 6861 6e6b 7320   ....(my thanks 
+0004c7d0: 746f 204d 6174 7468 6577 204e 6577 7669  to Matthew Newvi
+0004c7e0: 6c6c 6520 616e 6420 636f 6c6c 6561 6775  lle and colleagu
+0004c7f0: 6573 2066 6f72 2063 7265 6174 696e 6720  es for creating 
+0004c800: 7468 6973 2070 6861 6e74 6173 7469 6320  this phantastic 
+0004c810: 746f 6f6c 2920 0d0a 0909 5b4d 2e20 4e65  tool) ....[M. Ne
+0004c820: 7776 696c 6c65 2c20 542e 2053 7465 6e73  wville, T. Stens
+0004c830: 6974 7a6b 692c 2044 2e20 422e 2041 6c6c  itzki, D. B. All
+0004c840: 656e 2c20 412e 2049 6e67 6172 6769 6f6c  en, A. Ingargiol
+0004c850: 612c 2032 3031 342e 2044 4f49 3a20 3130  a, 2014. DOI: 10
+0004c860: 2e35 3238 312f 5a45 4e4f 444f 2e31 3138  .5281/ZENODO.118
+0004c870: 3133 2e5d 2e20 0d0a 0909 5468 6520 7768  13.]. ....The wh
+0004c880: 6174 2074 7970 6520 6f66 2066 6974 7469  at type of fitti
+0004c890: 6e67 2069 7320 7065 7266 6f72 6d65 6420  ng is performed 
+0004c8a0: 6973 2063 6f6e 7472 6f6c 6c65 6420 6279  is controlled by
+0004c8b0: 2073 6574 7469 6e67 206f 6620 7468 6520   setting of the 
+0004c8c0: 7061 7261 6d65 7465 7220 6865 7265 2e0d  parameter here..
+0004c8d0: 0a09 090d 0a09 0954 6865 2067 656e 6572  .......The gener
+0004c8e0: 616c 2066 6974 7469 6e67 2066 6f6c 6c6f  al fitting follo
+0004c8f0: 7773 2074 6869 7320 726f 7574 696e 653a  ws this routine:
+0004c900: 0d0a 0909 0931 2e20 0963 7265 6174 6520  .....1. .create 
+0004c910: 6120 636f 7079 206f 6620 7468 6520 4461  a copy of the Da
+0004c920: 7461 2d4d 6174 7269 7820 7365 6c66 2e64  ta-Matrix self.d
+0004c930: 7320 6973 2063 7265 6174 6564 2077 6974  s is created wit
+0004c940: 6820 7468 6520 7368 6170 696e 6720 7061  h the shaping pa
+0004c950: 7261 6d65 7465 7273 0d0a 0909 0932 2e20  rameters.....2. 
+0004c960: 0954 6865 6e20 6120 4d61 7472 6978 2069  .Then a Matrix i
+0004c970: 7320 6372 6561 7465 6420 7468 6174 2072  s created that r
+0004c980: 6570 7265 7365 6e74 7320 7468 6520 6672  epresents the fr
+0004c990: 6163 7469 6f6e 616c 2070 6f70 756c 6174  actional populat
+0004c9a0: 696f 6e20 6f66 2065 6163 6820 7370 6563  ion of each spec
+0004c9b0: 6965 7320 0d0a 0909 0909 286f 7220 7072  ies ......(or pr
+0004c9c0: 6f63 6573 7365 7320 696e 2063 6173 6520  ocesses in case 
+0004c9d0: 6f66 2074 6865 2070 6172 616c 206d 6f64  of the paral mod
+0004c9e0: 656c 292e 200d 0a09 0909 0954 6869 7320  el). ......This 
+0004c9f0: 4d61 7472 6978 2063 6f6e 7461 696e 7320  Matrix contains 
+0004ca00: 6f6e 6520 656e 7472 7920 666f 7220 6561  one entry for ea
+0004ca10: 6368 2074 696d 6570 6f69 6e74 2061 6e64  ch timepoint and
+0004ca20: 2072 6570 7265 7365 6e74 7320 7468 6520   represents the 
+0004ca30: 6b69 6e65 7469 6320 6d6f 6465 6c20 0d0a  kinetic model ..
+0004ca40: 0909 0909 6261 7365 6420 7570 6f6e 2074  ....based upon t
+0004ca50: 6865 2073 7461 7274 696e 6720 7061 7261  he starting para
+0004ca60: 6d65 7465 722e 2028 7365 6520 6265 6c6f  meter. (see belo
+0004ca70: 7720 666f 7220 6120 6465 7363 7269 7074  w for a descript
+0004ca80: 696f 6e20 6f66 2074 6865 206d 6f64 656c  ion of the model
+0004ca90: 7329 2e20 0d0a 0909 0909 5468 6973 206d  s). ......This m
+0004caa0: 6f64 656c 2066 6f72 6d61 7469 6f6e 2063  odel formation c
+0004cab0: 616e 2062 7920 646f 6e65 2062 7920 7573  an by done by us
+0004cac0: 696e 6720 6120 6275 696c 6420 696e 206f  ing a build in o
+0004cad0: 7220 6120 7573 6572 2073 7570 706c 6965  r a user supplie
+0004cae0: 6420 6675 6e63 7469 6f6e 2e20 0d0a 0909  d function. ....
+0004caf0: 0909 2868 616e 646c 6564 2069 6e20 7468  ..(handled in th
+0004cb00: 6520 6675 6e63 7469 6f6e 2022 7066 2e62  e function "pf.b
+0004cb10: 7569 6c64 5f63 2229 0d0a 0909 0909 2d3e  uild_c")......->
+0004cb20: 2049 6620 616e 2065 7874 5f73 7065 6374   If an ext_spect
+0004cb30: 7261 2069 7320 7072 6f76 6964 6564 2074  ra is provided t
+0004cb40: 6869 7320 6974 7320 696e 7465 6e73 6974  his its intensit
+0004cb50: 7920 6973 2073 7562 7374 6163 7465 6420  y is substacted 
+0004cb60: 6672 6f6d 2074 6865 206d 6174 7269 7820  from the matrix 
+0004cb70: 286f 6e6c 7920 666f 7220 6578 7465 726e  (only for extern
+0004cb80: 616c 206d 6f64 656c 7329 0d0a 0909 0933  al models).....3
+0004cb90: 2e20 0954 6865 6e20 7468 6520 7072 6f63  . .Then the proc
+0004cba0: 6573 732f 7370 6563 6965 7320 6173 736f  ess/species asso
+0004cbb0: 6369 6174 6564 2073 7065 6374 7261 2066  ciated spectra f
+0004cbc0: 6f72 2065 6163 6820 6f66 2074 6865 2073  or each of the s
+0004cbd0: 7065 6369 6573 2069 7320 6361 6c63 756c  pecies is calcul
+0004cbe0: 6174 6564 200d 0a09 0909 0975 7369 6e67  ated ......using
+0004cbf0: 2074 6865 206c 696e 616c 672e 6c73 7473   the linalg.lsts
+0004cc00: 7120 616c 676f 7269 7468 6d20 6672 6f6d  q algorithm from
+0004cc10: 206e 756d 7079 200d 0a09 0909 0928 6874   numpy ......(ht
+0004cc20: 7470 733a 2f2f 6e75 6d70 792e 6f72 672f  tps://numpy.org/
+0004cc30: 646f 632f 7374 6162 6c65 2f72 6566 6572  doc/stable/refer
+0004cc40: 656e 6365 2f67 656e 6572 6174 6564 2f6e  ence/generated/n
+0004cc50: 756d 7079 2e6c 696e 616c 672e 6c73 7473  umpy.linalg.lsts
+0004cc60: 712e 6874 6d6c 290d 0a09 0909 342e 2009  q.html).....4. .
+0004cc70: 4672 6f6d 2074 6865 2063 6f6e 766f 6c75  From the convolu
+0004cc80: 7465 6420 6361 6c63 756c 6174 6564 2073  ted calculated s
+0004cc90: 7065 6369 6573 2063 6f6e 6365 6e74 7261  pecies concentra
+0004cca0: 7469 6f6e 7320 616e 6420 7370 6563 7472  tions and spectr
+0004ccb0: 6120 6120 6361 6c63 756c 6174 6564 206d  a a calculated m
+0004ccc0: 6174 7269 7820 0d0a 0909 0909 6973 2066  atrix ......is f
+0004ccd0: 6f72 6d65 6420 2868 616e 646c 6564 2069  ormed (handled i
+0004cce0: 6e20 7468 6520 6675 6e63 7469 6f6e 2022  n the function "
+0004ccf0: 7066 2e66 696c 6c5f 696e 7422 290d 0a09  pf.fill_int")...
+0004cd00: 0909 352e 2009 5468 6520 6469 6666 6572  ..5. .The differ
+0004cd10: 656e 6365 2062 6574 7765 656e 2063 616c  ence between cal
+0004cd20: 6375 6c61 7465 6420 616e 6420 6d65 6173  culated and meas
+0004cd30: 7572 6564 2073 7065 6374 7261 2069 7320  ured spectra is 
+0004cd40: 6361 6c63 756c 6174 6564 2c20 706f 696e  calculated, poin
+0004cd50: 742d 7769 7365 2073 7175 6172 6564 200d  t-wise squared .
+0004cd60: 0a09 0909 0961 6e64 2073 756d 6d65 6420  .....and summed 
+0004cd70: 746f 6765 7468 6572 2e20 2866 756e 6374  together. (funct
+0004cd80: 696f 6e20 2265 7272 5f66 756e 6322 206f  ion "err_func" o
+0004cd90: 7220 2265 7272 5f66 756e 635f 6d75 6c74  r "err_func_mult
+0004cda0: 6922 2069 6620 6d75 6c74 6970 6c65 2064  i" if multiple d
+0004cdb0: 6174 6173 6574 7320 6172 6520 6669 7474  atasets are fitt
+0004cdc0: 6564 290d 0a09 0909 362e 2009 5468 6973  ed).....6. .This
+0004cdd0: 2064 6966 6665 7265 6e63 6520 6973 206d   difference is m
+0004cde0: 696e 696d 697a 6564 2062 7920 6974 6572  inimized by iter
+0004cdf0: 6174 696e 6720 322d 3420 7769 7468 2063  ating 2-4 with c
+0004ce00: 6861 6e67 696e 6720 7061 7261 6d65 7465  hanging paramete
+0004ce10: 7273 2075 7369 6e67 2061 6e20 0d0a 0909  rs using an ....
+0004ce20: 0909 6f70 7469 6d69 7a61 7469 6f6e 2061  ..optimization a
+0004ce30: 6c67 6f72 6974 686d 2028 6765 6e65 7261  lgorithm (genera
+0004ce40: 6c6c 7920 6e65 6c64 6572 2d6d 6561 6420  lly nelder-mead 
+0004ce50: 7369 6d70 6c65 7829 0d0a 0909 0937 2e20  simplex).....7. 
+0004ce60: 0946 696e 616c 6c79 2069 6e20 6120 6c61  .Finally in a la
+0004ce70: 7374 2072 756e 206f 6620 322d 3520 7468  st run of 2-5 th
+0004ce80: 6520 6669 6e61 6c20 7370 6563 7472 6120  e final spectra 
+0004ce90: 6172 6520 6361 6c63 756c 6174 6564 2028  are calculated (
+0004cea0: 7573 696e 6720 7468 6520 2266 696e 616c  using the "final
+0004ceb0: 2220 666c 6167 2920 0d0a 0909 0909 616e  " flag) ......an
+0004cec0: 6420 7468 6520 6f70 7469 6d69 7a65 6420  d the optimized 
+0004ced0: 7061 7261 6d65 7465 722c 2074 6865 206d  parameter, the m
+0004cee0: 6174 7269 7865 7320 0d0a 0909 0909 2822  atrixes ......("
+0004cef0: 4122 2d6d 6561 7375 7265 642c 2022 4143  A"-measured, "AC
+0004cf00: 2220 2d20 6361 6c63 756c 6174 6564 2c20  " - calculated, 
+0004cf10: 2241 4522 202d 206c 696e 6561 7220 6572  "AE" - linear er
+0004cf20: 726f 7229 2c20 0d0a 0909 0909 7370 6563  ror), ......spec
+0004cf30: 7472 6120 2861 6c77 6179 7320 6361 6c6c  tra (always call
+0004cf40: 6564 2022 4441 5322 2920 7468 6520 636f  ed "DAS") the co
+0004cf50: 6e63 656e 7472 6174 696f 6e73 2028 6361  ncentrations (ca
+0004cf60: 6c6c 6564 2022 6322 2920 0d0a 0909 0909  lled "c") ......
+0004cf70: 6172 6520 7772 6974 7465 6e20 696e 2074  are written in t
+0004cf80: 6865 2064 6963 7469 6f6e 6172 7920 2274  he dictionary "t
+0004cf90: 612e 7265 2220 746f 6765 7468 6572 2077  a.re" together w
+0004cfa0: 6974 6820 6120 6665 7720 7265 7375 6c74  ith a few result
+0004cfb0: 2072 6570 7265 7365 6e74 6174 696f 6e73   representations
+0004cfc0: 200d 0a09 0909 0961 6e64 206f 7468 6572   ......and other
+0004cfd0: 2066 6974 206f 7574 7075 7473 2e20 5468   fit outputs. Th
+0004cfe0: 6520 6f70 7469 6d69 7a65 6420 7061 7261  e optimized para
+0004cff0: 6d65 7465 7220 6172 6520 616c 736f 2077  meter are also w
+0004d000: 7269 7474 656e 2069 6e74 6f20 7461 2e70  ritten into ta.p
+0004d010: 6172 5f66 6974 200d 0a09 0909 0928 6173  ar_fit ......(as
+0004d020: 2061 6e20 7061 7261 6d65 7465 7220 6f62   an parameter ob
+0004d030: 6a65 6374 2920 7468 6174 2063 616e 2062  ject) that can b
+0004d040: 6520 7265 2d75 7365 6420 6173 2069 6e70  e re-used as inp
+0004d050: 7574 2069 6e74 6f20 6675 7274 6865 7220  ut into further 
+0004d060: 6f70 7469 6d69 7a61 7469 6f6e 2073 7465  optimization ste
+0004d070: 7073 2e0d 0a09 0909 090d 0a09 0941 6c6c  ps...........All
+0004d080: 206d 616e 6461 746f 7279 2070 6172 616d   mandatory param
+0004d090: 6574 6572 7320 6172 6520 696e 2067 656e  eters are in gen
+0004d0a0: 6572 616c 2074 616b 656e 2066 726f 6d20  eral taken from 
+0004d0b0: 7468 6520 696e 7465 726e 616c 206f 6a65  the internal oje
+0004d0c0: 6374 2028 7365 6c66 2920 5468 6520 6f70  ct (self) The op
+0004d0d0: 7469 6f6e 616c 2070 6172 616d 6574 6572  tional parameter
+0004d0e0: 2063 6f6e 7472 6f6c 2074 6865 2062 6568   control the beh
+0004d0f0: 6176 696f 7572 206f 6620 7468 6520 6669  aviour of the fi
+0004d100: 7474 696e 6720 6675 6e63 7469 6f6e 2020  tting function  
+0004d110: 0d0a 0909 0d0a 0909 5061 7261 6d65 7465  ........Paramete
+0004d120: 7273 0d0a 0909 2d2d 2d2d 2d2d 2d2d 2d2d  rs....----------
+0004d130: 2d2d 2d2d 2d2d 2d2d 0d0a 0909 090d 0a09  --------........
+0004d140: 0909 7061 7220 3a20 6c6d 6669 7420 7061  ..par : lmfit pa
+0004d150: 7261 6d65 7465 7220 6f6a 6563 742c 206f  rameter oject, o
+0004d160: 7074 696f 6e61 6c0d 0a09 0909 0948 6572  ptional......Her
+0004d170: 6520 616e 6f74 6865 7220 7061 7261 6d65  e another parame
+0004d180: 7465 7220 6f62 6a65 6374 2063 6f75 6c64  ter object could
+0004d190: 2062 6520 6769 7665 6e2c 6f76 6572 7772   be given,overwr
+0004d1a0: 6974 696e 6720 7468 6520 2844 6566 6175  iting the (Defau
+0004d1b0: 6c74 2069 7320 7365 6c66 2e70 6172 2920  lt is self.par) 
+0004d1c0: 0d0a 0909 0909 0d0a 0909 096d 6f64 203a  ...........mod :
+0004d1d0: 2073 7472 206f 7220 6675 6e63 7469 6f6e   str or function
+0004d1e0: 2c20 6f70 7469 6f6e 616c 0d0a 0909 0909  , optional......
+0004d1f0: 4769 7665 2061 2065 7874 7261 206d 6f64  Give a extra mod
+0004d200: 656c 2073 656c 6563 7469 6f6e 2028 4465  el selection (De
+0004d210: 6661 756c 7420 7573 6573 2073 656c 662e  fault uses self.
+0004d220: 6d6f 6429 0d0a 0909 0909 696e 7465 726e  mod)......intern
+0004d230: 616c 206d 6f64 656c 6c73 3a20 2770 6172  al modells: 'par
+0004d240: 616c 272c 2765 7870 6f6e 656e 7469 616c  al','exponential
+0004d250: 272c 2763 6f6e 7365 6375 7469 7665 272c  ','consecutive',
+0004d260: 2766 756c 6c5f 636f 6e73 6563 7574 6976  'full_consecutiv
+0004d270: 6527 0d0a 0909 0909 7365 6520 616c 736f  e'......see also
+0004d280: 203a 6d65 7468 3a60 706c 6f74 5f66 756e   :meth:`plot_fun
+0004d290: 632e 6275 696c 645f 6360 2061 6e64 203a  c.build_c` and :
+0004d2a0: 6d65 7468 3a60 706c 6f74 5f66 756e 632e  meth:`plot_func.
+0004d2b0: 6572 725f 6675 6e63 600d 0a09 0909 090d  err_func`.......
+0004d2c0: 0a09 0909 636f 6e66 6964 656e 6365 5f6c  ....confidence_l
+0004d2d0: 6576 656c 3a20 4e6f 6e65 206f 7220 666c  evel: None or fl
+0004d2e0: 6f61 7420 2830 2e35 2d31 292c 206f 7074  oat (0.5-1), opt
+0004d2f0: 696f 6e61 6c0d 0a09 0909 0949 6620 7468  ional......If th
+0004d300: 6973 2069 7320 6368 616e 6765 6420 6672  is is changed fr
+0004d310: 6f6d 204e 6f6e 6520 2844 6566 6175 6c74  om None (Default
+0004d320: 2920 746f 2061 2076 616c 7565 2062 6574  ) to a value bet
+0004d330: 7765 656e 2030 2e35 2061 6e64 2031 2074  ween 0.5 and 1 t
+0004d340: 6865 2063 6f64 6520 7769 6c6c 0d0a 0909  he code will....
+0004d350: 0909 7472 7920 746f 2063 616c 6375 6c61  ..try to calcula
+0004d360: 7465 2074 6865 2065 7272 6f72 206f 6620  te the error of 
+0004d370: 7468 6520 7061 7261 6d65 7465 7220 666f  the parameter fo
+0004d380: 7220 7468 6520 6669 742e 2046 6f72 2065  r the fit. For e
+0004d390: 6163 6820 7061 7261 6d65 7465 7220 7468  ach parameter th
+0004d3a0: 6174 200d 0a09 0909 0963 616e 2076 6172  at ......can var
+0004d3b0: 7920 6120 7365 7061 7261 7465 206f 7074  y a separate opt
+0004d3c0: 696d 697a 6174 696f 6e20 6973 0970 6572  imization is.per
+0004d3d0: 666f 726d 6564 2c20 7468 6174 2061 7474  formed, that att
+0004d3e0: 656d 7074 7320 746f 2066 696e 6420 7468  empts to find th
+0004d3f0: 6520 7570 7065 7220 0d0a 0909 0909 616e  e upper ......an
+0004d400: 6420 6c6f 7765 7220 626f 756e 6420 6174  d lower bound at
+0004d410: 2077 6869 6368 2074 6865 2074 6f74 616c   which the total
+0004d420: 2065 7272 6f72 206f 6620 7468 6520 7265   error of the re
+0004d430: 2d6f 7074 696d 697a 6564 2067 6c6f 6261  -optimized globa
+0004d440: 6c6c 7920 6669 7474 6564 2072 6573 756c  lly fitted resul
+0004d450: 7473 0d0a 0909 0909 7265 6163 6865 7320  ts......reaches 
+0004d460: 7468 6520 6279 2046 2d73 7461 7469 7374  the by F-statist
+0004d470: 6963 7320 6465 6669 6e65 6420 636f 6e66  ics defined conf
+0004d480: 6964 656e 6365 2062 6f75 6e64 2e20 5365  idence bound. Se
+0004d490: 6520 3a6d 6574 683a 6070 6c6f 745f 6675  e :meth:`plot_fu
+0004d4a0: 6e63 2e73 325f 7673 5f73 6d69 6e32 6020  nc.s2_vs_smin2` 
+0004d4b0: 666f 7220 6465 7461 696c 7320 0d0a 0909  for details ....
+0004d4c0: 0909 6f6e 2068 6f77 2074 6869 7320 6c65  ..on how this le
+0004d4d0: 7665 6c20 6973 2064 6574 6572 6d69 6e65  vel is determine
+0004d4e0: 642e 2043 6172 6566 756c 2c20 7468 6973  d. Careful, this
+0004d4f0: 206f 7074 696f 6e20 6d69 6768 7420 7275   option might ru
+0004d500: 6e20 666f 7220 7665 7279 206c 6f6e 6720  n for very long 
+0004d510: 7469 6d65 2e0d 0a09 0909 094d 6561 6e69  time.......Meani
+0004d520: 6e67 2074 6861 7420 6974 2074 7970 6963  ng that it typic
+0004d530: 616c 6c79 2074 616b 6573 2035 3020 6f70  ally takes 50 op
+0004d540: 7469 6d69 7a61 7469 6f6e 2070 6572 2076  timization per v
+0004d550: 6172 6961 626c 6520 7061 7261 6d65 7465  ariable paramete
+0004d560: 7220 2868 6172 6420 636f 6465 6420 6c69  r (hard coded li
+0004d570: 6d69 7420 3230 3029 0d0a 0909 0909 5468  mit 200)......Th
+0004d580: 6520 636f 6e66 6964 656e 6365 206c 6576  e confidence lev
+0004d590: 656c 2069 7320 746f 2062 6520 756e 6465  el is to be unde
+0004d5a0: 7273 746f 6f64 2074 6861 7420 6974 2064  rstood that it d
+0004d5b0: 6566 696e 6573 2074 6865 2065 2e67 2e20  efines the e.g. 
+0004d5c0: 302e 3635 202a 2031 3030 5c25 2061 7265  0.65 * 100\% are
+0004d5d0: 6120 7468 6174 2074 6865 0d0a 0909 0909  a that the......
+0004d5e0: 7061 7261 6d65 7465 7220 7769 7468 2074  parameter with t
+0004d5f0: 6869 7320 7365 7420 6f66 2076 616c 7565  his set of value
+0004d600: 7320 6973 2077 6974 6869 6e20 7468 6973  s is within this
+0004d610: 2062 6f75 6e64 732e 0d0a 0909 0909 4e6f   bounds.......No
+0004d620: 726d 616c 2062 6568 6176 696f 7572 2066  rmal behaviour f
+0004d630: 6f72 2074 6869 7320 6973 2074 6f20 7265  or this is to re
+0004d640: 2d6f 7074 696d 6973 6520 7468 6520 7061  -optimise the pa
+0004d650: 7261 6d65 7465 7220 6475 7269 6e67 2074  rameter during t
+0004d660: 6865 206f 7074 696d 697a 6174 696f 6e2e  he optimization.
+0004d670: 2069 6620 7468 6520 7061 7261 6d65 7465   if the paramete
+0004d680: 7220 0d0a 0909 0909 7061 725b 2765 7272  r ......par['err
+0004d690: 6f72 5f70 6172 616d 5f66 6978 275d 2069  or_param_fix'] i
+0004d6a0: 7320 7072 6573 656e 742c 2074 6869 7320  s present, this 
+0004d6b0: 7769 6c6c 2062 6520 7375 7070 7265 7373  will be suppress
+0004d6c0: 6564 2e0d 0a09 0909 0d0a 0909 0975 7365  ed...........use
+0004d6d0: 5f61 6d70 676f 203a 2062 6f6f 6c2c 206f  _ampgo : bool, o
+0004d6e0: 7074 696f 6e61 6c0d 0a09 0909 0928 4465  ptional......(De
+0004d6f0: 6661 756c 7429 2069 7320 4661 6c73 650d  fault) is False.
+0004d700: 0a09 0909 0943 6861 6e67 6573 2074 6865  .....Changes the
+0004d710: 206f 7074 696d 697a 6572 2066 726f 6d20   optimizer from 
+0004d720: 6120 7075 7265 204e 656c 6465 7220 6d65  a pure Nelder me
+0004d730: 6164 2074 6f20 416d 7067 6f20 7769 7468  ad to Ampgo with
+0004d740: 2061 206c 6f63 616c 204e 656c 6465 7220   a local Nelder 
+0004d750: 4d65 6164 2e20 0d0a 0909 0909 466f 7220  Mead. ......For 
+0004d760: 7573 696e 6720 7468 6973 2070 6f77 6572  using this power
+0004d770: 6675 6c6c 2074 6f6f 6c20 616c 6c20 7061  full tool all pa
+0004d780: 7261 6d65 7465 7220 6e65 6564 2074 6f20  rameter need to 
+0004d790: 6861 7665 2061 2022 6d69 6e22 2061 6e64  have a "min" and
+0004d7a0: 2061 2022 6d61 7822 2073 6574 2e20 0d0a   a "max" set. ..
+0004d7b0: 0909 0909 5479 7069 6361 6c6c 7920 7461  ....Typically ta
+0004d7c0: 6b65 7320 3130 2d34 3078 206c 6f6e 6765  kes 10-40x longe
+0004d7d0: 7220 7468 616e 2061 2073 7461 6e64 6172  r than a standar
+0004d7e0: 6420 6f70 7469 6d69 7a61 7469 6f6e 2c20  d optimization, 
+0004d7f0: 6275 7420 6361 6e20 6475 6520 746f 2069  but can due to i
+0004d800: 7473 200d 0a09 0909 0974 756e 6e65 6c69  ts ......tunneli
+0004d810: 6e67 2061 6c67 6f72 6974 686d 206d 6f72  ng algorithm mor
+0004d820: 6520 7265 6c69 6162 6c79 2066 696e 6420  e reliably find 
+0004d830: 676c 6f62 616c 206d 696e 696d 612e 200d  global minima. .
+0004d840: 0a09 0909 0973 6565 3a68 7474 7073 3a2f  .....see:https:/
+0004d850: 2f6c 6d66 6974 2e67 6974 6875 622e 696f  /lmfit.github.io
+0004d860: 2f6c 6d66 6974 2d70 792f 6669 7474 696e  /lmfit-py/fittin
+0004d870: 672e 6874 6d6c 2066 6f72 2066 7572 7468  g.html for furth
+0004d880: 6572 2064 6574 6169 6c73 0d0a 0909 090d  er details......
+0004d890: 0a09 0909 6669 745f 6368 6972 7020 3a20  ....fit_chirp : 
+0004d8a0: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0d0a  bool, optional..
+0004d8b0: 0909 0909 2844 6566 6175 6c74 2920 6973  ....(Default) is
+0004d8c0: 2046 616c 7365 0d0a 0909 0909 6120 706f   False......a po
+0004d8d0: 7765 7266 756c 206f 7074 696d 697a 6174  werful optimizat
+0004d8e0: 696f 6e20 6f66 2074 6865 2063 6869 7270  ion of the chirp
+0004d8f0: 2070 6172 616d 6574 6572 2e20 466f 7220   parameter. For 
+0004d900: 7468 6973 2074 6f20 776f 726b 2074 6865  this to work the
+0004d910: 2064 6174 6120 0d0a 0909 0909 6e65 6564   data ......need
+0004d920: 7320 746f 2069 6e63 6c75 6465 2074 696d  s to include tim
+0004d930: 6570 6f69 6e74 7320 6265 666f 7265 2061  epoints before a
+0004d940: 6e64 2061 6674 6572 2074 3d30 2061 6e64  nd after t=0 and
+0004d950: 206f 6e65 2073 686f 756c 6420 6861 7665   one should have
+0004d960: 2072 6561 6368 6564 200d 0a09 0909 0961   reached ......a
+0004d970: 2064 6563 656e 7420 6669 7420 6f66 206d   decent fit of m
+0004d980: 6f73 7420 6665 6174 7572 6573 2069 6e20  ost features in 
+0004d990: 7468 6520 7370 6563 7472 756d 2e20 5765  the spectrum. We
+0004d9a0: 2070 6572 666f 726d 2061 6e20 4e65 6c64   perform an Neld
+0004d9b0: 6572 2d4d 6561 6420 6f70 7469 6d69 7361  er-Mead optimisa
+0004d9c0: 7469 6f6e 200d 0a09 0909 096f 6620 7468  tion ......of th
+0004d9d0: 6520 7061 7261 6d65 7465 7220 666f 6c6c  e parameter foll
+0004d9e0: 6f77 6564 2062 7920 6120 4e65 6c64 6572  owed by a Nelder
+0004d9f0: 2d4d 6561 6420 6f70 7469 6d69 7a61 7469  -Mead optimizati
+0004da00: 6f6e 206f 6620 7468 6520 6368 6972 7020  on of the chirp 
+0004da10: 7061 7261 6d65 7465 7220 0d0a 0909 0909  parameter ......
+0004da20: 6173 206f 6e65 2069 7465 7261 7469 6f6e  as one iteration
+0004da30: 2e20 4166 7465 7220 6561 6368 2063 6f6e  . After each con
+0004da40: 7365 6375 7469 7665 206f 7074 696d 697a  secutive optimiz
+0004da50: 6174 696f 6e20 6974 2069 7320 6368 6563  ation it is chec
+0004da60: 6b65 6420 6966 2074 6865 2074 6f74 616c  ked if the total
+0004da70: 2065 7272 6f72 200d 0a09 0909 0969 6d70   error ......imp
+0004da80: 726f 7665 642e 2049 6620 6e6f 7420 7468  roved. If not th
+0004da90: 6520 6669 7420 6973 2065 6e64 6564 2c20  e fit is ended, 
+0004daa0: 6966 2079 6573 2074 6865 206d 6178 696d  if yes the maxim
+0004dab0: 756d 206e 756d 6265 7220 6f66 2069 7465  um number of ite
+0004dac0: 7261 7469 6f6e 7320 0d0a 0909 0909 2766  rations ......'f
+0004dad0: 6974 5f63 6869 7270 5f69 7465 7261 7469  it_chirp_iterati
+0004dae0: 6f6e 7327 2069 7320 7065 7266 6f72 6d65  ons' is performe
+0004daf0: 642e 2057 6172 6e69 6e67 2c20 7468 6973  d. Warning, this
+0004db00: 2067 6f65 7320 7765 6c6c 2069 6e20 6d61   goes well in ma
+0004db10: 6e79 2063 6173 6573 2c20 0d0a 0909 0909  ny cases, ......
+0004db20: 6275 7420 6361 6e20 6c65 6164 2074 6f20  but can lead to 
+0004db30: 7665 7279 2073 7472 616e 6765 2072 6573  very strange res
+0004db40: 756c 7473 2069 6e20 6f74 6865 7273 2c20  ults in others, 
+0004db50: 616c 7761 7973 2063 6172 6566 756c 6c79  always carefully
+0004db60: 2063 6865 636b 2074 6865 2072 6573 756c   check the resul
+0004db70: 7473 2e0d 0a09 0909 0949 2072 6563 6f6d  ts.......I recom
+0004db80: 6d65 6e64 2074 6f20 6d61 6b65 2061 2063  mend to make a c
+0004db90: 6f70 7920 6f66 2074 6865 206f 626a 6563  opy of the objec
+0004dba0: 7420 6265 666f 7265 2072 756e 6e6e 696e  t before runnnin
+0004dbb0: 6720 6120 6368 6972 7020 6f70 7469 6d69  g a chirp optimi
+0004dbc0: 7a61 7469 6f6e 2e0d 0a09 0909 0d0a 0909  zation..........
+0004dbd0: 0966 6974 5f63 6869 7270 5f69 7465 7261  .fit_chirp_itera
+0004dbe0: 7469 6f6e 7320 3a20 696e 742c 206f 7074  tions : int, opt
+0004dbf0: 696f 6e61 6c0d 0a09 0909 096d 6178 696d  ional......maxim
+0004dc00: 756d 206e 756d 6265 7220 6f66 2074 696d  um number of tim
+0004dc10: 6573 2074 6865 2067 6c6f 6261 6c20 2d20  es the global - 
+0004dc20: 6368 6972 7020 6c6f 6f70 2069 7320 7265  chirp loop is re
+0004dc30: 7065 6174 6564 2e20 0d0a 0909 0909 5479  peated. ......Ty
+0004dc40: 7069 6361 6c6c 7920 7468 6973 2069 7465  pically this ite
+0004dc50: 7261 7469 6f6e 7320 7275 6e20 322d 3520  rations run 2-5 
+0004dc60: 7469 6d65 732c 2028 4465 6661 756c 7429  times, (Default)
+0004dc70: 2069 7320 3130 0d0a 0909 090d 0a09 0909   is 10..........
+0004dc80: 6475 6d70 5f70 6172 6173 203a 2062 6f6f  dump_paras : boo
+0004dc90: 6c2c 206f 7074 696f 6e61 6c0d 0a09 0909  l, optional.....
+0004dca0: 0928 4465 6661 756c 7429 2069 7320 4661  .(Default) is Fa
+0004dcb0: 6c73 652c 2049 6620 5472 7565 2063 7265  lse, If True cre
+0004dcc0: 6174 6573 2074 776f 2066 696c 6573 2069  ates two files i
+0004dcd0: 6e20 7468 6520 776f 726b 696e 6720 666f  n the working fo
+0004dce0: 6c64 6572 2c20 6f6e 6520 7769 7468 2074  lder, one with t
+0004dcf0: 6865 200d 0a09 0909 0963 7572 7265 6e74  he ......current
+0004dd00: 6c79 2075 7365 6420 7061 7261 6d65 7465  ly used paramete
+0004dd10: 7220 6372 6561 7465 6420 6174 2074 6865  r created at the
+0004dd20: 2065 6e64 206f 6620 6561 6368 206f 7074   end of each opt
+0004dd30: 696d 6973 6174 696f 6e20 7374 6570 2c20  imisation step, 
+0004dd40: 616e 6420 6f6e 6520 7769 7468 0d0a 0909  and one with....
+0004dd50: 0909 7468 6520 7365 7420 6f66 2070 6172  ..the set of par
+0004dd60: 616d 6574 6572 2074 6861 7420 7570 2074  ameter that up t
+0004dd70: 6f20 6e6f 7720 6761 7665 2074 6865 206c  o now gave the l
+0004dd80: 6f77 6573 7420 6572 726f 722e 2049 6e74  owest error. Int
+0004dd90: 656e 7465 6420 746f 2073 746f 7265 0d0a  ented to store..
+0004dda0: 0909 0909 7468 6520 6f70 7469 6d69 7361  ....the optimisa
+0004ddb0: 7469 6f6e 2072 6573 756c 7473 2069 6620  tion results if 
+0004ddc0: 7468 6520 6669 7420 6e65 6564 7320 746f  the fit needs to
+0004ddd0: 2062 6520 696e 7465 7272 7570 7465 6420   be interrupted 
+0004dde0: 0d0a 0909 0909 2869 6620 652e 672e 2041  ......(if e.g. A
+0004ddf0: 6d70 676f 2073 696d 706c 7920 6e65 6564  mpgo simply need
+0004de00: 7320 746f 206c 6f6e 6720 746f 206f 7074  s to long to opt
+0004de10: 696d 697a 652e 2920 7573 6566 756c 206f  imize.) useful o
+0004de20: 7074 696f 6e20 6966 2074 6869 6e67 7320  ption if things 
+0004de30: 6172 6520 736c 6f77 0d0a 0909 0909 7468  are slow......th
+0004de40: 6973 2070 6172 616d 6574 6572 2061 6c73  is parameter als
+0004de50: 6f20 7472 6967 6765 7273 2074 6865 2077  o triggers the w
+0004de60: 7269 7469 6e67 206f 6620 6669 746f 7574  riting of fitout
+0004de70: 2074 6f20 6120 7465 7874 6669 6c65 206f   to a textfile o
+0004de80: 6e20 6469 7363 0d0a 0909 0909 0d0a 0909  n disc..........
+0004de90: 0964 756d 705f 7368 6170 6573 203a 2062  .dump_shapes : b
+0004dea0: 6f6f 6c2c 206f 7074 696f 6e61 6c0d 0a09  ool, optional...
+0004deb0: 0909 0974 6869 7320 6f70 7469 6f6e 2064  ...this option d
+0004dec0: 756d 7073 2074 6865 2063 6f6e 6365 6e74  umps the concent
+0004ded0: 7261 746f 696e 206d 6174 7269 7820 616e  ratoin matrix an
+0004dee0: 6420 7468 6520 4441 5320 6f6e 746f 2064  d the DAS onto d
+0004def0: 6973 6b20 666f 7220 6561 6368 2072 6f75  isk for each rou
+0004df00: 6e64 206f 6620 6f70 7469 6d69 7a61 7469  nd of optimizati
+0004df10: 6f6e 2c0d 0a09 0909 096d 6f73 746c 7920  on,......mostly 
+0004df20: 7573 6566 756c 2066 6f72 206d 756c 7469  useful for multi
+0004df30: 2d70 726f 6a65 6374 2066 6974 7469 6e67  -project fitting
+0004df40: 2074 6861 7420 7761 6e74 7320 746f 2075   that wants to u
+0004df50: 7365 2074 6865 2073 7065 6374 7261 6c20  se the spectral 
+0004df60: 6f72 2074 656d 706f 7261 6c20 696e 7465  or temporal inte
+0004df70: 6e73 6974 790d 0a09 0909 0d0a 0909 0966  nsity..........f
+0004df80: 696c 656e 616d 6520 3a20 4e6f 6e65 206f  ilename : None o
+0004df90: 7220 7374 722c 206f 7074 696f 6e61 6c0d  r str, optional.
+0004dfa0: 0a09 0909 094f 6e6c 7920 7573 6564 2069  .....Only used i
+0004dfb0: 6e20 636f 6e6a 756e 6374 696f 6e20 7769  n conjunction wi
+0004dfc0: 7468 2027 6475 6d70 5f70 6172 6173 272e  th 'dump_paras'.
+0004dfd0: 2054 6865 2070 726f 6772 616d 2075 7365   The program use
+0004dfe0: 7320 7468 6973 2066 696c 656e 616d 6520  s this filename 
+0004dff0: 746f 2064 756d 7020 7468 6520 0d0a 0909  to dump the ....
+0004e000: 0909 7061 7261 6d65 7465 7220 746f 2064  ..parameter to d
+0004e010: 6973 6b20 0d0a 0909 090d 0a09 0909 6d75  isk ..........mu
+0004e020: 6c74 695f 7072 6f6a 6563 7420 3a20 4e6f  lti_project : No
+0004e030: 6e65 206f 7220 6c69 7374 2028 6f66 2054  ne or list (of T
+0004e040: 4120 7072 6f6a 6563 7473 292c 206f 7074  A projects), opt
+0004e050: 696f 6e61 6c0d 0a09 0909 0954 6869 7320  ional......This 
+0004e060: 7377 6974 6368 2069 7320 7472 6967 6765  switch is trigge
+0004e070: 7269 6e67 2074 6865 2073 696d 756c 7461  ring the simulta
+0004e080: 6e65 6f75 7320 6f70 7469 6d69 7361 7469  neous optimisati
+0004e090: 6f6e 206f 6620 6d75 6c74 6970 6c65 2064  on of multiple d
+0004e0a0: 6174 6173 6574 732e 2020 0d0a 0909 0909  atasets.  ......
+0004e0b0: 6d75 6c74 695f 7072 6f6a 6563 7420 6973  multi_project is
+0004e0c0: 2061 7320 2844 6566 6175 6c74 2920 4e6f   as (Default) No
+0004e0d0: 6e65 2e20 6974 2065 7870 6563 7473 2061  ne. it expects a
+0004e0e0: 6e20 6974 6572 6162 6c65 2028 7479 7069  n iterable (typi
+0004e0f0: 6361 6c6c 7920 6c69 7374 2920 7769 7468  cally list) with
+0004e100: 206f 7468 6572 200d 0a09 0909 0954 4120   other ......TA 
+0004e110: 7072 6f6a 6563 7473 2028 6c69 6b65 2074  projects (like t
+0004e120: 6129 2074 6861 7420 6172 6520 7468 656e  a) that are then
+0004e130: 206f 7074 696d 6973 6564 2077 6974 6820   optimised with 
+0004e140: 7468 6520 7361 6d65 2070 6172 616d 6574  the same paramet
+0004e150: 6572 2e20 0d0a 0909 0909 5468 6973 206d  er. ......This m
+0004e160: 6561 6e73 2074 6861 7420 616c 6c20 7072  eans that all pr
+0004e170: 6f6a 6563 7473 2067 6574 2074 6865 2073  ojects get the s
+0004e180: 616d 6520 7061 7261 6d65 7465 7220 6f62  ame parameter ob
+0004e190: 6a65 6374 2066 6f72 2065 6163 6820 6974  ject for each it
+0004e1a0: 6572 6174 696f 6e20 0d0a 0909 0909 6f66  eration ......of
+0004e1b0: 2074 6865 2066 6974 2061 6e64 2072 6574   the fit and ret
+0004e1c0: 7572 6e20 7468 6569 7220 696e 6469 7669  urn their indivi
+0004e1d0: 6475 616c 2065 7272 6f72 2c20 7768 6963  dual error, whic
+0004e1e0: 6820 6973 2073 756d 6d65 6420 6c69 6e65  h is summed line
+0004e1f0: 6172 6c79 2e20 0d0a 0909 0909 5468 6520  arly. ......The 
+0004e200: 2277 6569 6768 7473 2220 6f70 7469 6f6e  "weights" option
+0004e210: 2061 6c6c 6f77 7320 746f 2067 6976 6520   allows to give 
+0004e220: 6561 6368 206d 756c 7469 5f70 726f 6a65  each multi_proje
+0004e230: 6374 2061 2073 7065 6369 6669 6320 7765  ct a specific we
+0004e240: 6967 6874 2028 6e75 6d62 6572 2920 0d0a  ight (number) ..
+0004e250: 0909 0909 7468 6174 2069 7320 6d75 6c74  ....that is mult
+0004e260: 6970 6c69 6564 2074 6f20 7468 6520 6572  iplied to the er
+0004e270: 726f 722e 2049 6620 7468 6520 7765 6967  ror. If the weig
+0004e280: 6874 206f 626a 6563 7420 6861 7320 7468  ht object has th
+0004e290: 6520 7361 6d65 206e 756d 6265 7220 6f66  e same number of
+0004e2a0: 2069 7465 6d73 200d 0a09 0909 0961 7320   items ......as 
+0004e2b0: 7468 6520 6d75 6c74 695f 7072 6f6a 6563  the multi_projec
+0004e2c0: 7420 6974 2069 7320 6173 7375 6d65 6420  t it is assumed 
+0004e2d0: 7468 6174 2074 6865 2074 7269 6767 6572  that the trigger
+0004e2e0: 696e 6720 6f62 6a65 6374 2028 7468 6520  ing object (the 
+0004e2f0: 656d 6265 6464 6564 2070 726f 6a65 6374  embedded project
+0004e300: 2920 0d0a 0909 0909 6861 7320 7468 6520  ) ......has the 
+0004e310: 7765 6967 6874 206f 6620 312c 206f 7468  weight of 1, oth
+0004e320: 6572 7769 7365 2074 6865 2066 6972 7374  erwise the first
+0004e330: 2077 6569 6768 7420 6973 2066 6f72 2074   weight is for t
+0004e340: 6865 2065 6d62 6564 6465 6420 7072 6f6a  he embedded proj
+0004e350: 6563 742e 200d 0a09 0909 0954 6865 206f  ect. ......The o
+0004e360: 7074 696f 6e20 2775 6e69 7175 655f 7061  ption 'unique_pa
+0004e370: 7261 6d65 7465 7227 2074 616b 6573 2028  rameter' takes (
+0004e380: 6120 6c69 7374 2920 6f66 2070 6172 616d  a list) of param
+0004e390: 6574 6572 2074 6861 7420 6172 6520 6e6f  eter that are no
+0004e3a0: 7420 0d0a 0909 0909 746f 2062 6520 7368  t ......to be sh
+0004e3b0: 6172 6564 2062 6574 7765 656e 2074 6865  ared between the
+0004e3c0: 2070 726f 6a65 6374 7320 2861 6e64 2074   projects (and t
+0004e3d0: 6861 7420 6172 6520 6e6f 7420 6f70 7469  hat are not opti
+0004e3e0: 6d69 7a65 6420 6569 7468 6572 2920 0d0a  mized either) ..
+0004e3f0: 0909 0909 5468 6520 696e 7465 6e64 6564  ....The intended
+0004e400: 2075 7365 206f 6620 7468 6973 2069 7320   use of this is 
+0004e410: 746f 2067 6976 6520 652e 672e 2074 6865  to give e.g. the
+0004e420: 2070 756d 7020 706f 7765 7220 666f 7220   pump power for 
+0004e430: 6d75 6c74 6970 6c65 2065 7870 6572 696d  multiple experim
+0004e440: 656e 7473 2074 6f20 0d0a 0909 0909 7374  ents to ......st
+0004e450: 7564 7920 6e6f 6e20 6c69 6e65 6172 2062  udy non linear b
+0004e460: 6568 6176 696f 7572 2e20 5265 7475 726e  ehaviour. Return
+0004e470: 6564 2077 696c 6c20 6265 206f 6e6c 7920  ed will be only 
+0004e480: 7468 6520 7061 7261 6d65 7465 7220 7365  the parameter se
+0004e490: 7420 666f 7220 7468 6520 6f70 7469 6d69  t for the optimi
+0004e4a0: 756d 0d0a 0909 0909 636f 6d62 696e 6174  um......combinat
+0004e4b0: 696f 6e20 6f66 2061 6c6c 2070 6172 616d  ion of all param
+0004e4c0: 6574 6572 2e20 496e 7465 726e 616c 6c79  eter. Internally
+0004e4d0: 2c20 7765 2069 7465 7261 7465 2074 6872  , we iterate thr
+0004e4e0: 6f75 6768 2074 6865 2070 726f 6a65 6374  ough the project
+0004e4f0: 7320 616e 6420 6361 6c63 756c 6174 6520  s and calculate 
+0004e500: 0d0a 0909 0909 666f 7220 6561 6368 2070  ......for each p
+0004e510: 726f 6a65 6374 2074 6865 2065 7272 6f72  roject the error
+0004e520: 2066 6f72 2065 6163 6820 6974 6572 6174   for each iterat
+0004e530: 696f 6e2e 2049 6d70 6f72 7461 6e74 2074  ion. Important t
+0004e540: 6f20 6e6f 7465 2069 7320 7468 6174 2063  o note is that c
+0004e550: 7572 7265 6e74 6c79 2074 6869 7320 0d0a  urrently this ..
+0004e560: 0909 0909 6d65 616e 7320 7468 6174 2065  ....means that e
+0004e570: 6163 6820 4441 532f 5341 5320 6973 2063  ach DAS/SAS is c
+0004e580: 616c 6375 6c61 7465 6420 696e 6465 7065  alculated indepe
+0004e590: 6e64 656e 746c 7921 2046 6f72 2070 6572  ndently! For per
+0004e5a0: 666f 726d 696e 6720 7468 6520 7361 6d65  forming the same
+0004e5b0: 2063 616c 6375 6c61 7469 6f6e 0d0a 0909   calculation....
+0004e5c0: 0909 7769 7468 2061 2073 696e 676c 6520  ..with a single 
+0004e5d0: 4441 532c 2074 6865 204d 6174 7269 7865  DAS, the Matrixe
+0004e5e0: 7320 6e65 6564 2074 6f20 6265 2063 6f6e  s need to be con
+0004e5f0: 6361 7465 6e61 7465 6420 6265 666f 7265  catenated before
+0004e600: 2074 6865 2072 756e 2061 6e64 2061 6e20   the run and an 
+0004e610: 6578 7465 726e 616c 0d0a 0909 0909 6675  external......fu
+0004e620: 6e63 7469 6f6e 2075 7365 6420 746f 2063  nction used to c
+0004e630: 7265 6174 6520 6120 636f 6d62 696e 6564  reate a combined
+0004e640: 206d 6f64 656c 2e20 4173 2074 6869 7320   model. As this 
+0004e650: 6973 2076 6572 7920 6469 6666 6963 756c  is very difficul
+0004e660: 7420 746f 2069 6d70 6c65 6d65 6e74 2072  t to implement r
+0004e670: 656c 6961 626c 790d 0a09 0909 0946 6f72  eliably......For
+0004e680: 2067 656e 6572 616c 2075 7365 2028 7468   general use (th
+0004e690: 696e 6b20 652e 672e 2064 6966 6665 7265  ink e.g. differe
+0004e6a0: 6e74 2070 756d 7020 7761 7665 6c65 6e67  nt pump waveleng
+0004e6b0: 7468 2920 7468 6973 2068 6173 2074 6f20  th) this has to 
+0004e6c0: 6265 2064 6f6e 6520 6d61 6e75 616c 6c79  be done manually
+0004e6d0: 2e20 0d0a 0909 090d 0a09 0909 756e 6971  . ..........uniq
+0004e6e0: 7565 5f70 6172 616d 6574 6572 203a 204e  ue_parameter : N
+0004e6f0: 6f6e 6520 6f72 2073 7472 206f 7220 6c69  one or str or li
+0004e700: 7374 2028 6f66 2073 7472 696e 6773 292c  st (of strings),
+0004e710: 206f 7074 696f 6e61 6c20 0d0a 0909 0909   optional ......
+0004e720: 6f6e 6c79 2075 7365 6420 696e 2063 6f6e  only used in con
+0004e730: 6a75 6e63 7469 6f6e 2077 6974 6820 276d  junction with 'm
+0004e740: 756c 7469 5f70 726f 6a65 6374 272c 2069  ulti_project', i
+0004e750: 7420 7461 6b65 7320 2861 206c 6973 7429  t takes (a list)
+0004e760: 206f 6620 7061 7261 6d65 7465 7220 7468   of parameter th
+0004e770: 6174 200d 0a09 0909 0961 7265 206e 6f74  at ......are not
+0004e780: 2074 6f20 6265 2073 6861 7265 6420 6265   to be shared be
+0004e790: 7477 6565 6e20 7468 6520 7072 6f6a 6563  tween the projec
+0004e7a0: 7473 2028 616e 6420 7468 6174 2061 7265  ts (and that are
+0004e7b0: 206e 6f74 206f 7074 696d 697a 6564 2065   not optimized e
+0004e7c0: 6974 6865 7229 200d 0a09 0909 0954 6865  ither) ......The
+0004e7d0: 2069 6e74 656e 6465 6420 7573 6520 6f66   intended use of
+0004e7e0: 2074 6869 7320 6973 2074 6f20 6769 7665   this is to give
+0004e7f0: 2065 2e67 2e20 7468 6520 7075 6d70 2070   e.g. the pump p
+0004e800: 6f77 6572 2066 6f72 206d 756c 7469 706c  ower for multipl
+0004e810: 6520 6578 7065 7269 6d65 6e74 7320 0d0a  e experiments ..
+0004e820: 0909 0909 746f 2073 7475 6479 206e 6f6e  ....to study non
+0004e830: 206c 696e 6561 7220 6265 6861 7669 6f75   linear behaviou
+0004e840: 722e 2028 4465 6661 756c 7429 204e 6f6e  r. (Default) Non
+0004e850: 650d 0a09 0909 0d0a 0909 0973 616d 655f  e..........same_
+0004e860: 4441 5320 3a20 626f 6f6c 2c6f 7074 696f  DAS : bool,optio
+0004e870: 6e61 6c0d 0a09 0909 0963 6861 6e67 6573  nal......changes
+0004e880: 2074 6865 2066 6974 2062 6568 6176 696f   the fit behavio
+0004e890: 7220 616e 6420 7573 6573 2074 6865 2073  r and uses the s
+0004e8a0: 616d 6520 4441 5320 666f 7220 7468 6520  ame DAS for the 
+0004e8b0: 6f70 7469 6d69 7a61 7469 6f6e 2e20 0d0a  optimization. ..
+0004e8c0: 0909 0909 5468 6973 206d 6561 6e73 2074  ....This means t
+0004e8d0: 6861 7420 7468 6520 6473 2061 7265 2073  hat the ds are s
+0004e8e0: 7461 636b 6564 2062 6566 6f72 6520 7468  tacked before th
+0004e8f0: 6520 6669 6c6c 5f69 6e74 2072 6f75 6e64  e fill_int round
+0004e900: 732e 2054 6869 7320 6f70 7469 6f6e 2069  s. This option i
+0004e910: 7320 6f6e 6c79 2075 7365 6420 696e 206d  s only used in m
+0004e920: 756c 7469 2d70 726f 6a65 6374 2066 6974  ulti-project fit
+0004e930: 7469 6e67 0d0a 0909 090d 0a09 0909 7765  ting..........we
+0004e940: 6967 6874 7320 3a20 6c69 7374 206f 6620  ights : list of 
+0004e950: 666c 6f61 7473 2c20 6f70 7469 6f6e 616c  floats, optional
+0004e960: 0d0a 0909 0909 6f6e 6c79 2075 7365 6420  ......only used 
+0004e970: 696e 2063 6f6e 6a75 6e63 7469 6f6e 2077  in conjunction w
+0004e980: 6974 6820 276d 756c 7469 5f70 726f 6a65  ith 'multi_proje
+0004e990: 6374 272e 2054 6865 2022 7765 6967 6874  ct'. The "weight
+0004e9a0: 7322 206f 7074 696f 6e20 616c 6c6f 7773  s" option allows
+0004e9b0: 2074 6f20 0d0a 0909 0909 6769 7665 2065   to ......give e
+0004e9c0: 6163 6820 6d75 6c74 695c 5f70 726f 6a65  ach multi\_proje
+0004e9d0: 6374 2061 2073 7065 6369 6669 6320 7765  ct a specific we
+0004e9e0: 6967 6874 2028 6e75 6d62 6572 2920 7468  ight (number) th
+0004e9f0: 6174 2069 7320 6d75 6c74 6970 6c69 6564  at is multiplied
+0004ea00: 2074 6f20 7468 6520 6572 726f 722e 200d   to the error. .
+0004ea10: 0a09 0909 0949 6620 7468 6520 7765 6967  .....If the weig
+0004ea20: 6874 206f 626a 6563 7420 6861 7320 7468  ht object has th
+0004ea30: 6520 7361 6d65 206e 756d 6265 7220 6f66  e same number of
+0004ea40: 2069 7465 6d73 2061 7320 7468 6520 276d   items as the 'm
+0004ea50: 756c 7469 5f70 726f 6a65 6374 2720 6974  ulti_project' it
+0004ea60: 2069 7320 6173 7375 6d65 6420 0d0a 0909   is assumed ....
+0004ea70: 0909 7468 6174 2074 6120 2874 6865 2065  ..that ta (the e
+0004ea80: 6d62 6564 6465 6420 7072 6f6a 6563 7429  mbedded project)
+0004ea90: 2068 6173 2074 6865 2077 6569 6768 7420   has the weight 
+0004eaa0: 6f66 2031 2c20 6f74 6865 7277 6973 6520  of 1, otherwise 
+0004eab0: 7468 6520 6669 7273 7420 7765 6967 6874  the first weight
+0004eac0: 2069 7320 666f 7220 7468 6520 0d0a 0909   is for the ....
+0004ead0: 0909 656d 6265 6464 6564 206f 626a 6563  ..embedded objec
+0004eae0: 740d 0a09 0909 090d 0a09 0909 6578 745f  t...........ext_
+0004eaf0: 7370 6563 7472 6120 3a20 4461 7461 4672  spectra : DataFr
+0004eb00: 616d 652c 206f 7074 696f 6e61 6c0d 0a09  ame, optional...
+0004eb10: 0909 0928 4465 6661 756c 7429 2069 7320  ...(Default) is 
+0004eb20: 4e6f 6e65 2c20 6966 2067 6976 656e 2073  None, if given s
+0004eb30: 7562 7374 7261 6374 2074 6869 7320 7370  ubstract this sp
+0004eb40: 6563 7472 6120 6672 6f6d 2074 6865 2044  ectra from the D
+0004eb50: 6174 614d 6174 7269 7820 7573 696e 6720  ataMatrix using 
+0004eb60: 7468 6520 696e 7465 6e73 6974 7920 0d0a  the intensity ..
+0004eb70: 0909 0909 6769 7665 6e20 696e 2022 4328  ....given in "C(
+0004eb80: 7429 2220 7468 6973 2066 756e 6374 696f  t)" this functio
+0004eb90: 6e20 7769 6c6c 206f 6e6c 7920 776f 726b  n will only work
+0004eba0: 2066 6f72 2065 7874 6572 6e61 6c20 6d6f   for external mo
+0004ebb0: 6465 6c73 2e20 5468 6520 6e61 6d65 206f  dels. The name o
+0004ebc0: 6620 7468 6520 7370 6563 7472 616c 2063  f the spectral c
+0004ebd0: 6f6c 756d 6e20 0d0a 0909 0909 6d75 7374  olumn ......must
+0004ebe0: 2062 6520 7361 6d65 2061 7320 7468 6520   be same as the 
+0004ebf0: 6e61 6d65 206f 6620 7468 6520 636f 6c75  name of the colu
+0004ec00: 6d6e 2075 7365 642e 2049 6620 6e6f 7420  mn used. If not 
+0004ec10: 7468 6520 7370 6563 7472 756d 2077 696c  the spectrum wil
+0004ec20: 6c20 6265 2069 676e 6f72 6564 2e20 5468  l be ignored. Th
+0004ec30: 6520 7370 6563 7472 756d 2077 696c 6c20  e spectrum will 
+0004ec40: 0d0a 0909 0909 6265 2069 6e74 6572 706f  ......be interpo
+0004ec50: 6c61 7465 6420 746f 2074 6865 2073 7065  lated to the spe
+0004ec60: 6374 7261 6c20 706f 696e 7473 206f 6620  ctral points of 
+0004ec70: 7468 6520 6d6f 6465 6c20 6473 2062 6566  the model ds bef
+0004ec80: 6f72 6520 7468 6520 7375 6273 7472 6163  ore the substrac
+0004ec90: 7469 6f6e 2e20 0d0a 0d0a 0909 5265 7475  tion. ......Retu
+0004eca0: 726e 730d 0a09 092d 2d2d 2d2d 2d2d 2d2d  rns....---------
+0004ecb0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a09 090d 0a09  ---------.......
+0004ecc0: 0972 6520 3a20 6469 6374 0d0a 0909 0974  .re : dict.....t
+0004ecd0: 6865 2064 6963 7469 6f6e 6172 7920 2272  he dictionary "r
+0004ece0: 6522 2061 7474 6163 6865 6420 746f 2074  e" attached to t
+0004ecf0: 6865 206f 626a 6563 7420 636f 6e74 6169  he object contai
+0004ed00: 6e69 6e67 2061 6c6c 2074 6865 206d 6174  ning all the mat
+0004ed10: 7269 7865 7320 616e 6420 7061 7261 6d65  rixes and parame
+0004ed20: 7465 722e 200d 0a09 0909 5468 6520 7573  ter. .....The us
+0004ed30: 7561 6c20 6b65 7973 2061 7265 3a0d 0a09  ual keys are:...
+0004ed40: 0909 2241 2220 5368 6170 6564 206d 6561  .."A" Shaped mea
+0004ed50: 7375 7265 6420 4d61 7472 6978 0d0a 0909  sured Matrix....
+0004ed60: 0922 4143 2220 5368 6170 6564 2063 616c  ."AC" Shaped cal
+0004ed70: 6375 6c61 7465 6420 4d61 7472 6978 200d  culated Matrix .
+0004ed80: 0a09 0909 2241 4522 2044 6966 6665 7265  ...."AE" Differe
+0004ed90: 6e63 6520 6265 7477 6565 6e20 4120 616e  nce between A an
+0004eda0: 6420 4143 203d 206c 696e 6561 7220 6572  d AC = linear er
+0004edb0: 726f 7220 0d0a 0909 0922 4441 5322 2044  ror ....."DAS" D
+0004edc0: 4153 206f 7220 5341 532c 206c 6162 656c  AS or SAS, label
+0004edd0: 6564 2061 6674 6572 2074 6865 206e 616d  ed after the nam
+0004ede0: 6573 2067 6976 656e 2069 6e20 7468 6520  es given in the 
+0004edf0: 6675 6e63 7469 6f6e 2028 7468 6520 636f  function (the co
+0004ee00: 6c75 6d6e 7320 6f66 2063 2920 4361 7265  lumns of c) Care
+0004ee10: 206d 7573 7420 6265 2074 616b 656e 2074   must be taken t
+0004ee20: 6861 7420 7468 6973 206d 6573 7572 6564  hat this mesured
+0004ee30: 2069 6e74 656e 7369 7479 2069 7320 4320   intensity is C 
+0004ee40: 2a20 4441 532c 2074 6865 2070 726f 6475  * DAS, the produ
+0004ee50: 6374 2e20 466f 7220 6578 706f 6e65 6e74  ct. For exponent
+0004ee60: 6961 6c20 6d6f 6465 6c20 7468 6520 636f  ial model the co
+0004ee70: 6e63 656e 7472 6174 696f 6e73 2061 7265  ncentrations are
+0004ee80: 206e 6f72 6d61 6c69 7a65 640d 0a09 0909   normalized.....
+0004ee90: 2263 2220 5468 6520 436f 6e63 656e 7472  "c" The Concentr
+0004eea0: 6174 696f 6e73 2028 6d65 616e 696e 6720  ations (meaning 
+0004eeb0: 7468 6520 6576 6f6c 7574 696f 6e20 6f66  the evolution of
+0004eec0: 2074 6865 2063 6f6e 6365 6e74 7261 7469   the concentrati
+0004eed0: 6f6e 7320 6f76 6572 2074 696d 652e 2043  ons over time. C
+0004eee0: 6172 6520 6d75 7374 2062 6520 7461 6b65  are must be take
+0004eef0: 6e20 7468 6174 2074 6869 7320 6d65 7375  n that this mesu
+0004ef00: 7265 6420 696e 7465 6e73 6974 7920 6973  red intensity is
+0004ef10: 2043 202a 2044 4153 2c20 7468 6520 7072   C * DAS, the pr
+0004ef20: 6f64 7563 742e 2046 6f72 2065 7870 6f6e  oduct. For expon
+0004ef30: 656e 7469 616c 206d 6f64 656c 2074 6865  ential model the
+0004ef40: 2063 6f6e 6365 6e74 7261 7469 6f6e 7320   concentrations 
+0004ef50: 6172 6520 6e6f 726d 616c 697a 6564 0d0a  are normalized..
+0004ef60: 0909 0922 6669 745f 7265 7375 6c74 735f  ..."fit_results_
+0004ef70: 7261 7465 7322 2044 6174 6146 7261 6d65  rates" DataFrame
+0004ef80: 2077 6974 6820 7468 6520 6669 7474 6564   with the fitted
+0004ef90: 2072 6174 6573 2028 616e 6420 7468 6520   rates (and the 
+0004efa0: 636f 6e66 6964 656e 6365 2069 6e74 6572  confidence inter
+0004efb0: 7661 6c73 2069 6620 6361 6c63 756c 6174  vals if calculat
+0004efc0: 6564 290d 0a09 0909 2266 6974 5f72 6573  ed)....."fit_res
+0004efd0: 756c 7473 5f74 696d 6573 2220 4461 7461  ults_times" Data
+0004efe0: 4672 616d 6520 7769 7468 2074 6865 2066  Frame with the f
+0004eff0: 6974 7465 6420 6465 6361 7920 7469 6d65  itted decay time
+0004f000: 7320 2861 6e64 2074 6865 2063 6f6e 6669  s (and the confi
+0004f010: 6465 6e63 6520 696e 7465 7276 616c 7320  dence intervals 
+0004f020: 6966 2063 616c 6375 6c61 7465 6429 0d0a  if calculated)..
+0004f030: 0909 0922 6669 745f 6f75 7470 7574 2220  ..."fit_output" 
+0004f040: 5468 6520 4669 7420 6f62 6a65 6374 2061  The Fit object a
+0004f050: 7320 7265 7475 726e 6564 2066 726f 6d20  s returned from 
+0004f060: 6c6d 6669 742e 2028 5468 6973 2069 7320  lmfit. (This is 
+0004f070: 6e6f 7420 7361 7665 6420 7769 7468 2074  not saved with t
+0004f080: 6865 2070 726f 6a65 6374 2129 0d0a 0909  he project!)....
+0004f090: 0922 6572 726f 7222 2069 7320 7468 6520  ."error" is the 
+0004f0a0: 5332 2c20 6d65 616e 696e 6720 4145 2a2a  S2, meaning AE**
+0004f0b0: 322e 7375 6d28 292e 7375 6d28 290d 0a09  2.sum().sum()...
+0004f0c0: 0909 2272 3222 3d31 2d22 6572 726f 7222  .."r2"=1-"error"
+0004f0d0: 2f28 2827 4127 2d27 4127 2e6d 6561 6e28  /(('A'-'A'.mean(
+0004f0e0: 2929 2a2a 3229 2e73 756d 2829 2c20 736f  ))**2).sum(), so
+0004f0f0: 2074 6865 2072 6573 6964 7561 6c73 2073   the residuals s
+0004f100: 6361 6c65 6420 7769 7468 2074 6865 2073  caled with the s
+0004f110: 6967 6e61 6c20 7369 7a65 0d0a 0909 0d0a  ignal size......
+0004f120: 0909 7061 725f 6669 7420 3a20 6c6d 6669  ..par_fit : lmfi
+0004f130: 7420 7061 7261 6d65 7465 7220 6f62 6a65  t parameter obje
+0004f140: 6374 0d0a 0909 0969 7320 7772 6974 7465  ct.....is writte
+0004f150: 6e20 696e 746f 2074 6865 206f 626a 6563  n into the objec
+0004f160: 7420 6173 2061 206c 6d66 6974 2070 6172  t as a lmfit par
+0004f170: 616d 6574 6572 206f 626a 6563 7420 7769  ameter object wi
+0004f180: 7468 2074 6865 206f 7074 696d 697a 6564  th the optimized
+0004f190: 2072 6573 756c 7473 2028 7468 6174 2063   results (that c
+0004f1a0: 616e 2062 6520 7573 6520 6675 7274 6865  an be use furthe
+0004f1b0: 7229 0d0a 0909 0d0a 0909 6669 7463 6f65  r)........fitcoe
+0004f1c0: 6666 203a 206c 6973 742c 2069 6620 6368  ff : list, if ch
+0004f1d0: 6972 7066 6974 2069 7320 646f 6e65 0d0a  irpfit is done..
+0004f1e0: 0909 0954 6865 2063 6869 7270 2070 6172  ...The chirp par
+0004f1f0: 616d 6574 6572 2061 7265 2075 7064 6174  ameter are updat
+0004f200: 6564 0d0a 0909 0d0a 0909 6473 203a 2044  ed........ds : D
+0004f210: 6174 6146 7261 6d65 2c20 6966 2063 6869  ataFrame, if chi
+0004f220: 7270 6669 7420 6973 2064 6f6e 650d 0a09  rpfit is done...
+0004f230: 0909 4120 6e65 7720 6473 2069 7320 6361  ..A new ds is ca
+0004f240: 6c63 756c 6174 6564 2066 6f72 6d20 6473  lculated form ds
+0004f250: 5f6f 7269 2069 6620 4368 7269 7046 6974  _ori if ChripFit
+0004f260: 2069 7320 646f 6e65 0d0a 0909 090d 0a09   is done........
+0004f270: 0954 6865 2072 6573 7420 6973 206d 6169  .The rest is mai
+0004f280: 6e6c 7920 7072 696e 7465 6420 6f6e 2073  nly printed on s
+0004f290: 6372 6565 6e2e 0d0a 0909 0d0a 0909 0d0a  creen...........
+0004f2a0: 0909 4578 616d 706c 6573 0d0a 0909 2d2d  ..Examples....--
+0004f2b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0004f2c0: 2d2d 0d0a 0909 0d0a 0909 4e6f 6e20 6f70  --........Non op
+0004f2d0: 7469 6f6e 616c 3a0d 0a09 090d 0a09 093e  tional:........>
+0004f2e0: 3e3e 2074 613d 7066 2e54 4128 2774 6573  >> ta=pf.TA('tes
+0004f2f0: 7466 696c 652e 5349 4127 2920 236c 6f61  tfile.SIA') #loa
+0004f300: 6420 6461 7461 0d0a 2009 093e 3e3e 2074  d data.. ..>>> t
+0004f310: 612e 6d6f 643d 2765 7870 6f6e 656e 7469  a.mod='exponenti
+0004f320: 616c 2720 2020 2023 6465 6669 6e65 206d  al'    #define m
+0004f330: 6f64 656c 0d0a 0909 3e3e 3e20 7461 2e70  odel....>>> ta.p
+0004f340: 6172 3d6c 6d66 6974 2e50 6172 616d 6574  ar=lmfit.Paramet
+0004f350: 6572 7328 2920 2023 6372 6561 7465 2065  ers()  #create e
+0004f360: 6d70 7479 2070 6172 616d 6574 6572 206f  mpty parameter o
+0004f370: 626a 6563 740d 0a09 093e 3e3e 2074 612e  bject....>>> ta.
+0004f380: 7061 722e 6164 6428 276b 3027 2c76 616c  par.add('k0',val
+0004f390: 7565 3d31 2f30 2e31 2c76 6172 793d 5472  ue=1/0.1,vary=Tr
+0004f3a0: 7565 2920 2361 6464 2061 7420 6c65 6173  ue) #add at leas
+0004f3b0: 7420 6f6e 6520 7061 7261 6d65 7465 7220  t one parameter 
+0004f3c0: 746f 206f 7074 696d 697a 650d 0a09 0920  to optimize.... 
+0004f3d0: 200d 0a09 0954 7269 6767 6572 2073 696d   ....Trigger sim
+0004f3e0: 706c 6520 6669 743a 0d0a 0909 0d0a 0909  ple fit:........
+0004f3f0: 3e3e 3e20 7461 2e46 6974 5f47 6c6f 6261  >>> ta.Fit_Globa
+0004f400: 6c28 290d 0a09 090d 0a09 0954 7269 6767  l()........Trigg
+0004f410: 6572 2066 6974 2077 6974 6820 4368 7269  er fit with Chri
+0004f420: 7020 4669 743a 0d0a 0909 0d0a 0909 3e3e  p Fit:........>>
+0004f430: 3e20 7461 2e46 6974 5f47 6c6f 6261 6c28  > ta.Fit_Global(
+0004f440: 6669 745f 6368 6972 703d 5472 7565 290d  fit_chirp=True).
+0004f450: 0a09 090d 0a09 0954 7269 6767 6572 2069  .......Trigger i
+0004f460: 7465 7261 7469 7665 2043 6869 7270 2066  terative Chirp f
+0004f470: 6974 7469 6e67 2077 6974 6820 6672 6573  itting with fres
+0004f480: 6820 7265 6669 6e65 6d65 6e74 206f 6620  h refinement of 
+0004f490: 7468 6520 476c 6f62 616c 206b 696e 6574  the Global kinet
+0004f4a0: 6963 2070 6172 616d 6574 6572 7366 6f72  ic parametersfor
+0004f4b0: 2069 2069 6e20 7261 6e67 6528 3529 3a0d   i in range(5):.
+0004f4c0: 0a09 090d 0a09 093e 3e3e 2066 6f72 2069  .......>>> for i
+0004f4d0: 2069 6e20 7261 6e67 6528 3529 3a0d 0a09   in range(5):...
+0004f4e0: 093e 3e3e 2009 7374 6172 745f 6572 726f  .>>> .start_erro
+0004f4f0: 723d 7461 2e72 655b 2765 7272 6f72 275d  r=ta.re['error']
+0004f500: 0d0a 0909 3e3e 3e20 0974 612e 7061 723d  ....>>> .ta.par=
+0004f510: 7461 2e70 6172 5f66 6974 0d0a 0909 3e3e  ta.par_fit....>>
+0004f520: 3e20 0974 612e 4669 745f 476c 6f62 616c  > .ta.Fit_Global
+0004f530: 2866 6974 5f63 6869 7270 3d54 7275 6529  (fit_chirp=True)
+0004f540: 0d0a 0909 3e3e 3e20 0969 6620 6e6f 7420  ....>>> .if not 
+0004f550: 7461 2e72 655b 2765 7272 6f72 275d 203c  ta.re['error'] <
+0004f560: 2073 7461 7274 5f65 7272 6f72 3a62 7265   start_error:bre
+0004f570: 616b 0d0a 0909 0d0a 0909 5472 6967 6765  ak........Trigge
+0004f580: 7220 6669 7420 6669 7420 6572 726f 7220  r fit fit error 
+0004f590: 6361 6c63 756c 6174 696f 6e73 0d0a 0909  calculations....
+0004f5a0: 0d0a 0909 3e3e 3e20 7461 2e46 6974 5f47  ....>>> ta.Fit_G
+0004f5b0: 6c6f 6261 6c28 636f 6e66 6964 656e 6365  lobal(confidence
+0004f5c0: 5f6c 6576 656c 3d30 2e36 3629 0d0a 0909  _level=0.66)....
+0004f5d0: 0d0a 0909 5472 6967 6765 7220 6669 7420  ....Trigger fit 
+0004f5e0: 6f66 206d 756c 7469 706c 6520 7072 6f6a  of multiple proj
+0004f5f0: 6563 7473 0d0a 0909 2375 7365 2074 6865  ects....#use the
+0004f600: 2047 5549 5f6f 7065 6e20 6675 6e63 7469   GUI_open functi
+0004f610: 6f6e 2074 6f20 6f70 656e 2061 206c 6973  on to open a lis
+0004f620: 7420 6f66 206f 626a 6563 7473 2028 6c65  t of objects (le
+0004f630: 6176 6520 656d 7074 7920 666f 7220 7573  ave empty for us
+0004f640: 696e 6720 7468 6520 4755 4929 0d0a 0909  ing the GUI)....
+0004f650: 0d0a 0909 3e3e 3e20 6f74 6865 725f 7072  ....>>> other_pr
+0004f660: 6f6a 6563 7473 3d70 662e 4755 495f 6f70  ojects=pf.GUI_op
+0004f670: 656e 285b 2773 616d 706c 655f 312e 6864  en(['sample_1.hd
+0004f680: 6635 272c 2773 616d 706c 655f 322e 6864  f5','sample_2.hd
+0004f690: 6635 275d 2c70 6174 683d 2744 6174 6127  f5'],path='Data'
+0004f6a0: 290d 0a09 093e 3e3e 2074 612e 4669 745f  )....>>> ta.Fit_
+0004f6b0: 476c 6f62 616c 286d 756c 7469 5f70 726f  Global(multi_pro
+0004f6c0: 6a65 6374 3d6f 7468 6572 5f70 726f 6a65  ject=other_proje
+0004f6d0: 6374 7329 0d0a 0909 0d0a 0909 0d0a 0909  cts)............
+0004f6e0: 466f 7220 6d6f 7265 2065 7861 6d70 6c65  For more example
+0004f6f0: 7320 706c 6561 7365 2073 6565 2074 6865  s please see the
+0004f700: 2063 6f6d 706c 6574 6520 646f 6375 6d65   complete docume
+0004f710: 6e74 6174 696f 6e20 756e 6465 7220 3a72  ntation under :r
+0004f720: 6566 3a60 4669 7474 696e 672c 2050 6172  ef:`Fitting, Par
+0004f730: 616d 6574 6572 206f 7074 696d 697a 6174  ameter optimizat
+0004f740: 696f 6e20 616e 6420 4572 726f 7220 6573  ion and Error es
+0004f750: 7469 6d61 7469 6f6e 600d 0a09 096f 7220  timation`....or 
+0004f760: 3a72 6566 3a60 4669 7474 696e 6720 6d75  :ref:`Fitting mu
+0004f770: 6c74 6970 6c65 206d 6561 7375 7265 6420  ltiple measured 
+0004f780: 6669 6c65 7320 6174 206f 6e63 6560 0d0a  files at once`..
+0004f790: 0909 2222 220d 0a0d 0a09 0969 6620 7061  .."""......if pa
+0004f7a0: 7220 6973 204e 6f6e 653a 7061 723d 7365  r is None:par=se
+0004f7b0: 6c66 2e70 6172 0d0a 0909 6966 206d 6f64  lf.par....if mod
+0004f7c0: 2069 7320 4e6f 6e65 3a6d 6f64 3d73 656c   is None:mod=sel
+0004f7d0: 662e 6d6f 640d 0a09 0974 7279 3a0d 0a09  f.mod....try:...
+0004f7e0: 0909 7430 3d70 6172 5b27 7430 275d 0d0a  ..t0=par['t0']..
+0004f7f0: 0909 6578 6365 7074 3a0d 0a09 0909 7472  ..except:.....tr
+0004f800: 793a 0d0a 0909 0909 7061 722e 6164 6428  y:......par.add(
+0004f810: 2774 3027 2c76 616c 7565 3d30 2c6d 696e  't0',value=0,min
+0004f820: 3d2d 302e 352c 6d61 783d 302e 352c 7661  =-0.5,max=0.5,va
+0004f830: 7279 3d46 616c 7365 290d 0a09 0909 6578  ry=False).....ex
+0004f840: 6365 7074 3a0d 0a09 0909 0970 7269 6e74  cept:......print
+0004f850: 2822 556e 6578 7065 6374 6564 2065 7272  ("Unexpected err
+0004f860: 6f72 3a22 2c20 7379 732e 6578 635f 696e  or:", sys.exc_in
+0004f870: 666f 2829 5b30 5d29 0d0a 0909 7472 793a  fo()[0])....try:
+0004f880: 0d0a 0909 0972 6573 6f6c 7574 696f 6e3d  .....resolution=
+0004f890: 7061 725b 2772 6573 6f6c 7574 696f 6e27  par['resolution'
+0004f8a0: 5d0d 0a09 0965 7863 6570 743a 0d0a 0909  ]....except:....
+0004f8b0: 0974 7279 3a0d 0a09 0909 0970 6172 2e61  .try:......par.a
+0004f8c0: 6464 2827 7265 736f 6c75 7469 6f6e 272c  dd('resolution',
+0004f8d0: 7661 6c75 653d 302e 3038 362c 6d69 6e3d  value=0.086,min=
+0004f8e0: 302e 3034 2c6d 6178 3d30 2e35 2c76 6172  0.04,max=0.5,var
+0004f8f0: 793d 4661 6c73 6529 0d0a 0909 0965 7863  y=False).....exc
+0004f900: 6570 743a 0d0a 0909 0909 7072 696e 7428  ept:......print(
+0004f910: 2255 6e65 7870 6563 7465 6420 6572 726f  "Unexpected erro
+0004f920: 723a 222c 2073 7973 2e65 7863 5f69 6e66  r:", sys.exc_inf
+0004f930: 6f28 295b 305d 290d 0a09 0974 7279 3a0d  o()[0])....try:.
+0004f940: 0a09 0909 7061 725b 2769 6e66 696e 6974  ....par['infinit
+0004f950: 6527 5d2e 7661 6c75 653d 310d 0a09 0909  e'].value=1.....
+0004f960: 7061 725b 2769 6e66 696e 6974 6527 5d2e  par['infinite'].
+0004f970: 7661 7279 3d46 616c 7365 0d0a 0909 6578  vary=False....ex
+0004f980: 6365 7074 3a0d 0a09 0909 7061 7373 0d0a  cept:.....pass..
+0004f990: 0909 7472 793a 0d0a 0909 0970 6172 5b27  ..try:.....par['
+0004f9a0: 6261 636b 6772 6f75 6e64 275d 2e76 616c  background'].val
+0004f9b0: 7565 3d31 0d0a 0909 0970 6172 5b27 6261  ue=1.....par['ba
+0004f9c0: 636b 6772 6f75 6e64 275d 2e76 6172 793d  ckground'].vary=
+0004f9d0: 4661 6c73 650d 0a09 0965 7863 6570 743a  False....except:
+0004f9e0: 0d0a 0909 0970 6173 730d 0a09 0974 7279  .....pass....try
+0004f9f0: 3a20 2320 7468 6973 2069 7320 6569 7468  : # this is eith
+0004fa00: 6572 2066 7265 657a 696e 6720 6f72 2065  er freezing or e
+0004fa10: 6e61 626c 696e 6720 7468 6520 7265 2d6f  nabling the re-o
+0004fa20: 7074 696d 697a 6174 696f 6e20 6f66 2061  ptimization of a
+0004fa30: 6c6c 206f 7468 6572 2070 6172 616d 6574  ll other paramet
+0004fa40: 6572 2064 7572 696e 6720 636f 6e66 6964  er during confid
+0004fa50: 656e 6365 2069 6e74 6572 7661 6c20 6361  ence interval ca
+0004fa60: 6c63 756c 6174 696f 6e0d 0a09 0909 7061  lculation.....pa
+0004fa70: 725b 2765 7272 6f72 5f70 6172 616d 5f66  r['error_param_f
+0004fa80: 6978 275d 2e76 616c 7565 3d31 0d0a 0909  ix'].value=1....
+0004fa90: 0970 6172 5b27 6572 726f 725f 7061 7261  .par['error_para
+0004faa0: 6d5f 6669 7827 5d2e 7661 7279 3d46 616c  m_fix'].vary=Fal
+0004fab0: 7365 0d0a 0909 0976 6172 795f 6572 726f  se.....vary_erro
+0004fac0: 725f 7061 7261 6d65 7465 723d 4661 6c73  r_parameter=Fals
+0004fad0: 650d 0a09 0965 7863 6570 743a 0d0a 0909  e....except:....
+0004fae0: 0976 6172 795f 6572 726f 725f 7061 7261  .vary_error_para
+0004faf0: 6d65 7465 723d 5472 7565 0d0a 0909 0d0a  meter=True......
+0004fb00: 0909 7061 7264 663d 7061 725f 746f 5f70  ..pardf=par_to_p
+0004fb10: 6172 6466 2870 6172 290d 0a09 0970 6172  ardf(par)....par
+0004fb20: 6466 2e6c 6f63 5b6e 702e 6c6f 6769 6361  df.loc[np.logica
+0004fb30: 6c5f 616e 6428 7061 7264 662e 6c6f 635b  l_and(pardf.loc[
+0004fb40: 3a2c 276d 696e 275d 2e76 616c 7565 733c  :,'min'].values<
+0004fb50: 302c 7061 7264 662e 6973 5f72 6174 6529  0,pardf.is_rate)
+0004fb60: 2c27 6d69 6e27 5d3d 300d 0a09 0970 6172  ,'min']=0....par
+0004fb70: 6466 2e6c 6f63 5b6e 702e 6c6f 6769 6361  df.loc[np.logica
+0004fb80: 6c5f 616e 6428 7061 7264 662e 6c6f 635b  l_and(pardf.loc[
+0004fb90: 3a2c 276d 6178 275d 2e76 616c 7565 733c  :,'max'].values<
+0004fba0: 302c 7061 7264 662e 6973 5f72 6174 6529  0,pardf.is_rate)
+0004fbb0: 2c27 6d61 7827 5d3d 300d 0a0d 0a09 0970  ,'max']=0......p
+0004fbc0: 6172 6466 5b27 696e 6974 5f76 616c 7565  ardf['init_value
+0004fbd0: 275d 3d70 6172 6466 5b27 7661 6c75 6527  ']=pardf['value'
+0004fbe0: 5d0d 0a09 0969 6620 6475 6d70 5f70 6172  ]....if dump_par
+0004fbf0: 6173 3a0d 0a09 0909 7061 7264 665f 7465  as:.....pardf_te
+0004fc00: 6d70 3d70 6172 6466 2e63 6f70 7928 290d  mp=pardf.copy().
+0004fc10: 0a09 0909 7061 7264 665f 7465 6d70 2e6c  ....pardf_temp.l
+0004fc20: 6f63 5b27 6572 726f 7227 2c27 7661 6c75  oc['error','valu
+0004fc30: 6527 5d3d 3130 3030 0d0a 0909 0970 6172  e']=1000.....par
+0004fc40: 6466 5f74 656d 702e 746f 5f63 7376 2827  df_temp.to_csv('
+0004fc50: 6d69 6e69 6d61 6c5f 6475 6d70 5f70 6172  minimal_dump_par
+0004fc60: 6173 2e70 6172 2729 0d0a 090d 0a09 0969  as.par').......i
+0004fc70: 6620 7365 6c66 2e6c 6f67 5f66 6974 3a0d  f self.log_fit:.
+0004fc80: 0a09 0909 666f 7220 6b65 7920 696e 205b  ....for key in [
+0004fc90: 2776 616c 7565 272c 276d 696e 272c 276d  'value','min','m
+0004fca0: 6178 275d 3a0d 0a09 0909 0970 6172 6466  ax']:......pardf
+0004fcb0: 2e6c 6f63 5b70 6172 6466 2e69 735f 7261  .loc[pardf.is_ra
+0004fcc0: 7465 2c6b 6579 5d3d 7061 7264 662e 6c6f  te,key]=pardf.lo
+0004fcd0: 635b 7061 7264 662e 6973 5f72 6174 652c  c[pardf.is_rate,
+0004fce0: 6b65 795d 2e61 7070 6c79 286c 616d 6264  key].apply(lambd
+0004fcf0: 6120 783a 206e 702e 6c6f 6731 3028 7829  a x: np.log10(x)
+0004fd00: 2909 0d0a 0909 0d0a 0909 2363 7265 6174  ).........#creat
+0004fd10: 652d 7368 6170 6520 7468 6520 6461 7461  e-shape the data
+0004fd20: 2074 6f20 6265 2066 6974 7465 6409 0d0a   to be fitted...
+0004fd30: 0909 6669 745f 6473 203d 2073 7562 5f64  ..fit_ds = sub_d
+0004fd40: 7328 6473 203d 2073 656c 662e 6473 2e63  s(ds = self.ds.c
+0004fd50: 6f70 7928 292c 2073 6361 7474 6572 6375  opy(), scattercu
+0004fd60: 7420 3d20 7365 6c66 2e73 6361 7474 6572  t = self.scatter
+0004fd70: 6375 742c 2062 6f72 6465 7263 7574 203d  cut, bordercut =
+0004fd80: 2073 656c 662e 626f 7264 6572 6375 742c   self.bordercut,
+0004fd90: 200d 0a09 0909 0909 0974 696d 656c 696d   ........timelim
+0004fda0: 6974 7320 3d20 7365 6c66 2e74 696d 656c  its = self.timel
+0004fdb0: 696d 6974 732c 2077 6176 655f 6e6d 5f62  imits, wave_nm_b
+0004fdc0: 696e 203d 2073 656c 662e 7761 7665 5f6e  in = self.wave_n
+0004fdd0: 6d5f 6269 6e2c 2065 7175 616c 5f65 6e65  m_bin, equal_ene
+0004fde0: 7267 795f 6269 6e20 3d20 7365 6c66 2e65  rgy_bin = self.e
+0004fdf0: 7175 616c 5f65 6e65 7267 795f 6269 6e2c  qual_energy_bin,
+0004fe00: 200d 0a09 0909 0909 0974 696d 655f 6269   ........time_bi
+0004fe10: 6e20 3d20 7365 6c66 2e74 696d 655f 6269  n = self.time_bi
+0004fe20: 6e2c 2069 676e 6f72 655f 7469 6d65 5f72  n, ignore_time_r
+0004fe30: 6567 696f 6e20 3d20 7365 6c66 2e69 676e  egion = self.ign
+0004fe40: 6f72 655f 7469 6d65 5f72 6567 696f 6e2c  ore_time_region,
+0004fe50: 2064 726f 705f 7363 6174 7465 7220 3d20   drop_scatter = 
+0004fe60: 5472 7565 2c20 6472 6f70 5f69 676e 6f72  True, drop_ignor
+0004fe70: 6520 3d20 5472 7565 290d 0a09 0974 696d  e = True)....tim
+0004fe80: 655f 6c61 6265 6c3d 6669 745f 6473 2e69  e_label=fit_ds.i
+0004fe90: 6e64 6578 2e6e 616d 650d 0a09 0965 6e65  ndex.name....ene
+0004fea0: 7267 795f 6c61 6265 6c3d 6669 745f 6473  rgy_label=fit_ds
+0004feb0: 2e63 6f6c 756d 6e73 2e6e 616d 650d 0a09  .columns.name...
+0004fec0: 090d 0a09 0923 2323 2323 2323 2323 2323  .....###########
 0004fed0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004fee0: 2323 230d 0a09 0923 2d2d 2d2d 476c 6f62  ###....#----Glob
-0004fef0: 616c 206f 7074 696d 6973 6174 696f 6e2d  al optimisation-
-0004ff00: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0004ff10: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0004ff20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0004ff30: 2d2d 2d2d 2d0d 0a09 0923 2323 2323 2323  -----....#######
-0004ff40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004ff50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004ff60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004fee0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004fef0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004ff00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004ff10: 230d 0a09 0923 2d2d 2d2d 476c 6f62 616c  #....#----Global
+0004ff20: 206f 7074 696d 6973 6174 696f 6e2d 2d2d   optimisation---
+0004ff30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0004ff40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0004ff50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0004ff60: 2d2d 2d0d 0a09 0923 2323 2323 2323 2323  ---....#########
 0004ff70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-0004ff80: 2323 2323 230d 0a09 090d 0a09 0969 6620  #####........if 
-0004ff90: 6d75 6c74 695f 7072 6f6a 6563 7420 6973  multi_project is
-0004ffa0: 204e 6f6e 653a 0d0a 0909 0923 6368 6563   None:.....#chec
-0004ffb0: 6b20 6966 2074 6865 7265 2069 7320 616e  k if there is an
-0004ffc0: 7920 636f 6e63 656e 7472 6174 696f 6e20  y concentration 
-0004ffd0: 746f 206f 7074 696d 6973 650d 0a09 0909  to optimise.....
-0004ffe0: 6966 2028 6669 6c65 6e61 6d65 2069 7320  if (filename is 
-0004fff0: 4e6f 6e65 2920 616e 6420 6475 6d70 5f73  None) and dump_s
-00050000: 6861 7065 733a 2066 696c 656e 616d 6520  hapes: filename 
-00050010: 3d20 7365 6c66 2e66 696c 656e 616d 650d  = self.filename.
-00050020: 0a09 0909 6966 2070 6172 6466 2e76 6172  ....if pardf.var
-00050030: 792e 616e 7928 293a 236f 6b20 7765 2068  y.any():#ok we h
-00050040: 6176 6520 736f 6d65 7468 696e 6720 746f  ave something to
-00050050: 206f 7074 696d 697a 650d 0a09 0909 096d   optimize......m
-00050060: 696e 6920 3d20 6c6d 6669 742e 4d69 6e69  ini = lmfit.Mini
-00050070: 6d69 7a65 7228 6572 725f 6675 6e63 2c70  mizer(err_func,p
-00050080: 6172 6466 5f74 6f5f 7061 7228 7061 7264  ardf_to_par(pard
-00050090: 6629 2c0d 0a09 0909 0909 0909 0909 0966  f),............f
-000500a0: 636e 5f6b 7773 3d7b 2764 7327 3a66 6974  cn_kws={'ds':fit
-000500b0: 5f64 732c 276d 6f64 273a 6d6f 642c 276c  _ds,'mod':mod,'l
-000500c0: 6f67 5f66 6974 273a 7365 6c66 2e6c 6f67  og_fit':self.log
-000500d0: 5f66 6974 2c27 6669 6e61 6c27 3a46 616c  _fit,'final':Fal
-000500e0: 7365 2c0d 0a09 0909 0909 0909 0909 0909  se,.............
-000500f0: 0927 6475 6d70 5f70 6172 6173 273a 6475  .'dump_paras':du
-00050100: 6d70 5f70 6172 6173 2c27 6669 6c65 6e61  mp_paras,'filena
-00050110: 6d65 273a 6669 6c65 6e61 6d65 2c27 6578  me':filename,'ex
-00050120: 745f 7370 6563 7472 6127 3a65 7874 5f73  t_spectra':ext_s
-00050130: 7065 6374 7261 2c0d 0a09 0909 0909 0909  pectra,.........
-00050140: 0909 0909 0927 6475 6d70 5f73 6861 7065  .....'dump_shape
-00050150: 7327 3a64 756d 705f 7368 6170 6573 7d29  s':dump_shapes})
-00050160: 0d0a 0909 0909 6966 206e 6f74 2075 7365  ......if not use
-00050170: 5f61 6d70 676f 3a0d 0a09 0909 0909 6966  _ampgo:.......if
-00050180: 206c 656e 2870 6172 6466 5b70 6172 6466   len(pardf[pardf
-00050190: 2e76 6172 795d 2e69 6e64 6578 293e 333a  .vary].index)>3:
-000501a0: 0d0a 0909 0909 0909 7072 696e 7428 2777  ........print('w
-000501b0: 6520 7573 6520 6164 6170 7469 7665 206d  e use adaptive m
-000501c0: 6f64 6520 666f 7220 6e65 6c64 6572 2729  ode for nelder')
-000501d0: 0d0a 0909 0909 0909 7265 7375 6c74 7320  ........results 
-000501e0: 3d20 6d69 6e69 2e6d 696e 696d 697a 6528  = mini.minimize(
-000501f0: 276e 656c 6465 7227 2c6f 7074 696f 6e73  'nelder',options
-00050200: 3d7b 276d 6178 6974 6572 273a 3165 352c  ={'maxiter':1e5,
-00050210: 2761 6461 7074 6976 6527 3a54 7275 657d  'adaptive':True}
-00050220: 290d 0a09 0909 0909 656c 7365 3a0d 0a09  ).......else:...
-00050230: 0909 0909 0972 6573 756c 7473 203d 206d  .....results = m
-00050240: 696e 692e 6d69 6e69 6d69 7a65 2827 6e65  ini.minimize('ne
-00050250: 6c64 6572 272c 6f70 7469 6f6e 733d 7b27  lder',options={'
-00050260: 6d61 7869 7465 7227 3a31 6535 7d29 0d0a  maxiter':1e5})..
-00050270: 0909 0909 656c 7365 3a0d 0a09 0909 0909  ....else:.......
-00050280: 7265 7375 6c74 7320 3d20 6d69 6e69 2e6d  results = mini.m
-00050290: 696e 696d 697a 6528 2761 6d70 676f 272c  inimize('ampgo',
-000502a0: 2a2a 7b27 6c6f 6361 6c27 3a27 4e65 6c64  **{'local':'Neld
-000502b0: 6572 2d4d 6561 6427 7d29 0d0a 0909 0909  er-Mead'})......
-000502c0: 090d 0a09 0923 2323 2323 2323 2323 2323  .....###########
-000502d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000502e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000502f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004ff80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004ff90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004ffa0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+0004ffb0: 2323 230d 0a09 090d 0a09 0969 6620 6d75  ###........if mu
+0004ffc0: 6c74 695f 7072 6f6a 6563 7420 6973 204e  lti_project is N
+0004ffd0: 6f6e 653a 0d0a 0909 0923 6368 6563 6b20  one:.....#check 
+0004ffe0: 6966 2074 6865 7265 2069 7320 616e 7920  if there is any 
+0004fff0: 636f 6e63 656e 7472 6174 696f 6e20 746f  concentration to
+00050000: 206f 7074 696d 6973 650d 0a09 0909 6966   optimise.....if
+00050010: 2028 6669 6c65 6e61 6d65 2069 7320 4e6f   (filename is No
+00050020: 6e65 2920 616e 6420 6475 6d70 5f73 6861  ne) and dump_sha
+00050030: 7065 733a 2066 696c 656e 616d 6520 3d20  pes: filename = 
+00050040: 7365 6c66 2e66 696c 656e 616d 650d 0a09  self.filename...
+00050050: 0909 6966 2070 6172 6466 2e76 6172 792e  ..if pardf.vary.
+00050060: 616e 7928 293a 236f 6b20 7765 2068 6176  any():#ok we hav
+00050070: 6520 736f 6d65 7468 696e 6720 746f 206f  e something to o
+00050080: 7074 696d 697a 650d 0a09 0909 096d 696e  ptimize......min
+00050090: 6920 3d20 6c6d 6669 742e 4d69 6e69 6d69  i = lmfit.Minimi
+000500a0: 7a65 7228 6572 725f 6675 6e63 2c70 6172  zer(err_func,par
+000500b0: 6466 5f74 6f5f 7061 7228 7061 7264 6629  df_to_par(pardf)
+000500c0: 2c0d 0a09 0909 0909 0909 0909 0966 636e  ,............fcn
+000500d0: 5f6b 7773 3d7b 2764 7327 3a66 6974 5f64  _kws={'ds':fit_d
+000500e0: 732c 276d 6f64 273a 6d6f 642c 276c 6f67  s,'mod':mod,'log
+000500f0: 5f66 6974 273a 7365 6c66 2e6c 6f67 5f66  _fit':self.log_f
+00050100: 6974 2c27 6669 6e61 6c27 3a46 616c 7365  it,'final':False
+00050110: 2c0d 0a09 0909 0909 0909 0909 0909 0927  ,..............'
+00050120: 6475 6d70 5f70 6172 6173 273a 6475 6d70  dump_paras':dump
+00050130: 5f70 6172 6173 2c27 6669 6c65 6e61 6d65  _paras,'filename
+00050140: 273a 6669 6c65 6e61 6d65 2c27 6578 745f  ':filename,'ext_
+00050150: 7370 6563 7472 6127 3a65 7874 5f73 7065  spectra':ext_spe
+00050160: 6374 7261 2c0d 0a09 0909 0909 0909 0909  ctra,...........
+00050170: 0909 0927 6475 6d70 5f73 6861 7065 7327  ...'dump_shapes'
+00050180: 3a64 756d 705f 7368 6170 6573 7d29 0d0a  :dump_shapes})..
+00050190: 0909 0909 6966 206e 6f74 2075 7365 5f61  ....if not use_a
+000501a0: 6d70 676f 3a0d 0a09 0909 0909 6966 206c  mpgo:.......if l
+000501b0: 656e 2870 6172 6466 5b70 6172 6466 2e76  en(pardf[pardf.v
+000501c0: 6172 795d 2e69 6e64 6578 293e 333a 0d0a  ary].index)>3:..
+000501d0: 0909 0909 0909 7072 696e 7428 2777 6520  ......print('we 
+000501e0: 7573 6520 6164 6170 7469 7665 206d 6f64  use adaptive mod
+000501f0: 6520 666f 7220 6e65 6c64 6572 2729 0d0a  e for nelder')..
+00050200: 0909 0909 0909 7265 7375 6c74 7320 3d20  ......results = 
+00050210: 6d69 6e69 2e6d 696e 696d 697a 6528 276e  mini.minimize('n
+00050220: 656c 6465 7227 2c6f 7074 696f 6e73 3d7b  elder',options={
+00050230: 276d 6178 6974 6572 273a 3165 352c 2761  'maxiter':1e5,'a
+00050240: 6461 7074 6976 6527 3a54 7275 657d 290d  daptive':True}).
+00050250: 0a09 0909 0909 656c 7365 3a0d 0a09 0909  ......else:.....
+00050260: 0909 0972 6573 756c 7473 203d 206d 696e  ...results = min
+00050270: 692e 6d69 6e69 6d69 7a65 2827 6e65 6c64  i.minimize('neld
+00050280: 6572 272c 6f70 7469 6f6e 733d 7b27 6d61  er',options={'ma
+00050290: 7869 7465 7227 3a31 6535 7d29 0d0a 0909  xiter':1e5})....
+000502a0: 0909 656c 7365 3a0d 0a09 0909 0909 7265  ..else:.......re
+000502b0: 7375 6c74 7320 3d20 6d69 6e69 2e6d 696e  sults = mini.min
+000502c0: 696d 697a 6528 2761 6d70 676f 272c 2a2a  imize('ampgo',**
+000502d0: 7b27 6c6f 6361 6c27 3a27 4e65 6c64 6572  {'local':'Nelder
+000502e0: 2d4d 6561 6427 7d29 0d0a 0909 0909 090d  -Mead'})........
+000502f0: 0a09 0923 2323 2323 2323 2323 2323 2323  ...#############
 00050300: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00050310: 230d 0a09 0923 2d2d 2d2d 4d75 6c74 6920  #....#----Multi 
-00050320: 7072 6f6a 6563 7409 476c 6f62 616c 206f  project.Global o
-00050330: 7074 696d 6973 6174 696f 6e2d 2d2d 2d2d  ptimisation-----
-00050340: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00050350: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00050360: 2d2d 2d0d 0a09 0923 2323 2323 2323 2323  ---....#########
-00050370: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00050380: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00050390: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00050310: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00050320: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00050330: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
+00050340: 0a09 0923 2d2d 2d2d 4d75 6c74 6920 7072  ...#----Multi pr
+00050350: 6f6a 6563 7409 476c 6f62 616c 206f 7074  oject.Global opt
+00050360: 696d 6973 6174 696f 6e2d 2d2d 2d2d 2d2d  imisation-------
+00050370: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00050380: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00050390: 2d0d 0a09 0923 2323 2323 2323 2323 2323  -....###########
 000503a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000503b0: 230d 0a09 090d 0a09 0965 6c73 653a 0d0a  #........else:..
-000503c0: 0909 0966 6974 5f63 6869 7270 3d46 616c  ...fit_chirp=Fal
-000503d0: 7365 2023 6368 6972 7020 6669 7474 696e  se #chirp fittin
-000503e0: 6720 6375 7272 656e 746c 7920 6f6e 6c79  g currently only
-000503f0: 2077 6f72 6b73 2066 6f72 2073 696e 676c   works for singl
-00050400: 6520 7072 6f62 6c65 6d73 0d0a 0909 0969  e problems.....i
-00050410: 6620 7061 7264 662e 7661 7279 2e61 6e79  f pardf.vary.any
-00050420: 2829 3a23 6f6b 2077 6520 6861 7665 2073  ():#ok we have s
-00050430: 6f6d 6574 6869 6e67 2074 6f20 6f70 7469  omething to opti
-00050440: 6d69 7a65 206c 6574 7320 7265 7475 726e  mize lets return
-00050450: 2074 6865 2073 7065 6374 7261 0d0a 0909   the spectra....
-00050460: 0909 6d75 6c74 695f 7072 6f6a 6563 742e  ..multi_project.
-00050470: 696e 7365 7274 2830 2c73 656c 6629 0d0a  insert(0,self)..
-00050480: 0909 0909 6d69 6e69 203d 206c 6d66 6974  ....mini = lmfit
-00050490: 2e4d 696e 696d 697a 6572 2865 7272 5f66  .Minimizer(err_f
-000504a0: 756e 635f 6d75 6c74 692c 7061 7264 665f  unc_multi,pardf_
-000504b0: 746f 5f70 6172 2870 6172 6466 292c 6663  to_par(pardf),fc
-000504c0: 6e5f 6b77 733d 7b27 6d75 6c74 695f 7072  n_kws={'multi_pr
-000504d0: 6f6a 6563 7427 3a6d 756c 7469 5f70 726f  oject':multi_pro
-000504e0: 6a65 6374 2c27 756e 6971 7565 5f70 6172  ject,'unique_par
-000504f0: 616d 6574 6572 273a 756e 6971 7565 5f70  ameter':unique_p
-00050500: 6172 616d 6574 6572 2c0d 0a09 0909 0909  arameter,.......
-00050510: 0909 0909 0909 0909 0909 0909 0909 0909  ................
-00050520: 2777 6569 6768 7473 273a 7765 6967 6874  'weights':weight
-00050530: 732c 276d 6f64 273a 6d6f 642c 276c 6f67  s,'mod':mod,'log
-00050540: 5f66 6974 273a 7365 6c66 2e6c 6f67 5f66  _fit':self.log_f
-00050550: 6974 2c27 6669 6e61 6c27 3a46 616c 7365  it,'final':False
-00050560: 2c0d 0a09 0909 0909 0909 0909 0909 0909  ,...............
-00050570: 0909 0909 0909 0909 2764 756d 705f 7061  ........'dump_pa
-00050580: 7261 7327 3a64 756d 705f 7061 7261 732c  ras':dump_paras,
-00050590: 2766 696c 656e 616d 6527 3a66 696c 656e  'filename':filen
-000505a0: 616d 652c 2765 7874 5f73 7065 6374 7261  ame,'ext_spectra
-000505b0: 273a 6578 745f 7370 6563 7472 612c 0d0a  ':ext_spectra,..
-000505c0: 0909 0909 0909 0909 0909 0909 0909 0909  ................
-000505d0: 0909 0909 0927 6475 6d70 5f73 6861 7065  .....'dump_shape
-000505e0: 7327 3a64 756d 705f 7368 6170 6573 2c27  s':dump_shapes,'
-000505f0: 7361 6d65 5f44 4153 273a 7361 6d65 5f44  same_DAS':same_D
-00050600: 4153 7d29 0d0a 0909 0909 6966 206c 656e  AS})......if len
-00050610: 2870 6172 6466 5b70 6172 6466 2e76 6172  (pardf[pardf.var
-00050620: 795d 2e69 6e64 6578 293e 333a 0d0a 0909  y].index)>3:....
-00050630: 0909 0970 7269 6e74 2827 7765 2075 7365  ...print('we use
-00050640: 2061 6461 7074 6976 6520 6d6f 6465 2066   adaptive mode f
-00050650: 6f72 206e 656c 6465 7227 290d 0a09 0909  or nelder').....
-00050660: 0909 7265 7375 6c74 7320 3d20 6d69 6e69  ..results = mini
-00050670: 2e6d 696e 696d 697a 6528 276e 656c 6465  .minimize('nelde
-00050680: 7227 2c6f 7074 696f 6e73 3d7b 276d 6178  r',options={'max
-00050690: 6974 6572 273a 3165 352c 2761 6461 7074  iter':1e5,'adapt
-000506a0: 6976 6527 3a54 7275 657d 290d 0a09 0909  ive':True}).....
-000506b0: 0965 6c73 653a 0d0a 0909 0909 0972 6573  .else:.......res
-000506c0: 756c 7473 203d 206d 696e 692e 6d69 6e69  ults = mini.mini
-000506d0: 6d69 7a65 2827 6e65 6c64 6572 272c 6f70  mize('nelder',op
-000506e0: 7469 6f6e 733d 7b27 6d61 7869 7465 7227  tions={'maxiter'
-000506f0: 3a31 6535 7d29 0d0a 0909 0909 090d 0a09  :1e5})..........
-00050700: 0923 2323 2323 2323 2323 2323 2323 2323  .###############
-00050710: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00050720: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000503b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000503c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000503d0: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
+000503e0: 0a09 090d 0a09 0965 6c73 653a 0d0a 0909  .......else:....
+000503f0: 0966 6974 5f63 6869 7270 3d46 616c 7365  .fit_chirp=False
+00050400: 2023 6368 6972 7020 6669 7474 696e 6720   #chirp fitting 
+00050410: 6375 7272 656e 746c 7920 6f6e 6c79 2077  currently only w
+00050420: 6f72 6b73 2066 6f72 2073 696e 676c 6520  orks for single 
+00050430: 7072 6f62 6c65 6d73 0d0a 0909 0969 6620  problems.....if 
+00050440: 7061 7264 662e 7661 7279 2e61 6e79 2829  pardf.vary.any()
+00050450: 3a23 6f6b 2077 6520 6861 7665 2073 6f6d  :#ok we have som
+00050460: 6574 6869 6e67 2074 6f20 6f70 7469 6d69  ething to optimi
+00050470: 7a65 206c 6574 7320 7265 7475 726e 2074  ze lets return t
+00050480: 6865 2073 7065 6374 7261 0d0a 0909 0909  he spectra......
+00050490: 6d75 6c74 695f 7072 6f6a 6563 742e 696e  multi_project.in
+000504a0: 7365 7274 2830 2c73 656c 6629 0d0a 0909  sert(0,self)....
+000504b0: 0909 6d69 6e69 203d 206c 6d66 6974 2e4d  ..mini = lmfit.M
+000504c0: 696e 696d 697a 6572 2865 7272 5f66 756e  inimizer(err_fun
+000504d0: 635f 6d75 6c74 692c 7061 7264 665f 746f  c_multi,pardf_to
+000504e0: 5f70 6172 2870 6172 6466 292c 6663 6e5f  _par(pardf),fcn_
+000504f0: 6b77 733d 7b27 6d75 6c74 695f 7072 6f6a  kws={'multi_proj
+00050500: 6563 7427 3a6d 756c 7469 5f70 726f 6a65  ect':multi_proje
+00050510: 6374 2c27 756e 6971 7565 5f70 6172 616d  ct,'unique_param
+00050520: 6574 6572 273a 756e 6971 7565 5f70 6172  eter':unique_par
+00050530: 616d 6574 6572 2c0d 0a09 0909 0909 0909  ameter,.........
+00050540: 0909 0909 0909 0909 0909 0909 0909 2777  ..............'w
+00050550: 6569 6768 7473 273a 7765 6967 6874 732c  eights':weights,
+00050560: 276d 6f64 273a 6d6f 642c 276c 6f67 5f66  'mod':mod,'log_f
+00050570: 6974 273a 7365 6c66 2e6c 6f67 5f66 6974  it':self.log_fit
+00050580: 2c27 6669 6e61 6c27 3a46 616c 7365 2c0d  ,'final':False,.
+00050590: 0a09 0909 0909 0909 0909 0909 0909 0909  ................
+000505a0: 0909 0909 0909 2764 756d 705f 7061 7261  ......'dump_para
+000505b0: 7327 3a64 756d 705f 7061 7261 732c 2766  s':dump_paras,'f
+000505c0: 696c 656e 616d 6527 3a66 696c 656e 616d  ilename':filenam
+000505d0: 652c 2765 7874 5f73 7065 6374 7261 273a  e,'ext_spectra':
+000505e0: 6578 745f 7370 6563 7472 612c 0d0a 0909  ext_spectra,....
+000505f0: 0909 0909 0909 0909 0909 0909 0909 0909  ................
+00050600: 0909 0927 6475 6d70 5f73 6861 7065 7327  ...'dump_shapes'
+00050610: 3a64 756d 705f 7368 6170 6573 2c27 7361  :dump_shapes,'sa
+00050620: 6d65 5f44 4153 273a 7361 6d65 5f44 4153  me_DAS':same_DAS
+00050630: 7d29 0d0a 0909 0909 6966 206c 656e 2870  })......if len(p
+00050640: 6172 6466 5b70 6172 6466 2e76 6172 795d  ardf[pardf.vary]
+00050650: 2e69 6e64 6578 293e 333a 0d0a 0909 0909  .index)>3:......
+00050660: 0970 7269 6e74 2827 7765 2075 7365 2061  .print('we use a
+00050670: 6461 7074 6976 6520 6d6f 6465 2066 6f72  daptive mode for
+00050680: 206e 656c 6465 7227 290d 0a09 0909 0909   nelder').......
+00050690: 7265 7375 6c74 7320 3d20 6d69 6e69 2e6d  results = mini.m
+000506a0: 696e 696d 697a 6528 276e 656c 6465 7227  inimize('nelder'
+000506b0: 2c6f 7074 696f 6e73 3d7b 276d 6178 6974  ,options={'maxit
+000506c0: 6572 273a 3165 352c 2761 6461 7074 6976  er':1e5,'adaptiv
+000506d0: 6527 3a54 7275 657d 290d 0a09 0909 0965  e':True})......e
+000506e0: 6c73 653a 0d0a 0909 0909 0972 6573 756c  lse:.......resul
+000506f0: 7473 203d 206d 696e 692e 6d69 6e69 6d69  ts = mini.minimi
+00050700: 7a65 2827 6e65 6c64 6572 272c 6f70 7469  ze('nelder',opti
+00050710: 6f6e 733d 7b27 6d61 7869 7465 7227 3a31  ons={'maxiter':1
+00050720: 6535 7d29 0d0a 0909 0909 090d 0a09 0923  e5})...........#
 00050730: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00050740: 2323 2323 2323 2323 0d0a 0909 232d 2d2d  ########....#---
-00050750: 2d46 6974 2063 6869 7270 2d2d 2d2d 2d2d  -Fit chirp------
-00050760: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00050770: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00050780: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00050740: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00050750: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00050760: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00050770: 2323 2323 2323 0d0a 0909 232d 2d2d 2d46  ######....#----F
+00050780: 6974 2063 6869 7270 2d2d 2d2d 2d2d 2d2d  it chirp--------
 00050790: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000507a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 0909  ------------....
-000507b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000507c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000507d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000507a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000507b0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000507c0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000507d0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 0909 2323  ----------....##
 000507e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000507f0: 2323 2323 0d0a 0909 0d0a 0909 6966 2073  ####........if s
-00050800: 656c 662e 6967 6e6f 7265 5f74 696d 655f  elf.ignore_time_
-00050810: 7265 6769 6f6e 2069 7320 6e6f 7420 4e6f  region is not No
-00050820: 6e65 3a20 0d0a 0909 0969 6620 6669 745f  ne: .....if fit_
-00050830: 6368 6972 703a 0d0a 0909 0909 7072 696e  chirp:......prin
-00050840: 7428 2773 6f72 7279 2062 7574 2063 7572  t('sorry but cur
-00050850: 7265 6e74 6c79 2079 6f75 2063 616e 206e  rently you can n
-00050860: 6f74 2062 6f74 6820 6967 6e6f 7265 2061  ot both ignore a
-00050870: 2074 696d 6520 7265 6769 6f6e 2061 6e64   time region and
-00050880: 2066 6974 2074 6865 2063 6869 7270 2028   fit the chirp (
-00050890: 6173 7375 6d69 6e67 2074 6861 7420 796f  assuming that yo
-000508a0: 7520 6967 6e6f 7265 2074 6865 2074 696d  u ignore the tim
-000508b0: 652d 7a65 726f 2072 6567 696f 6e29 2729  e-zero region)')
-000508c0: 0d0a 0909 0966 6974 5f63 6869 7270 3d46  .....fit_chirp=F
-000508d0: 616c 7365 0d0a 0909 6966 2066 6974 5f63  alse....if fit_c
-000508e0: 6869 7270 3a0d 0a09 0909 7072 696e 7428  hirp:.....print(
-000508f0: 2744 6f6e 6520 696e 6974 6961 6c20 6669  'Done initial fi
-00050900: 7474 696e 6720 6e6f 7720 6368 6972 7066  tting now chirpf
-00050910: 6974 2729 0d0a 0909 0972 6573 756c 7473  it').....results
-00050920: 2c66 6974 5f64 733d 7365 6c66 2e5f 5f46  ,fit_ds=self.__F
-00050930: 6974 5f43 6869 7270 5f6f 7574 6572 2870  it_Chirp_outer(p
-00050940: 6172 6466 2c72 6573 756c 7473 2c66 6974  ardf,results,fit
-00050950: 5f64 732c 6669 745f 6368 6972 705f 6974  _ds,fit_chirp_it
-00050960: 6572 6174 696f 6e73 2c6d 6f64 290d 0a09  erations,mod)...
-00050970: 0909 0d0a 0909 090d 0a09 0923 2323 2323  ...........#####
-00050980: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00050990: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000509a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000509b0: 2323 2323 2323 2323 2323 2323 2323 230d  ###############.
-000509c0: 0a09 0923 2d2d 2d2d 2d2d 5772 6974 6520  ...#------Write 
-000509d0: 7265 7375 6c74 7320 746f 2070 6172 616d  results to param
-000509e0: 6574 6572 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  eter------------
-000509f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 0909  ------------....
-00050a00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00050a10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00050a20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00050a30: 2323 2323 2323 2323 2323 2323 0d0a 0909  ############....
-00050a40: 0d0a 0909 6966 2070 6172 6466 2e76 6172  ....if pardf.var
-00050a50: 792e 616e 7928 293a 2377 6520 6163 7475  y.any():#we actu
-00050a60: 616c 6c79 2068 6176 6520 6f70 7469 6d69  ally have optimi
-00050a70: 7365 6420 736f 6d65 7468 696e 670d 0a09  sed something...
-00050a80: 0909 7061 7264 665b 2776 616c 7565 275d  ..pardf['value']
-00050a90: 3d70 6172 5f74 6f5f 7061 7264 6628 7265  =par_to_pardf(re
-00050aa0: 7375 6c74 732e 7061 7261 6d73 295b 2776  sults.params)['v
-00050ab0: 616c 7565 275d 0d0a 0909 0969 6620 7365  alue'].....if se
-00050ac0: 6c66 2e6c 6f67 5f66 6974 3a0d 0a09 0909  lf.log_fit:.....
-00050ad0: 0966 6f72 206b 6579 2069 6e20 5b27 7661  .for key in ['va
-00050ae0: 6c75 6527 2c27 6d69 6e27 2c27 6d61 7827  lue','min','max'
-00050af0: 5d3a 0d0a 0909 0909 0970 6172 6466 2e6c  ]:.......pardf.l
-00050b00: 6f63 5b70 6172 6466 2e69 735f 7261 7465  oc[pardf.is_rate
-00050b10: 2c6b 6579 5d3d 7061 7264 662e 6c6f 635b  ,key]=pardf.loc[
-00050b20: 7061 7264 662e 6973 5f72 6174 652c 6b65  pardf.is_rate,ke
-00050b30: 795d 2e61 7070 6c79 286c 616d 6264 6120  y].apply(lambda 
-00050b40: 783a 2031 302a 2a78 290d 0a09 0909 7365  x: 10**x).....se
-00050b50: 6c66 2e70 6172 5f66 6974 3d70 6172 6466  lf.par_fit=pardf
-00050b60: 5f74 6f5f 7061 7228 7061 7264 6629 0d0a  _to_par(pardf)..
-00050b70: 0909 656c 7365 3a0d 0a09 0909 7072 696e  ..else:.....prin
-00050b80: 7428 2741 5454 454e 5449 4f4e 3a20 7765  t('ATTENTION: we
-00050b90: 2068 6176 6520 6e6f 7420 6f70 7469 6d69   have not optimi
-00050ba0: 7a65 6420 616e 7974 6869 6e67 2062 7574  zed anything but
-00050bb0: 206a 7573 7420 7265 7475 726e 6564 2074   just returned t
-00050bc0: 6865 2070 6172 616d 6574 6572 7327 290d  he parameters').
-00050bd0: 0a09 0909 7365 6c66 2e70 6172 5f66 6974  ....self.par_fit
-00050be0: 3d73 656c 662e 7061 720d 0a09 0969 6620  =self.par....if 
-00050bf0: 6d75 6c74 695f 7072 6f6a 6563 7420 6973  multi_project is
-00050c00: 204e 6f6e 653a 0d0a 0909 0972 653d 6572   None:.....re=er
-00050c10: 725f 6675 6e63 2870 6172 6173 3d73 656c  r_func(paras=sel
-00050c20: 662e 7061 725f 6669 742c 6473 3d66 6974  f.par_fit,ds=fit
-00050c30: 5f64 732c 6d6f 643d 7365 6c66 2e6d 6f64  _ds,mod=self.mod
-00050c40: 2c66 696e 616c 3d54 7275 652c 6c6f 675f  ,final=True,log_
-00050c50: 6669 743d 7365 6c66 2e6c 6f67 5f66 6974  fit=self.log_fit
-00050c60: 2c65 7874 5f73 7065 6374 7261 3d65 7874  ,ext_spectra=ext
-00050c70: 5f73 7065 6374 7261 290d 0a09 0965 6c73  _spectra)....els
-00050c80: 653a 0d0a 0909 0969 6620 7361 6d65 5f44  e:.....if same_D
-00050c90: 4153 3a0d 0a09 0909 0972 655f 6c69 7374  AS:......re_list
-00050ca0: 656e 203d 2065 7272 5f66 756e 635f 6d75  en = err_func_mu
-00050cb0: 6c74 6928 7061 7261 7320 3d20 7365 6c66  lti(paras = self
-00050cc0: 2e70 6172 5f66 6974 2c20 6d6f 6420 3d20  .par_fit, mod = 
-00050cd0: 6d6f 642c 2066 696e 616c 203d 2054 7275  mod, final = Tru
-00050ce0: 652c 206c 6f67 5f66 6974 203d 2073 656c  e, log_fit = sel
-00050cf0: 662e 6c6f 675f 6669 742c 200d 0a09 0909  f.log_fit, .....
-00050d00: 0909 0909 0909 6d75 6c74 695f 7072 6f6a  ......multi_proj
-00050d10: 6563 7420 3d20 6d75 6c74 695f 7072 6f6a  ect = multi_proj
-00050d20: 6563 742c 2075 6e69 7175 655f 7061 7261  ect, unique_para
-00050d30: 6d65 7465 7220 3d20 756e 6971 7565 5f70  meter = unique_p
-00050d40: 6172 616d 6574 6572 2c20 7361 6d65 5f44  arameter, same_D
-00050d50: 4153 203d 2073 616d 655f 4441 532c 2077  AS = same_DAS, w
-00050d60: 6569 6768 7473 203d 2077 6569 6768 7473  eights = weights
-00050d70: 2c20 0d0a 0909 0909 0909 0909 0965 7874  , ...........ext
-00050d80: 5f73 7065 6374 7261 203d 2065 7874 5f73  _spectra = ext_s
-00050d90: 7065 6374 7261 290d 0a09 0909 0972 653d  pectra)......re=
-00050da0: 7265 5f6c 6973 7465 6e5b 305d 0d0a 0909  re_listen[0]....
-00050db0: 0965 6c73 653a 0d0a 0909 0909 7265 203d  .else:......re =
-00050dc0: 2065 7272 5f66 756e 635f 6d75 6c74 6928   err_func_multi(
-00050dd0: 7061 7261 7320 3d20 7365 6c66 2e70 6172  paras = self.par
-00050de0: 5f66 6974 2c20 6d6f 6420 3d20 6d6f 642c  _fit, mod = mod,
-00050df0: 2066 696e 616c 203d 2054 7275 652c 206c   final = True, l
-00050e00: 6f67 5f66 6974 203d 2073 656c 662e 6c6f  og_fit = self.lo
-00050e10: 675f 6669 742c 200d 0a09 0909 0909 0909  g_fit, .........
-00050e20: 0909 6d75 6c74 695f 7072 6f6a 6563 7420  ..multi_project 
-00050e30: 3d20 6d75 6c74 695f 7072 6f6a 6563 742c  = multi_project,
-00050e40: 2075 6e69 7175 655f 7061 7261 6d65 7465   unique_paramete
-00050e50: 7220 3d20 756e 6971 7565 5f70 6172 616d  r = unique_param
-00050e60: 6574 6572 2c20 7361 6d65 5f44 4153 203d  eter, same_DAS =
-00050e70: 2073 616d 655f 4441 532c 2077 6569 6768   same_DAS, weigh
-00050e80: 7473 203d 2077 6569 6768 7473 2c20 0d0a  ts = weights, ..
-00050e90: 0909 0909 0909 0909 0965 7874 5f73 7065  .........ext_spe
-00050ea0: 6374 7261 203d 2065 7874 5f73 7065 6374  ctra = ext_spect
-00050eb0: 7261 290d 0a09 090d 0a09 0923 2323 2323  ra)........#####
-00050ec0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00050ed0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00050ee0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000507f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00050800: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00050810: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00050820: 2323 0d0a 0909 0d0a 0909 6966 2073 656c  ##........if sel
+00050830: 662e 6967 6e6f 7265 5f74 696d 655f 7265  f.ignore_time_re
+00050840: 6769 6f6e 2069 7320 6e6f 7420 4e6f 6e65  gion is not None
+00050850: 3a20 0d0a 0909 0969 6620 6669 745f 6368  : .....if fit_ch
+00050860: 6972 703a 0d0a 0909 0909 7072 696e 7428  irp:......print(
+00050870: 2773 6f72 7279 2062 7574 2063 7572 7265  'sorry but curre
+00050880: 6e74 6c79 2079 6f75 2063 616e 206e 6f74  ntly you can not
+00050890: 2062 6f74 6820 6967 6e6f 7265 2061 2074   both ignore a t
+000508a0: 696d 6520 7265 6769 6f6e 2061 6e64 2066  ime region and f
+000508b0: 6974 2074 6865 2063 6869 7270 2028 6173  it the chirp (as
+000508c0: 7375 6d69 6e67 2074 6861 7420 796f 7520  suming that you 
+000508d0: 6967 6e6f 7265 2074 6865 2074 696d 652d  ignore the time-
+000508e0: 7a65 726f 2072 6567 696f 6e29 2729 0d0a  zero region)')..
+000508f0: 0909 0966 6974 5f63 6869 7270 3d46 616c  ...fit_chirp=Fal
+00050900: 7365 0d0a 0909 6966 2066 6974 5f63 6869  se....if fit_chi
+00050910: 7270 3a0d 0a09 0909 7072 696e 7428 2744  rp:.....print('D
+00050920: 6f6e 6520 696e 6974 6961 6c20 6669 7474  one initial fitt
+00050930: 696e 6720 6e6f 7720 6368 6972 7066 6974  ing now chirpfit
+00050940: 2729 0d0a 0909 0972 6573 756c 7473 2c66  ').....results,f
+00050950: 6974 5f64 733d 7365 6c66 2e5f 5f46 6974  it_ds=self.__Fit
+00050960: 5f43 6869 7270 5f6f 7574 6572 2870 6172  _Chirp_outer(par
+00050970: 6466 2c72 6573 756c 7473 2c66 6974 5f64  df,results,fit_d
+00050980: 732c 6669 745f 6368 6972 705f 6974 6572  s,fit_chirp_iter
+00050990: 6174 696f 6e73 2c6d 6f64 290d 0a09 0909  ations,mod).....
+000509a0: 0d0a 0909 090d 0a09 0923 2323 2323 2323  .........#######
+000509b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000509c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000509d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000509e0: 2323 2323 2323 2323 2323 2323 230d 0a09  #############...
+000509f0: 0923 2d2d 2d2d 2d2d 5772 6974 6520 7265  .#------Write re
+00050a00: 7375 6c74 7320 746f 2070 6172 616d 6574  sults to paramet
+00050a10: 6572 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  er--------------
+00050a20: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 0909 2323  ----------....##
+00050a30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00050a40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00050a50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00050a60: 2323 2323 2323 2323 2323 0d0a 0909 0d0a  ##########......
+00050a70: 0909 6966 2070 6172 6466 2e76 6172 792e  ..if pardf.vary.
+00050a80: 616e 7928 293a 2377 6520 6163 7475 616c  any():#we actual
+00050a90: 6c79 2068 6176 6520 6f70 7469 6d69 7365  ly have optimise
+00050aa0: 6420 736f 6d65 7468 696e 670d 0a09 0909  d something.....
+00050ab0: 7061 7264 665b 2776 616c 7565 275d 3d70  pardf['value']=p
+00050ac0: 6172 5f74 6f5f 7061 7264 6628 7265 7375  ar_to_pardf(resu
+00050ad0: 6c74 732e 7061 7261 6d73 295b 2776 616c  lts.params)['val
+00050ae0: 7565 275d 0d0a 0909 0969 6620 7365 6c66  ue'].....if self
+00050af0: 2e6c 6f67 5f66 6974 3a0d 0a09 0909 0966  .log_fit:......f
+00050b00: 6f72 206b 6579 2069 6e20 5b27 7661 6c75  or key in ['valu
+00050b10: 6527 2c27 6d69 6e27 2c27 6d61 7827 5d3a  e','min','max']:
+00050b20: 0d0a 0909 0909 0970 6172 6466 2e6c 6f63  .......pardf.loc
+00050b30: 5b70 6172 6466 2e69 735f 7261 7465 2c6b  [pardf.is_rate,k
+00050b40: 6579 5d3d 7061 7264 662e 6c6f 635b 7061  ey]=pardf.loc[pa
+00050b50: 7264 662e 6973 5f72 6174 652c 6b65 795d  rdf.is_rate,key]
+00050b60: 2e61 7070 6c79 286c 616d 6264 6120 783a  .apply(lambda x:
+00050b70: 2031 302a 2a78 290d 0a09 0909 7365 6c66   10**x).....self
+00050b80: 2e70 6172 5f66 6974 3d70 6172 6466 5f74  .par_fit=pardf_t
+00050b90: 6f5f 7061 7228 7061 7264 6629 0d0a 0909  o_par(pardf)....
+00050ba0: 656c 7365 3a0d 0a09 0909 7072 696e 7428  else:.....print(
+00050bb0: 2741 5454 454e 5449 4f4e 3a20 7765 2068  'ATTENTION: we h
+00050bc0: 6176 6520 6e6f 7420 6f70 7469 6d69 7a65  ave not optimize
+00050bd0: 6420 616e 7974 6869 6e67 2062 7574 206a  d anything but j
+00050be0: 7573 7420 7265 7475 726e 6564 2074 6865  ust returned the
+00050bf0: 2070 6172 616d 6574 6572 7327 290d 0a09   parameters')...
+00050c00: 0909 7365 6c66 2e70 6172 5f66 6974 3d73  ..self.par_fit=s
+00050c10: 656c 662e 7061 720d 0a09 0969 6620 6d75  elf.par....if mu
+00050c20: 6c74 695f 7072 6f6a 6563 7420 6973 204e  lti_project is N
+00050c30: 6f6e 653a 0d0a 0909 0972 653d 6572 725f  one:.....re=err_
+00050c40: 6675 6e63 2870 6172 6173 3d73 656c 662e  func(paras=self.
+00050c50: 7061 725f 6669 742c 6473 3d66 6974 5f64  par_fit,ds=fit_d
+00050c60: 732c 6d6f 643d 7365 6c66 2e6d 6f64 2c66  s,mod=self.mod,f
+00050c70: 696e 616c 3d54 7275 652c 6c6f 675f 6669  inal=True,log_fi
+00050c80: 743d 7365 6c66 2e6c 6f67 5f66 6974 2c65  t=self.log_fit,e
+00050c90: 7874 5f73 7065 6374 7261 3d65 7874 5f73  xt_spectra=ext_s
+00050ca0: 7065 6374 7261 290d 0a09 0965 6c73 653a  pectra)....else:
+00050cb0: 0d0a 0909 0969 6620 7361 6d65 5f44 4153  .....if same_DAS
+00050cc0: 3a0d 0a09 0909 0972 655f 6c69 7374 656e  :......re_listen
+00050cd0: 203d 2065 7272 5f66 756e 635f 6d75 6c74   = err_func_mult
+00050ce0: 6928 7061 7261 7320 3d20 7365 6c66 2e70  i(paras = self.p
+00050cf0: 6172 5f66 6974 2c20 6d6f 6420 3d20 6d6f  ar_fit, mod = mo
+00050d00: 642c 2066 696e 616c 203d 2054 7275 652c  d, final = True,
+00050d10: 206c 6f67 5f66 6974 203d 2073 656c 662e   log_fit = self.
+00050d20: 6c6f 675f 6669 742c 200d 0a09 0909 0909  log_fit, .......
+00050d30: 0909 0909 6d75 6c74 695f 7072 6f6a 6563  ....multi_projec
+00050d40: 7420 3d20 6d75 6c74 695f 7072 6f6a 6563  t = multi_projec
+00050d50: 742c 2075 6e69 7175 655f 7061 7261 6d65  t, unique_parame
+00050d60: 7465 7220 3d20 756e 6971 7565 5f70 6172  ter = unique_par
+00050d70: 616d 6574 6572 2c20 7361 6d65 5f44 4153  ameter, same_DAS
+00050d80: 203d 2073 616d 655f 4441 532c 2077 6569   = same_DAS, wei
+00050d90: 6768 7473 203d 2077 6569 6768 7473 2c20  ghts = weights, 
+00050da0: 0d0a 0909 0909 0909 0909 0965 7874 5f73  ...........ext_s
+00050db0: 7065 6374 7261 203d 2065 7874 5f73 7065  pectra = ext_spe
+00050dc0: 6374 7261 290d 0a09 0909 0972 653d 7265  ctra)......re=re
+00050dd0: 5f6c 6973 7465 6e5b 305d 0d0a 0909 0965  _listen[0].....e
+00050de0: 6c73 653a 0d0a 0909 0909 7265 203d 2065  lse:......re = e
+00050df0: 7272 5f66 756e 635f 6d75 6c74 6928 7061  rr_func_multi(pa
+00050e00: 7261 7320 3d20 7365 6c66 2e70 6172 5f66  ras = self.par_f
+00050e10: 6974 2c20 6d6f 6420 3d20 6d6f 642c 2066  it, mod = mod, f
+00050e20: 696e 616c 203d 2054 7275 652c 206c 6f67  inal = True, log
+00050e30: 5f66 6974 203d 2073 656c 662e 6c6f 675f  _fit = self.log_
+00050e40: 6669 742c 200d 0a09 0909 0909 0909 0909  fit, ...........
+00050e50: 6d75 6c74 695f 7072 6f6a 6563 7420 3d20  multi_project = 
+00050e60: 6d75 6c74 695f 7072 6f6a 6563 742c 2075  multi_project, u
+00050e70: 6e69 7175 655f 7061 7261 6d65 7465 7220  nique_parameter 
+00050e80: 3d20 756e 6971 7565 5f70 6172 616d 6574  = unique_paramet
+00050e90: 6572 2c20 7361 6d65 5f44 4153 203d 2073  er, same_DAS = s
+00050ea0: 616d 655f 4441 532c 2077 6569 6768 7473  ame_DAS, weights
+00050eb0: 203d 2077 6569 6768 7473 2c20 0d0a 0909   = weights, ....
+00050ec0: 0909 0909 0909 0965 7874 5f73 7065 6374  .......ext_spect
+00050ed0: 7261 203d 2065 7874 5f73 7065 6374 7261  ra = ext_spectra
+00050ee0: 290d 0a09 090d 0a09 0923 2323 2323 2323  )........#######
 00050ef0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00050f00: 2323 2323 2323 230d 0a09 0923 2d2d 2d2d  #######....#----
-00050f10: 4573 7469 6d61 7465 2065 7272 6f72 732d  Estimate errors-
-00050f20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00050f30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00050f40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00050f00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00050f10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00050f20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00050f30: 2323 2323 230d 0a09 0923 2d2d 2d2d 4573  #####....#----Es
+00050f40: 7469 6d61 7465 2065 7272 6f72 732d 2d2d  timate errors---
 00050f50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00050f60: 2d2d 2d2d 0d0a 0909 2323 2323 2323 2323  ----....########
-00050f70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00050f80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00050f90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00050f60: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00050f70: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00050f80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00050f90: 2d2d 0d0a 0909 2323 2323 2323 2323 2323  --....##########
 00050fa0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00050fb0: 2323 2323 0d0a 0909 0d0a 0909 6966 2063  ####........if c
-00050fc0: 6f6e 6669 6465 6e63 655f 6c65 7665 6c20  onfidence_level 
-00050fd0: 6973 206e 6f74 204e 6f6e 653a 236f 6b20  is not None:#ok 
-00050fe0: 7765 2063 616c 6375 6c61 7465 2065 7272  we calculate err
-00050ff0: 6f72 7320 746f 2074 6865 206c 6576 656c  ors to the level
-00051000: 206f 6620 7468 6520 636f 6e66 6964 656e   of the confiden
-00051010: 6365 5f6c 6576 656c 0d0a 0909 0969 6620  ce_level.....if 
-00051020: 7365 6c66 2e6c 6f67 5f66 6974 3a0d 0a09  self.log_fit:...
-00051030: 0909 0966 6f72 206b 6579 2069 6e20 5b27  ...for key in ['
-00051040: 7661 6c75 6527 2c27 6d69 6e27 2c27 6d61  value','min','ma
-00051050: 7827 5d3a 0d0a 0909 0909 0970 6172 6466  x']:.......pardf
-00051060: 2e6c 6f63 5b70 6172 6466 2e69 735f 7261  .loc[pardf.is_ra
-00051070: 7465 2c6b 6579 5d3d 7061 7264 662e 6c6f  te,key]=pardf.lo
-00051080: 635b 7061 7264 662e 6973 5f72 6174 652c  c[pardf.is_rate,
-00051090: 6b65 795d 2e61 7070 6c79 286c 616d 6264  key].apply(lambd
-000510a0: 6120 783a 206e 702e 6c6f 6731 3028 7829  a x: np.log10(x)
-000510b0: 290d 0a09 0909 6966 2070 6172 6466 2e76  ).....if pardf.v
-000510c0: 6172 792e 616e 7928 293a 2377 6520 6163  ary.any():#we ac
-000510d0: 7475 616c 6c79 2068 6176 6520 6f70 7469  tually have opti
-000510e0: 6d69 7365 6420 736f 6d65 7468 696e 670d  mised something.
-000510f0: 0a09 0909 0969 6620 2830 2e36 203c 2063  .....if (0.6 < c
-00051100: 6f6e 6669 6465 6e63 655f 6c65 7665 6c20  onfidence_level 
-00051110: 3c20 3129 206f 7220 2831 203c 2063 6f6e  < 1) or (1 < con
-00051120: 6669 6465 6e63 655f 6c65 7665 6c20 3c20  fidence_level < 
-00051130: 302e 3629 3a0d 0a09 0909 0909 6966 206d  0.6):.......if m
-00051140: 756c 7469 5f70 726f 6a65 6374 2069 7320  ulti_project is 
-00051150: 4e6f 6e65 3a0d 0a09 0909 0909 0974 6172  None:........tar
-00051160: 6765 743d 7332 5f76 735f 736d 696e 3228  get=s2_vs_smin2(
-00051170: 5370 6563 7472 616c 5f70 6f69 6e74 733d  Spectral_points=
-00051180: 6c65 6e28 7265 5b27 4127 5d2e 636f 6c75  len(re['A'].colu
-00051190: 6d6e 7329 2c54 696d 655f 706f 696e 7473  mns),Time_points
-000511a0: 3d6c 656e 2872 655b 2741 275d 2e69 6e64  =len(re['A'].ind
-000511b0: 6578 292c 6e75 6d62 6572 5f6f 665f 7370  ex),number_of_sp
-000511c0: 6563 6965 733d 6c65 6e28 7265 5b27 4441  ecies=len(re['DA
-000511d0: 4327 5d2e 636f 6c75 6d6e 7329 2c66 6974  C'].columns),fit
-000511e0: 7465 645f 6b69 6e65 7469 635f 7061 7273  ted_kinetic_pars
-000511f0: 3d6c 656e 2870 6172 6466 5b70 6172 6466  =len(pardf[pardf
-00051200: 2e76 6172 795d 2e69 6e64 6578 292c 7461  .vary].index),ta
-00051210: 7267 6574 5f71 7561 6c69 7479 3d63 6f6e  rget_quality=con
-00051220: 6669 6465 6e63 655f 6c65 7665 6c29 0d0a  fidence_level)..
-00051230: 0909 0909 0965 6c73 653a 0d0a 0909 0909  .....else:......
-00051240: 0909 6d75 6c74 695f 7072 6f6a 6563 742e  ..multi_project.
-00051250: 696e 7365 7274 2830 2c73 656c 6629 0d0a  insert(0,self)..
-00051260: 0909 0909 0909 2320 7765 2061 7373 756d  ......# we assum
-00051270: 6520 7468 6174 2077 6520 6861 7665 2074  e that we have t
-00051280: 6865 2073 616d 6520 6e75 6d62 6572 206f  he same number o
-00051290: 6620 7370 6563 7461 6c20 706f 696e 7473  f spectal points
-000512a0: 2062 7574 2061 7265 2073 7461 636b 696e   but are stackin
-000512b0: 6720 7468 6520 7469 6d65 730d 0a09 0909  g the times.....
-000512c0: 0909 0974 6f74 616c 5f74 696d 655f 706f  ...total_time_po
-000512d0: 696e 7473 3d6e 702e 6172 7261 7928 5b6c  ints=np.array([l
-000512e0: 656e 2874 2e72 655b 2741 275d 2e69 6e64  en(t.re['A'].ind
-000512f0: 6578 2920 666f 7220 7420 696e 206d 756c  ex) for t in mul
-00051300: 7469 5f70 726f 6a65 6374 5d29 2e73 756d  ti_project]).sum
-00051310: 2829 0909 0909 090d 0a09 0909 0909 0974  ().............t
-00051320: 6172 6765 743d 7332 5f76 735f 736d 696e  arget=s2_vs_smin
-00051330: 3228 5370 6563 7472 616c 5f70 6f69 6e74  2(Spectral_point
-00051340: 733d 6c65 6e28 7265 5b27 4127 5d2e 636f  s=len(re['A'].co
-00051350: 6c75 6d6e 7329 2c54 696d 655f 706f 696e  lumns),Time_poin
-00051360: 7473 3d74 6f74 616c 5f74 696d 655f 706f  ts=total_time_po
-00051370: 696e 7473 2c6e 756d 6265 725f 6f66 5f73  ints,number_of_s
-00051380: 7065 6369 6573 3d6c 656e 2872 655b 2744  pecies=len(re['D
-00051390: 4143 275d 2e63 6f6c 756d 6e73 292c 6669  AC'].columns),fi
-000513a0: 7474 6564 5f6b 696e 6574 6963 5f70 6172  tted_kinetic_par
-000513b0: 733d 6c65 6e28 7061 7264 665b 7061 7264  s=len(pardf[pard
-000513c0: 662e 7661 7279 5d2e 696e 6465 7829 2c74  f.vary].index),t
-000513d0: 6172 6765 745f 7175 616c 6974 793d 636f  arget_quality=co
-000513e0: 6e66 6964 656e 6365 5f6c 6576 656c 290d  nfidence_level).
-000513f0: 0a09 0909 0909 2370 7269 6e74 2874 6172  ......#print(tar
-00051400: 6765 7429 0d0a 0909 0909 0974 6172 6765  get).......targe
-00051410: 745f 7332 3d72 655b 2765 7272 6f72 275d  t_s2=re['error']
-00051420: 2a74 6172 6765 740d 0a09 0909 0909 6c69  *target.......li
-00051430: 7374 5f6f 665f 7661 7269 6162 6c65 5f70  st_of_variable_p
-00051440: 6172 616d 6574 6572 3d70 6172 6466 5b70  arameter=pardf[p
-00051450: 6172 6466 2e76 6172 795d 2e69 6e64 6578  ardf.vary].index
-00051460: 2e76 616c 7565 730d 0a09 0909 0909 636f  .values.......co
-00051470: 6e66 5f6c 696d 6974 733d 7b7d 0d0a 0909  nf_limits={}....
-00051480: 0909 0969 7465 7261 7469 7665 5f63 616c  ...iterative_cal
-00051490: 6c73 3d30 0d0a 0909 0909 0966 6f72 2066  ls=0.......for f
-000514a0: 6978 6564 5f70 6172 2069 6e20 6c69 7374  ixed_par in list
-000514b0: 5f6f 665f 7661 7269 6162 6c65 5f70 6172  _of_variable_par
-000514c0: 616d 6574 6572 3a0d 0a09 0909 0909 0963  ameter:........c
-000514d0: 6f6e 665f 6c69 6d69 7473 5b66 6978 6564  onf_limits[fixed
-000514e0: 5f70 6172 5d3d 7b27 7570 7065 7227 3a4e  _par]={'upper':N
-000514f0: 6f6e 652c 276c 6f77 6572 273a 4e6f 6e65  one,'lower':None
-00051500: 7d0d 0a09 0909 0909 0966 6f72 2069 2069  }........for i i
-00051510: 6e20 5b27 6c6f 7765 7227 2c27 7570 7065  n ['lower','uppe
-00051520: 7227 5d3a 0d0a 0909 0909 0909 0970 7269  r']:.........pri
-00051530: 6e74 2827 5472 7969 6e67 2074 6f20 6669  nt('Trying to fi
-00051540: 6e64 2025 732c 2025 7320 636f 6e66 6964  nd %s, %s confid
-00051550: 656e 6365 206c 696d 6974 2725 2866 6978  ence limit'%(fix
-00051560: 6564 5f70 6172 2c69 2929 0d0a 0909 0909  ed_par,i))......
-00051570: 0909 0970 6172 6466 5f6c 6f63 616c 3d73  ...pardf_local=s
-00051580: 656c 662e 7061 725f 6669 742e 636f 7079  elf.par_fit.copy
-00051590: 2829 0d0a 0909 0909 0909 0970 6172 6466  ().........pardf
-000515a0: 5f6c 6f63 616c 5b66 6978 6564 5f70 6172  _local[fixed_par
-000515b0: 5d2e 7661 7279 3d46 616c 7365 0d0a 0909  ].vary=False....
-000515c0: 0909 0909 0970 6172 5f6c 6f63 616c 3d6c  .....par_local=l
-000515d0: 6d66 6974 2e50 6172 616d 6574 6572 7328  mfit.Parameters(
-000515e0: 290d 0a09 0909 0909 0909 6966 2027 6c6f  ).........if 'lo
-000515f0: 7765 7227 2069 6e20 693a 2367 6f20 6265  wer' in i:#go be
-00051600: 6c6f 7720 6d69 6e0d 0a09 0909 0909 0909  low min.........
-00051610: 0969 6620 7061 725f 746f 5f70 6172 6466  .if par_to_pardf
-00051620: 2870 6172 6466 5f6c 6f63 616c 292e 6c6f  (pardf_local).lo
-00051630: 635b 6669 7865 645f 7061 722c 2769 735f  c[fixed_par,'is_
-00051640: 7261 7465 275d 3a0d 0a09 0909 0909 0909  rate']:.........
-00051650: 0909 7061 725f 6c6f 6361 6c2e 6164 6428  ..par_local.add(
-00051660: 6669 7865 645f 7061 722c 7661 6c75 653d  fixed_par,value=
-00051670: 7061 7264 665f 6c6f 6361 6c5b 6669 7865  pardf_local[fixe
-00051680: 645f 7061 725d 2e76 616c 7565 2a30 2e39  d_par].value*0.9
-00051690: 352c 6d69 6e3d 302c 6d61 783d 7061 7264  5,min=0,max=pard
-000516a0: 665f 6c6f 6361 6c5b 6669 7865 645f 7061  f_local[fixed_pa
-000516b0: 725d 2e76 616c 7565 2c76 6172 793d 7661  r].value,vary=va
-000516c0: 7279 5f65 7272 6f72 5f70 6172 616d 6574  ry_error_paramet
-000516d0: 6572 290d 0a09 0909 0909 0909 0965 6c73  er)..........els
-000516e0: 653a 0d0a 0909 0909 0909 0909 0970 6172  e:...........par
-000516f0: 5f6c 6f63 616c 2e61 6464 2866 6978 6564  _local.add(fixed
-00051700: 5f70 6172 2c76 616c 7565 3d70 6172 6466  _par,value=pardf
-00051710: 5f6c 6f63 616c 5b66 6978 6564 5f70 6172  _local[fixed_par
-00051720: 5d2e 7661 6c75 652a 302e 3935 2c6d 6178  ].value*0.95,max
-00051730: 3d70 6172 6466 5f6c 6f63 616c 5b66 6978  =pardf_local[fix
-00051740: 6564 5f70 6172 5d2e 7661 6c75 652c 7661  ed_par].value,va
-00051750: 7279 3d76 6172 795f 6572 726f 725f 7061  ry=vary_error_pa
-00051760: 7261 6d65 7465 7229 0d0a 0909 0909 0909  rameter)........
-00051770: 0965 6c73 653a 2023 676f 2061 626f 7665  .else: #go above
-00051780: 206d 696e 0d0a 0909 0909 0909 0909 7061   min..........pa
-00051790: 725f 6c6f 6361 6c2e 6164 6428 6669 7865  r_local.add(fixe
-000517a0: 645f 7061 722c 7661 6c75 653d 7061 7264  d_par,value=pard
-000517b0: 665f 6c6f 6361 6c5b 6669 7865 645f 7061  f_local[fixed_pa
-000517c0: 725d 2e76 616c 7565 2a31 2e30 352c 6d69  r].value*1.05,mi
-000517d0: 6e3d 7061 7264 665f 6c6f 6361 6c5b 6669  n=pardf_local[fi
-000517e0: 7865 645f 7061 725d 2e76 616c 7565 2c76  xed_par].value,v
-000517f0: 6172 793d 7661 7279 5f65 7272 6f72 5f70  ary=vary_error_p
-00051800: 6172 616d 6574 6572 290d 0a09 0909 0909  arameter).......
-00051810: 0909 0d0a 0909 0909 0909 0964 6566 2073  ...........def s
-00051820: 7562 5f70 726f 626c 656d 2870 6172 5f6c  ub_problem(par_l
-00051830: 6f63 616c 2c76 6172 6965 645f 7061 722c  ocal,varied_par,
-00051840: 7061 7264 665f 6c6f 6361 6c2c 6669 745f  pardf_local,fit_
-00051850: 6473 3d4e 6f6e 652c 6d6f 643d 4e6f 6e65  ds=None,mod=None
-00051860: 2c6c 6f67 5f66 6974 3d4e 6f6e 652c 6d75  ,log_fit=None,mu
-00051870: 6c74 695f 7072 6f6a 6563 743d 4e6f 6e65  lti_project=None
-00051880: 2c75 6e69 7175 655f 7061 7261 6d65 7465  ,unique_paramete
-00051890: 723d 4e6f 6e65 2c77 6569 6768 7473 3d4e  r=None,weights=N
-000518a0: 6f6e 652c 7461 7267 6574 5f73 323d 4e6f  one,target_s2=No
-000518b0: 6e65 2c65 7874 5f73 7065 6374 7261 3d4e  ne,ext_spectra=N
-000518c0: 6f6e 652c 7361 6d65 5f44 4153 3d46 616c  one,same_DAS=Fal
-000518d0: 7365 2029 3a0d 0a09 0909 0909 0909 0970  se ):..........p
-000518e0: 6172 6466 5f6c 6f63 616c 5b76 6172 6965  ardf_local[varie
-000518f0: 645f 7061 725d 2e76 616c 7565 3d70 6172  d_par].value=par
-00051900: 5f6c 6f63 616c 5b76 6172 6965 645f 7061  _local[varied_pa
-00051910: 725d 2e76 616c 7565 0d0a 0909 0909 0909  r].value........
-00051920: 0909 6966 2070 6172 5f74 6f5f 7061 7264  ..if par_to_pard
-00051930: 6628 7061 7264 665f 6c6f 6361 6c29 2e76  f(pardf_local).v
-00051940: 6172 792e 616e 7928 293a 0d0a 0909 0909  ary.any():......
-00051950: 0909 0909 0969 6620 6d75 6c74 695f 7072  .....if multi_pr
-00051960: 6f6a 6563 7420 6973 204e 6f6e 653a 0d0a  oject is None:..
-00051970: 0909 0909 0909 0909 0909 6d69 6e69 5f73  ..........mini_s
-00051980: 7562 203d 206c 6d66 6974 2e4d 696e 696d  ub = lmfit.Minim
-00051990: 697a 6572 2865 7272 5f66 756e 632c 7061  izer(err_func,pa
-000519a0: 7264 665f 6c6f 6361 6c2c 6663 6e5f 6b77  rdf_local,fcn_kw
-000519b0: 733d 7b27 6473 273a 6669 745f 6473 2c27  s={'ds':fit_ds,'
-000519c0: 6d6f 6427 3a6d 6f64 2c27 6c6f 675f 6669  mod':mod,'log_fi
-000519d0: 7427 3a6c 6f67 5f66 6974 2c27 6578 745f  t':log_fit,'ext_
-000519e0: 7370 6563 7472 6127 3a65 7874 5f73 7065  spectra':ext_spe
-000519f0: 6374 7261 7d29 0d0a 0909 0909 0909 0909  ctra})..........
-00051a00: 0965 6c73 653a 0d0a 0909 0909 0909 0909  .else:..........
-00051a10: 0909 6d69 6e69 5f73 7562 203d 206c 6d66  ..mini_sub = lmf
-00051a20: 6974 2e4d 696e 696d 697a 6572 2865 7272  it.Minimizer(err
-00051a30: 5f66 756e 635f 6d75 6c74 692c 7061 7264  _func_multi,pard
-00051a40: 665f 6c6f 6361 6c2c 6663 6e5f 6b77 733d  f_local,fcn_kws=
-00051a50: 7b27 6d75 6c74 695f 7072 6f6a 6563 7427  {'multi_project'
-00051a60: 3a6d 756c 7469 5f70 726f 6a65 6374 2c27  :multi_project,'
-00051a70: 756e 6971 7565 5f70 6172 616d 6574 6572  unique_parameter
-00051a80: 273a 756e 6971 7565 5f70 6172 616d 6574  ':unique_paramet
-00051a90: 6572 2c27 7765 6967 6874 7327 3a77 6569  er,'weights':wei
-00051aa0: 6768 7473 2c0d 0a09 0909 0909 0909 0909  ghts,...........
-00051ab0: 0909 0909 0909 0909 0909 0909 0909 0909  ................
-00051ac0: 0927 7361 6d65 5f44 4153 273a 7361 6d65  .'same_DAS':same
-00051ad0: 5f44 4153 2c27 6d6f 6427 3a6d 6f64 2c27  _DAS,'mod':mod,'
-00051ae0: 6c6f 675f 6669 7427 3a6c 6f67 5f66 6974  log_fit':log_fit
-00051af0: 2c27 6578 745f 7370 6563 7472 6127 3a65  ,'ext_spectra':e
-00051b00: 7874 5f73 7065 6374 7261 7d29 0d0a 0909  xt_spectra})....
-00051b10: 0909 0909 0909 0969 6620 6c65 6e28 7061  .......if len(pa
-00051b20: 7264 665b 7061 7264 662e 7661 7279 5d2e  rdf[pardf.vary].
-00051b30: 696e 6465 7829 3e33 3a0d 0a09 0909 0909  index)>3:.......
-00051b40: 0909 0909 0972 6573 756c 7473 5f73 7562  .....results_sub
-00051b50: 203d 206d 696e 695f 7375 622e 6d69 6e69   = mini_sub.mini
-00051b60: 6d69 7a65 2827 4e65 6c64 6572 272c 6f70  mize('Nelder',op
-00051b70: 7469 6f6e 733d 7b27 6d61 7869 7465 7227  tions={'maxiter'
-00051b80: 3a31 6535 2c27 6164 6170 7469 7665 273a  :1e5,'adaptive':
-00051b90: 5472 7565 7d29 0d0a 0909 0909 0909 0909  True})..........
-00051ba0: 0965 6c73 653a 0d0a 0909 0909 0909 0909  .else:..........
-00051bb0: 0909 7265 7375 6c74 735f 7375 6220 3d20  ..results_sub = 
-00051bc0: 6d69 6e69 5f73 7562 2e6d 696e 696d 697a  mini_sub.minimiz
-00051bd0: 6528 274e 656c 6465 7227 2c6f 7074 696f  e('Nelder',optio
-00051be0: 6e73 3d7b 276d 6178 6974 6572 273a 3165  ns={'maxiter':1e
-00051bf0: 357d 290d 0a09 0909 0909 0909 0909 6c6f  5})...........lo
-00051c00: 6361 6c5f 6572 726f 723d 2872 6573 756c  cal_error=(resul
-00051c10: 7473 5f73 7562 2e72 6573 6964 7561 6c5b  ts_sub.residual[
-00051c20: 305d 2d74 6172 6765 745f 7332 292a 2a32  0]-target_s2)**2
-00051c30: 0d0a 0909 0909 0909 0909 0972 6574 7572  ...........retur
-00051c40: 6e20 6c6f 6361 6c5f 6572 726f 720d 0a09  n local_error...
-00051c50: 0909 0909 0909 0965 6c73 653a 0d0a 0909  .......else:....
-00051c60: 0909 0909 0909 0969 6620 6d75 6c74 695f  .......if multi_
-00051c70: 7072 6f6a 6563 7420 6973 204e 6f6e 653a  project is None:
-00051c80: 0d0a 0909 0909 0909 0909 0909 7265 7475  ............retu
-00051c90: 726e 2065 7272 5f66 756e 6328 7061 7264  rn err_func(pard
-00051ca0: 665f 6c6f 6361 6c2c 6473 3d66 6974 5f64  f_local,ds=fit_d
-00051cb0: 732c 6d6f 643d 6d6f 642c 6c6f 675f 6669  s,mod=mod,log_fi
-00051cc0: 743d 6c6f 675f 6669 742c 6578 745f 7370  t=log_fit,ext_sp
-00051cd0: 6563 7472 613d 6578 745f 7370 6563 7472  ectra=ext_spectr
-00051ce0: 6129 0d0a 0909 0909 0909 0909 0965 6c73  a)...........els
-00051cf0: 653a 0d0a 0909 0909 0909 0909 0909 7265  e:............re
-00051d00: 7475 726e 2065 7272 5f66 756e 635f 6d75  turn err_func_mu
-00051d10: 6c74 6928 7061 7264 665f 6c6f 6361 6c2c  lti(pardf_local,
-00051d20: 6d75 6c74 695f 7072 6f6a 6563 743d 6d75  multi_project=mu
-00051d30: 6c74 695f 7072 6f6a 6563 742c 756e 6971  lti_project,uniq
-00051d40: 7565 5f70 6172 616d 6574 6572 3d75 6e69  ue_parameter=uni
-00051d50: 7175 655f 7061 7261 6d65 7465 722c 7765  que_parameter,we
-00051d60: 6967 6874 733d 7765 6967 6874 732c 6d6f  ights=weights,mo
-00051d70: 643d 6d6f 642c 6c6f 675f 6669 743d 6c6f  d=mod,log_fit=lo
-00051d80: 675f 6669 742c 6578 745f 7370 6563 7472  g_fit,ext_spectr
-00051d90: 613d 6578 745f 7370 6563 7472 6129 0d0a  a=ext_spectra)..
-00051da0: 0909 0909 0909 0974 7279 3a0d 0a09 0909  .......try:.....
-00051db0: 0909 0909 090d 0a09 0909 0909 0909 096d  ...............m
-00051dc0: 696e 695f 6c6f 6361 6c20 3d20 6c6d 6669  ini_local = lmfi
-00051dd0: 742e 4d69 6e69 6d69 7a65 7228 7375 625f  t.Minimizer(sub_
-00051de0: 7072 6f62 6c65 6d2c 7061 725f 6c6f 6361  problem,par_loca
-00051df0: 6c2c 6663 6e5f 6b77 733d 7b27 7661 7269  l,fcn_kws={'vari
-00051e00: 6564 5f70 6172 273a 6669 7865 645f 7061  ed_par':fixed_pa
-00051e10: 722c 2770 6172 6466 5f6c 6f63 616c 273a  r,'pardf_local':
-00051e20: 7061 7264 665f 6c6f 6361 6c2c 2766 6974  pardf_local,'fit
-00051e30: 5f64 7327 3a66 6974 5f64 732c 0d0a 0909  _ds':fit_ds,....
-00051e40: 0909 0909 0909 0909 0909 0909 0909 0909  ................
-00051e50: 0909 0909 0927 6d75 6c74 695f 7072 6f6a  .....'multi_proj
-00051e60: 6563 7427 3a6d 756c 7469 5f70 726f 6a65  ect':multi_proje
-00051e70: 6374 2c20 2775 6e69 7175 655f 7061 7261  ct, 'unique_para
-00051e80: 6d65 7465 7227 3a75 6e69 7175 655f 7061  meter':unique_pa
-00051e90: 7261 6d65 7465 722c 2773 616d 655f 4441  rameter,'same_DA
-00051ea0: 5327 3a73 616d 655f 4441 532c 2777 6569  S':same_DAS,'wei
-00051eb0: 6768 7473 273a 7765 6967 6874 732c 0d0a  ghts':weights,..
-00051ec0: 0909 0909 0909 0909 0909 0909 0909 0909  ................
-00051ed0: 0909 0909 0909 0927 6d6f 6427 3a6d 6f64  .......'mod':mod
-00051ee0: 2c27 6c6f 675f 6669 7427 3a73 656c 662e  ,'log_fit':self.
-00051ef0: 6c6f 675f 6669 742c 2774 6172 6765 745f  log_fit,'target_
-00051f00: 7332 273a 7461 7267 6574 5f73 322c 2765  s2':target_s2,'e
-00051f10: 7874 5f73 7065 6374 7261 273a 6578 745f  xt_spectra':ext_
-00051f20: 7370 6563 7472 617d 2909 0909 0909 0909  spectra}).......
-00051f30: 0d0a 0909 0909 0909 0909 6f6e 655f 7065  ..........one_pe
-00051f40: 7263 656e 745f 7072 6563 6973 7369 6f6e  rcent_precission
-00051f50: 3d28 7461 7267 6574 2d31 292a 302e 3031  =(target-1)*0.01
-00051f60: 2a72 655b 2765 7272 6f72 275d 0d0a 0909  *re['error']....
-00051f70: 0909 0909 0909 2372 6573 756c 7473 5f6c  ......#results_l
-00051f80: 6f63 616c 203d 206d 696e 695f 6c6f 6361  ocal = mini_loca
-00051f90: 6c2e 6d69 6e69 6d69 7a65 2827 6c65 6173  l.minimize('leas
-00051fa0: 745f 7371 7561 7265 7327 2c66 746f 6c3d  t_squares',ftol=
-00051fb0: 6f6e 655f 7065 7263 656e 745f 7072 6563  one_percent_prec
-00051fc0: 6973 7369 6f6e 290d 0a09 0909 0909 0909  ission).........
-00051fd0: 0972 6573 756c 7473 5f6c 6f63 616c 203d  .results_local =
-00051fe0: 206d 696e 695f 6c6f 6361 6c2e 6d69 6e69   mini_local.mini
-00051ff0: 6d69 7a65 286d 6574 686f 643d 276e 656c  mize(method='nel
-00052000: 6465 7227 2c6f 7074 696f 6e73 3d7b 276d  der',options={'m
-00052010: 6178 6974 6572 273a 3130 302c 2766 6174  axiter':100,'fat
-00052020: 6f6c 273a 6f6e 655f 7065 7263 656e 745f  ol':one_percent_
-00052030: 7072 6563 6973 7369 6f6e 7d29 0d0a 0909  precission})....
-00052040: 0909 0909 0909 6974 6572 6174 6976 655f  ......iterative_
-00052050: 6361 6c6c 732b 3d72 6573 756c 7473 5f6c  calls+=results_l
-00052060: 6f63 616c 2e6e 6665 760d 0a09 0909 0909  ocal.nfev.......
-00052070: 0909 0969 6620 7265 7375 6c74 735f 6c6f  ...if results_lo
-00052080: 6361 6c2e 7375 6363 6573 733a 0d0a 0909  cal.success:....
-00052090: 0909 0909 0909 0963 6f6e 665f 6c69 6d69  .......conf_limi
-000520a0: 7473 5b66 6978 6564 5f70 6172 5d5b 695d  ts[fixed_par][i]
-000520b0: 3d72 6573 756c 7473 5f6c 6f63 616c 2e70  =results_local.p
-000520c0: 6172 616d 735b 6669 7865 645f 7061 725d  arams[fixed_par]
-000520d0: 2e76 616c 7565 0d0a 0909 0909 0909 0909  .value..........
-000520e0: 656c 7365 3a0d 0a09 0909 0909 0909 0909  else:...........
-000520f0: 7072 696e 7428 2274 7269 6564 2074 6f20  print("tried to 
-00052100: 6f70 7469 6d69 7365 2025 6920 7469 6d65  optimise %i time
-00052110: 7320 6163 6869 6576 6564 2072 6573 6964  s achieved resid
-00052120: 7561 6c20 2567 2077 6974 6820 7461 7267  ual %g with targ
-00052130: 6574 6564 2025 6722 2528 7265 7375 6c74  eted %g"%(result
-00052140: 735f 6c6f 6361 6c2e 6e66 6576 2c28 6e70  s_local.nfev,(np
-00052150: 2e73 7172 7428 7265 7375 6c74 735f 6c6f  .sqrt(results_lo
-00052160: 6361 6c2e 7265 7369 6475 616c 5b30 5d29  cal.residual[0])
-00052170: 2b74 6172 6765 745f 7332 292c 7461 7267  +target_s2),targ
-00052180: 6574 5f73 3229 290d 0a09 0909 0909 0909  et_s2)).........
-00052190: 6578 6365 7074 3a0d 0a09 0909 0909 0909  except:.........
-000521a0: 0923 7072 696e 7428 2255 6e65 7870 6563  .#print("Unexpec
-000521b0: 7465 6420 6572 726f 723a 222c 2073 7973  ted error:", sys
-000521c0: 2e65 7863 5f69 6e66 6f28 295b 305d 290d  .exc_info()[0]).
-000521d0: 0a09 0909 0909 0909 0970 7269 6e74 2822  .........print("
-000521e0: 6572 726f 7220 696e 2025 7320 6174 2025  error in %s at %
-000521f0: 7320 6c69 6d69 7422 2528 6669 7865 645f  s limit"%(fixed_
-00052200: 7061 722c 6929 290d 0a09 0909 0909 0909  par,i)).........
-00052210: 0963 6f6e 7469 6e75 650d 0a09 0909 0965  .continue......e
-00052220: 6c73 653a 0d0a 0909 0909 0970 7269 6e74  lse:.......print
-00052230: 2822 706c 6561 7365 2075 7365 2061 2063  ("please use a c
-00052240: 6f6e 6669 6465 6e63 6520 6c65 7665 6c20  onfidence level 
-00052250: 6265 7477 6565 6e20 302e 3620 616e 6420  between 0.6 and 
-00052260: 3122 290d 0a09 0909 0909 7265 7475 726e  1").......return
-00052270: 2046 616c 7365 0d0a 0909 0909 7072 696e   False......prin
-00052280: 7428 2269 7420 746f 6f6b 2025 6920 6f70  t("it took %i op
-00052290: 7469 6d69 7361 7469 6f6e 7320 746f 2067  timisations to g
-000522a0: 6574 2074 6865 2063 6f6e 6669 6465 6e63  et the confidenc
-000522b0: 6522 2569 7465 7261 7469 7665 5f63 616c  e"%iterative_cal
-000522c0: 6c73 290d 0a09 090d 0a09 0923 2323 2323  ls)........#####
-000522d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000522e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000522f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00050fb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00050fc0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00050fd0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00050fe0: 2323 0d0a 0909 0d0a 0909 6966 2063 6f6e  ##........if con
+00050ff0: 6669 6465 6e63 655f 6c65 7665 6c20 6973  fidence_level is
+00051000: 206e 6f74 204e 6f6e 653a 236f 6b20 7765   not None:#ok we
+00051010: 2063 616c 6375 6c61 7465 2065 7272 6f72   calculate error
+00051020: 7320 746f 2074 6865 206c 6576 656c 206f  s to the level o
+00051030: 6620 7468 6520 636f 6e66 6964 656e 6365  f the confidence
+00051040: 5f6c 6576 656c 0d0a 0909 0969 6620 7365  _level.....if se
+00051050: 6c66 2e6c 6f67 5f66 6974 3a0d 0a09 0909  lf.log_fit:.....
+00051060: 0966 6f72 206b 6579 2069 6e20 5b27 7661  .for key in ['va
+00051070: 6c75 6527 2c27 6d69 6e27 2c27 6d61 7827  lue','min','max'
+00051080: 5d3a 0d0a 0909 0909 0970 6172 6466 2e6c  ]:.......pardf.l
+00051090: 6f63 5b70 6172 6466 2e69 735f 7261 7465  oc[pardf.is_rate
+000510a0: 2c6b 6579 5d3d 7061 7264 662e 6c6f 635b  ,key]=pardf.loc[
+000510b0: 7061 7264 662e 6973 5f72 6174 652c 6b65  pardf.is_rate,ke
+000510c0: 795d 2e61 7070 6c79 286c 616d 6264 6120  y].apply(lambda 
+000510d0: 783a 206e 702e 6c6f 6731 3028 7829 290d  x: np.log10(x)).
+000510e0: 0a09 0909 6966 2070 6172 6466 2e76 6172  ....if pardf.var
+000510f0: 792e 616e 7928 293a 2377 6520 6163 7475  y.any():#we actu
+00051100: 616c 6c79 2068 6176 6520 6f70 7469 6d69  ally have optimi
+00051110: 7365 6420 736f 6d65 7468 696e 670d 0a09  sed something...
+00051120: 0909 0969 6620 2830 2e36 203c 2063 6f6e  ...if (0.6 < con
+00051130: 6669 6465 6e63 655f 6c65 7665 6c20 3c20  fidence_level < 
+00051140: 3129 206f 7220 2831 203c 2063 6f6e 6669  1) or (1 < confi
+00051150: 6465 6e63 655f 6c65 7665 6c20 3c20 302e  dence_level < 0.
+00051160: 3629 3a0d 0a09 0909 0909 6966 206d 756c  6):.......if mul
+00051170: 7469 5f70 726f 6a65 6374 2069 7320 4e6f  ti_project is No
+00051180: 6e65 3a0d 0a09 0909 0909 0974 6172 6765  ne:........targe
+00051190: 743d 7332 5f76 735f 736d 696e 3228 5370  t=s2_vs_smin2(Sp
+000511a0: 6563 7472 616c 5f70 6f69 6e74 733d 6c65  ectral_points=le
+000511b0: 6e28 7265 5b27 4127 5d2e 636f 6c75 6d6e  n(re['A'].column
+000511c0: 7329 2c54 696d 655f 706f 696e 7473 3d6c  s),Time_points=l
+000511d0: 656e 2872 655b 2741 275d 2e69 6e64 6578  en(re['A'].index
+000511e0: 292c 6e75 6d62 6572 5f6f 665f 7370 6563  ),number_of_spec
+000511f0: 6965 733d 6c65 6e28 7265 5b27 4441 4327  ies=len(re['DAC'
+00051200: 5d2e 636f 6c75 6d6e 7329 2c66 6974 7465  ].columns),fitte
+00051210: 645f 6b69 6e65 7469 635f 7061 7273 3d6c  d_kinetic_pars=l
+00051220: 656e 2870 6172 6466 5b70 6172 6466 2e76  en(pardf[pardf.v
+00051230: 6172 795d 2e69 6e64 6578 292c 7461 7267  ary].index),targ
+00051240: 6574 5f71 7561 6c69 7479 3d63 6f6e 6669  et_quality=confi
+00051250: 6465 6e63 655f 6c65 7665 6c29 0d0a 0909  dence_level)....
+00051260: 0909 0965 6c73 653a 0d0a 0909 0909 0909  ...else:........
+00051270: 6d75 6c74 695f 7072 6f6a 6563 742e 696e  multi_project.in
+00051280: 7365 7274 2830 2c73 656c 6629 0d0a 0909  sert(0,self)....
+00051290: 0909 0909 2320 7765 2061 7373 756d 6520  ....# we assume 
+000512a0: 7468 6174 2077 6520 6861 7665 2074 6865  that we have the
+000512b0: 2073 616d 6520 6e75 6d62 6572 206f 6620   same number of 
+000512c0: 7370 6563 7461 6c20 706f 696e 7473 2062  spectal points b
+000512d0: 7574 2061 7265 2073 7461 636b 696e 6720  ut are stacking 
+000512e0: 7468 6520 7469 6d65 730d 0a09 0909 0909  the times.......
+000512f0: 0974 6f74 616c 5f74 696d 655f 706f 696e  .total_time_poin
+00051300: 7473 3d6e 702e 6172 7261 7928 5b6c 656e  ts=np.array([len
+00051310: 2874 2e72 655b 2741 275d 2e69 6e64 6578  (t.re['A'].index
+00051320: 2920 666f 7220 7420 696e 206d 756c 7469  ) for t in multi
+00051330: 5f70 726f 6a65 6374 5d29 2e73 756d 2829  _project]).sum()
+00051340: 0909 0909 090d 0a09 0909 0909 0974 6172  .............tar
+00051350: 6765 743d 7332 5f76 735f 736d 696e 3228  get=s2_vs_smin2(
+00051360: 5370 6563 7472 616c 5f70 6f69 6e74 733d  Spectral_points=
+00051370: 6c65 6e28 7265 5b27 4127 5d2e 636f 6c75  len(re['A'].colu
+00051380: 6d6e 7329 2c54 696d 655f 706f 696e 7473  mns),Time_points
+00051390: 3d74 6f74 616c 5f74 696d 655f 706f 696e  =total_time_poin
+000513a0: 7473 2c6e 756d 6265 725f 6f66 5f73 7065  ts,number_of_spe
+000513b0: 6369 6573 3d6c 656e 2872 655b 2744 4143  cies=len(re['DAC
+000513c0: 275d 2e63 6f6c 756d 6e73 292c 6669 7474  '].columns),fitt
+000513d0: 6564 5f6b 696e 6574 6963 5f70 6172 733d  ed_kinetic_pars=
+000513e0: 6c65 6e28 7061 7264 665b 7061 7264 662e  len(pardf[pardf.
+000513f0: 7661 7279 5d2e 696e 6465 7829 2c74 6172  vary].index),tar
+00051400: 6765 745f 7175 616c 6974 793d 636f 6e66  get_quality=conf
+00051410: 6964 656e 6365 5f6c 6576 656c 290d 0a09  idence_level)...
+00051420: 0909 0909 2370 7269 6e74 2874 6172 6765  ....#print(targe
+00051430: 7429 0d0a 0909 0909 0974 6172 6765 745f  t).......target_
+00051440: 7332 3d72 655b 2765 7272 6f72 275d 2a74  s2=re['error']*t
+00051450: 6172 6765 740d 0a09 0909 0909 6c69 7374  arget.......list
+00051460: 5f6f 665f 7661 7269 6162 6c65 5f70 6172  _of_variable_par
+00051470: 616d 6574 6572 3d70 6172 6466 5b70 6172  ameter=pardf[par
+00051480: 6466 2e76 6172 795d 2e69 6e64 6578 2e76  df.vary].index.v
+00051490: 616c 7565 730d 0a09 0909 0909 636f 6e66  alues.......conf
+000514a0: 5f6c 696d 6974 733d 7b7d 0d0a 0909 0909  _limits={}......
+000514b0: 0969 7465 7261 7469 7665 5f63 616c 6c73  .iterative_calls
+000514c0: 3d30 0d0a 0909 0909 0966 6f72 2066 6978  =0.......for fix
+000514d0: 6564 5f70 6172 2069 6e20 6c69 7374 5f6f  ed_par in list_o
+000514e0: 665f 7661 7269 6162 6c65 5f70 6172 616d  f_variable_param
+000514f0: 6574 6572 3a0d 0a09 0909 0909 0963 6f6e  eter:........con
+00051500: 665f 6c69 6d69 7473 5b66 6978 6564 5f70  f_limits[fixed_p
+00051510: 6172 5d3d 7b27 7570 7065 7227 3a4e 6f6e  ar]={'upper':Non
+00051520: 652c 276c 6f77 6572 273a 4e6f 6e65 7d0d  e,'lower':None}.
+00051530: 0a09 0909 0909 0966 6f72 2069 2069 6e20  .......for i in 
+00051540: 5b27 6c6f 7765 7227 2c27 7570 7065 7227  ['lower','upper'
+00051550: 5d3a 0d0a 0909 0909 0909 0970 7269 6e74  ]:.........print
+00051560: 2827 5472 7969 6e67 2074 6f20 6669 6e64  ('Trying to find
+00051570: 2025 732c 2025 7320 636f 6e66 6964 656e   %s, %s confiden
+00051580: 6365 206c 696d 6974 2725 2866 6978 6564  ce limit'%(fixed
+00051590: 5f70 6172 2c69 2929 0d0a 0909 0909 0909  _par,i))........
+000515a0: 0970 6172 6466 5f6c 6f63 616c 3d73 656c  .pardf_local=sel
+000515b0: 662e 7061 725f 6669 742e 636f 7079 2829  f.par_fit.copy()
+000515c0: 0d0a 0909 0909 0909 0970 6172 6466 5f6c  .........pardf_l
+000515d0: 6f63 616c 5b66 6978 6564 5f70 6172 5d2e  ocal[fixed_par].
+000515e0: 7661 7279 3d46 616c 7365 0d0a 0909 0909  vary=False......
+000515f0: 0909 0970 6172 5f6c 6f63 616c 3d6c 6d66  ...par_local=lmf
+00051600: 6974 2e50 6172 616d 6574 6572 7328 290d  it.Parameters().
+00051610: 0a09 0909 0909 0909 6966 2027 6c6f 7765  ........if 'lowe
+00051620: 7227 2069 6e20 693a 2367 6f20 6265 6c6f  r' in i:#go belo
+00051630: 7720 6d69 6e0d 0a09 0909 0909 0909 0969  w min..........i
+00051640: 6620 7061 725f 746f 5f70 6172 6466 2870  f par_to_pardf(p
+00051650: 6172 6466 5f6c 6f63 616c 292e 6c6f 635b  ardf_local).loc[
+00051660: 6669 7865 645f 7061 722c 2769 735f 7261  fixed_par,'is_ra
+00051670: 7465 275d 3a0d 0a09 0909 0909 0909 0909  te']:...........
+00051680: 7061 725f 6c6f 6361 6c2e 6164 6428 6669  par_local.add(fi
+00051690: 7865 645f 7061 722c 7661 6c75 653d 7061  xed_par,value=pa
+000516a0: 7264 665f 6c6f 6361 6c5b 6669 7865 645f  rdf_local[fixed_
+000516b0: 7061 725d 2e76 616c 7565 2a30 2e39 352c  par].value*0.95,
+000516c0: 6d69 6e3d 302c 6d61 783d 7061 7264 665f  min=0,max=pardf_
+000516d0: 6c6f 6361 6c5b 6669 7865 645f 7061 725d  local[fixed_par]
+000516e0: 2e76 616c 7565 2c76 6172 793d 7661 7279  .value,vary=vary
+000516f0: 5f65 7272 6f72 5f70 6172 616d 6574 6572  _error_parameter
+00051700: 290d 0a09 0909 0909 0909 0965 6c73 653a  )..........else:
+00051710: 0d0a 0909 0909 0909 0909 0970 6172 5f6c  ...........par_l
+00051720: 6f63 616c 2e61 6464 2866 6978 6564 5f70  ocal.add(fixed_p
+00051730: 6172 2c76 616c 7565 3d70 6172 6466 5f6c  ar,value=pardf_l
+00051740: 6f63 616c 5b66 6978 6564 5f70 6172 5d2e  ocal[fixed_par].
+00051750: 7661 6c75 652a 302e 3935 2c6d 6178 3d70  value*0.95,max=p
+00051760: 6172 6466 5f6c 6f63 616c 5b66 6978 6564  ardf_local[fixed
+00051770: 5f70 6172 5d2e 7661 6c75 652c 7661 7279  _par].value,vary
+00051780: 3d76 6172 795f 6572 726f 725f 7061 7261  =vary_error_para
+00051790: 6d65 7465 7229 0d0a 0909 0909 0909 0965  meter).........e
+000517a0: 6c73 653a 2023 676f 2061 626f 7665 206d  lse: #go above m
+000517b0: 696e 0d0a 0909 0909 0909 0909 7061 725f  in..........par_
+000517c0: 6c6f 6361 6c2e 6164 6428 6669 7865 645f  local.add(fixed_
+000517d0: 7061 722c 7661 6c75 653d 7061 7264 665f  par,value=pardf_
+000517e0: 6c6f 6361 6c5b 6669 7865 645f 7061 725d  local[fixed_par]
+000517f0: 2e76 616c 7565 2a31 2e30 352c 6d69 6e3d  .value*1.05,min=
+00051800: 7061 7264 665f 6c6f 6361 6c5b 6669 7865  pardf_local[fixe
+00051810: 645f 7061 725d 2e76 616c 7565 2c76 6172  d_par].value,var
+00051820: 793d 7661 7279 5f65 7272 6f72 5f70 6172  y=vary_error_par
+00051830: 616d 6574 6572 290d 0a09 0909 0909 0909  ameter).........
+00051840: 0d0a 0909 0909 0909 0964 6566 2073 7562  .........def sub
+00051850: 5f70 726f 626c 656d 2870 6172 5f6c 6f63  _problem(par_loc
+00051860: 616c 2c76 6172 6965 645f 7061 722c 7061  al,varied_par,pa
+00051870: 7264 665f 6c6f 6361 6c2c 6669 745f 6473  rdf_local,fit_ds
+00051880: 3d4e 6f6e 652c 6d6f 643d 4e6f 6e65 2c6c  =None,mod=None,l
+00051890: 6f67 5f66 6974 3d4e 6f6e 652c 6d75 6c74  og_fit=None,mult
+000518a0: 695f 7072 6f6a 6563 743d 4e6f 6e65 2c75  i_project=None,u
+000518b0: 6e69 7175 655f 7061 7261 6d65 7465 723d  nique_parameter=
+000518c0: 4e6f 6e65 2c77 6569 6768 7473 3d4e 6f6e  None,weights=Non
+000518d0: 652c 7461 7267 6574 5f73 323d 4e6f 6e65  e,target_s2=None
+000518e0: 2c65 7874 5f73 7065 6374 7261 3d4e 6f6e  ,ext_spectra=Non
+000518f0: 652c 7361 6d65 5f44 4153 3d46 616c 7365  e,same_DAS=False
+00051900: 2029 3a0d 0a09 0909 0909 0909 0970 6172   ):..........par
+00051910: 6466 5f6c 6f63 616c 5b76 6172 6965 645f  df_local[varied_
+00051920: 7061 725d 2e76 616c 7565 3d70 6172 5f6c  par].value=par_l
+00051930: 6f63 616c 5b76 6172 6965 645f 7061 725d  ocal[varied_par]
+00051940: 2e76 616c 7565 0d0a 0909 0909 0909 0909  .value..........
+00051950: 6966 2070 6172 5f74 6f5f 7061 7264 6628  if par_to_pardf(
+00051960: 7061 7264 665f 6c6f 6361 6c29 2e76 6172  pardf_local).var
+00051970: 792e 616e 7928 293a 0d0a 0909 0909 0909  y.any():........
+00051980: 0909 0969 6620 6d75 6c74 695f 7072 6f6a  ...if multi_proj
+00051990: 6563 7420 6973 204e 6f6e 653a 0d0a 0909  ect is None:....
+000519a0: 0909 0909 0909 0909 6d69 6e69 5f73 7562  ........mini_sub
+000519b0: 203d 206c 6d66 6974 2e4d 696e 696d 697a   = lmfit.Minimiz
+000519c0: 6572 2865 7272 5f66 756e 632c 7061 7264  er(err_func,pard
+000519d0: 665f 6c6f 6361 6c2c 6663 6e5f 6b77 733d  f_local,fcn_kws=
+000519e0: 7b27 6473 273a 6669 745f 6473 2c27 6d6f  {'ds':fit_ds,'mo
+000519f0: 6427 3a6d 6f64 2c27 6c6f 675f 6669 7427  d':mod,'log_fit'
+00051a00: 3a6c 6f67 5f66 6974 2c27 6578 745f 7370  :log_fit,'ext_sp
+00051a10: 6563 7472 6127 3a65 7874 5f73 7065 6374  ectra':ext_spect
+00051a20: 7261 7d29 0d0a 0909 0909 0909 0909 0965  ra})...........e
+00051a30: 6c73 653a 0d0a 0909 0909 0909 0909 0909  lse:............
+00051a40: 6d69 6e69 5f73 7562 203d 206c 6d66 6974  mini_sub = lmfit
+00051a50: 2e4d 696e 696d 697a 6572 2865 7272 5f66  .Minimizer(err_f
+00051a60: 756e 635f 6d75 6c74 692c 7061 7264 665f  unc_multi,pardf_
+00051a70: 6c6f 6361 6c2c 6663 6e5f 6b77 733d 7b27  local,fcn_kws={'
+00051a80: 6d75 6c74 695f 7072 6f6a 6563 7427 3a6d  multi_project':m
+00051a90: 756c 7469 5f70 726f 6a65 6374 2c27 756e  ulti_project,'un
+00051aa0: 6971 7565 5f70 6172 616d 6574 6572 273a  ique_parameter':
+00051ab0: 756e 6971 7565 5f70 6172 616d 6574 6572  unique_parameter
+00051ac0: 2c27 7765 6967 6874 7327 3a77 6569 6768  ,'weights':weigh
+00051ad0: 7473 2c0d 0a09 0909 0909 0909 0909 0909  ts,.............
+00051ae0: 0909 0909 0909 0909 0909 0909 0909 0927  ...............'
+00051af0: 7361 6d65 5f44 4153 273a 7361 6d65 5f44  same_DAS':same_D
+00051b00: 4153 2c27 6d6f 6427 3a6d 6f64 2c27 6c6f  AS,'mod':mod,'lo
+00051b10: 675f 6669 7427 3a6c 6f67 5f66 6974 2c27  g_fit':log_fit,'
+00051b20: 6578 745f 7370 6563 7472 6127 3a65 7874  ext_spectra':ext
+00051b30: 5f73 7065 6374 7261 7d29 0d0a 0909 0909  _spectra})......
+00051b40: 0909 0909 0969 6620 6c65 6e28 7061 7264  .....if len(pard
+00051b50: 665b 7061 7264 662e 7661 7279 5d2e 696e  f[pardf.vary].in
+00051b60: 6465 7829 3e33 3a0d 0a09 0909 0909 0909  dex)>3:.........
+00051b70: 0909 0972 6573 756c 7473 5f73 7562 203d  ...results_sub =
+00051b80: 206d 696e 695f 7375 622e 6d69 6e69 6d69   mini_sub.minimi
+00051b90: 7a65 2827 4e65 6c64 6572 272c 6f70 7469  ze('Nelder',opti
+00051ba0: 6f6e 733d 7b27 6d61 7869 7465 7227 3a31  ons={'maxiter':1
+00051bb0: 6535 2c27 6164 6170 7469 7665 273a 5472  e5,'adaptive':Tr
+00051bc0: 7565 7d29 0d0a 0909 0909 0909 0909 0965  ue})...........e
+00051bd0: 6c73 653a 0d0a 0909 0909 0909 0909 0909  lse:............
+00051be0: 7265 7375 6c74 735f 7375 6220 3d20 6d69  results_sub = mi
+00051bf0: 6e69 5f73 7562 2e6d 696e 696d 697a 6528  ni_sub.minimize(
+00051c00: 274e 656c 6465 7227 2c6f 7074 696f 6e73  'Nelder',options
+00051c10: 3d7b 276d 6178 6974 6572 273a 3165 357d  ={'maxiter':1e5}
+00051c20: 290d 0a09 0909 0909 0909 0909 6c6f 6361  )...........loca
+00051c30: 6c5f 6572 726f 723d 2872 6573 756c 7473  l_error=(results
+00051c40: 5f73 7562 2e72 6573 6964 7561 6c5b 305d  _sub.residual[0]
+00051c50: 2d74 6172 6765 745f 7332 292a 2a32 0d0a  -target_s2)**2..
+00051c60: 0909 0909 0909 0909 0972 6574 7572 6e20  .........return 
+00051c70: 6c6f 6361 6c5f 6572 726f 720d 0a09 0909  local_error.....
+00051c80: 0909 0909 0965 6c73 653a 0d0a 0909 0909  .....else:......
+00051c90: 0909 0909 0969 6620 6d75 6c74 695f 7072  .....if multi_pr
+00051ca0: 6f6a 6563 7420 6973 204e 6f6e 653a 0d0a  oject is None:..
+00051cb0: 0909 0909 0909 0909 0909 7265 7475 726e  ..........return
+00051cc0: 2065 7272 5f66 756e 6328 7061 7264 665f   err_func(pardf_
+00051cd0: 6c6f 6361 6c2c 6473 3d66 6974 5f64 732c  local,ds=fit_ds,
+00051ce0: 6d6f 643d 6d6f 642c 6c6f 675f 6669 743d  mod=mod,log_fit=
+00051cf0: 6c6f 675f 6669 742c 6578 745f 7370 6563  log_fit,ext_spec
+00051d00: 7472 613d 6578 745f 7370 6563 7472 6129  tra=ext_spectra)
+00051d10: 0d0a 0909 0909 0909 0909 0965 6c73 653a  ...........else:
+00051d20: 0d0a 0909 0909 0909 0909 0909 7265 7475  ............retu
+00051d30: 726e 2065 7272 5f66 756e 635f 6d75 6c74  rn err_func_mult
+00051d40: 6928 7061 7264 665f 6c6f 6361 6c2c 6d75  i(pardf_local,mu
+00051d50: 6c74 695f 7072 6f6a 6563 743d 6d75 6c74  lti_project=mult
+00051d60: 695f 7072 6f6a 6563 742c 756e 6971 7565  i_project,unique
+00051d70: 5f70 6172 616d 6574 6572 3d75 6e69 7175  _parameter=uniqu
+00051d80: 655f 7061 7261 6d65 7465 722c 7765 6967  e_parameter,weig
+00051d90: 6874 733d 7765 6967 6874 732c 6d6f 643d  hts=weights,mod=
+00051da0: 6d6f 642c 6c6f 675f 6669 743d 6c6f 675f  mod,log_fit=log_
+00051db0: 6669 742c 6578 745f 7370 6563 7472 613d  fit,ext_spectra=
+00051dc0: 6578 745f 7370 6563 7472 6129 0d0a 0909  ext_spectra)....
+00051dd0: 0909 0909 0974 7279 3a0d 0a09 0909 0909  .....try:.......
+00051de0: 0909 090d 0a09 0909 0909 0909 096d 696e  .............min
+00051df0: 695f 6c6f 6361 6c20 3d20 6c6d 6669 742e  i_local = lmfit.
+00051e00: 4d69 6e69 6d69 7a65 7228 7375 625f 7072  Minimizer(sub_pr
+00051e10: 6f62 6c65 6d2c 7061 725f 6c6f 6361 6c2c  oblem,par_local,
+00051e20: 6663 6e5f 6b77 733d 7b27 7661 7269 6564  fcn_kws={'varied
+00051e30: 5f70 6172 273a 6669 7865 645f 7061 722c  _par':fixed_par,
+00051e40: 2770 6172 6466 5f6c 6f63 616c 273a 7061  'pardf_local':pa
+00051e50: 7264 665f 6c6f 6361 6c2c 2766 6974 5f64  rdf_local,'fit_d
+00051e60: 7327 3a66 6974 5f64 732c 0d0a 0909 0909  s':fit_ds,......
+00051e70: 0909 0909 0909 0909 0909 0909 0909 0909  ................
+00051e80: 0909 0927 6d75 6c74 695f 7072 6f6a 6563  ...'multi_projec
+00051e90: 7427 3a6d 756c 7469 5f70 726f 6a65 6374  t':multi_project
+00051ea0: 2c20 2775 6e69 7175 655f 7061 7261 6d65  , 'unique_parame
+00051eb0: 7465 7227 3a75 6e69 7175 655f 7061 7261  ter':unique_para
+00051ec0: 6d65 7465 722c 2773 616d 655f 4441 5327  meter,'same_DAS'
+00051ed0: 3a73 616d 655f 4441 532c 2777 6569 6768  :same_DAS,'weigh
+00051ee0: 7473 273a 7765 6967 6874 732c 0d0a 0909  ts':weights,....
+00051ef0: 0909 0909 0909 0909 0909 0909 0909 0909  ................
+00051f00: 0909 0909 0927 6d6f 6427 3a6d 6f64 2c27  .....'mod':mod,'
+00051f10: 6c6f 675f 6669 7427 3a73 656c 662e 6c6f  log_fit':self.lo
+00051f20: 675f 6669 742c 2774 6172 6765 745f 7332  g_fit,'target_s2
+00051f30: 273a 7461 7267 6574 5f73 322c 2765 7874  ':target_s2,'ext
+00051f40: 5f73 7065 6374 7261 273a 6578 745f 7370  _spectra':ext_sp
+00051f50: 6563 7472 617d 2909 0909 0909 0909 0d0a  ectra}).........
+00051f60: 0909 0909 0909 0909 6f6e 655f 7065 7263  ........one_perc
+00051f70: 656e 745f 7072 6563 6973 7369 6f6e 3d28  ent_precission=(
+00051f80: 7461 7267 6574 2d31 292a 302e 3031 2a72  target-1)*0.01*r
+00051f90: 655b 2765 7272 6f72 275d 0d0a 0909 0909  e['error']......
+00051fa0: 0909 0909 2372 6573 756c 7473 5f6c 6f63  ....#results_loc
+00051fb0: 616c 203d 206d 696e 695f 6c6f 6361 6c2e  al = mini_local.
+00051fc0: 6d69 6e69 6d69 7a65 2827 6c65 6173 745f  minimize('least_
+00051fd0: 7371 7561 7265 7327 2c66 746f 6c3d 6f6e  squares',ftol=on
+00051fe0: 655f 7065 7263 656e 745f 7072 6563 6973  e_percent_precis
+00051ff0: 7369 6f6e 290d 0a09 0909 0909 0909 0972  sion)..........r
+00052000: 6573 756c 7473 5f6c 6f63 616c 203d 206d  esults_local = m
+00052010: 696e 695f 6c6f 6361 6c2e 6d69 6e69 6d69  ini_local.minimi
+00052020: 7a65 286d 6574 686f 643d 276e 656c 6465  ze(method='nelde
+00052030: 7227 2c6f 7074 696f 6e73 3d7b 276d 6178  r',options={'max
+00052040: 6974 6572 273a 3130 302c 2766 6174 6f6c  iter':100,'fatol
+00052050: 273a 6f6e 655f 7065 7263 656e 745f 7072  ':one_percent_pr
+00052060: 6563 6973 7369 6f6e 7d29 0d0a 0909 0909  ecission})......
+00052070: 0909 0909 6974 6572 6174 6976 655f 6361  ....iterative_ca
+00052080: 6c6c 732b 3d72 6573 756c 7473 5f6c 6f63  lls+=results_loc
+00052090: 616c 2e6e 6665 760d 0a09 0909 0909 0909  al.nfev.........
+000520a0: 0969 6620 7265 7375 6c74 735f 6c6f 6361  .if results_loca
+000520b0: 6c2e 7375 6363 6573 733a 0d0a 0909 0909  l.success:......
+000520c0: 0909 0909 0963 6f6e 665f 6c69 6d69 7473  .....conf_limits
+000520d0: 5b66 6978 6564 5f70 6172 5d5b 695d 3d72  [fixed_par][i]=r
+000520e0: 6573 756c 7473 5f6c 6f63 616c 2e70 6172  esults_local.par
+000520f0: 616d 735b 6669 7865 645f 7061 725d 2e76  ams[fixed_par].v
+00052100: 616c 7565 0d0a 0909 0909 0909 0909 656c  alue..........el
+00052110: 7365 3a0d 0a09 0909 0909 0909 0909 7072  se:...........pr
+00052120: 696e 7428 2274 7269 6564 2074 6f20 6f70  int("tried to op
+00052130: 7469 6d69 7365 2025 6920 7469 6d65 7320  timise %i times 
+00052140: 6163 6869 6576 6564 2072 6573 6964 7561  achieved residua
+00052150: 6c20 2567 2077 6974 6820 7461 7267 6574  l %g with target
+00052160: 6564 2025 6722 2528 7265 7375 6c74 735f  ed %g"%(results_
+00052170: 6c6f 6361 6c2e 6e66 6576 2c28 6e70 2e73  local.nfev,(np.s
+00052180: 7172 7428 7265 7375 6c74 735f 6c6f 6361  qrt(results_loca
+00052190: 6c2e 7265 7369 6475 616c 5b30 5d29 2b74  l.residual[0])+t
+000521a0: 6172 6765 745f 7332 292c 7461 7267 6574  arget_s2),target
+000521b0: 5f73 3229 290d 0a09 0909 0909 0909 6578  _s2)).........ex
+000521c0: 6365 7074 3a0d 0a09 0909 0909 0909 0923  cept:..........#
+000521d0: 7072 696e 7428 2255 6e65 7870 6563 7465  print("Unexpecte
+000521e0: 6420 6572 726f 723a 222c 2073 7973 2e65  d error:", sys.e
+000521f0: 7863 5f69 6e66 6f28 295b 305d 290d 0a09  xc_info()[0])...
+00052200: 0909 0909 0909 0970 7269 6e74 2822 6572  .......print("er
+00052210: 726f 7220 696e 2025 7320 6174 2025 7320  ror in %s at %s 
+00052220: 6c69 6d69 7422 2528 6669 7865 645f 7061  limit"%(fixed_pa
+00052230: 722c 6929 290d 0a09 0909 0909 0909 0963  r,i))..........c
+00052240: 6f6e 7469 6e75 650d 0a09 0909 0965 6c73  ontinue......els
+00052250: 653a 0d0a 0909 0909 0970 7269 6e74 2822  e:.......print("
+00052260: 706c 6561 7365 2075 7365 2061 2063 6f6e  please use a con
+00052270: 6669 6465 6e63 6520 6c65 7665 6c20 6265  fidence level be
+00052280: 7477 6565 6e20 302e 3620 616e 6420 3122  tween 0.6 and 1"
+00052290: 290d 0a09 0909 0909 7265 7475 726e 2046  ).......return F
+000522a0: 616c 7365 0d0a 0909 0909 7072 696e 7428  alse......print(
+000522b0: 2269 7420 746f 6f6b 2025 6920 6f70 7469  "it took %i opti
+000522c0: 6d69 7361 7469 6f6e 7320 746f 2067 6574  misations to get
+000522d0: 2074 6865 2063 6f6e 6669 6465 6e63 6522   the confidence"
+000522e0: 2569 7465 7261 7469 7665 5f63 616c 6c73  %iterative_calls
+000522f0: 290d 0a09 090d 0a09 0923 2323 2323 2323  )........#######
 00052300: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00052310: 2323 2323 2323 2309 090d 0a09 0923 2d2d  #######......#--
-00052320: 2d2d 2d70 7265 7061 7265 2066 7261 6d65  ---prepare frame
-00052330: 7320 666f 7220 7374 6f72 6167 6520 7769  s for storage wi
-00052340: 7468 6f75 7420 636f 6e66 6964 656e 6365  thout confidence
-00052350: 2061 6e64 2073 746f 7265 2074 6865 6d2d   and store them-
-00052360: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00052370: 2d2d 2d2d 2d2d 2d0d 0a09 0923 2323 2323  -------....#####
-00052380: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00052390: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000523a0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00052310: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00052320: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00052330: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00052340: 2323 2323 2309 090d 0a09 0923 2d2d 2d2d  #####......#----
+00052350: 2d70 7265 7061 7265 2066 7261 6d65 7320  -prepare frames 
+00052360: 666f 7220 7374 6f72 6167 6520 7769 7468  for storage with
+00052370: 6f75 7420 636f 6e66 6964 656e 6365 2061  out confidence a
+00052380: 6e64 2073 746f 7265 2074 6865 6d2d 2d2d  nd store them---
+00052390: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+000523a0: 2d2d 2d2d 2d0d 0a09 0923 2323 2323 2323  -----....#######
 000523b0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000523c0: 2323 2323 2323 230d 0a09 090d 0a09 0969  #######........i
-000523d0: 6620 7061 7264 662e 7661 7279 2e61 6e79  f pardf.vary.any
-000523e0: 2829 3a0d 0a09 0909 7265 5b27 6669 745f  ():.....re['fit_
-000523f0: 6f75 7470 7574 275d 3d72 6573 756c 7473  output']=results
-00052400: 236c 6574 2773 2073 746f 7265 2074 6865  #let's store the
-00052410: 2066 6974 2072 6573 756c 7473 2069 6e20   fit results in 
-00052420: 7468 6520 7265 5f6f 626a 6563 7420 666f  the re_object fo
-00052430: 7220 6e6f 772e 0d0a 0909 0969 6620 636f  r now......if co
-00052440: 6e66 6964 656e 6365 5f6c 6576 656c 2069  nfidence_level i
-00052450: 7320 6e6f 7420 4e6f 6e65 3a0d 0a09 0909  s not None:.....
-00052460: 0972 655b 2763 6f6e 6669 6465 6e63 6527  .re['confidence'
-00052470: 5d3d 636f 6e66 5f6c 696d 6974 730d 0a09  ]=conf_limits...
-00052480: 0909 0970 6172 6466 2e69 6e73 6572 7428  ...pardf.insert(
-00052490: 6c65 6e28 7061 7264 662e 636f 6c75 6d6e  len(pardf.column
-000524a0: 7329 2c27 6c6f 7765 725f 6c69 6d69 7427  s),'lower_limit'
-000524b0: 2c4e 6f6e 6529 0d0a 0909 0909 7061 7264  ,None)......pard
-000524c0: 662e 696e 7365 7274 286c 656e 2870 6172  f.insert(len(par
-000524d0: 6466 2e63 6f6c 756d 6e73 292c 2775 7070  df.columns),'upp
-000524e0: 6572 5f6c 696d 6974 272c 4e6f 6e65 290d  er_limit',None).
-000524f0: 0a09 0909 0966 6f72 206b 6579 2069 6e20  .....for key in 
-00052500: 636f 6e66 5f6c 696d 6974 732e 6b65 7973  conf_limits.keys
-00052510: 2829 3a0d 0a09 0909 0909 7061 7264 662e  ():.......pardf.
-00052520: 6c6f 635b 6b65 792c 276c 6f77 6572 5f6c  loc[key,'lower_l
-00052530: 696d 6974 275d 3d63 6f6e 665f 6c69 6d69  imit']=conf_limi
-00052540: 7473 5b6b 6579 5d5b 276c 6f77 6572 275d  ts[key]['lower']
-00052550: 0d0a 0909 0909 0970 6172 6466 2e6c 6f63  .......pardf.loc
-00052560: 5b6b 6579 2c27 7570 7065 725f 6c69 6d69  [key,'upper_limi
-00052570: 7427 5d3d 636f 6e66 5f6c 696d 6974 735b  t']=conf_limits[
-00052580: 6b65 795d 5b27 7570 7065 7227 5d0d 0a09  key]['upper']...
-00052590: 0909 0969 6620 7365 6c66 2e6c 6f67 5f66  ...if self.log_f
-000525a0: 6974 3a0d 0a09 0909 0909 666f 7220 6b65  it:.......for ke
-000525b0: 7920 696e 205b 2776 616c 7565 272c 276d  y in ['value','m
-000525c0: 696e 272c 276d 6178 272c 276c 6f77 6572  in','max','lower
-000525d0: 5f6c 696d 6974 272c 2775 7070 6572 5f6c  _limit','upper_l
-000525e0: 696d 6974 275d 3a0d 0a09 0909 0909 0966  imit']:........f
-000525f0: 6f72 2072 6f77 2069 6e20 7061 7264 665b  or row in pardf[
-00052600: 7061 7264 662e 6973 5f72 6174 655d 2e69  pardf.is_rate].i
-00052610: 6e64 6578 2e76 616c 7565 733a 0d0a 0909  ndex.values:....
-00052620: 0909 0909 0974 7279 3a0d 0a09 0909 0909  .....try:.......
-00052630: 0909 0970 6172 6466 2e6c 6f63 5b72 6f77  ...pardf.loc[row
-00052640: 2c6b 6579 5d3d 3130 2a2a 7061 7264 662e  ,key]=10**pardf.
-00052650: 6c6f 635b 726f 772c 6b65 795d 0d0a 0909  loc[row,key]....
-00052660: 0909 0909 0965 7863 6570 743a 0d0a 0909  .....except:....
-00052670: 0909 0909 0909 6966 2070 6172 6466 2e6c  ......if pardf.l
-00052680: 6f63 5b72 6f77 2c6b 6579 5d20 6973 204e  oc[row,key] is N
-00052690: 6f6e 653a 0d0a 0909 0909 0909 0909 0963  one:...........c
-000526a0: 6f6e 7469 6e75 650d 0a09 0909 0909 0909  ontinue.........
-000526b0: 0965 6c69 6620 7061 7264 662e 6c6f 635b  .elif pardf.loc[
-000526c0: 726f 772c 6b65 795d 2e69 736e 616e 2829  row,key].isnan()
-000526d0: 3a0d 0a09 0909 0909 0909 0909 636f 6e74  :...........cont
-000526e0: 696e 7565 0d0a 0909 0909 0909 0909 656c  inue..........el
-000526f0: 7365 3a0d 0a09 0909 0909 0909 0909 7072  se:...........pr
-00052700: 696e 7428 2725 732c 2573 2068 6173 2063  int('%s,%s has c
-00052710: 6f75 6c64 206e 6f74 2062 6520 636f 6e76  ould not be conv
-00052720: 6572 7465 6420 616e 6420 6861 7320 7661  erted and has va
-00052730: 6c75 6527 2528 726f 772c 6b65 7929 290d  lue'%(row,key)).
-00052740: 0a09 0909 0909 0909 0909 7072 696e 7428  ..........print(
-00052750: 7061 7264 662e 6c6f 635b 726f 772c 6b65  pardf.loc[row,ke
-00052760: 795d 290d 0a09 0909 0909 0909 0909 636f  y])...........co
-00052770: 6e74 696e 7565 0d0a 0909 0909 7265 5b27  ntinue......re['
-00052780: 636f 6e66 6964 656e 6365 275d 5b27 7461  confidence']['ta
-00052790: 7267 6574 2d6c 6576 656c 275d 3d27 252e  rget-level']='%.
-000527a0: 3166 5c6e 2725 2828 636f 6e66 6964 656e  1f\n'%((confiden
-000527b0: 6365 5f6c 6576 656c 292a 3130 3029 0d0a  ce_level)*100)..
-000527c0: 0909 7265 5b27 6669 745f 7265 7375 6c74  ..re['fit_result
-000527d0: 735f 7261 7465 7327 5d3d 7061 7264 660d  s_rates']=pardf.
-000527e0: 0a09 0974 696d 6564 663d 7061 7264 665f  ...timedf=pardf_
-000527f0: 746f 5f74 696d 6564 6628 7061 7264 6629  to_timedf(pardf)
-00052800: 0d0a 0909 7265 5b27 6669 745f 7265 7375  ....re['fit_resu
-00052810: 6c74 735f 7469 6d65 7327 5d3d 7469 6d65  lts_times']=time
-00052820: 6466 0909 090d 0a09 0969 6620 7361 6d65  df.......if same
-00052830: 5f44 4153 3a0d 0a09 0909 666f 7220 692c  _DAS:.....for i,
-00052840: 7265 5f6c 6f63 616c 2069 6e20 656e 756d  re_local in enum
-00052850: 6572 6174 6528 7265 5f6c 6973 7465 6e29  erate(re_listen)
-00052860: 3a0d 0a09 0909 0966 6f72 206e 616d 6520  :......for name 
-00052870: 696e 205b 2766 6974 5f6f 7574 7075 7427  in ['fit_output'
-00052880: 2c27 6669 745f 7265 7375 6c74 735f 7261  ,'fit_results_ra
-00052890: 7465 7327 2c27 6669 745f 7265 7375 6c74  tes','fit_result
-000528a0: 735f 7469 6d65 7327 5d3a 0d0a 0909 0909  s_times']:......
-000528b0: 0972 655f 6c69 7374 656e 5b69 5d5b 6e61  .re_listen[i][na
-000528c0: 6d65 5d3d 7265 5b6e 616d 655d 0d0a 0909  me]=re[name]....
-000528d0: 0d0a 0909 2323 2323 2323 2323 2323 2323  ....############
-000528e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-000528f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00052900: 2323 230d 0a09 0923 2363 6f6e 7665 7274  ###....##convert
-00052910: 2065 6e65 7267 7920 6261 636b 2074 6f20   energy back to 
-00052920: 7761 7665 6c65 6e67 7468 2323 2323 2323  wavelength######
-00052930: 2323 2323 2323 230d 0a09 0923 2323 2323  #######....#####
-00052940: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00052950: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00052960: 2323 2323 2323 2323 2323 230d 0a09 0969  ###########....i
-00052970: 6620 313a 0d0a 0909 0969 6620 7365 6c66  f 1:.....if self
-00052980: 2e65 7175 616c 5f65 6e65 7267 795f 6269  .equal_energy_bi
-00052990: 6e20 6973 206e 6f74 204e 6f6e 653a 0d0a  n is not None:..
-000529a0: 0909 0909 6966 2073 616d 655f 4441 533a  ....if same_DAS:
-000529b0: 0d0a 0909 0909 0966 6f72 2069 2c72 655f  .......for i,re_
-000529c0: 6c6f 6361 6c20 696e 2065 6e75 6d65 7261  local in enumera
-000529d0: 7465 2872 655f 6c69 7374 656e 293a 0d0a  te(re_listen):..
-000529e0: 0909 0909 0909 666f 7220 6e61 6d65 2069  ......for name i
-000529f0: 6e20 5b27 4127 2c27 4143 272c 2741 4527  n ['A','AC','AE'
-00052a00: 5d3a 0d0a 0909 0909 0909 0972 655f 6c6f  ]:.........re_lo
-00052a10: 6361 6c5b 6e61 6d65 5d2e 636f 6c75 6d6e  cal[name].column
-00052a20: 733d 2873 6369 7079 2e63 6f6e 7374 616e  s=(scipy.constan
-00052a30: 7473 2e68 2a73 6369 7079 2e63 6f6e 7374  ts.h*scipy.const
-00052a40: 616e 7473 2e63 2f28 7265 5f6c 6f63 616c  ants.c/(re_local
-00052a50: 5b6e 616d 655d 2e63 6f6c 756d 6e73 2e76  [name].columns.v
-00052a60: 616c 7565 732a 3165 2d39 2a73 6369 7079  alues*1e-9*scipy
-00052a70: 2e63 6f6e 7374 616e 7473 2e65 6c65 6374  .constants.elect
-00052a80: 726f 6e5f 766f 6c74 2929 0d0a 0909 0909  ron_volt))......
-00052a90: 0909 0972 655f 6c6f 6361 6c5b 6e61 6d65  ...re_local[name
-00052aa0: 5d2e 636f 6c75 6d6e 732e 6e61 6d65 3d27  ].columns.name='
-00052ab0: 7761 7665 6c65 6e67 7468 2069 6e20 6e6d  wavelength in nm
-00052ac0: 270d 0a09 0909 0909 0909 7265 5f6c 6f63  '.........re_loc
-00052ad0: 616c 5b6e 616d 655d 2e73 6f72 745f 696e  al[name].sort_in
-00052ae0: 6465 7828 696e 706c 6163 653d 5472 7565  dex(inplace=True
-00052af0: 2c61 7869 733d 312c 6173 6365 6e64 696e  ,axis=1,ascendin
-00052b00: 673d 5472 7565 290d 0a09 0909 0909 0972  g=True)........r
-00052b10: 655f 6c6f 6361 6c5b 2744 4143 275d 2e69  e_local['DAC'].i
-00052b20: 6e64 6578 3d28 7363 6970 792e 636f 6e73  ndex=(scipy.cons
-00052b30: 7461 6e74 732e 682a 7363 6970 792e 636f  tants.h*scipy.co
-00052b40: 6e73 7461 6e74 732e 632f 2872 655f 6c6f  nstants.c/(re_lo
-00052b50: 6361 6c5b 2744 4143 275d 2e69 6e64 6578  cal['DAC'].index
-00052b60: 2e76 616c 7565 732a 3165 2d39 2a73 6369  .values*1e-9*sci
-00052b70: 7079 2e63 6f6e 7374 616e 7473 2e65 6c65  py.constants.ele
-00052b80: 6374 726f 6e5f 766f 6c74 2929 0d0a 0909  ctron_volt))....
-00052b90: 0909 0909 7265 5f6c 6f63 616c 5b27 4441  ....re_local['DA
-00052ba0: 4327 5d2e 696e 6465 782e 6e61 6d65 3d27  C'].index.name='
-00052bb0: 7761 7665 6c65 6e67 7468 2069 6e20 6e6d  wavelength in nm
-00052bc0: 270d 0a09 0909 0909 0972 655f 6c6f 6361  '........re_loca
-00052bd0: 6c5b 2744 4143 275d 2e73 6f72 745f 696e  l['DAC'].sort_in
-00052be0: 6465 7828 696e 706c 6163 653d 5472 7565  dex(inplace=True
-00052bf0: 2c61 7869 733d 302c 6173 6365 6e64 696e  ,axis=0,ascendin
-00052c00: 673d 5472 7565 290d 0a09 0909 0909 0972  g=True)........r
-00052c10: 655f 6c69 7374 656e 5b69 5d3d 7265 5f6c  e_listen[i]=re_l
-00052c20: 6f63 616c 0d0a 0909 0909 656c 7365 3a0d  ocal......else:.
-00052c30: 0a09 0909 0909 666f 7220 6e61 6d65 2069  ......for name i
-00052c40: 6e20 5b27 4127 2c27 4143 272c 2741 4527  n ['A','AC','AE'
-00052c50: 5d3a 0d0a 0909 0909 0909 7265 5b6e 616d  ]:........re[nam
-00052c60: 655d 2e63 6f6c 756d 6e73 3d28 7363 6970  e].columns=(scip
-00052c70: 792e 636f 6e73 7461 6e74 732e 682a 7363  y.constants.h*sc
-00052c80: 6970 792e 636f 6e73 7461 6e74 732e 632f  ipy.constants.c/
-00052c90: 2872 655b 6e61 6d65 5d2e 636f 6c75 6d6e  (re[name].column
-00052ca0: 732e 7661 6c75 6573 2a31 652d 392a 7363  s.values*1e-9*sc
-00052cb0: 6970 792e 636f 6e73 7461 6e74 732e 656c  ipy.constants.el
-00052cc0: 6563 7472 6f6e 5f76 6f6c 7429 290d 0a09  ectron_volt))...
-00052cd0: 0909 0909 0972 655b 6e61 6d65 5d2e 636f  .....re[name].co
-00052ce0: 6c75 6d6e 732e 6e61 6d65 3d27 7761 7665  lumns.name='wave
-00052cf0: 6c65 6e67 7468 2069 6e20 6e6d 270d 0a09  length in nm'...
-00052d00: 0909 0909 0972 655b 6e61 6d65 5d2e 736f  .....re[name].so
-00052d10: 7274 5f69 6e64 6578 2869 6e70 6c61 6365  rt_index(inplace
-00052d20: 3d54 7275 652c 6178 6973 3d31 2c61 7363  =True,axis=1,asc
-00052d30: 656e 6469 6e67 3d54 7275 6529 0d0a 0909  ending=True)....
-00052d40: 0909 0972 655b 2744 4143 275d 2e69 6e64  ...re['DAC'].ind
-00052d50: 6578 3d28 7363 6970 792e 636f 6e73 7461  ex=(scipy.consta
-00052d60: 6e74 732e 682a 7363 6970 792e 636f 6e73  nts.h*scipy.cons
-00052d70: 7461 6e74 732e 632f 2872 655b 2744 4143  tants.c/(re['DAC
-00052d80: 275d 2e69 6e64 6578 2e76 616c 7565 732a  '].index.values*
-00052d90: 3165 2d39 2a73 6369 7079 2e63 6f6e 7374  1e-9*scipy.const
-00052da0: 616e 7473 2e65 6c65 6374 726f 6e5f 766f  ants.electron_vo
-00052db0: 6c74 2929 0d0a 0909 0909 0972 655b 2744  lt)).......re['D
-00052dc0: 4143 275d 2e69 6e64 6578 2e6e 616d 653d  AC'].index.name=
-00052dd0: 2777 6176 656c 656e 6774 6820 696e 206e  'wavelength in n
-00052de0: 6d27 0d0a 0909 0909 0972 655b 2744 4143  m'.......re['DAC
-00052df0: 275d 2e73 6f72 745f 696e 6465 7828 696e  '].sort_index(in
-00052e00: 706c 6163 653d 5472 7565 2c61 7869 733d  place=True,axis=
-00052e10: 302c 6173 6365 6e64 696e 673d 5472 7565  0,ascending=True
-00052e20: 290d 0a09 090d 0a09 090d 0a09 0923 2323  )............###
-00052e30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00052e40: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00052e50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000523c0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000523d0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000523e0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+000523f0: 2323 2323 230d 0a09 090d 0a09 0969 6620  #####........if 
+00052400: 7061 7264 662e 7661 7279 2e61 6e79 2829  pardf.vary.any()
+00052410: 3a0d 0a09 0909 7265 5b27 6669 745f 6f75  :.....re['fit_ou
+00052420: 7470 7574 275d 3d72 6573 756c 7473 236c  tput']=results#l
+00052430: 6574 2773 2073 746f 7265 2074 6865 2066  et's store the f
+00052440: 6974 2072 6573 756c 7473 2069 6e20 7468  it results in th
+00052450: 6520 7265 5f6f 626a 6563 7420 666f 7220  e re_object for 
+00052460: 6e6f 772e 0d0a 0909 0969 6620 636f 6e66  now......if conf
+00052470: 6964 656e 6365 5f6c 6576 656c 2069 7320  idence_level is 
+00052480: 6e6f 7420 4e6f 6e65 3a0d 0a09 0909 0972  not None:......r
+00052490: 655b 2763 6f6e 6669 6465 6e63 6527 5d3d  e['confidence']=
+000524a0: 636f 6e66 5f6c 696d 6974 730d 0a09 0909  conf_limits.....
+000524b0: 0970 6172 6466 2e69 6e73 6572 7428 6c65  .pardf.insert(le
+000524c0: 6e28 7061 7264 662e 636f 6c75 6d6e 7329  n(pardf.columns)
+000524d0: 2c27 6c6f 7765 725f 6c69 6d69 7427 2c4e  ,'lower_limit',N
+000524e0: 6f6e 6529 0d0a 0909 0909 7061 7264 662e  one)......pardf.
+000524f0: 696e 7365 7274 286c 656e 2870 6172 6466  insert(len(pardf
+00052500: 2e63 6f6c 756d 6e73 292c 2775 7070 6572  .columns),'upper
+00052510: 5f6c 696d 6974 272c 4e6f 6e65 290d 0a09  _limit',None)...
+00052520: 0909 0966 6f72 206b 6579 2069 6e20 636f  ...for key in co
+00052530: 6e66 5f6c 696d 6974 732e 6b65 7973 2829  nf_limits.keys()
+00052540: 3a0d 0a09 0909 0909 7061 7264 662e 6c6f  :.......pardf.lo
+00052550: 635b 6b65 792c 276c 6f77 6572 5f6c 696d  c[key,'lower_lim
+00052560: 6974 275d 3d63 6f6e 665f 6c69 6d69 7473  it']=conf_limits
+00052570: 5b6b 6579 5d5b 276c 6f77 6572 275d 0d0a  [key]['lower']..
+00052580: 0909 0909 0970 6172 6466 2e6c 6f63 5b6b  .....pardf.loc[k
+00052590: 6579 2c27 7570 7065 725f 6c69 6d69 7427  ey,'upper_limit'
+000525a0: 5d3d 636f 6e66 5f6c 696d 6974 735b 6b65  ]=conf_limits[ke
+000525b0: 795d 5b27 7570 7065 7227 5d0d 0a09 0909  y]['upper'].....
+000525c0: 0969 6620 7365 6c66 2e6c 6f67 5f66 6974  .if self.log_fit
+000525d0: 3a0d 0a09 0909 0909 666f 7220 6b65 7920  :.......for key 
+000525e0: 696e 205b 2776 616c 7565 272c 276d 696e  in ['value','min
+000525f0: 272c 276d 6178 272c 276c 6f77 6572 5f6c  ','max','lower_l
+00052600: 696d 6974 272c 2775 7070 6572 5f6c 696d  imit','upper_lim
+00052610: 6974 275d 3a0d 0a09 0909 0909 0966 6f72  it']:........for
+00052620: 2072 6f77 2069 6e20 7061 7264 665b 7061   row in pardf[pa
+00052630: 7264 662e 6973 5f72 6174 655d 2e69 6e64  rdf.is_rate].ind
+00052640: 6578 2e76 616c 7565 733a 0d0a 0909 0909  ex.values:......
+00052650: 0909 0974 7279 3a0d 0a09 0909 0909 0909  ...try:.........
+00052660: 0970 6172 6466 2e6c 6f63 5b72 6f77 2c6b  .pardf.loc[row,k
+00052670: 6579 5d3d 3130 2a2a 7061 7264 662e 6c6f  ey]=10**pardf.lo
+00052680: 635b 726f 772c 6b65 795d 0d0a 0909 0909  c[row,key]......
+00052690: 0909 0965 7863 6570 743a 0d0a 0909 0909  ...except:......
+000526a0: 0909 0909 6966 2070 6172 6466 2e6c 6f63  ....if pardf.loc
+000526b0: 5b72 6f77 2c6b 6579 5d20 6973 204e 6f6e  [row,key] is Non
+000526c0: 653a 0d0a 0909 0909 0909 0909 0963 6f6e  e:...........con
+000526d0: 7469 6e75 650d 0a09 0909 0909 0909 0965  tinue..........e
+000526e0: 6c69 6620 7061 7264 662e 6c6f 635b 726f  lif pardf.loc[ro
+000526f0: 772c 6b65 795d 2e69 736e 616e 2829 3a0d  w,key].isnan():.
+00052700: 0a09 0909 0909 0909 0909 636f 6e74 696e  ..........contin
+00052710: 7565 0d0a 0909 0909 0909 0909 656c 7365  ue..........else
+00052720: 3a0d 0a09 0909 0909 0909 0909 7072 696e  :...........prin
+00052730: 7428 2725 732c 2573 2068 6173 2063 6f75  t('%s,%s has cou
+00052740: 6c64 206e 6f74 2062 6520 636f 6e76 6572  ld not be conver
+00052750: 7465 6420 616e 6420 6861 7320 7661 6c75  ted and has valu
+00052760: 6527 2528 726f 772c 6b65 7929 290d 0a09  e'%(row,key))...
+00052770: 0909 0909 0909 0909 7072 696e 7428 7061  ........print(pa
+00052780: 7264 662e 6c6f 635b 726f 772c 6b65 795d  rdf.loc[row,key]
+00052790: 290d 0a09 0909 0909 0909 0909 636f 6e74  )...........cont
+000527a0: 696e 7565 0d0a 0909 0909 7265 5b27 636f  inue......re['co
+000527b0: 6e66 6964 656e 6365 275d 5b27 7461 7267  nfidence']['targ
+000527c0: 6574 2d6c 6576 656c 275d 3d27 252e 3166  et-level']='%.1f
+000527d0: 5c6e 2725 2828 636f 6e66 6964 656e 6365  \n'%((confidence
+000527e0: 5f6c 6576 656c 292a 3130 3029 0d0a 0909  _level)*100)....
+000527f0: 7265 5b27 6669 745f 7265 7375 6c74 735f  re['fit_results_
+00052800: 7261 7465 7327 5d3d 7061 7264 660d 0a09  rates']=pardf...
+00052810: 0974 696d 6564 663d 7061 7264 665f 746f  .timedf=pardf_to
+00052820: 5f74 696d 6564 6628 7061 7264 6629 0d0a  _timedf(pardf)..
+00052830: 0909 7265 5b27 6669 745f 7265 7375 6c74  ..re['fit_result
+00052840: 735f 7469 6d65 7327 5d3d 7469 6d65 6466  s_times']=timedf
+00052850: 0909 090d 0a09 0969 6620 7361 6d65 5f44  .......if same_D
+00052860: 4153 3a0d 0a09 0909 666f 7220 692c 7265  AS:.....for i,re
+00052870: 5f6c 6f63 616c 2069 6e20 656e 756d 6572  _local in enumer
+00052880: 6174 6528 7265 5f6c 6973 7465 6e29 3a0d  ate(re_listen):.
+00052890: 0a09 0909 0966 6f72 206e 616d 6520 696e  .....for name in
+000528a0: 205b 2766 6974 5f6f 7574 7075 7427 2c27   ['fit_output','
+000528b0: 6669 745f 7265 7375 6c74 735f 7261 7465  fit_results_rate
+000528c0: 7327 2c27 6669 745f 7265 7375 6c74 735f  s','fit_results_
+000528d0: 7469 6d65 7327 5d3a 0d0a 0909 0909 0972  times']:.......r
+000528e0: 655f 6c69 7374 656e 5b69 5d5b 6e61 6d65  e_listen[i][name
+000528f0: 5d3d 7265 5b6e 616d 655d 0d0a 0909 0d0a  ]=re[name]......
+00052900: 0909 2323 2323 2323 2323 2323 2323 2323  ..##############
+00052910: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00052920: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00052930: 230d 0a09 0923 2363 6f6e 7665 7274 2065  #....##convert e
+00052940: 6e65 7267 7920 6261 636b 2074 6f20 7761  nergy back to wa
+00052950: 7665 6c65 6e67 7468 2323 2323 2323 2323  velength########
+00052960: 2323 2323 230d 0a09 0923 2323 2323 2323  #####....#######
+00052970: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00052980: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00052990: 2323 2323 2323 2323 230d 0a09 0969 6620  #########....if 
+000529a0: 313a 0d0a 0909 0969 6620 7365 6c66 2e65  1:.....if self.e
+000529b0: 7175 616c 5f65 6e65 7267 795f 6269 6e20  qual_energy_bin 
+000529c0: 6973 206e 6f74 204e 6f6e 653a 0d0a 0909  is not None:....
+000529d0: 0909 6966 2073 616d 655f 4441 533a 0d0a  ..if same_DAS:..
+000529e0: 0909 0909 0966 6f72 2069 2c72 655f 6c6f  .....for i,re_lo
+000529f0: 6361 6c20 696e 2065 6e75 6d65 7261 7465  cal in enumerate
+00052a00: 2872 655f 6c69 7374 656e 293a 0d0a 0909  (re_listen):....
+00052a10: 0909 0909 666f 7220 6e61 6d65 2069 6e20  ....for name in 
+00052a20: 5b27 4127 2c27 4143 272c 2741 4527 5d3a  ['A','AC','AE']:
+00052a30: 0d0a 0909 0909 0909 0972 655f 6c6f 6361  .........re_loca
+00052a40: 6c5b 6e61 6d65 5d2e 636f 6c75 6d6e 733d  l[name].columns=
+00052a50: 2873 6369 7079 2e63 6f6e 7374 616e 7473  (scipy.constants
+00052a60: 2e68 2a73 6369 7079 2e63 6f6e 7374 616e  .h*scipy.constan
+00052a70: 7473 2e63 2f28 7265 5f6c 6f63 616c 5b6e  ts.c/(re_local[n
+00052a80: 616d 655d 2e63 6f6c 756d 6e73 2e76 616c  ame].columns.val
+00052a90: 7565 732a 3165 2d39 2a73 6369 7079 2e63  ues*1e-9*scipy.c
+00052aa0: 6f6e 7374 616e 7473 2e65 6c65 6374 726f  onstants.electro
+00052ab0: 6e5f 766f 6c74 2929 0d0a 0909 0909 0909  n_volt))........
+00052ac0: 0972 655f 6c6f 6361 6c5b 6e61 6d65 5d2e  .re_local[name].
+00052ad0: 636f 6c75 6d6e 732e 6e61 6d65 3d27 7761  columns.name='wa
+00052ae0: 7665 6c65 6e67 7468 2069 6e20 6e6d 270d  velength in nm'.
+00052af0: 0a09 0909 0909 0909 7265 5f6c 6f63 616c  ........re_local
+00052b00: 5b6e 616d 655d 2e73 6f72 745f 696e 6465  [name].sort_inde
+00052b10: 7828 696e 706c 6163 653d 5472 7565 2c61  x(inplace=True,a
+00052b20: 7869 733d 312c 6173 6365 6e64 696e 673d  xis=1,ascending=
+00052b30: 5472 7565 290d 0a09 0909 0909 0972 655f  True)........re_
+00052b40: 6c6f 6361 6c5b 2744 4143 275d 2e69 6e64  local['DAC'].ind
+00052b50: 6578 3d28 7363 6970 792e 636f 6e73 7461  ex=(scipy.consta
+00052b60: 6e74 732e 682a 7363 6970 792e 636f 6e73  nts.h*scipy.cons
+00052b70: 7461 6e74 732e 632f 2872 655f 6c6f 6361  tants.c/(re_loca
+00052b80: 6c5b 2744 4143 275d 2e69 6e64 6578 2e76  l['DAC'].index.v
+00052b90: 616c 7565 732a 3165 2d39 2a73 6369 7079  alues*1e-9*scipy
+00052ba0: 2e63 6f6e 7374 616e 7473 2e65 6c65 6374  .constants.elect
+00052bb0: 726f 6e5f 766f 6c74 2929 0d0a 0909 0909  ron_volt))......
+00052bc0: 0909 7265 5f6c 6f63 616c 5b27 4441 4327  ..re_local['DAC'
+00052bd0: 5d2e 696e 6465 782e 6e61 6d65 3d27 7761  ].index.name='wa
+00052be0: 7665 6c65 6e67 7468 2069 6e20 6e6d 270d  velength in nm'.
+00052bf0: 0a09 0909 0909 0972 655f 6c6f 6361 6c5b  .......re_local[
+00052c00: 2744 4143 275d 2e73 6f72 745f 696e 6465  'DAC'].sort_inde
+00052c10: 7828 696e 706c 6163 653d 5472 7565 2c61  x(inplace=True,a
+00052c20: 7869 733d 302c 6173 6365 6e64 696e 673d  xis=0,ascending=
+00052c30: 5472 7565 290d 0a09 0909 0909 0972 655f  True)........re_
+00052c40: 6c69 7374 656e 5b69 5d3d 7265 5f6c 6f63  listen[i]=re_loc
+00052c50: 616c 0d0a 0909 0909 656c 7365 3a0d 0a09  al......else:...
+00052c60: 0909 0909 666f 7220 6e61 6d65 2069 6e20  ....for name in 
+00052c70: 5b27 4127 2c27 4143 272c 2741 4527 5d3a  ['A','AC','AE']:
+00052c80: 0d0a 0909 0909 0909 7265 5b6e 616d 655d  ........re[name]
+00052c90: 2e63 6f6c 756d 6e73 3d28 7363 6970 792e  .columns=(scipy.
+00052ca0: 636f 6e73 7461 6e74 732e 682a 7363 6970  constants.h*scip
+00052cb0: 792e 636f 6e73 7461 6e74 732e 632f 2872  y.constants.c/(r
+00052cc0: 655b 6e61 6d65 5d2e 636f 6c75 6d6e 732e  e[name].columns.
+00052cd0: 7661 6c75 6573 2a31 652d 392a 7363 6970  values*1e-9*scip
+00052ce0: 792e 636f 6e73 7461 6e74 732e 656c 6563  y.constants.elec
+00052cf0: 7472 6f6e 5f76 6f6c 7429 290d 0a09 0909  tron_volt)).....
+00052d00: 0909 0972 655b 6e61 6d65 5d2e 636f 6c75  ...re[name].colu
+00052d10: 6d6e 732e 6e61 6d65 3d27 7761 7665 6c65  mns.name='wavele
+00052d20: 6e67 7468 2069 6e20 6e6d 270d 0a09 0909  ngth in nm'.....
+00052d30: 0909 0972 655b 6e61 6d65 5d2e 736f 7274  ...re[name].sort
+00052d40: 5f69 6e64 6578 2869 6e70 6c61 6365 3d54  _index(inplace=T
+00052d50: 7275 652c 6178 6973 3d31 2c61 7363 656e  rue,axis=1,ascen
+00052d60: 6469 6e67 3d54 7275 6529 0d0a 0909 0909  ding=True)......
+00052d70: 0972 655b 2744 4143 275d 2e69 6e64 6578  .re['DAC'].index
+00052d80: 3d28 7363 6970 792e 636f 6e73 7461 6e74  =(scipy.constant
+00052d90: 732e 682a 7363 6970 792e 636f 6e73 7461  s.h*scipy.consta
+00052da0: 6e74 732e 632f 2872 655b 2744 4143 275d  nts.c/(re['DAC']
+00052db0: 2e69 6e64 6578 2e76 616c 7565 732a 3165  .index.values*1e
+00052dc0: 2d39 2a73 6369 7079 2e63 6f6e 7374 616e  -9*scipy.constan
+00052dd0: 7473 2e65 6c65 6374 726f 6e5f 766f 6c74  ts.electron_volt
+00052de0: 2929 0d0a 0909 0909 0972 655b 2744 4143  )).......re['DAC
+00052df0: 275d 2e69 6e64 6578 2e6e 616d 653d 2777  '].index.name='w
+00052e00: 6176 656c 656e 6774 6820 696e 206e 6d27  avelength in nm'
+00052e10: 0d0a 0909 0909 0972 655b 2744 4143 275d  .......re['DAC']
+00052e20: 2e73 6f72 745f 696e 6465 7828 696e 706c  .sort_index(inpl
+00052e30: 6163 653d 5472 7565 2c61 7869 733d 302c  ace=True,axis=0,
+00052e40: 6173 6365 6e64 696e 673d 5472 7565 290d  ascending=True).
+00052e50: 0a09 090d 0a09 090d 0a09 0923 2323 2323  ...........#####
 00052e60: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00052e70: 2323 2323 2323 2323 230d 0a09 0923 2d2d  #########....#--
-00052e80: 2d70 7269 6e74 2074 6865 206f 7574 7075  -print the outpu
-00052e90: 742d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  t---------------
-00052ea0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00052eb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00052ec0: 2d2d 2d2d 0d0a 0909 2323 2323 2323 2323  ----....########
-00052ed0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00052ee0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00052ef0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00052e70: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00052e80: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00052e90: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00052ea0: 2323 2323 2323 230d 0a09 0923 2d2d 2d70  #######....#---p
+00052eb0: 7269 6e74 2074 6865 206f 7574 7075 742d  rint the output-
+00052ec0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00052ed0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00052ee0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00052ef0: 2d2d 0d0a 0909 2323 2323 2323 2323 2323  --....##########
 00052f00: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00052f10: 2323 2323 0d0a 0909 7365 6c66 2e72 653d  ####....self.re=
-00052f20: 7265 0d0a 0909 6966 2073 616d 655f 4441  re....if same_DA
-00052f30: 533a 0d0a 0909 0972 655f 6c69 7374 656e  S:.....re_listen
-00052f40: 5b30 5d3d 7265 0d0a 0909 0973 656c 662e  [0]=re.....self.
-00052f50: 6d75 6c74 695f 7072 6f6a 6563 7473 3d72  multi_projects=r
-00052f60: 655f 6c69 7374 656e 0d0a 0d0a 0909 5265  e_listen......Re
-00052f70: 7375 6c74 5f73 7472 696e 673d 275c 6e46  sult_string='\nF
-00052f80: 6974 2052 6573 756c 7473 3a5c 6e27 0d0a  it Results:\n'..
-00052f90: 0909 0d0a 0909 6966 2069 7369 6e73 7461  ......if isinsta
-00052fa0: 6e63 6528 6d6f 642c 7479 7065 2827 6865  nce(mod,type('he
-00052fb0: 6c6c 6f27 2929 3a0d 0a09 0909 5265 7375  llo')):.....Resu
-00052fc0: 6c74 5f73 7472 696e 672b 3d27 4d6f 6465  lt_string+='Mode
-00052fd0: 6c20 5573 6564 3a20 2573 5c6e 5c6e 2725  l Used: %s\n\n'%
-00052fe0: 6d6f 640d 0a09 0965 6c73 653a 0d0a 0909  mod....else:....
-00052ff0: 0952 6573 756c 745f 7374 7269 6e67 2b3d  .Result_string+=
-00053000: 274d 6f64 656c 2055 7365 643a 2045 7874  'Model Used: Ext
-00053010: 6572 6e61 6c20 6675 6e63 7469 6f6e 5c6e  ernal function\n
-00053020: 5c6e 270d 0a09 090d 0a09 090d 0a09 0969  \n'............i
-00053030: 6620 7365 6c66 2e69 676e 6f72 655f 7469  f self.ignore_ti
-00053040: 6d65 5f72 6567 696f 6e20 6973 206e 6f74  me_region is not
-00053050: 204e 6f6e 653a 0d0a 0909 0974 7279 3a0d   None:.....try:.
-00053060: 0a09 0909 0952 6573 756c 745f 7374 7269  .....Result_stri
-00053070: 6e67 2b3d 2774 6865 2074 696d 6520 6265  ng+='the time be
-00053080: 7477 6565 6e20 252e 3366 2025 7320 616e  tween %.3f %s an
-00053090: 6420 252e 3366 2025 7320 7761 7320 6578  d %.3f %s was ex
-000530a0: 636c 7564 6564 2066 726f 6d20 7468 6520  cluded from the 
-000530b0: 6f70 7469 6d69 7a61 7469 6f6e 5c6e 5c6e  optimization\n\n
-000530c0: 2725 2873 656c 662e 6967 6e6f 7265 5f74  '%(self.ignore_t
-000530d0: 696d 655f 7265 6769 6f6e 5b30 5d2c 7365  ime_region[0],se
-000530e0: 6c66 2e62 6173 6575 6e69 742c 7365 6c66  lf.baseunit,self
-000530f0: 2e69 676e 6f72 655f 7469 6d65 5f72 6567  .ignore_time_reg
-00053100: 696f 6e5b 315d 2c73 656c 662e 6261 7365  ion[1],self.base
-00053110: 756e 6974 290d 0a09 0909 6578 6365 7074  unit).....except
-00053120: 3a23 7765 2067 6f74 2061 206c 6973 740d  :#we got a list.
-00053130: 0a09 0909 0966 6f72 2065 6e74 7279 2069  .....for entry i
-00053140: 6e20 7365 6c66 2e69 676e 6f72 655f 7469  n self.ignore_ti
-00053150: 6d65 5f72 6567 696f 6e3a 0d0a 0909 0909  me_region:......
-00053160: 0952 6573 756c 745f 7374 7269 6e67 2b3d  .Result_string+=
-00053170: 2774 6865 2074 696d 6520 6265 7477 6565  'the time betwee
-00053180: 6e20 252e 3366 2025 7320 616e 6420 252e  n %.3f %s and %.
-00053190: 3366 2025 7320 7761 7320 6578 636c 7564  3f %s was exclud
-000531a0: 6564 2066 726f 6d20 7468 6520 6f70 7469  ed from the opti
-000531b0: 6d69 7a61 7469 6f6e 5c6e 5c6e 2725 2865  mization\n\n'%(e
-000531c0: 6e74 7279 5b30 5d2c 7365 6c66 2e62 6173  ntry[0],self.bas
-000531d0: 6575 6e69 742c 656e 7472 795b 315d 2c73  eunit,entry[1],s
-000531e0: 656c 662e 6261 7365 756e 6974 290d 0a09  elf.baseunit)...
-000531f0: 0952 6573 756c 745f 7374 7269 6e67 2b3d  .Result_string+=
-00053200: 2754 6865 206d 696e 696d 756d 2065 7272  'The minimum err
-00053210: 6f72 2069 733a 7b3a 2e38 657d 5c6e 272e  or is:{:.8e}\n'.
-00053220: 666f 726d 6174 2872 655b 2765 7272 6f72  format(re['error
-00053230: 275d 290d 0a09 0952 6573 756c 745f 7374  '])....Result_st
-00053240: 7269 6e67 2b3d 2754 6865 206d 696e 696d  ring+='The minim
-00053250: 756d 2052 322d 7661 6c75 6520 6973 3a7b  um R2-value is:{
-00053260: 3a2e 3865 7d5c 6e27 2e66 6f72 6d61 7428  :.8e}\n'.format(
-00053270: 7265 5b27 7232 275d 290d 0a09 0969 6620  re['r2'])....if 
-00053280: 7361 6d65 5f44 4153 3a0d 0a09 0909 5265  same_DAS:.....Re
-00053290: 7375 6c74 5f73 7472 696e 672b 3d27 5468  sult_string+='Th
-000532a0: 6520 6d69 6e69 6d75 6d20 676c 6f62 616c  e minimum global
-000532b0: 2065 7272 6f72 2069 733a 7b3a 2e38 657d   error is:{:.8e}
-000532c0: 5c6e 272e 666f 726d 6174 2872 655b 2765  \n'.format(re['e
-000532d0: 7272 6f72 5f74 6f74 616c 275d 290d 0a09  rror_total'])...
-000532e0: 0909 5265 7375 6c74 5f73 7472 696e 672b  ..Result_string+
-000532f0: 3d27 5468 6520 6d69 6e69 6d75 6d20 676c  ='The minimum gl
-00053300: 6f62 616c 2052 322d 7661 6c75 6520 6973  obal R2-value is
-00053310: 3a7b 3a2e 3865 7d5c 6e27 2e66 6f72 6d61  :{:.8e}\n'.forma
-00053320: 7428 7265 5b27 7232 5f74 6f74 616c 275d  t(re['r2_total']
-00053330: 290d 0a09 0969 6620 636f 6e66 6964 656e  )....if confiden
-00053340: 6365 5f6c 6576 656c 2069 7320 6e6f 7420  ce_level is not 
-00053350: 4e6f 6e65 3a0d 0a09 0909 5265 7375 6c74  None:.....Result
-00053360: 5f73 7472 696e 672b 3d27 5c6e 496e 2052  _string+='\nIn R
-00053370: 6174 6573 2077 6974 6820 636f 6e66 6964  ates with confid
-00053380: 656e 6365 2069 6e74 6572 7661 6c20 746f  ence interval to
-00053390: 206c 6576 656c 206f 6620 252e 3166 5c6e   level of %.1f\n
-000533a0: 5c6e 2725 2828 636f 6e66 6964 656e 6365  \n'%((confidence
-000533b0: 5f6c 6576 656c 292a 3130 3029 0d0a 0909  _level)*100)....
-000533c0: 0952 6573 756c 745f 7374 7269 6e67 2b3d  .Result_string+=
-000533d0: 7061 7264 662e 746f 5f73 7472 696e 6728  pardf.to_string(
-000533e0: 636f 6c75 6d6e 733d 5b27 7661 6c75 6527  columns=['value'
-000533f0: 2c27 6c6f 7765 725f 6c69 6d69 7427 2c27  ,'lower_limit','
-00053400: 7570 7065 725f 6c69 6d69 7427 2c27 696e  upper_limit','in
-00053410: 6974 5f76 616c 7565 272c 2776 6172 7927  it_value','vary'
-00053420: 2c27 6d69 6e27 2c27 6d61 7827 2c27 6578  ,'min','max','ex
-00053430: 7072 275d 290d 0a09 0909 5265 7375 6c74  pr']).....Result
-00053440: 5f73 7472 696e 672b 3d27 5c6e 5c6e 5468  _string+='\n\nTh
-00053450: 6520 7261 7465 7320 636f 6e76 6572 7465  e rates converte
-00053460: 6420 746f 2074 696d 6573 2077 6974 6820  d to times with 
-00053470: 756e 6974 2025 7320 7769 7468 2063 6f6e  unit %s with con
-00053480: 6669 6465 6e63 6520 696e 7465 7276 616c  fidence interval
-00053490: 2074 6f20 6c65 7665 6c20 6f66 2025 2e31   to level of %.1
-000534a0: 665c 6e5c 6e27 2528 7365 6c66 2e62 6173  f\n\n'%(self.bas
-000534b0: 6575 6e69 742c 2863 6f6e 6669 6465 6e63  eunit,(confidenc
-000534c0: 655f 6c65 7665 6c29 2a31 3030 290d 0a09  e_level)*100)...
-000534d0: 0909 5265 7375 6c74 5f73 7472 696e 672b  ..Result_string+
-000534e0: 3d74 696d 6564 662e 746f 5f73 7472 696e  =timedf.to_strin
-000534f0: 6728 636f 6c75 6d6e 733d 5b27 7661 6c75  g(columns=['valu
-00053500: 6527 2c27 6c6f 7765 725f 6c69 6d69 7427  e','lower_limit'
-00053510: 2c27 7570 7065 725f 6c69 6d69 7427 2c27  ,'upper_limit','
-00053520: 696e 6974 5f76 616c 7565 272c 2776 6172  init_value','var
-00053530: 7927 2c27 6d69 6e27 2c27 6d61 7827 2c27  y','min','max','
-00053540: 6578 7072 275d 290d 0a09 0965 6c73 653a  expr'])....else:
-00053550: 0d0a 0909 0952 6573 756c 745f 7374 7269  .....Result_stri
-00053560: 6e67 2b3d 275c 6e49 6e20 5261 7465 735c  ng+='\nIn Rates\
-00053570: 6e5c 6e27 0d0a 0909 0952 6573 756c 745f  n\n'.....Result_
-00053580: 7374 7269 6e67 2b3d 7061 7264 662e 746f  string+=pardf.to
-00053590: 5f73 7472 696e 6728 636f 6c75 6d6e 733d  _string(columns=
-000535a0: 5b27 7661 6c75 6527 2c27 696e 6974 5f76  ['value','init_v
-000535b0: 616c 7565 272c 2776 6172 7927 2c27 6d69  alue','vary','mi
-000535c0: 6e27 2c27 6d61 7827 2c27 6578 7072 275d  n','max','expr']
-000535d0: 290d 0a09 0909 5265 7375 6c74 5f73 7472  ).....Result_str
-000535e0: 696e 672b 3d27 5c6e 5c6e 5468 6520 7261  ing+='\n\nThe ra
-000535f0: 7465 7320 636f 6e76 6572 7465 6420 746f  tes converted to
-00053600: 2074 696d 6573 2077 6974 6820 756e 6974   times with unit
-00053610: 2025 735c 6e5c 6e27 2573 656c 662e 6261   %s\n\n'%self.ba
-00053620: 7365 756e 6974 0d0a 0909 0952 6573 756c  seunit.....Resul
-00053630: 745f 7374 7269 6e67 2b3d 7469 6d65 6466  t_string+=timedf
-00053640: 2e74 6f5f 7374 7269 6e67 2863 6f6c 756d  .to_string(colum
-00053650: 6e73 3d5b 2776 616c 7565 272c 2769 6e69  ns=['value','ini
-00053660: 745f 7661 6c75 6527 2c27 7661 7279 272c  t_value','vary',
-00053670: 276d 696e 272c 276d 6178 272c 2765 7870  'min','max','exp
-00053680: 7227 5d29 0d0a 0909 6966 2073 616d 655f  r'])....if same_
-00053690: 4441 533a 0d0a 0909 0952 6573 756c 745f  DAS:.....Result_
-000536a0: 7374 7269 6e67 2b3d 275c 6e5c 6e74 6865  string+='\n\nthe
-000536b0: 206f 7468 6572 206f 626a 6563 7473 2077   other objects w
-000536c0: 6572 6520 6c61 7965 6420 696e 746f 2073  ere layed into s
-000536d0: 656c 662e 6d75 6c74 695f 7072 6f6a 6563  elf.multi_projec
-000536e0: 7473 2061 7320 6c69 7374 2077 6974 6820  ts as list with 
-000536f0: 7468 6520 6c6f 6361 6c20 7265 206f 6e20  the local re on 
-00053700: 706f 7369 7469 6f6e 2030 2e5c 6e20 4279  position 0.\n By
-00053710: 2072 6570 6c61 6369 6e67 2061 7373 756d   replacing assum
-00053720: 696e 6720 7468 6174 2073 656c 6620 3d20  ing that self = 
-00053730: 7461 2077 7269 7465 3a20 5c6e 2074 612e  ta write: \n ta.
-00053740: 7265 203d 2074 612e 6d75 6c74 695f 7072  re = ta.multi_pr
-00053750: 6f6a 6563 7473 5b31 5d20 616e 6420 7468  ojects[1] and th
-00053760: 656e 2074 612e 506c 6f74 5f66 6974 5f6f  en ta.Plot_fit_o
-00053770: 7574 7075 7420 746f 206c 6f6f 6b20 6f6e  utput to look on
-00053780: 2074 6865 206f 7468 6572 2066 6974 735c   the other fits\
-00053790: 6e20 270d 0a09 0909 0d0a 0909 7072 696e  n '.........prin
-000537a0: 7428 5265 7375 6c74 5f73 7472 696e 6729  t(Result_string)
-000537b0: 0d0a 0909 0d0a 0909 6966 2064 756d 705f  ........if dump_
-000537c0: 7061 7261 733a 0d0a 0909 0977 6974 6820  paras:.....with 
-000537d0: 6f70 656e 2822 4669 745f 7265 7375 6c74  open("Fit_result
-000537e0: 735f 7072 696e 742e 7061 7222 2c20 2277  s_print.par", "w
-000537f0: 2229 2061 7320 7465 7874 5f66 696c 653a  ") as text_file:
-00053800: 0d0a 0909 0909 7465 7874 5f66 696c 652e  ......text_file.
-00053810: 7772 6974 6528 5265 7375 6c74 5f73 7472  write(Result_str
-00053820: 696e 6729 0d0a 0909 090d 0a09 0909 0d0a  ing)............
-00053830: 0964 6566 2050 6c6f 745f 6669 745f 6f75  .def Plot_fit_ou
-00053840: 7470 7574 2873 656c 662c 2070 6c6f 7474  tput(self, plott
-00053850: 696e 6720 3d20 7261 6e67 6528 3629 2c20  ing = range(6), 
-00053860: 7061 7468 203d 2027 7265 7375 6c74 5f66  path = 'result_f
-00053870: 6967 7572 6573 272c 2073 6176 6574 7970  igures', savetyp
-00053880: 6520 3d20 2770 6e67 272c 200d 0a09 0909  e = 'png', .....
-00053890: 0909 0965 7661 6c75 6174 696f 6e5f 7374  ...evaluation_st
-000538a0: 796c 6520 3d20 4661 6c73 652c 2074 6974  yle = False, tit
-000538b0: 6c65 203d 204e 6f6e 652c 2073 6361 6c65  le = None, scale
-000538c0: 5f74 7970 6520 3d20 2773 796d 6c6f 6727  _type = 'symlog'
-000538d0: 2c20 0d0a 0909 0909 0909 7061 7463 6865  , ........patche
-000538e0: 7320 3d20 4661 6c73 652c 2066 696c 656e  s = False, filen
-000538f0: 616d 6520 3d20 4e6f 6e65 2c20 636d 6170  ame = None, cmap
-00053900: 203d 204e 6f6e 6520 2c20 7072 696e 745f   = None , print_
-00053910: 636c 6963 6b5f 706f 7369 7469 6f6e 203d  click_position =
-00053920: 2046 616c 7365 2c0d 0a09 0909 0909 0970   False,........p
-00053930: 6c6f 745f 7365 636f 6e64 5f61 735f 656e  lot_second_as_en
-00053940: 6572 6779 203d 2054 7275 6529 3a0d 0a09  ergy = True):...
-00053950: 0909 0909 0909 0909 0909 0909 0909 0909  ................
-00053960: 200d 0a09 0927 2727 706c 6f74 7320 616c   ....'''plots al
-00053970: 6c20 7468 6520 6669 7420 6f75 7470 7574  l the fit output
-00053980: 2066 6967 7572 6573 2e20 5468 6520 6669   figures. The fi
-00053990: 6775 7265 7320 6361 6e20 6265 2063 616c  gures can be cal
-000539a0: 6c65 6420 7365 7061 7261 7465 6c79 200d  led separately .
-000539b0: 0a09 096f 7220 7769 7468 2061 206c 6973  ...or with a lis
-000539c0: 7420 6f66 2070 6c6f 7473 2e20 652e 672e  t of plots. e.g.
-000539d0: 2072 616e 6765 2836 2920 6361 6c6c 2070   range(6) call p
-000539e0: 6c6f 7473 2030 2d35 204d 616e 7561 6c20  lots 0-5 Manual 
-000539f0: 706c 6f74 7469 6e67 206f 6620 6365 7274  plotting of cert
-00053a00: 6169 6e20 7479 7065 3a0d 0a09 090d 0a09  ain type:.......
-00053a10: 0954 6869 7320 6973 2061 2077 7261 7070  .This is a wrapp
-00053a20: 6572 2066 756e 6374 696f 6e20 7468 6174  er function that
-00053a30: 2074 7269 6767 6572 7320 7468 6520 706c   triggers the pl
-00053a40: 6f74 7469 6e67 206f 6620 616c 6c20 7468  otting of all th
-00053a50: 6520 6669 7474 6564 2070 6c6f 7473 2e0d  e fitted plots..
-00053a60: 0a09 0954 6865 2070 6172 616d 6574 6572  ...The parameter
-00053a70: 2069 6e20 7468 6973 2070 6c6f 7420 6361   in this plot ca
-00053a80: 6c6c 2061 7265 2074 6f20 636f 6e74 726f  ll are to contro
-00053a90: 6c20 7468 6520 6765 6e65 7261 6c20 6c6f  l the general lo
-00053aa0: 6f6b 2061 6e64 2066 6561 7475 7265 7320  ok and features 
-00053ab0: 6f66 2074 6865 2070 6c6f 742e 0d0a 0909  of the plot.....
-00053ac0: 5768 6963 6820 706c 6f74 7320 6172 6520  Which plots are 
-00053ad0: 7072 696e 7465 6420 6973 2064 6566 696e  printed is defin
-00053ae0: 6564 2062 7920 7468 6520 6669 7273 7420  ed by the first 
-00053af0: 636f 6d6d 616e 6420 2870 6c6f 7474 696e  command (plottin
-00053b00: 6729 0d0a 0909 5468 6520 706c 6f74 7320  g)....The plots 
-00053b10: 6172 6520 6765 6e65 7261 7465 6420 6672  are generated fr
-00053b20: 6f6d 2074 6865 2066 6974 7465 6420 4d61  om the fitted Ma
-00053b30: 7472 6978 6573 2061 6e64 2061 7320 7375  trixes and as su
-00053b40: 6368 206f 6e6c 7920 7769 6c6c 2077 6f72  ch only will wor
-00053b50: 6b20 6166 7465 7220 6120 6669 7420 7761  k after a fit wa
-00053b60: 7320 6163 7475 616c 6c79 0d0a 0909 636f  s actually....co
-00053b70: 6d70 6c65 7465 6420 2861 6e64 2074 6865  mpleted (and the
-00053b80: 2022 7265 2220 6469 6374 696f 6e61 7279   "re" dictionary
-00053b90: 2061 7474 6163 6865 6420 746f 2074 6865   attached to the
-00053ba0: 206f 626a 6563 742e 290d 0a09 0949 6e20   object.)....In 
-00053bb0: 616c 6c20 706c 6f74 7320 7468 6520 5241  all plots the RA
-00053bc0: 5720 6461 7461 2069 7320 706c 6f74 7465  W data is plotte
-00053bd0: 6420 6173 2064 6f74 7320 616e 6420 7468  d as dots and th
-00053be0: 6520 6669 7420 7769 7468 206c 696e 6573  e fit with lines
-00053bf0: 200d 0a09 090d 0a09 0943 6f6e 7465 6e74   ........Content
-00053c00: 7320 6f66 2074 6865 2070 6c6f 7473 0d0a  s of the plots..
-00053c10: 0d0a 0909 0930 2e20 4441 4320 636f 6e74  .....0. DAC cont
-00053c20: 6169 6e73 2074 6865 2061 7373 6967 6e65  ains the assigne
-00053c30: 6420 7370 6563 7472 6120 666f 7220 6561  d spectra for ea
-00053c40: 6368 2063 6f6d 706f 6e65 6e74 206f 6620  ch component of 
-00053c50: 7468 6520 6669 742e 2046 6f72 0d0a 0909  the fit. For....
-00053c60: 0920 2020 6120 6d6f 6465 6c6c 696e 6720  .   a modelling 
-00053c70: 7769 7468 2069 6e64 6570 656e 6465 6e74  with independent
-00053c80: 2065 7870 6f6e 656e 7469 616c 2064 6563   exponential dec
-00053c90: 6179 7320 7468 6973 2063 6f72 7265 7370  ays this corresp
-00053ca0: 6f6e 6473 2074 6f0d 0a09 0909 2020 2074  onds to.....   t
-00053cb0: 6865 2022 4465 6361 7920 4173 736f 6369  he "Decay Associ
-00053cc0: 6174 6564 2053 7065 6374 7261 2220 2844  ated Spectra" (D
-00053cd0: 4153 292e 2046 6f72 2061 6c6c 206f 7468  AS). For all oth
-00053ce0: 6572 206d 6f64 656c 7320 7468 6973 0d0a  er models this..
-00053cf0: 0909 0920 2020 636f 6e74 6169 6e73 2074  ...   contains t
-00053d00: 6865 2022 5370 6563 6965 7320 4173 736f  he "Species Asso
-00053d10: 6369 6174 6564 2053 7065 6374 7261 2220  ciated Spectra" 
-00053d20: 2853 4153 292e 2041 6363 6f72 6469 6e67  (SAS). According
-00053d30: 2074 6f20 7468 650d 0a09 0909 2020 206d   to the.....   m
-00053d40: 6f64 656c 2074 6865 2073 6570 6172 6174  odel the separat
-00053d50: 6520 7370 6563 7472 6120 6172 6520 6c61  e spectra are la
-00053d60: 6265 6c65 6420 6279 2074 696d 6520 2870  beled by time (p
-00053d70: 726f 6365 7373 2920 6f72 206e 616d 652c  rocess) or name,
-00053d80: 2069 660d 0a09 0909 2020 2061 206e 616d   if.....   a nam
-00053d90: 6520 6973 2061 7373 6f63 6961 7465 6420  e is associated 
-00053da0: 696e 2074 6865 2066 6974 7469 6e67 206d  in the fitting m
-00053db0: 6f64 656c 2e20 5468 6520 7370 6563 7472  odel. The spectr
-00053dc0: 6120 6172 6520 7368 6f77 6e20 696e 0d0a  a are shown in..
-00053dd0: 0909 0920 2020 7468 6520 6578 7472 6163  ...   the extrac
-00053de0: 7465 6420 7374 7265 6e67 7468 2069 6e20  ted strength in 
-00053df0: 7468 6520 7269 6768 7420 7061 6e65 2061  the right pane a
-00053e00: 6e64 206e 6f72 6d61 6c69 7a65 6420 696e  nd normalized in
-00053e10: 2074 6865 206c 6566 742e 0d0a 0909 0920   the left...... 
-00053e20: 2020 4578 7472 6163 7465 6420 7374 7265    Extracted stre
-00053e30: 6e67 7468 206d 6561 6e73 2074 6861 7420  ngth means that 
-00053e40: 7468 6520 6d65 6173 7572 6564 2073 7065  the measured spe
-00053e50: 6374 7261 6c20 7374 7265 6e67 7468 2069  ctral strength i
-00053e60: 7320 7468 650d 0a09 0909 2020 2069 6e74  s the.....   int
-00053e70: 656e 7369 7479 2028 636f 6e63 656e 7472  ensity (concentr
-00053e80: 6174 696f 6e20 6d61 7472 6978 2920 7469  ation matrix) ti
-00053e90: 6d65 7320 7468 6973 2073 7065 6374 7261  mes this spectra
-00053ea0: 6c20 7374 7265 6e67 7468 2e20 4173 2074  l strength. As t
-00053eb0: 6865 0d0a 0909 0920 2020 636f 6e63 656e  he.....   concen
-00053ec0: 7472 6174 696f 6e20 6d61 7869 6d61 2066  tration maxima f
-00053ed0: 6f72 2061 6c6c 2044 4153 2061 7265 2031  or all DAS are 1
-00053ee0: 2074 6869 7320 636f 7272 6573 706f 6e64   this correspond
-00053ef0: 7320 746f 2074 6865 0d0a 0909 0920 2020  s to the.....   
-00053f00: 7370 6563 7472 616c 2073 7472 656e 6774  spectral strengt
-00053f10: 6820 666f 7220 7468 6520 4441 532e 2028  h for the DAS. (
-00053f20: 706c 6561 7365 2073 6565 2074 6865 2064  please see the d
-00053f30: 6f63 756d 656e 7461 7469 6f6e 2066 6f72  ocumentation for
-00053f40: 2074 6865 0d0a 0909 0920 2020 6669 7474   the.....   fitt
-00053f50: 696e 6720 616c 676f 7269 7468 6d20 666f  ing algorithm fo
-00053f60: 7220 6675 7274 6865 7220 6465 7461 696c  r further detail
-00053f70: 7329 2e0d 0a0d 0a09 0909 312e 2073 756d  s)........1. sum
-00053f80: 6d65 6420 696e 7465 6e73 6974 792e 2041  med intensity. A
-00053f90: 6c6c 2077 6176 656c 656e 6774 6820 6f66  ll wavelength of
-00053fa0: 2074 6865 2073 7065 6374 7261 6c20 6178   the spectral ax
-00053fb0: 6973 2061 7265 2073 756d 6d65 6420 666f  is are summed fo
-00053fc0: 720d 0a09 0909 2020 2064 6174 6120 616e  r.....   data an
-00053fd0: 6420 6669 742e 2054 6865 2064 6174 6120  d fit. The data 
-00053fe0: 6973 2070 6c6f 7474 6564 2069 6e20 6120  is plotted in a 
-00053ff0: 6e75 6d62 6572 206f 6620 7761 7973 2076  number of ways v
-00054000: 7320 6c69 6e65 6172 2061 6e64 0d0a 0909  s linear and....
-00054010: 0920 2020 6c6f 6761 7269 7468 6d69 6320  .   logarithmic 
-00054020: 6178 6973 2e20 5468 6973 2070 6c6f 7420  axis. This plot 
-00054030: 6973 206e 6f74 206d 656e 7420 666f 7220  is not ment for 
-00054040: 7075 626c 6963 6174 696f 6e20 6275 7420  publication but 
-00054050: 7665 7279 0d0a 0909 0920 2020 7573 6566  very.....   usef
-00054060: 756c 2074 6f20 6576 616c 7561 7465 2074  ul to evaluate t
-00054070: 6865 2071 7561 6c69 7479 206f 6620 6120  he quality of a 
-00054080: 6669 742e 0d0a 0d0a 0909 0932 2e20 706c  fit........2. pl
-00054090: 6f74 206b 696e 6574 6963 7320 666f 7220  ot kinetics for 
-000540a0: 7365 6c65 6374 6564 2077 6176 656c 656e  selected wavelen
-000540b0: 6774 6820 2873 6565 2063 6f72 7265 7370  gth (see corresp
-000540c0: 6f6e 6469 6e67 2052 4157 2070 6c6f 7429  onding RAW plot)
-000540d0: 2e0d 0a0d 0a09 0909 332e 2070 6c6f 7420  ........3. plot 
-000540e0: 7370 6563 7472 6120 6174 2073 656c 6563  spectra at selec
-000540f0: 7465 6420 7469 6d65 7320 2873 6565 2063  ted times (see c
-00054100: 6f72 7265 7370 6f6e 6469 6e67 2052 4157  orresponding RAW
-00054110: 2070 6c6f 7429 2e0d 0a0d 0a09 0909 342e   plot)........4.
-00054120: 2070 6c6f 7473 206d 6174 7269 7820 286d   plots matrix (m
-00054130: 6561 7375 7265 642c 206d 6f64 656c 6c65  easured, modelle
-00054140: 6420 616e 6420 6572 726f 7220 4d61 7472  d and error Matr
-00054150: 6978 292e 2054 6865 2070 6172 616d 6574  ix). The paramet
-00054160: 6572 2061 7265 0d0a 0909 0920 2020 7468  er are.....   th
-00054170: 6520 7361 6d65 2061 7320 7573 6564 2066  e same as used f
-00054180: 6f72 2074 6865 2063 6f72 7265 7370 6f6e  or the correspon
-00054190: 6469 6e67 2052 4157 2070 6c6f 7420 7769  ding RAW plot wi
-000541a0: 7468 2074 6865 2061 6464 6974 696f 6e20  th the addition 
-000541b0: 6f66 0d0a 0909 0920 2020 2265 7272 6f72  of.....   "error
-000541c0: 5f6d 6174 7269 785f 616d 706c 6966 6963  _matrix_amplific
-000541d0: 6174 696f 6e22 2077 6869 6368 2069 7320  ation" which is 
-000541e0: 6120 7363 616c 696e 6720 6661 6374 6f72  a scaling factor
-000541f0: 206d 756c 7469 706c 6965 640d 0a09 0909   multiplied.....
-00054200: 2020 206f 6e74 6f20 7468 6520 6572 726f     onto the erro
-00054210: 7220 6d61 7472 6978 2e20 4920 7265 636f  r matrix. I reco
-00054220: 6d6d 656e 6420 746f 2070 6c61 7920 7769  mmend to play wi
-00054230: 7468 2064 6966 6665 7265 6e74 2022 636d  th different "cm
-00054240: 6170 222c 0d0a 0909 0920 2020 226c 6f67  ap",.....   "log
-00054250: 5f73 6361 6c65 2220 616e 6420 2269 6e74  _scale" and "int
-00054260: 656e 7369 7479 5f73 6361 6c65 2220 746f  ensity_scale" to
-00054270: 2063 7265 6174 6520 6120 706c 6561 7369   create a pleasi
-00054280: 6e67 2070 6c6f 742e 0d0a 0d0a 0909 0935  ng plot........5
-00054290: 2e20 636f 6e63 656e 7472 6174 696f 6e73  . concentrations
-000542a0: 2e20 496e 2074 6865 2070 726f 6772 6573  . In the progres
-000542b0: 7320 6f66 2074 6865 206d 6f64 656c 6c69  s of the modelli
-000542c0: 6e67 2f66 6974 7469 6e67 2061 206d 6174  ng/fitting a mat
-000542d0: 7269 7820 6973 0d0a 0909 0920 2020 6765  rix is.....   ge
-000542e0: 6e65 7261 7465 6420 7468 6174 2063 6f6e  nerated that con
-000542f0: 7461 696e 7320 7468 6520 7265 6c61 7469  tains the relati
-00054300: 7665 2063 6f6e 6365 6e74 7261 7469 6f6e  ve concentration
-00054310: 7320 6f66 2074 6865 2073 7065 6369 6573  s of the species
-00054320: 0d0a 0909 0920 2020 6d6f 6465 6c6c 6564  .....   modelled
-00054330: 2e20 5468 6973 2070 6c6f 7420 6973 2073  . This plot is s
-00054340: 686f 7769 6e67 2074 6865 2074 656d 706f  howing the tempo
-00054350: 7261 6c20 6465 7665 6c6f 706d 656e 7420  ral development 
-00054360: 6f66 2074 6865 7365 0d0a 0909 0920 2020  of these.....   
-00054370: 7370 6563 6965 732e 2046 7572 7468 6572  species. Further
-00054380: 2064 6574 6169 6c73 206f 6e20 686f 7720   details on how 
-00054390: 7468 6973 206d 6174 7269 7820 6973 2067  this matrix is g
-000543a0: 656e 6572 6174 6564 2063 616e 2062 6520  enerated can be 
-000543b0: 666f 756e 640d 0a09 0909 2020 2069 6e20  found.....   in 
-000543c0: 7468 6520 646f 6375 6d65 6e74 6174 696f  the documentatio
-000543d0: 6e20 6f66 2074 6865 2066 6974 7469 6e67  n of the fitting
-000543e0: 2066 756e 6374 696f 6e2e 2054 6865 206d   function. The m
-000543f0: 6f64 656c 6564 2073 7065 6374 7261 2061  odeled spectra a
-00054400: 7265 0d0a 0909 0920 2020 7468 6520 636f  re.....   the co
-00054410: 6e76 6f6c 7574 696f 6e20 6f66 2074 6865  nvolution of the
-00054420: 7365 2076 6563 746f 7273 2028 6769 7669  se vectors (givi
-00054430: 6e67 2074 6865 2074 696d 652d 6465 7665  ng the time-deve
-00054440: 6c6f 706d 656e 7429 2061 6e64 0d0a 0909  lopment) and....
-00054450: 0920 2020 7468 6520 4441 532f 5341 5320  .   the DAS/SAS 
-00054460: 2867 6976 696e 6720 7468 6520 7370 6563  (giving the spec
-00054470: 7472 616c 2064 6576 656c 6f70 6d65 6e74  tral development
-00054480: 292e 0d0a 0909 0d0a 0909 5061 7261 6d65  ).........Parame
-00054490: 7465 7273 0d0a 0909 2d2d 2d2d 2d2d 2d2d  ters....--------
-000544a0: 2d2d 2d2d 2d2d 2d0d 0a09 090d 0a09 0970  -------........p
-000544b0: 6c6f 7474 696e 6720 3a20 696e 7420 6f72  lotting : int or
-000544c0: 2069 7465 7261 626c 6520 286f 6620 696e   iterable (of in
-000544d0: 7465 6765 7273 292c 206f 7074 696f 6e61  tegers), optiona
-000544e0: 6c0d 0a09 0909 5468 6973 2070 6172 616d  l.....This param
-000544f0: 6574 6572 2064 6574 6572 6d69 6e65 7320  eter determines 
-00054500: 7768 6963 6820 6669 6775 7265 7320 6172  which figures ar
-00054510: 6520 706c 6f74 7465 6420 0d0a 0909 0974  e plotted .....t
-00054520: 6865 2066 6967 7572 6573 2063 616e 2062  he figures can b
-00054530: 6520 6361 6c6c 6564 2073 6570 6172 6174  e called separat
-00054540: 656c 7920 7769 7468 2070 6c6f 7474 696e  ely with plottin
-00054550: 6720 3d20 310d 0a09 0909 6f72 2077 6974  g = 1.....or wit
-00054560: 6820 6120 6c69 7374 206f 6620 706c 6f74  h a list of plot
-00054570: 7320 2844 6566 6175 6c74 2920 652e 672e  s (Default) e.g.
-00054580: 2070 6c6f 7474 696e 673d 7261 6e67 6528   plotting=range(
-00054590: 3629 2063 616c 6c73 2070 6c6f 7473 2030  6) calls plots 0
-000545a0: 2c31 2c32 2c33 2c34 2c35 0d0a 0909 0954  ,1,2,3,4,5.....T
-000545b0: 6865 2070 6c6f 7473 2068 6176 6520 7468  he plots have th
-000545c0: 6520 666f 6c6c 6f77 696e 6720 6e75 6d62  e following numb
-000545d0: 6572 733a 0d0a 0909 090d 0a09 0909 0930  ers:...........0
-000545e0: 2e20 4441 5320 6f72 2053 4153 0d0a 0909  . DAS or SAS....
-000545f0: 0909 312e 2073 756d 6d65 6420 696e 7465  ..1. summed inte
-00054600: 6e73 6974 790d 0a09 0909 0932 2e20 4b69  nsity......2. Ki
-00054610: 6e65 7469 6373 0d0a 0909 0909 332e 2053  netics......3. S
-00054620: 7065 6374 7261 0d0a 0909 0909 342e 204d  pectra......4. M
-00054630: 6174 7269 7865 730d 0a09 0909 0935 2e20  atrixes......5. 
-00054640: 436f 6e63 656e 7472 6174 696f 6e73 2028  Concentrations (
-00054650: 7468 6520 632d 6f62 6a65 6374 290d 0a09  the c-object)...
-00054660: 0909 0d0a 0909 0954 6865 2070 6c6f 7474  .......The plott
-00054670: 696e 6720 7461 6b65 7320 616c 6c20 7061  ing takes all pa
-00054680: 7261 6d65 7465 7220 6672 6f6d 2074 6865  rameter from the
-00054690: 2022 7461 2220 6f62 6a65 6374 2075 6e6c   "ta" object unl
-000546a0: 6573 7320 6f74 6865 7277 6973 6520 7370  ess otherwise sp
-000546b0: 6563 6966 6965 640d 0a09 090d 0a09 0970  ecified........p
-000546c0: 6174 6820 3a20 4e6f 6e65 2c20 7374 7220  ath : None, str 
-000546d0: 6f72 2070 6174 6820 6f62 6a65 6374 2c20  or path object, 
-000546e0: 6f70 7469 6f6e 616c 0d0a 0909 0954 6869  optional.....Thi
-000546f0: 7320 6465 6669 6e65 7320 7768 6572 6520  s defines where 
-00054700: 7468 6520 6669 6c65 7320 6172 6520 7361  the files are sa
-00054710: 7665 6420 6966 2074 6865 2073 6166 655f  ved if the safe_
-00054720: 6669 6775 7265 735f 746f 5f66 6f6c 6465  figures_to_folde
-00054730: 7220 7061 7261 6d65 7465 7220 6973 2054  r parameter is T
-00054740: 7275 652c 200d 0a09 0909 7175 6974 6520  rue, .....quite 
-00054750: 7573 6566 756c 2069 6620 6120 6c6f 7420  useful if a lot 
-00054760: 6f66 2064 6174 6120 7365 7473 2061 7265  of data sets are
-00054770: 2074 6f20 6265 2070 7269 6e74 6564 2066   to be printed f
-00054780: 6173 742e 200d 0a09 0909 4966 2061 2070  ast. .....If a p
-00054790: 6174 6820 6973 2067 6976 656e 2c20 7468  ath is given, th
-000547a0: 6973 2069 7320 7573 6564 2e20 4966 2061  is is used. If a
-000547b0: 2073 7472 696e 6720 6c69 6b65 2074 6865   string like the
-000547c0: 2028 4465 6661 756c 7429 2022 7265 7375   (Default) "resu
-000547d0: 6c74 5f66 6967 7572 6573 2220 6973 2067  lt_figures" is g
-000547e0: 6976 656e 2c20 0d0a 0909 0974 6865 6e20  iven, .....then 
-000547f0: 6120 7375 6266 6f6c 6465 7220 6f66 2074  a subfolder of t
-00054800: 6869 7320 6e61 6d65 2077 696c 6c20 6265  his name will be
-00054810: 2075 7365 6420 2861 6e20 6765 6e65 7261   used (an genera
-00054820: 7465 6420 6966 206e 6563 6573 7361 7279  ted if necessary
-00054830: 2920 0d0a 0909 0972 656c 6174 6976 6520  ) .....relative 
-00054840: 746f 2073 656c 662e 7061 7468 2e20 5573  to self.path. Us
-00054850: 6520 616e 6420 656d 7074 7920 7374 7269  e and empty stri
-00054860: 6e67 2074 6f20 7573 6520 7468 6520 7365  ng to use the se
-00054870: 6c66 2e70 6174 680d 0a09 0909 4966 2073  lf.path.....If s
-00054880: 6574 2074 6f20 4e6f 6e65 2c20 7468 6520  et to None, the 
-00054890: 6c6f 6361 7469 6f6e 206f 6620 7468 6520  location of the 
-000548a0: 706c 6f74 5f66 756e 6320 7769 6c6c 2062  plot_func will b
-000548b0: 6520 7573 6564 2061 6e64 0d0a 0909 0961  e used and.....a
-000548c0: 2073 7562 666f 6c64 6572 2077 6974 6820   subfolder with 
-000548d0: 7469 746c 6520 2272 6573 756c 745f 6669  title "result_fi
-000548e0: 6775 7265 7322 2062 6520 6765 6e65 7261  gures" be genera
-000548f0: 7465 6420 6865 7265 0d0a 0909 0d0a 0909  ted here........
-00054900: 7361 7665 7479 7065 203a 2073 7472 206f  savetype : str o
-00054910: 7220 6974 6572 6162 6c65 2028 6f66 2073  r iterable (of s
-00054920: 7472 292c 206f 7074 696f 6e61 6c20 0d0a  tr), optional ..
-00054930: 0909 096d 6174 706c 6f74 6c69 6220 616c  ...matplotlib al
-00054940: 6c6f 7773 2074 6865 2073 6176 696e 6720  lows the saving 
-00054950: 6f66 2066 6967 7572 6573 2069 6e20 7661  of figures in va
-00054960: 7269 6f75 7320 666f 726d 6174 732e 2028  rious formats. (
-00054970: 4465 6661 756c 7429 2022 706e 6722 2c20  Default) "png", 
-00054980: 0d0a 0909 0974 7970 6963 616c 2061 6e64  .....typical and
-00054990: 2072 6563 6f6d 6d65 6e64 6162 6c65 206f   recommendable o
-000549a0: 7074 696f 6e73 2061 7265 2022 7376 6722  ptions are "svg"
-000549b0: 2061 6e64 2022 7064 6622 2e20 200d 0a09   and "pdf".  ...
-000549c0: 0909 0d0a 0909 6576 616c 7561 7469 6f6e  ......evaluation
-000549d0: 5f73 7479 6c65 203a 2062 6f6f 6c2c 206f  _style : bool, o
-000549e0: 7074 696f 6e61 6c0d 0a09 0909 5472 7565  ptional.....True
-000549f0: 2028 4465 6661 756c 7420 3d20 4661 6c73   (Default = Fals
-00054a00: 6529 2061 6464 7320 6120 6c6f 7420 6f66  e) adds a lot of
-00054a10: 2065 7874 7261 2069 6e66 6f72 6d61 7469   extra informati
-00054a20: 6f6e 2069 6e20 7468 6520 706c 6f74 0d0a  on in the plot..
-00054a30: 0909 0d0a 0909 7469 746c 6520 3a20 4e6f  ......title : No
-00054a40: 6e65 206f 7220 7374 722c 206f 7074 696f  ne or str, optio
-00054a50: 6e61 6c0d 0a09 0920 2020 2274 6974 6c65  nal....   "title
-00054a60: 3d4e 6f6e 6522 2069 7320 696e 2067 656e  =None" is in gen
-00054a70: 6572 616c 2074 6865 2066 696c 656e 616d  eral the filenam
-00054a80: 6520 7468 6174 2077 6173 206c 6f61 6465  e that was loade
-00054a90: 642e 2053 6574 7469 6e67 2061 0d0a 0909  d. Setting a....
-00054aa0: 2020 2073 7065 6369 6669 6320 7469 746c     specific titl
-00054ab0: 6520 7769 6c6c 2062 6520 7573 6564 2069  e will be used i
-00054ac0: 6e20 616c 6c20 706c 6f74 732e 2054 6f20  n all plots. To 
-00054ad0: 7265 6d6f 7665 2074 6865 2074 6974 6c65  remove the title
-00054ae0: 2061 6c6c 0d0a 0909 2020 2074 6f67 6574   all....   toget
-00054af0: 6865 7220 7365 7420 616e 2065 6d70 7479  her set an empty
-00054b00: 2073 7472 696e 6720 7769 7468 2074 6974   string with tit
-00054b10: 6c65 3d22 220d 0a09 0920 2020 0d0a 0909  le=""....   ....
-00054b20: 7363 616c 655f 7479 7065 203a 2073 7472  scale_type : str
-00054b30: 2c20 6f70 7469 6f6e 616c 0d0a 0909 2020  , optional....  
-00054b40: 2072 6566 6572 7320 746f 2074 6865 2074   refers to the t
-00054b50: 696d 652d 6178 6973 2061 6e64 2074 616b  ime-axis and tak
-00054b60: 6573 2c20 2273 796d 6c6f 6722 2028 4465  es, "symlog" (De
-00054b70: 6661 756c 7429 286c 696e 6561 7220 6172  fault)(linear ar
-00054b80: 6f75 6e64 207a 6572 6f20 616e 6420 6c6f  ound zero and lo
-00054b90: 6761 7269 7468 6d69 6320 6f74 6865 7277  garithmic otherw
-00054ba0: 6973 6529 0d0a 0909 2020 2061 6e64 2022  ise)....   and "
-00054bb0: 6c69 6e22 2066 6f72 206c 696e 6561 7220  lin" for linear 
-00054bc0: 616e 6420 2022 6c6f 6722 2066 6f72 206c  and  "log" for l
-00054bd0: 6f67 6172 6974 686d 6963 2c20 7377 6974  ogarithmic, swit
-00054be0: 6368 696e 6720 616c 6c20 7468 6520 7469  ching all the ti
-00054bf0: 6d65 2061 7869 7320 746f 2074 6869 7320  me axis to this 
-00054c00: 7479 7065 0d0a 0909 0d0a 0909 7061 7463  type........patc
-00054c10: 6865 7320 3a20 626f 6f6c 2c20 6f70 7469  hes : bool, opti
-00054c20: 6f6e 616c 0d0a 0909 0949 6620 4661 6c73  onal.....If Fals
-00054c30: 6520 2844 6566 6175 6c74 2920 7468 6520  e (Default) the 
-00054c40: 6e61 6d65 7320 226d 6561 7375 7265 6422  names "measured"
-00054c50: 2022 6669 7474 6564 2220 2264 6966 6665   "fitted" "diffe
-00054c60: 7265 6e63 6522 2077 696c 6c20 6265 2070  rence" will be p
-00054c70: 6c61 6365 6420 6162 6f76 6520 7468 6520  laced above the 
-00054c80: 696d 6167 6573 2e0d 0a09 0909 4966 2054  images......If T
-00054c90: 7275 652c 2074 6865 6e20 7468 6579 2077  rue, then they w
-00054ca0: 696c 6c20 6265 2069 6e63 6c75 6465 6420  ill be included 
-00054cb0: 696e 746f 2074 6865 2069 6d61 6765 2028  into the image (
-00054cc0: 6465 6e73 6572 290d 0a0d 0a09 0966 696c  denser)......fil
-00054cd0: 656e 616d 6520 3a20 7374 722c 206f 7074  ename : str, opt
-00054ce0: 696f 6e61 6c0d 0a09 0909 6f66 6665 7273  ional.....offers
-00054cf0: 2074 6f20 7265 706c 6163 6520 7468 6520   to replace the 
-00054d00: 6261 7365 2d6e 616d 6520 7573 6564 2066  base-name used f
-00054d10: 6f72 2061 6c6c 2070 6c6f 7473 2028 746f  or all plots (to
-00054d20: 2065 2e67 2e73 7065 6369 6679 2077 6861   e.g.specify wha
-00054d30: 7420 7361 6d70 6c65 2077 6173 2075 7365  t sample was use
-00054d40: 6429 2e20 0d0a 0909 0969 6620 2844 6566  d). .....if (Def
-00054d50: 6175 6c74 2920 4e6f 6e65 2069 7320 7573  ault) None is us
-00054d60: 6564 2c20 7468 6520 7365 6c66 2e66 696c  ed, the self.fil
-00054d70: 656e 616d 6520 6973 2075 7365 6420 6173  ename is used as
-00054d80: 2061 2062 6173 6520 6e61 6d65 2e20 5468   a base name. Th
-00054d90: 6520 6669 6c65 6e61 6d65 2070 6c61 7973  e filename plays
-00054da0: 206f 6e6c 7920 6120 0d0a 0909 0972 6f6c   only a .....rol
-00054db0: 6520 6475 7269 6e67 2073 6176 696e 672c  e during saving,
-00054dc0: 2061 7320 646f 6573 2074 6865 2070 6174   as does the pat
-00054dd0: 6820 616e 6420 7361 7665 7479 7065 090d  h and savetype..
-00054de0: 0a09 0909 0d0a 0909 636d 6170 203a 204e  ........cmap : N
-00054df0: 6f6e 6520 6f72 206d 6174 706c 6f74 6c69  one or matplotli
-00054e00: 6220 636f 6c6f 7220 6d61 702c 206f 7074  b color map, opt
-00054e10: 696f 6e61 6c0d 0a09 0909 6973 2061 2070  ional.....is a p
-00054e20: 6f77 6572 6675 6c6c 2076 6172 6961 626c  owerfull variabl
-00054e30: 6520 7468 6174 2063 686f 6f73 6573 2074  e that chooses t
-00054e40: 6865 2063 6f6c 6f75 7220 6d61 7020 6170  he colour map ap
-00054e50: 706c 6965 6420 666f 7220 616c 6c20 706c  plied for all pl
-00054e60: 6f74 732e 2049 6620 7365 7420 746f 200d  ots. If set to .
-00054e70: 0a09 0909 4e6f 6e65 2028 4465 6661 756c  ....None (Defaul
-00054e80: 7429 2074 6865 6e20 7468 6520 7365 6c66  t) then the self
-00054e90: 2e63 6d61 7020 6973 2075 7365 642e 0d0a  .cmap is used...
-00054ea0: 0909 0941 7320 7374 616e 6461 7264 2049  ...As standard I
-00054eb0: 2075 7365 2074 6865 2063 6f6c 6f72 206d   use the color m
-00054ec0: 6170 2022 6a65 7422 2066 726f 6d20 6d61  ap "jet" from ma
-00054ed0: 7470 6c6f 746c 6962 2e20 5468 6572 6520  tplotlib. There 
-00054ee0: 6172 6520 6120 7661 7269 6574 7920 6f66  are a variety of
-00054ef0: 2063 6f6c 6f72 6d61 7073 200d 0a09 0909   colormaps .....
-00054f00: 6176 6169 6c61 626c 6520 7468 6174 2061  available that a
-00054f10: 7265 2076 6572 7920 7573 6566 756c 6c2e  re very usefull.
-00054f20: 2042 6573 6964 6520 226a 6574 222c 2022   Beside "jet", "
-00054f30: 7669 7269 6469 7322 2069 7320 6120 676f  viridis" is a go
-00054f40: 6f64 2063 686f 6963 6520 6173 2069 7420  od choice as it 
-00054f50: 6973 2077 656c 6c20 0d0a 0909 0976 6973  is well .....vis
-00054f60: 6962 6c65 2075 6e64 6572 2072 6564 2d67  ible under red-g
-00054f70: 7265 656e 2062 6c69 6e64 6e65 7373 2e20  reen blindness. 
-00054f80: 4f74 6865 7220 7573 6566 756c 206d 6170  Other useful map
-00054f90: 7320 6172 6520 2270 7269 736d 2220 666f  s are "prism" fo
-00054fa0: 7220 6869 6768 2066 6c75 6374 7561 7469  r high fluctuati
-00054fb0: 6f6e 7320 0d0a 0909 096f 7220 6469 7665  ons .....or dive
-00054fc0: 7267 696e 6720 636f 6c6f 7220 6d61 7073  rging color maps
-00054fd0: 206c 696b 6520 2273 6569 736d 6963 222e   like "seismic".
-00054fe0: 200d 0a09 0909 5365 6520 6874 7470 733a   .....See https:
-00054ff0: 2f2f 6d61 7470 6c6f 746c 6962 2e6f 7267  //matplotlib.org
-00055000: 2f33 2e31 2e30 2f74 7574 6f72 6961 6c73  /3.1.0/tutorials
-00055010: 2f63 6f6c 6f72 732f 636f 6c6f 726d 6170  /colors/colormap
-00055020: 732e 6874 6d6c 2066 6f72 2061 2063 6f6d  s.html for a com
-00055030: 7072 6568 656e 7369 7665 200d 0a09 0909  prehensive .....
-00055040: 7365 6c65 6374 696f 6e2e 2049 6e20 7468  selection. In th
-00055050: 6520 636f 6465 2074 6865 2063 6f6c 6f72  e code the color
-00055060: 6d61 7073 2061 7265 2069 6d70 6f72 7465  maps are importe
-00055070: 6420 736f 2069 6620 706c 6f74 5f66 756e  d so if plot_fun
-00055080: 6320 6973 2069 6d70 6f72 7465 6420 6173  c is imported as
-00055090: 2070 6620 7468 656e 200d 0a09 0909 7365   pf then .....se
-000550a0: 6c66 2e63 6d61 703d 7066 2e63 6d2e 7669  lf.cmap=pf.cm.vi
-000550b0: 7269 6469 7320 7365 7473 2076 6972 6964  ridis sets virid
-000550c0: 6973 2061 7320 7468 6520 6d61 7020 746f  is as the map to
-000550d0: 2075 7365 2e20 496e 7465 726e 616c 6c79   use. Internally
-000550e0: 2074 6865 2063 6f6c 6f72 7320 6172 6520   the colors are 
-000550f0: 6368 6f73 656e 200d 0a09 0909 7769 7468  chosen .....with
-00055100: 2074 6865 2022 636f 6c6d 2220 6675 6e63   the "colm" func
-00055110: 7469 6f6e 2e20 5468 6520 3264 2070 6c6f  tion. The 2d plo
-00055120: 7473 2072 6571 7569 7265 2061 2063 6f6e  ts require a con
-00055130: 7469 6e75 6f75 7320 636f 6c6f 7220 6d61  tinuous color ma
-00055140: 7020 736f 2069 6620 736f 6d65 7468 696e  p so if somethin
-00055150: 6720 0d0a 0909 0965 6c73 6520 6973 2067  g .....else is g
-00055160: 6976 6520 3264 2070 6c6f 7473 2061 7265  ive 2d plots are
-00055170: 2073 686f 776e 2061 7574 6f6d 6174 6963   shown automatic
-00055180: 616c 6c79 2077 6974 6820 226a 6574 222e  ally with "jet".
-00055190: 2046 6f72 2061 6c6c 206f 6620 7468 6520   For all of the 
-000551a0: 3164 2070 6c6f 7473 2068 6f77 6576 6572  1d plots however
-000551b0: 200d 0a09 0909 4920 6669 7273 7420 7365   .....I first se
-000551c0: 6c65 6374 2061 206e 756d 6265 7220 6f66  lect a number of
-000551d0: 2063 6f6c 6f72 7320 6265 666f 7265 2065   colors before e
-000551e0: 6163 6820 706c 6f74 2e20 4966 2063 6d61  ach plot. If cma
-000551f0: 7020 6973 2061 2063 6f6e 7469 6e6f 7573  p is a continous
-00055200: 206d 6170 2074 6865 6e20 7468 6573 650d   map then these.
-00055210: 0a09 0909 6172 6520 7361 6d70 6c65 6420  ....are sampled 
-00055220: 6576 656e 6c79 206f 7665 7220 7468 6520  evenly over the 
-00055230: 636f 6c6f 7572 6d61 702e 204d 616e 7561  colourmap. Manua
-00055240: 6c20 6974 6572 6162 6c65 7320 6f66 2063  l iterables of c
-00055250: 6f6c 6f75 7273 200d 0a09 0909 636d 6170  olours .....cmap
-00055260: 3d5b 2831 2c30 2c30 292c 2830 2c31 2c30  =[(1,0,0),(0,1,0
-00055270: 292c 2830 2c30 2c31 292c 2e2e 2e5d 2061  ),(0,0,1),...] a
-00055280: 7265 2061 6c73 6f20 6163 6365 7074 6564  re also accepted
-00055290: 2c20 6173 2061 7265 2076 6563 746f 7273  , as are vectors
-000552a0: 206f 7220 6461 7461 6672 616d 6573 2074   or dataframes t
-000552b0: 6861 7420 0d0a 0909 0963 6f6e 7461 696e  hat .....contain
-000552c0: 2061 7320 726f 7773 2074 6865 2063 6f6c   as rows the col
-000552d0: 6f72 732e 2054 6865 7265 206d 7573 7420  ors. There must 
-000552e0: 6265 206f 6620 636f 7572 7365 2073 7566  be of course suf
-000552f0: 6669 6369 656e 7420 636f 6c6f 7273 2070  ficient colors p
-00055300: 7265 7365 6e74 2066 6f72 200d 0a09 0909  resent for .....
-00055310: 7468 6520 6e75 6d62 6572 7320 6f66 206c  the numbers of l
-00055320: 696e 6573 2074 6861 7420 7769 6c6c 2062  ines that will b
-00055330: 6520 706c 6f74 7465 642e 2053 6f20 4920  e plotted. So I 
-00055340: 7265 636f 6d6d 656e 6420 746f 2070 726f  recommend to pro
-00055350: 7669 6465 2061 7420 6c65 6173 7420 3130  vide at least 10
-00055360: 2063 6f6c 6f75 7273 200d 0a09 0909 2865   colours .....(e
-00055370: 2e67 2e79 6f75 7220 756e 6976 6572 7369  .g.your universi
-00055380: 7479 2063 6f6c 6f72 7329 2e20 636f 6c6f  ty colors). colo
-00055390: 7572 7320 6172 6520 616c 7761 7973 2067  urs are always g
-000553a0: 6976 656e 2061 7320 612c 206c 6973 7420  iven as a, list 
-000553b0: 6f72 2074 7570 6c65 2077 6974 6820 5247  or tuple with RG
-000553c0: 4120 6f72 2052 4742 410d 0a09 0909 2877  A or RGBA.....(w
-000553d0: 6974 6820 7468 6520 6c61 7374 2041 2062  ith the last A b
-000553e0: 6565 696e 6720 7468 6520 416c 7068 613d  eeing the Alpha=
-000553f0: 7472 616e 7370 6172 656e 6379 2e20 416c  transparency. Al
-00055400: 6c20 6e75 6d62 6572 7320 6172 6520 6265  l numbers are be
-00055410: 7477 6565 6e20 3020 616e 6420 312e 200d  tween 0 and 1. .
-00055420: 0a09 0909 4966 2061 206c 6973 742f 7665  ....If a list/ve
-00055430: 6374 6f72 2f44 6174 6146 7261 6d65 2069  ctor/DataFrame i
-00055440: 7320 6769 7665 6e20 666f 7220 7468 6520  s given for the 
-00055450: 636f 6c6f 7572 7320 7468 6579 2077 696c  colours they wil
-00055460: 6c20 6265 2075 7365 6420 696e 2074 6865  l be used in the
-00055470: 206f 7264 6572 2070 726f 7669 6465 642e   order provided.
-00055480: 0909 0d0a 0909 0d0a 0909 7072 696e 745f  ..........print_
-00055490: 636c 6963 6b5f 706f 7369 7469 6f6e 203a  click_position :
-000554a0: 2062 6f6f 6c2c 206f 7074 696f 6e61 6c0d   bool, optional.
-000554b0: 0a09 0909 6966 2054 7275 6520 7468 656e  ....if True then
-000554c0: 2074 6865 2063 6c69 636b 2070 6f73 6974   the click posit
-000554d0: 696f 6e20 6973 2070 7269 6e74 6564 2066  ion is printed f
-000554e0: 6f72 2074 6865 2073 7065 6374 7261 6c20  or the spectral 
-000554f0: 706c 6f74 7320 0d0a 0909 0d0a 0909 4578  plots ........Ex
-00055500: 616d 706c 6573 0d0a 0909 2d2d 2d2d 2d2d  amples....------
-00055510: 2d2d 2d2d 2d2d 0d0a 0909 0d0a 0909 5479  ------........Ty
-00055520: 7069 6361 6c6c 7920 6f6e 6520 776f 756c  pically one woul
-00055530: 6420 6361 6c6c 2074 6869 7320 6675 6e63  d call this func
-00055540: 7469 6f6e 2065 6d70 7479 2066 6f72 2061  tion empty for a
-00055550: 6e20 6f76 6572 7669 6577 3a0d 0a09 0941  n overview:....A
-00055560: 6674 6572 2074 6865 206d 696e 696d 756d  fter the minimum
-00055570: 2066 6974 0d0a 0909 0d0a 0909 3e3e 3e20   fit........>>> 
-00055580: 7461 3d70 662e 5441 2827 7465 7374 6669  ta=pf.TA('testfi
-00055590: 6c65 2e53 4941 2729 0d0a 0909 3e3e 3e20  le.SIA')....>>> 
-000555a0: 7461 2e70 6172 3d6c 6d66 6974 2e50 6172  ta.par=lmfit.Par
-000555b0: 616d 6574 6572 7328 290d 0a09 093e 3e3e  ameters()....>>>
-000555c0: 2074 612e 7061 722e 6164 6428 276b 3027   ta.par.add('k0'
-000555d0: 2c76 616c 7565 3d31 2f30 2e31 2c76 6172  ,value=1/0.1,var
-000555e0: 793d 5472 7565 290d 0a09 093e 3e3e 2074  y=True)....>>> t
-000555f0: 612e 4669 745f 476c 6f62 616c 2829 0d0a  a.Fit_Global()..
-00055600: 0909 0d0a 0909 4f6e 6520 7573 7561 6c6c  ......One usuall
-00055610: 7920 706c 6f74 7320 7468 6520 616e 206f  y plots the an o
-00055620: 7665 7276 6965 770d 0a09 090d 0a09 093e  verview........>
-00055630: 3e3e 2074 612e 506c 6f74 5f66 6974 5f6f  >> ta.Plot_fit_o
-00055640: 7574 7075 7428 290d 0a09 093e 3e3e 2074  utput()....>>> t
-00055650: 612e 506c 6f74 5f66 6974 5f6f 7574 7075  a.Plot_fit_outpu
-00055660: 7428 706c 6f74 7469 6e67 3d72 616e 6765  t(plotting=range
-00055670: 2836 2929 2023 6973 2074 6865 2073 616d  (6)) #is the sam
-00055680: 6520 6173 2062 6566 6f72 650d 0a09 093e  e as before....>
-00055690: 3e3e 2074 612e 506c 6f74 5f66 6974 5f6f  >> ta.Plot_fit_o
-000556a0: 7574 7075 7428 3229 2023 776f 756c 6420  utput(2) #would 
-000556b0: 706c 6f74 206f 6e6c 7920 7468 6520 6b69  plot only the ki
-000556c0: 6e65 7469 6373 0d0a 0909 3e3e 3e20 7461  netics....>>> ta
-000556d0: 2e50 6c6f 745f 6669 745f 6f75 7470 7574  .Plot_fit_output
-000556e0: 2870 6c6f 7474 696e 6720 3d20 3229 2023  (plotting = 2) #
-000556f0: 776f 756c 6420 706c 6f74 206f 6e6c 7920  would plot only 
-00055700: 7468 6520 6b69 6e65 7469 6373 0d0a 0909  the kinetics....
-00055710: 0909 0d0a 0d0a 0909 2727 270d 0a09 0974  ........'''....t
-00055720: 7279 3a0d 0a09 0909 7265 3d73 656c 662e  ry:.....re=self.
-00055730: 7265 0d0a 0909 6578 6365 7074 3a0d 0a09  re....except:...
-00055740: 0909 7072 696e 7428 2757 6520 6e65 6564  ..print('We need
-00055750: 2074 6f20 6861 7665 2066 6974 7465 6420   to have fitted 
-00055760: 736f 6d65 7468 696e 6720 736f 2074 6861  something so tha
-00055770: 7420 7765 2063 616e 2070 6c6f 7427 290d  t we can plot').
-00055780: 0a09 0909 7265 7475 726e 2046 616c 7365  ....return False
-00055790: 0d0a 0909 7061 7468 3d63 6865 636b 5f66  ....path=check_f
-000557a0: 6f6c 6465 7228 7061 7468 3d70 6174 682c  older(path=path,
-000557b0: 6375 7272 656e 745f 7061 7468 3d73 656c  current_path=sel
-000557c0: 662e 7061 7468 290d 0a09 0969 6620 7365  f.path)....if se
-000557d0: 6c66 2e73 6176 655f 6669 6775 7265 735f  lf.save_figures_
-000557e0: 746f 5f66 6f6c 6465 723a 0d0a 0909 0973  to_folder:.....s
-000557f0: 656c 662e 6669 6775 7265 5f70 6174 683d  elf.figure_path=
-00055800: 7061 7468 0d0a 0909 6966 2063 6d61 7020  path....if cmap 
-00055810: 6973 204e 6f6e 653a 636d 6170 3d73 656c  is None:cmap=sel
-00055820: 662e 636d 6170 0d0a 0909 6966 2066 696c  f.cmap....if fil
-00055830: 656e 616d 6520 6973 204e 6f6e 653a 6669  ename is None:fi
-00055840: 6c65 6e61 6d65 3d73 656c 662e 6669 6c65  lename=self.file
-00055850: 6e61 6d65 0d0a 0909 6966 2074 6974 6c65  name....if title
-00055860: 2069 7320 4e6f 6e65 3a0d 0a09 0909 6966   is None:.....if
-00055870: 2066 696c 656e 616d 6520 6973 204e 6f6e   filename is Non
-00055880: 653a 0d0a 0909 0909 7469 746c 653d 7365  e:......title=se
-00055890: 6c66 2e66 696c 656e 616d 650d 0a09 0909  lf.filename.....
-000558a0: 656c 7365 3a0d 0a09 0909 0974 6974 6c65  else:......title
-000558b0: 3d66 696c 656e 616d 650d 0a09 0969 6620  =filename....if 
-000558c0: 6e6f 7420 6861 7361 7474 7228 706c 6f74  not hasattr(plot
-000558d0: 7469 6e67 2c22 5f5f 6974 6572 5f5f 2229  ting,"__iter__")
-000558e0: 3a70 6c6f 7474 696e 673d 5b70 6c6f 7474  :plotting=[plott
-000558f0: 696e 675d 0d0a 0909 706c 6f74 5f66 6974  ing]....plot_fit
-00055900: 5f6f 7574 7075 7428 7365 6c66 2e72 652c  _output(self.re,
-00055910: 2073 656c 662e 6473 2c20 636d 6170 203d   self.ds, cmap =
-00055920: 2073 656c 662e 636d 6170 2c20 706c 6f74   self.cmap, plot
-00055930: 7469 6e67 203d 2070 6c6f 7474 696e 672c  ting = plotting,
-00055940: 2074 6974 6c65 203d 2074 6974 6c65 2c20   title = title, 
-00055950: 0d0a 0909 0909 0909 7061 7468 203d 2070  ........path = p
-00055960: 6174 682c 2066 203d 2066 696c 656e 616d  ath, f = filenam
-00055970: 652c 2069 6e74 656e 7369 7479 5f72 616e  e, intensity_ran
-00055980: 6765 203d 2073 656c 662e 696e 7465 6e73  ge = self.intens
-00055990: 6974 795f 7261 6e67 652c 200d 0a09 0909  ity_range, .....
-000559a0: 0909 096c 6f67 5f73 6361 6c65 203d 2073  ...log_scale = s
-000559b0: 656c 662e 6c6f 675f 7363 616c 652c 2062  elf.log_scale, b
-000559c0: 6173 6575 6e69 7420 3d20 7365 6c66 2e62  aseunit = self.b
-000559d0: 6173 6575 6e69 742c 2074 696d 656c 696d  aseunit, timelim
-000559e0: 6974 7320 3d20 7365 6c66 2e74 696d 656c  its = self.timel
-000559f0: 696d 6974 732c 200d 0a09 0909 0909 0973  imits, ........s
-00055a00: 6361 7474 6572 6375 7420 3d20 7365 6c66  cattercut = self
-00055a10: 2e73 6361 7474 6572 6375 742c 2062 6f72  .scattercut, bor
-00055a20: 6465 7263 7574 203d 2073 656c 662e 626f  dercut = self.bo
-00055a30: 7264 6572 6375 742c 200d 0a09 0909 0909  rdercut, .......
-00055a40: 0965 7272 6f72 5f6d 6174 7269 785f 616d  .error_matrix_am
-00055a50: 706c 6966 6963 6174 696f 6e20 3d20 7365  plification = se
-00055a60: 6c66 2e65 7272 6f72 5f6d 6174 7269 785f  lf.error_matrix_
-00055a70: 616d 706c 6966 6963 6174 696f 6e2c 200d  amplification, .
-00055a80: 0a09 0909 0909 0977 6176 655f 6e6d 5f62  .......wave_nm_b
-00055a90: 696e 203d 2073 656c 662e 7761 7665 5f6e  in = self.wave_n
-00055aa0: 6d5f 6269 6e2c 2072 656c 5f77 6176 6520  m_bin, rel_wave 
-00055ab0: 3d20 7365 6c66 2e72 656c 5f77 6176 652c  = self.rel_wave,
-00055ac0: 2077 6964 7468 203d 2073 656c 662e 7761   width = self.wa
-00055ad0: 7665 6c65 6e67 7468 5f62 696e 2c20 0d0a  velength_bin, ..
-00055ae0: 0909 0909 0909 7265 6c5f 7469 6d65 203d  ......rel_time =
-00055af0: 2073 656c 662e 7265 6c5f 7469 6d65 2c20   self.rel_time, 
-00055b00: 7361 7665 5f66 6967 7572 6573 5f74 6f5f  save_figures_to_
-00055b10: 666f 6c64 6572 203d 2073 656c 662e 7361  folder = self.sa
-00055b20: 7665 5f66 6967 7572 6573 5f74 6f5f 666f  ve_figures_to_fo
-00055b30: 6c64 6572 2c20 0d0a 0909 0909 0909 6c6f  lder, ........lo
-00055b40: 675f 6669 7420 3d20 7365 6c66 2e6c 6f67  g_fit = self.log
-00055b50: 5f66 6974 2c6d 6f64 203d 2073 656c 662e  _fit,mod = self.
-00055b60: 6d6f 642c 2073 6176 6574 7970 6520 3d20  mod, savetype = 
-00055b70: 7361 7665 7479 7065 2c20 0d0a 0909 0909  savetype, ......
-00055b80: 0909 7469 6d65 5f77 6964 7468 5f70 6572  ..time_width_per
-00055b90: 6365 6e74 203d 2073 656c 662e 7469 6d65  cent = self.time
-00055ba0: 5f77 6964 7468 5f70 6572 6365 6e74 2c20  _width_percent, 
-00055bb0: 6576 616c 7561 7469 6f6e 5f73 7479 6c65  evaluation_style
-00055bc0: 203d 2065 7661 6c75 6174 696f 6e5f 7374   = evaluation_st
-00055bd0: 796c 652c 200d 0a09 0909 0909 0966 696c  yle, ........fil
-00055be0: 656e 616d 6520 3d20 7365 6c66 2e66 696c  ename = self.fil
-00055bf0: 656e 616d 652c 2073 6361 6c65 5f74 7970  ename, scale_typ
-00055c00: 6520 3d20 7363 616c 655f 7479 7065 2c20  e = scale_type, 
-00055c10: 7061 7463 6865 7320 3d20 7061 7463 6865  patches = patche
-00055c20: 732c 206c 696e 7472 6573 6820 3d20 7365  s, lintresh = se
-00055c30: 6c66 2e6c 696e 7472 6573 682c 0d0a 0909  lf.lintresh,....
-00055c40: 0909 0909 7072 696e 745f 636c 6963 6b5f  ....print_click_
-00055c50: 706f 7369 7469 6f6e 203d 2070 7269 6e74  position = print
-00055c60: 5f63 6c69 636b 5f70 6f73 6974 696f 6e2c  _click_position,
-00055c70: 2069 676e 6f72 655f 7469 6d65 5f72 6567   ignore_time_reg
-00055c80: 696f 6e20 3d20 7365 6c66 2e69 676e 6f72  ion = self.ignor
-00055c90: 655f 7469 6d65 5f72 6567 696f 6e2c 0d0a  e_time_region,..
-00055ca0: 0909 0909 0909 6461 7461 5f74 7970 6520  ......data_type 
-00055cb0: 3d20 7365 6c66 2e64 6174 615f 7479 7065  = self.data_type
-00055cc0: 2c20 706c 6f74 5f73 6563 6f6e 645f 6173  , plot_second_as
-00055cd0: 5f65 6e65 7267 7920 3d20 706c 6f74 5f73  _energy = plot_s
-00055ce0: 6563 6f6e 645f 6173 5f65 6e65 7267 792c  econd_as_energy,
-00055cf0: 2075 6e69 7473 3d20 7365 6c66 2e75 6e69   units= self.uni
-00055d00: 7473 2c20 0d0a 0909 0909 0909 6571 7561  ts, ........equa
-00055d10: 6c5f 656e 6572 6779 5f62 696e 203d 2073  l_energy_bin = s
-00055d20: 656c 662e 6571 7561 6c5f 656e 6572 6779  elf.equal_energy
-00055d30: 5f62 696e 290d 0a0d 0a0d 0a0d 0a09 6465  _bin).........de
-00055d40: 6620 5361 7665 5f64 6174 6128 7365 6c66  f Save_data(self
-00055d50: 2c20 7361 7665 5f52 4157 203d 2054 7275  , save_RAW = Tru
-00055d60: 652c 2073 6176 655f 4669 7420 3d20 5472  e, save_Fit = Tr
-00055d70: 7565 2c20 7361 7665 5f73 6c69 6365 7320  ue, save_slices 
-00055d80: 3d20 5472 7565 2c20 7361 7665 5f62 696e  = True, save_bin
-00055d90: 6e65 6420 3d20 4661 6c73 652c 200d 0a09  ned = False, ...
-00055da0: 0909 0909 6669 6c65 6e61 6d65 203d 204e  ....filename = N
-00055db0: 6f6e 652c 2073 6176 655f 6669 745f 7265  one, save_fit_re
-00055dc0: 7375 6c74 7320 3d20 5472 7565 2c20 7061  sults = True, pa
-00055dd0: 7468 203d 2027 4461 7461 5f65 7870 6f72  th = 'Data_expor
-00055de0: 7427 2c20 7365 7020 3d20 7374 7228 275c  t', sep = str('\
-00055df0: 7427 2929 3a0d 0a09 0927 2727 6861 6e64  t')):....'''hand
-00055e00: 7920 6675 6e63 7469 6f6e 2074 6f20 7361  y function to sa
-00055e10: 7665 2074 6865 2064 6174 6120 6f6e 2064  ve the data on d
-00055e20: 6973 6b20 6173 2064 6174 2066 696c 6573  isk as dat files
-00055e30: 2e0d 0a09 0954 6865 2052 4157 206c 6162  .....The RAW lab
-00055e40: 656c 6564 2066 696c 6573 2063 6f6e 7461  eled files conta
-00055e50: 696e 2074 6865 2063 6869 7270 2063 6f72  in the chirp cor
-00055e60: 7265 6374 6564 2076 616c 7565 7320 2873  rected values (s
-00055e70: 656c 662e 6473 290d 0a09 090d 0a09 0974  elf.ds)........t
-00055e80: 6865 2073 6176 655f 736c 6963 6573 2073  he save_slices s
-00055e90: 7769 7463 6820 7475 726e 7320 6f6e 2074  witch turns on t
-00055ea0: 6865 2064 756d 7020 6f66 2074 6865 2073  he dump of the s
-00055eb0: 6570 6172 6174 6520 736c 6963 6564 2066  eparate sliced f
-00055ec0: 6967 7572 6573 2028 7469 6d65 2061 6e64  igures (time and
-00055ed0: 2073 7065 6374 7261 6c29 200d 0a0d 0a09   spectral) .....
-00055ee0: 090d 0a09 0950 6172 616d 6574 6572 730d  .....Parameters.
-00055ef0: 0a09 092d 2d2d 2d2d 2d2d 2d2d 2d0d 0a09  ...----------...
-00055f00: 090d 0a09 0973 6176 655f 6269 6e6e 6564  .....save_binned
-00055f10: 203a 2062 6f6f 6c2c 206f 7074 696f 6e61   : bool, optiona
-00055f20: 6c0d 0a09 0909 6973 2061 6c73 6f20 7468  l.....is also th
-00055f30: 6520 7265 2d62 696e 6e65 6420 6d61 7472  e re-binned matr
-00055f40: 6978 2074 6f20 6265 2073 6176 6564 2e0d  ix to be saved..
-00055f50: 0a09 0909 0d0a 0909 7361 7665 5f73 6c69  ........save_sli
-00055f60: 6365 7320 3a20 626f 6f6c 2c20 6f70 7469  ces : bool, opti
-00055f70: 6f6e 616c 0d0a 0909 0973 6176 6520 7468  onal.....save th
-00055f80: 6520 6b69 6e65 7469 6373 2061 6e64 2073  e kinetics and s
-00055f90: 7065 6374 7261 2066 726f 6d20 7468 6520  pectra from the 
-00055fa0: 6669 7474 6564 2064 6174 6120 2877 6974  fitted data (wit
-00055fb0: 6820 7468 6520 6669 7473 290d 0a09 0909  h the fits).....
-00055fc0: 0d0a 0909 7365 7020 3a20 7374 722c 206f  ....sep : str, o
-00055fd0: 7074 696f 6e61 6c0d 0a09 0909 7768 6174  ptional.....what
-00055fe0: 2073 796d 626f 6c20 6973 2075 7365 6420   symbol is used 
-00055ff0: 746f 2073 6570 6172 6174 6520 6469 6666  to separate diff
-00056000: 6572 656e 7420 6e75 6d62 6572 2e20 2874  erent number. (t
-00056010: 7970 6963 616c 2065 6974 6865 7220 2774  ypical either 't
-00056020: 6162 2720 6f72 2063 6f6d 6d61 0d0a 0909  ab' or comma....
-00056030: 0d0a 0909 7361 7665 5f52 4157 203a 2062  ....save_RAW : b
-00056040: 6f6f 6c2c 206f 7074 696f 6e61 6c0d 0a09  ool, optional...
-00056050: 0909 2844 6566 6175 6c74 2920 5472 7565  ..(Default) True
-00056060: 2074 6865 6e20 7468 6520 6669 7273 7420   then the first 
-00056070: 736c 6964 6520 7769 7468 2074 6865 2052  slide with the R
-00056080: 4157 2064 6174 6120 6973 2063 7265 6174  AW data is creat
-00056090: 6564 200d 0a09 090d 0a09 0973 6176 655f  ed ........save_
-000560a0: 4669 7420 3a20 626f 6f6c 2c20 6f70 7469  Fit : bool, opti
-000560b0: 6f6e 616c 0d0a 0909 0928 4465 6661 756c  onal.....(Defaul
-000560c0: 7429 2054 7275 6520 7468 656e 2074 6865  t) True then the
-000560d0: 2073 6563 6f6e 6420 736c 6964 6520 7769   second slide wi
-000560e0: 7468 2074 6865 2046 6974 7465 6420 6461  th the Fitted da
-000560f0: 7461 2069 7320 6372 6561 7465 6420 0d0a  ta is created ..
-00056100: 0909 0d0a 0909 7061 7468 203a 204e 6f6e  ......path : Non
-00056110: 652c 2073 7472 206f 7220 7061 7468 2c20  e, str or path, 
-00056120: 6f70 7469 6f6e 616c 0d0a 0909 0928 4465  optional.....(De
-00056130: 6661 756c 7429 204e 6f6e 652c 2069 6620  fault) None, if 
-00056140: 6c65 6674 206f 6e20 4e6f 6e65 2c20 7468  left on None, th
-00056150: 656e 2061 2066 6f6c 6465 7220 2272 6573  en a folder "res
-00056160: 756c 745f 6669 6775 7265 7322 2069 7320  ult_figures" is 
-00056170: 6372 6561 7465 6420 696e 2074 6865 2066  created in the f
-00056180: 6f6c 6465 7220 0d0a 0909 096f 6620 7468  older .....of th
-00056190: 6520 6461 7461 2028 7365 6c66 2e70 6174  e data (self.pat
-000561a0: 6829 0d0a 0909 090d 0a09 0973 6176 655f  h).........save_
-000561b0: 6669 745f 7265 7375 6c74 7320 3a20 626f  fit_results : bo
-000561c0: 6f6c 2c20 6f70 7469 6f6e 616c 0d0a 0909  ol, optional....
-000561d0: 0969 6620 5472 7565 2028 4465 6661 756c  .if True (Defaul
-000561e0: 7429 2020 6120 6e65 6174 6c79 2066 6f72  t)  a neatly for
-000561f0: 6d61 7465 6420 6669 6c65 2077 6974 6820  mated file with 
-00056200: 7468 6520 6669 7420 7265 7375 6c74 7320  the fit results 
-00056210: 6973 2063 7265 6174 6564 2061 6e64 2073  is created and s
-00056220: 746f 7265 6420 7769 7468 2074 6865 2064  tored with the d
-00056230: 6174 610d 0a09 0909 0d0a 0909 6669 6c65  ata.........file
-00056240: 6e61 6d65 203a 2073 7472 2c20 6f70 7469  name : str, opti
-00056250: 6f6e 616c 0d0a 0909 0928 4465 6661 756c  onal.....(Defaul
-00056260: 7429 204e 6f6e 652c 2042 6173 6520 6e61  t) None, Base na
-00056270: 6d65 2066 6f72 2061 6c6c 2070 6c6f 7473  me for all plots
-00056280: 2e20 4966 204e 6f6e 652c 2074 6865 6e20  . If None, then 
-00056290: 7365 6c66 2e66 696c 656e 616d 6520 7769  self.filename wi
-000562a0: 6c6c 2062 6520 7573 6564 0d0a 0909 090d  ll be used......
-000562b0: 0a09 0945 7861 6d70 6c65 730d 0a09 092d  ...Examples....-
-000562c0: 2d2d 2d2d 2d2d 2d2d 0d0a 0909 3e3e 3e20  --------....>>> 
-000562d0: 7461 2e53 6176 655f 4461 7461 0d0a 0909  ta.Save_Data....
-000562e0: 0d0a 0909 2727 270d 0a09 090d 0a09 0969  ....'''........i
-000562f0: 6620 6669 6c65 6e61 6d65 2069 7320 4e6f  f filename is No
-00056300: 6e65 3a66 696c 656e 616d 6520 3d20 7365  ne:filename = se
-00056310: 6c66 2e66 696c 656e 616d 652e 7370 6c69  lf.filename.spli
-00056320: 7428 272e 2729 5b30 5d0d 0a09 0969 6620  t('.')[0]....if 
-00056330: 7361 7665 5f52 4157 3a0d 0a09 0909 7365  save_RAW:.....se
-00056340: 6c66 2e64 732e 746f 5f63 7376 2863 6865  lf.ds.to_csv(che
-00056350: 636b 5f66 6f6c 6465 7228 7061 7468 203d  ck_folder(path =
-00056360: 2070 6174 682c 2063 7572 7265 6e74 5f70   path, current_p
-00056370: 6174 6820 3d20 7365 6c66 2e70 6174 682c  ath = self.path,
-00056380: 200d 0a09 0909 0909 0909 6669 6c65 6e61   .........filena
-00056390: 6d65 203d 2066 696c 656e 616d 652b 275f  me = filename+'_
-000563a0: 6368 6972 705f 636f 7272 6563 7465 645f  chirp_corrected_
-000563b0: 7261 775f 6d61 7472 6978 2e64 6174 2729  raw_matrix.dat')
-000563c0: 2c20 7365 7020 3d20 7365 7029 0d0a 0909  , sep = sep)....
-000563d0: 0969 6620 7361 7665 5f62 696e 6e65 643a  .if save_binned:
-000563e0: 0d0a 0909 0909 7375 6220 3d20 7375 625f  ......sub = sub_
-000563f0: 6473 2873 656c 662e 6473 2c20 7363 6174  ds(self.ds, scat
-00056400: 7465 7263 7574 203d 2073 656c 662e 7363  tercut = self.sc
-00056410: 6174 7465 7263 7574 2c20 626f 7264 6572  attercut, border
-00056420: 6375 7420 3d20 7365 6c66 2e62 6f72 6465  cut = self.borde
-00056430: 7263 7574 2c20 0d0a 0909 0909 0909 0974  rcut, .........t
-00056440: 696d 656c 696d 6974 7320 3d20 7365 6c66  imelimits = self
-00056450: 2e74 696d 656c 696d 6974 732c 2077 6176  .timelimits, wav
-00056460: 655f 6e6d 5f62 696e 203d 2073 656c 662e  e_nm_bin = self.
-00056470: 7761 7665 5f6e 6d5f 6269 6e2c 200d 0a09  wave_nm_bin, ...
-00056480: 0909 0909 0909 7469 6d65 5f62 696e 203d  ......time_bin =
-00056490: 2073 656c 662e 7469 6d65 5f62 696e 290d   self.time_bin).
-000564a0: 0a09 0909 0973 7562 2e74 6f5f 6373 7628  .....sub.to_csv(
-000564b0: 6368 6563 6b5f 666f 6c64 6572 2870 6174  check_folder(pat
-000564c0: 6820 3d20 7061 7468 2c20 6375 7272 656e  h = path, curren
-000564d0: 745f 7061 7468 203d 2073 656c 662e 7061  t_path = self.pa
-000564e0: 7468 2c20 0d0a 0909 0909 0909 0909 0909  th, ............
-000564f0: 6669 6c65 6e61 6d65 203d 2066 696c 656e  filename = filen
-00056500: 616d 652b 275f 6368 6972 705f 636f 7272  ame+'_chirp_corr
-00056510: 6563 7465 645f 7265 6269 6e6e 6564 5f6d  ected_rebinned_m
-00056520: 6174 7269 782e 6461 7427 292c 2073 6570  atrix.dat'), sep
-00056530: 203d 2073 6570 290d 0a09 0909 6966 2073   = sep).....if s
-00056540: 6176 655f 736c 6963 6573 3a0d 0a09 0909  ave_slices:.....
-00056550: 0973 7562 203d 2073 7562 5f64 7328 6473  .sub = sub_ds(ds
-00056560: 203d 2073 656c 662e 6473 2e63 6f70 7928   = self.ds.copy(
-00056570: 292c 2077 6176 656c 656e 6774 685f 6269  ), wavelength_bi
-00056580: 6e20 3d20 7365 6c66 2e77 6176 656c 656e  n = self.wavelen
-00056590: 6774 685f 6269 6e2c 2077 6176 656c 656e  gth_bin, wavelen
-000565a0: 6774 6820 3d20 7365 6c66 2e72 656c 5f77  gth = self.rel_w
-000565b0: 6176 6529 0d0a 0909 0909 2373 7562 2e63  ave)......#sub.c
-000565c0: 6f6c 756d 6e73 2e6e 616d 6520 3d20 2777  olumns.name = 'w
-000565d0: 6176 656c 656e 6774 6820 5b6e 6d5d 2069  avelength [nm] i
-000565e0: 6e20 252e 3066 2062 696e 7327 2573 656c  n %.0f bins'%sel
-000565f0: 662e 7761 7665 6c65 6e67 7468 5f62 696e  f.wavelength_bin
-00056600: 0d0a 0909 0909 7375 622e 746f 5f63 7376  ......sub.to_csv
-00056610: 2863 6865 636b 5f66 6f6c 6465 7228 7061  (check_folder(pa
-00056620: 7468 203d 2070 6174 682c 2063 7572 7265  th = path, curre
-00056630: 6e74 5f70 6174 6820 3d20 7365 6c66 2e70  nt_path = self.p
-00056640: 6174 682c 200d 0a09 0909 0909 0909 6669  ath, .........fi
-00056650: 6c65 6e61 6d65 203d 2066 696c 656e 616d  lename = filenam
-00056660: 652b 275f 6368 6972 705f 636f 7272 6563  e+'_chirp_correc
-00056670: 7465 645f 5241 575f 6b69 6e65 7469 6373  ted_RAW_kinetics
-00056680: 2e64 6174 2729 2c20 7365 7020 3d20 7365  .dat'), sep = se
-00056690: 7029 0d0a 0909 0909 7375 6220 3d20 7375  p)......sub = su
-000566a0: 625f 6473 2864 7320 3d20 7365 6c66 2e64  b_ds(ds = self.d
-000566b0: 732e 636f 7079 2829 2c20 7469 6d65 7320  s.copy(), times 
-000566c0: 3d20 7365 6c66 2e72 656c 5f74 696d 652c  = self.rel_time,
-000566d0: 2074 696d 655f 7769 6474 685f 7065 7263   time_width_perc
-000566e0: 656e 7420 3d20 7365 6c66 2e74 696d 655f  ent = self.time_
-000566f0: 7769 6474 685f 7065 7263 656e 742c 200d  width_percent, .
-00056700: 0a09 0909 0909 0909 0973 6361 7474 6572  .........scatter
-00056710: 6375 7420 3d20 7365 6c66 2e73 6361 7474  cut = self.scatt
-00056720: 6572 6375 742c 2062 6f72 6465 7263 7574  ercut, bordercut
-00056730: 203d 2073 656c 662e 626f 7264 6572 6375   = self.bordercu
-00056740: 742c 2077 6176 655f 6e6d 5f62 696e 203d  t, wave_nm_bin =
-00056750: 2073 656c 662e 7761 7665 5f6e 6d5f 6269   self.wave_nm_bi
-00056760: 6e29 0d0a 0909 0909 7375 622e 746f 5f63  n)......sub.to_c
-00056770: 7376 2863 6865 636b 5f66 6f6c 6465 7228  sv(check_folder(
-00056780: 7061 7468 203d 2070 6174 682c 2063 7572  path = path, cur
-00056790: 7265 6e74 5f70 6174 6820 3d20 7365 6c66  rent_path = self
-000567a0: 2e70 6174 682c 200d 0a09 0909 0909 0909  .path, .........
-000567b0: 6669 6c65 6e61 6d65 203d 2066 696c 656e  filename = filen
-000567c0: 616d 652b 275f 6368 6972 705f 636f 7272  ame+'_chirp_corr
-000567d0: 6563 7465 645f 5241 575f 5370 6563 7472  ected_RAW_Spectr
-000567e0: 612e 6461 7427 292c 2073 6570 203d 2073  a.dat'), sep = s
-000567f0: 6570 290d 0a09 0969 6620 7361 7665 5f46  ep)....if save_F
-00056800: 6974 3a0d 0a09 0909 7472 793a 0d0a 0909  it:.....try:....
-00056810: 0909 7365 6c66 2e72 652e 6b65 7973 2829  ..self.re.keys()
-00056820: 0d0a 0909 0965 7863 6570 743a 0d0a 0909  .....except:....
-00056830: 0909 7072 696e 7428 276e 6f20 6669 7420  ..print('no fit 
-00056840: 696e 2064 6174 6127 290d 0a09 0909 0973  in data')......s
-00056850: 6176 655f 4669 7420 3d20 4661 6c73 650d  ave_Fit = False.
-00056860: 0a09 0969 6620 7361 7665 5f46 6974 3a0d  ...if save_Fit:.
-00056870: 0a09 0909 7365 6c66 2e72 655b 2741 275d  ....self.re['A']
-00056880: 2e74 6f5f 6373 7628 6368 6563 6b5f 666f  .to_csv(check_fo
-00056890: 6c64 6572 2870 6174 6820 3d20 7061 7468  lder(path = path
-000568a0: 2c20 6375 7272 656e 745f 7061 7468 203d  , current_path =
-000568b0: 2073 656c 662e 7061 7468 2c20 0d0a 0909   self.path, ....
-000568c0: 0909 0909 0909 6669 6c65 6e61 6d65 203d  ......filename =
-000568d0: 2066 696c 656e 616d 652b 275f 6d61 7472   filename+'_matr
-000568e0: 6978 2075 7365 6420 6173 2066 6974 2069  ix used as fit i
-000568f0: 6e70 7574 2e64 6174 2729 2c20 7365 7020  nput.dat'), sep 
-00056900: 3d20 7365 7029 0d0a 0909 0973 656c 662e  = sep).....self.
-00056910: 7265 5b27 4143 275d 2e74 6f5f 6373 7628  re['AC'].to_csv(
-00056920: 6368 6563 6b5f 666f 6c64 6572 2870 6174  check_folder(pat
-00056930: 6820 3d20 7061 7468 2c20 6375 7272 656e  h = path, curren
-00056940: 745f 7061 7468 203d 2073 656c 662e 7061  t_path = self.pa
-00056950: 7468 2c20 0d0a 0909 0909 0909 0909 6669  th, ..........fi
-00056960: 6c65 6e61 6d65 203d 2066 696c 656e 616d  lename = filenam
-00056970: 652b 275f 6d61 7472 6978 2063 616c 6375  e+'_matrix calcu
-00056980: 6c61 7465 6420 6475 7269 6e67 2066 6974  lated during fit
-00056990: 2e64 6174 2729 2c20 7365 7020 3d20 7365  .dat'), sep = se
-000569a0: 7029 0d0a 0909 0973 656c 662e 7265 5b27  p).....self.re['
-000569b0: 4145 275d 2e74 6f5f 6373 7628 6368 6563  AE'].to_csv(chec
-000569c0: 6b5f 666f 6c64 6572 2870 6174 6820 3d20  k_folder(path = 
-000569d0: 7061 7468 2c20 6375 7272 656e 745f 7061  path, current_pa
-000569e0: 7468 203d 2073 656c 662e 7061 7468 2c20  th = self.path, 
-000569f0: 0d0a 0909 0909 0909 0909 6669 6c65 6e61  ..........filena
-00056a00: 6d65 203d 2066 696c 656e 616d 652b 275f  me = filename+'_
-00056a10: 6572 726f 725f 6d61 7472 6978 2063 616c  error_matrix cal
-00056a20: 6375 6c61 7465 6420 6475 7269 6e67 2066  culated during f
-00056a30: 6974 2e64 6174 2729 2c20 7365 7020 3d20  it.dat'), sep = 
-00056a40: 7365 7029 0d0a 0909 0969 6620 7361 7665  sep).....if save
-00056a50: 5f73 6c69 6365 733a 090d 0a09 0909 0973  _slices:.......s
-00056a60: 7562 203d 2073 7562 5f64 7328 6473 203d  ub = sub_ds(ds =
-00056a70: 2073 656c 662e 7265 5b27 4143 275d 2e63   self.re['AC'].c
-00056a80: 6f70 7928 292c 2077 6176 656c 656e 6774  opy(), wavelengt
-00056a90: 685f 6269 6e20 3d20 7365 6c66 2e77 6176  h_bin = self.wav
-00056aa0: 656c 656e 6774 685f 6269 6e2c 2077 6176  elength_bin, wav
-00056ab0: 656c 656e 6774 6820 3d20 7365 6c66 2e72  elength = self.r
-00056ac0: 656c 5f77 6176 6529 0d0a 0909 0909 2373  el_wave)......#s
-00056ad0: 7562 2e63 6f6c 756d 6e73 2e6e 616d 6520  ub.columns.name 
-00056ae0: 3d20 2777 6176 656c 656e 7468 205b 6e6d  = 'wavelenth [nm
-00056af0: 5d20 696e 2025 2e30 6620 6269 6e73 2725  ] in %.0f bins'%
-00056b00: 7365 6c66 2e77 6176 656c 656e 6774 685f  self.wavelength_
-00056b10: 6269 6e0d 0a09 0909 0973 7562 2e74 6f5f  bin......sub.to_
-00056b20: 6373 7628 6368 6563 6b5f 666f 6c64 6572  csv(check_folder
-00056b30: 2870 6174 6820 3d20 7061 7468 2c20 6375  (path = path, cu
-00056b40: 7272 656e 745f 7061 7468 203d 2073 656c  rrent_path = sel
-00056b50: 662e 7061 7468 2c20 0d0a 0909 0909 0909  f.path, ........
-00056b60: 0966 696c 656e 616d 6520 3d20 6669 6c65  .filename = file
-00056b70: 6e61 6d65 2b27 5f66 6974 7465 645f 6b69  name+'_fitted_ki
-00056b80: 6e65 7469 6373 2e64 6174 2729 2c20 7365  netics.dat'), se
-00056b90: 7020 3d20 7365 7029 0d0a 0909 0909 7375  p = sep)......su
-00056ba0: 6220 3d20 7375 625f 6473 2864 7320 3d20  b = sub_ds(ds = 
-00056bb0: 7365 6c66 2e72 655b 2741 275d 2e63 6f70  self.re['A'].cop
-00056bc0: 7928 292c 2077 6176 656c 656e 6774 685f  y(), wavelength_
-00056bd0: 6269 6e20 3d20 7365 6c66 2e77 6176 656c  bin = self.wavel
-00056be0: 656e 6774 685f 6269 6e2c 2077 6176 656c  ength_bin, wavel
-00056bf0: 656e 6774 6820 3d20 7365 6c66 2e72 656c  ength = self.rel
-00056c00: 5f77 6176 6529 0d0a 0909 0909 2373 7562  _wave)......#sub
-00056c10: 2e63 6f6c 756d 6e73 2e6e 616d 6520 3d20  .columns.name = 
-00056c20: 2777 6176 656c 656e 7468 205b 6e6d 5d20  'wavelenth [nm] 
-00056c30: 696e 2025 2e30 6620 6269 6e73 2725 7365  in %.0f bins'%se
-00056c40: 6c66 2e77 6176 656c 656e 6774 685f 6269  lf.wavelength_bi
-00056c50: 6e0d 0a09 0909 0973 7562 2e74 6f5f 6373  n......sub.to_cs
-00056c60: 7628 6368 6563 6b5f 666f 6c64 6572 2870  v(check_folder(p
-00056c70: 6174 6820 3d20 7061 7468 2c20 6375 7272  ath = path, curr
-00056c80: 656e 745f 7061 7468 203d 2073 656c 662e  ent_path = self.
-00056c90: 7061 7468 2c20 0d0a 0909 0909 0909 0966  path, .........f
-00056ca0: 696c 656e 616d 6520 3d20 6669 6c65 6e61  ilename = filena
-00056cb0: 6d65 2b27 5f6d 6561 7375 7265 645f 6b69  me+'_measured_ki
-00056cc0: 6e65 7469 6373 2e64 6174 2729 2c20 7365  netics.dat'), se
-00056cd0: 7020 3d20 7365 7029 0d0a 0909 0909 7375  p = sep)......su
-00056ce0: 6220 3d20 7375 625f 6473 2864 7320 3d20  b = sub_ds(ds = 
-00056cf0: 7365 6c66 2e72 655b 2741 4327 5d2e 636f  self.re['AC'].co
-00056d00: 7079 2829 2c20 7469 6d65 7320 3d20 7365  py(), times = se
-00056d10: 6c66 2e72 656c 5f74 696d 652c 200d 0a09  lf.rel_time, ...
-00056d20: 0909 0909 0909 7469 6d65 5f77 6964 7468  ......time_width
-00056d30: 5f70 6572 6365 6e74 203d 2073 656c 662e  _percent = self.
-00056d40: 7469 6d65 5f77 6964 7468 5f70 6572 6365  time_width_perce
-00056d50: 6e74 2c20 7363 6174 7465 7263 7574 203d  nt, scattercut =
-00056d60: 2073 656c 662e 7363 6174 7465 7263 7574   self.scattercut
-00056d70: 2c20 0d0a 0909 0909 0909 0962 6f72 6465  , .........borde
-00056d80: 7263 7574 203d 2073 656c 662e 626f 7264  rcut = self.bord
-00056d90: 6572 6375 742c 2077 6176 655f 6e6d 5f62  ercut, wave_nm_b
-00056da0: 696e 203d 2073 656c 662e 7761 7665 5f6e  in = self.wave_n
-00056db0: 6d5f 6269 6e29 0d0a 0909 0909 7375 622e  m_bin)......sub.
-00056dc0: 746f 5f63 7376 2863 6865 636b 5f66 6f6c  to_csv(check_fol
-00056dd0: 6465 7228 7061 7468 203d 2070 6174 682c  der(path = path,
-00056de0: 2063 7572 7265 6e74 5f70 6174 6820 3d20   current_path = 
-00056df0: 7365 6c66 2e70 6174 682c 200d 0a09 0909  self.path, .....
-00056e00: 0909 0909 6669 6c65 6e61 6d65 203d 2066  ....filename = f
-00056e10: 696c 656e 616d 652b 275f 6669 7474 6564  ilename+'_fitted
-00056e20: 5f73 7065 6374 7261 2e64 6174 2729 2c20  _spectra.dat'), 
-00056e30: 7365 7020 3d20 7365 7029 0d0a 0909 0909  sep = sep)......
-00056e40: 7375 6220 3d20 7375 625f 6473 2864 7320  sub = sub_ds(ds 
-00056e50: 3d20 7365 6c66 2e72 655b 2741 275d 2e63  = self.re['A'].c
-00056e60: 6f70 7928 292c 2074 696d 6573 203d 2073  opy(), times = s
-00056e70: 656c 662e 7265 6c5f 7469 6d65 2c20 0d0a  elf.rel_time, ..
-00056e80: 0909 0909 0909 0974 696d 655f 7769 6474  .......time_widt
-00056e90: 685f 7065 7263 656e 7420 3d20 7365 6c66  h_percent = self
-00056ea0: 2e74 696d 655f 7769 6474 685f 7065 7263  .time_width_perc
-00056eb0: 656e 742c 2073 6361 7474 6572 6375 7420  ent, scattercut 
-00056ec0: 3d20 7365 6c66 2e73 6361 7474 6572 6375  = self.scattercu
-00056ed0: 742c 200d 0a09 0909 0909 0909 626f 7264  t, .........bord
-00056ee0: 6572 6375 7420 3d20 7365 6c66 2e62 6f72  ercut = self.bor
-00056ef0: 6465 7263 7574 2c20 7761 7665 5f6e 6d5f  dercut, wave_nm_
-00056f00: 6269 6e20 3d20 7365 6c66 2e77 6176 655f  bin = self.wave_
-00056f10: 6e6d 5f62 696e 290d 0a09 0909 0973 7562  nm_bin)......sub
-00056f20: 2e74 6f5f 6373 7628 6368 6563 6b5f 666f  .to_csv(check_fo
-00056f30: 6c64 6572 2870 6174 6820 3d20 7061 7468  lder(path = path
-00056f40: 2c20 6375 7272 656e 745f 7061 7468 203d  , current_path =
-00056f50: 2073 656c 662e 7061 7468 2c20 0d0a 0909   self.path, ....
-00056f60: 0909 0909 0966 696c 656e 616d 6520 3d20  .....filename = 
-00056f70: 6669 6c65 6e61 6d65 2b27 5f6d 6561 7375  filename+'_measu
-00056f80: 7265 645f 7370 6563 7472 612e 6461 7427  red_spectra.dat'
-00056f90: 292c 2073 6570 203d 2073 6570 290d 0a09  ), sep = sep)...
-00056fa0: 0909 0973 656c 662e 7265 5b27 4441 4327  ...self.re['DAC'
-00056fb0: 5d2e 746f 5f63 7376 2863 6865 636b 5f66  ].to_csv(check_f
-00056fc0: 6f6c 6465 7228 7061 7468 203d 2070 6174  older(path = pat
-00056fd0: 682c 2063 7572 7265 6e74 5f70 6174 6820  h, current_path 
-00056fe0: 3d20 7365 6c66 2e70 6174 682c 200d 0a09  = self.path, ...
-00056ff0: 0909 0909 0909 6669 6c65 6e61 6d65 203d  ......filename =
-00057000: 2066 696c 656e 616d 652b 275f 4441 532d   filename+'_DAS-
-00057010: 5341 532e 6461 7427 292c 2073 6570 203d  SAS.dat'), sep =
-00057020: 2073 6570 290d 0a09 090d 0a09 0909 6966   sep).........if
-00057030: 2073 6176 655f 6669 745f 7265 7375 6c74   save_fit_result
-00057040: 733a 0d0a 0909 0909 0d0a 0909 0909 5265  s:............Re
-00057050: 7375 6c74 5f73 7472 696e 673d 275c 6e46  sult_string='\nF
-00057060: 6974 2052 6573 756c 7473 3a5c 6e27 0d0a  it Results:\n'..
-00057070: 0909 0909 0d0a 0909 0909 6966 2069 7369  ..........if isi
-00057080: 6e73 7461 6e63 6528 7365 6c66 2e6d 6f64  nstance(self.mod
-00057090: 2c74 7970 6528 2768 656c 6c6f 2729 293a  ,type('hello')):
-000570a0: 0d0a 0909 0909 0952 6573 756c 745f 7374  .......Result_st
-000570b0: 7269 6e67 2b3d 274d 6f64 656c 2055 7365  ring+='Model Use
-000570c0: 643a 2025 735c 6e5c 6e27 2573 656c 662e  d: %s\n\n'%self.
-000570d0: 6d6f 640d 0a09 0909 0965 6c73 653a 0d0a  mod......else:..
-000570e0: 0909 0909 0952 6573 756c 745f 7374 7269  .....Result_stri
-000570f0: 6e67 2b3d 274d 6f64 656c 2055 7365 643a  ng+='Model Used:
-00057100: 2045 7874 6572 6e61 6c20 6675 6e63 7469   External functi
-00057110: 6f6e 5c6e 5c6e 270d 0a09 0909 090d 0a09  on\n\n'.........
-00057120: 0909 0969 6620 7365 6c66 2e69 676e 6f72  ...if self.ignor
-00057130: 655f 7469 6d65 5f72 6567 696f 6e20 6973  e_time_region is
-00057140: 206e 6f74 204e 6f6e 653a 0d0a 0909 0909   not None:......
-00057150: 0952 6573 756c 745f 7374 7269 6e67 2b3d  .Result_string+=
-00057160: 2774 6865 2074 696d 6520 6265 7477 6565  'the time betwee
-00057170: 6e20 252e 3366 2025 7320 616e 6420 252e  n %.3f %s and %.
-00057180: 3366 2025 7320 7761 7320 6578 636c 7564  3f %s was exclud
-00057190: 6564 2066 726f 6d20 7468 6520 6f70 7469  ed from the opti
-000571a0: 6d69 7a61 7469 6f6e 5c6e 2725 2873 656c  mization\n'%(sel
-000571b0: 662e 6967 6e6f 7265 5f74 696d 655f 7265  f.ignore_time_re
-000571c0: 6769 6f6e 5b30 5d2c 7365 6c66 2e62 6173  gion[0],self.bas
-000571d0: 6575 6e69 742c 7365 6c66 2e69 676e 6f72  eunit,self.ignor
-000571e0: 655f 7469 6d65 5f72 6567 696f 6e5b 315d  e_time_region[1]
-000571f0: 2c73 656c 662e 6261 7365 756e 6974 2909  ,self.baseunit).
-00057200: 0d0a 0909 0909 5265 7375 6c74 5f73 7472  ......Result_str
-00057210: 696e 672b 3d27 5468 6520 6d69 6e69 6d75  ing+='The minimu
-00057220: 6d20 6572 726f 7220 6973 3a7b 3a2e 3865  m error is:{:.8e
-00057230: 7d5c 6e27 2e66 6f72 6d61 7428 7365 6c66  }\n'.format(self
-00057240: 2e72 655b 2765 7272 6f72 275d 290d 0a09  .re['error'])...
-00057250: 0909 0952 6573 756c 745f 7374 7269 6e67  ...Result_string
-00057260: 2b3d 2754 6865 206d 696e 696d 756d 2052  +='The minimum R
-00057270: 322d 7661 6c75 6520 6973 3a7b 3a2e 3865  2-value is:{:.8e
-00057280: 7d5c 6e27 2e66 6f72 6d61 7428 7365 6c66  }\n'.format(self
-00057290: 2e72 655b 2772 3227 5d29 0d0a 0909 0909  .re['r2'])......
-000572a0: 0d0a 0909 0909 6966 2027 636f 6e66 6964  ......if 'confid
-000572b0: 656e 6365 2720 696e 2073 656c 662e 7265  ence' in self.re
-000572c0: 3a0d 0a09 0909 0909 5265 7375 6c74 5f73  :.......Result_s
-000572d0: 7472 696e 672b 3d27 5c6e 496e 2052 6174  tring+='\nIn Rat
-000572e0: 6573 2077 6974 6820 636f 6e66 6964 656e  es with confiden
-000572f0: 6365 2069 6e74 6572 7661 6c20 746f 206c  ce interval to l
-00057300: 6576 656c 206f 6620 2573 5c6e 2725 7365  evel of %s\n'%se
-00057310: 6c66 2e72 655b 2763 6f6e 6669 6465 6e63  lf.re['confidenc
-00057320: 6527 5d5b 2774 6172 6765 742d 6c65 7665  e']['target-leve
-00057330: 6c27 5d0d 0a09 0909 0909 5265 7375 6c74  l'].......Result
-00057340: 5f73 7472 696e 672b 3d73 656c 662e 7265  _string+=self.re
-00057350: 5b27 6669 745f 7265 7375 6c74 735f 7261  ['fit_results_ra
-00057360: 7465 7327 5d2e 746f 5f73 7472 696e 6728  tes'].to_string(
-00057370: 636f 6c75 6d6e 733d 5b27 7661 6c75 6527  columns=['value'
-00057380: 2c27 6c6f 7765 725f 6c69 6d69 7427 2c27  ,'lower_limit','
-00057390: 7570 7065 725f 6c69 6d69 7427 2c27 696e  upper_limit','in
-000573a0: 6974 5f76 616c 7565 272c 2776 6172 7927  it_value','vary'
-000573b0: 2c27 6d69 6e27 2c27 6d61 7827 2c27 6578  ,'min','max','ex
-000573c0: 7072 275d 290d 0a09 0909 0909 5265 7375  pr']).......Resu
-000573d0: 6c74 5f73 7472 696e 672b 3d27 5c6e 5c6e  lt_string+='\n\n
-000573e0: 5468 6520 7261 7465 7320 636f 6e76 6572  The rates conver
-000573f0: 7465 6420 746f 2074 696d 6573 2077 6974  ted to times wit
-00057400: 6820 756e 6974 2025 7320 7769 7468 2063  h unit %s with c
-00057410: 6f6e 6669 6465 6e63 6520 696e 7465 7276  onfidence interv
-00057420: 616c 2074 6f20 6c65 7665 6c20 6f66 2025  al to level of %
-00057430: 735c 6e27 2528 7365 6c66 2e62 6173 6575  s\n'%(self.baseu
-00057440: 6e69 742c 7365 6c66 2e72 655b 2763 6f6e  nit,self.re['con
-00057450: 6669 6465 6e63 6527 5d5b 2774 6172 6765  fidence']['targe
-00057460: 742d 6c65 7665 6c27 5d29 0d0a 0909 0909  t-level'])......
-00057470: 0952 6573 756c 745f 7374 7269 6e67 2b3d  .Result_string+=
-00057480: 7365 6c66 2e72 655b 2766 6974 5f72 6573  self.re['fit_res
-00057490: 756c 7473 5f74 696d 6573 275d 2e74 6f5f  ults_times'].to_
-000574a0: 7374 7269 6e67 2863 6f6c 756d 6e73 3d5b  string(columns=[
-000574b0: 2776 616c 7565 272c 276c 6f77 6572 5f6c  'value','lower_l
-000574c0: 696d 6974 272c 2775 7070 6572 5f6c 696d  imit','upper_lim
-000574d0: 6974 272c 2769 6e69 745f 7661 6c75 6527  it','init_value'
-000574e0: 2c27 7661 7279 272c 276d 696e 272c 276d  ,'vary','min','m
-000574f0: 6178 272c 2765 7870 7227 5d29 0d0a 0909  ax','expr'])....
-00057500: 0909 656c 7365 3a0d 0a09 0909 0909 5265  ..else:.......Re
-00057510: 7375 6c74 5f73 7472 696e 672b 3d27 5c6e  sult_string+='\n
-00057520: 496e 2052 6174 6573 5c6e 270d 0a09 0909  In Rates\n'.....
-00057530: 0909 5265 7375 6c74 5f73 7472 696e 672b  ..Result_string+
-00057540: 3d73 656c 662e 7265 5b27 6669 745f 7265  =self.re['fit_re
-00057550: 7375 6c74 735f 7261 7465 7327 5d2e 746f  sults_rates'].to
-00057560: 5f73 7472 696e 6728 636f 6c75 6d6e 733d  _string(columns=
-00057570: 5b27 7661 6c75 6527 2c27 696e 6974 5f76  ['value','init_v
-00057580: 616c 7565 272c 2776 6172 7927 2c27 6d69  alue','vary','mi
-00057590: 6e27 2c27 6d61 7827 2c27 6578 7072 275d  n','max','expr']
-000575a0: 290d 0a09 0909 0909 5265 7375 6c74 5f73  ).......Result_s
-000575b0: 7472 696e 672b 3d27 5c6e 5c6e 5468 6520  tring+='\n\nThe 
-000575c0: 7261 7465 7320 636f 6e76 6572 7465 6420  rates converted 
-000575d0: 746f 2074 696d 6573 2077 6974 6820 756e  to times with un
-000575e0: 6974 2025 735c 6e27 2573 656c 662e 6261  it %s\n'%self.ba
-000575f0: 7365 756e 6974 0d0a 0909 0909 0952 6573  seunit.......Res
-00057600: 756c 745f 7374 7269 6e67 2b3d 7365 6c66  ult_string+=self
-00057610: 2e72 655b 2766 6974 5f72 6573 756c 7473  .re['fit_results
-00057620: 5f74 696d 6573 275d 2e74 6f5f 7374 7269  _times'].to_stri
-00057630: 6e67 2863 6f6c 756d 6e73 3d5b 2776 616c  ng(columns=['val
-00057640: 7565 272c 2769 6e69 745f 7661 6c75 6527  ue','init_value'
-00057650: 2c27 7661 7279 272c 276d 696e 272c 276d  ,'vary','min','m
-00057660: 6178 272c 2765 7870 7227 5d29 0d0a 0d0a  ax','expr'])....
-00057670: 0909 0909 7769 7468 206f 7065 6e28 6368  ....with open(ch
-00057680: 6563 6b5f 666f 6c64 6572 2870 6174 6820  eck_folder(path 
-00057690: 3d20 7061 7468 2c20 6375 7272 656e 745f  = path, current_
-000576a0: 7061 7468 203d 2073 656c 662e 7061 7468  path = self.path
-000576b0: 2c20 6669 6c65 6e61 6d65 203d 2066 696c  , filename = fil
-000576c0: 656e 616d 652b 275f 6669 745f 7265 7375  ename+'_fit_resu
-000576d0: 6c74 735f 7061 7261 6d65 7465 722e 7061  lts_parameter.pa
-000576e0: 7227 292c 2022 7722 2920 6173 2074 6578  r'), "w") as tex
-000576f0: 745f 6669 6c65 3a0d 0a09 0909 0909 7465  t_file:.......te
-00057700: 7874 5f66 696c 652e 7772 6974 6528 5265  xt_file.write(Re
-00057710: 7375 6c74 5f73 7472 696e 6729 0d0a 0d0a  sult_string)....
-00057720: 0964 6566 2053 6176 655f 506f 7765 7270  .def Save_Powerp
-00057730: 6f69 6e74 2873 656c 662c 2073 6176 655f  oint(self, save_
-00057740: 5241 5720 3d20 5472 7565 2c20 7361 7665  RAW = True, save
-00057750: 5f46 6974 203d 2054 7275 652c 2066 696c  _Fit = True, fil
-00057760: 656e 616d 6520 3d20 4e6f 6e65 2c20 0d0a  ename = None, ..
-00057770: 0909 0909 0909 7061 7468 203d 2027 7265  ......path = 're
-00057780: 7375 6c74 5f66 6967 7572 6573 272c 2073  sult_figures', s
-00057790: 6361 6c65 5f74 7970 6520 3d20 2773 796d  cale_type = 'sym
-000577a0: 6c6f 6727 2c20 7469 746c 6520 3d20 4e6f  log', title = No
-000577b0: 6e65 2c20 7061 7463 6865 7320 3d20 4661  ne, patches = Fa
-000577c0: 6c73 652c 2063 6d61 703d 4e6f 6e65 202c  lse, cmap=None ,
-000577d0: 2073 6176 6574 7970 6520 3d20 2770 7074   savetype = 'ppt
-000577e0: 7827 293a 0d0a 0909 2727 2754 6869 7320  x'):....'''This 
-000577f0: 6675 6e63 7469 6f6e 2063 7265 6174 6573  function creates
-00057800: 2074 776f 2070 6f77 6572 2070 6f69 6e74   two power point
-00057810: 2073 6c69 6465 732e 204f 6e20 7468 6520   slides. On the 
-00057820: 6669 7273 7420 6974 2073 756d 6d61 7269  first it summari
-00057830: 7a65 7320 7468 6520 5241 5720 706c 6f74  zes the RAW plot
-00057840: 7320 616e 6420 6f6e 200d 0a09 0974 6865  s and on ....the
-00057850: 2073 6563 6f6e 6420 2869 6620 6578 6973   second (if exis
-00057860: 7465 6e74 2920 6974 2073 756d 6d61 7269  tent) it summari
-00057870: 7a65 7320 7468 6520 6669 7474 6564 2072  zes the fitted r
-00057880: 6573 756c 7473 0d0a 0909 0d0a 0909 5061  esults........Pa
-00057890: 7261 6d65 7465 7273 0d0a 0909 2d2d 2d2d  rameters....----
-000578a0: 2d2d 2d2d 2d2d 0d0a 0909 0d0a 0909 7361  ------........sa
-000578b0: 7665 5f52 4157 203a 2062 6f6f 6c2c 206f  ve_RAW : bool, o
-000578c0: 7074 696f 6e61 6c0d 0a09 0909 2844 6566  ptional.....(Def
-000578d0: 6175 6c74 2920 5472 7565 2074 6865 6e20  ault) True then 
-000578e0: 7468 6520 6669 7273 7420 736c 6964 6520  the first slide 
-000578f0: 7769 7468 2074 6865 2052 4157 2064 6174  with the RAW dat
-00057900: 6120 6973 2063 7265 6174 6564 200d 0a09  a is created ...
-00057910: 090d 0a09 0973 6176 655f 4669 7420 3a20  .....save_Fit : 
-00057920: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0d0a  bool, optional..
-00057930: 0909 0928 4465 6661 756c 7429 2054 7275  ...(Default) Tru
-00057940: 6520 7468 656e 2074 6865 2073 6563 6f6e  e then the secon
-00057950: 6420 736c 6964 6520 7769 7468 2074 6865  d slide with the
-00057960: 2046 6974 7465 6420 6461 7461 2069 7320   Fitted data is 
-00057970: 6372 6561 7465 6420 0d0a 0909 0d0a 0909  created ........
-00057980: 7061 7468 203a 204e 6f6e 652c 2073 7472  path : None, str
-00057990: 206f 7220 7061 7468 2c20 6f70 7469 6f6e   or path, option
-000579a0: 616c 0d0a 0909 0928 4465 6661 756c 7429  al.....(Default)
-000579b0: 204e 6f6e 652c 2069 6620 6c65 6674 206f   None, if left o
-000579c0: 6e20 4e6f 6e65 2c20 7468 656e 2061 2066  n None, then a f
-000579d0: 6f6c 6465 7220 2272 6573 756c 745f 6669  older "result_fi
-000579e0: 6775 7265 7322 2069 7320 6372 6561 7465  gures" is create
-000579f0: 6420 696e 2074 6865 2066 6f6c 6465 7220  d in the folder 
-00057a00: 0d0a 0909 096f 6620 7468 6520 6461 7461  .....of the data
-00057a10: 2028 7365 6c66 2e70 6174 6829 0d0a 0909   (self.path)....
-00057a20: 0d0a 0909 7361 7665 7479 7065 203a 2073  ....savetype : s
-00057a30: 7472 206f 7220 6974 6572 6162 6c65 2028  tr or iterable (
-00057a40: 6f66 2073 7472 292c 206f 7074 696f 6e61  of str), optiona
-00057a50: 6c20 0d0a 0909 0974 7269 6767 6572 7320  l .....triggers 
-00057a60: 7468 6520 6164 6469 7469 6f6e 616c 2063  the additional c
-00057a70: 7265 6174 696f 6e20 6f66 2061 2063 6f6d  reation of a com
-00057a80: 706f 7369 7465 2066 696c 6520 696e 2074  posite file in t
-00057a90: 6869 7320 666f 726d 6174 2e0d 0a09 0909  his format......
-00057aa0: 6d61 7470 6c6f 746c 6962 2061 6c6c 6f77  matplotlib allow
-00057ab0: 7320 7468 6520 7361 7669 6e67 206f 6620  s the saving of 
-00057ac0: 6669 6775 7265 7320 696e 2076 6172 696f  figures in vario
-00057ad0: 7573 2066 6f72 6d61 7473 2e20 2844 6566  us formats. (Def
-00057ae0: 6175 6c74 2920 2270 6e67 222c 200d 0a09  ault) "png", ...
-00057af0: 0909 7479 7069 6361 6c20 616e 6420 7265  ..typical and re
-00057b00: 636f 6d6d 656e 6461 626c 6520 6f70 7469  commendable opti
-00057b10: 6f6e 7320 6172 6520 2273 7667 2220 616e  ons are "svg" an
-00057b20: 6420 2270 6466 222e 2020 0d0a 0909 090d  d "pdf".  ......
-00057b30: 0a09 0974 6974 6c65 203a 204e 6f6e 6520  ...title : None 
-00057b40: 6f72 2073 7472 2c20 6f70 7469 6f6e 616c  or str, optional
-00057b50: 0d0a 0909 0928 4465 6661 756c 7429 204e  .....(Default) N
-00057b60: 6f6e 652c 2055 7365 2074 6869 7320 7469  one, Use this ti
-00057b70: 746c 6520 6f6e 2061 6c6c 2070 6c6f 7473  tle on all plots
-00057b80: 2e20 6966 204e 6f6e 652c 2075 7365 2073  . if None, use s
-00057b90: 656c 662e 6669 6c65 6e61 6d65 0d0a 0909  elf.filename....
-00057ba0: 090d 0a09 0966 696c 656e 616d 6520 3a20  .....filename : 
-00057bb0: 7374 722c 206f 7074 696f 6e61 6c0d 0a09  str, optional...
-00057bc0: 0909 2844 6566 6175 6c74 2920 4e6f 6e65  ..(Default) None
-00057bd0: 2c20 4261 7365 206e 616d 6520 666f 7220  , Base name for 
-00057be0: 616c 6c20 706c 6f74 732e 2049 6620 4e6f  all plots. If No
-00057bf0: 6e65 2c20 7468 656e 2073 656c 662e 6669  ne, then self.fi
-00057c00: 6c65 6e61 6d65 2077 696c 6c20 6265 2075  lename will be u
-00057c10: 7365 640d 0a09 0909 0d0a 0909 7363 616c  sed.........scal
-00057c20: 655f 7479 7065 203a 2073 7472 2c20 6f70  e_type : str, op
-00057c30: 7469 6f6e 616c 0d0a 0909 0927 7379 6d6c  tional.....'syml
-00057c40: 6f67 2720 2844 6566 6175 6c74 292c 2027  og' (Default), '
-00057c50: 6c69 6e65 6172 272c 2027 6c6f 6727 2074  linear', 'log' t
-00057c60: 696d 6520 6178 6973 0d0a 0909 090d 0a09  ime axis........
-00057c70: 0970 6174 6368 6573 203a 2062 6f6f 6c2c  .patches : bool,
-00057c80: 206f 7074 696f 6e61 6c0d 0a09 0909 466f   optional.....Fo
-00057c90: 7220 7472 7565 2075 7365 2077 6869 7465  r true use white
-00057ca0: 2070 6174 6368 6573 2074 6f20 6c61 6265   patches to labe
-00057cb0: 6c20 7468 696e 6773 2069 6e20 7468 6520  l things in the 
-00057cc0: 3264 206d 6174 7269 7865 732c 2074 6f20  2d matrixes, to 
-00057cd0: 7361 6665 0d0a 0909 0973 7061 6365 2066  safe.....space f
-00057ce0: 6f72 2070 7562 6c69 6361 7469 6f6e 0d0a  or publication..
-00057cf0: 0909 090d 0a09 0963 6d61 7020 3a20 4e6f  .......cmap : No
-00057d00: 6e65 206f 7220 6d61 7470 6c6f 746c 6962  ne or matplotlib
-00057d10: 2063 6f6c 6f72 206d 6170 2c20 6f70 7469   color map, opti
-00057d20: 6f6e 616c 0d0a 0909 0969 7320 6120 706f  onal.....is a po
-00057d30: 7765 7266 756c 6c20 7661 7269 6162 6c65  werfull variable
-00057d40: 2074 6861 7420 6368 6f6f 7365 7320 7468   that chooses th
-00057d50: 6520 636f 6c6f 7572 206d 6170 2061 7070  e colour map app
-00057d60: 6c69 6564 2066 6f72 2061 6c6c 2070 6c6f  lied for all plo
-00057d70: 7473 2e20 4966 2073 6574 2074 6f20 0d0a  ts. If set to ..
-00057d80: 0909 094e 6f6e 6520 2844 6566 6175 6c74  ...None (Default
-00057d90: 2920 7468 656e 2074 6865 2073 656c 662e  ) then the self.
-00057da0: 636d 6170 2069 7320 7573 6564 2e0d 0a09  cmap is used....
-00057db0: 0909 4173 2073 7461 6e64 6172 6420 4920  ..As standard I 
-00057dc0: 7573 6520 7468 6520 636f 6c6f 7220 6d61  use the color ma
-00057dd0: 7020 226a 6574 2220 6672 6f6d 206d 6174  p "jet" from mat
-00057de0: 706c 6f74 6c69 622e 2054 6865 7265 2061  plotlib. There a
-00057df0: 7265 2061 2076 6172 6965 7479 206f 6620  re a variety of 
-00057e00: 636f 6c6f 726d 6170 7320 0d0a 0909 0961  colormaps .....a
-00057e10: 7661 696c 6162 6c65 2074 6861 7420 6172  vailable that ar
-00057e20: 6520 7665 7279 2075 7365 6675 6c6c 2e20  e very usefull. 
-00057e30: 4265 7369 6465 2022 6a65 7422 2c20 2276  Beside "jet", "v
-00057e40: 6972 6964 6973 2220 6973 2061 2067 6f6f  iridis" is a goo
-00057e50: 6420 6368 6f69 6365 2061 7320 6974 2069  d choice as it i
-00057e60: 7320 7765 6c6c 200d 0a09 0909 7669 7369  s well .....visi
-00057e70: 626c 6520 756e 6465 7220 7265 642d 6772  ble under red-gr
-00057e80: 6565 6e20 626c 696e 646e 6573 732e 204f  een blindness. O
-00057e90: 7468 6572 2075 7365 6675 6c20 6d61 7073  ther useful maps
-00057ea0: 2061 7265 2022 7072 6973 6d22 2066 6f72   are "prism" for
-00057eb0: 2068 6967 6820 666c 7563 7475 6174 696f   high fluctuatio
-00057ec0: 6e73 200d 0a09 0909 6f72 2064 6976 6572  ns .....or diver
-00057ed0: 6769 6e67 2063 6f6c 6f72 206d 6170 7320  ging color maps 
-00057ee0: 6c69 6b65 2022 7365 6973 6d69 6322 2e20  like "seismic". 
-00057ef0: 0d0a 0909 0953 6565 2068 7474 7073 3a2f  .....See https:/
-00057f00: 2f6d 6174 706c 6f74 6c69 622e 6f72 672f  /matplotlib.org/
-00057f10: 332e 312e 302f 7475 746f 7269 616c 732f  3.1.0/tutorials/
-00057f20: 636f 6c6f 7273 2f63 6f6c 6f72 6d61 7073  colors/colormaps
-00057f30: 2e68 746d 6c20 666f 7220 6120 636f 6d70  .html for a comp
-00057f40: 7265 6865 6e73 6976 6520 0d0a 0909 0973  rehensive .....s
-00057f50: 656c 6563 7469 6f6e 2e20 496e 2074 6865  election. In the
-00057f60: 2063 6f64 6520 7468 6520 636f 6c6f 726d   code the colorm
-00057f70: 6170 7320 6172 6520 696d 706f 7274 6564  aps are imported
-00057f80: 2073 6f20 6966 2070 6c6f 745f 6675 6e63   so if plot_func
-00057f90: 2069 7320 696d 706f 7274 6564 2061 7320   is imported as 
-00057fa0: 7066 2074 6865 6e20 0d0a 0909 0973 656c  pf then .....sel
-00057fb0: 662e 636d 6170 3d70 662e 636d 2e76 6972  f.cmap=pf.cm.vir
-00057fc0: 6964 6973 2073 6574 7320 7669 7269 6469  idis sets viridi
-00057fd0: 7320 6173 2074 6865 206d 6170 2074 6f20  s as the map to 
-00057fe0: 7573 652e 2049 6e74 6572 6e61 6c6c 7920  use. Internally 
-00057ff0: 7468 6520 636f 6c6f 7273 2061 7265 2063  the colors are c
-00058000: 686f 7365 6e20 0d0a 0909 0977 6974 6820  hosen .....with 
-00058010: 7468 6520 2263 6f6c 6d22 2066 756e 6374  the "colm" funct
-00058020: 696f 6e2e 2054 6865 2032 6420 706c 6f74  ion. The 2d plot
-00058030: 7320 7265 7175 6972 6520 6120 636f 6e74  s require a cont
-00058040: 696e 756f 7573 2063 6f6c 6f72 206d 6170  inuous color map
-00058050: 2073 6f20 6966 2073 6f6d 6574 6869 6e67   so if something
-00058060: 200d 0a09 0909 656c 7365 2069 7320 6769   .....else is gi
-00058070: 7665 2032 6420 706c 6f74 7320 6172 6520  ve 2d plots are 
-00058080: 7368 6f77 6e20 6175 746f 6d61 7469 6361  shown automatica
-00058090: 6c6c 7920 7769 7468 2022 6a65 7422 2e20  lly with "jet". 
-000580a0: 466f 7220 616c 6c20 6f66 2074 6865 2031  For all of the 1
-000580b0: 6420 706c 6f74 7320 686f 7765 7665 7220  d plots however 
-000580c0: 0d0a 0909 0949 2066 6972 7374 2073 656c  .....I first sel
-000580d0: 6563 7420 6120 6e75 6d62 6572 206f 6620  ect a number of 
-000580e0: 636f 6c6f 7273 2062 6566 6f72 6520 6561  colors before ea
-000580f0: 6368 2070 6c6f 742e 2049 6620 636d 6170  ch plot. If cmap
-00058100: 2069 7320 6120 636f 6e74 696e 6f75 7320   is a continous 
-00058110: 6d61 7020 7468 656e 2074 6865 7365 0d0a  map then these..
-00058120: 0909 0961 7265 2073 616d 706c 6564 2065  ...are sampled e
-00058130: 7665 6e6c 7920 6f76 6572 2074 6865 2063  venly over the c
-00058140: 6f6c 6f75 726d 6170 2e20 4d61 6e75 616c  olourmap. Manual
-00058150: 2069 7465 7261 626c 6573 206f 6620 636f   iterables of co
-00058160: 6c6f 7572 7320 0d0a 0909 0963 6d61 703d  lours .....cmap=
-00058170: 5b28 312c 302c 3029 2c28 302c 312c 3029  [(1,0,0),(0,1,0)
-00058180: 2c28 302c 302c 3129 2c2e 2e2e 5d20 6172  ,(0,0,1),...] ar
-00058190: 6520 616c 736f 2061 6363 6570 7465 642c  e also accepted,
-000581a0: 2061 7320 6172 6520 7665 6374 6f72 7320   as are vectors 
-000581b0: 6f72 2064 6174 6166 7261 6d65 7320 7468  or dataframes th
-000581c0: 6174 200d 0a09 0909 636f 6e74 6169 6e20  at .....contain 
-000581d0: 6173 2072 6f77 7320 7468 6520 636f 6c6f  as rows the colo
-000581e0: 7273 2e20 5468 6572 6520 6d75 7374 2062  rs. There must b
-000581f0: 6520 6f66 2063 6f75 7273 6520 7375 6666  e of course suff
-00058200: 6963 6965 6e74 2063 6f6c 6f72 7320 7072  icient colors pr
-00058210: 6573 656e 7420 666f 7220 0d0a 0909 0974  esent for .....t
-00058220: 6865 206e 756d 6265 7273 206f 6620 6c69  he numbers of li
-00058230: 6e65 7320 7468 6174 2077 696c 6c20 6265  nes that will be
-00058240: 2070 6c6f 7474 6564 2e20 536f 2049 2072   plotted. So I r
-00058250: 6563 6f6d 6d65 6e64 2074 6f20 7072 6f76  ecommend to prov
-00058260: 6964 6520 6174 206c 6561 7374 2031 3020  ide at least 10 
-00058270: 636f 6c6f 7572 7320 0d0a 0909 0928 652e  colours .....(e.
-00058280: 672e 7e79 6f75 7220 756e 6976 6572 7369  g.~your universi
-00058290: 7479 2063 6f6c 6f72 7329 2e20 636f 6c6f  ty colors). colo
-000582a0: 7572 7320 6172 6520 616c 7761 7973 2067  urs are always g
-000582b0: 6976 656e 2061 7320 612c 206c 6973 7420  iven as a, list 
-000582c0: 6f72 2074 7570 6c65 2077 6974 6820 5247  or tuple with RG
-000582d0: 4120 6f72 2052 4742 410d 0a09 0909 2877  A or RGBA.....(w
-000582e0: 6974 6820 7468 6520 6c61 7374 2041 2062  ith the last A b
-000582f0: 6565 696e 6720 7468 6520 416c 7068 613d  eeing the Alpha=
-00058300: 7472 616e 7370 6172 656e 6379 2e20 416c  transparency. Al
-00058310: 6c20 6e75 6d62 6572 7320 6172 6520 6265  l numbers are be
-00058320: 7477 6565 6e20 3020 616e 6420 312e 200d  tween 0 and 1. .
-00058330: 0a09 0909 4966 2061 206c 6973 742f 7665  ....If a list/ve
-00058340: 6374 6f72 2f44 6174 6146 7261 6d65 2069  ctor/DataFrame i
-00058350: 7320 6769 7665 6e20 666f 7220 7468 6520  s given for the 
-00058360: 636f 6c6f 7572 7320 7468 6579 2077 696c  colours they wil
-00058370: 6c20 6265 2075 7365 6420 696e 2074 6865  l be used in the
-00058380: 206f 7264 6572 2070 726f 7669 6465 642e   order provided.
-00058390: 0d0a 0909 0d0a 0909 4578 616d 706c 6573  ........Examples
-000583a0: 0d0a 0909 2d2d 2d2d 2d2d 2d2d 2d0d 0a09  ....---------...
-000583b0: 090d 0a09 093e 3e3e 2074 612e 5361 7665  .....>>> ta.Save
-000583c0: 5f50 6f77 6572 706f 696e 7428 290d 0a09  _Powerpoint()...
-000583d0: 093e 3e3e 2074 612e 5361 7665 5f50 6f77  .>>> ta.Save_Pow
-000583e0: 6572 706f 696e 7428 7061 7463 6865 7320  erpoint(patches 
-000583f0: 3d20 5472 7565 290d 0a09 090d 0a09 0927  = True)........'
-00058400: 2727 0909 0909 0909 200d 0a09 0969 6620  ''...... ....if 
-00058410: 6973 696e 7374 616e 6365 2873 6176 6574  isinstance(savet
-00058420: 7970 652c 7479 7065 2827 6865 6c6c 6f27  ype,type('hello'
-00058430: 2929 3a73 6176 6574 7970 653d 5b73 6176  )):savetype=[sav
-00058440: 6574 7970 655d 0d0a 0909 6966 206e 6f74  etype]....if not
-00058450: 2068 6173 6174 7472 2873 6176 6574 7970   hasattr(savetyp
-00058460: 652c 225f 5f69 7465 725f 5f22 293a 7361  e,"__iter__"):sa
-00058470: 7665 7479 7065 3d5b 7361 7665 7479 7065  vetype=[savetype
-00058480: 5d0d 0a09 0972 6177 5f6e 616d 6573 3d5b  ]....raw_names=[
-00058490: 224d 4154 222c 2253 454c 222c 2253 5045  "MAT","SEL","SPE
-000584a0: 4b22 2c22 5356 4422 5d0d 0a09 0972 6177  K","SVD"]....raw
-000584b0: 5f6e 616d 6573 3d5b 6368 6563 6b5f 666f  _names=[check_fo
-000584c0: 6c64 6572 2863 7572 7265 6e74 5f70 6174  lder(current_pat
-000584d0: 683d 7365 6c66 2e70 6174 682c 2070 6174  h=self.path, pat
-000584e0: 683d 7061 7468 2c20 6669 6c65 6e61 6d65  h=path, filename
-000584f0: 3d73 656c 662e 6669 6c65 6e61 6d65 2e73  =self.filename.s
-00058500: 706c 6974 2827 2e27 295b 305d 202b 2022  plit('.')[0] + "
-00058510: 5f52 4157 5f22 2b73 7472 2861 2920 2b22  _RAW_"+str(a) +"
-00058520: 2e70 6e67 2229 2066 6f72 2061 2069 6e20  .png") for a in 
-00058530: 7261 775f 6e61 6d65 735d 0d0a 0909 6669  raw_names]....fi
-00058540: 745f 6e61 6d65 733d 5b22 4649 475f 4d41  t_names=["FIG_MA
-00058550: 5422 2c22 5350 4543 222c 2253 454c 222c  T","SPEC","SEL",
-00058560: 2253 554d 222c 2244 4143 225d 0d0a 0909  "SUM","DAC"]....
-00058570: 6669 745f 6e61 6d65 733d 5b63 6865 636b  fit_names=[check
-00058580: 5f66 6f6c 6465 7228 6375 7272 656e 745f  _folder(current_
-00058590: 7061 7468 3d73 656c 662e 7061 7468 2c20  path=self.path, 
-000585a0: 7061 7468 3d70 6174 682c 2066 696c 656e  path=path, filen
-000585b0: 616d 653d 7365 6c66 2e66 696c 656e 616d  ame=self.filenam
-000585c0: 652e 7370 6c69 7428 272e 2729 5b30 5d20  e.split('.')[0] 
-000585d0: 2b20 225f 2220 2b73 7472 2861 2920 2b22  + "_" +str(a) +"
-000585e0: 2e70 6e67 2229 2066 6f72 2061 2069 6e20  .png") for a in 
-000585f0: 6669 745f 6e61 6d65 735d 0d0a 0909 706c  fit_names]....pl
-00058600: 742e 636c 6f73 6528 2761 6c6c 2729 0d0a  t.close('all')..
-00058610: 0909 6f72 6967 696e 3d73 656c 662e 7361  ..origin=self.sa
-00058620: 7665 5f66 6967 7572 6573 5f74 6f5f 666f  ve_figures_to_fo
-00058630: 6c64 6572 0d0a 0909 6966 2066 696c 656e  lder....if filen
-00058640: 616d 6520 6973 204e 6f6e 653a 0d0a 0909  ame is None:....
-00058650: 0966 696c 656e 616d 653d 7365 6c66 2e66  .filename=self.f
-00058660: 696c 656e 616d 650d 0a09 0909 6669 6c65  ilename.....file
-00058670: 6e61 6d65 3d66 696c 656e 616d 652e 7370  name=filename.sp
-00058680: 6c69 7428 272e 2729 5b30 5d0d 0a09 0969  lit('.')[0]....i
-00058690: 6620 7361 7665 5f52 4157 3a0d 0a09 0909  f save_RAW:.....
-000586a0: 7365 6c66 2e73 6176 655f 6669 6775 7265  self.save_figure
-000586b0: 735f 746f 5f66 6f6c 6465 723d 5472 7565  s_to_folder=True
-000586c0: 0d0a 0909 0973 656c 662e 506c 6f74 5f52  .....self.Plot_R
-000586d0: 4157 2873 6176 6574 7970 6520 3d20 2770  AW(savetype = 'p
-000586e0: 6e67 272c 2073 6361 6c65 5f74 7970 6520  ng', scale_type 
-000586f0: 3d20 7363 616c 655f 7479 7065 2c20 7469  = scale_type, ti
-00058700: 746c 6520 3d20 7469 746c 652c 2063 6d61  tle = title, cma
-00058710: 7020 3d20 636d 6170 2c20 7061 7468 203d  p = cmap, path =
-00058720: 2070 6174 6829 090d 0a09 0909 706c 742e   path)......plt.
-00058730: 636c 6f73 6528 2761 6c6c 2729 0d0a 0909  close('all')....
-00058740: 6966 2073 6176 655f 4669 743a 0d0a 0909  if save_Fit:....
-00058750: 0974 7279 3a0d 0a09 0909 0973 656c 662e  .try:......self.
-00058760: 7361 7665 5f66 6967 7572 6573 5f74 6f5f  save_figures_to_
-00058770: 666f 6c64 6572 3d54 7275 650d 0a09 0909  folder=True.....
-00058780: 0973 656c 662e 506c 6f74 5f66 6974 5f6f  .self.Plot_fit_o
-00058790: 7574 7075 7428 7361 7665 7479 7065 203d  utput(savetype =
-000587a0: 2027 706e 6727 2c20 7363 616c 655f 7479   'png', scale_ty
-000587b0: 7065 203d 2073 6361 6c65 5f74 7970 652c  pe = scale_type,
-000587c0: 2074 6974 6c65 203d 2074 6974 6c65 2c20   title = title, 
-000587d0: 7061 7463 6865 7320 3d20 7061 7463 6865  patches = patche
-000587e0: 732c 2063 6d61 7020 3d20 636d 6170 202c  s, cmap = cmap ,
-000587f0: 2070 6174 6820 3d20 7061 7468 290d 0a09   path = path)...
-00058800: 0909 0970 6c74 2e63 6c6f 7365 2827 616c  ...plt.close('al
-00058810: 6c27 290d 0a09 0909 6578 6365 7074 3a0d  l').....except:.
-00058820: 0a09 0909 0973 6176 655f 4669 7420 3d20  .....save_Fit = 
-00058830: 4661 6c73 650d 0a09 0909 0970 7269 6e74  False......print
-00058840: 2827 7275 6e20 696e 746f 2070 726f 626c  ('run into probl
-00058850: 656d 7320 7769 7468 2061 6464 696e 6720  ems with adding 
-00058860: 7468 6520 6669 7420 7265 7375 6c74 732e  the fit results.
-00058870: 2048 6176 6520 796f 7520 6669 7474 6564   Have you fitted
-00058880: 2073 6f6d 6574 6869 6e67 3f27 290d 0a09   something?')...
-00058890: 0909 7472 793a 0d0a 0909 0909 5265 7375  ..try:......Resu
-000588a0: 6c74 5f73 7472 696e 673d 275c 6e46 6974  lt_string='\nFit
-000588b0: 2052 6573 756c 7473 3a5c 6e27 0d0a 0909   Results:\n'....
-000588c0: 0909 6966 2069 7369 6e73 7461 6e63 6528  ..if isinstance(
-000588d0: 7365 6c66 2e6d 6f64 2c74 7970 6528 2768  self.mod,type('h
-000588e0: 656c 6c6f 2729 293a 0d0a 0909 0909 0952  ello')):.......R
-000588f0: 6573 756c 745f 7374 7269 6e67 2b3d 274d  esult_string+='M
-00058900: 6f64 656c 2055 7365 643a 2025 735c 6e5c  odel Used: %s\n\
-00058910: 6e27 2573 656c 662e 6d6f 640d 0a09 0909  n'%self.mod.....
-00058920: 0965 6c73 653a 0d0a 0909 0909 0952 6573  .else:.......Res
-00058930: 756c 745f 7374 7269 6e67 2b3d 274d 6f64  ult_string+='Mod
-00058940: 656c 2055 7365 643a 2045 7874 6572 6e61  el Used: Externa
-00058950: 6c20 6675 6e63 7469 6f6e 5c6e 5c6e 270d  l function\n\n'.
-00058960: 0a09 0909 0969 6620 7365 6c66 2e69 676e  .....if self.ign
-00058970: 6f72 655f 7469 6d65 5f72 6567 696f 6e20  ore_time_region 
-00058980: 6973 206e 6f74 204e 6f6e 653a 0d0a 0909  is not None:....
-00058990: 0909 0952 6573 756c 745f 7374 7269 6e67  ...Result_string
-000589a0: 2b3d 2774 6865 2074 696d 6520 6265 7477  +='the time betw
-000589b0: 6565 6e20 252e 3366 2025 7320 616e 6420  een %.3f %s and 
-000589c0: 252e 3366 2025 7320 5c6e 2077 6173 2065  %.3f %s \n was e
-000589d0: 7863 6c75 6465 6420 6672 6f6d 2074 6865  xcluded from the
-000589e0: 206f 7074 696d 697a 6174 696f 6e5c 6e27   optimization\n'
-000589f0: 2528 7365 6c66 2e69 676e 6f72 655f 7469  %(self.ignore_ti
-00058a00: 6d65 5f72 6567 696f 6e5b 305d 2c73 656c  me_region[0],sel
-00058a10: 662e 6261 7365 756e 6974 2c73 656c 662e  f.baseunit,self.
-00058a20: 6967 6e6f 7265 5f74 696d 655f 7265 6769  ignore_time_regi
-00058a30: 6f6e 5b31 5d2c 7365 6c66 2e62 6173 6575  on[1],self.baseu
-00058a40: 6e69 7429 090d 0a09 0909 0952 6573 756c  nit).......Resul
-00058a50: 745f 7374 7269 6e67 2b3d 2754 6865 206d  t_string+='The m
-00058a60: 696e 696d 756d 2065 7272 6f72 2069 733a  inimum error is:
-00058a70: 7b3a 2e38 657d 5c6e 272e 666f 726d 6174  {:.8e}\n'.format
-00058a80: 2873 656c 662e 7265 5b27 6572 726f 7227  (self.re['error'
-00058a90: 5d29 0d0a 0909 0909 5265 7375 6c74 5f73  ])......Result_s
-00058aa0: 7472 696e 672b 3d27 5468 6520 6d69 6e69  tring+='The mini
-00058ab0: 6d75 6d20 5232 2d76 616c 7565 2069 733a  mum R2-value is:
-00058ac0: 7b3a 2e38 657d 5c6e 272e 666f 726d 6174  {:.8e}\n'.format
-00058ad0: 2873 656c 662e 7265 5b27 7232 275d 290d  (self.re['r2']).
-00058ae0: 0a09 0909 0969 6620 2763 6f6e 6669 6465  .....if 'confide
-00058af0: 6e63 6527 2069 6e20 7365 6c66 2e72 653a  nce' in self.re:
-00058b00: 0d0a 0909 0909 0952 6573 756c 745f 7374  .......Result_st
-00058b10: 7269 6e67 2b3d 275c 6e49 6e20 5261 7465  ring+='\nIn Rate
-00058b20: 7320 7769 7468 2063 6f6e 6669 6465 6e63  s with confidenc
-00058b30: 6520 696e 7465 7276 616c 2074 6f20 6c65  e interval to le
-00058b40: 7665 6c20 6f66 2025 735c 6e27 2573 656c  vel of %s\n'%sel
-00058b50: 662e 7265 5b27 636f 6e66 6964 656e 6365  f.re['confidence
-00058b60: 275d 5b27 7461 7267 6574 2d6c 6576 656c  ']['target-level
-00058b70: 275d 0d0a 0909 0909 0952 6573 756c 745f  '].......Result_
-00058b80: 7374 7269 6e67 2b3d 7365 6c66 2e72 655b  string+=self.re[
-00058b90: 2766 6974 5f72 6573 756c 7473 5f72 6174  'fit_results_rat
-00058ba0: 6573 275d 2e74 6f5f 7374 7269 6e67 2863  es'].to_string(c
-00058bb0: 6f6c 756d 6e73 3d5b 2776 616c 7565 272c  olumns=['value',
-00058bc0: 276c 6f77 6572 5f6c 696d 6974 272c 2775  'lower_limit','u
-00058bd0: 7070 6572 5f6c 696d 6974 272c 2769 6e69  pper_limit','ini
-00058be0: 745f 7661 6c75 6527 2c27 7661 7279 272c  t_value','vary',
-00058bf0: 276d 696e 272c 276d 6178 272c 2765 7870  'min','max','exp
-00058c00: 7227 5d29 0d0a 0909 0909 0952 6573 756c  r']).......Resul
-00058c10: 745f 7374 7269 6e67 2b3d 275c 6e5c 6e54  t_string+='\n\nT
-00058c20: 6865 2072 6174 6573 2063 6f6e 7665 7274  he rates convert
-00058c30: 6564 2074 6f20 7469 6d65 7320 7769 7468  ed to times with
-00058c40: 2075 6e69 7420 2573 5c6e 2077 6974 6820   unit %s\n with 
-00058c50: 636f 6e66 6964 656e 6365 2069 6e74 6572  confidence inter
-00058c60: 7661 6c20 746f 206c 6576 656c 206f 6620  val to level of 
-00058c70: 2573 5c6e 2725 2873 656c 662e 6261 7365  %s\n'%(self.base
-00058c80: 756e 6974 2c73 656c 662e 7265 5b27 636f  unit,self.re['co
-00058c90: 6e66 6964 656e 6365 275d 5b27 7461 7267  nfidence']['targ
-00058ca0: 6574 2d6c 6576 656c 275d 290d 0a09 0909  et-level']).....
-00058cb0: 0909 5265 7375 6c74 5f73 7472 696e 672b  ..Result_string+
-00058cc0: 3d73 656c 662e 7265 5b27 6669 745f 7265  =self.re['fit_re
-00058cd0: 7375 6c74 735f 7469 6d65 7327 5d2e 746f  sults_times'].to
-00058ce0: 5f73 7472 696e 6728 636f 6c75 6d6e 733d  _string(columns=
-00058cf0: 5b27 7661 6c75 6527 2c27 6c6f 7765 725f  ['value','lower_
-00058d00: 6c69 6d69 7427 2c27 7570 7065 725f 6c69  limit','upper_li
-00058d10: 6d69 7427 2c27 696e 6974 5f76 616c 7565  mit','init_value
-00058d20: 272c 2776 6172 7927 2c27 6d69 6e27 2c27  ','vary','min','
-00058d30: 6d61 7827 2c27 6578 7072 275d 290d 0a09  max','expr'])...
-00058d40: 0909 0965 6c73 653a 0d0a 0909 0909 0952  ...else:.......R
-00058d50: 6573 756c 745f 7374 7269 6e67 2b3d 275c  esult_string+='\
-00058d60: 6e49 6e20 5261 7465 735c 6e27 0d0a 0909  nIn Rates\n'....
-00058d70: 0909 0952 6573 756c 745f 7374 7269 6e67  ...Result_string
-00058d80: 2b3d 7365 6c66 2e72 655b 2766 6974 5f72  +=self.re['fit_r
-00058d90: 6573 756c 7473 5f72 6174 6573 275d 2e74  esults_rates'].t
-00058da0: 6f5f 7374 7269 6e67 2863 6f6c 756d 6e73  o_string(columns
-00058db0: 3d5b 2776 616c 7565 272c 2769 6e69 745f  =['value','init_
-00058dc0: 7661 6c75 6527 2c27 7661 7279 272c 276d  value','vary','m
-00058dd0: 696e 272c 276d 6178 272c 2765 7870 7227  in','max','expr'
-00058de0: 5d29 0d0a 0909 0909 0952 6573 756c 745f  ]).......Result_
-00058df0: 7374 7269 6e67 2b3d 275c 6e5c 6e54 6865  string+='\n\nThe
-00058e00: 2072 6174 6573 2063 6f6e 7665 7274 6564   rates converted
-00058e10: 2074 6f20 7469 6d65 7320 7769 7468 2075   to times with u
-00058e20: 6e69 7420 2573 5c6e 2725 7365 6c66 2e62  nit %s\n'%self.b
-00058e30: 6173 6575 6e69 740d 0a09 0909 0909 5265  aseunit.......Re
-00058e40: 7375 6c74 5f73 7472 696e 672b 3d73 656c  sult_string+=sel
-00058e50: 662e 7265 5b27 6669 745f 7265 7375 6c74  f.re['fit_result
-00058e60: 735f 7469 6d65 7327 5d2e 746f 5f73 7472  s_times'].to_str
-00058e70: 696e 6728 636f 6c75 6d6e 733d 5b27 7661  ing(columns=['va
-00058e80: 6c75 6527 2c27 696e 6974 5f76 616c 7565  lue','init_value
-00058e90: 272c 2776 6172 7927 2c27 6d69 6e27 2c27  ','vary','min','
-00058ea0: 6d61 7827 2c27 6578 7072 275d 290d 0a09  max','expr'])...
-00058eb0: 0909 6578 6365 7074 3a0d 0a09 0909 0970  ..except:......p
-00058ec0: 6173 730d 0a09 0969 6620 2827 7064 6627  ass....if ('pdf'
-00058ed0: 2069 6e20 7361 7665 7479 7065 2920 6f72   in savetype) or
-00058ee0: 2028 2770 6e67 2720 696e 2073 6176 6574   ('png' in savet
-00058ef0: 7970 6529 206f 7220 2827 7376 6727 2069  ype) or ('svg' i
-00058f00: 6e20 7361 7665 7479 7065 293a 0d0a 0909  n savetype):....
-00058f10: 0969 6620 7361 7665 5f52 4157 3a0d 0a09  .if save_RAW:...
-00058f20: 0909 0966 6967 2c61 783d 706c 742e 7375  ...fig,ax=plt.su
-00058f30: 6270 6c6f 7473 286e 726f 7773 3d32 2c6e  bplots(nrows=2,n
-00058f40: 636f 6c73 3d32 2c66 6967 7369 7a65 3d28  cols=2,figsize=(
-00058f50: 3130 2c37 2e35 2929 0d0a 0909 0909 6178  10,7.5))......ax
-00058f60: 5b30 2c31 5d2e 696d 7368 6f77 286d 7069  [0,1].imshow(mpi
-00058f70: 6d67 2e69 6d72 6561 6428 7374 7228 7261  mg.imread(str(ra
-00058f80: 775f 6e61 6d65 735b 305d 2929 290d 0a09  w_names[0])))...
-00058f90: 0909 0961 785b 302c 305d 2e69 6d73 686f  ...ax[0,0].imsho
-00058fa0: 7728 6d70 696d 672e 696d 7265 6164 2873  w(mpimg.imread(s
-00058fb0: 7472 2872 6177 5f6e 616d 6573 5b31 5d29  tr(raw_names[1])
-00058fc0: 2929 0d0a 0909 0909 6178 5b31 2c30 5d2e  ))......ax[1,0].
-00058fd0: 696d 7368 6f77 286d 7069 6d67 2e69 6d72  imshow(mpimg.imr
-00058fe0: 6561 6428 7374 7228 7261 775f 6e61 6d65  ead(str(raw_name
-00058ff0: 735b 325d 2929 290d 0a09 0909 0961 785b  s[2])))......ax[
-00059000: 312c 315d 2e69 6d73 686f 7728 6d70 696d  1,1].imshow(mpim
-00059010: 672e 696d 7265 6164 2873 7472 2872 6177  g.imread(str(raw
-00059020: 5f6e 616d 6573 5b33 5d29 2929 0d0a 0909  _names[3])))....
-00059030: 0909 6178 5b30 2c30 5d2e 6178 6973 2827  ..ax[0,0].axis('
-00059040: 6f66 6627 293b 6178 5b31 2c30 5d2e 6178  off');ax[1,0].ax
-00059050: 6973 2827 6f66 6627 293b 6178 5b30 2c31  is('off');ax[0,1
-00059060: 5d2e 6178 6973 2827 6f66 6627 293b 6178  ].axis('off');ax
-00059070: 5b31 2c31 5d2e 6178 6973 2827 6f66 6627  [1,1].axis('off'
-00059080: 290d 0a09 0909 0966 6f72 2065 6e74 7279  )......for entry
-00059090: 2069 6e20 7361 7665 7479 7065 3a0d 0a09   in savetype:...
-000590a0: 0909 0909 6966 2065 6e74 7279 203d 3d20  ....if entry == 
-000590b0: 2270 7074 7822 3a63 6f6e 7469 6e75 650d  "pptx":continue.
-000590c0: 0a09 0909 0909 7472 793a 0d0a 0909 0909  ......try:......
-000590d0: 0909 6669 672e 7469 6768 745f 6c61 796f  ..fig.tight_layo
-000590e0: 7574 2829 0d0a 0909 0909 0909 6669 672e  ut()........fig.
-000590f0: 7361 7665 6669 6728 6368 6563 6b5f 666f  savefig(check_fo
-00059100: 6c64 6572 2870 6174 683d 7061 7468 2c63  lder(path=path,c
-00059110: 7572 7265 6e74 5f70 6174 683d 7365 6c66  urrent_path=self
-00059120: 2e70 6174 682c 6669 6c65 6e61 6d65 3d73  .path,filename=s
-00059130: 656c 662e 6669 6c65 6e61 6d65 2e73 706c  elf.filename.spl
-00059140: 6974 2827 2e27 295b 305d 202b 2027 5f52  it('.')[0] + '_R
-00059150: 4157 2d73 756d 6d61 7279 2e25 7327 2565  AW-summary.%s'%e
-00059160: 6e74 7279 292c 6470 693d 3630 3029 0d0a  ntry),dpi=600)..
-00059170: 0909 0909 0965 7863 6570 743a 0d0a 0909  .....except:....
-00059180: 0909 0909 7072 696e 7428 2273 6176 696e  ....print("savin
-00059190: 6720 696e 2220 2b20 656e 7472 7920 2b22  g in" + entry +"
-000591a0: 6661 696c 6564 2229 0d0a 0909 0969 6620  failed").....if 
-000591b0: 7361 7665 5f46 6974 3a0d 0a09 0909 0947  save_Fit:......G
-000591c0: 203d 2047 7269 6453 7065 6328 342c 2038   = GridSpec(4, 8
-000591d0: 290d 0a09 0909 0966 6967 313d 706c 742e  )......fig1=plt.
-000591e0: 6669 6775 7265 2866 6967 7369 7a65 3d28  figure(figsize=(
-000591f0: 3130 2c37 2e35 2929 0d0a 0909 0909 6178  10,7.5))......ax
-00059200: 313d 6669 6731 2e61 6464 5f73 7562 706c  1=fig1.add_subpl
-00059210: 6f74 2847 5b30 2c3a 365d 290d 0a09 0909  ot(G[0,:6]).....
-00059220: 0961 7832 3d66 6967 312e 6164 645f 7375  .ax2=fig1.add_su
-00059230: 6270 6c6f 7428 475b 312c 3a36 5d29 0d0a  bplot(G[1,:6])..
-00059240: 0909 0909 6178 333d 6669 6731 2e61 6464  ....ax3=fig1.add
-00059250: 5f73 7562 706c 6f74 2847 5b32 2c3a 365d  _subplot(G[2,:6]
-00059260: 290d 0a09 0909 0961 7834 3d66 6967 312e  )......ax4=fig1.
-00059270: 6164 645f 7375 6270 6c6f 7428 475b 332c  add_subplot(G[3,
-00059280: 3a36 5d29 0d0a 0909 0909 6178 353d 6669  :6])......ax5=fi
-00059290: 6731 2e61 6464 5f73 7562 706c 6f74 2847  g1.add_subplot(G
-000592a0: 5b30 3a32 2c35 3a5d 290d 0a09 0909 0961  [0:2,5:])......a
-000592b0: 7836 3d66 6967 312e 6164 645f 7375 6270  x6=fig1.add_subp
-000592c0: 6c6f 7428 475b 323a 2c36 3a5d 290d 0a09  lot(G[2:,6:])...
-000592d0: 0909 0961 7831 2e69 6d73 686f 7728 6d70  ...ax1.imshow(mp
-000592e0: 696d 672e 696d 7265 6164 2873 7472 2866  img.imread(str(f
-000592f0: 6974 5f6e 616d 6573 5b31 5d29 2929 0d0a  it_names[1])))..
-00059300: 0909 0909 6178 322e 696d 7368 6f77 286d  ....ax2.imshow(m
-00059310: 7069 6d67 2e69 6d72 6561 6428 7374 7228  pimg.imread(str(
-00059320: 6669 745f 6e61 6d65 735b 325d 2929 290d  fit_names[2]))).
-00059330: 0a09 0909 0961 7833 2e69 6d73 686f 7728  .....ax3.imshow(
-00059340: 6d70 696d 672e 696d 7265 6164 2873 7472  mpimg.imread(str
-00059350: 2866 6974 5f6e 616d 6573 5b33 5d29 2929  (fit_names[3])))
-00059360: 0d0a 0909 0909 6178 342e 696d 7368 6f77  ......ax4.imshow
-00059370: 286d 7069 6d67 2e69 6d72 6561 6428 7374  (mpimg.imread(st
-00059380: 7228 6669 745f 6e61 6d65 735b 345d 2929  r(fit_names[4]))
-00059390: 290d 0a09 0909 0961 7835 2e69 6d73 686f  )......ax5.imsho
-000593a0: 7728 6d70 696d 672e 696d 7265 6164 2873  w(mpimg.imread(s
-000593b0: 7472 2866 6974 5f6e 616d 6573 5b30 5d29  tr(fit_names[0])
-000593c0: 2929 0d0a 0909 0909 6178 362e 7465 7874  ))......ax6.text
-000593d0: 2830 2c30 2c52 6573 756c 745f 7374 7269  (0,0,Result_stri
-000593e0: 6e67 2c66 6f6e 7473 697a 653d 372c 666f  ng,fontsize=7,fo
-000593f0: 6e74 7765 6967 6874 3d27 6e6f 726d 616c  ntweight='normal
-00059400: 2729 0d0a 0909 0909 6178 312e 6178 6973  ')......ax1.axis
-00059410: 2827 6f66 6627 293b 6178 322e 6178 6973  ('off');ax2.axis
-00059420: 2827 6f66 6627 293b 6178 332e 6178 6973  ('off');ax3.axis
-00059430: 2827 6f66 6627 293b 6178 342e 6178 6973  ('off');ax4.axis
-00059440: 2827 6f66 6627 293b 6178 352e 6178 6973  ('off');ax5.axis
-00059450: 2827 6f66 6627 293b 6178 362e 6178 6973  ('off');ax6.axis
-00059460: 2827 6f66 6627 290d 0a09 0909 0966 6f72  ('off')......for
-00059470: 2065 6e74 7279 2069 6e20 7361 7665 7479   entry in savety
-00059480: 7065 3a0d 0a09 0909 0909 6966 2065 6e74  pe:.......if ent
-00059490: 7279 203d 3d20 2270 7074 7822 3a20 636f  ry == "pptx": co
-000594a0: 6e74 696e 7565 0d0a 0909 0909 0974 7279  ntinue.......try
-000594b0: 3a0d 0a09 0909 0909 0966 6967 312e 7469  :........fig1.ti
-000594c0: 6768 745f 6c61 796f 7574 2829 0d0a 0909  ght_layout()....
-000594d0: 0909 0909 6669 6731 2e73 6176 6566 6967  ....fig1.savefig
-000594e0: 2863 6865 636b 5f66 6f6c 6465 7228 7061  (check_folder(pa
-000594f0: 7468 3d70 6174 682c 6375 7272 656e 745f  th=path,current_
-00059500: 7061 7468 3d73 656c 662e 7061 7468 2c66  path=self.path,f
-00059510: 696c 656e 616d 653d 7365 6c66 2e66 696c  ilename=self.fil
-00059520: 656e 616d 652e 7370 6c69 7428 272e 2729  ename.split('.')
-00059530: 5b30 5d20 2b20 275f 4669 742d 7375 6d6d  [0] + '_Fit-summ
-00059540: 6172 792e 2573 2725 656e 7472 7929 2c64  ary.%s'%entry),d
-00059550: 7069 3d36 3030 290d 0a09 0909 0909 6578  pi=600).......ex
-00059560: 6365 7074 3a0d 0a09 0909 0909 0970 7269  cept:........pri
-00059570: 6e74 2822 7361 7669 6e67 2069 6e22 202b  nt("saving in" +
-00059580: 2065 6e74 7279 202b 2266 6169 6c65 6422   entry +"failed"
-00059590: 290d 0a09 0969 6620 2827 7070 7478 2720  )....if ('pptx' 
-000595a0: 696e 2073 6176 6574 7970 6529 206f 7220  in savetype) or 
-000595b0: 2827 7070 7427 2069 6e20 7361 7665 7479  ('ppt' in savety
-000595c0: 7065 293a 0d0a 0909 096c 6566 743d 496e  pe):.....left=In
-000595d0: 6368 6573 2830 2e32 290d 0a09 0909 746f  ches(0.2).....to
-000595e0: 703d 496e 6368 6573 2830 2e32 290d 0a09  p=Inches(0.2)...
-000595f0: 0909 7072 7320 3d20 5072 6573 656e 7461  ..prs = Presenta
-00059600: 7469 6f6e 2829 0d0a 0909 0962 6c61 6e6b  tion().....blank
-00059610: 5f73 6c69 6465 5f6c 6179 6f75 7420 3d20  _slide_layout = 
-00059620: 7072 732e 736c 6964 655f 6c61 796f 7574  prs.slide_layout
-00059630: 735b 365d 0d0a 0909 0973 6c69 6465 203d  s[6].....slide =
-00059640: 2070 7273 2e73 6c69 6465 732e 6164 645f   prs.slides.add_
-00059650: 736c 6964 6528 626c 616e 6b5f 736c 6964  slide(blank_slid
-00059660: 655f 6c61 796f 7574 290d 0a09 0909 6966  e_layout).....if
-00059670: 2073 6176 655f 5241 573a 0d0a 0909 0909   save_RAW:......
-00059680: 6c65 6674 203d 2074 6f70 203d 2049 6e63  left = top = Inc
-00059690: 6865 7328 302e 3529 0d0a 0909 0909 7069  hes(0.5)......pi
-000596a0: 6320 3d20 736c 6964 652e 7368 6170 6573  c = slide.shapes
-000596b0: 2e61 6464 5f70 6963 7475 7265 2873 7472  .add_picture(str
-000596c0: 2872 6177 5f6e 616d 6573 5b30 5d2e 7265  (raw_names[0].re
-000596d0: 736f 6c76 6528 2929 2c20 6c65 6674 3d6c  solve()), left=l
-000596e0: 6566 742b 496e 6368 6573 2834 2e35 292c  eft+Inches(4.5),
-000596f0: 2074 6f70 3d74 6f70 2c20 7769 6474 683d   top=top, width=
-00059700: 496e 6368 6573 2834 2e35 2929 0d0a 0909  Inches(4.5))....
-00059710: 0909 7069 6320 3d20 736c 6964 652e 7368  ..pic = slide.sh
-00059720: 6170 6573 2e61 6464 5f70 6963 7475 7265  apes.add_picture
-00059730: 2873 7472 2872 6177 5f6e 616d 6573 5b31  (str(raw_names[1
-00059740: 5d2e 7265 736f 6c76 6528 2929 2c20 6c65  ].resolve()), le
-00059750: 6674 3d6c 6566 742c 2074 6f70 3d74 6f70  ft=left, top=top
-00059760: 2c20 7769 6474 683d 496e 6368 6573 2834  , width=Inches(4
-00059770: 2e35 2929 0d0a 0909 0909 7069 6320 3d20  .5))......pic = 
-00059780: 736c 6964 652e 7368 6170 6573 2e61 6464  slide.shapes.add
-00059790: 5f70 6963 7475 7265 2873 7472 2872 6177  _picture(str(raw
-000597a0: 5f6e 616d 6573 5b32 5d2e 7265 736f 6c76  _names[2].resolv
-000597b0: 6528 2929 2c20 6c65 6674 3d6c 6566 742c  e()), left=left,
-000597c0: 2074 6f70 3d74 6f70 2b49 6e63 6865 7328   top=top+Inches(
-000597d0: 3329 2c20 7769 6474 683d 496e 6368 6573  3), width=Inches
-000597e0: 2834 2e35 2929 0d0a 0909 0909 7472 793a  (4.5))......try:
-000597f0: 0d0a 0909 0909 0970 6963 203d 2073 6c69  .......pic = sli
-00059800: 6465 2e73 6861 7065 732e 6164 645f 7069  de.shapes.add_pi
-00059810: 6374 7572 6528 7374 7228 7261 775f 6e61  cture(str(raw_na
-00059820: 6d65 735b 335d 2e72 6573 6f6c 7665 2829  mes[3].resolve()
-00059830: 292c 206c 6566 743d 6c65 6674 2b49 6e63  ), left=left+Inc
-00059840: 6865 7328 342e 3529 2c20 746f 703d 746f  hes(4.5), top=to
-00059850: 702b 496e 6368 6573 2833 292c 2068 6569  p+Inches(3), hei
-00059860: 6768 743d 496e 6368 6573 2833 2e34 2929  ght=Inches(3.4))
-00059870: 0d0a 0909 0909 6578 6365 7074 3a0d 0a09  ......except:...
-00059880: 0909 0909 7061 7373 0d0a 0909 0969 6620  ....pass.....if 
-00059890: 7361 7665 5f46 6974 3a0d 0a09 0909 0974  save_Fit:......t
-000598a0: 7279 3a0d 0a09 0909 0909 736c 6964 6532  ry:.......slide2
-000598b0: 203d 2070 7273 2e73 6c69 6465 732e 6164   = prs.slides.ad
-000598c0: 645f 736c 6964 6528 626c 616e 6b5f 736c  d_slide(blank_sl
-000598d0: 6964 655f 6c61 796f 7574 290d 0a09 0909  ide_layout).....
-000598e0: 0909 6c65 6674 203d 2074 6f70 203d 2049  ..left = top = I
-000598f0: 6e63 6865 7328 302e 3129 0d0a 0909 0909  nches(0.1)......
-00059900: 0970 6963 203d 2073 6c69 6465 322e 7368  .pic = slide2.sh
-00059910: 6170 6573 2e61 6464 5f70 6963 7475 7265  apes.add_picture
-00059920: 2873 7472 2866 6974 5f6e 616d 6573 5b30  (str(fit_names[0
-00059930: 5d2e 7265 736f 6c76 6528 2929 2c20 6c65  ].resolve()), le
-00059940: 6674 3d6c 6566 742b 496e 6368 6573 2835  ft=left+Inches(5
-00059950: 2e35 292c 2074 6f70 3d74 6f70 2c20 6865  .5), top=top, he
-00059960: 6967 6874 3d49 6e63 6865 7328 332e 3529  ight=Inches(3.5)
-00059970: 2923 4d61 7472 6978 0d0a 0909 0909 0970  )#Matrix.......p
-00059980: 6963 203d 2073 6c69 6465 322e 7368 6170  ic = slide2.shap
-00059990: 6573 2e61 6464 5f70 6963 7475 7265 2873  es.add_picture(s
-000599a0: 7472 2866 6974 5f6e 616d 6573 5b31 5d2e  tr(fit_names[1].
-000599b0: 7265 736f 6c76 6528 2929 2c20 6c65 6674  resolve()), left
-000599c0: 3d6c 6566 742c 2074 6f70 3d74 6f70 2c20  =left, top=top, 
-000599d0: 6865 6967 6874 3d49 6e63 6865 7328 3229  height=Inches(2)
-000599e0: 290d 0a09 0909 0909 7069 6320 3d20 736c  ).......pic = sl
-000599f0: 6964 6532 2e73 6861 7065 732e 6164 645f  ide2.shapes.add_
-00059a00: 7069 6374 7572 6528 7374 7228 6669 745f  picture(str(fit_
-00059a10: 6e61 6d65 735b 325d 2e72 6573 6f6c 7665  names[2].resolve
-00059a20: 2829 292c 206c 6566 743d 6c65 6674 2c20  ()), left=left, 
-00059a30: 746f 703d 746f 702b 496e 6368 6573 2832  top=top+Inches(2
-00059a40: 292c 2068 6569 6768 743d 496e 6368 6573  ), height=Inches
-00059a50: 2832 2929 0d0a 0909 0909 0970 6963 203d  (2)).......pic =
-00059a60: 2073 6c69 6465 322e 7368 6170 6573 2e61   slide2.shapes.a
-00059a70: 6464 5f70 6963 7475 7265 2873 7472 2866  dd_picture(str(f
-00059a80: 6974 5f6e 616d 6573 5b33 5d2e 7265 736f  it_names[3].reso
-00059a90: 6c76 6528 2929 2c20 6c65 6674 3d6c 6566  lve()), left=lef
-00059aa0: 742c 2074 6f70 3d74 6f70 2b49 6e63 6865  t, top=top+Inche
-00059ab0: 7328 332e 3929 2c20 6865 6967 6874 3d49  s(3.9), height=I
-00059ac0: 6e63 6865 7328 312e 3429 290d 0a09 0909  nches(1.4)).....
-00059ad0: 0909 7069 6320 3d20 736c 6964 6532 2e73  ..pic = slide2.s
-00059ae0: 6861 7065 732e 6164 645f 7069 6374 7572  hapes.add_pictur
-00059af0: 6528 7374 7228 6669 745f 6e61 6d65 735b  e(str(fit_names[
-00059b00: 345d 2e72 6573 6f6c 7665 2829 292c 206c  4].resolve()), l
-00059b10: 6566 743d 6c65 6674 2c20 746f 703d 746f  eft=left, top=to
-00059b20: 702b 496e 6368 6573 2835 2e34 292c 2068  p+Inches(5.4), h
-00059b30: 6569 6768 743d 496e 6368 6573 2832 2929  eight=Inches(2))
-00059b40: 0d0a 0909 0909 090d 0a09 0909 0909 7465  ..............te
-00059b50: 7874 3120 3d20 736c 6964 6532 2e73 6861  xt1 = slide2.sha
-00059b60: 7065 732e 6164 645f 7465 7874 626f 7828  pes.add_textbox(
-00059b70: 6c65 6674 3d6c 6566 742b 496e 6368 6573  left=left+Inches
-00059b80: 2835 2e35 292c 2074 6f70 3d74 6f70 2b49  (5.5), top=top+I
-00059b90: 6e63 6865 7328 332e 3529 2c20 7769 6474  nches(3.5), widt
-00059ba0: 683d 496e 6368 6573 2834 2e35 292c 2068  h=Inches(4.5), h
-00059bb0: 6569 6768 743d 496e 6368 6573 2834 2929  eight=Inches(4))
-00059bc0: 0d0a 0909 0909 0974 6578 7431 2e74 6578  .......text1.tex
-00059bd0: 7420 3d20 5265 7375 6c74 5f73 7472 696e  t = Result_strin
-00059be0: 670d 0a09 0909 0909 7465 7874 312e 7465  g.......text1.te
-00059bf0: 7874 5f66 7261 6d65 2e66 6974 5f74 6578  xt_frame.fit_tex
-00059c00: 7428 666f 6e74 5f66 616d 696c 793d 7527  t(font_family=u'
-00059c10: 4172 6961 6c27 2c20 6d61 785f 7369 7a65  Arial', max_size
-00059c20: 3d38 2c20 626f 6c64 3d46 616c 7365 2c20  =8, bold=False, 
-00059c30: 6974 616c 6963 3d46 616c 7365 290d 0a09  italic=False)...
-00059c40: 0909 0965 7863 6570 743a 0d0a 0909 0909  ...except:......
-00059c50: 0970 7269 6e74 2827 6578 6974 6564 2077  .print('exited w
-00059c60: 6865 6e20 7361 7669 6e67 2074 6865 2066  hen saving the f
-00059c70: 6974 2070 6c6f 7473 2729 0d0a 0909 0909  it plots')......
-00059c80: 0d0a 0d0a 0909 0970 6c74 2e63 6c6f 7365  .......plt.close
-00059c90: 2827 616c 6c27 290d 0a09 0909 7365 6c66  ('all').....self
-00059ca0: 2e73 6176 655f 6669 6775 7265 735f 746f  .save_figures_to
-00059cb0: 5f66 6f6c 6465 723d 6f72 6967 696e 0d0a  _folder=origin..
-00059cc0: 0909 0970 7273 2e73 6176 6528 6368 6563  ...prs.save(chec
-00059cd0: 6b5f 666f 6c64 6572 2870 6174 683d 7061  k_folder(path=pa
-00059ce0: 7468 2c63 7572 7265 6e74 5f70 6174 683d  th,current_path=
-00059cf0: 7365 6c66 2e70 6174 682c 6669 6c65 6e61  self.path,filena
-00059d00: 6d65 3d73 656c 662e 6669 6c65 6e61 6d65  me=self.filename
-00059d10: 2e73 706c 6974 2827 2e27 295b 305d 202b  .split('.')[0] +
-00059d20: 2027 2e70 7074 7827 2929 0d0a 0909 0970   '.pptx')).....p
-00059d30: 7269 6e74 2827 416c 6c20 6461 7461 2077  rint('All data w
-00059d40: 6173 2073 6176 6564 2074 6f20 2573 2725  as saved to %s'%
-00059d50: 6368 6563 6b5f 666f 6c64 6572 2870 6174  check_folder(pat
-00059d60: 683d 7061 7468 2c63 7572 7265 6e74 5f70  h=path,current_p
-00059d70: 6174 683d 7365 6c66 2e70 6174 6829 290d  ath=self.path)).
-00059d80: 0a09 090d 0a09 0d0a 0d0a 0d0a 0964 6566  .............def
-00059d90: 2053 6176 655f 7072 6f6a 6563 7428 7365   Save_project(se
-00059da0: 6c66 2c20 6669 6c65 6e61 6d65 3d4e 6f6e  lf, filename=Non
-00059db0: 652c 7061 7468 3d4e 6f6e 6529 3a0d 0a09  e,path=None):...
-00059dc0: 0927 2727 6675 6e63 7469 6f6e 2074 6f20  .'''function to 
-00059dd0: 6475 6d70 2061 6c6c 2074 6865 2070 6172  dump all the par
-00059de0: 616d 6574 6572 206f 6620 616e 2061 6e61  ameter of an ana
-00059df0: 6c79 7369 7320 696e 746f 2061 6e20 6864  lysis into an hd
-00059e00: 6635 2066 696c 652e 200d 0a09 0954 6869  f5 file. ....Thi
-00059e10: 7320 6669 6c65 2063 6f6e 7461 696e 7320  s file contains 
-00059e20: 7468 6520 6473 5f6f 7269 2061 6e64 2061  the ds_ori and a
-00059e30: 6c6c 2074 6865 2070 6172 616d 6574 6572  ll the parameter
-00059e40: 2c20 696e 636c 7564 696e 6720 6669 7474  , including fitt
-00059e50: 696e 6720 7061 7261 6d65 7465 720d 0a09  ing parameter...
-00059e60: 0961 6e64 2072 6573 756c 7473 2e0d 0a09  .and results....
-00059e70: 094f 6e65 206c 696d 6974 6174 696f 6e20  .One limitation 
-00059e80: 6973 2074 6865 2066 6974 7469 6e67 206d  is the fitting m
-00059e90: 6f64 656c 2e20 4966 2074 6865 206d 6f64  odel. If the mod
-00059ea0: 656c 2069 7320 6275 696c 6420 696e 2c20  el is build in, 
-00059eb0: 736f 2074 6865 206d 6f64 656c 2069 730d  so the model is.
-00059ec0: 0a09 0927 6578 706f 6e65 6e74 6961 6c27  ...'exponential'
-00059ed0: 206f 7220 2770 6172 616c 6c65 6c27 2074   or 'parallel' t
-00059ee0: 6865 6e20 7468 6520 7361 6669 6e67 2077  hen the safing w
-00059ef0: 6f72 6b73 2e20 4966 2061 6e20 6578 7465  orks. If an exte
-00059f00: 726e 616c 206d 6f64 656c 2069 7320 7573  rnal model is us
-00059f10: 6564 2074 6865 6e20 7468 6520 0d0a 0909  ed then the ....
-00059f20: 646f 7374 7269 6e67 206f 6620 7468 6520  dostring of the 
-00059f30: 6578 7465 726e 616c 2066 756e 6374 696f  external functio
-00059f40: 6e20 6973 2073 746f 7265 642c 2062 7574  n is stored, but
-00059f50: 206e 6f74 2074 6865 2066 756e 6374 696f   not the functio
-00059f60: 6e20 6974 7365 6c66 2e0d 0a09 0909 090d  n itself........
-00059f70: 0a09 0950 6172 616d 6574 6572 730d 0a09  ...Parameters...
-00059f80: 092d 2d2d 2d2d 2d2d 2d2d 2d0d 0a09 090d  .----------.....
-00059f90: 0a09 0970 6174 6820 3a20 4e6f 6e65 2c20  ...path : None, 
-00059fa0: 7374 7220 6f72 2070 6174 682c 206f 7074  str or path, opt
-00059fb0: 696f 6e61 6c0d 0a09 0909 2844 6566 6175  ional.....(Defau
-00059fc0: 6c74 2920 4e6f 6e65 2c20 6966 206c 6566  lt) None, if lef
-00059fd0: 7420 6f6e 204e 6f6e 652c 2074 6865 6e20  t on None, then 
-00059fe0: 6120 666f 6c64 6572 2022 4461 7461 2220  a folder "Data" 
-00059ff0: 6973 2063 7265 6174 6564 2069 6e20 7468  is created in th
-0005a000: 6520 666f 6c64 6572 200d 0a09 0909 6f66  e folder .....of
-0005a010: 2074 6865 2070 726f 6a65 6374 2028 7365   the project (se
-0005a020: 6c66 2e70 6174 6829 0d0a 0909 0909 0d0a  lf.path)........
-0005a030: 0909 6669 6c65 6e61 6d65 203a 2073 7472  ..filename : str
-0005a040: 2c20 6f70 7469 6f6e 616c 0d0a 0909 0928  , optional.....(
-0005a050: 4465 6661 756c 7429 204e 6f6e 652c 2042  Default) None, B
-0005a060: 6173 6520 6e61 6d65 2066 6f72 2061 6c6c  ase name for all
-0005a070: 2070 6c6f 7473 2e20 4966 204e 6f6e 652c   plots. If None,
-0005a080: 2074 6865 6e20 7365 6c66 2e66 696c 656e   then self.filen
-0005a090: 616d 6520 7769 6c6c 2062 6520 7573 6564  ame will be used
-0005a0a0: 0d0a 0909 090d 0a09 0945 7861 6d70 6c65  .........Example
-0005a0b0: 730d 0a09 092d 2d2d 2d2d 2d2d 2d0d 0a09  s....--------...
-0005a0c0: 090d 0a09 093e 3e3e 2074 612e 5361 7665  .....>>> ta.Save
-0005a0d0: 5f70 726f 6a65 6374 2829 0d0a 0909 0d0a  _project()......
-0005a0e0: 0909 2727 270d 0a09 090d 0a09 0969 6620  ..'''........if 
-0005a0f0: 6669 6c65 6e61 6d65 2069 7320 4e6f 6e65  filename is None
-0005a100: 3a0d 0a09 0909 6669 6c65 6e61 6d65 203d  :.....filename =
-0005a110: 2073 656c 662e 6669 6c65 6e61 6d65 0d0a   self.filename..
-0005a120: 0909 6864 6635 5f6e 616d 6520 3d63 6865  ..hdf5_name =che
-0005a130: 636b 5f66 6f6c 6465 7228 7061 7468 203d  ck_folder(path =
-0005a140: 2070 6174 682c 2063 7572 7265 6e74 5f70   path, current_p
-0005a150: 6174 6820 3d20 7365 6c66 2e70 6174 682c  ath = self.path,
-0005a160: 2066 696c 656e 616d 6520 3d20 6669 6c65   filename = file
-0005a170: 6e61 6d65 2e73 706c 6974 2827 2e27 295b  name.split('.')[
-0005a180: 305d 2b27 2e68 6466 3527 290d 0a09 0969  0]+'.hdf5')....i
-0005a190: 6620 6f73 2e70 6174 682e 6578 6973 7473  f os.path.exists
-0005a1a0: 2868 6466 355f 6e61 6d65 293a 0d0a 0909  (hdf5_name):....
-0005a1b0: 0974 7279 3a0d 0a09 0909 096f 732e 7265  .try:......os.re
-0005a1c0: 6d6f 7665 2868 6466 355f 6e61 6d65 290d  move(hdf5_name).
-0005a1d0: 0a09 0909 6578 6365 7074 3a0d 0a09 0909  ....except:.....
-0005a1e0: 0974 7279 3a0d 0a09 0909 0909 6864 6635  .try:.......hdf5
-0005a1f0: 5f6e 616d 652e 636c 6f73 6528 290d 0a09  _name.close()...
-0005a200: 0909 0909 6f73 2e72 656d 6f76 6528 6864  ....os.remove(hd
-0005a210: 6635 5f6e 616d 6529 0d0a 0909 0909 6578  f5_name)......ex
-0005a220: 6365 7074 3a0d 0a09 0909 0909 7072 696e  cept:.......prin
-0005a230: 7428 2746 696c 6520 6578 6973 7473 2062  t('File exists b
-0005a240: 7574 2063 616e 206e 6f74 2062 6520 6465  ut can not be de
-0005a250: 6c65 7465 6427 290d 0a09 0972 655f 7377  leted')....re_sw
-0005a260: 6974 6368 203d 2046 616c 7365 0d0a 0909  itch = False....
-0005a270: 7769 7468 2068 3570 792e 4669 6c65 2868  with h5py.File(h
-0005a280: 6466 355f 6e61 6d65 2c20 2777 2729 2061  df5_name, 'w') a
-0005a290: 7320 663a 0d0a 0909 0966 6f72 206b 6579  s f:.....for key
-0005a2a0: 2069 6e20 7365 6c66 2e5f 5f64 6963 745f   in self.__dict_
-0005a2b0: 5f2e 6b65 7973 2829 3a0d 0a09 0909 0969  _.keys():......i
-0005a2c0: 6620 6b65 7920 3d3d 2027 6d6f 6427 3a0d  f key == 'mod':.
-0005a2d0: 0a09 0909 0909 6966 2073 656c 662e 5f5f  ......if self.__
-0005a2e0: 6469 6374 5f5f 5b6b 6579 5d20 696e 205b  dict__[key] in [
-0005a2f0: 2770 6172 616c 272c 2765 7870 6f6e 656e  'paral','exponen
-0005a300: 7469 616c 272c 2763 6f6e 7365 6375 7469  tial','consecuti
-0005a310: 7665 272c 2766 756c 6c5f 636f 6e73 6563  ve','full_consec
-0005a320: 7574 6976 6527 5d3a 0d0a 0909 0909 0909  utive']:........
-0005a330: 662e 6372 6561 7465 5f64 6174 6173 6574  f.create_dataset
-0005a340: 286e 616d 653d 6b65 792c 2064 6174 613d  (name=key, data=
-0005a350: 7365 6c66 2e5f 5f64 6963 745f 5f5b 6b65  self.__dict__[ke
-0005a360: 795d 290d 0a09 0909 0909 656c 7365 3a0d  y]).......else:.
-0005a370: 0a09 0909 0909 0974 7279 3a0d 0a09 0909  .......try:.....
-0005a380: 0909 0909 646f 6373 7472 696e 673d 7365  ....docstring=se
-0005a390: 6c66 2e5f 5f64 6963 745f 5f5b 6b65 795d  lf.__dict__[key]
-0005a3a0: 2e5f 5f64 6f63 5f5f 0d0a 0909 0909 0909  .__doc__........
-0005a3b0: 0969 6620 6973 696e 7374 616e 6365 2864  .if isinstance(d
-0005a3c0: 6f63 7374 7269 6e67 2c74 7970 6528 2768  ocstring,type('h
-0005a3d0: 656c 6c6f 2729 293a 0d0a 0909 0909 0909  ello')):........
-0005a3e0: 0909 662e 6372 6561 7465 5f64 6174 6173  ..f.create_datas
-0005a3f0: 6574 286e 616d 653d 6b65 792c 2064 6174  et(name=key, dat
-0005a400: 613d 646f 6373 7472 696e 6729 0d0a 0909  a=docstring)....
-0005a410: 0909 0909 6578 6365 7074 3a0d 0a09 0909  ....except:.....
-0005a420: 0909 0909 662e 6372 6561 7465 5f64 6174  ....f.create_dat
-0005a430: 6173 6574 286e 616d 653d 6b65 792c 2064  aset(name=key, d
-0005a440: 6174 613d 2765 7874 6572 6e61 6c5f 6675  ata='external_fu
-0005a450: 6e63 7469 6f6e 5f77 6974 686f 7574 5f64  nction_without_d
-0005a460: 6f63 7374 7269 6e67 2729 0d0a 0909 0909  ocstring')......
-0005a470: 656c 6966 206b 6579 2069 6e20 5b27 7265  elif key in ['re
-0005a480: 6c5f 7761 7665 272c 2772 656c 5f74 696d  l_wave','rel_tim
-0005a490: 6527 5d3a 236e 6565 6420 6578 7472 612c  e']:#need extra,
-0005a4a0: 2061 7320 6974 2069 7320 6279 7061 7373   as it is bypass
-0005a4b0: 6564 2062 7920 7468 6520 7265 2d73 7769  ed by the re-swi
-0005a4c0: 7463 680d 0a09 0909 0909 662e 6372 6561  tch.......f.crea
-0005a4d0: 7465 5f64 6174 6173 6574 286e 616d 653d  te_dataset(name=
-0005a4e0: 6b65 792c 2064 6174 613d 7365 6c66 2e5f  key, data=self._
-0005a4f0: 5f64 6963 745f 5f5b 6b65 795d 290d 0a09  _dict__[key])...
-0005a500: 0909 0965 6c69 6620 6b65 795b 3a32 5d20  ...elif key[:2] 
-0005a510: 3d3d 2027 7265 2720 3a0d 0a09 0909 0909  == 're' :.......
-0005a520: 7265 5f73 7769 7463 6820 3d20 5472 7565  re_switch = True
-0005a530: 0d0a 0909 0909 0966 6f72 206b 6579 3220  .......for key2 
-0005a540: 696e 2073 656c 662e 5f5f 6469 6374 5f5f  in self.__dict__
-0005a550: 5b27 7265 275d 3a0d 0a09 0909 0909 0969  ['re']:........i
-0005a560: 6620 6b65 7932 203d 3d20 2766 6974 5f6f  f key2 == 'fit_o
-0005a570: 7574 7075 7427 3a63 6f6e 7469 6e75 650d  utput':continue.
-0005a580: 0a09 0909 0909 0964 6174 6120 3d20 7365  .......data = se
+00052f10: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00052f20: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00052f30: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00052f40: 2323 0d0a 0909 7365 6c66 2e72 653d 7265  ##....self.re=re
+00052f50: 0d0a 0909 6966 2073 616d 655f 4441 533a  ....if same_DAS:
+00052f60: 0d0a 0909 0972 655f 6c69 7374 656e 5b30  .....re_listen[0
+00052f70: 5d3d 7265 0d0a 0909 0973 656c 662e 6d75  ]=re.....self.mu
+00052f80: 6c74 695f 7072 6f6a 6563 7473 3d72 655f  lti_projects=re_
+00052f90: 6c69 7374 656e 0d0a 0d0a 0909 5265 7375  listen......Resu
+00052fa0: 6c74 5f73 7472 696e 673d 275c 6e46 6974  lt_string='\nFit
+00052fb0: 2052 6573 756c 7473 3a5c 6e27 0d0a 0909   Results:\n'....
+00052fc0: 0d0a 0909 6966 2069 7369 6e73 7461 6e63  ....if isinstanc
+00052fd0: 6528 6d6f 642c 7479 7065 2827 6865 6c6c  e(mod,type('hell
+00052fe0: 6f27 2929 3a0d 0a09 0909 5265 7375 6c74  o')):.....Result
+00052ff0: 5f73 7472 696e 672b 3d27 4d6f 6465 6c20  _string+='Model 
+00053000: 5573 6564 3a20 2573 5c6e 5c6e 2725 6d6f  Used: %s\n\n'%mo
+00053010: 640d 0a09 0965 6c73 653a 0d0a 0909 0952  d....else:.....R
+00053020: 6573 756c 745f 7374 7269 6e67 2b3d 274d  esult_string+='M
+00053030: 6f64 656c 2055 7365 643a 2045 7874 6572  odel Used: Exter
+00053040: 6e61 6c20 6675 6e63 7469 6f6e 5c6e 5c6e  nal function\n\n
+00053050: 270d 0a09 090d 0a09 090d 0a09 0969 6620  '............if 
+00053060: 7365 6c66 2e69 676e 6f72 655f 7469 6d65  self.ignore_time
+00053070: 5f72 6567 696f 6e20 6973 206e 6f74 204e  _region is not N
+00053080: 6f6e 653a 0d0a 0909 0974 7279 3a0d 0a09  one:.....try:...
+00053090: 0909 0952 6573 756c 745f 7374 7269 6e67  ...Result_string
+000530a0: 2b3d 2774 6865 2074 696d 6520 6265 7477  +='the time betw
+000530b0: 6565 6e20 252e 3366 2025 7320 616e 6420  een %.3f %s and 
+000530c0: 252e 3366 2025 7320 7761 7320 6578 636c  %.3f %s was excl
+000530d0: 7564 6564 2066 726f 6d20 7468 6520 6f70  uded from the op
+000530e0: 7469 6d69 7a61 7469 6f6e 5c6e 5c6e 2725  timization\n\n'%
+000530f0: 2873 656c 662e 6967 6e6f 7265 5f74 696d  (self.ignore_tim
+00053100: 655f 7265 6769 6f6e 5b30 5d2c 7365 6c66  e_region[0],self
+00053110: 2e62 6173 6575 6e69 742c 7365 6c66 2e69  .baseunit,self.i
+00053120: 676e 6f72 655f 7469 6d65 5f72 6567 696f  gnore_time_regio
+00053130: 6e5b 315d 2c73 656c 662e 6261 7365 756e  n[1],self.baseun
+00053140: 6974 290d 0a09 0909 6578 6365 7074 3a23  it).....except:#
+00053150: 7765 2067 6f74 2061 206c 6973 740d 0a09  we got a list...
+00053160: 0909 0966 6f72 2065 6e74 7279 2069 6e20  ...for entry in 
+00053170: 7365 6c66 2e69 676e 6f72 655f 7469 6d65  self.ignore_time
+00053180: 5f72 6567 696f 6e3a 0d0a 0909 0909 0952  _region:.......R
+00053190: 6573 756c 745f 7374 7269 6e67 2b3d 2774  esult_string+='t
+000531a0: 6865 2074 696d 6520 6265 7477 6565 6e20  he time between 
+000531b0: 252e 3366 2025 7320 616e 6420 252e 3366  %.3f %s and %.3f
+000531c0: 2025 7320 7761 7320 6578 636c 7564 6564   %s was excluded
+000531d0: 2066 726f 6d20 7468 6520 6f70 7469 6d69   from the optimi
+000531e0: 7a61 7469 6f6e 5c6e 5c6e 2725 2865 6e74  zation\n\n'%(ent
+000531f0: 7279 5b30 5d2c 7365 6c66 2e62 6173 6575  ry[0],self.baseu
+00053200: 6e69 742c 656e 7472 795b 315d 2c73 656c  nit,entry[1],sel
+00053210: 662e 6261 7365 756e 6974 290d 0a09 0952  f.baseunit)....R
+00053220: 6573 756c 745f 7374 7269 6e67 2b3d 2754  esult_string+='T
+00053230: 6865 206d 696e 696d 756d 2065 7272 6f72  he minimum error
+00053240: 2069 733a 7b3a 2e38 657d 5c6e 272e 666f   is:{:.8e}\n'.fo
+00053250: 726d 6174 2872 655b 2765 7272 6f72 275d  rmat(re['error']
+00053260: 290d 0a09 0974 7279 3a0d 0a09 0909 5265  )....try:.....Re
+00053270: 7375 6c74 5f73 7472 696e 672b 3d27 5468  sult_string+='Th
+00053280: 6520 6d69 6e69 6d75 6d20 5232 2d76 616c  e minimum R2-val
+00053290: 7565 2069 733a 7b3a 2e38 657d 5c6e 272e  ue is:{:.8e}\n'.
+000532a0: 666f 726d 6174 2872 655b 2772 3227 5d29  format(re['r2'])
+000532b0: 0d0a 0909 6578 6365 7074 3a0d 0a09 0909  ....except:.....
+000532c0: 7061 7373 0d0a 0909 6966 2073 616d 655f  pass....if same_
+000532d0: 4441 533a 0d0a 0909 0952 6573 756c 745f  DAS:.....Result_
+000532e0: 7374 7269 6e67 2b3d 2754 6865 206d 696e  string+='The min
+000532f0: 696d 756d 2067 6c6f 6261 6c20 6572 726f  imum global erro
+00053300: 7220 6973 3a7b 3a2e 3865 7d5c 6e27 2e66  r is:{:.8e}\n'.f
+00053310: 6f72 6d61 7428 7265 5b27 6572 726f 725f  ormat(re['error_
+00053320: 746f 7461 6c27 5d29 0d0a 0909 0952 6573  total']).....Res
+00053330: 756c 745f 7374 7269 6e67 2b3d 2754 6865  ult_string+='The
+00053340: 206d 696e 696d 756d 2067 6c6f 6261 6c20   minimum global 
+00053350: 5232 2d76 616c 7565 2069 733a 7b3a 2e38  R2-value is:{:.8
+00053360: 657d 5c6e 272e 666f 726d 6174 2872 655b  e}\n'.format(re[
+00053370: 2772 325f 746f 7461 6c27 5d29 0d0a 0909  'r2_total'])....
+00053380: 6966 2063 6f6e 6669 6465 6e63 655f 6c65  if confidence_le
+00053390: 7665 6c20 6973 206e 6f74 204e 6f6e 653a  vel is not None:
+000533a0: 0d0a 0909 0952 6573 756c 745f 7374 7269  .....Result_stri
+000533b0: 6e67 2b3d 275c 6e49 6e20 5261 7465 7320  ng+='\nIn Rates 
+000533c0: 7769 7468 2063 6f6e 6669 6465 6e63 6520  with confidence 
+000533d0: 696e 7465 7276 616c 2074 6f20 6c65 7665  interval to leve
+000533e0: 6c20 6f66 2025 2e31 665c 6e5c 6e27 2528  l of %.1f\n\n'%(
+000533f0: 2863 6f6e 6669 6465 6e63 655f 6c65 7665  (confidence_leve
+00053400: 6c29 2a31 3030 290d 0a09 0909 5265 7375  l)*100).....Resu
+00053410: 6c74 5f73 7472 696e 672b 3d70 6172 6466  lt_string+=pardf
+00053420: 2e74 6f5f 7374 7269 6e67 2863 6f6c 756d  .to_string(colum
+00053430: 6e73 3d5b 2776 616c 7565 272c 276c 6f77  ns=['value','low
+00053440: 6572 5f6c 696d 6974 272c 2775 7070 6572  er_limit','upper
+00053450: 5f6c 696d 6974 272c 2769 6e69 745f 7661  _limit','init_va
+00053460: 6c75 6527 2c27 7661 7279 272c 276d 696e  lue','vary','min
+00053470: 272c 276d 6178 272c 2765 7870 7227 5d29  ','max','expr'])
+00053480: 0d0a 0909 0952 6573 756c 745f 7374 7269  .....Result_stri
+00053490: 6e67 2b3d 275c 6e5c 6e54 6865 2072 6174  ng+='\n\nThe rat
+000534a0: 6573 2063 6f6e 7665 7274 6564 2074 6f20  es converted to 
+000534b0: 7469 6d65 7320 7769 7468 2075 6e69 7420  times with unit 
+000534c0: 2573 2077 6974 6820 636f 6e66 6964 656e  %s with confiden
+000534d0: 6365 2069 6e74 6572 7661 6c20 746f 206c  ce interval to l
+000534e0: 6576 656c 206f 6620 252e 3166 5c6e 5c6e  evel of %.1f\n\n
+000534f0: 2725 2873 656c 662e 6261 7365 756e 6974  '%(self.baseunit
+00053500: 2c28 636f 6e66 6964 656e 6365 5f6c 6576  ,(confidence_lev
+00053510: 656c 292a 3130 3029 0d0a 0909 0952 6573  el)*100).....Res
+00053520: 756c 745f 7374 7269 6e67 2b3d 7469 6d65  ult_string+=time
+00053530: 6466 2e74 6f5f 7374 7269 6e67 2863 6f6c  df.to_string(col
+00053540: 756d 6e73 3d5b 2776 616c 7565 272c 276c  umns=['value','l
+00053550: 6f77 6572 5f6c 696d 6974 272c 2775 7070  ower_limit','upp
+00053560: 6572 5f6c 696d 6974 272c 2769 6e69 745f  er_limit','init_
+00053570: 7661 6c75 6527 2c27 7661 7279 272c 276d  value','vary','m
+00053580: 696e 272c 276d 6178 272c 2765 7870 7227  in','max','expr'
+00053590: 5d29 0d0a 0909 656c 7365 3a0d 0a09 0909  ])....else:.....
+000535a0: 5265 7375 6c74 5f73 7472 696e 672b 3d27  Result_string+='
+000535b0: 5c6e 496e 2052 6174 6573 5c6e 5c6e 270d  \nIn Rates\n\n'.
+000535c0: 0a09 0909 5265 7375 6c74 5f73 7472 696e  ....Result_strin
+000535d0: 672b 3d70 6172 6466 2e74 6f5f 7374 7269  g+=pardf.to_stri
+000535e0: 6e67 2863 6f6c 756d 6e73 3d5b 2776 616c  ng(columns=['val
+000535f0: 7565 272c 2769 6e69 745f 7661 6c75 6527  ue','init_value'
+00053600: 2c27 7661 7279 272c 276d 696e 272c 276d  ,'vary','min','m
+00053610: 6178 272c 2765 7870 7227 5d29 0d0a 0909  ax','expr'])....
+00053620: 0952 6573 756c 745f 7374 7269 6e67 2b3d  .Result_string+=
+00053630: 275c 6e5c 6e54 6865 2072 6174 6573 2063  '\n\nThe rates c
+00053640: 6f6e 7665 7274 6564 2074 6f20 7469 6d65  onverted to time
+00053650: 7320 7769 7468 2075 6e69 7420 2573 5c6e  s with unit %s\n
+00053660: 5c6e 2725 7365 6c66 2e62 6173 6575 6e69  \n'%self.baseuni
+00053670: 740d 0a09 0909 5265 7375 6c74 5f73 7472  t.....Result_str
+00053680: 696e 672b 3d74 696d 6564 662e 746f 5f73  ing+=timedf.to_s
+00053690: 7472 696e 6728 636f 6c75 6d6e 733d 5b27  tring(columns=['
+000536a0: 7661 6c75 6527 2c27 696e 6974 5f76 616c  value','init_val
+000536b0: 7565 272c 2776 6172 7927 2c27 6d69 6e27  ue','vary','min'
+000536c0: 2c27 6d61 7827 2c27 6578 7072 275d 290d  ,'max','expr']).
+000536d0: 0a09 0969 6620 7361 6d65 5f44 4153 3a0d  ...if same_DAS:.
+000536e0: 0a09 0909 5265 7375 6c74 5f73 7472 696e  ....Result_strin
+000536f0: 672b 3d27 5c6e 5c6e 7468 6520 6f74 6865  g+='\n\nthe othe
+00053700: 7220 6f62 6a65 6374 7320 7765 7265 206c  r objects were l
+00053710: 6179 6564 2069 6e74 6f20 7365 6c66 2e6d  ayed into self.m
+00053720: 756c 7469 5f70 726f 6a65 6374 7320 6173  ulti_projects as
+00053730: 206c 6973 7420 7769 7468 2074 6865 206c   list with the l
+00053740: 6f63 616c 2072 6520 6f6e 2070 6f73 6974  ocal re on posit
+00053750: 696f 6e20 302e 5c6e 2042 7920 7265 706c  ion 0.\n By repl
+00053760: 6163 696e 6720 6173 7375 6d69 6e67 2074  acing assuming t
+00053770: 6861 7420 7365 6c66 203d 2074 6120 7772  hat self = ta wr
+00053780: 6974 653a 205c 6e20 7461 2e72 6520 3d20  ite: \n ta.re = 
+00053790: 7461 2e6d 756c 7469 5f70 726f 6a65 6374  ta.multi_project
+000537a0: 735b 315d 2061 6e64 2074 6865 6e20 7461  s[1] and then ta
+000537b0: 2e50 6c6f 745f 6669 745f 6f75 7470 7574  .Plot_fit_output
+000537c0: 2074 6f20 6c6f 6f6b 206f 6e20 7468 6520   to look on the 
+000537d0: 6f74 6865 7220 6669 7473 5c6e 2027 0d0a  other fits\n '..
+000537e0: 0909 090d 0a09 0970 7269 6e74 2852 6573  .......print(Res
+000537f0: 756c 745f 7374 7269 6e67 290d 0a09 090d  ult_string).....
+00053800: 0a09 0969 6620 6475 6d70 5f70 6172 6173  ...if dump_paras
+00053810: 3a0d 0a09 0909 7769 7468 206f 7065 6e28  :.....with open(
+00053820: 2246 6974 5f72 6573 756c 7473 5f70 7269  "Fit_results_pri
+00053830: 6e74 2e70 6172 222c 2022 7722 2920 6173  nt.par", "w") as
+00053840: 2074 6578 745f 6669 6c65 3a0d 0a09 0909   text_file:.....
+00053850: 0974 6578 745f 6669 6c65 2e77 7269 7465  .text_file.write
+00053860: 2852 6573 756c 745f 7374 7269 6e67 290d  (Result_string).
+00053870: 0a09 0909 0d0a 0909 090d 0a09 6465 6620  ............def 
+00053880: 506c 6f74 5f66 6974 5f6f 7574 7075 7428  Plot_fit_output(
+00053890: 7365 6c66 2c20 706c 6f74 7469 6e67 203d  self, plotting =
+000538a0: 2072 616e 6765 2836 292c 2070 6174 6820   range(6), path 
+000538b0: 3d20 2772 6573 756c 745f 6669 6775 7265  = 'result_figure
+000538c0: 7327 2c20 7361 7665 7479 7065 203d 2027  s', savetype = '
+000538d0: 706e 6727 2c20 0d0a 0909 0909 0909 6576  png', ........ev
+000538e0: 616c 7561 7469 6f6e 5f73 7479 6c65 203d  aluation_style =
+000538f0: 2046 616c 7365 2c20 7469 746c 6520 3d20   False, title = 
+00053900: 4e6f 6e65 2c20 7363 616c 655f 7479 7065  None, scale_type
+00053910: 203d 2027 7379 6d6c 6f67 272c 200d 0a09   = 'symlog', ...
+00053920: 0909 0909 0970 6174 6368 6573 203d 2046  .....patches = F
+00053930: 616c 7365 2c20 6669 6c65 6e61 6d65 203d  alse, filename =
+00053940: 204e 6f6e 652c 2063 6d61 7020 3d20 4e6f   None, cmap = No
+00053950: 6e65 202c 2070 7269 6e74 5f63 6c69 636b  ne , print_click
+00053960: 5f70 6f73 6974 696f 6e20 3d20 4661 6c73  _position = Fals
+00053970: 652c 0d0a 0909 0909 0909 706c 6f74 5f73  e,........plot_s
+00053980: 6563 6f6e 645f 6173 5f65 6e65 7267 7920  econd_as_energy 
+00053990: 3d20 5472 7565 293a 0d0a 0909 0909 0909  = True):........
+000539a0: 0909 0909 0909 0909 0909 0920 0d0a 0909  ........... ....
+000539b0: 2727 2770 6c6f 7473 2061 6c6c 2074 6865  '''plots all the
+000539c0: 2066 6974 206f 7574 7075 7420 6669 6775   fit output figu
+000539d0: 7265 732e 2054 6865 2066 6967 7572 6573  res. The figures
+000539e0: 2063 616e 2062 6520 6361 6c6c 6564 2073   can be called s
+000539f0: 6570 6172 6174 656c 7920 0d0a 0909 6f72  eparately ....or
+00053a00: 2077 6974 6820 6120 6c69 7374 206f 6620   with a list of 
+00053a10: 706c 6f74 732e 2065 2e67 2e20 7261 6e67  plots. e.g. rang
+00053a20: 6528 3629 2063 616c 6c20 706c 6f74 7320  e(6) call plots 
+00053a30: 302d 3520 4d61 6e75 616c 2070 6c6f 7474  0-5 Manual plott
+00053a40: 696e 6720 6f66 2063 6572 7461 696e 2074  ing of certain t
+00053a50: 7970 653a 0d0a 0909 0d0a 0909 5468 6973  ype:........This
+00053a60: 2069 7320 6120 7772 6170 7065 7220 6675   is a wrapper fu
+00053a70: 6e63 7469 6f6e 2074 6861 7420 7472 6967  nction that trig
+00053a80: 6765 7273 2074 6865 2070 6c6f 7474 696e  gers the plottin
+00053a90: 6720 6f66 2061 6c6c 2074 6865 2066 6974  g of all the fit
+00053aa0: 7465 6420 706c 6f74 732e 0d0a 0909 5468  ted plots.....Th
+00053ab0: 6520 7061 7261 6d65 7465 7220 696e 2074  e parameter in t
+00053ac0: 6869 7320 706c 6f74 2063 616c 6c20 6172  his plot call ar
+00053ad0: 6520 746f 2063 6f6e 7472 6f6c 2074 6865  e to control the
+00053ae0: 2067 656e 6572 616c 206c 6f6f 6b20 616e   general look an
+00053af0: 6420 6665 6174 7572 6573 206f 6620 7468  d features of th
+00053b00: 6520 706c 6f74 2e0d 0a09 0957 6869 6368  e plot.....Which
+00053b10: 2070 6c6f 7473 2061 7265 2070 7269 6e74   plots are print
+00053b20: 6564 2069 7320 6465 6669 6e65 6420 6279  ed is defined by
+00053b30: 2074 6865 2066 6972 7374 2063 6f6d 6d61   the first comma
+00053b40: 6e64 2028 706c 6f74 7469 6e67 290d 0a09  nd (plotting)...
+00053b50: 0954 6865 2070 6c6f 7473 2061 7265 2067  .The plots are g
+00053b60: 656e 6572 6174 6564 2066 726f 6d20 7468  enerated from th
+00053b70: 6520 6669 7474 6564 204d 6174 7269 7865  e fitted Matrixe
+00053b80: 7320 616e 6420 6173 2073 7563 6820 6f6e  s and as such on
+00053b90: 6c79 2077 696c 6c20 776f 726b 2061 6674  ly will work aft
+00053ba0: 6572 2061 2066 6974 2077 6173 2061 6374  er a fit was act
+00053bb0: 7561 6c6c 790d 0a09 0963 6f6d 706c 6574  ually....complet
+00053bc0: 6564 2028 616e 6420 7468 6520 2272 6522  ed (and the "re"
+00053bd0: 2064 6963 7469 6f6e 6172 7920 6174 7461   dictionary atta
+00053be0: 6368 6564 2074 6f20 7468 6520 6f62 6a65  ched to the obje
+00053bf0: 6374 2e29 0d0a 0909 496e 2061 6c6c 2070  ct.)....In all p
+00053c00: 6c6f 7473 2074 6865 2052 4157 2064 6174  lots the RAW dat
+00053c10: 6120 6973 2070 6c6f 7474 6564 2061 7320  a is plotted as 
+00053c20: 646f 7473 2061 6e64 2074 6865 2066 6974  dots and the fit
+00053c30: 2077 6974 6820 6c69 6e65 7320 0d0a 0909   with lines ....
+00053c40: 0d0a 0909 436f 6e74 656e 7473 206f 6620  ....Contents of 
+00053c50: 7468 6520 706c 6f74 730d 0a0d 0a09 0909  the plots.......
+00053c60: 302e 2044 4143 2063 6f6e 7461 696e 7320  0. DAC contains 
+00053c70: 7468 6520 6173 7369 676e 6564 2073 7065  the assigned spe
+00053c80: 6374 7261 2066 6f72 2065 6163 6820 636f  ctra for each co
+00053c90: 6d70 6f6e 656e 7420 6f66 2074 6865 2066  mponent of the f
+00053ca0: 6974 2e20 466f 720d 0a09 0909 2020 2061  it. For.....   a
+00053cb0: 206d 6f64 656c 6c69 6e67 2077 6974 6820   modelling with 
+00053cc0: 696e 6465 7065 6e64 656e 7420 6578 706f  independent expo
+00053cd0: 6e65 6e74 6961 6c20 6465 6361 7973 2074  nential decays t
+00053ce0: 6869 7320 636f 7272 6573 706f 6e64 7320  his corresponds 
+00053cf0: 746f 0d0a 0909 0920 2020 7468 6520 2244  to.....   the "D
+00053d00: 6563 6179 2041 7373 6f63 6961 7465 6420  ecay Associated 
+00053d10: 5370 6563 7472 6122 2028 4441 5329 2e20  Spectra" (DAS). 
+00053d20: 466f 7220 616c 6c20 6f74 6865 7220 6d6f  For all other mo
+00053d30: 6465 6c73 2074 6869 730d 0a09 0909 2020  dels this.....  
+00053d40: 2063 6f6e 7461 696e 7320 7468 6520 2253   contains the "S
+00053d50: 7065 6369 6573 2041 7373 6f63 6961 7465  pecies Associate
+00053d60: 6420 5370 6563 7472 6122 2028 5341 5329  d Spectra" (SAS)
+00053d70: 2e20 4163 636f 7264 696e 6720 746f 2074  . According to t
+00053d80: 6865 0d0a 0909 0920 2020 6d6f 6465 6c20  he.....   model 
+00053d90: 7468 6520 7365 7061 7261 7465 2073 7065  the separate spe
+00053da0: 6374 7261 2061 7265 206c 6162 656c 6564  ctra are labeled
+00053db0: 2062 7920 7469 6d65 2028 7072 6f63 6573   by time (proces
+00053dc0: 7329 206f 7220 6e61 6d65 2c20 6966 0d0a  s) or name, if..
+00053dd0: 0909 0920 2020 6120 6e61 6d65 2069 7320  ...   a name is 
+00053de0: 6173 736f 6369 6174 6564 2069 6e20 7468  associated in th
+00053df0: 6520 6669 7474 696e 6720 6d6f 6465 6c2e  e fitting model.
+00053e00: 2054 6865 2073 7065 6374 7261 2061 7265   The spectra are
+00053e10: 2073 686f 776e 2069 6e0d 0a09 0909 2020   shown in.....  
+00053e20: 2074 6865 2065 7874 7261 6374 6564 2073   the extracted s
+00053e30: 7472 656e 6774 6820 696e 2074 6865 2072  trength in the r
+00053e40: 6967 6874 2070 616e 6520 616e 6420 6e6f  ight pane and no
+00053e50: 726d 616c 697a 6564 2069 6e20 7468 6520  rmalized in the 
+00053e60: 6c65 6674 2e0d 0a09 0909 2020 2045 7874  left......   Ext
+00053e70: 7261 6374 6564 2073 7472 656e 6774 6820  racted strength 
+00053e80: 6d65 616e 7320 7468 6174 2074 6865 206d  means that the m
+00053e90: 6561 7375 7265 6420 7370 6563 7472 616c  easured spectral
+00053ea0: 2073 7472 656e 6774 6820 6973 2074 6865   strength is the
+00053eb0: 0d0a 0909 0920 2020 696e 7465 6e73 6974  .....   intensit
+00053ec0: 7920 2863 6f6e 6365 6e74 7261 7469 6f6e  y (concentration
+00053ed0: 206d 6174 7269 7829 2074 696d 6573 2074   matrix) times t
+00053ee0: 6869 7320 7370 6563 7472 616c 2073 7472  his spectral str
+00053ef0: 656e 6774 682e 2041 7320 7468 650d 0a09  ength. As the...
+00053f00: 0909 2020 2063 6f6e 6365 6e74 7261 7469  ..   concentrati
+00053f10: 6f6e 206d 6178 696d 6120 666f 7220 616c  on maxima for al
+00053f20: 6c20 4441 5320 6172 6520 3120 7468 6973  l DAS are 1 this
+00053f30: 2063 6f72 7265 7370 6f6e 6473 2074 6f20   corresponds to 
+00053f40: 7468 650d 0a09 0909 2020 2073 7065 6374  the.....   spect
+00053f50: 7261 6c20 7374 7265 6e67 7468 2066 6f72  ral strength for
+00053f60: 2074 6865 2044 4153 2e20 2870 6c65 6173   the DAS. (pleas
+00053f70: 6520 7365 6520 7468 6520 646f 6375 6d65  e see the docume
+00053f80: 6e74 6174 696f 6e20 666f 7220 7468 650d  ntation for the.
+00053f90: 0a09 0909 2020 2066 6974 7469 6e67 2061  ....   fitting a
+00053fa0: 6c67 6f72 6974 686d 2066 6f72 2066 7572  lgorithm for fur
+00053fb0: 7468 6572 2064 6574 6169 6c73 292e 0d0a  ther details)...
+00053fc0: 0d0a 0909 0931 2e20 7375 6d6d 6564 2069  .....1. summed i
+00053fd0: 6e74 656e 7369 7479 2e20 416c 6c20 7761  ntensity. All wa
+00053fe0: 7665 6c65 6e67 7468 206f 6620 7468 6520  velength of the 
+00053ff0: 7370 6563 7472 616c 2061 7869 7320 6172  spectral axis ar
+00054000: 6520 7375 6d6d 6564 2066 6f72 0d0a 0909  e summed for....
+00054010: 0920 2020 6461 7461 2061 6e64 2066 6974  .   data and fit
+00054020: 2e20 5468 6520 6461 7461 2069 7320 706c  . The data is pl
+00054030: 6f74 7465 6420 696e 2061 206e 756d 6265  otted in a numbe
+00054040: 7220 6f66 2077 6179 7320 7673 206c 696e  r of ways vs lin
+00054050: 6561 7220 616e 640d 0a09 0909 2020 206c  ear and.....   l
+00054060: 6f67 6172 6974 686d 6963 2061 7869 732e  ogarithmic axis.
+00054070: 2054 6869 7320 706c 6f74 2069 7320 6e6f   This plot is no
+00054080: 7420 6d65 6e74 2066 6f72 2070 7562 6c69  t ment for publi
+00054090: 6361 7469 6f6e 2062 7574 2076 6572 790d  cation but very.
+000540a0: 0a09 0909 2020 2075 7365 6675 6c20 746f  ....   useful to
+000540b0: 2065 7661 6c75 6174 6520 7468 6520 7175   evaluate the qu
+000540c0: 616c 6974 7920 6f66 2061 2066 6974 2e0d  ality of a fit..
+000540d0: 0a0d 0a09 0909 322e 2070 6c6f 7420 6b69  ......2. plot ki
+000540e0: 6e65 7469 6373 2066 6f72 2073 656c 6563  netics for selec
+000540f0: 7465 6420 7761 7665 6c65 6e67 7468 2028  ted wavelength (
+00054100: 7365 6520 636f 7272 6573 706f 6e64 696e  see correspondin
+00054110: 6720 5241 5720 706c 6f74 292e 0d0a 0d0a  g RAW plot).....
+00054120: 0909 0933 2e20 706c 6f74 2073 7065 6374  ...3. plot spect
+00054130: 7261 2061 7420 7365 6c65 6374 6564 2074  ra at selected t
+00054140: 696d 6573 2028 7365 6520 636f 7272 6573  imes (see corres
+00054150: 706f 6e64 696e 6720 5241 5720 706c 6f74  ponding RAW plot
+00054160: 292e 0d0a 0d0a 0909 0934 2e20 706c 6f74  )........4. plot
+00054170: 7320 6d61 7472 6978 2028 6d65 6173 7572  s matrix (measur
+00054180: 6564 2c20 6d6f 6465 6c6c 6564 2061 6e64  ed, modelled and
+00054190: 2065 7272 6f72 204d 6174 7269 7829 2e20   error Matrix). 
+000541a0: 5468 6520 7061 7261 6d65 7465 7220 6172  The parameter ar
+000541b0: 650d 0a09 0909 2020 2074 6865 2073 616d  e.....   the sam
+000541c0: 6520 6173 2075 7365 6420 666f 7220 7468  e as used for th
+000541d0: 6520 636f 7272 6573 706f 6e64 696e 6720  e corresponding 
+000541e0: 5241 5720 706c 6f74 2077 6974 6820 7468  RAW plot with th
+000541f0: 6520 6164 6469 7469 6f6e 206f 660d 0a09  e addition of...
+00054200: 0909 2020 2022 6572 726f 725f 6d61 7472  ..   "error_matr
+00054210: 6978 5f61 6d70 6c69 6669 6361 7469 6f6e  ix_amplification
+00054220: 2220 7768 6963 6820 6973 2061 2073 6361  " which is a sca
+00054230: 6c69 6e67 2066 6163 746f 7220 6d75 6c74  ling factor mult
+00054240: 6970 6c69 6564 0d0a 0909 0920 2020 6f6e  iplied.....   on
+00054250: 746f 2074 6865 2065 7272 6f72 206d 6174  to the error mat
+00054260: 7269 782e 2049 2072 6563 6f6d 6d65 6e64  rix. I recommend
+00054270: 2074 6f20 706c 6179 2077 6974 6820 6469   to play with di
+00054280: 6666 6572 656e 7420 2263 6d61 7022 2c0d  fferent "cmap",.
+00054290: 0a09 0909 2020 2022 6c6f 675f 7363 616c  ....   "log_scal
+000542a0: 6522 2061 6e64 2022 696e 7465 6e73 6974  e" and "intensit
+000542b0: 795f 7363 616c 6522 2074 6f20 6372 6561  y_scale" to crea
+000542c0: 7465 2061 2070 6c65 6173 696e 6720 706c  te a pleasing pl
+000542d0: 6f74 2e0d 0a0d 0a09 0909 352e 2063 6f6e  ot........5. con
+000542e0: 6365 6e74 7261 7469 6f6e 732e 2049 6e20  centrations. In 
+000542f0: 7468 6520 7072 6f67 7265 7373 206f 6620  the progress of 
+00054300: 7468 6520 6d6f 6465 6c6c 696e 672f 6669  the modelling/fi
+00054310: 7474 696e 6720 6120 6d61 7472 6978 2069  tting a matrix i
+00054320: 730d 0a09 0909 2020 2067 656e 6572 6174  s.....   generat
+00054330: 6564 2074 6861 7420 636f 6e74 6169 6e73  ed that contains
+00054340: 2074 6865 2072 656c 6174 6976 6520 636f   the relative co
+00054350: 6e63 656e 7472 6174 696f 6e73 206f 6620  ncentrations of 
+00054360: 7468 6520 7370 6563 6965 730d 0a09 0909  the species.....
+00054370: 2020 206d 6f64 656c 6c65 642e 2054 6869     modelled. Thi
+00054380: 7320 706c 6f74 2069 7320 7368 6f77 696e  s plot is showin
+00054390: 6720 7468 6520 7465 6d70 6f72 616c 2064  g the temporal d
+000543a0: 6576 656c 6f70 6d65 6e74 206f 6620 7468  evelopment of th
+000543b0: 6573 650d 0a09 0909 2020 2073 7065 6369  ese.....   speci
+000543c0: 6573 2e20 4675 7274 6865 7220 6465 7461  es. Further deta
+000543d0: 696c 7320 6f6e 2068 6f77 2074 6869 7320  ils on how this 
+000543e0: 6d61 7472 6978 2069 7320 6765 6e65 7261  matrix is genera
+000543f0: 7465 6420 6361 6e20 6265 2066 6f75 6e64  ted can be found
+00054400: 0d0a 0909 0920 2020 696e 2074 6865 2064  .....   in the d
+00054410: 6f63 756d 656e 7461 7469 6f6e 206f 6620  ocumentation of 
+00054420: 7468 6520 6669 7474 696e 6720 6675 6e63  the fitting func
+00054430: 7469 6f6e 2e20 5468 6520 6d6f 6465 6c65  tion. The modele
+00054440: 6420 7370 6563 7472 6120 6172 650d 0a09  d spectra are...
+00054450: 0909 2020 2074 6865 2063 6f6e 766f 6c75  ..   the convolu
+00054460: 7469 6f6e 206f 6620 7468 6573 6520 7665  tion of these ve
+00054470: 6374 6f72 7320 2867 6976 696e 6720 7468  ctors (giving th
+00054480: 6520 7469 6d65 2d64 6576 656c 6f70 6d65  e time-developme
+00054490: 6e74 2920 616e 640d 0a09 0909 2020 2074  nt) and.....   t
+000544a0: 6865 2044 4153 2f53 4153 2028 6769 7669  he DAS/SAS (givi
+000544b0: 6e67 2074 6865 2073 7065 6374 7261 6c20  ng the spectral 
+000544c0: 6465 7665 6c6f 706d 656e 7429 2e0d 0a09  development)....
+000544d0: 090d 0a09 0950 6172 616d 6574 6572 730d  .....Parameters.
+000544e0: 0a09 092d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ...-------------
+000544f0: 2d2d 0d0a 0909 0d0a 0909 706c 6f74 7469  --........plotti
+00054500: 6e67 203a 2069 6e74 206f 7220 6974 6572  ng : int or iter
+00054510: 6162 6c65 2028 6f66 2069 6e74 6567 6572  able (of integer
+00054520: 7329 2c20 6f70 7469 6f6e 616c 0d0a 0909  s), optional....
+00054530: 0954 6869 7320 7061 7261 6d65 7465 7220  .This parameter 
+00054540: 6465 7465 726d 696e 6573 2077 6869 6368  determines which
+00054550: 2066 6967 7572 6573 2061 7265 2070 6c6f   figures are plo
+00054560: 7474 6564 200d 0a09 0909 7468 6520 6669  tted .....the fi
+00054570: 6775 7265 7320 6361 6e20 6265 2063 616c  gures can be cal
+00054580: 6c65 6420 7365 7061 7261 7465 6c79 2077  led separately w
+00054590: 6974 6820 706c 6f74 7469 6e67 203d 2031  ith plotting = 1
+000545a0: 0d0a 0909 096f 7220 7769 7468 2061 206c  .....or with a l
+000545b0: 6973 7420 6f66 2070 6c6f 7473 2028 4465  ist of plots (De
+000545c0: 6661 756c 7429 2065 2e67 2e20 706c 6f74  fault) e.g. plot
+000545d0: 7469 6e67 3d72 616e 6765 2836 2920 6361  ting=range(6) ca
+000545e0: 6c6c 7320 706c 6f74 7320 302c 312c 322c  lls plots 0,1,2,
+000545f0: 332c 342c 350d 0a09 0909 5468 6520 706c  3,4,5.....The pl
+00054600: 6f74 7320 6861 7665 2074 6865 2066 6f6c  ots have the fol
+00054610: 6c6f 7769 6e67 206e 756d 6265 7273 3a0d  lowing numbers:.
+00054620: 0a09 0909 0d0a 0909 0909 302e 2044 4153  ..........0. DAS
+00054630: 206f 7220 5341 530d 0a09 0909 0931 2e20   or SAS......1. 
+00054640: 7375 6d6d 6564 2069 6e74 656e 7369 7479  summed intensity
+00054650: 0d0a 0909 0909 322e 204b 696e 6574 6963  ......2. Kinetic
+00054660: 730d 0a09 0909 0933 2e20 5370 6563 7472  s......3. Spectr
+00054670: 610d 0a09 0909 0934 2e20 4d61 7472 6978  a......4. Matrix
+00054680: 6573 0d0a 0909 0909 352e 2043 6f6e 6365  es......5. Conce
+00054690: 6e74 7261 7469 6f6e 7320 2874 6865 2063  ntrations (the c
+000546a0: 2d6f 626a 6563 7429 0d0a 0909 090d 0a09  -object)........
+000546b0: 0909 5468 6520 706c 6f74 7469 6e67 2074  ..The plotting t
+000546c0: 616b 6573 2061 6c6c 2070 6172 616d 6574  akes all paramet
+000546d0: 6572 2066 726f 6d20 7468 6520 2274 6122  er from the "ta"
+000546e0: 206f 626a 6563 7420 756e 6c65 7373 206f   object unless o
+000546f0: 7468 6572 7769 7365 2073 7065 6369 6669  therwise specifi
+00054700: 6564 0d0a 0909 0d0a 0909 7061 7468 203a  ed........path :
+00054710: 204e 6f6e 652c 2073 7472 206f 7220 7061   None, str or pa
+00054720: 7468 206f 626a 6563 742c 206f 7074 696f  th object, optio
+00054730: 6e61 6c0d 0a09 0909 5468 6973 2064 6566  nal.....This def
+00054740: 696e 6573 2077 6865 7265 2074 6865 2066  ines where the f
+00054750: 696c 6573 2061 7265 2073 6176 6564 2069  iles are saved i
+00054760: 6620 7468 6520 7361 6665 5f66 6967 7572  f the safe_figur
+00054770: 6573 5f74 6f5f 666f 6c64 6572 2070 6172  es_to_folder par
+00054780: 616d 6574 6572 2069 7320 5472 7565 2c20  ameter is True, 
+00054790: 0d0a 0909 0971 7569 7465 2075 7365 6675  .....quite usefu
+000547a0: 6c20 6966 2061 206c 6f74 206f 6620 6461  l if a lot of da
+000547b0: 7461 2073 6574 7320 6172 6520 746f 2062  ta sets are to b
+000547c0: 6520 7072 696e 7465 6420 6661 7374 2e20  e printed fast. 
+000547d0: 0d0a 0909 0949 6620 6120 7061 7468 2069  .....If a path i
+000547e0: 7320 6769 7665 6e2c 2074 6869 7320 6973  s given, this is
+000547f0: 2075 7365 642e 2049 6620 6120 7374 7269   used. If a stri
+00054800: 6e67 206c 696b 6520 7468 6520 2844 6566  ng like the (Def
+00054810: 6175 6c74 2920 2272 6573 756c 745f 6669  ault) "result_fi
+00054820: 6775 7265 7322 2069 7320 6769 7665 6e2c  gures" is given,
+00054830: 200d 0a09 0909 7468 656e 2061 2073 7562   .....then a sub
+00054840: 666f 6c64 6572 206f 6620 7468 6973 206e  folder of this n
+00054850: 616d 6520 7769 6c6c 2062 6520 7573 6564  ame will be used
+00054860: 2028 616e 2067 656e 6572 6174 6564 2069   (an generated i
+00054870: 6620 6e65 6365 7373 6172 7929 200d 0a09  f necessary) ...
+00054880: 0909 7265 6c61 7469 7665 2074 6f20 7365  ..relative to se
+00054890: 6c66 2e70 6174 682e 2055 7365 2061 6e64  lf.path. Use and
+000548a0: 2065 6d70 7479 2073 7472 696e 6720 746f   empty string to
+000548b0: 2075 7365 2074 6865 2073 656c 662e 7061   use the self.pa
+000548c0: 7468 0d0a 0909 0949 6620 7365 7420 746f  th.....If set to
+000548d0: 204e 6f6e 652c 2074 6865 206c 6f63 6174   None, the locat
+000548e0: 696f 6e20 6f66 2074 6865 2070 6c6f 745f  ion of the plot_
+000548f0: 6675 6e63 2077 696c 6c20 6265 2075 7365  func will be use
+00054900: 6420 616e 640d 0a09 0909 6120 7375 6266  d and.....a subf
+00054910: 6f6c 6465 7220 7769 7468 2074 6974 6c65  older with title
+00054920: 2022 7265 7375 6c74 5f66 6967 7572 6573   "result_figures
+00054930: 2220 6265 2067 656e 6572 6174 6564 2068  " be generated h
+00054940: 6572 650d 0a09 090d 0a09 0973 6176 6574  ere........savet
+00054950: 7970 6520 3a20 7374 7220 6f72 2069 7465  ype : str or ite
+00054960: 7261 626c 6520 286f 6620 7374 7229 2c20  rable (of str), 
+00054970: 6f70 7469 6f6e 616c 200d 0a09 0909 6d61  optional .....ma
+00054980: 7470 6c6f 746c 6962 2061 6c6c 6f77 7320  tplotlib allows 
+00054990: 7468 6520 7361 7669 6e67 206f 6620 6669  the saving of fi
+000549a0: 6775 7265 7320 696e 2076 6172 696f 7573  gures in various
+000549b0: 2066 6f72 6d61 7473 2e20 2844 6566 6175   formats. (Defau
+000549c0: 6c74 2920 2270 6e67 222c 200d 0a09 0909  lt) "png", .....
+000549d0: 7479 7069 6361 6c20 616e 6420 7265 636f  typical and reco
+000549e0: 6d6d 656e 6461 626c 6520 6f70 7469 6f6e  mmendable option
+000549f0: 7320 6172 6520 2273 7667 2220 616e 6420  s are "svg" and 
+00054a00: 2270 6466 222e 2020 0d0a 0909 090d 0a09  "pdf".  ........
+00054a10: 0965 7661 6c75 6174 696f 6e5f 7374 796c  .evaluation_styl
+00054a20: 6520 3a20 626f 6f6c 2c20 6f70 7469 6f6e  e : bool, option
+00054a30: 616c 0d0a 0909 0954 7275 6520 2844 6566  al.....True (Def
+00054a40: 6175 6c74 203d 2046 616c 7365 2920 6164  ault = False) ad
+00054a50: 6473 2061 206c 6f74 206f 6620 6578 7472  ds a lot of extr
+00054a60: 6120 696e 666f 726d 6174 696f 6e20 696e  a information in
+00054a70: 2074 6865 2070 6c6f 740d 0a09 090d 0a09   the plot.......
+00054a80: 0974 6974 6c65 203a 204e 6f6e 6520 6f72  .title : None or
+00054a90: 2073 7472 2c20 6f70 7469 6f6e 616c 0d0a   str, optional..
+00054aa0: 0909 2020 2022 7469 746c 653d 4e6f 6e65  ..   "title=None
+00054ab0: 2220 6973 2069 6e20 6765 6e65 7261 6c20  " is in general 
+00054ac0: 7468 6520 6669 6c65 6e61 6d65 2074 6861  the filename tha
+00054ad0: 7420 7761 7320 6c6f 6164 6564 2e20 5365  t was loaded. Se
+00054ae0: 7474 696e 6720 610d 0a09 0920 2020 7370  tting a....   sp
+00054af0: 6563 6966 6963 2074 6974 6c65 2077 696c  ecific title wil
+00054b00: 6c20 6265 2075 7365 6420 696e 2061 6c6c  l be used in all
+00054b10: 2070 6c6f 7473 2e20 546f 2072 656d 6f76   plots. To remov
+00054b20: 6520 7468 6520 7469 746c 6520 616c 6c0d  e the title all.
+00054b30: 0a09 0920 2020 746f 6765 7468 6572 2073  ...   together s
+00054b40: 6574 2061 6e20 656d 7074 7920 7374 7269  et an empty stri
+00054b50: 6e67 2077 6974 6820 7469 746c 653d 2222  ng with title=""
+00054b60: 0d0a 0909 2020 200d 0a09 0973 6361 6c65  ....   ....scale
+00054b70: 5f74 7970 6520 3a20 7374 722c 206f 7074  _type : str, opt
+00054b80: 696f 6e61 6c0d 0a09 0920 2020 7265 6665  ional....   refe
+00054b90: 7273 2074 6f20 7468 6520 7469 6d65 2d61  rs to the time-a
+00054ba0: 7869 7320 616e 6420 7461 6b65 732c 2022  xis and takes, "
+00054bb0: 7379 6d6c 6f67 2220 2844 6566 6175 6c74  symlog" (Default
+00054bc0: 2928 6c69 6e65 6172 2061 726f 756e 6420  )(linear around 
+00054bd0: 7a65 726f 2061 6e64 206c 6f67 6172 6974  zero and logarit
+00054be0: 686d 6963 206f 7468 6572 7769 7365 290d  hmic otherwise).
+00054bf0: 0a09 0920 2020 616e 6420 226c 696e 2220  ...   and "lin" 
+00054c00: 666f 7220 6c69 6e65 6172 2061 6e64 2020  for linear and  
+00054c10: 226c 6f67 2220 666f 7220 6c6f 6761 7269  "log" for logari
+00054c20: 7468 6d69 632c 2073 7769 7463 6869 6e67  thmic, switching
+00054c30: 2061 6c6c 2074 6865 2074 696d 6520 6178   all the time ax
+00054c40: 6973 2074 6f20 7468 6973 2074 7970 650d  is to this type.
+00054c50: 0a09 090d 0a09 0970 6174 6368 6573 203a  .......patches :
+00054c60: 2062 6f6f 6c2c 206f 7074 696f 6e61 6c0d   bool, optional.
+00054c70: 0a09 0909 4966 2046 616c 7365 2028 4465  ....If False (De
+00054c80: 6661 756c 7429 2074 6865 206e 616d 6573  fault) the names
+00054c90: 2022 6d65 6173 7572 6564 2220 2266 6974   "measured" "fit
+00054ca0: 7465 6422 2022 6469 6666 6572 656e 6365  ted" "difference
+00054cb0: 2220 7769 6c6c 2062 6520 706c 6163 6564  " will be placed
+00054cc0: 2061 626f 7665 2074 6865 2069 6d61 6765   above the image
+00054cd0: 732e 0d0a 0909 0949 6620 5472 7565 2c20  s......If True, 
+00054ce0: 7468 656e 2074 6865 7920 7769 6c6c 2062  then they will b
+00054cf0: 6520 696e 636c 7564 6564 2069 6e74 6f20  e included into 
+00054d00: 7468 6520 696d 6167 6520 2864 656e 7365  the image (dense
+00054d10: 7229 0d0a 0d0a 0909 6669 6c65 6e61 6d65  r)......filename
+00054d20: 203a 2073 7472 2c20 6f70 7469 6f6e 616c   : str, optional
+00054d30: 0d0a 0909 096f 6666 6572 7320 746f 2072  .....offers to r
+00054d40: 6570 6c61 6365 2074 6865 2062 6173 652d  eplace the base-
+00054d50: 6e61 6d65 2075 7365 6420 666f 7220 616c  name used for al
+00054d60: 6c20 706c 6f74 7320 2874 6f20 652e 672e  l plots (to e.g.
+00054d70: 7370 6563 6966 7920 7768 6174 2073 616d  specify what sam
+00054d80: 706c 6520 7761 7320 7573 6564 292e 200d  ple was used). .
+00054d90: 0a09 0909 6966 2028 4465 6661 756c 7429  ....if (Default)
+00054da0: 204e 6f6e 6520 6973 2075 7365 642c 2074   None is used, t
+00054db0: 6865 2073 656c 662e 6669 6c65 6e61 6d65  he self.filename
+00054dc0: 2069 7320 7573 6564 2061 7320 6120 6261   is used as a ba
+00054dd0: 7365 206e 616d 652e 2054 6865 2066 696c  se name. The fil
+00054de0: 656e 616d 6520 706c 6179 7320 6f6e 6c79  ename plays only
+00054df0: 2061 200d 0a09 0909 726f 6c65 2064 7572   a .....role dur
+00054e00: 696e 6720 7361 7669 6e67 2c20 6173 2064  ing saving, as d
+00054e10: 6f65 7320 7468 6520 7061 7468 2061 6e64  oes the path and
+00054e20: 2073 6176 6574 7970 6509 0d0a 0909 090d   savetype.......
+00054e30: 0a09 0963 6d61 7020 3a20 4e6f 6e65 206f  ...cmap : None o
+00054e40: 7220 6d61 7470 6c6f 746c 6962 2063 6f6c  r matplotlib col
+00054e50: 6f72 206d 6170 2c20 6f70 7469 6f6e 616c  or map, optional
+00054e60: 0d0a 0909 0969 7320 6120 706f 7765 7266  .....is a powerf
+00054e70: 756c 6c20 7661 7269 6162 6c65 2074 6861  ull variable tha
+00054e80: 7420 6368 6f6f 7365 7320 7468 6520 636f  t chooses the co
+00054e90: 6c6f 7572 206d 6170 2061 7070 6c69 6564  lour map applied
+00054ea0: 2066 6f72 2061 6c6c 2070 6c6f 7473 2e20   for all plots. 
+00054eb0: 4966 2073 6574 2074 6f20 0d0a 0909 094e  If set to .....N
+00054ec0: 6f6e 6520 2844 6566 6175 6c74 2920 7468  one (Default) th
+00054ed0: 656e 2074 6865 2073 656c 662e 636d 6170  en the self.cmap
+00054ee0: 2069 7320 7573 6564 2e0d 0a09 0909 4173   is used......As
+00054ef0: 2073 7461 6e64 6172 6420 4920 7573 6520   standard I use 
+00054f00: 7468 6520 636f 6c6f 7220 6d61 7020 226a  the color map "j
+00054f10: 6574 2220 6672 6f6d 206d 6174 706c 6f74  et" from matplot
+00054f20: 6c69 622e 2054 6865 7265 2061 7265 2061  lib. There are a
+00054f30: 2076 6172 6965 7479 206f 6620 636f 6c6f   variety of colo
+00054f40: 726d 6170 7320 0d0a 0909 0961 7661 696c  rmaps .....avail
+00054f50: 6162 6c65 2074 6861 7420 6172 6520 7665  able that are ve
+00054f60: 7279 2075 7365 6675 6c6c 2e20 4265 7369  ry usefull. Besi
+00054f70: 6465 2022 6a65 7422 2c20 2276 6972 6964  de "jet", "virid
+00054f80: 6973 2220 6973 2061 2067 6f6f 6420 6368  is" is a good ch
+00054f90: 6f69 6365 2061 7320 6974 2069 7320 7765  oice as it is we
+00054fa0: 6c6c 200d 0a09 0909 7669 7369 626c 6520  ll .....visible 
+00054fb0: 756e 6465 7220 7265 642d 6772 6565 6e20  under red-green 
+00054fc0: 626c 696e 646e 6573 732e 204f 7468 6572  blindness. Other
+00054fd0: 2075 7365 6675 6c20 6d61 7073 2061 7265   useful maps are
+00054fe0: 2022 7072 6973 6d22 2066 6f72 2068 6967   "prism" for hig
+00054ff0: 6820 666c 7563 7475 6174 696f 6e73 200d  h fluctuations .
+00055000: 0a09 0909 6f72 2064 6976 6572 6769 6e67  ....or diverging
+00055010: 2063 6f6c 6f72 206d 6170 7320 6c69 6b65   color maps like
+00055020: 2022 7365 6973 6d69 6322 2e20 0d0a 0909   "seismic". ....
+00055030: 0953 6565 2068 7474 7073 3a2f 2f6d 6174  .See https://mat
+00055040: 706c 6f74 6c69 622e 6f72 672f 332e 312e  plotlib.org/3.1.
+00055050: 302f 7475 746f 7269 616c 732f 636f 6c6f  0/tutorials/colo
+00055060: 7273 2f63 6f6c 6f72 6d61 7073 2e68 746d  rs/colormaps.htm
+00055070: 6c20 666f 7220 6120 636f 6d70 7265 6865  l for a comprehe
+00055080: 6e73 6976 6520 0d0a 0909 0973 656c 6563  nsive .....selec
+00055090: 7469 6f6e 2e20 496e 2074 6865 2063 6f64  tion. In the cod
+000550a0: 6520 7468 6520 636f 6c6f 726d 6170 7320  e the colormaps 
+000550b0: 6172 6520 696d 706f 7274 6564 2073 6f20  are imported so 
+000550c0: 6966 2070 6c6f 745f 6675 6e63 2069 7320  if plot_func is 
+000550d0: 696d 706f 7274 6564 2061 7320 7066 2074  imported as pf t
+000550e0: 6865 6e20 0d0a 0909 0973 656c 662e 636d  hen .....self.cm
+000550f0: 6170 3d70 662e 636d 2e76 6972 6964 6973  ap=pf.cm.viridis
+00055100: 2073 6574 7320 7669 7269 6469 7320 6173   sets viridis as
+00055110: 2074 6865 206d 6170 2074 6f20 7573 652e   the map to use.
+00055120: 2049 6e74 6572 6e61 6c6c 7920 7468 6520   Internally the 
+00055130: 636f 6c6f 7273 2061 7265 2063 686f 7365  colors are chose
+00055140: 6e20 0d0a 0909 0977 6974 6820 7468 6520  n .....with the 
+00055150: 2263 6f6c 6d22 2066 756e 6374 696f 6e2e  "colm" function.
+00055160: 2054 6865 2032 6420 706c 6f74 7320 7265   The 2d plots re
+00055170: 7175 6972 6520 6120 636f 6e74 696e 756f  quire a continuo
+00055180: 7573 2063 6f6c 6f72 206d 6170 2073 6f20  us color map so 
+00055190: 6966 2073 6f6d 6574 6869 6e67 200d 0a09  if something ...
+000551a0: 0909 656c 7365 2069 7320 6769 7665 2032  ..else is give 2
+000551b0: 6420 706c 6f74 7320 6172 6520 7368 6f77  d plots are show
+000551c0: 6e20 6175 746f 6d61 7469 6361 6c6c 7920  n automatically 
+000551d0: 7769 7468 2022 6a65 7422 2e20 466f 7220  with "jet". For 
+000551e0: 616c 6c20 6f66 2074 6865 2031 6420 706c  all of the 1d pl
+000551f0: 6f74 7320 686f 7765 7665 7220 0d0a 0909  ots however ....
+00055200: 0949 2066 6972 7374 2073 656c 6563 7420  .I first select 
+00055210: 6120 6e75 6d62 6572 206f 6620 636f 6c6f  a number of colo
+00055220: 7273 2062 6566 6f72 6520 6561 6368 2070  rs before each p
+00055230: 6c6f 742e 2049 6620 636d 6170 2069 7320  lot. If cmap is 
+00055240: 6120 636f 6e74 696e 6f75 7320 6d61 7020  a continous map 
+00055250: 7468 656e 2074 6865 7365 0d0a 0909 0961  then these.....a
+00055260: 7265 2073 616d 706c 6564 2065 7665 6e6c  re sampled evenl
+00055270: 7920 6f76 6572 2074 6865 2063 6f6c 6f75  y over the colou
+00055280: 726d 6170 2e20 4d61 6e75 616c 2069 7465  rmap. Manual ite
+00055290: 7261 626c 6573 206f 6620 636f 6c6f 7572  rables of colour
+000552a0: 7320 0d0a 0909 0963 6d61 703d 5b28 312c  s .....cmap=[(1,
+000552b0: 302c 3029 2c28 302c 312c 3029 2c28 302c  0,0),(0,1,0),(0,
+000552c0: 302c 3129 2c2e 2e2e 5d20 6172 6520 616c  0,1),...] are al
+000552d0: 736f 2061 6363 6570 7465 642c 2061 7320  so accepted, as 
+000552e0: 6172 6520 7665 6374 6f72 7320 6f72 2064  are vectors or d
+000552f0: 6174 6166 7261 6d65 7320 7468 6174 200d  ataframes that .
+00055300: 0a09 0909 636f 6e74 6169 6e20 6173 2072  ....contain as r
+00055310: 6f77 7320 7468 6520 636f 6c6f 7273 2e20  ows the colors. 
+00055320: 5468 6572 6520 6d75 7374 2062 6520 6f66  There must be of
+00055330: 2063 6f75 7273 6520 7375 6666 6963 6965   course sufficie
+00055340: 6e74 2063 6f6c 6f72 7320 7072 6573 656e  nt colors presen
+00055350: 7420 666f 7220 0d0a 0909 0974 6865 206e  t for .....the n
+00055360: 756d 6265 7273 206f 6620 6c69 6e65 7320  umbers of lines 
+00055370: 7468 6174 2077 696c 6c20 6265 2070 6c6f  that will be plo
+00055380: 7474 6564 2e20 536f 2049 2072 6563 6f6d  tted. So I recom
+00055390: 6d65 6e64 2074 6f20 7072 6f76 6964 6520  mend to provide 
+000553a0: 6174 206c 6561 7374 2031 3020 636f 6c6f  at least 10 colo
+000553b0: 7572 7320 0d0a 0909 0928 652e 672e 796f  urs .....(e.g.yo
+000553c0: 7572 2075 6e69 7665 7273 6974 7920 636f  ur university co
+000553d0: 6c6f 7273 292e 2063 6f6c 6f75 7273 2061  lors). colours a
+000553e0: 7265 2061 6c77 6179 7320 6769 7665 6e20  re always given 
+000553f0: 6173 2061 2c20 6c69 7374 206f 7220 7475  as a, list or tu
+00055400: 706c 6520 7769 7468 2052 4741 206f 7220  ple with RGA or 
+00055410: 5247 4241 0d0a 0909 0928 7769 7468 2074  RGBA.....(with t
+00055420: 6865 206c 6173 7420 4120 6265 6569 6e67  he last A beeing
+00055430: 2074 6865 2041 6c70 6861 3d74 7261 6e73   the Alpha=trans
+00055440: 7061 7265 6e63 792e 2041 6c6c 206e 756d  parency. All num
+00055450: 6265 7273 2061 7265 2062 6574 7765 656e  bers are between
+00055460: 2030 2061 6e64 2031 2e20 0d0a 0909 0949   0 and 1. .....I
+00055470: 6620 6120 6c69 7374 2f76 6563 746f 722f  f a list/vector/
+00055480: 4461 7461 4672 616d 6520 6973 2067 6976  DataFrame is giv
+00055490: 656e 2066 6f72 2074 6865 2063 6f6c 6f75  en for the colou
+000554a0: 7273 2074 6865 7920 7769 6c6c 2062 6520  rs they will be 
+000554b0: 7573 6564 2069 6e20 7468 6520 6f72 6465  used in the orde
+000554c0: 7220 7072 6f76 6964 6564 2e09 090d 0a09  r provided......
+000554d0: 090d 0a09 0970 7269 6e74 5f63 6c69 636b  .....print_click
+000554e0: 5f70 6f73 6974 696f 6e20 3a20 626f 6f6c  _position : bool
+000554f0: 2c20 6f70 7469 6f6e 616c 0d0a 0909 0969  , optional.....i
+00055500: 6620 5472 7565 2074 6865 6e20 7468 6520  f True then the 
+00055510: 636c 6963 6b20 706f 7369 7469 6f6e 2069  click position i
+00055520: 7320 7072 696e 7465 6420 666f 7220 7468  s printed for th
+00055530: 6520 7370 6563 7472 616c 2070 6c6f 7473  e spectral plots
+00055540: 200d 0a09 090d 0a09 0945 7861 6d70 6c65   ........Example
+00055550: 730d 0a09 092d 2d2d 2d2d 2d2d 2d2d 2d2d  s....-----------
+00055560: 2d0d 0a09 090d 0a09 0954 7970 6963 616c  -........Typical
+00055570: 6c79 206f 6e65 2077 6f75 6c64 2063 616c  ly one would cal
+00055580: 6c20 7468 6973 2066 756e 6374 696f 6e20  l this function 
+00055590: 656d 7074 7920 666f 7220 616e 206f 7665  empty for an ove
+000555a0: 7276 6965 773a 0d0a 0909 4166 7465 7220  rview:....After 
+000555b0: 7468 6520 6d69 6e69 6d75 6d20 6669 740d  the minimum fit.
+000555c0: 0a09 090d 0a09 093e 3e3e 2074 613d 7066  .......>>> ta=pf
+000555d0: 2e54 4128 2774 6573 7466 696c 652e 5349  .TA('testfile.SI
+000555e0: 4127 290d 0a09 093e 3e3e 2074 612e 7061  A')....>>> ta.pa
+000555f0: 723d 6c6d 6669 742e 5061 7261 6d65 7465  r=lmfit.Paramete
+00055600: 7273 2829 0d0a 0909 3e3e 3e20 7461 2e70  rs()....>>> ta.p
+00055610: 6172 2e61 6464 2827 6b30 272c 7661 6c75  ar.add('k0',valu
+00055620: 653d 312f 302e 312c 7661 7279 3d54 7275  e=1/0.1,vary=Tru
+00055630: 6529 0d0a 0909 3e3e 3e20 7461 2e46 6974  e)....>>> ta.Fit
+00055640: 5f47 6c6f 6261 6c28 290d 0a09 090d 0a09  _Global().......
+00055650: 094f 6e65 2075 7375 616c 6c79 2070 6c6f  .One usually plo
+00055660: 7473 2074 6865 2061 6e20 6f76 6572 7669  ts the an overvi
+00055670: 6577 0d0a 0909 0d0a 0909 3e3e 3e20 7461  ew........>>> ta
+00055680: 2e50 6c6f 745f 6669 745f 6f75 7470 7574  .Plot_fit_output
+00055690: 2829 0d0a 0909 3e3e 3e20 7461 2e50 6c6f  ()....>>> ta.Plo
+000556a0: 745f 6669 745f 6f75 7470 7574 2870 6c6f  t_fit_output(plo
+000556b0: 7474 696e 673d 7261 6e67 6528 3629 2920  tting=range(6)) 
+000556c0: 2369 7320 7468 6520 7361 6d65 2061 7320  #is the same as 
+000556d0: 6265 666f 7265 0d0a 0909 3e3e 3e20 7461  before....>>> ta
+000556e0: 2e50 6c6f 745f 6669 745f 6f75 7470 7574  .Plot_fit_output
+000556f0: 2832 2920 2377 6f75 6c64 2070 6c6f 7420  (2) #would plot 
+00055700: 6f6e 6c79 2074 6865 206b 696e 6574 6963  only the kinetic
+00055710: 730d 0a09 093e 3e3e 2074 612e 506c 6f74  s....>>> ta.Plot
+00055720: 5f66 6974 5f6f 7574 7075 7428 706c 6f74  _fit_output(plot
+00055730: 7469 6e67 203d 2032 2920 2377 6f75 6c64  ting = 2) #would
+00055740: 2070 6c6f 7420 6f6e 6c79 2074 6865 206b   plot only the k
+00055750: 696e 6574 6963 730d 0a09 0909 090d 0a0d  inetics.........
+00055760: 0a09 0927 2727 0d0a 0909 7472 793a 0d0a  ...'''....try:..
+00055770: 0909 0972 653d 7365 6c66 2e72 650d 0a09  ...re=self.re...
+00055780: 0965 7863 6570 743a 0d0a 0909 0970 7269  .except:.....pri
+00055790: 6e74 2827 5765 206e 6565 6420 746f 2068  nt('We need to h
+000557a0: 6176 6520 6669 7474 6564 2073 6f6d 6574  ave fitted somet
+000557b0: 6869 6e67 2073 6f20 7468 6174 2077 6520  hing so that we 
+000557c0: 6361 6e20 706c 6f74 2729 0d0a 0909 0972  can plot').....r
+000557d0: 6574 7572 6e20 4661 6c73 650d 0a09 0970  eturn False....p
+000557e0: 6174 683d 6368 6563 6b5f 666f 6c64 6572  ath=check_folder
+000557f0: 2870 6174 683d 7061 7468 2c63 7572 7265  (path=path,curre
+00055800: 6e74 5f70 6174 683d 7365 6c66 2e70 6174  nt_path=self.pat
+00055810: 6829 0d0a 0909 6966 2073 656c 662e 7361  h)....if self.sa
+00055820: 7665 5f66 6967 7572 6573 5f74 6f5f 666f  ve_figures_to_fo
+00055830: 6c64 6572 3a0d 0a09 0909 7365 6c66 2e66  lder:.....self.f
+00055840: 6967 7572 655f 7061 7468 3d70 6174 680d  igure_path=path.
+00055850: 0a09 0969 6620 636d 6170 2069 7320 4e6f  ...if cmap is No
+00055860: 6e65 3a63 6d61 703d 7365 6c66 2e63 6d61  ne:cmap=self.cma
+00055870: 700d 0a09 0969 6620 6669 6c65 6e61 6d65  p....if filename
+00055880: 2069 7320 4e6f 6e65 3a66 696c 656e 616d   is None:filenam
+00055890: 653d 7365 6c66 2e66 696c 656e 616d 650d  e=self.filename.
+000558a0: 0a09 0969 6620 7469 746c 6520 6973 204e  ...if title is N
+000558b0: 6f6e 653a 0d0a 0909 0969 6620 6669 6c65  one:.....if file
+000558c0: 6e61 6d65 2069 7320 4e6f 6e65 3a0d 0a09  name is None:...
+000558d0: 0909 0974 6974 6c65 3d73 656c 662e 6669  ...title=self.fi
+000558e0: 6c65 6e61 6d65 0d0a 0909 0965 6c73 653a  lename.....else:
+000558f0: 0d0a 0909 0909 7469 746c 653d 6669 6c65  ......title=file
+00055900: 6e61 6d65 0d0a 0909 6966 206e 6f74 2068  name....if not h
+00055910: 6173 6174 7472 2870 6c6f 7474 696e 672c  asattr(plotting,
+00055920: 225f 5f69 7465 725f 5f22 293a 706c 6f74  "__iter__"):plot
+00055930: 7469 6e67 3d5b 706c 6f74 7469 6e67 5d0d  ting=[plotting].
+00055940: 0a09 0970 6c6f 745f 6669 745f 6f75 7470  ...plot_fit_outp
+00055950: 7574 2873 656c 662e 7265 2c20 7365 6c66  ut(self.re, self
+00055960: 2e64 732c 2063 6d61 7020 3d20 7365 6c66  .ds, cmap = self
+00055970: 2e63 6d61 702c 2070 6c6f 7474 696e 6720  .cmap, plotting 
+00055980: 3d20 706c 6f74 7469 6e67 2c20 7469 746c  = plotting, titl
+00055990: 6520 3d20 7469 746c 652c 200d 0a09 0909  e = title, .....
+000559a0: 0909 0970 6174 6820 3d20 7061 7468 2c20  ...path = path, 
+000559b0: 6620 3d20 6669 6c65 6e61 6d65 2c20 696e  f = filename, in
+000559c0: 7465 6e73 6974 795f 7261 6e67 6520 3d20  tensity_range = 
+000559d0: 7365 6c66 2e69 6e74 656e 7369 7479 5f72  self.intensity_r
+000559e0: 616e 6765 2c20 0d0a 0909 0909 0909 6c6f  ange, ........lo
+000559f0: 675f 7363 616c 6520 3d20 7365 6c66 2e6c  g_scale = self.l
+00055a00: 6f67 5f73 6361 6c65 2c20 6261 7365 756e  og_scale, baseun
+00055a10: 6974 203d 2073 656c 662e 6261 7365 756e  it = self.baseun
+00055a20: 6974 2c20 7469 6d65 6c69 6d69 7473 203d  it, timelimits =
+00055a30: 2073 656c 662e 7469 6d65 6c69 6d69 7473   self.timelimits
+00055a40: 2c20 0d0a 0909 0909 0909 7363 6174 7465  , ........scatte
+00055a50: 7263 7574 203d 2073 656c 662e 7363 6174  rcut = self.scat
+00055a60: 7465 7263 7574 2c20 626f 7264 6572 6375  tercut, bordercu
+00055a70: 7420 3d20 7365 6c66 2e62 6f72 6465 7263  t = self.borderc
+00055a80: 7574 2c20 0d0a 0909 0909 0909 6572 726f  ut, ........erro
+00055a90: 725f 6d61 7472 6978 5f61 6d70 6c69 6669  r_matrix_amplifi
+00055aa0: 6361 7469 6f6e 203d 2073 656c 662e 6572  cation = self.er
+00055ab0: 726f 725f 6d61 7472 6978 5f61 6d70 6c69  ror_matrix_ampli
+00055ac0: 6669 6361 7469 6f6e 2c20 0d0a 0909 0909  fication, ......
+00055ad0: 0909 7761 7665 5f6e 6d5f 6269 6e20 3d20  ..wave_nm_bin = 
+00055ae0: 7365 6c66 2e77 6176 655f 6e6d 5f62 696e  self.wave_nm_bin
+00055af0: 2c20 7265 6c5f 7761 7665 203d 2073 656c  , rel_wave = sel
+00055b00: 662e 7265 6c5f 7761 7665 2c20 7769 6474  f.rel_wave, widt
+00055b10: 6820 3d20 7365 6c66 2e77 6176 656c 656e  h = self.wavelen
+00055b20: 6774 685f 6269 6e2c 200d 0a09 0909 0909  gth_bin, .......
+00055b30: 0972 656c 5f74 696d 6520 3d20 7365 6c66  .rel_time = self
+00055b40: 2e72 656c 5f74 696d 652c 2073 6176 655f  .rel_time, save_
+00055b50: 6669 6775 7265 735f 746f 5f66 6f6c 6465  figures_to_folde
+00055b60: 7220 3d20 7365 6c66 2e73 6176 655f 6669  r = self.save_fi
+00055b70: 6775 7265 735f 746f 5f66 6f6c 6465 722c  gures_to_folder,
+00055b80: 200d 0a09 0909 0909 096c 6f67 5f66 6974   ........log_fit
+00055b90: 203d 2073 656c 662e 6c6f 675f 6669 742c   = self.log_fit,
+00055ba0: 6d6f 6420 3d20 7365 6c66 2e6d 6f64 2c20  mod = self.mod, 
+00055bb0: 7361 7665 7479 7065 203d 2073 6176 6574  savetype = savet
+00055bc0: 7970 652c 200d 0a09 0909 0909 0974 696d  ype, ........tim
+00055bd0: 655f 7769 6474 685f 7065 7263 656e 7420  e_width_percent 
+00055be0: 3d20 7365 6c66 2e74 696d 655f 7769 6474  = self.time_widt
+00055bf0: 685f 7065 7263 656e 742c 2065 7661 6c75  h_percent, evalu
+00055c00: 6174 696f 6e5f 7374 796c 6520 3d20 6576  ation_style = ev
+00055c10: 616c 7561 7469 6f6e 5f73 7479 6c65 2c20  aluation_style, 
+00055c20: 0d0a 0909 0909 0909 6669 6c65 6e61 6d65  ........filename
+00055c30: 203d 2073 656c 662e 6669 6c65 6e61 6d65   = self.filename
+00055c40: 2c20 7363 616c 655f 7479 7065 203d 2073  , scale_type = s
+00055c50: 6361 6c65 5f74 7970 652c 2070 6174 6368  cale_type, patch
+00055c60: 6573 203d 2070 6174 6368 6573 2c20 6c69  es = patches, li
+00055c70: 6e74 7265 7368 203d 2073 656c 662e 6c69  ntresh = self.li
+00055c80: 6e74 7265 7368 2c0d 0a09 0909 0909 0970  ntresh,........p
+00055c90: 7269 6e74 5f63 6c69 636b 5f70 6f73 6974  rint_click_posit
+00055ca0: 696f 6e20 3d20 7072 696e 745f 636c 6963  ion = print_clic
+00055cb0: 6b5f 706f 7369 7469 6f6e 2c20 6967 6e6f  k_position, igno
+00055cc0: 7265 5f74 696d 655f 7265 6769 6f6e 203d  re_time_region =
+00055cd0: 2073 656c 662e 6967 6e6f 7265 5f74 696d   self.ignore_tim
+00055ce0: 655f 7265 6769 6f6e 2c0d 0a09 0909 0909  e_region,.......
+00055cf0: 0964 6174 615f 7479 7065 203d 2073 656c  .data_type = sel
+00055d00: 662e 6461 7461 5f74 7970 652c 2070 6c6f  f.data_type, plo
+00055d10: 745f 7365 636f 6e64 5f61 735f 656e 6572  t_second_as_ener
+00055d20: 6779 203d 2070 6c6f 745f 7365 636f 6e64  gy = plot_second
+00055d30: 5f61 735f 656e 6572 6779 2c20 756e 6974  _as_energy, unit
+00055d40: 733d 2073 656c 662e 756e 6974 732c 200d  s= self.units, .
+00055d50: 0a09 0909 0909 0965 7175 616c 5f65 6e65  .......equal_ene
+00055d60: 7267 795f 6269 6e20 3d20 7365 6c66 2e65  rgy_bin = self.e
+00055d70: 7175 616c 5f65 6e65 7267 795f 6269 6e29  qual_energy_bin)
+00055d80: 0d0a 0d0a 0d0a 0d0a 0964 6566 2053 6176  .........def Sav
+00055d90: 655f 6461 7461 2873 656c 662c 2073 6176  e_data(self, sav
+00055da0: 655f 5241 5720 3d20 5472 7565 2c20 7361  e_RAW = True, sa
+00055db0: 7665 5f46 6974 203d 2054 7275 652c 2073  ve_Fit = True, s
+00055dc0: 6176 655f 736c 6963 6573 203d 2054 7275  ave_slices = Tru
+00055dd0: 652c 2073 6176 655f 6269 6e6e 6564 203d  e, save_binned =
+00055de0: 2046 616c 7365 2c20 0d0a 0909 0909 0966   False, .......f
+00055df0: 696c 656e 616d 6520 3d20 4e6f 6e65 2c20  ilename = None, 
+00055e00: 7361 7665 5f66 6974 5f72 6573 756c 7473  save_fit_results
+00055e10: 203d 2054 7275 652c 2070 6174 6820 3d20   = True, path = 
+00055e20: 2744 6174 615f 6578 706f 7274 272c 2073  'Data_export', s
+00055e30: 6570 203d 2073 7472 2827 5c74 2729 293a  ep = str('\t')):
+00055e40: 0d0a 0909 2727 2768 616e 6479 2066 756e  ....'''handy fun
+00055e50: 6374 696f 6e20 746f 2073 6176 6520 7468  ction to save th
+00055e60: 6520 6461 7461 206f 6e20 6469 736b 2061  e data on disk a
+00055e70: 7320 6461 7420 6669 6c65 732e 0d0a 0909  s dat files.....
+00055e80: 5468 6520 5241 5720 6c61 6265 6c65 6420  The RAW labeled 
+00055e90: 6669 6c65 7320 636f 6e74 6169 6e20 7468  files contain th
+00055ea0: 6520 6368 6972 7020 636f 7272 6563 7465  e chirp correcte
+00055eb0: 6420 7661 6c75 6573 2028 7365 6c66 2e64  d values (self.d
+00055ec0: 7329 0d0a 0909 0d0a 0909 7468 6520 7361  s)........the sa
+00055ed0: 7665 5f73 6c69 6365 7320 7377 6974 6368  ve_slices switch
+00055ee0: 2074 7572 6e73 206f 6e20 7468 6520 6475   turns on the du
+00055ef0: 6d70 206f 6620 7468 6520 7365 7061 7261  mp of the separa
+00055f00: 7465 2073 6c69 6365 6420 6669 6775 7265  te sliced figure
+00055f10: 7320 2874 696d 6520 616e 6420 7370 6563  s (time and spec
+00055f20: 7472 616c 2920 0d0a 0d0a 0909 0d0a 0909  tral) ..........
+00055f30: 5061 7261 6d65 7465 7273 0d0a 0909 2d2d  Parameters....--
+00055f40: 2d2d 2d2d 2d2d 2d2d 0d0a 0909 0d0a 0909  --------........
+00055f50: 7361 7665 5f62 696e 6e65 6420 3a20 626f  save_binned : bo
+00055f60: 6f6c 2c20 6f70 7469 6f6e 616c 0d0a 0909  ol, optional....
+00055f70: 0969 7320 616c 736f 2074 6865 2072 652d  .is also the re-
+00055f80: 6269 6e6e 6564 206d 6174 7269 7820 746f  binned matrix to
+00055f90: 2062 6520 7361 7665 642e 0d0a 0909 090d   be saved.......
+00055fa0: 0a09 0973 6176 655f 736c 6963 6573 203a  ...save_slices :
+00055fb0: 2062 6f6f 6c2c 206f 7074 696f 6e61 6c0d   bool, optional.
+00055fc0: 0a09 0909 7361 7665 2074 6865 206b 696e  ....save the kin
+00055fd0: 6574 6963 7320 616e 6420 7370 6563 7472  etics and spectr
+00055fe0: 6120 6672 6f6d 2074 6865 2066 6974 7465  a from the fitte
+00055ff0: 6420 6461 7461 2028 7769 7468 2074 6865  d data (with the
+00056000: 2066 6974 7329 0d0a 0909 090d 0a09 0973   fits).........s
+00056010: 6570 203a 2073 7472 2c20 6f70 7469 6f6e  ep : str, option
+00056020: 616c 0d0a 0909 0977 6861 7420 7379 6d62  al.....what symb
+00056030: 6f6c 2069 7320 7573 6564 2074 6f20 7365  ol is used to se
+00056040: 7061 7261 7465 2064 6966 6665 7265 6e74  parate different
+00056050: 206e 756d 6265 722e 2028 7479 7069 6361   number. (typica
+00056060: 6c20 6569 7468 6572 2027 7461 6227 206f  l either 'tab' o
+00056070: 7220 636f 6d6d 610d 0a09 090d 0a09 0973  r comma........s
+00056080: 6176 655f 5241 5720 3a20 626f 6f6c 2c20  ave_RAW : bool, 
+00056090: 6f70 7469 6f6e 616c 0d0a 0909 0928 4465  optional.....(De
+000560a0: 6661 756c 7429 2054 7275 6520 7468 656e  fault) True then
+000560b0: 2074 6865 2066 6972 7374 2073 6c69 6465   the first slide
+000560c0: 2077 6974 6820 7468 6520 5241 5720 6461   with the RAW da
+000560d0: 7461 2069 7320 6372 6561 7465 6420 0d0a  ta is created ..
+000560e0: 0909 0d0a 0909 7361 7665 5f46 6974 203a  ......save_Fit :
+000560f0: 2062 6f6f 6c2c 206f 7074 696f 6e61 6c0d   bool, optional.
+00056100: 0a09 0909 2844 6566 6175 6c74 2920 5472  ....(Default) Tr
+00056110: 7565 2074 6865 6e20 7468 6520 7365 636f  ue then the seco
+00056120: 6e64 2073 6c69 6465 2077 6974 6820 7468  nd slide with th
+00056130: 6520 4669 7474 6564 2064 6174 6120 6973  e Fitted data is
+00056140: 2063 7265 6174 6564 200d 0a09 090d 0a09   created .......
+00056150: 0970 6174 6820 3a20 4e6f 6e65 2c20 7374  .path : None, st
+00056160: 7220 6f72 2070 6174 682c 206f 7074 696f  r or path, optio
+00056170: 6e61 6c0d 0a09 0909 2844 6566 6175 6c74  nal.....(Default
+00056180: 2920 4e6f 6e65 2c20 6966 206c 6566 7420  ) None, if left 
+00056190: 6f6e 204e 6f6e 652c 2074 6865 6e20 6120  on None, then a 
+000561a0: 666f 6c64 6572 2022 7265 7375 6c74 5f66  folder "result_f
+000561b0: 6967 7572 6573 2220 6973 2063 7265 6174  igures" is creat
+000561c0: 6564 2069 6e20 7468 6520 666f 6c64 6572  ed in the folder
+000561d0: 200d 0a09 0909 6f66 2074 6865 2064 6174   .....of the dat
+000561e0: 6120 2873 656c 662e 7061 7468 290d 0a09  a (self.path)...
+000561f0: 0909 0d0a 0909 7361 7665 5f66 6974 5f72  ......save_fit_r
+00056200: 6573 756c 7473 203a 2062 6f6f 6c2c 206f  esults : bool, o
+00056210: 7074 696f 6e61 6c0d 0a09 0909 6966 2054  ptional.....if T
+00056220: 7275 6520 2844 6566 6175 6c74 2920 2061  rue (Default)  a
+00056230: 206e 6561 746c 7920 666f 726d 6174 6564   neatly formated
+00056240: 2066 696c 6520 7769 7468 2074 6865 2066   file with the f
+00056250: 6974 2072 6573 756c 7473 2069 7320 6372  it results is cr
+00056260: 6561 7465 6420 616e 6420 7374 6f72 6564  eated and stored
+00056270: 2077 6974 6820 7468 6520 6461 7461 0d0a   with the data..
+00056280: 0909 090d 0a09 0966 696c 656e 616d 6520  .......filename 
+00056290: 3a20 7374 722c 206f 7074 696f 6e61 6c0d  : str, optional.
+000562a0: 0a09 0909 2844 6566 6175 6c74 2920 4e6f  ....(Default) No
+000562b0: 6e65 2c20 4261 7365 206e 616d 6520 666f  ne, Base name fo
+000562c0: 7220 616c 6c20 706c 6f74 732e 2049 6620  r all plots. If 
+000562d0: 4e6f 6e65 2c20 7468 656e 2073 656c 662e  None, then self.
+000562e0: 6669 6c65 6e61 6d65 2077 696c 6c20 6265  filename will be
+000562f0: 2075 7365 640d 0a09 0909 0d0a 0909 4578   used.........Ex
+00056300: 616d 706c 6573 0d0a 0909 2d2d 2d2d 2d2d  amples....------
+00056310: 2d2d 2d0d 0a09 093e 3e3e 2074 612e 5361  ---....>>> ta.Sa
+00056320: 7665 5f44 6174 610d 0a09 090d 0a09 0927  ve_Data........'
+00056330: 2727 0d0a 0909 0d0a 0909 6966 2066 696c  ''........if fil
+00056340: 656e 616d 6520 6973 204e 6f6e 653a 6669  ename is None:fi
+00056350: 6c65 6e61 6d65 203d 2073 656c 662e 6669  lename = self.fi
+00056360: 6c65 6e61 6d65 2e73 706c 6974 2827 2e27  lename.split('.'
+00056370: 295b 305d 0d0a 0909 6966 2073 6176 655f  )[0]....if save_
+00056380: 5241 573a 0d0a 0909 0973 656c 662e 6473  RAW:.....self.ds
+00056390: 2e74 6f5f 6373 7628 6368 6563 6b5f 666f  .to_csv(check_fo
+000563a0: 6c64 6572 2870 6174 6820 3d20 7061 7468  lder(path = path
+000563b0: 2c20 6375 7272 656e 745f 7061 7468 203d  , current_path =
+000563c0: 2073 656c 662e 7061 7468 2c20 0d0a 0909   self.path, ....
+000563d0: 0909 0909 0966 696c 656e 616d 6520 3d20  .....filename = 
+000563e0: 6669 6c65 6e61 6d65 2b27 5f63 6869 7270  filename+'_chirp
+000563f0: 5f63 6f72 7265 6374 6564 5f72 6177 5f6d  _corrected_raw_m
+00056400: 6174 7269 782e 6461 7427 292c 2073 6570  atrix.dat'), sep
+00056410: 203d 2073 6570 290d 0a09 0909 6966 2073   = sep).....if s
+00056420: 6176 655f 6269 6e6e 6564 3a0d 0a09 0909  ave_binned:.....
+00056430: 0973 7562 203d 2073 7562 5f64 7328 7365  .sub = sub_ds(se
+00056440: 6c66 2e64 732c 2073 6361 7474 6572 6375  lf.ds, scattercu
+00056450: 7420 3d20 7365 6c66 2e73 6361 7474 6572  t = self.scatter
+00056460: 6375 742c 2062 6f72 6465 7263 7574 203d  cut, bordercut =
+00056470: 2073 656c 662e 626f 7264 6572 6375 742c   self.bordercut,
+00056480: 200d 0a09 0909 0909 0909 7469 6d65 6c69   .........timeli
+00056490: 6d69 7473 203d 2073 656c 662e 7469 6d65  mits = self.time
+000564a0: 6c69 6d69 7473 2c20 7761 7665 5f6e 6d5f  limits, wave_nm_
+000564b0: 6269 6e20 3d20 7365 6c66 2e77 6176 655f  bin = self.wave_
+000564c0: 6e6d 5f62 696e 2c20 0d0a 0909 0909 0909  nm_bin, ........
+000564d0: 0974 696d 655f 6269 6e20 3d20 7365 6c66  .time_bin = self
+000564e0: 2e74 696d 655f 6269 6e29 0d0a 0909 0909  .time_bin)......
+000564f0: 7375 622e 746f 5f63 7376 2863 6865 636b  sub.to_csv(check
+00056500: 5f66 6f6c 6465 7228 7061 7468 203d 2070  _folder(path = p
+00056510: 6174 682c 2063 7572 7265 6e74 5f70 6174  ath, current_pat
+00056520: 6820 3d20 7365 6c66 2e70 6174 682c 200d  h = self.path, .
+00056530: 0a09 0909 0909 0909 0909 0966 696c 656e  ...........filen
+00056540: 616d 6520 3d20 6669 6c65 6e61 6d65 2b27  ame = filename+'
+00056550: 5f63 6869 7270 5f63 6f72 7265 6374 6564  _chirp_corrected
+00056560: 5f72 6562 696e 6e65 645f 6d61 7472 6978  _rebinned_matrix
+00056570: 2e64 6174 2729 2c20 7365 7020 3d20 7365  .dat'), sep = se
+00056580: 7029 0d0a 0909 0969 6620 7361 7665 5f73  p).....if save_s
+00056590: 6c69 6365 733a 0d0a 0909 0909 7375 6220  lices:......sub 
+000565a0: 3d20 7375 625f 6473 2864 7320 3d20 7365  = sub_ds(ds = se
+000565b0: 6c66 2e64 732e 636f 7079 2829 2c20 7761  lf.ds.copy(), wa
+000565c0: 7665 6c65 6e67 7468 5f62 696e 203d 2073  velength_bin = s
+000565d0: 656c 662e 7761 7665 6c65 6e67 7468 5f62  elf.wavelength_b
+000565e0: 696e 2c20 7761 7665 6c65 6e67 7468 203d  in, wavelength =
+000565f0: 2073 656c 662e 7265 6c5f 7761 7665 290d   self.rel_wave).
+00056600: 0a09 0909 0923 7375 622e 636f 6c75 6d6e  .....#sub.column
+00056610: 732e 6e61 6d65 203d 2027 7761 7665 6c65  s.name = 'wavele
+00056620: 6e67 7468 205b 6e6d 5d20 696e 2025 2e30  ngth [nm] in %.0
+00056630: 6620 6269 6e73 2725 7365 6c66 2e77 6176  f bins'%self.wav
+00056640: 656c 656e 6774 685f 6269 6e0d 0a09 0909  elength_bin.....
+00056650: 0973 7562 2e74 6f5f 6373 7628 6368 6563  .sub.to_csv(chec
+00056660: 6b5f 666f 6c64 6572 2870 6174 6820 3d20  k_folder(path = 
+00056670: 7061 7468 2c20 6375 7272 656e 745f 7061  path, current_pa
+00056680: 7468 203d 2073 656c 662e 7061 7468 2c20  th = self.path, 
+00056690: 0d0a 0909 0909 0909 0966 696c 656e 616d  .........filenam
+000566a0: 6520 3d20 6669 6c65 6e61 6d65 2b27 5f63  e = filename+'_c
+000566b0: 6869 7270 5f63 6f72 7265 6374 6564 5f52  hirp_corrected_R
+000566c0: 4157 5f6b 696e 6574 6963 732e 6461 7427  AW_kinetics.dat'
+000566d0: 292c 2073 6570 203d 2073 6570 290d 0a09  ), sep = sep)...
+000566e0: 0909 0973 7562 203d 2073 7562 5f64 7328  ...sub = sub_ds(
+000566f0: 6473 203d 2073 656c 662e 6473 2e63 6f70  ds = self.ds.cop
+00056700: 7928 292c 2074 696d 6573 203d 2073 656c  y(), times = sel
+00056710: 662e 7265 6c5f 7469 6d65 2c20 7469 6d65  f.rel_time, time
+00056720: 5f77 6964 7468 5f70 6572 6365 6e74 203d  _width_percent =
+00056730: 2073 656c 662e 7469 6d65 5f77 6964 7468   self.time_width
+00056740: 5f70 6572 6365 6e74 2c20 0d0a 0909 0909  _percent, ......
+00056750: 0909 0909 7363 6174 7465 7263 7574 203d  ....scattercut =
+00056760: 2073 656c 662e 7363 6174 7465 7263 7574   self.scattercut
+00056770: 2c20 626f 7264 6572 6375 7420 3d20 7365  , bordercut = se
+00056780: 6c66 2e62 6f72 6465 7263 7574 2c20 7761  lf.bordercut, wa
+00056790: 7665 5f6e 6d5f 6269 6e20 3d20 7365 6c66  ve_nm_bin = self
+000567a0: 2e77 6176 655f 6e6d 5f62 696e 290d 0a09  .wave_nm_bin)...
+000567b0: 0909 0973 7562 2e74 6f5f 6373 7628 6368  ...sub.to_csv(ch
+000567c0: 6563 6b5f 666f 6c64 6572 2870 6174 6820  eck_folder(path 
+000567d0: 3d20 7061 7468 2c20 6375 7272 656e 745f  = path, current_
+000567e0: 7061 7468 203d 2073 656c 662e 7061 7468  path = self.path
+000567f0: 2c20 0d0a 0909 0909 0909 0966 696c 656e  , .........filen
+00056800: 616d 6520 3d20 6669 6c65 6e61 6d65 2b27  ame = filename+'
+00056810: 5f63 6869 7270 5f63 6f72 7265 6374 6564  _chirp_corrected
+00056820: 5f52 4157 5f53 7065 6374 7261 2e64 6174  _RAW_Spectra.dat
+00056830: 2729 2c20 7365 7020 3d20 7365 7029 0d0a  '), sep = sep)..
+00056840: 0909 6966 2073 6176 655f 4669 743a 0d0a  ..if save_Fit:..
+00056850: 0909 0974 7279 3a0d 0a09 0909 0973 656c  ...try:......sel
+00056860: 662e 7265 2e6b 6579 7328 290d 0a09 0909  f.re.keys().....
+00056870: 6578 6365 7074 3a0d 0a09 0909 0970 7269  except:......pri
+00056880: 6e74 2827 6e6f 2066 6974 2069 6e20 6461  nt('no fit in da
+00056890: 7461 2729 0d0a 0909 0909 7361 7665 5f46  ta')......save_F
+000568a0: 6974 203d 2046 616c 7365 0d0a 0909 6966  it = False....if
+000568b0: 2073 6176 655f 4669 743a 0d0a 0909 0973   save_Fit:.....s
+000568c0: 656c 662e 7265 5b27 4127 5d2e 746f 5f63  elf.re['A'].to_c
+000568d0: 7376 2863 6865 636b 5f66 6f6c 6465 7228  sv(check_folder(
+000568e0: 7061 7468 203d 2070 6174 682c 2063 7572  path = path, cur
+000568f0: 7265 6e74 5f70 6174 6820 3d20 7365 6c66  rent_path = self
+00056900: 2e70 6174 682c 200d 0a09 0909 0909 0909  .path, .........
+00056910: 0966 696c 656e 616d 6520 3d20 6669 6c65  .filename = file
+00056920: 6e61 6d65 2b27 5f6d 6174 7269 7820 7573  name+'_matrix us
+00056930: 6564 2061 7320 6669 7420 696e 7075 742e  ed as fit input.
+00056940: 6461 7427 292c 2073 6570 203d 2073 6570  dat'), sep = sep
+00056950: 290d 0a09 0909 7365 6c66 2e72 655b 2741  ).....self.re['A
+00056960: 4327 5d2e 746f 5f63 7376 2863 6865 636b  C'].to_csv(check
+00056970: 5f66 6f6c 6465 7228 7061 7468 203d 2070  _folder(path = p
+00056980: 6174 682c 2063 7572 7265 6e74 5f70 6174  ath, current_pat
+00056990: 6820 3d20 7365 6c66 2e70 6174 682c 200d  h = self.path, .
+000569a0: 0a09 0909 0909 0909 0966 696c 656e 616d  .........filenam
+000569b0: 6520 3d20 6669 6c65 6e61 6d65 2b27 5f6d  e = filename+'_m
+000569c0: 6174 7269 7820 6361 6c63 756c 6174 6564  atrix calculated
+000569d0: 2064 7572 696e 6720 6669 742e 6461 7427   during fit.dat'
+000569e0: 292c 2073 6570 203d 2073 6570 290d 0a09  ), sep = sep)...
+000569f0: 0909 7365 6c66 2e72 655b 2741 4527 5d2e  ..self.re['AE'].
+00056a00: 746f 5f63 7376 2863 6865 636b 5f66 6f6c  to_csv(check_fol
+00056a10: 6465 7228 7061 7468 203d 2070 6174 682c  der(path = path,
+00056a20: 2063 7572 7265 6e74 5f70 6174 6820 3d20   current_path = 
+00056a30: 7365 6c66 2e70 6174 682c 200d 0a09 0909  self.path, .....
+00056a40: 0909 0909 0966 696c 656e 616d 6520 3d20  .....filename = 
+00056a50: 6669 6c65 6e61 6d65 2b27 5f65 7272 6f72  filename+'_error
+00056a60: 5f6d 6174 7269 7820 6361 6c63 756c 6174  _matrix calculat
+00056a70: 6564 2064 7572 696e 6720 6669 742e 6461  ed during fit.da
+00056a80: 7427 292c 2073 6570 203d 2073 6570 290d  t'), sep = sep).
+00056a90: 0a09 0909 6966 2073 6176 655f 736c 6963  ....if save_slic
+00056aa0: 6573 3a09 0d0a 0909 0909 7375 6220 3d20  es:.......sub = 
+00056ab0: 7375 625f 6473 2864 7320 3d20 7365 6c66  sub_ds(ds = self
+00056ac0: 2e72 655b 2741 4327 5d2e 636f 7079 2829  .re['AC'].copy()
+00056ad0: 2c20 7761 7665 6c65 6e67 7468 5f62 696e  , wavelength_bin
+00056ae0: 203d 2073 656c 662e 7761 7665 6c65 6e67   = self.waveleng
+00056af0: 7468 5f62 696e 2c20 7761 7665 6c65 6e67  th_bin, waveleng
+00056b00: 7468 203d 2073 656c 662e 7265 6c5f 7761  th = self.rel_wa
+00056b10: 7665 290d 0a09 0909 0923 7375 622e 636f  ve)......#sub.co
+00056b20: 6c75 6d6e 732e 6e61 6d65 203d 2027 7761  lumns.name = 'wa
+00056b30: 7665 6c65 6e74 6820 5b6e 6d5d 2069 6e20  velenth [nm] in 
+00056b40: 252e 3066 2062 696e 7327 2573 656c 662e  %.0f bins'%self.
+00056b50: 7761 7665 6c65 6e67 7468 5f62 696e 0d0a  wavelength_bin..
+00056b60: 0909 0909 7375 622e 746f 5f63 7376 2863  ....sub.to_csv(c
+00056b70: 6865 636b 5f66 6f6c 6465 7228 7061 7468  heck_folder(path
+00056b80: 203d 2070 6174 682c 2063 7572 7265 6e74   = path, current
+00056b90: 5f70 6174 6820 3d20 7365 6c66 2e70 6174  _path = self.pat
+00056ba0: 682c 200d 0a09 0909 0909 0909 6669 6c65  h, .........file
+00056bb0: 6e61 6d65 203d 2066 696c 656e 616d 652b  name = filename+
+00056bc0: 275f 6669 7474 6564 5f6b 696e 6574 6963  '_fitted_kinetic
+00056bd0: 732e 6461 7427 292c 2073 6570 203d 2073  s.dat'), sep = s
+00056be0: 6570 290d 0a09 0909 0973 7562 203d 2073  ep)......sub = s
+00056bf0: 7562 5f64 7328 6473 203d 2073 656c 662e  ub_ds(ds = self.
+00056c00: 7265 5b27 4127 5d2e 636f 7079 2829 2c20  re['A'].copy(), 
+00056c10: 7761 7665 6c65 6e67 7468 5f62 696e 203d  wavelength_bin =
+00056c20: 2073 656c 662e 7761 7665 6c65 6e67 7468   self.wavelength
+00056c30: 5f62 696e 2c20 7761 7665 6c65 6e67 7468  _bin, wavelength
+00056c40: 203d 2073 656c 662e 7265 6c5f 7761 7665   = self.rel_wave
+00056c50: 290d 0a09 0909 0923 7375 622e 636f 6c75  )......#sub.colu
+00056c60: 6d6e 732e 6e61 6d65 203d 2027 7761 7665  mns.name = 'wave
+00056c70: 6c65 6e74 6820 5b6e 6d5d 2069 6e20 252e  lenth [nm] in %.
+00056c80: 3066 2062 696e 7327 2573 656c 662e 7761  0f bins'%self.wa
+00056c90: 7665 6c65 6e67 7468 5f62 696e 0d0a 0909  velength_bin....
+00056ca0: 0909 7375 622e 746f 5f63 7376 2863 6865  ..sub.to_csv(che
+00056cb0: 636b 5f66 6f6c 6465 7228 7061 7468 203d  ck_folder(path =
+00056cc0: 2070 6174 682c 2063 7572 7265 6e74 5f70   path, current_p
+00056cd0: 6174 6820 3d20 7365 6c66 2e70 6174 682c  ath = self.path,
+00056ce0: 200d 0a09 0909 0909 0909 6669 6c65 6e61   .........filena
+00056cf0: 6d65 203d 2066 696c 656e 616d 652b 275f  me = filename+'_
+00056d00: 6d65 6173 7572 6564 5f6b 696e 6574 6963  measured_kinetic
+00056d10: 732e 6461 7427 292c 2073 6570 203d 2073  s.dat'), sep = s
+00056d20: 6570 290d 0a09 0909 0973 7562 203d 2073  ep)......sub = s
+00056d30: 7562 5f64 7328 6473 203d 2073 656c 662e  ub_ds(ds = self.
+00056d40: 7265 5b27 4143 275d 2e63 6f70 7928 292c  re['AC'].copy(),
+00056d50: 2074 696d 6573 203d 2073 656c 662e 7265   times = self.re
+00056d60: 6c5f 7469 6d65 2c20 0d0a 0909 0909 0909  l_time, ........
+00056d70: 0974 696d 655f 7769 6474 685f 7065 7263  .time_width_perc
+00056d80: 656e 7420 3d20 7365 6c66 2e74 696d 655f  ent = self.time_
+00056d90: 7769 6474 685f 7065 7263 656e 742c 2073  width_percent, s
+00056da0: 6361 7474 6572 6375 7420 3d20 7365 6c66  cattercut = self
+00056db0: 2e73 6361 7474 6572 6375 742c 200d 0a09  .scattercut, ...
+00056dc0: 0909 0909 0909 626f 7264 6572 6375 7420  ......bordercut 
+00056dd0: 3d20 7365 6c66 2e62 6f72 6465 7263 7574  = self.bordercut
+00056de0: 2c20 7761 7665 5f6e 6d5f 6269 6e20 3d20  , wave_nm_bin = 
+00056df0: 7365 6c66 2e77 6176 655f 6e6d 5f62 696e  self.wave_nm_bin
+00056e00: 290d 0a09 0909 0973 7562 2e74 6f5f 6373  )......sub.to_cs
+00056e10: 7628 6368 6563 6b5f 666f 6c64 6572 2870  v(check_folder(p
+00056e20: 6174 6820 3d20 7061 7468 2c20 6375 7272  ath = path, curr
+00056e30: 656e 745f 7061 7468 203d 2073 656c 662e  ent_path = self.
+00056e40: 7061 7468 2c20 0d0a 0909 0909 0909 0966  path, .........f
+00056e50: 696c 656e 616d 6520 3d20 6669 6c65 6e61  ilename = filena
+00056e60: 6d65 2b27 5f66 6974 7465 645f 7370 6563  me+'_fitted_spec
+00056e70: 7472 612e 6461 7427 292c 2073 6570 203d  tra.dat'), sep =
+00056e80: 2073 6570 290d 0a09 0909 0973 7562 203d   sep)......sub =
+00056e90: 2073 7562 5f64 7328 6473 203d 2073 656c   sub_ds(ds = sel
+00056ea0: 662e 7265 5b27 4127 5d2e 636f 7079 2829  f.re['A'].copy()
+00056eb0: 2c20 7469 6d65 7320 3d20 7365 6c66 2e72  , times = self.r
+00056ec0: 656c 5f74 696d 652c 200d 0a09 0909 0909  el_time, .......
+00056ed0: 0909 7469 6d65 5f77 6964 7468 5f70 6572  ..time_width_per
+00056ee0: 6365 6e74 203d 2073 656c 662e 7469 6d65  cent = self.time
+00056ef0: 5f77 6964 7468 5f70 6572 6365 6e74 2c20  _width_percent, 
+00056f00: 7363 6174 7465 7263 7574 203d 2073 656c  scattercut = sel
+00056f10: 662e 7363 6174 7465 7263 7574 2c20 0d0a  f.scattercut, ..
+00056f20: 0909 0909 0909 0962 6f72 6465 7263 7574  .......bordercut
+00056f30: 203d 2073 656c 662e 626f 7264 6572 6375   = self.bordercu
+00056f40: 742c 2077 6176 655f 6e6d 5f62 696e 203d  t, wave_nm_bin =
+00056f50: 2073 656c 662e 7761 7665 5f6e 6d5f 6269   self.wave_nm_bi
+00056f60: 6e29 0d0a 0909 0909 7375 622e 746f 5f63  n)......sub.to_c
+00056f70: 7376 2863 6865 636b 5f66 6f6c 6465 7228  sv(check_folder(
+00056f80: 7061 7468 203d 2070 6174 682c 2063 7572  path = path, cur
+00056f90: 7265 6e74 5f70 6174 6820 3d20 7365 6c66  rent_path = self
+00056fa0: 2e70 6174 682c 200d 0a09 0909 0909 0909  .path, .........
+00056fb0: 6669 6c65 6e61 6d65 203d 2066 696c 656e  filename = filen
+00056fc0: 616d 652b 275f 6d65 6173 7572 6564 5f73  ame+'_measured_s
+00056fd0: 7065 6374 7261 2e64 6174 2729 2c20 7365  pectra.dat'), se
+00056fe0: 7020 3d20 7365 7029 0d0a 0909 0909 7365  p = sep)......se
+00056ff0: 6c66 2e72 655b 2744 4143 275d 2e74 6f5f  lf.re['DAC'].to_
+00057000: 6373 7628 6368 6563 6b5f 666f 6c64 6572  csv(check_folder
+00057010: 2870 6174 6820 3d20 7061 7468 2c20 6375  (path = path, cu
+00057020: 7272 656e 745f 7061 7468 203d 2073 656c  rrent_path = sel
+00057030: 662e 7061 7468 2c20 0d0a 0909 0909 0909  f.path, ........
+00057040: 0966 696c 656e 616d 6520 3d20 6669 6c65  .filename = file
+00057050: 6e61 6d65 2b27 5f44 4153 2d53 4153 2e64  name+'_DAS-SAS.d
+00057060: 6174 2729 2c20 7365 7020 3d20 7365 7029  at'), sep = sep)
+00057070: 0d0a 0909 0d0a 0909 0969 6620 7361 7665  .........if save
+00057080: 5f66 6974 5f72 6573 756c 7473 3a0d 0a09  _fit_results:...
+00057090: 0909 090d 0a09 0909 0952 6573 756c 745f  .........Result_
+000570a0: 7374 7269 6e67 3d27 5c6e 4669 7420 5265  string='\nFit Re
+000570b0: 7375 6c74 733a 5c6e 270d 0a09 0909 090d  sults:\n'.......
+000570c0: 0a09 0909 0969 6620 6973 696e 7374 616e  .....if isinstan
+000570d0: 6365 2873 656c 662e 6d6f 642c 7479 7065  ce(self.mod,type
+000570e0: 2827 6865 6c6c 6f27 2929 3a0d 0a09 0909  ('hello')):.....
+000570f0: 0909 5265 7375 6c74 5f73 7472 696e 672b  ..Result_string+
+00057100: 3d27 4d6f 6465 6c20 5573 6564 3a20 2573  ='Model Used: %s
+00057110: 5c6e 5c6e 2725 7365 6c66 2e6d 6f64 0d0a  \n\n'%self.mod..
+00057120: 0909 0909 656c 7365 3a0d 0a09 0909 0909  ....else:.......
+00057130: 5265 7375 6c74 5f73 7472 696e 672b 3d27  Result_string+='
+00057140: 4d6f 6465 6c20 5573 6564 3a20 4578 7465  Model Used: Exte
+00057150: 726e 616c 2066 756e 6374 696f 6e5c 6e5c  rnal function\n\
+00057160: 6e27 0d0a 0909 0909 0d0a 0909 0909 6966  n'............if
+00057170: 2073 656c 662e 6967 6e6f 7265 5f74 696d   self.ignore_tim
+00057180: 655f 7265 6769 6f6e 2069 7320 6e6f 7420  e_region is not 
+00057190: 4e6f 6e65 3a0d 0a09 0909 0909 5265 7375  None:.......Resu
+000571a0: 6c74 5f73 7472 696e 672b 3d27 7468 6520  lt_string+='the 
+000571b0: 7469 6d65 2062 6574 7765 656e 2025 2e33  time between %.3
+000571c0: 6620 2573 2061 6e64 2025 2e33 6620 2573  f %s and %.3f %s
+000571d0: 2077 6173 2065 7863 6c75 6465 6420 6672   was excluded fr
+000571e0: 6f6d 2074 6865 206f 7074 696d 697a 6174  om the optimizat
+000571f0: 696f 6e5c 6e27 2528 7365 6c66 2e69 676e  ion\n'%(self.ign
+00057200: 6f72 655f 7469 6d65 5f72 6567 696f 6e5b  ore_time_region[
+00057210: 305d 2c73 656c 662e 6261 7365 756e 6974  0],self.baseunit
+00057220: 2c73 656c 662e 6967 6e6f 7265 5f74 696d  ,self.ignore_tim
+00057230: 655f 7265 6769 6f6e 5b31 5d2c 7365 6c66  e_region[1],self
+00057240: 2e62 6173 6575 6e69 7429 090d 0a09 0909  .baseunit)......
+00057250: 0952 6573 756c 745f 7374 7269 6e67 2b3d  .Result_string+=
+00057260: 2754 6865 206d 696e 696d 756d 2065 7272  'The minimum err
+00057270: 6f72 2069 733a 7b3a 2e38 657d 5c6e 272e  or is:{:.8e}\n'.
+00057280: 666f 726d 6174 2873 656c 662e 7265 5b27  format(self.re['
+00057290: 6572 726f 7227 5d29 0d0a 0909 0909 5265  error'])......Re
+000572a0: 7375 6c74 5f73 7472 696e 672b 3d27 5468  sult_string+='Th
+000572b0: 6520 6d69 6e69 6d75 6d20 5232 2d76 616c  e minimum R2-val
+000572c0: 7565 2069 733a 7b3a 2e38 657d 5c6e 272e  ue is:{:.8e}\n'.
+000572d0: 666f 726d 6174 2873 656c 662e 7265 5b27  format(self.re['
+000572e0: 7232 275d 290d 0a09 0909 090d 0a09 0909  r2'])...........
+000572f0: 0969 6620 2763 6f6e 6669 6465 6e63 6527  .if 'confidence'
+00057300: 2069 6e20 7365 6c66 2e72 653a 0d0a 0909   in self.re:....
+00057310: 0909 0952 6573 756c 745f 7374 7269 6e67  ...Result_string
+00057320: 2b3d 275c 6e49 6e20 5261 7465 7320 7769  +='\nIn Rates wi
+00057330: 7468 2063 6f6e 6669 6465 6e63 6520 696e  th confidence in
+00057340: 7465 7276 616c 2074 6f20 6c65 7665 6c20  terval to level 
+00057350: 6f66 2025 735c 6e27 2573 656c 662e 7265  of %s\n'%self.re
+00057360: 5b27 636f 6e66 6964 656e 6365 275d 5b27  ['confidence']['
+00057370: 7461 7267 6574 2d6c 6576 656c 275d 0d0a  target-level']..
+00057380: 0909 0909 0952 6573 756c 745f 7374 7269  .....Result_stri
+00057390: 6e67 2b3d 7365 6c66 2e72 655b 2766 6974  ng+=self.re['fit
+000573a0: 5f72 6573 756c 7473 5f72 6174 6573 275d  _results_rates']
+000573b0: 2e74 6f5f 7374 7269 6e67 2863 6f6c 756d  .to_string(colum
+000573c0: 6e73 3d5b 2776 616c 7565 272c 276c 6f77  ns=['value','low
+000573d0: 6572 5f6c 696d 6974 272c 2775 7070 6572  er_limit','upper
+000573e0: 5f6c 696d 6974 272c 2769 6e69 745f 7661  _limit','init_va
+000573f0: 6c75 6527 2c27 7661 7279 272c 276d 696e  lue','vary','min
+00057400: 272c 276d 6178 272c 2765 7870 7227 5d29  ','max','expr'])
+00057410: 0d0a 0909 0909 0952 6573 756c 745f 7374  .......Result_st
+00057420: 7269 6e67 2b3d 275c 6e5c 6e54 6865 2072  ring+='\n\nThe r
+00057430: 6174 6573 2063 6f6e 7665 7274 6564 2074  ates converted t
+00057440: 6f20 7469 6d65 7320 7769 7468 2075 6e69  o times with uni
+00057450: 7420 2573 2077 6974 6820 636f 6e66 6964  t %s with confid
+00057460: 656e 6365 2069 6e74 6572 7661 6c20 746f  ence interval to
+00057470: 206c 6576 656c 206f 6620 2573 5c6e 2725   level of %s\n'%
+00057480: 2873 656c 662e 6261 7365 756e 6974 2c73  (self.baseunit,s
+00057490: 656c 662e 7265 5b27 636f 6e66 6964 656e  elf.re['confiden
+000574a0: 6365 275d 5b27 7461 7267 6574 2d6c 6576  ce']['target-lev
+000574b0: 656c 275d 290d 0a09 0909 0909 5265 7375  el']).......Resu
+000574c0: 6c74 5f73 7472 696e 672b 3d73 656c 662e  lt_string+=self.
+000574d0: 7265 5b27 6669 745f 7265 7375 6c74 735f  re['fit_results_
+000574e0: 7469 6d65 7327 5d2e 746f 5f73 7472 696e  times'].to_strin
+000574f0: 6728 636f 6c75 6d6e 733d 5b27 7661 6c75  g(columns=['valu
+00057500: 6527 2c27 6c6f 7765 725f 6c69 6d69 7427  e','lower_limit'
+00057510: 2c27 7570 7065 725f 6c69 6d69 7427 2c27  ,'upper_limit','
+00057520: 696e 6974 5f76 616c 7565 272c 2776 6172  init_value','var
+00057530: 7927 2c27 6d69 6e27 2c27 6d61 7827 2c27  y','min','max','
+00057540: 6578 7072 275d 290d 0a09 0909 0965 6c73  expr'])......els
+00057550: 653a 0d0a 0909 0909 0952 6573 756c 745f  e:.......Result_
+00057560: 7374 7269 6e67 2b3d 275c 6e49 6e20 5261  string+='\nIn Ra
+00057570: 7465 735c 6e27 0d0a 0909 0909 0952 6573  tes\n'.......Res
+00057580: 756c 745f 7374 7269 6e67 2b3d 7365 6c66  ult_string+=self
+00057590: 2e72 655b 2766 6974 5f72 6573 756c 7473  .re['fit_results
+000575a0: 5f72 6174 6573 275d 2e74 6f5f 7374 7269  _rates'].to_stri
+000575b0: 6e67 2863 6f6c 756d 6e73 3d5b 2776 616c  ng(columns=['val
+000575c0: 7565 272c 2769 6e69 745f 7661 6c75 6527  ue','init_value'
+000575d0: 2c27 7661 7279 272c 276d 696e 272c 276d  ,'vary','min','m
+000575e0: 6178 272c 2765 7870 7227 5d29 0d0a 0909  ax','expr'])....
+000575f0: 0909 0952 6573 756c 745f 7374 7269 6e67  ...Result_string
+00057600: 2b3d 275c 6e5c 6e54 6865 2072 6174 6573  +='\n\nThe rates
+00057610: 2063 6f6e 7665 7274 6564 2074 6f20 7469   converted to ti
+00057620: 6d65 7320 7769 7468 2075 6e69 7420 2573  mes with unit %s
+00057630: 5c6e 2725 7365 6c66 2e62 6173 6575 6e69  \n'%self.baseuni
+00057640: 740d 0a09 0909 0909 5265 7375 6c74 5f73  t.......Result_s
+00057650: 7472 696e 672b 3d73 656c 662e 7265 5b27  tring+=self.re['
+00057660: 6669 745f 7265 7375 6c74 735f 7469 6d65  fit_results_time
+00057670: 7327 5d2e 746f 5f73 7472 696e 6728 636f  s'].to_string(co
+00057680: 6c75 6d6e 733d 5b27 7661 6c75 6527 2c27  lumns=['value','
+00057690: 696e 6974 5f76 616c 7565 272c 2776 6172  init_value','var
+000576a0: 7927 2c27 6d69 6e27 2c27 6d61 7827 2c27  y','min','max','
+000576b0: 6578 7072 275d 290d 0a0d 0a09 0909 0977  expr'])........w
+000576c0: 6974 6820 6f70 656e 2863 6865 636b 5f66  ith open(check_f
+000576d0: 6f6c 6465 7228 7061 7468 203d 2070 6174  older(path = pat
+000576e0: 682c 2063 7572 7265 6e74 5f70 6174 6820  h, current_path 
+000576f0: 3d20 7365 6c66 2e70 6174 682c 2066 696c  = self.path, fil
+00057700: 656e 616d 6520 3d20 6669 6c65 6e61 6d65  ename = filename
+00057710: 2b27 5f66 6974 5f72 6573 756c 7473 5f70  +'_fit_results_p
+00057720: 6172 616d 6574 6572 2e70 6172 2729 2c20  arameter.par'), 
+00057730: 2277 2229 2061 7320 7465 7874 5f66 696c  "w") as text_fil
+00057740: 653a 0d0a 0909 0909 0974 6578 745f 6669  e:.......text_fi
+00057750: 6c65 2e77 7269 7465 2852 6573 756c 745f  le.write(Result_
+00057760: 7374 7269 6e67 290d 0a0d 0a09 6465 6620  string).....def 
+00057770: 5361 7665 5f50 6f77 6572 706f 696e 7428  Save_Powerpoint(
+00057780: 7365 6c66 2c20 7361 7665 5f52 4157 203d  self, save_RAW =
+00057790: 2054 7275 652c 2073 6176 655f 4669 7420   True, save_Fit 
+000577a0: 3d20 5472 7565 2c20 6669 6c65 6e61 6d65  = True, filename
+000577b0: 203d 204e 6f6e 652c 200d 0a09 0909 0909   = None, .......
+000577c0: 0970 6174 6820 3d20 2772 6573 756c 745f  .path = 'result_
+000577d0: 6669 6775 7265 7327 2c20 7363 616c 655f  figures', scale_
+000577e0: 7479 7065 203d 2027 7379 6d6c 6f67 272c  type = 'symlog',
+000577f0: 2074 6974 6c65 203d 204e 6f6e 652c 2070   title = None, p
+00057800: 6174 6368 6573 203d 2046 616c 7365 2c20  atches = False, 
+00057810: 636d 6170 3d4e 6f6e 6520 2c20 7361 7665  cmap=None , save
+00057820: 7479 7065 203d 2027 7070 7478 2729 3a0d  type = 'pptx'):.
+00057830: 0a09 0927 2727 5468 6973 2066 756e 6374  ...'''This funct
+00057840: 696f 6e20 6372 6561 7465 7320 7477 6f20  ion creates two 
+00057850: 706f 7765 7220 706f 696e 7420 736c 6964  power point slid
+00057860: 6573 2e20 4f6e 2074 6865 2066 6972 7374  es. On the first
+00057870: 2069 7420 7375 6d6d 6172 697a 6573 2074   it summarizes t
+00057880: 6865 2052 4157 2070 6c6f 7473 2061 6e64  he RAW plots and
+00057890: 206f 6e20 0d0a 0909 7468 6520 7365 636f   on ....the seco
+000578a0: 6e64 2028 6966 2065 7869 7374 656e 7429  nd (if existent)
+000578b0: 2069 7420 7375 6d6d 6172 697a 6573 2074   it summarizes t
+000578c0: 6865 2066 6974 7465 6420 7265 7375 6c74  he fitted result
+000578d0: 730d 0a09 090d 0a09 0950 6172 616d 6574  s........Paramet
+000578e0: 6572 730d 0a09 092d 2d2d 2d2d 2d2d 2d2d  ers....---------
+000578f0: 2d0d 0a09 090d 0a09 0973 6176 655f 5241  -........save_RA
+00057900: 5720 3a20 626f 6f6c 2c20 6f70 7469 6f6e  W : bool, option
+00057910: 616c 0d0a 0909 0928 4465 6661 756c 7429  al.....(Default)
+00057920: 2054 7275 6520 7468 656e 2074 6865 2066   True then the f
+00057930: 6972 7374 2073 6c69 6465 2077 6974 6820  irst slide with 
+00057940: 7468 6520 5241 5720 6461 7461 2069 7320  the RAW data is 
+00057950: 6372 6561 7465 6420 0d0a 0909 0d0a 0909  created ........
+00057960: 7361 7665 5f46 6974 203a 2062 6f6f 6c2c  save_Fit : bool,
+00057970: 206f 7074 696f 6e61 6c0d 0a09 0909 2844   optional.....(D
+00057980: 6566 6175 6c74 2920 5472 7565 2074 6865  efault) True the
+00057990: 6e20 7468 6520 7365 636f 6e64 2073 6c69  n the second sli
+000579a0: 6465 2077 6974 6820 7468 6520 4669 7474  de with the Fitt
+000579b0: 6564 2064 6174 6120 6973 2063 7265 6174  ed data is creat
+000579c0: 6564 200d 0a09 090d 0a09 0970 6174 6820  ed ........path 
+000579d0: 3a20 4e6f 6e65 2c20 7374 7220 6f72 2070  : None, str or p
+000579e0: 6174 682c 206f 7074 696f 6e61 6c0d 0a09  ath, optional...
+000579f0: 0909 2844 6566 6175 6c74 2920 4e6f 6e65  ..(Default) None
+00057a00: 2c20 6966 206c 6566 7420 6f6e 204e 6f6e  , if left on Non
+00057a10: 652c 2074 6865 6e20 6120 666f 6c64 6572  e, then a folder
+00057a20: 2022 7265 7375 6c74 5f66 6967 7572 6573   "result_figures
+00057a30: 2220 6973 2063 7265 6174 6564 2069 6e20  " is created in 
+00057a40: 7468 6520 666f 6c64 6572 200d 0a09 0909  the folder .....
+00057a50: 6f66 2074 6865 2064 6174 6120 2873 656c  of the data (sel
+00057a60: 662e 7061 7468 290d 0a09 090d 0a09 0973  f.path)........s
+00057a70: 6176 6574 7970 6520 3a20 7374 7220 6f72  avetype : str or
+00057a80: 2069 7465 7261 626c 6520 286f 6620 7374   iterable (of st
+00057a90: 7229 2c20 6f70 7469 6f6e 616c 200d 0a09  r), optional ...
+00057aa0: 0909 7472 6967 6765 7273 2074 6865 2061  ..triggers the a
+00057ab0: 6464 6974 696f 6e61 6c20 6372 6561 7469  dditional creati
+00057ac0: 6f6e 206f 6620 6120 636f 6d70 6f73 6974  on of a composit
+00057ad0: 6520 6669 6c65 2069 6e20 7468 6973 2066  e file in this f
+00057ae0: 6f72 6d61 742e 0d0a 0909 096d 6174 706c  ormat......matpl
+00057af0: 6f74 6c69 6220 616c 6c6f 7773 2074 6865  otlib allows the
+00057b00: 2073 6176 696e 6720 6f66 2066 6967 7572   saving of figur
+00057b10: 6573 2069 6e20 7661 7269 6f75 7320 666f  es in various fo
+00057b20: 726d 6174 732e 2028 4465 6661 756c 7429  rmats. (Default)
+00057b30: 2022 706e 6722 2c20 0d0a 0909 0974 7970   "png", .....typ
+00057b40: 6963 616c 2061 6e64 2072 6563 6f6d 6d65  ical and recomme
+00057b50: 6e64 6162 6c65 206f 7074 696f 6e73 2061  ndable options a
+00057b60: 7265 2022 7376 6722 2061 6e64 2022 7064  re "svg" and "pd
+00057b70: 6622 2e20 200d 0a09 0909 0d0a 0909 7469  f".  .........ti
+00057b80: 746c 6520 3a20 4e6f 6e65 206f 7220 7374  tle : None or st
+00057b90: 722c 206f 7074 696f 6e61 6c0d 0a09 0909  r, optional.....
+00057ba0: 2844 6566 6175 6c74 2920 4e6f 6e65 2c20  (Default) None, 
+00057bb0: 5573 6520 7468 6973 2074 6974 6c65 206f  Use this title o
+00057bc0: 6e20 616c 6c20 706c 6f74 732e 2069 6620  n all plots. if 
+00057bd0: 4e6f 6e65 2c20 7573 6520 7365 6c66 2e66  None, use self.f
+00057be0: 696c 656e 616d 650d 0a09 0909 0d0a 0909  ilename.........
+00057bf0: 6669 6c65 6e61 6d65 203a 2073 7472 2c20  filename : str, 
+00057c00: 6f70 7469 6f6e 616c 0d0a 0909 0928 4465  optional.....(De
+00057c10: 6661 756c 7429 204e 6f6e 652c 2042 6173  fault) None, Bas
+00057c20: 6520 6e61 6d65 2066 6f72 2061 6c6c 2070  e name for all p
+00057c30: 6c6f 7473 2e20 4966 204e 6f6e 652c 2074  lots. If None, t
+00057c40: 6865 6e20 7365 6c66 2e66 696c 656e 616d  hen self.filenam
+00057c50: 6520 7769 6c6c 2062 6520 7573 6564 0d0a  e will be used..
+00057c60: 0909 090d 0a09 0973 6361 6c65 5f74 7970  .......scale_typ
+00057c70: 6520 3a20 7374 722c 206f 7074 696f 6e61  e : str, optiona
+00057c80: 6c0d 0a09 0909 2773 796d 6c6f 6727 2028  l.....'symlog' (
+00057c90: 4465 6661 756c 7429 2c20 276c 696e 6561  Default), 'linea
+00057ca0: 7227 2c20 276c 6f67 2720 7469 6d65 2061  r', 'log' time a
+00057cb0: 7869 730d 0a09 0909 0d0a 0909 7061 7463  xis.........patc
+00057cc0: 6865 7320 3a20 626f 6f6c 2c20 6f70 7469  hes : bool, opti
+00057cd0: 6f6e 616c 0d0a 0909 0946 6f72 2074 7275  onal.....For tru
+00057ce0: 6520 7573 6520 7768 6974 6520 7061 7463  e use white patc
+00057cf0: 6865 7320 746f 206c 6162 656c 2074 6869  hes to label thi
+00057d00: 6e67 7320 696e 2074 6865 2032 6420 6d61  ngs in the 2d ma
+00057d10: 7472 6978 6573 2c20 746f 2073 6166 650d  trixes, to safe.
+00057d20: 0a09 0909 7370 6163 6520 666f 7220 7075  ....space for pu
+00057d30: 626c 6963 6174 696f 6e0d 0a09 0909 0d0a  blication.......
+00057d40: 0909 636d 6170 203a 204e 6f6e 6520 6f72  ..cmap : None or
+00057d50: 206d 6174 706c 6f74 6c69 6220 636f 6c6f   matplotlib colo
+00057d60: 7220 6d61 702c 206f 7074 696f 6e61 6c0d  r map, optional.
+00057d70: 0a09 0909 6973 2061 2070 6f77 6572 6675  ....is a powerfu
+00057d80: 6c6c 2076 6172 6961 626c 6520 7468 6174  ll variable that
+00057d90: 2063 686f 6f73 6573 2074 6865 2063 6f6c   chooses the col
+00057da0: 6f75 7220 6d61 7020 6170 706c 6965 6420  our map applied 
+00057db0: 666f 7220 616c 6c20 706c 6f74 732e 2049  for all plots. I
+00057dc0: 6620 7365 7420 746f 200d 0a09 0909 4e6f  f set to .....No
+00057dd0: 6e65 2028 4465 6661 756c 7429 2074 6865  ne (Default) the
+00057de0: 6e20 7468 6520 7365 6c66 2e63 6d61 7020  n the self.cmap 
+00057df0: 6973 2075 7365 642e 0d0a 0909 0941 7320  is used......As 
+00057e00: 7374 616e 6461 7264 2049 2075 7365 2074  standard I use t
+00057e10: 6865 2063 6f6c 6f72 206d 6170 2022 6a65  he color map "je
+00057e20: 7422 2066 726f 6d20 6d61 7470 6c6f 746c  t" from matplotl
+00057e30: 6962 2e20 5468 6572 6520 6172 6520 6120  ib. There are a 
+00057e40: 7661 7269 6574 7920 6f66 2063 6f6c 6f72  variety of color
+00057e50: 6d61 7073 200d 0a09 0909 6176 6169 6c61  maps .....availa
+00057e60: 626c 6520 7468 6174 2061 7265 2076 6572  ble that are ver
+00057e70: 7920 7573 6566 756c 6c2e 2042 6573 6964  y usefull. Besid
+00057e80: 6520 226a 6574 222c 2022 7669 7269 6469  e "jet", "viridi
+00057e90: 7322 2069 7320 6120 676f 6f64 2063 686f  s" is a good cho
+00057ea0: 6963 6520 6173 2069 7420 6973 2077 656c  ice as it is wel
+00057eb0: 6c20 0d0a 0909 0976 6973 6962 6c65 2075  l .....visible u
+00057ec0: 6e64 6572 2072 6564 2d67 7265 656e 2062  nder red-green b
+00057ed0: 6c69 6e64 6e65 7373 2e20 4f74 6865 7220  lindness. Other 
+00057ee0: 7573 6566 756c 206d 6170 7320 6172 6520  useful maps are 
+00057ef0: 2270 7269 736d 2220 666f 7220 6869 6768  "prism" for high
+00057f00: 2066 6c75 6374 7561 7469 6f6e 7320 0d0a   fluctuations ..
+00057f10: 0909 096f 7220 6469 7665 7267 696e 6720  ...or diverging 
+00057f20: 636f 6c6f 7220 6d61 7073 206c 696b 6520  color maps like 
+00057f30: 2273 6569 736d 6963 222e 200d 0a09 0909  "seismic". .....
+00057f40: 5365 6520 6874 7470 733a 2f2f 6d61 7470  See https://matp
+00057f50: 6c6f 746c 6962 2e6f 7267 2f33 2e31 2e30  lotlib.org/3.1.0
+00057f60: 2f74 7574 6f72 6961 6c73 2f63 6f6c 6f72  /tutorials/color
+00057f70: 732f 636f 6c6f 726d 6170 732e 6874 6d6c  s/colormaps.html
+00057f80: 2066 6f72 2061 2063 6f6d 7072 6568 656e   for a comprehen
+00057f90: 7369 7665 200d 0a09 0909 7365 6c65 6374  sive .....select
+00057fa0: 696f 6e2e 2049 6e20 7468 6520 636f 6465  ion. In the code
+00057fb0: 2074 6865 2063 6f6c 6f72 6d61 7073 2061   the colormaps a
+00057fc0: 7265 2069 6d70 6f72 7465 6420 736f 2069  re imported so i
+00057fd0: 6620 706c 6f74 5f66 756e 6320 6973 2069  f plot_func is i
+00057fe0: 6d70 6f72 7465 6420 6173 2070 6620 7468  mported as pf th
+00057ff0: 656e 200d 0a09 0909 7365 6c66 2e63 6d61  en .....self.cma
+00058000: 703d 7066 2e63 6d2e 7669 7269 6469 7320  p=pf.cm.viridis 
+00058010: 7365 7473 2076 6972 6964 6973 2061 7320  sets viridis as 
+00058020: 7468 6520 6d61 7020 746f 2075 7365 2e20  the map to use. 
+00058030: 496e 7465 726e 616c 6c79 2074 6865 2063  Internally the c
+00058040: 6f6c 6f72 7320 6172 6520 6368 6f73 656e  olors are chosen
+00058050: 200d 0a09 0909 7769 7468 2074 6865 2022   .....with the "
+00058060: 636f 6c6d 2220 6675 6e63 7469 6f6e 2e20  colm" function. 
+00058070: 5468 6520 3264 2070 6c6f 7473 2072 6571  The 2d plots req
+00058080: 7569 7265 2061 2063 6f6e 7469 6e75 6f75  uire a continuou
+00058090: 7320 636f 6c6f 7220 6d61 7020 736f 2069  s color map so i
+000580a0: 6620 736f 6d65 7468 696e 6720 0d0a 0909  f something ....
+000580b0: 0965 6c73 6520 6973 2067 6976 6520 3264  .else is give 2d
+000580c0: 2070 6c6f 7473 2061 7265 2073 686f 776e   plots are shown
+000580d0: 2061 7574 6f6d 6174 6963 616c 6c79 2077   automatically w
+000580e0: 6974 6820 226a 6574 222e 2046 6f72 2061  ith "jet". For a
+000580f0: 6c6c 206f 6620 7468 6520 3164 2070 6c6f  ll of the 1d plo
+00058100: 7473 2068 6f77 6576 6572 200d 0a09 0909  ts however .....
+00058110: 4920 6669 7273 7420 7365 6c65 6374 2061  I first select a
+00058120: 206e 756d 6265 7220 6f66 2063 6f6c 6f72   number of color
+00058130: 7320 6265 666f 7265 2065 6163 6820 706c  s before each pl
+00058140: 6f74 2e20 4966 2063 6d61 7020 6973 2061  ot. If cmap is a
+00058150: 2063 6f6e 7469 6e6f 7573 206d 6170 2074   continous map t
+00058160: 6865 6e20 7468 6573 650d 0a09 0909 6172  hen these.....ar
+00058170: 6520 7361 6d70 6c65 6420 6576 656e 6c79  e sampled evenly
+00058180: 206f 7665 7220 7468 6520 636f 6c6f 7572   over the colour
+00058190: 6d61 702e 204d 616e 7561 6c20 6974 6572  map. Manual iter
+000581a0: 6162 6c65 7320 6f66 2063 6f6c 6f75 7273  ables of colours
+000581b0: 200d 0a09 0909 636d 6170 3d5b 2831 2c30   .....cmap=[(1,0
+000581c0: 2c30 292c 2830 2c31 2c30 292c 2830 2c30  ,0),(0,1,0),(0,0
+000581d0: 2c31 292c 2e2e 2e5d 2061 7265 2061 6c73  ,1),...] are als
+000581e0: 6f20 6163 6365 7074 6564 2c20 6173 2061  o accepted, as a
+000581f0: 7265 2076 6563 746f 7273 206f 7220 6461  re vectors or da
+00058200: 7461 6672 616d 6573 2074 6861 7420 0d0a  taframes that ..
+00058210: 0909 0963 6f6e 7461 696e 2061 7320 726f  ...contain as ro
+00058220: 7773 2074 6865 2063 6f6c 6f72 732e 2054  ws the colors. T
+00058230: 6865 7265 206d 7573 7420 6265 206f 6620  here must be of 
+00058240: 636f 7572 7365 2073 7566 6669 6369 656e  course sufficien
+00058250: 7420 636f 6c6f 7273 2070 7265 7365 6e74  t colors present
+00058260: 2066 6f72 200d 0a09 0909 7468 6520 6e75   for .....the nu
+00058270: 6d62 6572 7320 6f66 206c 696e 6573 2074  mbers of lines t
+00058280: 6861 7420 7769 6c6c 2062 6520 706c 6f74  hat will be plot
+00058290: 7465 642e 2053 6f20 4920 7265 636f 6d6d  ted. So I recomm
+000582a0: 656e 6420 746f 2070 726f 7669 6465 2061  end to provide a
+000582b0: 7420 6c65 6173 7420 3130 2063 6f6c 6f75  t least 10 colou
+000582c0: 7273 200d 0a09 0909 2865 2e67 2e7e 796f  rs .....(e.g.~yo
+000582d0: 7572 2075 6e69 7665 7273 6974 7920 636f  ur university co
+000582e0: 6c6f 7273 292e 2063 6f6c 6f75 7273 2061  lors). colours a
+000582f0: 7265 2061 6c77 6179 7320 6769 7665 6e20  re always given 
+00058300: 6173 2061 2c20 6c69 7374 206f 7220 7475  as a, list or tu
+00058310: 706c 6520 7769 7468 2052 4741 206f 7220  ple with RGA or 
+00058320: 5247 4241 0d0a 0909 0928 7769 7468 2074  RGBA.....(with t
+00058330: 6865 206c 6173 7420 4120 6265 6569 6e67  he last A beeing
+00058340: 2074 6865 2041 6c70 6861 3d74 7261 6e73   the Alpha=trans
+00058350: 7061 7265 6e63 792e 2041 6c6c 206e 756d  parency. All num
+00058360: 6265 7273 2061 7265 2062 6574 7765 656e  bers are between
+00058370: 2030 2061 6e64 2031 2e20 0d0a 0909 0949   0 and 1. .....I
+00058380: 6620 6120 6c69 7374 2f76 6563 746f 722f  f a list/vector/
+00058390: 4461 7461 4672 616d 6520 6973 2067 6976  DataFrame is giv
+000583a0: 656e 2066 6f72 2074 6865 2063 6f6c 6f75  en for the colou
+000583b0: 7273 2074 6865 7920 7769 6c6c 2062 6520  rs they will be 
+000583c0: 7573 6564 2069 6e20 7468 6520 6f72 6465  used in the orde
+000583d0: 7220 7072 6f76 6964 6564 2e0d 0a09 090d  r provided......
+000583e0: 0a09 0945 7861 6d70 6c65 730d 0a09 092d  ...Examples....-
+000583f0: 2d2d 2d2d 2d2d 2d2d 0d0a 0909 0d0a 0909  --------........
+00058400: 3e3e 3e20 7461 2e53 6176 655f 506f 7765  >>> ta.Save_Powe
+00058410: 7270 6f69 6e74 2829 0d0a 0909 3e3e 3e20  rpoint()....>>> 
+00058420: 7461 2e53 6176 655f 506f 7765 7270 6f69  ta.Save_Powerpoi
+00058430: 6e74 2870 6174 6368 6573 203d 2054 7275  nt(patches = Tru
+00058440: 6529 0d0a 0909 0d0a 0909 2727 2709 0909  e)........'''...
+00058450: 0909 0920 0d0a 0909 6966 2069 7369 6e73  ... ....if isins
+00058460: 7461 6e63 6528 7361 7665 7479 7065 2c74  tance(savetype,t
+00058470: 7970 6528 2768 656c 6c6f 2729 293a 7361  ype('hello')):sa
+00058480: 7665 7479 7065 3d5b 7361 7665 7479 7065  vetype=[savetype
+00058490: 5d0d 0a09 0969 6620 6e6f 7420 6861 7361  ]....if not hasa
+000584a0: 7474 7228 7361 7665 7479 7065 2c22 5f5f  ttr(savetype,"__
+000584b0: 6974 6572 5f5f 2229 3a73 6176 6574 7970  iter__"):savetyp
+000584c0: 653d 5b73 6176 6574 7970 655d 0d0a 0909  e=[savetype]....
+000584d0: 7261 775f 6e61 6d65 733d 5b22 4d41 5422  raw_names=["MAT"
+000584e0: 2c22 5345 4c22 2c22 5350 454b 222c 2253  ,"SEL","SPEK","S
+000584f0: 5644 225d 0d0a 0909 7261 775f 6e61 6d65  VD"]....raw_name
+00058500: 733d 5b63 6865 636b 5f66 6f6c 6465 7228  s=[check_folder(
+00058510: 6375 7272 656e 745f 7061 7468 3d73 656c  current_path=sel
+00058520: 662e 7061 7468 2c20 7061 7468 3d70 6174  f.path, path=pat
+00058530: 682c 2066 696c 656e 616d 653d 7365 6c66  h, filename=self
+00058540: 2e66 696c 656e 616d 652e 7370 6c69 7428  .filename.split(
+00058550: 272e 2729 5b30 5d20 2b20 225f 5241 575f  '.')[0] + "_RAW_
+00058560: 222b 7374 7228 6129 202b 222e 706e 6722  "+str(a) +".png"
+00058570: 2920 666f 7220 6120 696e 2072 6177 5f6e  ) for a in raw_n
+00058580: 616d 6573 5d0d 0a09 0966 6974 5f6e 616d  ames]....fit_nam
+00058590: 6573 3d5b 2246 4947 5f4d 4154 222c 2253  es=["FIG_MAT","S
+000585a0: 5045 4322 2c22 5345 4c22 2c22 5355 4d22  PEC","SEL","SUM"
+000585b0: 2c22 4441 4322 5d0d 0a09 0966 6974 5f6e  ,"DAC"]....fit_n
+000585c0: 616d 6573 3d5b 6368 6563 6b5f 666f 6c64  ames=[check_fold
+000585d0: 6572 2863 7572 7265 6e74 5f70 6174 683d  er(current_path=
+000585e0: 7365 6c66 2e70 6174 682c 2070 6174 683d  self.path, path=
+000585f0: 7061 7468 2c20 6669 6c65 6e61 6d65 3d73  path, filename=s
+00058600: 656c 662e 6669 6c65 6e61 6d65 2e73 706c  elf.filename.spl
+00058610: 6974 2827 2e27 295b 305d 202b 2022 5f22  it('.')[0] + "_"
+00058620: 202b 7374 7228 6129 202b 222e 706e 6722   +str(a) +".png"
+00058630: 2920 666f 7220 6120 696e 2066 6974 5f6e  ) for a in fit_n
+00058640: 616d 6573 5d0d 0a09 0970 6c74 2e63 6c6f  ames]....plt.clo
+00058650: 7365 2827 616c 6c27 290d 0a09 096f 7269  se('all')....ori
+00058660: 6769 6e3d 7365 6c66 2e73 6176 655f 6669  gin=self.save_fi
+00058670: 6775 7265 735f 746f 5f66 6f6c 6465 720d  gures_to_folder.
+00058680: 0a09 0969 6620 6669 6c65 6e61 6d65 2069  ...if filename i
+00058690: 7320 4e6f 6e65 3a0d 0a09 0909 6669 6c65  s None:.....file
+000586a0: 6e61 6d65 3d73 656c 662e 6669 6c65 6e61  name=self.filena
+000586b0: 6d65 0d0a 0909 0966 696c 656e 616d 653d  me.....filename=
+000586c0: 6669 6c65 6e61 6d65 2e73 706c 6974 2827  filename.split('
+000586d0: 2e27 295b 305d 0d0a 0909 6966 2073 6176  .')[0]....if sav
+000586e0: 655f 5241 573a 0d0a 0909 0973 656c 662e  e_RAW:.....self.
+000586f0: 7361 7665 5f66 6967 7572 6573 5f74 6f5f  save_figures_to_
+00058700: 666f 6c64 6572 3d54 7275 650d 0a09 0909  folder=True.....
+00058710: 7365 6c66 2e50 6c6f 745f 5241 5728 7361  self.Plot_RAW(sa
+00058720: 7665 7479 7065 203d 2027 706e 6727 2c20  vetype = 'png', 
+00058730: 7363 616c 655f 7479 7065 203d 2073 6361  scale_type = sca
+00058740: 6c65 5f74 7970 652c 2074 6974 6c65 203d  le_type, title =
+00058750: 2074 6974 6c65 2c20 636d 6170 203d 2063   title, cmap = c
+00058760: 6d61 702c 2070 6174 6820 3d20 7061 7468  map, path = path
+00058770: 2909 0d0a 0909 0970 6c74 2e63 6c6f 7365  )......plt.close
+00058780: 2827 616c 6c27 290d 0a09 0969 6620 7361  ('all')....if sa
+00058790: 7665 5f46 6974 3a0d 0a09 0909 7472 793a  ve_Fit:.....try:
+000587a0: 0d0a 0909 0909 7365 6c66 2e73 6176 655f  ......self.save_
+000587b0: 6669 6775 7265 735f 746f 5f66 6f6c 6465  figures_to_folde
+000587c0: 723d 5472 7565 0d0a 0909 0909 7365 6c66  r=True......self
+000587d0: 2e50 6c6f 745f 6669 745f 6f75 7470 7574  .Plot_fit_output
+000587e0: 2873 6176 6574 7970 6520 3d20 2770 6e67  (savetype = 'png
+000587f0: 272c 2073 6361 6c65 5f74 7970 6520 3d20  ', scale_type = 
+00058800: 7363 616c 655f 7479 7065 2c20 7469 746c  scale_type, titl
+00058810: 6520 3d20 7469 746c 652c 2070 6174 6368  e = title, patch
+00058820: 6573 203d 2070 6174 6368 6573 2c20 636d  es = patches, cm
+00058830: 6170 203d 2063 6d61 7020 2c20 7061 7468  ap = cmap , path
+00058840: 203d 2070 6174 6829 0d0a 0909 0909 706c   = path)......pl
+00058850: 742e 636c 6f73 6528 2761 6c6c 2729 0d0a  t.close('all')..
+00058860: 0909 0965 7863 6570 743a 0d0a 0909 0909  ...except:......
+00058870: 7361 7665 5f46 6974 203d 2046 616c 7365  save_Fit = False
+00058880: 0d0a 0909 0909 7072 696e 7428 2772 756e  ......print('run
+00058890: 2069 6e74 6f20 7072 6f62 6c65 6d73 2077   into problems w
+000588a0: 6974 6820 6164 6469 6e67 2074 6865 2066  ith adding the f
+000588b0: 6974 2072 6573 756c 7473 2e20 4861 7665  it results. Have
+000588c0: 2079 6f75 2066 6974 7465 6420 736f 6d65   you fitted some
+000588d0: 7468 696e 673f 2729 0d0a 0909 0974 7279  thing?').....try
+000588e0: 3a0d 0a09 0909 0952 6573 756c 745f 7374  :......Result_st
+000588f0: 7269 6e67 3d27 5c6e 4669 7420 5265 7375  ring='\nFit Resu
+00058900: 6c74 733a 5c6e 270d 0a09 0909 0969 6620  lts:\n'......if 
+00058910: 6973 696e 7374 616e 6365 2873 656c 662e  isinstance(self.
+00058920: 6d6f 642c 7479 7065 2827 6865 6c6c 6f27  mod,type('hello'
+00058930: 2929 3a0d 0a09 0909 0909 5265 7375 6c74  )):.......Result
+00058940: 5f73 7472 696e 672b 3d27 4d6f 6465 6c20  _string+='Model 
+00058950: 5573 6564 3a20 2573 5c6e 5c6e 2725 7365  Used: %s\n\n'%se
+00058960: 6c66 2e6d 6f64 0d0a 0909 0909 656c 7365  lf.mod......else
+00058970: 3a0d 0a09 0909 0909 5265 7375 6c74 5f73  :.......Result_s
+00058980: 7472 696e 672b 3d27 4d6f 6465 6c20 5573  tring+='Model Us
+00058990: 6564 3a20 4578 7465 726e 616c 2066 756e  ed: External fun
+000589a0: 6374 696f 6e5c 6e5c 6e27 0d0a 0909 0909  ction\n\n'......
+000589b0: 6966 2073 656c 662e 6967 6e6f 7265 5f74  if self.ignore_t
+000589c0: 696d 655f 7265 6769 6f6e 2069 7320 6e6f  ime_region is no
+000589d0: 7420 4e6f 6e65 3a0d 0a09 0909 0909 5265  t None:.......Re
+000589e0: 7375 6c74 5f73 7472 696e 672b 3d27 7468  sult_string+='th
+000589f0: 6520 7469 6d65 2062 6574 7765 656e 2025  e time between %
+00058a00: 2e33 6620 2573 2061 6e64 2025 2e33 6620  .3f %s and %.3f 
+00058a10: 2573 205c 6e20 7761 7320 6578 636c 7564  %s \n was exclud
+00058a20: 6564 2066 726f 6d20 7468 6520 6f70 7469  ed from the opti
+00058a30: 6d69 7a61 7469 6f6e 5c6e 2725 2873 656c  mization\n'%(sel
+00058a40: 662e 6967 6e6f 7265 5f74 696d 655f 7265  f.ignore_time_re
+00058a50: 6769 6f6e 5b30 5d2c 7365 6c66 2e62 6173  gion[0],self.bas
+00058a60: 6575 6e69 742c 7365 6c66 2e69 676e 6f72  eunit,self.ignor
+00058a70: 655f 7469 6d65 5f72 6567 696f 6e5b 315d  e_time_region[1]
+00058a80: 2c73 656c 662e 6261 7365 756e 6974 2909  ,self.baseunit).
+00058a90: 0d0a 0909 0909 5265 7375 6c74 5f73 7472  ......Result_str
+00058aa0: 696e 672b 3d27 5468 6520 6d69 6e69 6d75  ing+='The minimu
+00058ab0: 6d20 6572 726f 7220 6973 3a7b 3a2e 3865  m error is:{:.8e
+00058ac0: 7d5c 6e27 2e66 6f72 6d61 7428 7365 6c66  }\n'.format(self
+00058ad0: 2e72 655b 2765 7272 6f72 275d 290d 0a09  .re['error'])...
+00058ae0: 0909 0952 6573 756c 745f 7374 7269 6e67  ...Result_string
+00058af0: 2b3d 2754 6865 206d 696e 696d 756d 2052  +='The minimum R
+00058b00: 322d 7661 6c75 6520 6973 3a7b 3a2e 3865  2-value is:{:.8e
+00058b10: 7d5c 6e27 2e66 6f72 6d61 7428 7365 6c66  }\n'.format(self
+00058b20: 2e72 655b 2772 3227 5d29 0d0a 0909 0909  .re['r2'])......
+00058b30: 6966 2027 636f 6e66 6964 656e 6365 2720  if 'confidence' 
+00058b40: 696e 2073 656c 662e 7265 3a0d 0a09 0909  in self.re:.....
+00058b50: 0909 5265 7375 6c74 5f73 7472 696e 672b  ..Result_string+
+00058b60: 3d27 5c6e 496e 2052 6174 6573 2077 6974  ='\nIn Rates wit
+00058b70: 6820 636f 6e66 6964 656e 6365 2069 6e74  h confidence int
+00058b80: 6572 7661 6c20 746f 206c 6576 656c 206f  erval to level o
+00058b90: 6620 2573 5c6e 2725 7365 6c66 2e72 655b  f %s\n'%self.re[
+00058ba0: 2763 6f6e 6669 6465 6e63 6527 5d5b 2774  'confidence']['t
+00058bb0: 6172 6765 742d 6c65 7665 6c27 5d0d 0a09  arget-level']...
+00058bc0: 0909 0909 5265 7375 6c74 5f73 7472 696e  ....Result_strin
+00058bd0: 672b 3d73 656c 662e 7265 5b27 6669 745f  g+=self.re['fit_
+00058be0: 7265 7375 6c74 735f 7261 7465 7327 5d2e  results_rates'].
+00058bf0: 746f 5f73 7472 696e 6728 636f 6c75 6d6e  to_string(column
+00058c00: 733d 5b27 7661 6c75 6527 2c27 6c6f 7765  s=['value','lowe
+00058c10: 725f 6c69 6d69 7427 2c27 7570 7065 725f  r_limit','upper_
+00058c20: 6c69 6d69 7427 2c27 696e 6974 5f76 616c  limit','init_val
+00058c30: 7565 272c 2776 6172 7927 2c27 6d69 6e27  ue','vary','min'
+00058c40: 2c27 6d61 7827 2c27 6578 7072 275d 290d  ,'max','expr']).
+00058c50: 0a09 0909 0909 5265 7375 6c74 5f73 7472  ......Result_str
+00058c60: 696e 672b 3d27 5c6e 5c6e 5468 6520 7261  ing+='\n\nThe ra
+00058c70: 7465 7320 636f 6e76 6572 7465 6420 746f  tes converted to
+00058c80: 2074 696d 6573 2077 6974 6820 756e 6974   times with unit
+00058c90: 2025 735c 6e20 7769 7468 2063 6f6e 6669   %s\n with confi
+00058ca0: 6465 6e63 6520 696e 7465 7276 616c 2074  dence interval t
+00058cb0: 6f20 6c65 7665 6c20 6f66 2025 735c 6e27  o level of %s\n'
+00058cc0: 2528 7365 6c66 2e62 6173 6575 6e69 742c  %(self.baseunit,
+00058cd0: 7365 6c66 2e72 655b 2763 6f6e 6669 6465  self.re['confide
+00058ce0: 6e63 6527 5d5b 2774 6172 6765 742d 6c65  nce']['target-le
+00058cf0: 7665 6c27 5d29 0d0a 0909 0909 0952 6573  vel']).......Res
+00058d00: 756c 745f 7374 7269 6e67 2b3d 7365 6c66  ult_string+=self
+00058d10: 2e72 655b 2766 6974 5f72 6573 756c 7473  .re['fit_results
+00058d20: 5f74 696d 6573 275d 2e74 6f5f 7374 7269  _times'].to_stri
+00058d30: 6e67 2863 6f6c 756d 6e73 3d5b 2776 616c  ng(columns=['val
+00058d40: 7565 272c 276c 6f77 6572 5f6c 696d 6974  ue','lower_limit
+00058d50: 272c 2775 7070 6572 5f6c 696d 6974 272c  ','upper_limit',
+00058d60: 2769 6e69 745f 7661 6c75 6527 2c27 7661  'init_value','va
+00058d70: 7279 272c 276d 696e 272c 276d 6178 272c  ry','min','max',
+00058d80: 2765 7870 7227 5d29 0d0a 0909 0909 656c  'expr'])......el
+00058d90: 7365 3a0d 0a09 0909 0909 5265 7375 6c74  se:.......Result
+00058da0: 5f73 7472 696e 672b 3d27 5c6e 496e 2052  _string+='\nIn R
+00058db0: 6174 6573 5c6e 270d 0a09 0909 0909 5265  ates\n'.......Re
+00058dc0: 7375 6c74 5f73 7472 696e 672b 3d73 656c  sult_string+=sel
+00058dd0: 662e 7265 5b27 6669 745f 7265 7375 6c74  f.re['fit_result
+00058de0: 735f 7261 7465 7327 5d2e 746f 5f73 7472  s_rates'].to_str
+00058df0: 696e 6728 636f 6c75 6d6e 733d 5b27 7661  ing(columns=['va
+00058e00: 6c75 6527 2c27 696e 6974 5f76 616c 7565  lue','init_value
+00058e10: 272c 2776 6172 7927 2c27 6d69 6e27 2c27  ','vary','min','
+00058e20: 6d61 7827 2c27 6578 7072 275d 290d 0a09  max','expr'])...
+00058e30: 0909 0909 5265 7375 6c74 5f73 7472 696e  ....Result_strin
+00058e40: 672b 3d27 5c6e 5c6e 5468 6520 7261 7465  g+='\n\nThe rate
+00058e50: 7320 636f 6e76 6572 7465 6420 746f 2074  s converted to t
+00058e60: 696d 6573 2077 6974 6820 756e 6974 2025  imes with unit %
+00058e70: 735c 6e27 2573 656c 662e 6261 7365 756e  s\n'%self.baseun
+00058e80: 6974 0d0a 0909 0909 0952 6573 756c 745f  it.......Result_
+00058e90: 7374 7269 6e67 2b3d 7365 6c66 2e72 655b  string+=self.re[
+00058ea0: 2766 6974 5f72 6573 756c 7473 5f74 696d  'fit_results_tim
+00058eb0: 6573 275d 2e74 6f5f 7374 7269 6e67 2863  es'].to_string(c
+00058ec0: 6f6c 756d 6e73 3d5b 2776 616c 7565 272c  olumns=['value',
+00058ed0: 2769 6e69 745f 7661 6c75 6527 2c27 7661  'init_value','va
+00058ee0: 7279 272c 276d 696e 272c 276d 6178 272c  ry','min','max',
+00058ef0: 2765 7870 7227 5d29 0d0a 0909 0965 7863  'expr']).....exc
+00058f00: 6570 743a 0d0a 0909 0909 7061 7373 0d0a  ept:......pass..
+00058f10: 0909 6966 2028 2770 6466 2720 696e 2073  ..if ('pdf' in s
+00058f20: 6176 6574 7970 6529 206f 7220 2827 706e  avetype) or ('pn
+00058f30: 6727 2069 6e20 7361 7665 7479 7065 2920  g' in savetype) 
+00058f40: 6f72 2028 2773 7667 2720 696e 2073 6176  or ('svg' in sav
+00058f50: 6574 7970 6529 3a0d 0a09 0909 6966 2073  etype):.....if s
+00058f60: 6176 655f 5241 573a 0d0a 0909 0909 6669  ave_RAW:......fi
+00058f70: 672c 6178 3d70 6c74 2e73 7562 706c 6f74  g,ax=plt.subplot
+00058f80: 7328 6e72 6f77 733d 322c 6e63 6f6c 733d  s(nrows=2,ncols=
+00058f90: 322c 6669 6773 697a 653d 2831 302c 372e  2,figsize=(10,7.
+00058fa0: 3529 290d 0a09 0909 0961 785b 302c 315d  5))......ax[0,1]
+00058fb0: 2e69 6d73 686f 7728 6d70 696d 672e 696d  .imshow(mpimg.im
+00058fc0: 7265 6164 2873 7472 2872 6177 5f6e 616d  read(str(raw_nam
+00058fd0: 6573 5b30 5d29 2929 0d0a 0909 0909 6178  es[0])))......ax
+00058fe0: 5b30 2c30 5d2e 696d 7368 6f77 286d 7069  [0,0].imshow(mpi
+00058ff0: 6d67 2e69 6d72 6561 6428 7374 7228 7261  mg.imread(str(ra
+00059000: 775f 6e61 6d65 735b 315d 2929 290d 0a09  w_names[1])))...
+00059010: 0909 0961 785b 312c 305d 2e69 6d73 686f  ...ax[1,0].imsho
+00059020: 7728 6d70 696d 672e 696d 7265 6164 2873  w(mpimg.imread(s
+00059030: 7472 2872 6177 5f6e 616d 6573 5b32 5d29  tr(raw_names[2])
+00059040: 2929 0d0a 0909 0909 6178 5b31 2c31 5d2e  ))......ax[1,1].
+00059050: 696d 7368 6f77 286d 7069 6d67 2e69 6d72  imshow(mpimg.imr
+00059060: 6561 6428 7374 7228 7261 775f 6e61 6d65  ead(str(raw_name
+00059070: 735b 335d 2929 290d 0a09 0909 0961 785b  s[3])))......ax[
+00059080: 302c 305d 2e61 7869 7328 276f 6666 2729  0,0].axis('off')
+00059090: 3b61 785b 312c 305d 2e61 7869 7328 276f  ;ax[1,0].axis('o
+000590a0: 6666 2729 3b61 785b 302c 315d 2e61 7869  ff');ax[0,1].axi
+000590b0: 7328 276f 6666 2729 3b61 785b 312c 315d  s('off');ax[1,1]
+000590c0: 2e61 7869 7328 276f 6666 2729 0d0a 0909  .axis('off')....
+000590d0: 0909 666f 7220 656e 7472 7920 696e 2073  ..for entry in s
+000590e0: 6176 6574 7970 653a 0d0a 0909 0909 0969  avetype:.......i
+000590f0: 6620 656e 7472 7920 3d3d 2022 7070 7478  f entry == "pptx
+00059100: 223a 636f 6e74 696e 7565 0d0a 0909 0909  ":continue......
+00059110: 0974 7279 3a0d 0a09 0909 0909 0966 6967  .try:........fig
+00059120: 2e74 6967 6874 5f6c 6179 6f75 7428 290d  .tight_layout().
+00059130: 0a09 0909 0909 0966 6967 2e73 6176 6566  .......fig.savef
+00059140: 6967 2863 6865 636b 5f66 6f6c 6465 7228  ig(check_folder(
+00059150: 7061 7468 3d70 6174 682c 6375 7272 656e  path=path,curren
+00059160: 745f 7061 7468 3d73 656c 662e 7061 7468  t_path=self.path
+00059170: 2c66 696c 656e 616d 653d 7365 6c66 2e66  ,filename=self.f
+00059180: 696c 656e 616d 652e 7370 6c69 7428 272e  ilename.split('.
+00059190: 2729 5b30 5d20 2b20 275f 5241 572d 7375  ')[0] + '_RAW-su
+000591a0: 6d6d 6172 792e 2573 2725 656e 7472 7929  mmary.%s'%entry)
+000591b0: 2c64 7069 3d36 3030 290d 0a09 0909 0909  ,dpi=600).......
+000591c0: 6578 6365 7074 3a0d 0a09 0909 0909 0970  except:........p
+000591d0: 7269 6e74 2822 7361 7669 6e67 2069 6e22  rint("saving in"
+000591e0: 202b 2065 6e74 7279 202b 2266 6169 6c65   + entry +"faile
+000591f0: 6422 290d 0a09 0909 6966 2073 6176 655f  d").....if save_
+00059200: 4669 743a 0d0a 0909 0909 4720 3d20 4772  Fit:......G = Gr
+00059210: 6964 5370 6563 2834 2c20 3829 0d0a 0909  idSpec(4, 8)....
+00059220: 0909 6669 6731 3d70 6c74 2e66 6967 7572  ..fig1=plt.figur
+00059230: 6528 6669 6773 697a 653d 2831 302c 372e  e(figsize=(10,7.
+00059240: 3529 290d 0a09 0909 0961 7831 3d66 6967  5))......ax1=fig
+00059250: 312e 6164 645f 7375 6270 6c6f 7428 475b  1.add_subplot(G[
+00059260: 302c 3a36 5d29 0d0a 0909 0909 6178 323d  0,:6])......ax2=
+00059270: 6669 6731 2e61 6464 5f73 7562 706c 6f74  fig1.add_subplot
+00059280: 2847 5b31 2c3a 365d 290d 0a09 0909 0961  (G[1,:6])......a
+00059290: 7833 3d66 6967 312e 6164 645f 7375 6270  x3=fig1.add_subp
+000592a0: 6c6f 7428 475b 322c 3a36 5d29 0d0a 0909  lot(G[2,:6])....
+000592b0: 0909 6178 343d 6669 6731 2e61 6464 5f73  ..ax4=fig1.add_s
+000592c0: 7562 706c 6f74 2847 5b33 2c3a 365d 290d  ubplot(G[3,:6]).
+000592d0: 0a09 0909 0961 7835 3d66 6967 312e 6164  .....ax5=fig1.ad
+000592e0: 645f 7375 6270 6c6f 7428 475b 303a 322c  d_subplot(G[0:2,
+000592f0: 353a 5d29 0d0a 0909 0909 6178 363d 6669  5:])......ax6=fi
+00059300: 6731 2e61 6464 5f73 7562 706c 6f74 2847  g1.add_subplot(G
+00059310: 5b32 3a2c 363a 5d29 0d0a 0909 0909 6178  [2:,6:])......ax
+00059320: 312e 696d 7368 6f77 286d 7069 6d67 2e69  1.imshow(mpimg.i
+00059330: 6d72 6561 6428 7374 7228 6669 745f 6e61  mread(str(fit_na
+00059340: 6d65 735b 315d 2929 290d 0a09 0909 0961  mes[1])))......a
+00059350: 7832 2e69 6d73 686f 7728 6d70 696d 672e  x2.imshow(mpimg.
+00059360: 696d 7265 6164 2873 7472 2866 6974 5f6e  imread(str(fit_n
+00059370: 616d 6573 5b32 5d29 2929 0d0a 0909 0909  ames[2])))......
+00059380: 6178 332e 696d 7368 6f77 286d 7069 6d67  ax3.imshow(mpimg
+00059390: 2e69 6d72 6561 6428 7374 7228 6669 745f  .imread(str(fit_
+000593a0: 6e61 6d65 735b 335d 2929 290d 0a09 0909  names[3]))).....
+000593b0: 0961 7834 2e69 6d73 686f 7728 6d70 696d  .ax4.imshow(mpim
+000593c0: 672e 696d 7265 6164 2873 7472 2866 6974  g.imread(str(fit
+000593d0: 5f6e 616d 6573 5b34 5d29 2929 0d0a 0909  _names[4])))....
+000593e0: 0909 6178 352e 696d 7368 6f77 286d 7069  ..ax5.imshow(mpi
+000593f0: 6d67 2e69 6d72 6561 6428 7374 7228 6669  mg.imread(str(fi
+00059400: 745f 6e61 6d65 735b 305d 2929 290d 0a09  t_names[0])))...
+00059410: 0909 0961 7836 2e74 6578 7428 302c 302c  ...ax6.text(0,0,
+00059420: 5265 7375 6c74 5f73 7472 696e 672c 666f  Result_string,fo
+00059430: 6e74 7369 7a65 3d37 2c66 6f6e 7477 6569  ntsize=7,fontwei
+00059440: 6768 743d 276e 6f72 6d61 6c27 290d 0a09  ght='normal')...
+00059450: 0909 0961 7831 2e61 7869 7328 276f 6666  ...ax1.axis('off
+00059460: 2729 3b61 7832 2e61 7869 7328 276f 6666  ');ax2.axis('off
+00059470: 2729 3b61 7833 2e61 7869 7328 276f 6666  ');ax3.axis('off
+00059480: 2729 3b61 7834 2e61 7869 7328 276f 6666  ');ax4.axis('off
+00059490: 2729 3b61 7835 2e61 7869 7328 276f 6666  ');ax5.axis('off
+000594a0: 2729 3b61 7836 2e61 7869 7328 276f 6666  ');ax6.axis('off
+000594b0: 2729 0d0a 0909 0909 666f 7220 656e 7472  ')......for entr
+000594c0: 7920 696e 2073 6176 6574 7970 653a 0d0a  y in savetype:..
+000594d0: 0909 0909 0969 6620 656e 7472 7920 3d3d  .....if entry ==
+000594e0: 2022 7070 7478 223a 2063 6f6e 7469 6e75   "pptx": continu
+000594f0: 650d 0a09 0909 0909 7472 793a 0d0a 0909  e.......try:....
+00059500: 0909 0909 6669 6731 2e74 6967 6874 5f6c  ....fig1.tight_l
+00059510: 6179 6f75 7428 290d 0a09 0909 0909 0966  ayout()........f
+00059520: 6967 312e 7361 7665 6669 6728 6368 6563  ig1.savefig(chec
+00059530: 6b5f 666f 6c64 6572 2870 6174 683d 7061  k_folder(path=pa
+00059540: 7468 2c63 7572 7265 6e74 5f70 6174 683d  th,current_path=
+00059550: 7365 6c66 2e70 6174 682c 6669 6c65 6e61  self.path,filena
+00059560: 6d65 3d73 656c 662e 6669 6c65 6e61 6d65  me=self.filename
+00059570: 2e73 706c 6974 2827 2e27 295b 305d 202b  .split('.')[0] +
+00059580: 2027 5f46 6974 2d73 756d 6d61 7279 2e25   '_Fit-summary.%
+00059590: 7327 2565 6e74 7279 292c 6470 693d 3630  s'%entry),dpi=60
+000595a0: 3029 0d0a 0909 0909 0965 7863 6570 743a  0).......except:
+000595b0: 0d0a 0909 0909 0909 7072 696e 7428 2273  ........print("s
+000595c0: 6176 696e 6720 696e 2220 2b20 656e 7472  aving in" + entr
+000595d0: 7920 2b22 6661 696c 6564 2229 0d0a 0909  y +"failed")....
+000595e0: 6966 2028 2770 7074 7827 2069 6e20 7361  if ('pptx' in sa
+000595f0: 7665 7479 7065 2920 6f72 2028 2770 7074  vetype) or ('ppt
+00059600: 2720 696e 2073 6176 6574 7970 6529 3a0d  ' in savetype):.
+00059610: 0a09 0909 6c65 6674 3d49 6e63 6865 7328  ....left=Inches(
+00059620: 302e 3229 0d0a 0909 0974 6f70 3d49 6e63  0.2).....top=Inc
+00059630: 6865 7328 302e 3229 0d0a 0909 0970 7273  hes(0.2).....prs
+00059640: 203d 2050 7265 7365 6e74 6174 696f 6e28   = Presentation(
+00059650: 290d 0a09 0909 626c 616e 6b5f 736c 6964  ).....blank_slid
+00059660: 655f 6c61 796f 7574 203d 2070 7273 2e73  e_layout = prs.s
+00059670: 6c69 6465 5f6c 6179 6f75 7473 5b36 5d0d  lide_layouts[6].
+00059680: 0a09 0909 736c 6964 6520 3d20 7072 732e  ....slide = prs.
+00059690: 736c 6964 6573 2e61 6464 5f73 6c69 6465  slides.add_slide
+000596a0: 2862 6c61 6e6b 5f73 6c69 6465 5f6c 6179  (blank_slide_lay
+000596b0: 6f75 7429 0d0a 0909 0969 6620 7361 7665  out).....if save
+000596c0: 5f52 4157 3a0d 0a09 0909 096c 6566 7420  _RAW:......left 
+000596d0: 3d20 746f 7020 3d20 496e 6368 6573 2830  = top = Inches(0
+000596e0: 2e35 290d 0a09 0909 0970 6963 203d 2073  .5)......pic = s
+000596f0: 6c69 6465 2e73 6861 7065 732e 6164 645f  lide.shapes.add_
+00059700: 7069 6374 7572 6528 7374 7228 7261 775f  picture(str(raw_
+00059710: 6e61 6d65 735b 305d 2e72 6573 6f6c 7665  names[0].resolve
+00059720: 2829 292c 206c 6566 743d 6c65 6674 2b49  ()), left=left+I
+00059730: 6e63 6865 7328 342e 3529 2c20 746f 703d  nches(4.5), top=
+00059740: 746f 702c 2077 6964 7468 3d49 6e63 6865  top, width=Inche
+00059750: 7328 342e 3529 290d 0a09 0909 0970 6963  s(4.5))......pic
+00059760: 203d 2073 6c69 6465 2e73 6861 7065 732e   = slide.shapes.
+00059770: 6164 645f 7069 6374 7572 6528 7374 7228  add_picture(str(
+00059780: 7261 775f 6e61 6d65 735b 315d 2e72 6573  raw_names[1].res
+00059790: 6f6c 7665 2829 292c 206c 6566 743d 6c65  olve()), left=le
+000597a0: 6674 2c20 746f 703d 746f 702c 2077 6964  ft, top=top, wid
+000597b0: 7468 3d49 6e63 6865 7328 342e 3529 290d  th=Inches(4.5)).
+000597c0: 0a09 0909 0970 6963 203d 2073 6c69 6465  .....pic = slide
+000597d0: 2e73 6861 7065 732e 6164 645f 7069 6374  .shapes.add_pict
+000597e0: 7572 6528 7374 7228 7261 775f 6e61 6d65  ure(str(raw_name
+000597f0: 735b 325d 2e72 6573 6f6c 7665 2829 292c  s[2].resolve()),
+00059800: 206c 6566 743d 6c65 6674 2c20 746f 703d   left=left, top=
+00059810: 746f 702b 496e 6368 6573 2833 292c 2077  top+Inches(3), w
+00059820: 6964 7468 3d49 6e63 6865 7328 342e 3529  idth=Inches(4.5)
+00059830: 290d 0a09 0909 0974 7279 3a0d 0a09 0909  )......try:.....
+00059840: 0909 7069 6320 3d20 736c 6964 652e 7368  ..pic = slide.sh
+00059850: 6170 6573 2e61 6464 5f70 6963 7475 7265  apes.add_picture
+00059860: 2873 7472 2872 6177 5f6e 616d 6573 5b33  (str(raw_names[3
+00059870: 5d2e 7265 736f 6c76 6528 2929 2c20 6c65  ].resolve()), le
+00059880: 6674 3d6c 6566 742b 496e 6368 6573 2834  ft=left+Inches(4
+00059890: 2e35 292c 2074 6f70 3d74 6f70 2b49 6e63  .5), top=top+Inc
+000598a0: 6865 7328 3329 2c20 6865 6967 6874 3d49  hes(3), height=I
+000598b0: 6e63 6865 7328 332e 3429 290d 0a09 0909  nches(3.4)).....
+000598c0: 0965 7863 6570 743a 0d0a 0909 0909 0970  .except:.......p
+000598d0: 6173 730d 0a09 0909 6966 2073 6176 655f  ass.....if save_
+000598e0: 4669 743a 0d0a 0909 0909 7472 793a 0d0a  Fit:......try:..
+000598f0: 0909 0909 0973 6c69 6465 3220 3d20 7072  .....slide2 = pr
+00059900: 732e 736c 6964 6573 2e61 6464 5f73 6c69  s.slides.add_sli
+00059910: 6465 2862 6c61 6e6b 5f73 6c69 6465 5f6c  de(blank_slide_l
+00059920: 6179 6f75 7429 0d0a 0909 0909 096c 6566  ayout).......lef
+00059930: 7420 3d20 746f 7020 3d20 496e 6368 6573  t = top = Inches
+00059940: 2830 2e31 290d 0a09 0909 0909 7069 6320  (0.1).......pic 
+00059950: 3d20 736c 6964 6532 2e73 6861 7065 732e  = slide2.shapes.
+00059960: 6164 645f 7069 6374 7572 6528 7374 7228  add_picture(str(
+00059970: 6669 745f 6e61 6d65 735b 305d 2e72 6573  fit_names[0].res
+00059980: 6f6c 7665 2829 292c 206c 6566 743d 6c65  olve()), left=le
+00059990: 6674 2b49 6e63 6865 7328 352e 3529 2c20  ft+Inches(5.5), 
+000599a0: 746f 703d 746f 702c 2068 6569 6768 743d  top=top, height=
+000599b0: 496e 6368 6573 2833 2e35 2929 234d 6174  Inches(3.5))#Mat
+000599c0: 7269 780d 0a09 0909 0909 7069 6320 3d20  rix.......pic = 
+000599d0: 736c 6964 6532 2e73 6861 7065 732e 6164  slide2.shapes.ad
+000599e0: 645f 7069 6374 7572 6528 7374 7228 6669  d_picture(str(fi
+000599f0: 745f 6e61 6d65 735b 315d 2e72 6573 6f6c  t_names[1].resol
+00059a00: 7665 2829 292c 206c 6566 743d 6c65 6674  ve()), left=left
+00059a10: 2c20 746f 703d 746f 702c 2068 6569 6768  , top=top, heigh
+00059a20: 743d 496e 6368 6573 2832 2929 0d0a 0909  t=Inches(2))....
+00059a30: 0909 0970 6963 203d 2073 6c69 6465 322e  ...pic = slide2.
+00059a40: 7368 6170 6573 2e61 6464 5f70 6963 7475  shapes.add_pictu
+00059a50: 7265 2873 7472 2866 6974 5f6e 616d 6573  re(str(fit_names
+00059a60: 5b32 5d2e 7265 736f 6c76 6528 2929 2c20  [2].resolve()), 
+00059a70: 6c65 6674 3d6c 6566 742c 2074 6f70 3d74  left=left, top=t
+00059a80: 6f70 2b49 6e63 6865 7328 3229 2c20 6865  op+Inches(2), he
+00059a90: 6967 6874 3d49 6e63 6865 7328 3229 290d  ight=Inches(2)).
+00059aa0: 0a09 0909 0909 7069 6320 3d20 736c 6964  ......pic = slid
+00059ab0: 6532 2e73 6861 7065 732e 6164 645f 7069  e2.shapes.add_pi
+00059ac0: 6374 7572 6528 7374 7228 6669 745f 6e61  cture(str(fit_na
+00059ad0: 6d65 735b 335d 2e72 6573 6f6c 7665 2829  mes[3].resolve()
+00059ae0: 292c 206c 6566 743d 6c65 6674 2c20 746f  ), left=left, to
+00059af0: 703d 746f 702b 496e 6368 6573 2833 2e39  p=top+Inches(3.9
+00059b00: 292c 2068 6569 6768 743d 496e 6368 6573  ), height=Inches
+00059b10: 2831 2e34 2929 0d0a 0909 0909 0970 6963  (1.4)).......pic
+00059b20: 203d 2073 6c69 6465 322e 7368 6170 6573   = slide2.shapes
+00059b30: 2e61 6464 5f70 6963 7475 7265 2873 7472  .add_picture(str
+00059b40: 2866 6974 5f6e 616d 6573 5b34 5d2e 7265  (fit_names[4].re
+00059b50: 736f 6c76 6528 2929 2c20 6c65 6674 3d6c  solve()), left=l
+00059b60: 6566 742c 2074 6f70 3d74 6f70 2b49 6e63  eft, top=top+Inc
+00059b70: 6865 7328 352e 3429 2c20 6865 6967 6874  hes(5.4), height
+00059b80: 3d49 6e63 6865 7328 3229 290d 0a09 0909  =Inches(2)).....
+00059b90: 0909 0d0a 0909 0909 0974 6578 7431 203d  .........text1 =
+00059ba0: 2073 6c69 6465 322e 7368 6170 6573 2e61   slide2.shapes.a
+00059bb0: 6464 5f74 6578 7462 6f78 286c 6566 743d  dd_textbox(left=
+00059bc0: 6c65 6674 2b49 6e63 6865 7328 352e 3529  left+Inches(5.5)
+00059bd0: 2c20 746f 703d 746f 702b 496e 6368 6573  , top=top+Inches
+00059be0: 2833 2e35 292c 2077 6964 7468 3d49 6e63  (3.5), width=Inc
+00059bf0: 6865 7328 342e 3529 2c20 6865 6967 6874  hes(4.5), height
+00059c00: 3d49 6e63 6865 7328 3429 290d 0a09 0909  =Inches(4)).....
+00059c10: 0909 7465 7874 312e 7465 7874 203d 2052  ..text1.text = R
+00059c20: 6573 756c 745f 7374 7269 6e67 0d0a 0909  esult_string....
+00059c30: 0909 0974 6578 7431 2e74 6578 745f 6672  ...text1.text_fr
+00059c40: 616d 652e 6669 745f 7465 7874 2866 6f6e  ame.fit_text(fon
+00059c50: 745f 6661 6d69 6c79 3d75 2741 7269 616c  t_family=u'Arial
+00059c60: 272c 206d 6178 5f73 697a 653d 382c 2062  ', max_size=8, b
+00059c70: 6f6c 643d 4661 6c73 652c 2069 7461 6c69  old=False, itali
+00059c80: 633d 4661 6c73 6529 0d0a 0909 0909 6578  c=False)......ex
+00059c90: 6365 7074 3a0d 0a09 0909 0909 7072 696e  cept:.......prin
+00059ca0: 7428 2765 7869 7465 6420 7768 656e 2073  t('exited when s
+00059cb0: 6176 696e 6720 7468 6520 6669 7420 706c  aving the fit pl
+00059cc0: 6f74 7327 290d 0a09 0909 090d 0a0d 0a09  ots')...........
+00059cd0: 0909 706c 742e 636c 6f73 6528 2761 6c6c  ..plt.close('all
+00059ce0: 2729 0d0a 0909 0973 656c 662e 7361 7665  ').....self.save
+00059cf0: 5f66 6967 7572 6573 5f74 6f5f 666f 6c64  _figures_to_fold
+00059d00: 6572 3d6f 7269 6769 6e0d 0a09 0909 7072  er=origin.....pr
+00059d10: 732e 7361 7665 2863 6865 636b 5f66 6f6c  s.save(check_fol
+00059d20: 6465 7228 7061 7468 3d70 6174 682c 6375  der(path=path,cu
+00059d30: 7272 656e 745f 7061 7468 3d73 656c 662e  rrent_path=self.
+00059d40: 7061 7468 2c66 696c 656e 616d 653d 7365  path,filename=se
+00059d50: 6c66 2e66 696c 656e 616d 652e 7370 6c69  lf.filename.spli
+00059d60: 7428 272e 2729 5b30 5d20 2b20 272e 7070  t('.')[0] + '.pp
+00059d70: 7478 2729 290d 0a09 0909 7072 696e 7428  tx')).....print(
+00059d80: 2741 6c6c 2064 6174 6120 7761 7320 7361  'All data was sa
+00059d90: 7665 6420 746f 2025 7327 2563 6865 636b  ved to %s'%check
+00059da0: 5f66 6f6c 6465 7228 7061 7468 3d70 6174  _folder(path=pat
+00059db0: 682c 6375 7272 656e 745f 7061 7468 3d73  h,current_path=s
+00059dc0: 656c 662e 7061 7468 2929 0d0a 0909 0d0a  elf.path))......
+00059dd0: 090d 0a0d 0a0d 0a09 6465 6620 5361 7665  ........def Save
+00059de0: 5f70 726f 6a65 6374 2873 656c 662c 2066  _project(self, f
+00059df0: 696c 656e 616d 653d 4e6f 6e65 2c70 6174  ilename=None,pat
+00059e00: 683d 4e6f 6e65 293a 0d0a 0909 2727 2766  h=None):....'''f
+00059e10: 756e 6374 696f 6e20 746f 2064 756d 7020  unction to dump 
+00059e20: 616c 6c20 7468 6520 7061 7261 6d65 7465  all the paramete
+00059e30: 7220 6f66 2061 6e20 616e 616c 7973 6973  r of an analysis
+00059e40: 2069 6e74 6f20 616e 2068 6466 3520 6669   into an hdf5 fi
+00059e50: 6c65 2e20 0d0a 0909 5468 6973 2066 696c  le. ....This fil
+00059e60: 6520 636f 6e74 6169 6e73 2074 6865 2064  e contains the d
+00059e70: 735f 6f72 6920 616e 6420 616c 6c20 7468  s_ori and all th
+00059e80: 6520 7061 7261 6d65 7465 722c 2069 6e63  e parameter, inc
+00059e90: 6c75 6469 6e67 2066 6974 7469 6e67 2070  luding fitting p
+00059ea0: 6172 616d 6574 6572 0d0a 0909 616e 6420  arameter....and 
+00059eb0: 7265 7375 6c74 732e 0d0a 0909 4f6e 6520  results.....One 
+00059ec0: 6c69 6d69 7461 7469 6f6e 2069 7320 7468  limitation is th
+00059ed0: 6520 6669 7474 696e 6720 6d6f 6465 6c2e  e fitting model.
+00059ee0: 2049 6620 7468 6520 6d6f 6465 6c20 6973   If the model is
+00059ef0: 2062 7569 6c64 2069 6e2c 2073 6f20 7468   build in, so th
+00059f00: 6520 6d6f 6465 6c20 6973 0d0a 0909 2765  e model is....'e
+00059f10: 7870 6f6e 656e 7469 616c 2720 6f72 2027  xponential' or '
+00059f20: 7061 7261 6c6c 656c 2720 7468 656e 2074  parallel' then t
+00059f30: 6865 2073 6166 696e 6720 776f 726b 732e  he safing works.
+00059f40: 2049 6620 616e 2065 7874 6572 6e61 6c20   If an external 
+00059f50: 6d6f 6465 6c20 6973 2075 7365 6420 7468  model is used th
+00059f60: 656e 2074 6865 200d 0a09 0964 6f73 7472  en the ....dostr
+00059f70: 696e 6720 6f66 2074 6865 2065 7874 6572  ing of the exter
+00059f80: 6e61 6c20 6675 6e63 7469 6f6e 2069 7320  nal function is 
+00059f90: 7374 6f72 6564 2c20 6275 7420 6e6f 7420  stored, but not 
+00059fa0: 7468 6520 6675 6e63 7469 6f6e 2069 7473  the function its
+00059fb0: 656c 662e 0d0a 0909 0909 0d0a 0909 5061  elf...........Pa
+00059fc0: 7261 6d65 7465 7273 0d0a 0909 2d2d 2d2d  rameters....----
+00059fd0: 2d2d 2d2d 2d2d 0d0a 0909 0d0a 0909 7061  ------........pa
+00059fe0: 7468 203a 204e 6f6e 652c 2073 7472 206f  th : None, str o
+00059ff0: 7220 7061 7468 2c20 6f70 7469 6f6e 616c  r path, optional
+0005a000: 0d0a 0909 0928 4465 6661 756c 7429 204e  .....(Default) N
+0005a010: 6f6e 652c 2069 6620 6c65 6674 206f 6e20  one, if left on 
+0005a020: 4e6f 6e65 2c20 7468 656e 2061 2066 6f6c  None, then a fol
+0005a030: 6465 7220 2244 6174 6122 2069 7320 6372  der "Data" is cr
+0005a040: 6561 7465 6420 696e 2074 6865 2066 6f6c  eated in the fol
+0005a050: 6465 7220 0d0a 0909 096f 6620 7468 6520  der .....of the 
+0005a060: 7072 6f6a 6563 7420 2873 656c 662e 7061  project (self.pa
+0005a070: 7468 290d 0a09 0909 090d 0a09 0966 696c  th)..........fil
+0005a080: 656e 616d 6520 3a20 7374 722c 206f 7074  ename : str, opt
+0005a090: 696f 6e61 6c0d 0a09 0909 2844 6566 6175  ional.....(Defau
+0005a0a0: 6c74 2920 4e6f 6e65 2c20 4261 7365 206e  lt) None, Base n
+0005a0b0: 616d 6520 666f 7220 616c 6c20 706c 6f74  ame for all plot
+0005a0c0: 732e 2049 6620 4e6f 6e65 2c20 7468 656e  s. If None, then
+0005a0d0: 2073 656c 662e 6669 6c65 6e61 6d65 2077   self.filename w
+0005a0e0: 696c 6c20 6265 2075 7365 640d 0a09 0909  ill be used.....
+0005a0f0: 0d0a 0909 4578 616d 706c 6573 0d0a 0909  ....Examples....
+0005a100: 2d2d 2d2d 2d2d 2d2d 0d0a 0909 0d0a 0909  --------........
+0005a110: 3e3e 3e20 7461 2e53 6176 655f 7072 6f6a  >>> ta.Save_proj
+0005a120: 6563 7428 290d 0a09 090d 0a09 0927 2727  ect()........'''
+0005a130: 0d0a 0909 0d0a 0909 6966 2066 696c 656e  ........if filen
+0005a140: 616d 6520 6973 204e 6f6e 653a 0d0a 0909  ame is None:....
+0005a150: 0966 696c 656e 616d 6520 3d20 7365 6c66  .filename = self
+0005a160: 2e66 696c 656e 616d 650d 0a09 0968 6466  .filename....hdf
+0005a170: 355f 6e61 6d65 203d 6368 6563 6b5f 666f  5_name =check_fo
+0005a180: 6c64 6572 2870 6174 6820 3d20 7061 7468  lder(path = path
+0005a190: 2c20 6375 7272 656e 745f 7061 7468 203d  , current_path =
+0005a1a0: 2073 656c 662e 7061 7468 2c20 6669 6c65   self.path, file
+0005a1b0: 6e61 6d65 203d 2066 696c 656e 616d 652e  name = filename.
+0005a1c0: 7370 6c69 7428 272e 2729 5b30 5d2b 272e  split('.')[0]+'.
+0005a1d0: 6864 6635 2729 0d0a 0909 6966 206f 732e  hdf5')....if os.
+0005a1e0: 7061 7468 2e65 7869 7374 7328 6864 6635  path.exists(hdf5
+0005a1f0: 5f6e 616d 6529 3a0d 0a09 0909 7472 793a  _name):.....try:
+0005a200: 0d0a 0909 0909 6f73 2e72 656d 6f76 6528  ......os.remove(
+0005a210: 6864 6635 5f6e 616d 6529 0d0a 0909 0965  hdf5_name).....e
+0005a220: 7863 6570 743a 0d0a 0909 0909 7472 793a  xcept:......try:
+0005a230: 0d0a 0909 0909 0968 6466 355f 6e61 6d65  .......hdf5_name
+0005a240: 2e63 6c6f 7365 2829 0d0a 0909 0909 096f  .close().......o
+0005a250: 732e 7265 6d6f 7665 2868 6466 355f 6e61  s.remove(hdf5_na
+0005a260: 6d65 290d 0a09 0909 0965 7863 6570 743a  me)......except:
+0005a270: 0d0a 0909 0909 0970 7269 6e74 2827 4669  .......print('Fi
+0005a280: 6c65 2065 7869 7374 7320 6275 7420 6361  le exists but ca
+0005a290: 6e20 6e6f 7420 6265 2064 656c 6574 6564  n not be deleted
+0005a2a0: 2729 0d0a 0909 7265 5f73 7769 7463 6820  ')....re_switch 
+0005a2b0: 3d20 4661 6c73 650d 0a09 0977 6974 6820  = False....with 
+0005a2c0: 6835 7079 2e46 696c 6528 6864 6635 5f6e  h5py.File(hdf5_n
+0005a2d0: 616d 652c 2027 7727 2920 6173 2066 3a0d  ame, 'w') as f:.
+0005a2e0: 0a09 0909 666f 7220 6b65 7920 696e 2073  ....for key in s
+0005a2f0: 656c 662e 5f5f 6469 6374 5f5f 2e6b 6579  elf.__dict__.key
+0005a300: 7328 293a 0d0a 0909 0909 6966 206b 6579  s():......if key
+0005a310: 203d 3d20 276d 6f64 273a 0d0a 0909 0909   == 'mod':......
+0005a320: 0969 6620 7365 6c66 2e5f 5f64 6963 745f  .if self.__dict_
+0005a330: 5f5b 6b65 795d 2069 6e20 5b27 7061 7261  _[key] in ['para
+0005a340: 6c27 2c27 6578 706f 6e65 6e74 6961 6c27  l','exponential'
+0005a350: 2c27 636f 6e73 6563 7574 6976 6527 2c27  ,'consecutive','
+0005a360: 6675 6c6c 5f63 6f6e 7365 6375 7469 7665  full_consecutive
+0005a370: 275d 3a0d 0a09 0909 0909 0966 2e63 7265  ']:........f.cre
+0005a380: 6174 655f 6461 7461 7365 7428 6e61 6d65  ate_dataset(name
+0005a390: 3d6b 6579 2c20 6461 7461 3d73 656c 662e  =key, data=self.
+0005a3a0: 5f5f 6469 6374 5f5f 5b6b 6579 5d29 0d0a  __dict__[key])..
+0005a3b0: 0909 0909 0965 6c73 653a 0d0a 0909 0909  .....else:......
+0005a3c0: 0909 7472 793a 0d0a 0909 0909 0909 0964  ..try:.........d
+0005a3d0: 6f63 7374 7269 6e67 3d73 656c 662e 5f5f  ocstring=self.__
+0005a3e0: 6469 6374 5f5f 5b6b 6579 5d2e 5f5f 646f  dict__[key].__do
+0005a3f0: 635f 5f0d 0a09 0909 0909 0909 6966 2069  c__.........if i
+0005a400: 7369 6e73 7461 6e63 6528 646f 6373 7472  sinstance(docstr
+0005a410: 696e 672c 7479 7065 2827 6865 6c6c 6f27  ing,type('hello'
+0005a420: 2929 3a0d 0a09 0909 0909 0909 0966 2e63  )):..........f.c
+0005a430: 7265 6174 655f 6461 7461 7365 7428 6e61  reate_dataset(na
+0005a440: 6d65 3d6b 6579 2c20 6461 7461 3d64 6f63  me=key, data=doc
+0005a450: 7374 7269 6e67 290d 0a09 0909 0909 0965  string)........e
+0005a460: 7863 6570 743a 0d0a 0909 0909 0909 0966  xcept:.........f
+0005a470: 2e63 7265 6174 655f 6461 7461 7365 7428  .create_dataset(
+0005a480: 6e61 6d65 3d6b 6579 2c20 6461 7461 3d27  name=key, data='
+0005a490: 6578 7465 726e 616c 5f66 756e 6374 696f  external_functio
+0005a4a0: 6e5f 7769 7468 6f75 745f 646f 6373 7472  n_without_docstr
+0005a4b0: 696e 6727 290d 0a09 0909 0965 6c69 6620  ing')......elif 
+0005a4c0: 6b65 7920 696e 205b 2772 656c 5f77 6176  key in ['rel_wav
+0005a4d0: 6527 2c27 7265 6c5f 7469 6d65 275d 3a23  e','rel_time']:#
+0005a4e0: 6e65 6564 2065 7874 7261 2c20 6173 2069  need extra, as i
+0005a4f0: 7420 6973 2062 7970 6173 7365 6420 6279  t is bypassed by
+0005a500: 2074 6865 2072 652d 7377 6974 6368 0d0a   the re-switch..
+0005a510: 0909 0909 0966 2e63 7265 6174 655f 6461  .....f.create_da
+0005a520: 7461 7365 7428 6e61 6d65 3d6b 6579 2c20  taset(name=key, 
+0005a530: 6461 7461 3d73 656c 662e 5f5f 6469 6374  data=self.__dict
+0005a540: 5f5f 5b6b 6579 5d29 0d0a 0909 0909 656c  __[key])......el
+0005a550: 6966 206b 6579 5b3a 325d 203d 3d20 2772  if key[:2] == 'r
+0005a560: 6527 203a 0d0a 0909 0909 0972 655f 7377  e' :.......re_sw
+0005a570: 6974 6368 203d 2054 7275 650d 0a09 0909  itch = True.....
+0005a580: 0909 666f 7220 6b65 7932 2069 6e20 7365  ..for key2 in se
 0005a590: 6c66 2e5f 5f64 6963 745f 5f5b 2772 6527  lf.__dict__['re'
-0005a5a0: 5d5b 6b65 7932 5d0d 0a09 0909 0909 0969  ][key2]........i
-0005a5b0: 6620 6b65 7932 203d 3d20 2765 7272 6f72  f key2 == 'error
-0005a5c0: 273a 0d0a 0909 0909 0909 0974 7279 3a0d  ':.........try:.
-0005a5d0: 0a09 0909 0909 0909 0966 2e63 7265 6174  .........f.creat
-0005a5e0: 655f 6461 7461 7365 7428 6e61 6d65 3d27  e_dataset(name='
-0005a5f0: 7265 5f65 7272 6f72 272c 2064 6174 613d  re_error', data=
-0005a600: 6461 7461 290d 0a09 0909 0909 0909 6578  data).........ex
-0005a610: 6365 7074 3a0d 0a09 0909 0909 0909 0970  cept:..........p
-0005a620: 7269 6e74 2827 7361 7669 6e67 206f 6620  rint('saving of 
-0005a630: 2720 2b20 6b65 7932 202b 2027 2066 6169  ' + key2 + ' fai
-0005a640: 6c65 6427 2029 0d0a 0909 0909 0909 656c  led' )........el
-0005a650: 6966 2069 7369 6e73 7461 6e63 6528 6461  if isinstance(da
-0005a660: 7461 2c20 7061 6e64 6173 2e44 6174 6146  ta, pandas.DataF
-0005a670: 7261 6d65 293a 0d0a 0909 0909 0909 0970  rame):.........p
-0005a680: 6173 730d 0a09 0909 0909 0965 6c73 653a  ass........else:
-0005a690: 0d0a 0909 0909 0909 0974 7279 3a0d 0a09  .........try:...
-0005a6a0: 0909 0909 0909 0966 2e63 7265 6174 655f  .......f.create_
-0005a6b0: 6461 7461 7365 7428 6e61 6d65 3d27 7265  dataset(name='re
-0005a6c0: 5f27 202b 206b 6579 322c 2064 6174 613d  _' + key2, data=
-0005a6d0: 6461 7461 290d 0a09 0909 0909 0909 6578  data).........ex
-0005a6e0: 6365 7074 3a0d 0a09 0909 0909 0909 0970  cept:..........p
-0005a6f0: 7269 6e74 2827 7361 7669 6e67 206f 6620  rint('saving of 
-0005a700: 2720 2b20 6b65 7932 202b 2027 2066 6169  ' + key2 + ' fai
-0005a710: 6c65 6427 2029 0d0a 0909 0909 656c 6966  led' )......elif
-0005a720: 206b 6579 203d 3d20 2763 6d61 7027 3a0d   key == 'cmap':.
-0005a730: 0a09 0909 0909 7061 7373 0d0a 0909 0909  ......pass......
-0005a740: 656c 6966 206b 6579 203d 3d20 2769 6e74  elif key == 'int
-0005a750: 656e 7369 7479 5f72 616e 6765 273a 0d0a  ensity_range':..
-0005a760: 0909 0909 0964 6174 613d 7365 6c66 2e5f  .....data=self._
-0005a770: 5f64 6963 745f 5f5b 2769 6e74 656e 7369  _dict__['intensi
-0005a780: 7479 5f72 616e 6765 275d 0d0a 0909 0909  ty_range']......
-0005a790: 0969 6620 6973 696e 7374 616e 6365 2864  .if isinstance(d
-0005a7a0: 6174 612c 2074 7970 6528 3165 2d33 2929  ata, type(1e-3))
-0005a7b0: 3a0d 0a09 0909 0909 0964 6174 613d 5b2d  :........data=[-
-0005a7c0: 6461 7461 2c64 6174 615d 0d0a 0909 0909  data,data]......
-0005a7d0: 0969 6620 6461 7461 2069 7320 4e6f 6e65  .if data is None
-0005a7e0: 3a0d 0a09 0909 0909 0966 2e63 7265 6174  :........f.creat
-0005a7f0: 655f 6461 7461 7365 7428 6e61 6d65 3d27  e_dataset(name='
-0005a800: 696e 7465 6e73 6974 795f 7261 6e67 6527  intensity_range'
-0005a810: 2c20 6461 7461 3d27 4e6f 6e65 2729 0d0a  , data='None')..
-0005a820: 0909 0909 0965 6c73 653a 0d0a 0909 0909  .....else:......
-0005a830: 0909 662e 6372 6561 7465 5f64 6174 6173  ..f.create_datas
-0005a840: 6574 286e 616d 653d 2769 6e74 656e 7369  et(name='intensi
-0005a850: 7479 5f72 616e 6765 272c 2064 6174 613d  ty_range', data=
-0005a860: 6461 7461 2909 0d0a 0909 0909 656c 6966  data).......elif
-0005a870: 206b 6579 203d 3d20 2762 6163 6b67 726f   key == 'backgro
-0005a880: 756e 645f 7061 7227 3a0d 0a09 0909 0909  und_par':.......
-0005a890: 662e 6372 6561 7465 5f64 6174 6173 6574  f.create_dataset
-0005a8a0: 286e 616d 653d 2762 6163 6b27 2c20 6461  (name='back', da
-0005a8b0: 7461 3d73 656c 662e 5f5f 6469 6374 5f5f  ta=self.__dict__
-0005a8c0: 5b27 6261 636b 6772 6f75 6e64 5f70 6172  ['background_par
-0005a8d0: 275d 5b33 5d29 0d0a 0909 0909 0d0a 0909  '][3])..........
-0005a8e0: 0909 656c 6966 206b 6579 2069 6e20 5b27  ..elif key in ['
-0005a8f0: 7061 7227 2c27 7061 725f 6669 7427 5d3a  par','par_fit']:
-0005a900: 0d0a 0909 0909 0909 0909 0920 0d0a 0909  ........... ....
-0005a910: 0909 0964 663d 7061 725f 746f 5f70 6172  ...df=par_to_par
-0005a920: 6466 2873 656c 662e 5f5f 6469 6374 5f5f  df(self.__dict__
-0005a930: 5b6b 6579 5d29 2370 616e 6461 7320 6861  [key])#pandas ha
-0005a940: 7320 6120 6275 6720 616e 6420 7072 6f62  s a bug and prob
-0005a950: 6c65 6d73 2068 616e 646c 696e 6720 6d69  lems handling mi
-0005a960: 7865 6420 7479 7065 2063 6f6c 756d 6e73  xed type columns
-0005a970: 2077 6865 6e20 7361 7669 6e67 2e20 536f   when saving. So
-0005a980: 2077 6520 636c 6561 6e20 7570 2e0d 0a09   we clean up....
-0005a990: 0909 0909 666f 7220 7375 625f 6b65 7920  ....for sub_key 
-0005a9a0: 696e 205b 276d 696e 272c 276d 6178 272c  in ['min','max',
-0005a9b0: 2776 616c 7565 275d 3a0d 0a09 0909 0909  'value']:.......
-0005a9c0: 0974 7279 3a0d 0a09 0909 0909 0909 6466  .try:.........df
-0005a9d0: 5b73 7562 5f6b 6579 5d3d 6466 5b73 7562  [sub_key]=df[sub
-0005a9e0: 5f6b 6579 5d2e 6173 7479 7065 2866 6c6f  _key].astype(flo
-0005a9f0: 6174 290d 0a09 0909 0909 0965 7863 6570  at)........excep
-0005aa00: 743a 0d0a 0909 0909 0909 0970 6173 730d  t:.........pass.
-0005aa10: 0a09 0909 0909 6466 5b27 6973 5f72 6174  ......df['is_rat
-0005aa20: 6527 5d3d 6466 5b27 6973 5f72 6174 6527  e']=df['is_rate'
-0005aa30: 5d2e 6173 7479 7065 2862 6f6f 6c29 0d0a  ].astype(bool)..
-0005aa40: 0909 0909 0964 665b 2776 6172 7927 5d3d  .....df['vary']=
-0005aa50: 6466 5b27 7661 7279 275d 2e61 7374 7970  df['vary'].astyp
-0005aa60: 6528 626f 6f6c 290d 0a09 0909 0909 6466  e(bool).......df
-0005aa70: 5b27 6578 7072 275d 3d64 665b 2765 7870  ['expr']=df['exp
-0005aa80: 7227 5d2e 6170 706c 7928 6c61 6d62 6461  r'].apply(lambda
-0005aa90: 2078 3a27 2573 2725 7829 0d0a 0909 0909   x:'%s'%x)......
-0005aaa0: 0964 662e 746f 5f68 6466 2873 7472 2868  .df.to_hdf(str(h
-0005aab0: 6466 355f 6e61 6d65 2e72 6573 6f6c 7665  df5_name.resolve
-0005aac0: 2829 292c 206b 6579 3d6b 6579 2c20 6170  ()), key=key, ap
-0005aad0: 7065 6e64 3d54 7275 652c 206d 6f64 653d  pend=True, mode=
-0005aae0: 2772 2b27 2c20 666f 726d 6174 3d27 7427  'r+', format='t'
-0005aaf0: 290d 0a09 0909 0965 6c73 653a 0d0a 0909  )......else:....
-0005ab00: 0909 0964 6174 6120 3d20 7365 6c66 2e5f  ...data = self._
-0005ab10: 5f64 6963 745f 5f5b 6b65 795d 0d0a 0909  _dict__[key]....
-0005ab20: 0909 0969 6620 6461 7461 2069 7320 4e6f  ...if data is No
-0005ab30: 6e65 3a0d 0a09 0909 0909 0966 2e63 7265  ne:........f.cre
-0005ab40: 6174 655f 6461 7461 7365 7428 6e61 6d65  ate_dataset(name
-0005ab50: 3d6b 6579 2c20 6461 7461 3d27 4e6f 6e65  =key, data='None
-0005ab60: 2729 0d0a 0909 0909 0965 6c73 653a 0d0a  ').......else:..
-0005ab70: 0909 0909 0909 6966 2069 7369 6e73 7461  ......if isinsta
-0005ab80: 6e63 6528 6461 7461 2c20 7061 6e64 6173  nce(data, pandas
-0005ab90: 2e44 6174 6146 7261 6d65 293a 0d0a 0909  .DataFrame):....
-0005aba0: 0909 0909 0970 6173 730d 0a09 0909 0909  .....pass.......
-0005abb0: 0965 6c73 653a 0d0a 0909 0909 0909 0974  .else:.........t
-0005abc0: 7279 3a0d 0a09 0909 0909 0909 0966 2e63  ry:..........f.c
-0005abd0: 7265 6174 655f 6461 7461 7365 7428 6e61  reate_dataset(na
-0005abe0: 6d65 3d6b 6579 2c20 6461 7461 3d64 6174  me=key, data=dat
-0005abf0: 6129 0d0a 0909 0909 0909 0965 7863 6570  a).........excep
-0005ac00: 743a 0d0a 0909 0909 0909 0909 6966 206b  t:..........if k
-0005ac10: 6579 203d 3d20 2770 6174 6827 3a0d 0a09  ey == 'path':...
-0005ac20: 0909 0909 0909 0909 7061 7373 0d0a 0909  ........pass....
-0005ac30: 0909 0909 0909 656c 6966 206b 6579 203d  ......elif key =
-0005ac40: 3d20 2766 6967 7572 655f 7061 7468 273a  = 'figure_path':
-0005ac50: 0d0a 0909 0909 0909 0909 0970 6173 730d  ...........pass.
-0005ac60: 0a09 0909 0909 0909 0965 6c73 653a 0d0a  .........else:..
-0005ac70: 0909 0909 0909 0909 0970 7269 6e74 2827  .........print('
-0005ac80: 7468 6520 7361 7669 6e67 206f 6620 2025  the saving of  %
-0005ac90: 7320 2066 6169 6c65 6427 256b 6579 290d  s  failed'%key).
-0005aca0: 0a09 0909 6966 206e 6f74 2027 6669 7463  ....if not 'fitc
-0005acb0: 6f65 6666 2720 696e 2066 3a0d 0a09 0909  oeff' in f:.....
-0005acc0: 0974 7279 3a0d 0a09 0909 0909 662e 6372  .try:.......f.cr
-0005acd0: 6561 7465 5f64 6174 6173 6574 286e 616d  eate_dataset(nam
-0005ace0: 653d 2766 6974 636f 6566 6627 2c20 6461  e='fitcoeff', da
-0005acf0: 7461 3d73 656c 662e 6669 7463 6f65 6666  ta=self.fitcoeff
-0005ad00: 290d 0a09 0909 0965 7863 6570 743a 0d0a  )......except:..
-0005ad10: 0909 0909 0974 7279 3a0d 0a09 0909 0909  .....try:.......
-0005ad20: 0977 6974 6820 6f70 656e 2873 656c 662e  .with open(self.
-0005ad30: 6368 6972 705f 6669 6c65 2c27 7227 2920  chirp_file,'r') 
-0005ad40: 6173 2066 323a 0d0a 0909 0909 0909 0966  as f2:.........f
-0005ad50: 6974 636f 6566 663d 6632 2e72 6561 646c  itcoeff=f2.readl
-0005ad60: 696e 6528 290d 0a09 0909 0909 0909 662e  ine().........f.
-0005ad70: 6372 6561 7465 5f64 6174 6173 6574 286e  create_dataset(n
-0005ad80: 616d 653d 2766 6974 636f 6566 6627 2c20  ame='fitcoeff', 
-0005ad90: 6461 7461 3d66 6974 636f 6566 6629 0d0a  data=fitcoeff)..
-0005ada0: 0909 0909 0965 7863 6570 743a 0d0a 0909  .....except:....
-0005adb0: 0909 0909 7061 7373 0d0a 0909 7365 6c66  ....pass....self
-0005adc0: 2e64 735f 6f72 692e 746f 5f68 6466 2873  .ds_ori.to_hdf(s
-0005add0: 7472 2868 6466 355f 6e61 6d65 2e72 6573  tr(hdf5_name.res
-0005ade0: 6f6c 7665 2829 292c 206b 6579 3d27 6473  olve()), key='ds
-0005adf0: 5f6f 7269 272c 2061 7070 656e 643d 5472  _ori', append=Tr
-0005ae00: 7565 2c20 6d6f 6465 3d27 722b 272c 2066  ue, mode='r+', f
-0005ae10: 6f72 6d61 743d 2774 2729 2373 6176 655f  ormat='t')#save_
-0005ae20: 7261 775f 6461 7461 0d0a 0909 6966 2072  raw_data....if r
-0005ae30: 655f 7377 6974 6368 3a0d 0a09 0909 2370  e_switch:.....#p
-0005ae40: 7269 6e74 2827 7265 2d73 7769 7463 6865  rint('re-switche
-0005ae50: 6427 290d 0a09 0909 666f 7220 6b65 7920  d').....for key 
-0005ae60: 696e 205b 2741 272c 2027 4143 272c 2027  in ['A', 'AC', '
-0005ae70: 4145 272c 2027 4441 4327 2c20 2763 275d  AE', 'DAC', 'c']
-0005ae80: 3a0d 0a09 0909 0973 656c 662e 7265 5b6b  :......self.re[k
-0005ae90: 6579 5d2e 746f 5f68 6466 2873 7472 2868  ey].to_hdf(str(h
-0005aea0: 6466 355f 6e61 6d65 2e72 6573 6f6c 7665  df5_name.resolve
-0005aeb0: 2829 292c 206b 6579 3d27 7265 5f27 202b  ()), key='re_' +
-0005aec0: 206b 6579 2c20 6170 7065 6e64 3d54 7275   key, append=Tru
-0005aed0: 652c 206d 6f64 653d 2772 2b27 2c20 666f  e, mode='r+', fo
-0005aee0: 726d 6174 3d27 7427 290d 0a09 0974 7279  rmat='t')....try
-0005aef0: 3a0d 0a09 0909 662e 636c 6f73 6528 290d  :.....f.close().
-0005af00: 0a09 0965 7863 6570 743a 0d0a 0909 0970  ...except:.....p
-0005af10: 6173 730d 0a09 090d 0a09 0970 7269 6e74  ass........print
-0005af20: 2827 5468 6520 7072 6f6a 6563 7420 7761  ('The project wa
-0005af30: 7320 7361 7665 6420 746f 2025 7327 2563  s saved to %s'%c
-0005af40: 6865 636b 5f66 6f6c 6465 7228 7061 7468  heck_folder(path
-0005af50: 203d 2070 6174 682c 2063 7572 7265 6e74   = path, current
-0005af60: 5f70 6174 6820 3d20 7365 6c66 2e70 6174  _path = self.pat
-0005af70: 6829 290d 0a0d 0a0d 0a09 6465 6620 5f5f  h)).......def __
-0005af80: 7265 6164 5f70 726f 6a65 6374 2873 656c  read_project(sel
-0005af90: 662c 2073 6176 6564 5f70 726f 6a65 6374  f, saved_project
-0005afa0: 3d4e 6f6e 652c 6375 7272 656e 745f 7061  =None,current_pa
-0005afb0: 7468 3d4e 6f6e 6529 3a0d 0a09 0927 2727  th=None):....'''
-0005afc0: 6675 6e63 7469 6f6e 2074 6f20 7265 2d72  function to re-r
-0005afd0: 6561 6420 616c 6c20 7468 6520 7061 7261  ead all the para
-0005afe0: 6d65 7465 7220 6f66 2061 2070 7265 7669  meter of a previ
-0005aff0: 6f75 7320 616e 616c 7973 6973 200d 0a09  ous analysis ...
-0005b000: 0969 6e74 6f20 616e 2068 6466 3520 6669  .into an hdf5 fi
-0005b010: 6c65 2c20 6375 7272 656e 7420 7061 7468  le, current path
-0005b020: 2069 7320 7468 6520 7061 7468 2074 6861   is the path tha
-0005b030: 7420 7468 6520 6669 6c65 2073 686f 756c  t the file shoul
-0005b040: 6420 0d0a 0909 6173 7375 6d65 2069 7320  d ....assume is 
-0005b050: 6974 7320 2268 6f6d 6520 6469 7265 6374  its "home direct
-0005b060: 6f72 7922 2061 6674 6572 2073 7563 6365  ory" after succe
-0005b070: 7373 6675 6c20 6c6f 6164 696e 672e 2049  ssful loading. I
-0005b080: 6620 6e6f 7420 0d0a 0909 7365 7420 7765  f not ....set we
-0005b090: 2074 616b 6520 7468 6520 6669 6c65 7061   take the filepa
-0005b0a0: 7468 2061 7420 7768 6963 6820 7468 6520  th at which the 
-0005b0b0: 6669 6c65 2069 7320 6375 7272 656e 746c  file is currentl
-0005b0c0: 7920 7374 6f72 6564 2061 7320 7061 7468  y stored as path
-0005b0d0: 2727 270d 0a09 0969 6620 7361 7665 645f  '''....if saved_
-0005b0e0: 7072 6f6a 6563 7420 6973 204e 6f6e 653a  project is None:
-0005b0f0: 0d0a 0909 0972 6169 7365 2049 6d70 6f72  .....raise Impor
-0005b100: 7445 7272 6f72 2827 5765 2064 6f20 6e65  tError('We do ne
-0005b110: 6564 2061 2070 726f 6a65 6374 2074 6f20  ed a project to 
-0005b120: 696d 706f 7274 2729 0d0a 0909 6966 2063  import')....if c
-0005b130: 7572 7265 6e74 5f70 6174 6820 6973 204e  urrent_path is N
-0005b140: 6f6e 653a 6375 7272 656e 745f 7061 7468  one:current_path
-0005b150: 3d6f 732e 7061 7468 2e64 6972 6e61 6d65  =os.path.dirname
-0005b160: 286f 732e 7061 7468 2e61 6273 7061 7468  (os.path.abspath
-0005b170: 2873 6176 6564 5f70 726f 6a65 6374 2929  (saved_project))
-0005b180: 0d0a 0909 7472 793a 0d0a 0909 0969 6d70  ....try:.....imp
-0005b190: 6f72 7420 6835 7079 0d0a 0909 6578 6365  ort h5py....exce
-0005b1a0: 7074 3a0d 0a09 0920 0d0a 0909 0970 7269  pt:.... .....pri
-0005b1b0: 6e74 2827 636f 756c 6420 6e6f 7420 696d  nt('could not im
-0005b1c0: 706f 7274 2068 6466 352c 2063 7572 7265  port hdf5, curre
-0005b1d0: 6e74 2076 6572 7369 6f6e 2072 6571 7569  nt version requi
-0005b1e0: 7265 7320 7468 6174 2074 6869 7320 6973  res that this is
-0005b1f0: 2069 6e73 7461 6c6c 6564 2e20 4946 2072   installed. IF r
-0005b200: 756e 6e69 6e67 2041 6e61 636f 6e64 6120  unning Anaconda 
-0005b210: 6f70 656e 2043 6f6e 6461 2070 726f 6d74  open Conda promt
-0005b220: 2061 6e64 2074 7970 653a 2063 6f6e 6461   and type: conda
-0005b230: 2069 6e73 7461 6c6c 2068 3570 7927 290d   install h5py').
-0005b240: 0a09 0964 6174 615f 6672 616d 655f 6c69  ...data_frame_li
-0005b250: 7374 3d5b 5d0d 0a0d 0a09 0923 2077 6520  st=[]......# we 
-0005b260: 6861 7620 746f 2068 616e 646c 6520 7468  hav to handle th
-0005b270: 6520 6f6c 6420 616e 6420 6e65 7720 7479  e old and new ty
-0005b280: 7065 206f 6620 7361 7669 6e67 0d0a 0909  pe of saving....
-0005b290: 7769 7468 2068 3570 792e 4669 6c65 2873  with h5py.File(s
-0005b2a0: 6176 6564 5f70 726f 6a65 6374 2c20 2772  aved_project, 'r
-0005b2b0: 2729 2061 7320 663a 0d0a 0909 0969 6620  ') as f:.....if 
-0005b2c0: 2772 655f 6669 6e61 6c5f 7365 7475 705f  're_final_setup_
-0005b2d0: 7061 7227 2069 6e20 662e 6b65 7973 2829  par' in f.keys()
-0005b2e0: 3a6f 6c64 5f73 7769 7463 683d 5472 7565  :old_switch=True
-0005b2f0: 0d0a 0909 0909 0920 0d0a 0909 0d0a 0909  ....... ........
-0005b300: 0965 6c73 653a 6f6c 645f 7377 6974 6368  .else:old_switch
-0005b310: 3d46 616c 7365 0d0a 0909 0909 0920 2020  =False.......   
-0005b320: 0d0a 0909 6966 206f 6c64 5f73 7769 7463  ....if old_switc
-0005b330: 683a 7072 696e 7428 2777 6520 7265 6164  h:print('we read
-0005b340: 2061 6e20 6f6c 6420 7374 796c 6520 6461   an old style da
-0005b350: 7461 5f66 696c 6520 616e 6420 6469 7265  ta_file and dire
-0005b360: 6374 6c79 2075 7064 6174 6520 6974 2069  ctly update it i
-0005b370: 6e74 6f20 7468 6520 6e65 7720 6669 6c65  nto the new file
-0005b380: 5f74 7970 6520 6166 7465 7220 6c6f 6164  _type after load
-0005b390: 696e 6727 290d 0a09 0977 6974 6820 6835  ing')....with h5
-0005b3a0: 7079 2e46 696c 6528 7361 7665 645f 7072  py.File(saved_pr
-0005b3b0: 6f6a 6563 742c 2027 7227 2920 6173 2066  oject, 'r') as f
-0005b3c0: 3a0d 0a09 0909 666f 7220 6b65 7920 696e  :.....for key in
-0005b3d0: 2066 2e6b 6579 7328 293a 0d0a 0909 0909   f.keys():......
-0005b3e0: 7472 793a 0d0a 0909 0909 0969 6620 2272  try:.......if "r
-0005b3f0: 655f 2220 696e 206b 6579 5b3a 335d 3a0d  e_" in key[:3]:.
-0005b400: 0a09 0909 0909 0969 6620 6e6f 7420 2772  .......if not 'r
-0005b410: 6527 2069 6e20 7365 6c66 2e5f 5f64 6963  e' in self.__dic
-0005b420: 745f 5f2e 6b65 7973 2829 3a0d 0a09 0909  t__.keys():.....
-0005b430: 0909 0909 7365 6c66 2e5f 5f64 6963 745f  ....self.__dict_
-0005b440: 5f5b 2772 6527 5d3d 7b7d 0d0a 0909 0909  _['re']={}......
-0005b450: 0909 7365 6c66 2e5f 5f64 6963 745f 5f5b  ..self.__dict__[
-0005b460: 2772 6527 5d5b 6b65 795b 333a 5d5d 3d66  're'][key[3:]]=f
-0005b470: 5b6b 6579 5d5b 2829 5d0d 0a09 0909 0909  [key][()].......
-0005b480: 656c 6966 2022 6261 636b 2220 696e 206b  elif "back" in k
-0005b490: 6579 5b3a 345d 3a0d 0a09 0909 0909 0972  ey[:4]:........r
-0005b4a0: 6561 3d66 5b6b 6579 5d5b 2829 5d0d 0a09  ea=f[key][()]...
-0005b4b0: 0909 0909 0973 656c 662e 5f5f 6469 6374  .....self.__dict
-0005b4c0: 5f5f 5b27 6261 636b 6772 6f75 6e64 5f70  __['background_p
-0005b4d0: 6172 275d 3d5b 4e6f 6e65 2c2d 312c 4661  ar']=[None,-1,Fa
-0005b4e0: 6c73 655d 0d0a 0909 0909 0909 7365 6c66  lse]........self
-0005b4f0: 2e5f 5f64 6963 745f 5f5b 2762 6163 6b67  .__dict__['backg
-0005b500: 726f 756e 645f 7061 7227 5d2e 6170 7065  round_par'].appe
-0005b510: 6e64 2872 6561 290d 0a09 0909 0909 656c  nd(rea).......el
-0005b520: 6966 2022 7061 7222 2069 6e20 6b65 795b  if "par" in key[
-0005b530: 3a33 5d3a 0d0a 0909 0909 0909 6966 206f  :3]:........if o
-0005b540: 6c64 5f73 7769 7463 683a 236f 6c64 2074  ld_switch:#old t
-0005b550: 7970 6520 6f66 2073 6176 6564 2064 6174  ype of saved dat
-0005b560: 610d 0a09 0909 0909 0909 7472 793a 0d0a  a.........try:..
-0005b570: 0909 0909 0909 0909 6f73 2e72 656d 6f76  ........os.remov
-0005b580: 6528 2774 656d 705f 6669 6c65 2e6a 736f  e('temp_file.jso
-0005b590: 6e27 290d 0a09 0909 0909 0909 6578 6365  n').........exce
-0005b5a0: 7074 3a0d 0a09 0909 0909 0909 0970 6173  pt:..........pas
-0005b5b0: 730d 0a09 0909 0909 0909 7769 7468 206f  s.........with o
-0005b5c0: 7065 6e28 2774 656d 705f 6669 6c65 2e6a  pen('temp_file.j
-0005b5d0: 736f 6e27 2c27 7727 2920 6173 2067 3a0d  son','w') as g:.
-0005b5e0: 0a09 0909 0909 0909 0967 2e77 7269 7465  .........g.write
-0005b5f0: 2866 5b6b 6579 5d5b 2829 5d29 0d0a 0909  (f[key][()])....
+0005a5a0: 5d3a 0d0a 0909 0909 0909 6966 206b 6579  ]:........if key
+0005a5b0: 3220 3d3d 2027 6669 745f 6f75 7470 7574  2 == 'fit_output
+0005a5c0: 273a 636f 6e74 696e 7565 0d0a 0909 0909  ':continue......
+0005a5d0: 0909 6461 7461 203d 2073 656c 662e 5f5f  ..data = self.__
+0005a5e0: 6469 6374 5f5f 5b27 7265 275d 5b6b 6579  dict__['re'][key
+0005a5f0: 325d 0d0a 0909 0909 0909 6966 206b 6579  2]........if key
+0005a600: 3220 3d3d 2027 6572 726f 7227 3a0d 0a09  2 == 'error':...
+0005a610: 0909 0909 0909 7472 793a 0d0a 0909 0909  ......try:......
+0005a620: 0909 0909 662e 6372 6561 7465 5f64 6174  ....f.create_dat
+0005a630: 6173 6574 286e 616d 653d 2772 655f 6572  aset(name='re_er
+0005a640: 726f 7227 2c20 6461 7461 3d64 6174 6129  ror', data=data)
+0005a650: 0d0a 0909 0909 0909 0965 7863 6570 743a  .........except:
+0005a660: 0d0a 0909 0909 0909 0909 7072 696e 7428  ..........print(
+0005a670: 2773 6176 696e 6720 6f66 2027 202b 206b  'saving of ' + k
+0005a680: 6579 3220 2b20 2720 6661 696c 6564 2720  ey2 + ' failed' 
+0005a690: 290d 0a09 0909 0909 0965 6c69 6620 6973  )........elif is
+0005a6a0: 696e 7374 616e 6365 2864 6174 612c 2070  instance(data, p
+0005a6b0: 616e 6461 732e 4461 7461 4672 616d 6529  andas.DataFrame)
+0005a6c0: 3a0d 0a09 0909 0909 0909 7061 7373 0d0a  :.........pass..
+0005a6d0: 0909 0909 0909 656c 7365 3a0d 0a09 0909  ......else:.....
+0005a6e0: 0909 0909 7472 793a 0d0a 0909 0909 0909  ....try:........
+0005a6f0: 0909 662e 6372 6561 7465 5f64 6174 6173  ..f.create_datas
+0005a700: 6574 286e 616d 653d 2772 655f 2720 2b20  et(name='re_' + 
+0005a710: 6b65 7932 2c20 6461 7461 3d64 6174 6129  key2, data=data)
+0005a720: 0d0a 0909 0909 0909 0965 7863 6570 743a  .........except:
+0005a730: 0d0a 0909 0909 0909 0909 7072 696e 7428  ..........print(
+0005a740: 2773 6176 696e 6720 6f66 2027 202b 206b  'saving of ' + k
+0005a750: 6579 3220 2b20 2720 6661 696c 6564 2720  ey2 + ' failed' 
+0005a760: 290d 0a09 0909 0965 6c69 6620 6b65 7920  )......elif key 
+0005a770: 3d3d 2027 636d 6170 273a 0d0a 0909 0909  == 'cmap':......
+0005a780: 0970 6173 730d 0a09 0909 0965 6c69 6620  .pass......elif 
+0005a790: 6b65 7920 3d3d 2027 696e 7465 6e73 6974  key == 'intensit
+0005a7a0: 795f 7261 6e67 6527 3a0d 0a09 0909 0909  y_range':.......
+0005a7b0: 6461 7461 3d73 656c 662e 5f5f 6469 6374  data=self.__dict
+0005a7c0: 5f5f 5b27 696e 7465 6e73 6974 795f 7261  __['intensity_ra
+0005a7d0: 6e67 6527 5d0d 0a09 0909 0909 6966 2069  nge'].......if i
+0005a7e0: 7369 6e73 7461 6e63 6528 6461 7461 2c20  sinstance(data, 
+0005a7f0: 7479 7065 2831 652d 3329 293a 0d0a 0909  type(1e-3)):....
+0005a800: 0909 0909 6461 7461 3d5b 2d64 6174 612c  ....data=[-data,
+0005a810: 6461 7461 5d0d 0a09 0909 0909 6966 2064  data].......if d
+0005a820: 6174 6120 6973 204e 6f6e 653a 0d0a 0909  ata is None:....
+0005a830: 0909 0909 662e 6372 6561 7465 5f64 6174  ....f.create_dat
+0005a840: 6173 6574 286e 616d 653d 2769 6e74 656e  aset(name='inten
+0005a850: 7369 7479 5f72 616e 6765 272c 2064 6174  sity_range', dat
+0005a860: 613d 274e 6f6e 6527 290d 0a09 0909 0909  a='None').......
+0005a870: 656c 7365 3a0d 0a09 0909 0909 0966 2e63  else:........f.c
+0005a880: 7265 6174 655f 6461 7461 7365 7428 6e61  reate_dataset(na
+0005a890: 6d65 3d27 696e 7465 6e73 6974 795f 7261  me='intensity_ra
+0005a8a0: 6e67 6527 2c20 6461 7461 3d64 6174 6129  nge', data=data)
+0005a8b0: 090d 0a09 0909 0965 6c69 6620 6b65 7920  .......elif key 
+0005a8c0: 3d3d 2027 6261 636b 6772 6f75 6e64 5f70  == 'background_p
+0005a8d0: 6172 273a 0d0a 0909 0909 0966 2e63 7265  ar':.......f.cre
+0005a8e0: 6174 655f 6461 7461 7365 7428 6e61 6d65  ate_dataset(name
+0005a8f0: 3d27 6261 636b 272c 2064 6174 613d 7365  ='back', data=se
+0005a900: 6c66 2e5f 5f64 6963 745f 5f5b 2762 6163  lf.__dict__['bac
+0005a910: 6b67 726f 756e 645f 7061 7227 5d5b 335d  kground_par'][3]
+0005a920: 290d 0a09 0909 090d 0a09 0909 0965 6c69  )............eli
+0005a930: 6620 6b65 7920 696e 205b 2770 6172 272c  f key in ['par',
+0005a940: 2770 6172 5f66 6974 275d 3a0d 0a09 0909  'par_fit']:.....
+0005a950: 0909 0909 0909 200d 0a09 0909 0909 6466  ...... .......df
+0005a960: 3d70 6172 5f74 6f5f 7061 7264 6628 7365  =par_to_pardf(se
+0005a970: 6c66 2e5f 5f64 6963 745f 5f5b 6b65 795d  lf.__dict__[key]
+0005a980: 2923 7061 6e64 6173 2068 6173 2061 2062  )#pandas has a b
+0005a990: 7567 2061 6e64 2070 726f 626c 656d 7320  ug and problems 
+0005a9a0: 6861 6e64 6c69 6e67 206d 6978 6564 2074  handling mixed t
+0005a9b0: 7970 6520 636f 6c75 6d6e 7320 7768 656e  ype columns when
+0005a9c0: 2073 6176 696e 672e 2053 6f20 7765 2063   saving. So we c
+0005a9d0: 6c65 616e 2075 702e 0d0a 0909 0909 0966  lean up........f
+0005a9e0: 6f72 2073 7562 5f6b 6579 2069 6e20 5b27  or sub_key in ['
+0005a9f0: 6d69 6e27 2c27 6d61 7827 2c27 7661 6c75  min','max','valu
+0005aa00: 6527 5d3a 0d0a 0909 0909 0909 7472 793a  e']:........try:
+0005aa10: 0d0a 0909 0909 0909 0964 665b 7375 625f  .........df[sub_
+0005aa20: 6b65 795d 3d64 665b 7375 625f 6b65 795d  key]=df[sub_key]
+0005aa30: 2e61 7374 7970 6528 666c 6f61 7429 0d0a  .astype(float)..
+0005aa40: 0909 0909 0909 6578 6365 7074 3a0d 0a09  ......except:...
+0005aa50: 0909 0909 0909 7061 7373 0d0a 0909 0909  ......pass......
+0005aa60: 0964 665b 2769 735f 7261 7465 275d 3d64  .df['is_rate']=d
+0005aa70: 665b 2769 735f 7261 7465 275d 2e61 7374  f['is_rate'].ast
+0005aa80: 7970 6528 626f 6f6c 290d 0a09 0909 0909  ype(bool).......
+0005aa90: 6466 5b27 7661 7279 275d 3d64 665b 2776  df['vary']=df['v
+0005aaa0: 6172 7927 5d2e 6173 7479 7065 2862 6f6f  ary'].astype(boo
+0005aab0: 6c29 0d0a 0909 0909 0964 665b 2765 7870  l).......df['exp
+0005aac0: 7227 5d3d 6466 5b27 6578 7072 275d 2e61  r']=df['expr'].a
+0005aad0: 7070 6c79 286c 616d 6264 6120 783a 2725  pply(lambda x:'%
+0005aae0: 7327 2578 290d 0a09 0909 0909 6466 2e74  s'%x).......df.t
+0005aaf0: 6f5f 6864 6628 7374 7228 6864 6635 5f6e  o_hdf(str(hdf5_n
+0005ab00: 616d 652e 7265 736f 6c76 6528 2929 2c20  ame.resolve()), 
+0005ab10: 6b65 793d 6b65 792c 2061 7070 656e 643d  key=key, append=
+0005ab20: 5472 7565 2c20 6d6f 6465 3d27 722b 272c  True, mode='r+',
+0005ab30: 2066 6f72 6d61 743d 2774 2729 0d0a 0909   format='t')....
+0005ab40: 0909 656c 7365 3a0d 0a09 0909 0909 6461  ..else:.......da
+0005ab50: 7461 203d 2073 656c 662e 5f5f 6469 6374  ta = self.__dict
+0005ab60: 5f5f 5b6b 6579 5d0d 0a09 0909 0909 6966  __[key].......if
+0005ab70: 2064 6174 6120 6973 204e 6f6e 653a 0d0a   data is None:..
+0005ab80: 0909 0909 0909 662e 6372 6561 7465 5f64  ......f.create_d
+0005ab90: 6174 6173 6574 286e 616d 653d 6b65 792c  ataset(name=key,
+0005aba0: 2064 6174 613d 274e 6f6e 6527 290d 0a09   data='None')...
+0005abb0: 0909 0909 656c 7365 3a0d 0a09 0909 0909  ....else:.......
+0005abc0: 0969 6620 6973 696e 7374 616e 6365 2864  .if isinstance(d
+0005abd0: 6174 612c 2070 616e 6461 732e 4461 7461  ata, pandas.Data
+0005abe0: 4672 616d 6529 3a0d 0a09 0909 0909 0909  Frame):.........
+0005abf0: 7061 7373 0d0a 0909 0909 0909 656c 7365  pass........else
+0005ac00: 3a0d 0a09 0909 0909 0909 7472 793a 0d0a  :.........try:..
+0005ac10: 0909 0909 0909 0909 662e 6372 6561 7465  ........f.create
+0005ac20: 5f64 6174 6173 6574 286e 616d 653d 6b65  _dataset(name=ke
+0005ac30: 792c 2064 6174 613d 6461 7461 290d 0a09  y, data=data)...
+0005ac40: 0909 0909 0909 6578 6365 7074 3a0d 0a09  ......except:...
+0005ac50: 0909 0909 0909 0969 6620 6b65 7920 3d3d  .......if key ==
+0005ac60: 2027 7061 7468 273a 0d0a 0909 0909 0909   'path':........
+0005ac70: 0909 0970 6173 730d 0a09 0909 0909 0909  ...pass.........
+0005ac80: 0965 6c69 6620 6b65 7920 3d3d 2027 6669  .elif key == 'fi
+0005ac90: 6775 7265 5f70 6174 6827 3a0d 0a09 0909  gure_path':.....
+0005aca0: 0909 0909 0909 7061 7373 0d0a 0909 0909  ......pass......
+0005acb0: 0909 0909 656c 7365 3a0d 0a09 0909 0909  ....else:.......
+0005acc0: 0909 0909 7072 696e 7428 2774 6865 2073  ....print('the s
+0005acd0: 6176 696e 6720 6f66 2020 2573 2020 6661  aving of  %s  fa
+0005ace0: 696c 6564 2725 6b65 7929 0d0a 0909 0969  iled'%key).....i
+0005acf0: 6620 6e6f 7420 2766 6974 636f 6566 6627  f not 'fitcoeff'
+0005ad00: 2069 6e20 663a 0d0a 0909 0909 7472 793a   in f:......try:
+0005ad10: 0d0a 0909 0909 0966 2e63 7265 6174 655f  .......f.create_
+0005ad20: 6461 7461 7365 7428 6e61 6d65 3d27 6669  dataset(name='fi
+0005ad30: 7463 6f65 6666 272c 2064 6174 613d 7365  tcoeff', data=se
+0005ad40: 6c66 2e66 6974 636f 6566 6629 0d0a 0909  lf.fitcoeff)....
+0005ad50: 0909 6578 6365 7074 3a0d 0a09 0909 0909  ..except:.......
+0005ad60: 7472 793a 0d0a 0909 0909 0909 7769 7468  try:........with
+0005ad70: 206f 7065 6e28 7365 6c66 2e63 6869 7270   open(self.chirp
+0005ad80: 5f66 696c 652c 2772 2729 2061 7320 6632  _file,'r') as f2
+0005ad90: 3a0d 0a09 0909 0909 0909 6669 7463 6f65  :.........fitcoe
+0005ada0: 6666 3d66 322e 7265 6164 6c69 6e65 2829  ff=f2.readline()
+0005adb0: 0d0a 0909 0909 0909 0966 2e63 7265 6174  .........f.creat
+0005adc0: 655f 6461 7461 7365 7428 6e61 6d65 3d27  e_dataset(name='
+0005add0: 6669 7463 6f65 6666 272c 2064 6174 613d  fitcoeff', data=
+0005ade0: 6669 7463 6f65 6666 290d 0a09 0909 0909  fitcoeff).......
+0005adf0: 6578 6365 7074 3a0d 0a09 0909 0909 0970  except:........p
+0005ae00: 6173 730d 0a09 0973 656c 662e 6473 5f6f  ass....self.ds_o
+0005ae10: 7269 2e74 6f5f 6864 6628 7374 7228 6864  ri.to_hdf(str(hd
+0005ae20: 6635 5f6e 616d 652e 7265 736f 6c76 6528  f5_name.resolve(
+0005ae30: 2929 2c20 6b65 793d 2764 735f 6f72 6927  )), key='ds_ori'
+0005ae40: 2c20 6170 7065 6e64 3d54 7275 652c 206d  , append=True, m
+0005ae50: 6f64 653d 2772 2b27 2c20 666f 726d 6174  ode='r+', format
+0005ae60: 3d27 7427 2923 7361 7665 5f72 6177 5f64  ='t')#save_raw_d
+0005ae70: 6174 610d 0a09 0969 6620 7265 5f73 7769  ata....if re_swi
+0005ae80: 7463 683a 0d0a 0909 0923 7072 696e 7428  tch:.....#print(
+0005ae90: 2772 652d 7377 6974 6368 6564 2729 0d0a  're-switched')..
+0005aea0: 0909 0966 6f72 206b 6579 2069 6e20 5b27  ...for key in ['
+0005aeb0: 4127 2c20 2741 4327 2c20 2741 4527 2c20  A', 'AC', 'AE', 
+0005aec0: 2744 4143 272c 2027 6327 5d3a 0d0a 0909  'DAC', 'c']:....
+0005aed0: 0909 7365 6c66 2e72 655b 6b65 795d 2e74  ..self.re[key].t
+0005aee0: 6f5f 6864 6628 7374 7228 6864 6635 5f6e  o_hdf(str(hdf5_n
+0005aef0: 616d 652e 7265 736f 6c76 6528 2929 2c20  ame.resolve()), 
+0005af00: 6b65 793d 2772 655f 2720 2b20 6b65 792c  key='re_' + key,
+0005af10: 2061 7070 656e 643d 5472 7565 2c20 6d6f   append=True, mo
+0005af20: 6465 3d27 722b 272c 2066 6f72 6d61 743d  de='r+', format=
+0005af30: 2774 2729 0d0a 0909 7472 793a 0d0a 0909  't')....try:....
+0005af40: 0966 2e63 6c6f 7365 2829 0d0a 0909 6578  .f.close()....ex
+0005af50: 6365 7074 3a0d 0a09 0909 7061 7373 0d0a  cept:.....pass..
+0005af60: 0909 0d0a 0909 7072 696e 7428 2754 6865  ......print('The
+0005af70: 2070 726f 6a65 6374 2077 6173 2073 6176   project was sav
+0005af80: 6564 2074 6f20 2573 2725 6368 6563 6b5f  ed to %s'%check_
+0005af90: 666f 6c64 6572 2870 6174 6820 3d20 7061  folder(path = pa
+0005afa0: 7468 2c20 6375 7272 656e 745f 7061 7468  th, current_path
+0005afb0: 203d 2073 656c 662e 7061 7468 2929 0d0a   = self.path))..
+0005afc0: 0d0a 0d0a 0964 6566 205f 5f72 6561 645f  .....def __read_
+0005afd0: 7072 6f6a 6563 7428 7365 6c66 2c20 7361  project(self, sa
+0005afe0: 7665 645f 7072 6f6a 6563 743d 4e6f 6e65  ved_project=None
+0005aff0: 2c63 7572 7265 6e74 5f70 6174 683d 4e6f  ,current_path=No
+0005b000: 6e65 293a 0d0a 0909 2727 2766 756e 6374  ne):....'''funct
+0005b010: 696f 6e20 746f 2072 652d 7265 6164 2061  ion to re-read a
+0005b020: 6c6c 2074 6865 2070 6172 616d 6574 6572  ll the parameter
+0005b030: 206f 6620 6120 7072 6576 696f 7573 2061   of a previous a
+0005b040: 6e61 6c79 7369 7320 0d0a 0909 696e 746f  nalysis ....into
+0005b050: 2061 6e20 6864 6635 2066 696c 652c 2063   an hdf5 file, c
+0005b060: 7572 7265 6e74 2070 6174 6820 6973 2074  urrent path is t
+0005b070: 6865 2070 6174 6820 7468 6174 2074 6865  he path that the
+0005b080: 2066 696c 6520 7368 6f75 6c64 200d 0a09   file should ...
+0005b090: 0961 7373 756d 6520 6973 2069 7473 2022  .assume is its "
+0005b0a0: 686f 6d65 2064 6972 6563 746f 7279 2220  home directory" 
+0005b0b0: 6166 7465 7220 7375 6363 6573 7366 756c  after successful
+0005b0c0: 206c 6f61 6469 6e67 2e20 4966 206e 6f74   loading. If not
+0005b0d0: 200d 0a09 0973 6574 2077 6520 7461 6b65   ....set we take
+0005b0e0: 2074 6865 2066 696c 6570 6174 6820 6174   the filepath at
+0005b0f0: 2077 6869 6368 2074 6865 2066 696c 6520   which the file 
+0005b100: 6973 2063 7572 7265 6e74 6c79 2073 746f  is currently sto
+0005b110: 7265 6420 6173 2070 6174 6827 2727 0d0a  red as path'''..
+0005b120: 0909 6966 2073 6176 6564 5f70 726f 6a65  ..if saved_proje
+0005b130: 6374 2069 7320 4e6f 6e65 3a0d 0a09 0909  ct is None:.....
+0005b140: 7261 6973 6520 496d 706f 7274 4572 726f  raise ImportErro
+0005b150: 7228 2757 6520 646f 206e 6565 6420 6120  r('We do need a 
+0005b160: 7072 6f6a 6563 7420 746f 2069 6d70 6f72  project to impor
+0005b170: 7427 290d 0a09 0969 6620 6375 7272 656e  t')....if curren
+0005b180: 745f 7061 7468 2069 7320 4e6f 6e65 3a63  t_path is None:c
+0005b190: 7572 7265 6e74 5f70 6174 683d 6f73 2e70  urrent_path=os.p
+0005b1a0: 6174 682e 6469 726e 616d 6528 6f73 2e70  ath.dirname(os.p
+0005b1b0: 6174 682e 6162 7370 6174 6828 7361 7665  ath.abspath(save
+0005b1c0: 645f 7072 6f6a 6563 7429 290d 0a09 0974  d_project))....t
+0005b1d0: 7279 3a0d 0a09 0909 696d 706f 7274 2068  ry:.....import h
+0005b1e0: 3570 790d 0a09 0965 7863 6570 743a 0d0a  5py....except:..
+0005b1f0: 0909 200d 0a09 0909 7072 696e 7428 2763  .. .....print('c
+0005b200: 6f75 6c64 206e 6f74 2069 6d70 6f72 7420  ould not import 
+0005b210: 6864 6635 2c20 6375 7272 656e 7420 7665  hdf5, current ve
+0005b220: 7273 696f 6e20 7265 7175 6972 6573 2074  rsion requires t
+0005b230: 6861 7420 7468 6973 2069 7320 696e 7374  hat this is inst
+0005b240: 616c 6c65 642e 2049 4620 7275 6e6e 696e  alled. IF runnin
+0005b250: 6720 416e 6163 6f6e 6461 206f 7065 6e20  g Anaconda open 
+0005b260: 436f 6e64 6120 7072 6f6d 7420 616e 6420  Conda promt and 
+0005b270: 7479 7065 3a20 636f 6e64 6120 696e 7374  type: conda inst
+0005b280: 616c 6c20 6835 7079 2729 0d0a 0909 6461  all h5py')....da
+0005b290: 7461 5f66 7261 6d65 5f6c 6973 743d 5b5d  ta_frame_list=[]
+0005b2a0: 0d0a 0d0a 0909 2320 7765 2068 6176 2074  ......# we hav t
+0005b2b0: 6f20 6861 6e64 6c65 2074 6865 206f 6c64  o handle the old
+0005b2c0: 2061 6e64 206e 6577 2074 7970 6520 6f66   and new type of
+0005b2d0: 2073 6176 696e 670d 0a09 0977 6974 6820   saving....with 
+0005b2e0: 6835 7079 2e46 696c 6528 7361 7665 645f  h5py.File(saved_
+0005b2f0: 7072 6f6a 6563 742c 2027 7227 2920 6173  project, 'r') as
+0005b300: 2066 3a0d 0a09 0909 6966 2027 7265 5f66   f:.....if 're_f
+0005b310: 696e 616c 5f73 6574 7570 5f70 6172 2720  inal_setup_par' 
+0005b320: 696e 2066 2e6b 6579 7328 293a 6f6c 645f  in f.keys():old_
+0005b330: 7377 6974 6368 3d54 7275 650d 0a09 0909  switch=True.....
+0005b340: 0909 200d 0a09 090d 0a09 0909 656c 7365  .. .........else
+0005b350: 3a6f 6c64 5f73 7769 7463 683d 4661 6c73  :old_switch=Fals
+0005b360: 650d 0a09 0909 0909 2020 200d 0a09 0969  e.......   ....i
+0005b370: 6620 6f6c 645f 7377 6974 6368 3a70 7269  f old_switch:pri
+0005b380: 6e74 2827 7765 2072 6561 6420 616e 206f  nt('we read an o
+0005b390: 6c64 2073 7479 6c65 2064 6174 615f 6669  ld style data_fi
+0005b3a0: 6c65 2061 6e64 2064 6972 6563 746c 7920  le and directly 
+0005b3b0: 7570 6461 7465 2069 7420 696e 746f 2074  update it into t
+0005b3c0: 6865 206e 6577 2066 696c 655f 7479 7065  he new file_type
+0005b3d0: 2061 6674 6572 206c 6f61 6469 6e67 2729   after loading')
+0005b3e0: 0d0a 0909 7769 7468 2068 3570 792e 4669  ....with h5py.Fi
+0005b3f0: 6c65 2873 6176 6564 5f70 726f 6a65 6374  le(saved_project
+0005b400: 2c20 2772 2729 2061 7320 663a 0d0a 0909  , 'r') as f:....
+0005b410: 0966 6f72 206b 6579 2069 6e20 662e 6b65  .for key in f.ke
+0005b420: 7973 2829 3a0d 0a09 0909 0974 7279 3a0d  ys():......try:.
+0005b430: 0a09 0909 0909 6966 2022 7265 5f22 2069  ......if "re_" i
+0005b440: 6e20 6b65 795b 3a33 5d3a 0d0a 0909 0909  n key[:3]:......
+0005b450: 0909 6966 206e 6f74 2027 7265 2720 696e  ..if not 're' in
+0005b460: 2073 656c 662e 5f5f 6469 6374 5f5f 2e6b   self.__dict__.k
+0005b470: 6579 7328 293a 0d0a 0909 0909 0909 0973  eys():.........s
+0005b480: 656c 662e 5f5f 6469 6374 5f5f 5b27 7265  elf.__dict__['re
+0005b490: 275d 3d7b 7d0d 0a09 0909 0909 0973 656c  ']={}........sel
+0005b4a0: 662e 5f5f 6469 6374 5f5f 5b27 7265 275d  f.__dict__['re']
+0005b4b0: 5b6b 6579 5b33 3a5d 5d3d 665b 6b65 795d  [key[3:]]=f[key]
+0005b4c0: 5b28 295d 0d0a 0909 0909 0965 6c69 6620  [()].......elif 
+0005b4d0: 2262 6163 6b22 2069 6e20 6b65 795b 3a34  "back" in key[:4
+0005b4e0: 5d3a 0d0a 0909 0909 0909 7265 613d 665b  ]:........rea=f[
+0005b4f0: 6b65 795d 5b28 295d 0d0a 0909 0909 0909  key][()]........
+0005b500: 7365 6c66 2e5f 5f64 6963 745f 5f5b 2762  self.__dict__['b
+0005b510: 6163 6b67 726f 756e 645f 7061 7227 5d3d  ackground_par']=
+0005b520: 5b4e 6f6e 652c 2d31 2c46 616c 7365 5d0d  [None,-1,False].
+0005b530: 0a09 0909 0909 0973 656c 662e 5f5f 6469  .......self.__di
+0005b540: 6374 5f5f 5b27 6261 636b 6772 6f75 6e64  ct__['background
+0005b550: 5f70 6172 275d 2e61 7070 656e 6428 7265  _par'].append(re
+0005b560: 6129 0d0a 0909 0909 0965 6c69 6620 2270  a).......elif "p
+0005b570: 6172 2220 696e 206b 6579 5b3a 335d 3a0d  ar" in key[:3]:.
+0005b580: 0a09 0909 0909 0969 6620 6f6c 645f 7377  .......if old_sw
+0005b590: 6974 6368 3a23 6f6c 6420 7479 7065 206f  itch:#old type o
+0005b5a0: 6620 7361 7665 6420 6461 7461 0d0a 0909  f saved data....
+0005b5b0: 0909 0909 0974 7279 3a0d 0a09 0909 0909  .....try:.......
+0005b5c0: 0909 096f 732e 7265 6d6f 7665 2827 7465  ...os.remove('te
+0005b5d0: 6d70 5f66 696c 652e 6a73 6f6e 2729 0d0a  mp_file.json')..
+0005b5e0: 0909 0909 0909 0965 7863 6570 743a 0d0a  .......except:..
+0005b5f0: 0909 0909 0909 0909 7061 7373 0d0a 0909  ........pass....
 0005b600: 0909 0909 0977 6974 6820 6f70 656e 2827  .....with open('
 0005b610: 7465 6d70 5f66 696c 652e 6a73 6f6e 272c  temp_file.json',
-0005b620: 2772 2729 2061 7320 673a 0d0a 0909 0909  'r') as g:......
-0005b630: 0909 0909 7365 6c66 2e70 6172 3d6c 6d66  ....self.par=lmf
-0005b640: 6974 2e50 6172 616d 6574 6572 7328 290d  it.Parameters().
-0005b650: 0a09 0909 0909 0909 0973 656c 662e 7061  .........self.pa
-0005b660: 722e 6c6f 6164 2867 290d 0a09 0909 0909  r.load(g).......
-0005b670: 0909 7472 793a 0d0a 0909 0909 0909 0909  ..try:..........
-0005b680: 6f73 2e72 656d 6f76 6528 2774 656d 705f  os.remove('temp_
-0005b690: 6669 6c65 2e6a 736f 6e27 290d 0a09 0909  file.json').....
-0005b6a0: 0909 0909 6578 6365 7074 3a0d 0a09 0909  ....except:.....
-0005b6b0: 0909 0909 0970 6173 730d 0a09 0909 0909  .....pass.......
-0005b6c0: 0965 6c73 653a 236e 6577 2074 7970 6520  .else:#new type 
-0005b6d0: 6f66 2064 6174 610d 0a09 0909 0909 0909  of data.........
-0005b6e0: 7261 6973 6509 090d 0a09 0909 0909 656c  raise.........el
-0005b6f0: 7365 3a0d 0a09 0909 0909 0972 6561 643d  se:........read=
-0005b700: 665b 6b65 795d 5b28 295d 0d0a 0909 0909  f[key][()]......
-0005b710: 0909 6966 2069 7369 6e73 7461 6e63 6528  ..if isinstance(
-0005b720: 7265 6164 2c62 7974 6573 293a 0d0a 0909  read,bytes):....
-0005b730: 0909 0909 0972 6561 643d 665b 6b65 795d  .....read=f[key]
-0005b740: 2e61 7373 7472 2829 5b28 295d 200d 0a09  .asstr()[()] ...
-0005b750: 0909 0909 0965 6c69 6620 6973 696e 7374  .....elif isinst
-0005b760: 616e 6365 2872 6561 642c 7479 7065 2827  ance(read,type('
-0005b770: 6865 6c6c 6f27 2929 3a0d 0a09 0909 0909  hello')):.......
-0005b780: 0909 6966 2028 7265 6164 3d3d 274e 6f6e  ..if (read=='Non
-0005b790: 6527 2920 6f72 2028 7265 6164 3d3d 276e  e') or (read=='n
-0005b7a0: 6f6e 6527 293a 0d0a 0909 0909 0909 0909  one'):..........
-0005b7b0: 7265 6164 3d4e 6f6e 650d 0a09 0909 0909  read=None.......
-0005b7c0: 0965 6c69 6620 6b65 7920 696e 205b 2762  .elif key in ['b
-0005b7d0: 6f72 6465 7263 7574 272c 2774 696d 656c  ordercut','timel
-0005b7e0: 696d 6974 7327 2c27 6669 7463 6f65 6666  imits','fitcoeff
-0005b7f0: 272c 2773 6361 7474 6572 6375 7427 5d3a  ','scattercut']:
-0005b800: 0d0a 0909 0909 0909 0972 6561 643d 5b66  .........read=[f
-0005b810: 6c6f 6174 2861 2920 666f 7220 6120 696e  loat(a) for a in
-0005b820: 2072 6561 645d 0d0a 0909 0909 0909 656c   read]........el
-0005b830: 6966 206b 6579 203d 3d27 696e 7465 6e73  if key =='intens
-0005b840: 6974 795f 7261 6e67 6527 3a0d 0a09 0909  ity_range':.....
+0005b620: 2777 2729 2061 7320 673a 0d0a 0909 0909  'w') as g:......
+0005b630: 0909 0909 672e 7772 6974 6528 665b 6b65  ....g.write(f[ke
+0005b640: 795d 5b28 295d 290d 0a09 0909 0909 0909  y][()]).........
+0005b650: 7769 7468 206f 7065 6e28 2774 656d 705f  with open('temp_
+0005b660: 6669 6c65 2e6a 736f 6e27 2c27 7227 2920  file.json','r') 
+0005b670: 6173 2067 3a0d 0a09 0909 0909 0909 0973  as g:..........s
+0005b680: 656c 662e 7061 723d 6c6d 6669 742e 5061  elf.par=lmfit.Pa
+0005b690: 7261 6d65 7465 7273 2829 0d0a 0909 0909  rameters()......
+0005b6a0: 0909 0909 7365 6c66 2e70 6172 2e6c 6f61  ....self.par.loa
+0005b6b0: 6428 6729 0d0a 0909 0909 0909 0974 7279  d(g).........try
+0005b6c0: 3a0d 0a09 0909 0909 0909 096f 732e 7265  :..........os.re
+0005b6d0: 6d6f 7665 2827 7465 6d70 5f66 696c 652e  move('temp_file.
+0005b6e0: 6a73 6f6e 2729 0d0a 0909 0909 0909 0965  json').........e
+0005b6f0: 7863 6570 743a 0d0a 0909 0909 0909 0909  xcept:..........
+0005b700: 7061 7373 0d0a 0909 0909 0909 656c 7365  pass........else
+0005b710: 3a23 6e65 7720 7479 7065 206f 6620 6461  :#new type of da
+0005b720: 7461 0d0a 0909 0909 0909 0972 6169 7365  ta.........raise
+0005b730: 0909 0d0a 0909 0909 0965 6c73 653a 0d0a  .........else:..
+0005b740: 0909 0909 0909 7265 6164 3d66 5b6b 6579  ......read=f[key
+0005b750: 5d5b 2829 5d0d 0a09 0909 0909 0969 6620  ][()]........if 
+0005b760: 6973 696e 7374 616e 6365 2872 6561 642c  isinstance(read,
+0005b770: 6279 7465 7329 3a0d 0a09 0909 0909 0909  bytes):.........
+0005b780: 7265 6164 3d66 5b6b 6579 5d2e 6173 7374  read=f[key].asst
+0005b790: 7228 295b 2829 5d20 0d0a 0909 0909 0909  r()[()] ........
+0005b7a0: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
+0005b7b0: 7265 6164 2c74 7970 6528 2768 656c 6c6f  read,type('hello
+0005b7c0: 2729 293a 0d0a 0909 0909 0909 0969 6620  ')):.........if 
+0005b7d0: 2872 6561 643d 3d27 4e6f 6e65 2729 206f  (read=='None') o
+0005b7e0: 7220 2872 6561 643d 3d27 6e6f 6e65 2729  r (read=='none')
+0005b7f0: 3a0d 0a09 0909 0909 0909 0972 6561 643d  :..........read=
+0005b800: 4e6f 6e65 0d0a 0909 0909 0909 656c 6966  None........elif
+0005b810: 206b 6579 2069 6e20 5b27 626f 7264 6572   key in ['border
+0005b820: 6375 7427 2c27 7469 6d65 6c69 6d69 7473  cut','timelimits
+0005b830: 272c 2766 6974 636f 6566 6627 2c27 7363  ','fitcoeff','sc
+0005b840: 6174 7465 7263 7574 275d 3a0d 0a09 0909  attercut']:.....
 0005b850: 0909 0909 7265 6164 3d5b 666c 6f61 7428  ....read=[float(
 0005b860: 6129 2066 6f72 2061 2069 6e20 7265 6164  a) for a in read
 0005b870: 5d0d 0a09 0909 0909 0965 6c69 6620 6b65  ]........elif ke
-0005b880: 7920 696e 205b 2772 656c 5f74 696d 6527  y in ['rel_time'
-0005b890: 2c27 7265 6c5f 7761 7665 275d 3a0d 0a09  ,'rel_wave']:...
-0005b8a0: 0909 0909 0909 7265 6164 3d6e 702e 6172  ......read=np.ar
-0005b8b0: 7261 7928 7265 6164 2c64 7479 7065 3d6e  ray(read,dtype=n
-0005b8c0: 702e 666c 6f61 7436 3429 0d0a 0909 0909  p.float64)......
-0005b8d0: 0909 656c 6966 206b 6579 2069 6e20 5b27  ..elif key in ['
-0005b8e0: 7363 6174 7465 7263 7574 275d 3a0d 0a09  scattercut']:...
-0005b8f0: 0909 0909 0909 7472 793a 0d0a 0909 0909  ......try:......
-0005b900: 0909 0909 7265 6164 3d5b 666c 6f61 7428  ....read=[float(
-0005b910: 6129 2066 6f72 2061 2069 6e20 7265 6164  a) for a in read
-0005b920: 5d0d 0a09 0909 0909 0909 6578 6365 7074  ].........except
-0005b930: 3a23 6d61 7962 6520 7765 2068 6176 6520  :#maybe we have 
-0005b940: 2061 206c 6973 7420 6f66 2073 6361 7474   a list of scatt
-0005b950: 6572 6375 7473 0d0a 0909 0909 0909 0909  ercuts..........
-0005b960: 7472 793a 0d0a 0909 0909 0909 0909 096f  try:...........o
-0005b970: 7574 5f6c 6973 7465 6e3d 5b5d 0d0a 0909  ut_listen=[]....
-0005b980: 0909 0909 0909 0966 6f72 206c 6973 7465  .......for liste
-0005b990: 6e20 696e 2072 6561 643a 0d0a 0909 0909  n in read:......
-0005b9a0: 0909 0909 0909 6f75 746c 6973 7465 6e2e  ......outlisten.
-0005b9b0: 6170 7065 6e64 285b 666c 6f61 7428 6129  append([float(a)
-0005b9c0: 2066 6f72 2061 2069 6e20 6c69 7374 656e   for a in listen
-0005b9d0: 5d29 0d0a 0909 0909 0909 0909 6578 6365  ])..........exce
-0005b9e0: 7074 3a23 6e6f 2069 6465 6120 6c65 7473  pt:#no idea lets
-0005b9f0: 2073 6565 2077 6861 7420 6861 7070 656e   see what happen
-0005ba00: 730d 0a09 0909 0909 0909 0909 7061 7373  s...........pass
-0005ba10: 0d0a 0909 0909 0909 7365 6c66 2e5f 5f64  ........self.__d
-0005ba20: 6963 745f 5f5b 6b65 795d 3d72 6561 640d  ict__[key]=read.
-0005ba30: 0a09 0909 0965 7863 6570 743a 2377 6527  .....except:#we'
-0005ba40: 6c6c 2067 6574 2061 6e20 6578 6365 7074  ll get an except
-0005ba50: 696f 6e20 6576 6572 7920 7469 6d65 2074  ion every time t
-0005ba60: 6865 7265 2069 7320 616e 2064 6174 6166  here is an dataf
-0005ba70: 7261 6d65 0d0a 0909 0909 0923 7072 696e  rame.......#prin
-0005ba80: 7428 2746 7261 6d65 3a27 2b6b 6579 290d  t('Frame:'+key).
-0005ba90: 0a09 0909 0909 6461 7461 5f66 7261 6d65  ......data_frame
-0005baa0: 5f6c 6973 742e 6170 7065 6e64 286b 6579  _list.append(key
-0005bab0: 290d 0a0d 0a09 0974 7279 3a0d 0a09 0909  )......try:.....
-0005bac0: 662e 636c 6f73 6528 290d 0a09 0965 7863  f.close()....exc
-0005bad0: 6570 743a 0d0a 0909 0970 6173 730d 0a09  ept:.....pass...
-0005bae0: 0966 6f72 206b 6579 2069 6e20 6461 7461  .for key in data
-0005baf0: 5f66 7261 6d65 5f6c 6973 743a 0d0a 0909  _frame_list:....
-0005bb00: 0974 7279 3a0d 0a09 0909 0969 6620 2272  .try:......if "r
-0005bb10: 655f 2220 696e 206b 6579 5b3a 335d 3a0d  e_" in key[:3]:.
-0005bb20: 0a09 0909 0909 2370 7269 6e74 2827 7265  ......#print('re
-0005bb30: 2069 6e20 6c69 7374 2729 0d0a 0909 0909   in list')......
-0005bb40: 0973 656c 662e 5f5f 6469 6374 5f5f 5b27  .self.__dict__['
-0005bb50: 7265 275d 5b6b 6579 5b33 3a5d 5d3d 7061  re'][key[3:]]=pa
-0005bb60: 6e64 6173 2e72 6561 645f 6864 6628 7361  ndas.read_hdf(sa
-0005bb70: 7665 645f 7072 6f6a 6563 742c 6b65 793d  ved_project,key=
-0005bb80: 6b65 792c 6d6f 6465 3d27 7227 2c64 6174  key,mode='r',dat
-0005bb90: 615f 636f 6c75 6d6e 733d 5472 7565 290d  a_columns=True).
-0005bba0: 0a09 0909 0965 6c69 6620 6b65 7920 696e  .....elif key in
-0005bbb0: 205b 2764 735f 6f72 6927 2c27 7061 725f   ['ds_ori','par_
-0005bbc0: 6669 7427 2c27 7061 7227 5d3a 0d0a 0909  fit','par']:....
-0005bbd0: 0909 0973 656c 662e 5f5f 6469 6374 5f5f  ...self.__dict__
-0005bbe0: 5b6b 6579 5d3d 7061 6e64 6173 2e72 6561  [key]=pandas.rea
-0005bbf0: 645f 6864 6628 7361 7665 645f 7072 6f6a  d_hdf(saved_proj
-0005bc00: 6563 742c 6b65 793d 6b65 792c 6d6f 6465  ect,key=key,mode
-0005bc10: 3d27 7227 2c64 6174 615f 636f 6c75 6d6e  ='r',data_column
-0005bc20: 733d 5472 7565 290d 0a09 0909 0965 6c73  s=True)......els
-0005bc30: 653a 0d0a 0909 0909 0970 7269 6e74 2822  e:.......print("
-0005bc40: 6d69 7373 696e 6720 6b65 793a 2220 2b20  missing key:" + 
-0005bc50: 6b65 7929 0d0a 0909 0965 7863 6570 743a  key).....except:
-0005bc60: 0d0a 0909 0909 6966 206b 6579 203d 3d20  ......if key == 
-0005bc70: 2770 6172 2720 616e 6420 6f6c 645f 7377  'par' and old_sw
-0005bc80: 6974 6368 3a70 6173 7320 2320 7765 2068  itch:pass # we h
-0005bc90: 6176 6520 7265 6164 2069 7420 6265 666f  ave read it befo
-0005bca0: 7265 2061 6c72 6561 6479 2061 6e64 2074  re already and t
-0005bcb0: 6865 2065 7272 6f72 2069 7320 6f6b 0d0a  he error is ok..
-0005bcc0: 0909 200d 0a09 0909 0965 6c73 653a 7072  .. ......else:pr
-0005bcd0: 696e 7428 2265 7272 6f72 2069 6e20 6b65  int("error in ke
-0005bce0: 793a 2220 2b20 6b65 7929 0d0a 0909 0d0a  y:" + key)......
-0005bcf0: 0909 7472 793a 0d0a 0909 0973 656c 662e  ..try:.....self.
-0005bd00: 5f5f 6469 6374 5f5f 5b27 7265 275d 5b27  __dict__['re']['
-0005bd10: 6669 745f 7265 7375 6c74 735f 7261 7465  fit_results_rate
-0005bd20: 7327 5d3d 7365 6c66 2e5f 5f64 6963 745f  s']=self.__dict_
-0005bd30: 5f5b 2770 6172 5f66 6974 275d 0d0a 0909  _['par_fit']....
-0005bd40: 0973 656c 662e 5f5f 6469 6374 5f5f 5b27  .self.__dict__['
-0005bd50: 7265 275d 5b27 6669 745f 7265 7375 6c74  re']['fit_result
-0005bd60: 735f 7469 6d65 7327 5d3d 7061 7264 665f  s_times']=pardf_
-0005bd70: 746f 5f74 696d 6564 6628 7365 6c66 2e5f  to_timedf(self._
-0005bd80: 5f64 6963 745f 5f5b 2772 6527 5d5b 2766  _dict__['re']['f
-0005bd90: 6974 5f72 6573 756c 7473 5f72 6174 6573  it_results_rates
-0005bda0: 275d 290d 0a09 0965 7863 6570 743a 0d0a  '])....except:..
-0005bdb0: 0909 0970 6173 730d 0a09 090d 0a09 0923  ...pass........#
-0005bdc0: 7468 6520 7061 7220 636f 6e76 6572 7369  the par conversi
-0005bdd0: 6f6e 2066 756e 6374 696f 6e20 6661 696c  on function fail
-0005bde0: 6564 2c20 7175 6963 6b66 6978 0d0a 0909  ed, quickfix....
-0005bdf0: 666f 7220 6f76 6572 5f6b 6579 2069 6e20  for over_key in 
-0005be00: 5b27 7061 725f 6669 7427 2c27 7061 7227  ['par_fit','par'
-0005be10: 5d3a 0d0a 0909 0974 7279 3a0d 0a09 0909  ]:.....try:.....
-0005be20: 0970 6172 5f64 663d 7365 6c66 2e5f 5f64  .par_df=self.__d
-0005be30: 6963 745f 5f5b 6f76 6572 5f6b 6579 5d2e  ict__[over_key].
-0005be40: 6c6f 635b 3a2c 5b27 7661 6c75 6527 2c27  loc[:,['value','
-0005be50: 6d69 6e27 2c27 6d61 7827 2c27 7661 7279  min','max','vary
-0005be60: 272c 2765 7870 7227 5d5d 0d0a 0909 0909  ','expr']]......
-0005be70: 7061 723d 6c6d 6669 742e 5061 7261 6d65  par=lmfit.Parame
-0005be80: 7465 7273 2829 0d0a 0909 0909 666f 7220  ters()......for 
-0005be90: 6b65 7920 696e 2070 6172 5f64 662e 696e  key in par_df.in
-0005bea0: 6465 782e 7661 6c75 6573 3a0d 0a09 0909  dex.values:.....
-0005beb0: 0909 7061 722e 6164 6428 6b65 792c 2076  ..par.add(key, v
-0005bec0: 616c 7565 3d70 6172 5f64 662e 6c6f 635b  alue=par_df.loc[
-0005bed0: 6b65 792c 2776 616c 7565 275d 2c20 7661  key,'value'], va
-0005bee0: 7279 3d70 6172 5f64 662e 6c6f 635b 6b65  ry=par_df.loc[ke
-0005bef0: 792c 2776 6172 7927 5d2c 206d 696e 3d70  y,'vary'], min=p
-0005bf00: 6172 5f64 662e 6c6f 635b 6b65 792c 276d  ar_df.loc[key,'m
-0005bf10: 696e 275d 2c20 6d61 783d 7061 725f 6466  in'], max=par_df
-0005bf20: 2e6c 6f63 5b6b 6579 2c27 6d61 7827 5d29  .loc[key,'max'])
-0005bf30: 0d0a 0909 0909 0909 0909 0909 0909 0909  ................
-0005bf40: 0920 200d 0a09 0909 0973 656c 662e 5f5f  .  ......self.__
-0005bf50: 6469 6374 5f5f 5b6f 7665 725f 6b65 795d  dict__[over_key]
-0005bf60: 3d70 6172 0d0a 0909 0965 7863 6570 743a  =par.....except:
-0005bf70: 0d0a 0909 0909 7061 7373 0d0a 0909 6966  ......pass....if
-0005bf80: 206f 6c64 5f73 7769 7463 683a 0d0a 0909   old_switch:....
-0005bf90: 0974 7279 3a0d 0a09 0909 0973 656c 662e  .try:......self.
-0005bfa0: 5f5f 6469 6374 5f5f 5b27 7265 275d 5b27  __dict__['re']['
-0005bfb0: 6669 745f 7265 7375 6c74 735f 7261 7465  fit_results_rate
-0005bfc0: 7327 5d3d 7061 725f 746f 5f70 6172 6466  s']=par_to_pardf
-0005bfd0: 2873 656c 662e 7061 7229 0d0a 0909 0909  (self.par)......
-0005bfe0: 7365 6c66 2e5f 5f64 6963 745f 5f5b 2772  self.__dict__['r
-0005bff0: 6527 5d5b 2766 6974 5f72 6573 756c 7473  e']['fit_results
-0005c000: 5f74 696d 6573 275d 3d70 6172 6466 5f74  _times']=pardf_t
-0005c010: 6f5f 7469 6d65 6466 2870 6172 5f74 6f5f  o_timedf(par_to_
-0005c020: 7061 7264 6628 7365 6c66 2e70 6172 2929  pardf(self.par))
-0005c030: 0d0a 0909 0909 7365 6c66 2e5f 5f64 6963  ......self.__dic
-0005c040: 745f 5f5b 2770 6172 5f66 6974 275d 3d73  t__['par_fit']=s
-0005c050: 656c 662e 7061 720d 0a09 0909 6578 6365  elf.par.....exce
-0005c060: 7074 3a0d 0a09 0909 0970 6173 730d 0a09  pt:......pass...
-0005c070: 0973 656c 662e 7361 7665 5f66 6967 7572  .self.save_figur
-0005c080: 6573 5f74 6f5f 666f 6c64 6572 3d46 616c  es_to_folder=Fal
-0005c090: 7365 0d0a 0909 7365 6c66 2e70 6174 683d  se....self.path=
-0005c0a0: 6375 7272 656e 745f 7061 7468 0d0a 0909  current_path....
-0005c0b0: 6966 206f 6c64 5f73 7769 7463 683a 2363  if old_switch:#c
-0005c0c0: 6f6e 7665 7274 2070 726f 6a65 6374 2069  onvert project i
-0005c0d0: 6e74 6f20 6e65 7720 7479 7065 0d0a 0909  nto new type....
-0005c0e0: 0923 636c 6561 6e20 6f6c 6420 6669 6c65  .#clean old file
-0005c0f0: 7320 7468 6174 2077 6572 6520 7265 6164  s that were read
-0005c100: 2077 726f 6e67 0d0a 0909 0966 6f72 206b   wrong.....for k
-0005c110: 6579 2069 6e20 5b27 7265 5f66 696e 616c  ey in ['re_final
-0005c120: 5f69 6e74 5f70 6172 272c 2772 655f 6669  _int_par','re_fi
-0005c130: 6e61 6c5f 7365 7475 705f 7061 7227 2c27  nal_setup_par','
-0005c140: 7265 5f66 696e 616c 5f74 696d 655f 7061  re_final_time_pa
-0005c150: 7227 2c27 7265 5f69 6e74 5f65 7272 6f72  r','re_int_error
-0005c160: 275d 3a0d 0a09 0909 0974 7279 3a0d 0a09  ']:......try:...
-0005c170: 0909 0909 6465 6c20 7365 6c66 2e5f 5f64  ....del self.__d
-0005c180: 6963 745f 5f5b 6b65 795d 0d0a 0909 0909  ict__[key]......
-0005c190: 6578 6365 7074 204b 6579 4572 726f 723a  except KeyError:
-0005c1a0: 0d0a 0909 0909 0970 7269 6e74 2866 274b  .......print(f'K
-0005c1b0: 6579 207b 6b65 797d 2069 7320 6e6f 7420  ey {key} is not 
-0005c1c0: 696e 2074 6865 2064 6963 7469 6f6e 6172  in the dictionar
-0005c1d0: 7927 290d 0a09 0909 666f 7220 6b65 7920  y').....for key 
-0005c1e0: 696e 205b 2766 696e 616c 5f69 6e74 5f70  in ['final_int_p
-0005c1f0: 6172 272c 2766 696e 616c 5f73 6574 7570  ar','final_setup
-0005c200: 5f70 6172 272c 2766 696e 616c 5f74 696d  _par','final_tim
-0005c210: 655f 7061 7227 2c27 696e 745f 6572 726f  e_par','int_erro
-0005c220: 7227 5d3a 0d0a 0909 0909 7472 793a 0d0a  r']:......try:..
-0005c230: 0909 0909 0964 656c 2073 656c 662e 5f5f  .....del self.__
-0005c240: 6469 6374 5f5f 5b27 7265 275d 5b6b 6579  dict__['re'][key
-0005c250: 5d0d 0a09 0909 0965 7863 6570 7420 4b65  ]......except Ke
-0005c260: 7945 7272 6f72 3a0d 0a09 0909 0909 7072  yError:.......pr
-0005c270: 696e 7428 6627 4b65 7920 7b6b 6579 7d20  int(f'Key {key} 
-0005c280: 6973 206e 6f74 2069 6e20 7468 6520 6469  is not in the di
-0005c290: 6374 696f 6e61 7279 2729 0d0a 0909 0974  ctionary').....t
-0005c2a0: 7279 3a0d 0a09 0909 0973 656c 662e 7361  ry:......self.sa
-0005c2b0: 7665 5f70 726f 6a65 6374 2829 0d0a 0909  ve_project()....
-0005c2c0: 0909 7072 696e 7428 2270 726f 6a65 6374  ..print("project
-0005c2d0: 2063 6f6e 7665 7274 6564 2069 6e74 6f20   converted into 
-0005c2e0: 6e65 7720 6461 7461 2074 7970 6520 616e  new data type an
-0005c2f0: 6420 7361 7665 6420 6167 6169 6e22 290d  d saved again").
-0005c300: 0a09 0909 6578 6365 7074 3a0d 0a09 0909  ....except:.....
-0005c310: 0970 7269 6e74 2822 7072 6f6a 6563 7420  .print("project 
-0005c320: 636f 6e76 6572 7465 6420 6962 7574 2063  converted ibut c
-0005c330: 6f75 6c64 206e 6f74 2062 6520 7361 7665  ould not be save
-0005c340: 6422 290d 0a09 0973 656c 662e 7061 7468  d")....self.path
-0005c350: 3d63 7572 7265 6e74 5f70 6174 680d 0a09  =current_path...
-0005c360: 0966 6f72 206b 6579 2069 6e20 5b27 7469  .for key in ['ti
-0005c370: 6d65 5f62 696e 272c 2772 656c 5f77 6176  me_bin','rel_wav
-0005c380: 6527 2c27 7265 6c5f 7469 6d65 272c 2773  e','rel_time','s
-0005c390: 6361 7474 6572 6375 7427 2c27 626f 7264  cattercut','bord
-0005c3a0: 6572 6375 7427 2c27 7469 6d65 6c69 6d69  ercut','timelimi
-0005c3b0: 7473 272c 2769 6e74 656e 7369 7479 5f72  ts','intensity_r
-0005c3c0: 616e 6765 272c 2777 6176 655f 6e6d 5f62  ange','wave_nm_b
-0005c3d0: 696e 272c 2777 6176 656c 656e 6774 685f  in','wavelength_
-0005c3e0: 6269 6e27 2c27 6967 6e6f 7265 5f74 696d  bin','ignore_tim
-0005c3f0: 655f 7265 6769 6f6e 275d 3a0d 0a09 0909  e_region']:.....
-0005c400: 7472 793a 0d0a 0909 0909 6966 2069 7369  try:......if isi
-0005c410: 6e73 7461 6e63 6528 7365 6c66 2e5f 5f64  nstance(self.__d
-0005c420: 6963 745f 5f5b 6b65 795d 2c62 7974 6573  ict__[key],bytes
-0005c430: 293a 0d0a 0909 0909 0923 7072 696e 7428  ):.......#print(
-0005c440: 6b65 7920 2b20 2720 7365 7420 746f 204e  key + ' set to N
-0005c450: 6f6e 6527 290d 0a09 0909 0909 7365 6c66  one').......self
-0005c460: 2e5f 5f64 6963 745f 5f5b 6b65 795d 3d4e  .__dict__[key]=N
-0005c470: 6f6e 650d 0a09 0909 0965 6c69 6620 6973  one......elif is
-0005c480: 696e 7374 616e 6365 2873 656c 662e 5f5f  instance(self.__
-0005c490: 6469 6374 5f5f 5b6b 6579 5d2c 7374 7229  dict__[key],str)
-0005c4a0: 3a0d 0a09 0909 0909 6966 2073 656c 662e  :.......if self.
-0005c4b0: 5f5f 6469 6374 5f5f 5b6b 6579 5d3d 3d27  __dict__[key]=='
-0005c4c0: 4e6f 6e65 273a 0d0a 0909 0909 0909 7365  None':........se
-0005c4d0: 6c66 2e5f 5f64 6963 745f 5f5b 6b65 795d  lf.__dict__[key]
-0005c4e0: 3d4e 6f6e 650d 0a09 0909 6578 6365 7074  =None.....except
-0005c4f0: 3a0d 0a09 0909 0963 6f6e 7469 6e75 650d  :......continue.
-0005c500: 0a09 0974 7279 3a0d 0a09 0909 7365 6c66  ...try:.....self
-0005c510: 2e66 6967 7572 655f 7061 7468 3d73 7472  .figure_path=str
-0005c520: 2873 656c 662e 6669 6775 7265 5f70 6174  (self.figure_pat
-0005c530: 6829 0d0a 0909 0969 6620 274e 6f6e 6527  h).....if 'None'
-0005c540: 2069 6e20 7365 6c66 2e66 6967 7572 655f   in self.figure_
-0005c550: 7061 7468 3a0d 0a09 0909 0973 656c 662e  path:......self.
-0005c560: 6669 6775 7265 5f70 6174 683d 4e6f 6e65  figure_path=None
-0005c570: 0d0a 0909 6578 6365 7074 3a0d 0a09 0909  ....except:.....
-0005c580: 7061 7373 0d0a 0d0a 0964 6566 2043 6f70  pass.....def Cop
-0005c590: 7928 7365 6c66 293a 0d0a 0909 2727 2772  y(self):....'''r
-0005c5a0: 6574 7572 6e73 2061 2064 6565 7020 636f  eturns a deep co
-0005c5b0: 7079 206f 6620 7468 6520 6f62 6a65 6374  py of the object
-0005c5c0: 2e0d 0a09 090d 0a09 0945 7861 6d70 6c65  .........Example
-0005c5d0: 730d 0a09 092d 2d2d 2d2d 2d2d 2d0d 0a09  s....--------...
-0005c5e0: 093e 3e3e 7461 3d70 6c6f 745f 6675 6e63  .>>>ta=plot_func
-0005c5f0: 2e54 4128 2774 6573 7466 696c 652e 6864  .TA('testfile.hd
-0005c600: 6635 2729 2023 6f70 656e 2061 2070 726f  f5') #open a pro
-0005c610: 6a65 6374 0d0a 0909 3e3e 3e74 6131 3d74  ject....>>>ta1=t
-0005c620: 612e 436f 7079 2829 2023 6d61 6b65 2061  a.Copy() #make a
-0005c630: 2063 6f70 7920 666f 7220 736f 6d65 2074   copy for some t
-0005c640: 6573 7473 206f 7220 6120 6469 6666 6572  ests or a differ
-0005c650: 6e65 7420 6669 740d 0a09 090d 0a09 0927  net fit........'
-0005c660: 2727 200d 0a09 0969 6d70 6f72 7420 636f  '' ....import co
-0005c670: 7079 0d0a 0909 7265 7475 726e 2063 6f70  py....return cop
-0005c680: 792e 6465 6570 636f 7079 2873 656c 6629  y.deepcopy(self)
-0005c690: 0d0a 0d0a 0d0a 0964 6566 2043 6f6d 7061  .......def Compa
-0005c6a0: 7265 5f61 745f 7469 6d65 2873 656c 662c  re_at_time(self,
-0005c6b0: 2072 656c 5f74 696d 6520 3d20 4e6f 6e65   rel_time = None
-0005c6c0: 2c20 6f74 6865 7220 3d20 4e6f 6e65 2c20  , other = None, 
-0005c6d0: 6669 7474 6564 203d 2046 616c 7365 2c20  fitted = False, 
-0005c6e0: 6e6f 726d 5f77 696e 646f 7720 3d20 4e6f  norm_window = No
-0005c6f0: 6e65 2c0d 0a09 0909 0909 0974 696d 655f  ne,........time_
-0005c700: 7769 6474 685f 7065 7263 656e 7420 3d20  width_percent = 
-0005c710: 4e6f 6e65 2c20 7370 6563 7472 6120 3d20  None, spectra = 
-0005c720: 4e6f 6e65 2c20 6461 7461 5f61 6e64 5f66  None, data_and_f
-0005c730: 6974 203d 2046 616c 7365 2c20 636d 6170  it = False, cmap
-0005c740: 203d 204e 6f6e 6520 2c20 0d0a 0909 0909   = None , ......
-0005c750: 0909 7072 696e 745f 636c 6963 6b5f 706f  ..print_click_po
-0005c760: 7369 7469 6f6e 203d 2046 616c 7365 2c20  sition = False, 
-0005c770: 6c69 6e65 7769 6474 6820 3d20 312c 2074  linewidth = 1, t
-0005c780: 6974 6c65 3d27 272c 2070 6c6f 745f 7365  itle='', plot_se
-0005c790: 636f 6e64 5f61 735f 656e 6572 6779 203d  cond_as_energy =
-0005c7a0: 2054 7275 6529 3a0d 0a09 0927 2727 5468   True):....'''Th
-0005c7b0: 6973 2066 756e 6374 696f 6e20 706c 6f74  is function plot
-0005c7c0: 7320 6d75 6c74 6970 6c65 2073 7065 6374  s multiple spect
-0005c7d0: 7261 2069 6e74 6f20 7468 6520 7361 6d65  ra into the same
-0005c7e0: 2066 6967 7572 6520 6174 2061 2067 6976   figure at a giv
-0005c7f0: 656e 2072 656c 5f74 696d 6520 2874 696d  en rel_time (tim
-0005c800: 6570 6f69 6e74 7329 2061 6e64 200d 0a09  epoints) and ...
-0005c810: 0961 6c6c 6f77 7320 666f 7220 6e6f 726d  .allows for norm
-0005c820: 616c 697a 6174 696f 6e2e 2056 6572 7920  alization. Very 
-0005c830: 7573 6566 756c 2074 6f20 636f 6d70 6172  useful to compar
-0005c840: 6520 7468 6520 7370 6563 7472 6120 666f  e the spectra fo
-0005c850: 7220 6469 6666 6572 656e 7420 736f 6c76  r different solv
-0005c860: 656e 7473 206f 7220 7175 656e 6368 6572  ents or quencher
-0005c870: 732c 206f 720d 0a09 0965 2e67 2e20 6469  s, or....e.g. di
-0005c880: 6666 6572 656e 7420 6669 7473 2e20 5468  fferent fits. Th
-0005c890: 6520 7461 2e74 696d 655f 7769 6474 685f  e ta.time_width_
-0005c8a0: 7065 7263 656e 7420 7061 7261 6d65 7465  percent paramete
-0005c8b0: 7220 6465 6669 6e65 7320 6966 2074 6869  r defines if thi
-0005c8c0: 7320 6973 2061 0d0a 0909 7369 6e67 6c65  s is a....single
-0005c8d0: 2074 696d 6520 2869 6620 7469 6d65 5f77   time (if time_w
-0005c8e0: 6964 7468 5f70 6572 6365 6e74 203d 2030  idth_percent = 0
-0005c8f0: 2920 6f72 2061 6e20 696e 7465 6772 6174  ) or an integrat
-0005c900: 6564 2077 696e 646f 772e 0d0a 0909 4f6e  ed window.....On
-0005c910: 6c79 2022 7265 6c5f 7469 6d65 2220 6973  ly "rel_time" is
-0005c920: 2061 206d 616e 6461 746f 7279 2c20 7468   a mandatory, th
-0005c930: 6520 7265 7374 2063 616e 2062 6520 7461  e rest can be ta
-0005c940: 6b65 6e20 6672 6f6d 2074 6865 206f 7269  ken from the ori
-0005c950: 6769 6e61 6c20 7072 6f6a 6563 7420 2874  ginal project (t
-0005c960: 6129 2e0d 0a09 090d 0a09 0954 6865 206e  a).........The n
-0005c970: 6f72 6d61 6c69 7a61 7469 6f6e 2069 7320  ormalization is 
-0005c980: 7265 616c 697a 6564 2062 7920 6769 7669  realized by givi
-0005c990: 6e67 2061 206e 6f72 6d5f 7769 6e64 6f77  ng a norm_window
-0005c9a0: 200d 0a09 0961 7420 7768 6963 6820 7468   ....at which th
-0005c9b0: 6520 696e 7465 6e73 6974 7920 696e 2074  e intensity in t
-0005c9c0: 6865 2074 7269 6767 6572 696e 6720 6f62  he triggering ob
-0005c9d0: 6a65 6374 2069 7320 696e 7465 6772 6174  ject is integrat
-0005c9e0: 6564 2028 696e 2074 612e 436f 6d70 6172  ed (in ta.Compar
-0005c9f0: 655f 6174 5f74 696d 6528 6f74 6865 722e  e_at_time(other.
-0005ca00: 2e29 200d 0a09 0922 7461 2220 6973 2074  .) ...."ta" is t
-0005ca10: 6865 2074 7269 6767 6572 696e 6720 6f62  he triggering ob
-0005ca20: 6a65 6374 2e20 5468 6520 696e 2065 6163  ject. The in eac
-0005ca30: 6820 6f66 2074 6865 206f 7468 6572 2063  h of the other c
-0005ca40: 7572 7665 7320 7468 6520 7361 6d65 2077  urves the same w
-0005ca50: 696e 646f 7720 6973 0d0a 0909 696e 7465  indow is....inte
-0005ca60: 6772 6174 6564 2061 6e64 2074 6865 2063  grated and the c
-0005ca70: 7572 7665 2073 6361 6c65 6420 6279 2074  urve scaled by t
-0005ca80: 6869 7320 7661 6c75 652e 2049 6d70 6f72  his value. Impor
-0005ca90: 7461 6e74 2074 6f20 6e6f 7465 2069 7320  tant to note is 
-0005caa0: 7468 6174 2074 6869 7320 7769 6e64 6f77  that this window
-0005cab0: 0d0a 0909 646f 6573 206e 6f74 206e 6565  ....does not nee
-0005cac0: 6420 746f 2062 6520 696e 2074 6865 2070  d to be in the p
-0005cad0: 6c6f 742e 2065 2e67 2e20 7468 6520 6e6f  lot. e.g. the no
-0005cae0: 726d 616c 697a 6174 696f 6e20 6361 6e20  rmalization can 
-0005caf0: 6265 2064 6f6e 6520 6174 2061 2064 6966  be done at a dif
-0005cb00: 6665 7265 6e74 2074 696d 652e 0d0a 0909  ferent time.....
-0005cb10: 0d0a 0909 5665 7279 206f 6674 656e 206f  ....Very often o
-0005cb20: 6e65 2077 6f75 6c64 206c 696b 6520 746f  ne would like to
-0005cb30: 2063 6f6d 7061 7265 2074 6865 206d 6561   compare the mea
-0005cb40: 7375 7265 6420 7370 6563 7472 6120 6174  sured spectra at
-0005cb50: 2061 2063 6572 7461 696e 0d0a 0909 7469   a certain....ti
-0005cb60: 6d65 2074 6f20 616e 2065 7874 6572 6e61  me to an externa
-0005cb70: 6c20 7370 6563 7472 756d 2028 652e 672e  l spectrum (e.g.
-0005cb80: 2073 7065 6374 726f 2d65 6c65 6374 726f   spectro-electro
-0005cb90: 2d63 6865 6d69 7374 7279 206f 7220 7374  -chemistry or st
-0005cba0: 6561 6479 0d0a 0909 7374 6174 6520 6162  eady....state ab
-0005cbb0: 736f 7270 7469 6f6e 292e 2054 6869 7320  sorption). This 
-0005cbc0: 6361 6e20 6265 2064 6f6e 6520 6279 206c  can be done by l
-0005cbd0: 6f61 6469 6e67 2061 2073 7065 6369 6669  oading a specifi
-0005cbe0: 6320 7370 6563 7472 756d 2069 6e74 6f0d  c spectrum into.
-0005cbf0: 0a09 0961 2044 6174 6146 7261 6d65 2061  ...a DataFrame a
-0005cc00: 6e64 2068 616e 6469 6e67 2074 6869 7320  nd handing this 
-0005cc10: 6461 7461 2046 7261 6d65 2074 6f20 7468  data Frame to th
-0005cc20: 6520 636f 6d70 6172 6973 696f 6e20 6675  e comparision fu
-0005cc30: 6e63 7469 6f6e 2e20 5468 650d 0a09 0966  nction. The....f
-0005cc40: 756e 6374 696f 6e20 6361 6e20 616c 736f  unction can also
-0005cc50: 2062 6520 7573 6564 2074 6f20 706c 6f74   be used to plot
-0005cc60: 2065 2e67 2e20 7468 6520 6d65 6173 7572   e.g. the measur
-0005cc70: 6564 2073 7065 6374 7261 2076 732e 2061  ed spectra vs. a
-0005cc80: 6e0d 0a09 0965 7874 6572 6e61 6c20 7370  n....external sp
-0005cc90: 6563 7472 756d 2077 6974 686f 7574 2067  ectrum without g
-0005cca0: 6976 696e 6720 616e 7920 226f 7468 6572  iving any "other
-0005ccb0: 2220 5072 6f6a 6563 7473 2e20 2876 6572  " Projects. (ver
-0005ccc0: 7920 7573 6566 756c 2066 6f72 0d0a 0909  y useful for....
-0005ccd0: 636f 6d70 6172 6973 696f 6e73 292e 0d0a  comparisions)...
-0005cce0: 0909 200d 0a09 0950 6172 616d 6574 6572  .. ....Parameter
-0005ccf0: 730d 0a09 092d 2d2d 2d2d 2d2d 2d2d 2d2d  s....-----------
-0005cd00: 2d2d 0d0a 0909 0d0a 0909 7265 6c5f 7469  --........rel_ti
-0005cd10: 6d65 203a 2066 6c6f 6174 206f 7220 6c69  me : float or li
-0005cd20: 7374 2f76 6563 746f 7220 286f 6620 666c  st/vector (of fl
-0005cd30: 6f61 7473 290d 0a09 0909 5370 6563 6966  oats).....Specif
-0005cd40: 7920 7468 6520 7469 6d65 7320 7768 6572  y the times wher
-0005cd50: 6520 746f 2070 6c6f 742c 2073 696e 676c  e to plot, singl
-0005cd60: 6520 7661 6c75 6520 6f72 206c 6973 742f  e value or list/
-0005cd70: 7665 6374 6f72 206f 6620 7661 6c75 6573  vector of values
-0005cd80: 2e20 0d0a 0909 0946 6f72 2065 6163 6820  . .....For each 
-0005cd90: 656e 7472 7920 696e 2072 656c 5f74 696d  entry in rel_tim
-0005cda0: 6520 6120 7370 6563 7472 756d 2069 7320  e a spectrum is 
-0005cdb0: 706c 6f74 7465 642e 200d 0a09 0909 4966  plotted. .....If
-0005cdc0: 2074 696d 655f 7769 6474 685f 7065 7263   time_width_perc
-0005cdd0: 656e 743d 3020 2844 6566 6175 6c74 2920  ent=0 (Default) 
-0005cde0: 7468 6520 6e65 6172 6573 7420 6d65 6173  the nearest meas
-0005cdf0: 7572 6564 200d 0a09 0909 7469 6d65 706f  ured .....timepo
-0005ce00: 696e 7420 6973 2063 686f 7365 6e2e 2046  int is chosen. F
-0005ce10: 6f72 206f 7468 6572 2076 616c 7565 7320  or other values 
-0005ce20: 7365 6520 7061 7261 6d65 7465 7220 2274  see parameter "t
-0005ce30: 696d 655f 7769 6474 685f 7065 7263 656e  ime_width_percen
-0005ce40: 7422 2e0d 0a09 0909 0d0a 0909 6f74 6865  t"..........othe
-0005ce50: 7220 3a20 5441 206f 626a 6563 7420 6f72  r : TA object or
-0005ce60: 206c 6973 7420 6f66 2074 686f 7365 2c20   list of those, 
-0005ce70: 6f70 7469 6f6e 616c 200d 0a09 0909 7368  optional .....sh
-0005ce80: 6f75 6c64 2062 6520 7461 2e70 6c6f 745f  ould be ta.plot_
-0005ce90: 6675 6e63 206f 626a 6563 7473 2028 6c6f  func objects (lo
-0005cea0: 6164 6564 206f 7220 636f 7069 6564 2920  aded or copied) 
-0005ceb0: 616e 6420 6973 2077 6861 7420 0d0a 0909  and is what ....
-0005cec0: 0969 7320 706c 6f74 7465 6420 6167 6169  .is plotted agai
-0005ced0: 6e73 7420 7468 6520 6461 7461 2075 7365  nst the data use
-0005cee0: 2061 206c 6973 7420 5b74 6131 2c74 6132   a list [ta1,ta2
-0005cef0: 2c2e 2e2e 205d 206f 7220 6765 6e65 7261  ,... ] or genera
-0005cf00: 7465 2074 6869 730d 0a09 0909 6c69 7374  te this.....list
-0005cf10: 2075 7369 6e67 2074 6865 2047 7569 2066   using the Gui f
-0005cf20: 756e 6374 696f 6e2e 2053 6565 2073 6563  unction. See sec
-0005cf30: 7469 6f6e 203a 7265 663a 604f 7065 6e69  tion :ref:`Openi
-0005cf40: 6e67 206d 756c 7469 706c 6520 6669 6c65  ng multiple file
-0005cf50: 7360 2069 6e20 0d0a 0909 0974 6865 2064  s` in .....the d
-0005cf60: 6f63 756d 656e 7461 7469 6f6e 0d0a 0909  ocumentation....
-0005cf70: 0d0a 0909 6669 7474 6564 203a 2062 6f6f  ....fitted : boo
-0005cf80: 6c2c 206f 7074 696f 6e61 6c0d 0a09 0909  l, optional.....
-0005cf90: 5472 7565 2f46 616c 7365 2028 4465 6661  True/False (Defa
-0005cfa0: 756c 7429 202d 2075 7365 2066 6974 7465  ult) - use fitte
-0005cfb0: 6420 6461 7461 2069 6e73 7465 6164 206f  d data instead o
-0005cfc0: 6620 7261 7720 6461 7461 2e20 0d0a 0909  f raw data. ....
-0005cfd0: 0949 6620 5472 7565 2c20 7468 6520 6669  .If True, the fi
-0005cfe0: 7474 6564 2064 6174 6170 6f69 6e74 7320  tted datapoints 
-0005cff0: 2877 6974 686f 7574 2069 6e74 6572 706f  (without interpo
-0005d000: 6c61 7469 6f6e 2920 6172 6520 7573 6564  lation) are used
-0005d010: 2e20 0d0a 0909 0954 6869 7320 6973 2069  . .....This is i
-0005d020: 6e74 656e 6465 6420 666f 7220 636f 6d70  ntended for comp
-0005d030: 6172 696e 6720 652e 672e 2064 6966 6665  aring e.g. diffe
-0005d040: 7265 6e74 2066 6974 730d 0a09 090d 0a09  rent fits.......
-0005d050: 096e 6f72 6d5f 7769 6e64 6f77 203a 204e  .norm_window : N
-0005d060: 6f6e 6520 6f72 206c 6973 742f 7665 6374  one or list/vect
-0005d070: 6f72 2028 7769 7468 2034 2066 6c6f 6174  or (with 4 float
-0005d080: 7329 2c20 6f70 7469 6f6e 616c 0d0a 0909  s), optional....
-0005d090: 096e 6f72 6d5f 7769 6e64 6f77 2047 6976  .norm_window Giv
-0005d0a0: 6520 6120 6c69 7374 2f74 7570 656c 2f76  e a list/tupel/v
-0005d0b0: 6563 746f 7220 7769 7468 2034 2065 6e74  ector with 4 ent
-0005d0c0: 7269 6573 2069 6e20 7468 6520 6f72 6465  ries in the orde
-0005d0d0: 7220 0d0a 0909 095b 5374 6172 7420 2d20  r .....[Start - 
-0005d0e0: 7469 6d65 2c20 456e 6420 2d20 7469 6d65  time, End - time
-0005d0f0: 2c20 5374 6172 7420 2d20 7761 7665 6c65  , Start - wavele
-0005d100: 6e67 7468 2c20 456e 6420 2d20 5761 7665  ngth, End - Wave
-0005d110: 6c65 6e67 7468 5d2c 200d 0a09 0909 7365  length], .....se
-0005d120: 6520 7365 6374 696f 6e20 203a 7265 663a  e section  :ref:
-0005d130: 604e 6f72 6d61 6c69 7a61 7469 6f6e 2061  `Normalization a
-0005d140: 6e64 2053 6361 6c69 6e67 6020 2069 6e20  nd Scaling`  in 
-0005d150: 7468 6520 646f 6375 6d65 6e74 6174 696f  the documentatio
-0005d160: 6e2e 0d0a 0909 0949 6620 4e6f 6e65 2028  n......If None (
-0005d170: 4465 6661 756c 7429 206e 6f20 6e6f 726d  Default) no norm
-0005d180: 616c 697a 6174 696f 6e20 6973 2064 6f6e  alization is don
-0005d190: 652e 0d0a 0909 0d0a 0909 6c69 6e65 7769  e.........linewi
-0005d1a0: 6474 6820 3a20 666c 6f61 742c 206f 7074  dth : float, opt
-0005d1b0: 696f 6e61 6c0d 0a09 0909 6c69 6e65 7769  ional.....linewi
-0005d1c0: 6474 6820 746f 2062 6520 7573 6564 2066  dth to be used f
-0005d1d0: 6f72 2070 6c6f 7474 696e 6709 090d 0a09  or plotting.....
-0005d1e0: 090d 0a09 0974 696d 655f 7769 6474 685f  .....time_width_
-0005d1f0: 7065 7263 656e 7420 3a20 4e6f 6e65 206f  percent : None o
-0005d200: 7220 666c 6f61 742c 206f 7074 696f 6e61  r float, optiona
-0005d210: 6c0d 0a09 0909 2272 656c 5f74 696d 6522  l....."rel_time"
-0005d220: 2061 6e64 2022 7469 6d65 5f77 6964 7468   and "time_width
-0005d230: 5f70 6572 6365 6e74 2220 776f 726b 2074  _percent" work t
-0005d240: 6f67 6574 6865 7220 666f 7220 6372 6561  ogether for crea
-0005d250: 7469 6e67 2073 7065 6374 7261 6c20 706c  ting spectral pl
-0005d260: 6f74 7320 6174 200d 0a09 0909 7370 6563  ots at .....spec
-0005d270: 6966 6963 2074 696d 6570 6f69 6e74 732e  ific timepoints.
-0005d280: 2046 6f72 2065 6163 6820 656e 7472 7920   For each entry 
-0005d290: 696e 2072 656c 5f74 696d 6520 6120 7370  in rel_time a sp
-0005d2a0: 6563 7472 756d 2069 7320 706c 6f74 7465  ectrum is plotte
-0005d2b0: 642e 200d 0a09 0909 4966 2068 6f77 6576  d. .....If howev
-0005d2c0: 6572 2065 2e67 2e20 7469 6d65 5f77 6964  er e.g. time_wid
-0005d2d0: 7468 5f70 6572 6365 6e74 3d31 3020 7468  th_percent=10 th
-0005d2e0: 6520 7265 6769 6f6e 2062 6574 7765 656e  e region between
-0005d2f0: 2074 6865 2074 696d 6570 6f69 6e74 2063   the timepoint c
-0005d300: 6c6f 7365 7374 200d 0a09 0909 746f 203a  losest .....to :
-0005d310: 6d61 7468 3a60 7469 6d65 706f 696e 742b  math:`timepoint+
-0005d320: 302e 3178 7469 6d65 706f 696e 74c2 b420  0.1xtimepoint.. 
-0005d330: 616e 6420 3a6d 6174 683a 6074 696d 6570  and :math:`timep
-0005d340: 6f69 6e74 2d30 2e31 7874 696d 6570 6f69  oint-0.1xtimepoi
-0005d350: 6e74 6020 6973 2061 7665 7261 6765 6420  nt` is averaged 
-0005d360: 616e 6420 7368 6f77 6e20 0d0a 0909 0928  and shown .....(
-0005d370: 616e 6420 7468 6520 6c65 6765 6e64 2061  and the legend a
-0005d380: 646a 7573 7465 6420 6163 636f 7264 696e  djusted accordin
-0005d390: 676c 7929 2e20 4966 204e 6f6e 6520 2844  gly). If None (D
-0005d3a0: 6566 6175 6c74 2920 6973 2067 6976 656e  efault) is given
-0005d3b0: 2c20 7468 6520 7661 6c75 6520 6973 200d  , the value is .
-0005d3c0: 0a09 0909 7461 6b65 6e20 6672 6f6d 2074  ....taken from t
-0005d3d0: 6865 2074 7269 6767 6572 696e 6720 6f62  he triggering ob
-0005d3e0: 6a65 6374 2028 7365 6c66 2e74 696d 655f  ject (self.time_
-0005d3f0: 7769 6474 685f 7065 7263 656e 7429 2054  width_percent) T
-0005d400: 6869 7320 6973 2070 6172 7469 6375 6c61  his is particula
-0005d410: 726c 7920 7573 6566 756c 2066 6f72 2074  rly useful for t
-0005d420: 6865 2064 656e 736c 790d 0a09 0909 7361  he densly.....sa
-0005d430: 6d70 6c65 6420 7265 6769 6f6e 2063 6c6f  mpled region clo
-0005d440: 7365 2074 6f20 743d 302e 2054 7970 6963  se to t=0. Typic
-0005d450: 616c 6c79 2066 6f72 2061 206c 6f67 6172  ally for a logar
-0005d460: 6974 686d 6963 2072 6563 6f72 6465 6420  ithmic recorded 
-0005d470: 6b69 6e65 7469 6373 2c20 7468 6520 0d0a  kinetics, the ..
-0005d480: 0909 0974 696d 6570 6f69 6e74 7320 6174  ...timepoints at
-0005d490: 206c 6174 6572 2074 696d 6573 2077 696c   later times wil
-0005d4a0: 6c20 6265 2066 7572 7468 6572 2061 7070  l be further app
-0005d4b0: 6172 7420 7468 616e 2031 3020 7065 7263  art than 10 perc
-0005d4c0: 656e 7420 6f66 2074 6865 2076 616c 7565  ent of the value
-0005d4d0: 2c20 0d0a 0909 0962 7574 2074 6869 7320  , .....but this 
-0005d4e0: 616c 6c6f 7773 2074 6f20 656c 6567 616e  allows to elegan
-0005d4f0: 746c 7920 636f 6d62 696e 6520 7661 6c75  tly combine valu
-0005d500: 6573 2061 726f 756e 6420 7469 6d65 3d30  es around time=0
-0005d510: 2066 6f72 2062 6574 7465 7220 7374 6174   for better stat
-0005d520: 6973 7469 6373 2e20 0d0a 0909 0954 6869  istics. .....Thi
-0005d530: 7320 6176 6572 6167 696e 6720 6973 206f  s averaging is o
-0005d540: 6e6c 7920 6170 706c 6965 6420 666f 7220  nly applied for 
-0005d550: 7468 6520 706c 6f74 7469 6e67 2066 756e  the plotting fun
-0005d560: 6374 696f 6e20 616e 6420 6e6f 7420 666f  ction and not fo
-0005d570: 7220 7468 6520 6669 7473 2e0d 0a09 090d  r the fits......
-0005d580: 0a09 0973 7065 6374 7261 203a 204e 6f6e  ...spectra : Non
-0005d590: 6520 6f72 2044 6174 6146 7261 6d65 2c20  e or DataFrame, 
-0005d5a0: 6f70 7469 6f6e 616c 0d0a 0909 0949 6620  optional.....If 
-0005d5b0: 616e 2044 6174 6146 7261 6d65 2077 6974  an DataFrame wit
-0005d5c0: 6820 7468 6520 7761 7665 6c65 6e67 7468  h the wavelength
-0005d5d0: 2061 7320 696e 6465 7820 6973 2070 726f   as index is pro
-0005d5e0: 7669 6465 642c 2054 6865 6e20 7468 6520  vided, Then the 
-0005d5f0: 7370 6563 7472 6120 6f66 2065 6163 6820  spectra of each 
-0005d600: 636f 6c75 6d6e 0d0a 0909 0969 7320 706c  column.....is pl
-0005d610: 6f74 7465 6420 696e 746f 2074 6865 2064  otted into the d
-0005d620: 6966 6665 7265 6e74 6961 6c20 7370 6563  ifferential spec
-0005d630: 7472 6120 312d 3120 616e 6420 7468 6520  tra 1-1 and the 
-0005d640: 636f 6c75 6d6e 206e 616d 6573 2061 7265  column names are
-0005d650: 2075 7365 6420 696e 2074 6865 206c 6567   used in the leg
-0005d660: 656e 640d 0a09 0909 5072 696f 7220 7363  end.....Prior sc
-0005d670: 616c 696e 6720 6973 2068 6967 686c 7920  aling is highly 
-0005d680: 7375 6767 6573 7465 642e 2054 6865 7365  suggested. These
-0005d690: 2073 7065 6374 7261 2061 7265 206e 6f74   spectra are not
-0005d6a0: 2028 696e 2067 656e 6572 616c 2920 7363   (in general) sc
-0005d6b0: 616c 6564 2077 6974 6820 7468 6520 0d0a  aled with the ..
-0005d6c0: 0909 096e 6f72 6d20 7769 6e64 6f77 2e20  ...norm window. 
-0005d6d0: 2873 6565 2065 7861 6d70 6c65 7329 2e0d  (see examples)..
-0005d6e0: 0a09 090d 0a09 0964 6174 615f 616e 645f  .......data_and_
-0005d6f0: 6669 7420 3a20 626f 6f6c 2c20 6f70 7469  fit : bool, opti
-0005d700: 6f6e 616c 0d0a 0909 0954 7275 6520 6f72  onal.....True or
-0005d710: 2046 616c 7365 2028 4465 6661 756c 7429   False (Default)
-0005d720: 2c20 6368 6f6f 7365 2069 6620 666f 7220  , choose if for 
-0005d730: 7468 6520 4669 7474 6564 2070 6c6f 7420  the Fitted plot 
-0005d740: 7468 6520 7261 7720 6461 7461 206f 6620  the raw data of 
-0005d750: 7468 6520 0d0a 0909 096f 7468 6572 2070  the .....other p
-0005d760: 726f 6a65 6374 7320 6973 2074 6f20 6265  rojects is to be
-0005d770: 2070 6c6f 7474 696e 6720 696e 2061 6464   plotting in add
-0005d780: 6974 696f 6e20 746f 2074 6865 2066 6974  ition to the fit
-0005d790: 7465 6420 6c69 6e65 2e20 466f 7220 4661  ted line. For Fa
-0005d7a0: 6c73 6520 2844 6566 6175 6c74 290d 0a09  lse (Default)...
-0005d7b0: 0909 4f6e 6c79 2074 6865 2066 6974 2069  ..Only the fit i
-0005d7c0: 7320 706c 6f74 7465 642e 200d 0a09 090d  s plotted. .....
-0005d7d0: 0a09 0963 6d61 7020 3a20 4e6f 6e65 206f  ...cmap : None o
-0005d7e0: 7220 6d61 7470 6c6f 746c 6962 2063 6f6c  r matplotlib col
-0005d7f0: 6f72 206d 6170 2c20 6f70 7469 6f6e 616c  or map, optional
-0005d800: 0d0a 0909 0969 7320 6120 706f 7765 7266  .....is a powerf
-0005d810: 756c 6c20 7661 7269 6162 6c65 2074 6861  ull variable tha
-0005d820: 7420 6368 6f6f 7365 7320 7468 6520 636f  t chooses the co
-0005d830: 6c6f 7572 206d 6170 2061 7070 6c69 6564  lour map applied
-0005d840: 2066 6f72 2061 6c6c 2070 6c6f 7473 2e20   for all plots. 
-0005d850: 4966 2073 6574 2074 6f20 0d0a 0909 094e  If set to .....N
-0005d860: 6f6e 6520 2844 6566 6175 6c74 2920 7468  one (Default) th
-0005d870: 656e 2074 6865 2073 656c 662e 636d 6170  en the self.cmap
-0005d880: 2069 7320 7573 6564 2e0d 0a09 0909 4173   is used......As
-0005d890: 2073 7461 6e64 6172 6420 4920 7573 6520   standard I use 
-0005d8a0: 7468 6520 636f 6c6f 7220 6d61 7020 226a  the color map "j
-0005d8b0: 6574 2220 6672 6f6d 206d 6174 706c 6f74  et" from matplot
-0005d8c0: 6c69 622e 2054 6865 7265 2061 7265 2061  lib. There are a
-0005d8d0: 2076 6172 6965 7479 206f 6620 636f 6c6f   variety of colo
-0005d8e0: 726d 6170 7320 0d0a 0909 0961 7661 696c  rmaps .....avail
-0005d8f0: 6162 6c65 2074 6861 7420 6172 6520 7665  able that are ve
-0005d900: 7279 2075 7365 6675 6c6c 2e20 4265 7369  ry usefull. Besi
-0005d910: 6465 2022 6a65 7422 2c20 2276 6972 6964  de "jet", "virid
-0005d920: 6973 2220 6973 2061 2067 6f6f 6420 6368  is" is a good ch
-0005d930: 6f69 6365 2061 7320 6974 2069 7320 7765  oice as it is we
-0005d940: 6c6c 200d 0a09 0909 7669 7369 626c 6520  ll .....visible 
-0005d950: 756e 6465 7220 7265 642d 6772 6565 6e20  under red-green 
-0005d960: 626c 696e 646e 6573 732e 204f 7468 6572  blindness. Other
-0005d970: 2075 7365 6675 6c20 6d61 7073 2061 7265   useful maps are
-0005d980: 2022 7072 6973 6d22 2066 6f72 2068 6967   "prism" for hig
-0005d990: 6820 666c 7563 7475 6174 696f 6e73 200d  h fluctuations .
-0005d9a0: 0a09 0909 6f72 2064 6976 6572 6769 6e67  ....or diverging
-0005d9b0: 2063 6f6c 6f72 206d 6170 7320 6c69 6b65   color maps like
-0005d9c0: 2022 7365 6973 6d69 6322 2e20 0d0a 0909   "seismic". ....
-0005d9d0: 0953 6565 2068 7474 7073 3a2f 2f6d 6174  .See https://mat
-0005d9e0: 706c 6f74 6c69 622e 6f72 672f 332e 312e  plotlib.org/3.1.
-0005d9f0: 302f 7475 746f 7269 616c 732f 636f 6c6f  0/tutorials/colo
-0005da00: 7273 2f63 6f6c 6f72 6d61 7073 2e68 746d  rs/colormaps.htm
-0005da10: 6c20 666f 7220 6120 636f 6d70 7265 6865  l for a comprehe
-0005da20: 6e73 6976 6520 0d0a 0909 0973 656c 6563  nsive .....selec
-0005da30: 7469 6f6e 2e20 496e 2074 6865 2063 6f64  tion. In the cod
-0005da40: 6520 7468 6520 636f 6c6f 726d 6170 7320  e the colormaps 
-0005da50: 6172 6520 696d 706f 7274 6564 2073 6f20  are imported so 
-0005da60: 6966 2070 6c6f 745f 6675 6e63 2069 7320  if plot_func is 
-0005da70: 696d 706f 7274 6564 2061 7320 7066 2074  imported as pf t
-0005da80: 6865 6e20 0d0a 0909 0973 656c 662e 636d  hen .....self.cm
-0005da90: 6170 3d70 662e 636d 2e76 6972 6964 6973  ap=pf.cm.viridis
-0005daa0: 2073 6574 7320 7669 7269 6469 7320 6173   sets viridis as
-0005dab0: 2074 6865 206d 6170 2074 6f20 7573 652e   the map to use.
-0005dac0: 2049 6e74 6572 6e61 6c6c 7920 7468 6520   Internally the 
-0005dad0: 636f 6c6f 7273 2061 7265 2063 686f 7365  colors are chose
-0005dae0: 6e20 0d0a 0909 0977 6974 6820 7468 6520  n .....with the 
-0005daf0: 2263 6f6c 6d22 2066 756e 6374 696f 6e2e  "colm" function.
-0005db00: 2054 6865 2032 6420 706c 6f74 7320 7265   The 2d plots re
-0005db10: 7175 6972 6520 6120 636f 6e74 696e 756f  quire a continuo
-0005db20: 7573 2063 6f6c 6f72 206d 6170 2073 6f20  us color map so 
-0005db30: 6966 2073 6f6d 6574 6869 6e67 200d 0a09  if something ...
-0005db40: 0909 656c 7365 2069 7320 6769 7665 2032  ..else is give 2
-0005db50: 6420 706c 6f74 7320 6172 6520 7368 6f77  d plots are show
-0005db60: 6e20 6175 746f 6d61 7469 6361 6c6c 7920  n automatically 
-0005db70: 7769 7468 2022 6a65 7422 2e20 466f 7220  with "jet". For 
-0005db80: 616c 6c20 6f66 2074 6865 2031 6420 706c  all of the 1d pl
-0005db90: 6f74 7320 686f 7765 7665 7220 0d0a 0909  ots however ....
-0005dba0: 0949 2066 6972 7374 2073 656c 6563 7420  .I first select 
-0005dbb0: 6120 6e75 6d62 6572 206f 6620 636f 6c6f  a number of colo
-0005dbc0: 7273 2062 6566 6f72 6520 6561 6368 2070  rs before each p
-0005dbd0: 6c6f 742e 2049 6620 636d 6170 2069 7320  lot. If cmap is 
-0005dbe0: 6120 636f 6e74 696e 6f75 7320 6d61 7020  a continous map 
-0005dbf0: 7468 656e 2074 6865 7365 0d0a 0909 0961  then these.....a
-0005dc00: 7265 2073 616d 706c 6564 2065 7665 6e6c  re sampled evenl
-0005dc10: 7920 6f76 6572 2074 6865 2063 6f6c 6f75  y over the colou
-0005dc20: 726d 6170 2e20 4d61 6e75 616c 2069 7465  rmap. Manual ite
-0005dc30: 7261 626c 6573 206f 6620 636f 6c6f 7572  rables of colour
-0005dc40: 7320 0d0a 0909 0963 6d61 703d 5b28 312c  s .....cmap=[(1,
-0005dc50: 302c 3029 2c28 302c 312c 3029 2c28 302c  0,0),(0,1,0),(0,
-0005dc60: 302c 3129 2c2e 2e2e 5d20 6172 6520 616c  0,1),...] are al
-0005dc70: 736f 2061 6363 6570 7465 642c 2061 7320  so accepted, as 
-0005dc80: 6172 6520 7665 6374 6f72 7320 6f72 2064  are vectors or d
-0005dc90: 6174 6166 7261 6d65 7320 7468 6174 200d  ataframes that .
-0005dca0: 0a09 0909 636f 6e74 6169 6e20 6173 2072  ....contain as r
-0005dcb0: 6f77 7320 7468 6520 636f 6c6f 7273 2e20  ows the colors. 
-0005dcc0: 5468 6572 6520 6d75 7374 2062 6520 6f66  There must be of
-0005dcd0: 2063 6f75 7273 6520 7375 6666 6963 6965   course sufficie
-0005dce0: 6e74 2063 6f6c 6f72 7320 7072 6573 656e  nt colors presen
-0005dcf0: 7420 666f 7220 0d0a 0909 0974 6865 206e  t for .....the n
-0005dd00: 756d 6265 7273 206f 6620 6c69 6e65 7320  umbers of lines 
-0005dd10: 7468 6174 2077 696c 6c20 6265 2070 6c6f  that will be plo
-0005dd20: 7474 6564 2e20 536f 2049 2072 6563 6f6d  tted. So I recom
-0005dd30: 6d65 6e64 2074 6f20 7072 6f76 6964 6520  mend to provide 
-0005dd40: 6174 206c 6561 7374 2031 3020 636f 6c6f  at least 10 colo
-0005dd50: 7572 7320 0d0a 0909 0928 652e 672e 7e79  urs .....(e.g.~y
-0005dd60: 6f75 7220 756e 6976 6572 7369 7479 2063  our university c
-0005dd70: 6f6c 6f72 7329 2e20 636f 6c6f 7572 7320  olors). colours 
-0005dd80: 6172 6520 616c 7761 7973 2067 6976 656e  are always given
-0005dd90: 2061 7320 612c 206c 6973 7420 6f72 2074   as a, list or t
-0005dda0: 7570 6c65 2077 6974 6820 5247 4120 6f72  uple with RGA or
-0005ddb0: 2052 4742 410d 0a09 0909 2877 6974 6820   RGBA.....(with 
-0005ddc0: 7468 6520 6c61 7374 2041 2062 6565 696e  the last A beein
-0005ddd0: 6720 7468 6520 416c 7068 613d 7472 616e  g the Alpha=tran
-0005dde0: 7370 6172 656e 6379 2e20 416c 6c20 6e75  sparency. All nu
-0005ddf0: 6d62 6572 7320 6172 6520 6265 7477 6565  mbers are betwee
-0005de00: 6e20 3020 616e 6420 312e 200d 0a09 0909  n 0 and 1. .....
-0005de10: 4966 2061 206c 6973 742f 7665 6374 6f72  If a list/vector
-0005de20: 2f44 6174 6146 7261 6d65 2069 7320 6769  /DataFrame is gi
-0005de30: 7665 6e20 666f 7220 7468 6520 636f 6c6f  ven for the colo
-0005de40: 7572 7320 7468 6579 2077 696c 6c20 6265  urs they will be
-0005de50: 2075 7365 6420 696e 2074 6865 206f 7264   used in the ord
-0005de60: 6572 2070 726f 7669 6465 642e 0d0a 0909  er provided.....
-0005de70: 706c 6f74 5f73 6563 6f6e 645f 6173 5f65  plot_second_as_e
-0005de80: 6e65 7267 7920 3a20 626f 6f6c 2c20 6f70  nergy : bool, op
-0005de90: 7469 6f6e 616c 0d0a 0909 0946 6f72 2028  tional.....For (
-0005dea0: 4465 6661 756c 7429 2054 7275 6520 6120  Default) True a 
-0005deb0: 7365 636f 6e64 2078 2d61 7869 7320 6973  second x-axis is
-0005dec0: 2070 6c6f 7474 6564 2020 7769 7468 2022   plotted  with "
-0005ded0: 6556 2220 6173 2075 6e69 740d 0a0d 0a09  eV" as unit.....
-0005dee0: 0970 7269 6e74 5f63 6c69 636b 5f70 6f73  .print_click_pos
-0005def0: 6974 696f 6e20 3a20 626f 6f6c 2c20 6f70  ition : bool, op
-0005df00: 7469 6f6e 616c 0d0a 0909 0969 6620 5472  tional.....if Tr
-0005df10: 7565 2074 6865 6e20 7468 6520 636c 6963  ue then the clic
-0005df20: 6b20 706f 7369 7469 6f6e 2069 7320 7072  k position is pr
-0005df30: 696e 7465 6420 666f 7220 7468 6520 7370  inted for the sp
-0005df40: 6563 7472 616c 2070 6c6f 7473 200d 0a0d  ectral plots ...
-0005df50: 0a09 0945 7861 6d70 6c65 730d 0a09 092d  ...Examples....-
-0005df60: 2d2d 2d2d 2d2d 2d2d 2d0d 0a09 090d 0a09  ---------.......
-0005df70: 093e 3e3e 2069 6d70 6f72 7420 706c 6f74  .>>> import plot
-0005df80: 5f66 756e 6320 6173 2070 660d 0a09 093e  _func as pf....>
-0005df90: 3e3e 2074 6120 3d20 7066 2e54 4128 2274  >> ta = pf.TA("t
-0005dfa0: 6573 7431 2e68 6466 3522 2920 236f 7065  est1.hdf5") #ope
-0005dfb0: 6e20 7468 6520 6f72 6967 696e 616c 2070  n the original p
-0005dfc0: 726f 6a65 6374 0d0a 0909 0d0a 0909 4e6f  roject........No
-0005dfd0: 7720 6f70 656e 2061 2062 756e 6368 206f  w open a bunch o
-0005dfe0: 6620 6f74 6865 7220 706f 726a 6563 7473  f other porjects
-0005dff0: 2074 6f20 636f 6d61 7265 2061 6761 696e   to comare again
-0005e000: 7374 0d0a 0909 0d0a 0909 3e3e 3e20 6f74  st........>>> ot
-0005e010: 6865 725f 7072 6f6a 6563 7473 203d 2070  her_projects = p
-0005e020: 662e 4755 495f 6f70 656e 2870 726f 6a65  f.GUI_open(proje
-0005e030: 6374 5f6c 6973 7420 3d20 5b22 6669 6c65  ct_list = ["file
-0005e040: 312e 5349 4122 2c20 2266 696c 6532 2e53  1.SIA", "file2.S
-0005e050: 4941 225d 290d 0a09 090d 0a09 0954 7970  IA"])........Typ
-0005e060: 6963 616c 2075 7365 2069 7320 636f 6d70  ical use is comp
-0005e070: 6172 6520 7468 6520 7261 7720 6461 7461  are the raw data
-0005e080: 2077 6974 686f 7574 206e 6f72 6d61 6c69   without normali
-0005e090: 7a61 7469 6f6e 2061 7420 3170 7320 616e  zation at 1ps an
-0005e0a0: 6420 3670 732e 0d0a 0909 0d0a 0909 3e3e  d 6ps.........>>
-0005e0b0: 3e20 7461 2e43 6f6d 7061 7265 5f61 745f  > ta.Compare_at_
-0005e0c0: 7469 6d65 2872 656c 5f74 696d 6520 3d20  time(rel_time = 
-0005e0d0: 5b31 2c36 5d2c 206f 7468 6572 7320 3d20  [1,6], others = 
-0005e0e0: 6f74 6865 725f 7072 6f6a 6563 7429 0d0a  other_project)..
-0005e0f0: 0909 0d0a 0909 436f 6d70 6172 6520 7468  ......Compare th
-0005e100: 6520 6669 7420 7769 7468 7075 7420 6e6f  e fit withput no
-0005e110: 726d 616c 697a 6174 696f 6e20 6174 2031  rmalization at 1
-0005e120: 7073 2061 6e64 2036 7073 2e0d 0a09 090d  ps and 6ps......
-0005e130: 0a09 093e 3e3e 2074 612e 436f 6d70 6172  ...>>> ta.Compar
-0005e140: 655f 6174 5f74 696d 6528 7265 6c5f 7469  e_at_time(rel_ti
-0005e150: 6d65 203d 205b 312c 365d 2c20 6f74 6865  me = [1,6], othe
-0005e160: 7273 203d 206f 7468 6572 5f70 726f 6a65  rs = other_proje
-0005e170: 6374 2c20 6669 7474 6564 203d 2054 7275  ct, fitted = Tru
-0005e180: 6529 0d0a 0909 0d0a 0909 436f 6d70 6172  e)........Compar
-0005e190: 6520 7769 7468 206e 6f72 6d61 6c69 7a61  e with normaliza
-0005e1a0: 7469 6f6e 2077 696e 646f 7720 6265 7477  tion window betw
-0005e1b0: 6565 6e20 3170 7320 616e 6420 3270 7320  een 1ps and 2ps 
-0005e1c0: 616e 6420 3430 306e 6d20 616e 6420 3435  and 400nm and 45
-0005e1d0: 306e 6d2e 0d0a 0909 0d0a 0909 3e3e 3e20  0nm.........>>> 
-0005e1e0: 6e6f 726d 5f77 696e 646f 773d 5b31 2c32  norm_window=[1,2
-0005e1f0: 2c34 3030 2c34 3530 5d0d 0a09 093e 3e3e  ,400,450]....>>>
-0005e200: 2074 612e 436f 6d70 6172 655f 6174 5f74   ta.Compare_at_t
-0005e210: 696d 6528 7265 6c5f 7469 6d65 203d 205b  ime(rel_time = [
-0005e220: 312c 365d 2c20 6f74 6865 7273 203d 206f  1,6], others = o
-0005e230: 7468 6572 5f70 726f 6a65 6374 2c20 6e6f  ther_project, no
-0005e240: 726d 5f77 696e 646f 7720 3d20 6e6f 726d  rm_window = norm
-0005e250: 5f77 696e 646f 7729 0d0a 0909 0d0a 0909  _window)........
-0005e260: 436f 6d70 6172 6520 7468 6520 7370 6563  Compare the spec
-0005e270: 7472 756d 2061 7420 3170 7320 616e 6420  trum at 1ps and 
-0005e280: 3670 7320 7769 7468 2061 6e20 6578 7465  6ps with an exte
-0005e290: 726e 616c 2073 7065 6374 7275 6d2e 0d0a  rnal spectrum...
-0005e2a0: 0909 0d0a 0909 3e3e 3e20 6578 745f 7370  ......>>> ext_sp
-0005e2b0: 6563 203d 2070 642e 7265 6164 5f63 7376  ec = pd.read_csv
-0005e2c0: 2822 4173 6369 695f 7370 6563 7472 756d  ("Ascii_spectrum
-0005e2d0: 2e64 6174 222c 2073 6570 203d 2022 2c22  .dat", sep = ","
-0005e2e0: 290d 0a09 093e 3e3e 2074 612e 436f 6d70  )....>>> ta.Comp
-0005e2f0: 6172 655f 6174 5f74 696d 6528 7265 6c5f  are_at_time(rel_
-0005e300: 7469 6d65 203d 205b 312c 365d 2c20 7370  time = [1,6], sp
-0005e310: 6563 7472 6120 3d20 6578 745f 7370 6563  ectra = ext_spec
-0005e320: 290d 0a0d 0a09 0955 7365 2065 7861 6d70  )......Use examp
-0005e330: 6c65 202d 2020 4f66 7465 6e20 7468 6572  le -  Often ther
-0005e340: 6520 6172 6520 6120 6c6f 7420 6f66 2064  e are a lot of d
-0005e350: 6966 6665 7265 6e74 206d 6561 7375 7265  ifferent measure
-0005e360: 6d65 6e74 7320 746f 200d 0a09 0963 6f6d  ments to ....com
-0005e370: 7061 7265 2061 7420 6d75 6c74 6970 6c65  pare at multiple
-0005e380: 2074 696d 652e 2054 6865 206e 6f72 6d6c   time. The norml
-0005e390: 697a 6174 696f 6e20 6973 2070 6572 666f  ization is perfo
-0005e3a0: 726d 6564 2061 7420 7468 6520 6772 6f75  rmed at the grou
-0005e3b0: 6e64 2073 7461 7465 2062 6c65 6163 680d  nd state bleach.
-0005e3c0: 0a09 0934 3630 206e 6d20 616e 6420 6561  ...460 nm and ea
-0005e3d0: 726c 7920 696e 2074 696d 652e 2054 6865  rly in time. The
-0005e3e0: 6e20 6974 2069 7320 6265 7474 6572 2074  n it is better t
-0005e3f0: 6f20 6d61 6b65 2061 206e 6577 2070 6c6f  o make a new plo
-0005e400: 7420 666f 7220 6561 6368 200d 0a09 0974  t for each ....t
-0005e410: 696d 6570 6f69 6e74 2e20 5468 6520 6e6f  imepoint. The no
-0005e420: 726d 616c 697a 6174 696f 6e20 7769 6e64  rmalization wind
-0005e430: 6f77 2073 7461 7973 2066 6978 6564 2e0d  ow stays fixed..
-0005e440: 0a09 090d 0a09 093e 3e3e 2070 6c74 2e63  .......>>> plt.c
-0005e450: 6c6f 7365 2822 616c 6c22 2920 236d 616b  lose("all") #mak
-0005e460: 6520 736f 6d65 2073 7061 6365 0d0a 0909  e some space....
-0005e470: 3e3e 3e20 6e6f 726d 5f77 696e 646f 773d  >>> norm_window=
-0005e480: 5b30 2e33 2c30 2e35 2c34 3530 2c34 3730  [0.3,0.5,450,470
-0005e490: 5d20 2364 6566 696e 6520 7769 6e64 6f77  ] #define window
-0005e4a0: 2069 6e20 6772 6f75 6e64 2073 7461 7465   in ground state
-0005e4b0: 2062 6c65 6163 680d 0a09 093e 3e3e 2066   bleach....>>> f
-0005e4c0: 6f72 2074 2069 6e20 5b30 2e33 2c30 2e35  or t in [0.3,0.5
-0005e4d0: 2c31 2c33 2c31 302c 3330 5d3a 2023 6974  ,1,3,10,30]: #it
-0005e4e0: 6572 6174 6520 6f76 6572 2074 6865 2077  erate over the w
-0005e4f0: 6176 656c 656e 6774 6820 0d0a 0909 3e3e  avelength ....>>
-0005e500: 3e20 0974 612e 436f 6d70 6172 655f 6174  > .ta.Compare_at
-0005e510: 5f74 696d 6528 7265 6c5f 7469 6d65 203d  _time(rel_time =
-0005e520: 2074 2c20 6f74 6865 7273 203d 206f 7468   t, others = oth
-0005e530: 6572 5f70 726f 6a65 6374 2c20 6e6f 726d  er_project, norm
-0005e540: 5f77 696e 646f 7720 3d20 6e6f 726d 5f77  _window = norm_w
-0005e550: 696e 646f 7729 0d0a 0909 0d0a 0909 2727  indow)........''
-0005e560: 270d 0a09 090d 0a09 0969 6620 7365 6c66  '........if self
-0005e570: 2e73 6176 655f 6669 6775 7265 735f 746f  .save_figures_to
-0005e580: 5f66 6f6c 6465 723a 7365 6c66 2e66 6967  _folder:self.fig
-0005e590: 7572 655f 7061 7468 3d63 6865 636b 5f66  ure_path=check_f
-0005e5a0: 6f6c 6465 7228 7061 7468 3d27 7265 7375  older(path='resu
-0005e5b0: 6c74 5f66 6967 7572 6573 272c 6375 7272  lt_figures',curr
-0005e5c0: 656e 745f 7061 7468 3d73 656c 662e 7061  ent_path=self.pa
-0005e5d0: 7468 290d 0a09 0969 6620 7469 6d65 5f77  th)....if time_w
-0005e5e0: 6964 7468 5f70 6572 6365 6e74 2069 7320  idth_percent is 
-0005e5f0: 4e6f 6e65 3a74 696d 655f 7769 6474 685f  None:time_width_
-0005e600: 7065 7263 656e 743d 7365 6c66 2e74 696d  percent=self.tim
-0005e610: 655f 7769 6474 685f 7065 7263 656e 740d  e_width_percent.
-0005e620: 0a09 0969 6620 7265 6c5f 7469 6d65 2069  ...if rel_time i
-0005e630: 7320 4e6f 6e65 3a72 656c 5f74 696d 653d  s None:rel_time=
-0005e640: 7365 6c66 2e72 656c 5f74 696d 650d 0a09  self.rel_time...
-0005e650: 0969 6620 6f74 6865 7220 6973 206e 6f74  .if other is not
-0005e660: 204e 6f6e 653a 0d0a 0909 0969 6620 6e6f   None:.....if no
-0005e670: 7420 6861 7361 7474 7228 6f74 6865 722c  t hasattr(other,
-0005e680: 275f 5f69 7465 725f 5f27 293a 6f74 6865  '__iter__'):othe
-0005e690: 723d 5b6f 7468 6572 5d0d 0a09 0969 6620  r=[other]....if 
-0005e6a0: 7265 6c5f 7469 6d65 2069 7320 6e6f 7420  rel_time is not 
-0005e6b0: 4e6f 6e65 3a0d 0a09 0909 6966 206e 6f74  None:.....if not
-0005e6c0: 2068 6173 6174 7472 2872 656c 5f74 696d   hasattr(rel_tim
-0005e6d0: 652c 275f 5f69 7465 725f 5f27 293a 7265  e,'__iter__'):re
-0005e6e0: 6c5f 7469 6d65 3d5b 7265 6c5f 7469 6d65  l_time=[rel_time
-0005e6f0: 5d09 090d 0a09 0965 6c73 653a 0d0a 0909  ]......else:....
-0005e700: 0972 656c 5f74 696d 653d 5b31 5d0d 0a09  .rel_time=[1]...
-0005e710: 0969 6620 636d 6170 2069 7320 4e6f 6e65  .if cmap is None
-0005e720: 3a63 6d61 703d 7365 6c66 2e63 6d61 700d  :cmap=self.cmap.
-0005e730: 0a09 0969 6620 6669 7474 6564 3a0d 0a09  ...if fitted:...
-0005e740: 0909 7472 793a 0d0a 0909 0909 7265 3d73  ..try:......re=s
-0005e750: 656c 662e 7265 0d0a 0909 0965 7863 6570  elf.re.....excep
-0005e760: 743a 0d0a 0909 0909 7072 696e 7428 224e  t:......print("N
-0005e770: 6f20 6669 7474 6564 2072 6573 756c 7473  o fitted results
-0005e780: 2070 7265 7365 6e74 2229 0d0a 0909 0909   present")......
-0005e790: 7265 7475 726e 2046 616c 7365 0d0a 0909  return False....
-0005e7a0: 0969 6620 6e6f 726d 5f77 696e 646f 7720  .if norm_window 
-0005e7b0: 6973 206e 6f74 204e 6f6e 653a 0d0a 0909  is not None:....
-0005e7c0: 0909 7265 665f 7363 616c 653d 7265 5b27  ..ref_scale=re['
-0005e7d0: 4127 5d2e 6c6f 635b 6e6f 726d 5f77 696e  A'].loc[norm_win
-0005e7e0: 646f 775b 305d 3a6e 6f72 6d5f 7769 6e64  dow[0]:norm_wind
-0005e7f0: 6f77 5b31 5d2c 6e6f 726d 5f77 696e 646f  ow[1],norm_windo
-0005e800: 775b 325d 3a6e 6f72 6d5f 7769 6e64 6f77  w[2]:norm_window
-0005e810: 5b33 5d5d 2e6d 6561 6e28 292e 6d65 616e  [3]].mean().mean
-0005e820: 2829 0d0a 0909 0966 6967 2c61 783d 706c  ().....fig,ax=pl
-0005e830: 742e 7375 6270 6c6f 7473 2866 6967 7369  t.subplots(figsi
-0005e840: 7a65 3d28 3130 2c36 292c 6470 693d 3130  ze=(10,6),dpi=10
-0005e850: 3029 0d0a 0909 096f 626a 6563 7473 3d6c  0).....objects=l
-0005e860: 656e 2872 656c 5f74 696d 6529 2a28 312b  en(rel_time)*(1+
-0005e870: 6c65 6e28 6f74 6865 7229 290d 0a09 0909  len(other)).....
-0005e880: 636f 6c6f 7273 3d63 6f6c 6d28 636d 6170  colors=colm(cmap
-0005e890: 3d63 6d61 702c 6b3d 7261 6e67 6528 6f62  =cmap,k=range(ob
-0005e8a0: 6a65 6374 7329 290d 0a09 0909 5f3d 706c  jects))....._=pl
-0005e8b0: 6f74 5f74 696d 6528 7265 5b27 4127 5d2c  ot_time(re['A'],
-0005e8c0: 2061 7820 3d20 6178 2c20 7265 6c5f 7469   ax = ax, rel_ti
-0005e8d0: 6d65 203d 2072 656c 5f74 696d 652c 2074  me = rel_time, t
-0005e8e0: 696d 655f 7769 6474 685f 7065 7263 656e  ime_width_percen
-0005e8f0: 7420 3d20 7469 6d65 5f77 6964 7468 5f70  t = time_width_p
-0005e900: 6572 6365 6e74 2c20 0d0a 0909 0909 0909  ercent, ........
-0005e910: 6261 7365 756e 6974 203d 2073 656c 662e  baseunit = self.
-0005e920: 6261 7365 756e 6974 2c20 6c69 6e65 735f  baseunit, lines_
-0005e930: 6172 6520 3d20 2764 6174 6127 2c20 636d  are = 'data', cm
-0005e940: 6170 203d 2063 6f6c 6f72 735b 3a6c 656e  ap = colors[:len
-0005e950: 2872 656c 5f74 696d 6529 5d2c 2074 6974  (rel_time)], tit
-0005e960: 6c65 203d 2027 272c 206c 696e 6577 6964  le = '', linewid
-0005e970: 7468 203d 206c 696e 6577 6964 7468 2c20  th = linewidth, 
-0005e980: 7375 6270 6c6f 743d 2054 7275 652c 2073  subplot= True, s
-0005e990: 6361 7474 6572 6375 7420 3d20 7365 6c66  cattercut = self
-0005e9a0: 2e73 6361 7474 6572 6375 7429 0d0a 0909  .scattercut)....
-0005e9b0: 095f 3d70 6c6f 745f 7469 6d65 2872 655b  ._=plot_time(re[
-0005e9c0: 2741 4327 5d2c 2061 7820 3d20 6178 2c20  'AC'], ax = ax, 
-0005e9d0: 7265 6c5f 7469 6d65 203d 2072 656c 5f74  rel_time = rel_t
-0005e9e0: 696d 652c 2074 696d 655f 7769 6474 685f  ime, time_width_
-0005e9f0: 7065 7263 656e 7420 3d20 7469 6d65 5f77  percent = time_w
-0005ea00: 6964 7468 5f70 6572 6365 6e74 2c20 0d0a  idth_percent, ..
-0005ea10: 0909 0909 0909 6261 7365 756e 6974 203d  ......baseunit =
-0005ea20: 2073 656c 662e 6261 7365 756e 6974 2c20   self.baseunit, 
-0005ea30: 6c69 6e65 735f 6172 6520 3d20 2766 6974  lines_are = 'fit
-0005ea40: 7465 6427 2c20 636d 6170 203d 2063 6f6c  ted', cmap = col
-0005ea50: 6f72 735b 3a6c 656e 2872 656c 5f74 696d  ors[:len(rel_tim
-0005ea60: 6529 5d2c 2074 6974 6c65 203d 2027 272c  e)], title = '',
-0005ea70: 2073 7562 706c 6f74 203d 2046 616c 7365   subplot = False
-0005ea80: 2c20 6c69 6e65 7769 6474 6820 3d20 6c69  , linewidth = li
-0005ea90: 6e65 7769 6474 682c 2073 6361 7474 6572  newidth, scatter
-0005eaa0: 6375 7420 3d20 7365 6c66 2e73 6361 7474  cut = self.scatt
-0005eab0: 6572 6375 7429 0d0a 0909 0968 616e 646c  ercut).....handl
-0005eac0: 6573 2c20 6c61 6265 6c73 3d61 782e 6765  es, labels=ax.ge
-0005ead0: 745f 6c65 6765 6e64 5f68 616e 646c 6573  t_legend_handles
-0005eae0: 5f6c 6162 656c 7328 290d 0a09 0909 6c61  _labels().....la
-0005eaf0: 623d 5b27 2567 2025 7327 2528 656e 742c  b=['%g %s'%(ent,
-0005eb00: 7365 6c66 2e62 6173 6575 6e69 7429 202b  self.baseunit) +
-0005eb10: 2027 5f27 202b 2073 7472 2873 656c 662e   '_' + str(self.
-0005eb20: 6669 6c65 6e61 6d65 2920 666f 7220 656e  filename) for en
-0005eb30: 7420 696e 2072 656c 5f74 696d 655d 0d0a  t in rel_time]..
-0005eb40: 0909 0968 616e 3d68 616e 646c 6573 5b3a  ...han=handles[:
-0005eb50: 6c65 6e28 7265 6c5f 7469 6d65 292a 325d  len(rel_time)*2]
-0005eb60: 0d0a 0909 0966 6f72 2065 6e74 2069 6e20  .....for ent in 
-0005eb70: 7265 6c5f 7469 6d65 3a0d 0a09 0909 096c  rel_time:......l
-0005eb80: 6162 2e61 7070 656e 6428 2725 6720 2573  ab.append('%g %s
-0005eb90: 2066 6974 2725 2865 6e74 2c73 656c 662e   fit'%(ent,self.
-0005eba0: 6261 7365 756e 6974 2920 2b20 275f 2720  baseunit) + '_' 
-0005ebb0: 2b20 7374 7228 7365 6c66 2e66 696c 656e  + str(self.filen
-0005ebc0: 616d 6529 290d 0a09 0909 6966 206f 7468  ame)).....if oth
-0005ebd0: 6572 2069 7320 6e6f 7420 4e6f 6e65 3a0d  er is not None:.
-0005ebe0: 0a09 0909 0966 6f72 2069 2c6f 2069 6e20  .....for i,o in 
-0005ebf0: 656e 756d 6572 6174 6528 6f74 6865 7229  enumerate(other)
-0005ec00: 3a0d 0a09 0909 0909 7472 793a 0d0a 0909  :.......try:....
-0005ec10: 0909 0909 7265 3d6f 2e72 650d 0a09 0909  ....re=o.re.....
-0005ec20: 0909 6578 6365 7074 3a0d 0a09 0909 0909  ..except:.......
-0005ec30: 0970 7269 6e74 2827 2573 2068 6173 206e  .print('%s has n
-0005ec40: 6f20 6669 7474 6564 2072 6573 756c 7473  o fitted results
-0005ec50: 2725 6f2e 6669 6c65 6e61 6d65 290d 0a09  '%o.filename)...
-0005ec60: 0909 0909 0963 6f6e 7469 6e75 650d 0a09  .....continue...
-0005ec70: 0909 0909 6966 206e 6f72 6d5f 7769 6e64  ....if norm_wind
-0005ec80: 6f77 2069 7320 6e6f 7420 4e6f 6e65 3a0d  ow is not None:.
-0005ec90: 0a09 0909 0909 0972 656c 5f73 6361 6c65  .......rel_scale
-0005eca0: 3d72 655b 2741 275d 2e6c 6f63 5b6e 6f72  =re['A'].loc[nor
-0005ecb0: 6d5f 7769 6e64 6f77 5b30 5d3a 6e6f 726d  m_window[0]:norm
-0005ecc0: 5f77 696e 646f 775b 315d 2c6e 6f72 6d5f  _window[1],norm_
-0005ecd0: 7769 6e64 6f77 5b32 5d3a 6e6f 726d 5f77  window[2]:norm_w
-0005ece0: 696e 646f 775b 335d 5d2e 6d65 616e 2829  indow[3]].mean()
-0005ecf0: 2e6d 6561 6e28 290d 0a09 0909 0909 0974  .mean()........t
-0005ed00: 7279 3a0d 0a09 0909 0909 0909 7363 616c  ry:.........scal
-0005ed10: 696e 673d 2872 656c 5f73 6361 6c65 2f72  ing=(rel_scale/r
-0005ed20: 6566 5f73 6361 6c65 290d 0a09 0909 0909  ef_scale).......
-0005ed30: 0909 6178 3d70 6c6f 745f 7469 6d65 2872  ..ax=plot_time(r
-0005ed40: 655b 2741 4327 5d2f 7363 616c 696e 672c  e['AC']/scaling,
-0005ed50: 2063 6d61 7020 3d20 636f 6c6f 7273 2c20   cmap = colors, 
-0005ed60: 6178 203d 2061 782c 2072 656c 5f74 696d  ax = ax, rel_tim
-0005ed70: 6520 3d20 7265 6c5f 7469 6d65 2c20 0d0a  e = rel_time, ..
-0005ed80: 0909 0909 0909 0909 0909 7469 6d65 5f77  ..........time_w
-0005ed90: 6964 7468 5f70 6572 6365 6e74 203d 2074  idth_percent = t
-0005eda0: 696d 655f 7769 6474 685f 7065 7263 656e  ime_width_percen
-0005edb0: 742c 2074 6974 6c65 203d 2027 272c 206c  t, title = '', l
-0005edc0: 696e 6573 5f61 7265 203d 2027 6669 7474  ines_are = 'fitt
-0005edd0: 6564 272c 200d 0a09 0909 0909 0909 0909  ed', ...........
-0005ede0: 0973 7562 706c 6f74 203d 2054 7275 652c  .subplot = True,
-0005edf0: 2063 6f6c 6f72 5f6f 6666 7365 7420 3d20   color_offset = 
-0005ee00: 6c65 6e28 7265 6c5f 7469 6d65 292a 2869  len(rel_time)*(i
-0005ee10: 2b31 292c 206c 696e 6577 6964 7468 203d  +1), linewidth =
-0005ee20: 206c 696e 6577 6964 7468 2c20 7363 6174   linewidth, scat
-0005ee30: 7465 7263 7574 203d 206f 2e73 6361 7474  tercut = o.scatt
-0005ee40: 6572 6375 7429 0d0a 0909 0909 0909 0968  ercut).........h
-0005ee50: 616e 646c 6573 2c20 6c61 6265 6c73 3d61  andles, labels=a
-0005ee60: 782e 6765 745f 6c65 6765 6e64 5f68 616e  x.get_legend_han
-0005ee70: 646c 6573 5f6c 6162 656c 7328 290d 0a09  dles_labels()...
-0005ee80: 0909 0909 0909 666f 7220 656e 7420 696e  ......for ent in
-0005ee90: 2072 656c 5f74 696d 653a 0d0a 0909 0909   rel_time:......
-0005eea0: 0909 0909 6c61 622e 6170 7065 6e64 2827  ....lab.append('
-0005eeb0: 2567 2025 7320 6669 7427 2528 656e 742c  %g %s fit'%(ent,
-0005eec0: 6f2e 6261 7365 756e 6974 2920 2b20 275f  o.baseunit) + '_
-0005eed0: 2720 2b20 7374 7228 6f2e 6669 6c65 6e61  ' + str(o.filena
-0005eee0: 6d65 2929 0d0a 0909 0909 0909 0966 6f72  me)).........for
-0005eef0: 2061 2069 6e20 6861 6e64 6c65 735b 2d6c   a in handles[-l
-0005ef00: 656e 2872 656c 5f74 696d 6529 3a5d 3a0d  en(rel_time):]:.
-0005ef10: 0a09 0909 0909 0909 0968 616e 2e61 7070  .........han.app
-0005ef20: 656e 6428 6129 0d0a 0909 0909 0909 090d  end(a)..........
-0005ef30: 0a09 0909 0909 0909 6966 2064 6174 615f  ........if data_
-0005ef40: 616e 645f 6669 743a 0d0a 0909 0909 0909  and_fit:........
-0005ef50: 0909 6178 3d70 6c6f 745f 7469 6d65 2872  ..ax=plot_time(r
-0005ef60: 655b 2741 275d 2f73 6361 6c69 6e67 2c20  e['A']/scaling, 
-0005ef70: 636d 6170 203d 2073 656c 662e 636d 6170  cmap = self.cmap
-0005ef80: 2c20 6178 203d 2061 782c 2072 656c 5f74  , ax = ax, rel_t
-0005ef90: 696d 6520 3d20 7265 6c5f 7469 6d65 2c20  ime = rel_time, 
-0005efa0: 0d0a 0909 0909 0909 0909 0909 0974 696d  .............tim
-0005efb0: 655f 7769 6474 685f 7065 7263 656e 7420  e_width_percent 
-0005efc0: 3d20 7469 6d65 5f77 6964 7468 5f70 6572  = time_width_per
-0005efd0: 6365 6e74 2c20 7469 746c 6520 3d20 6f2e  cent, title = o.
-0005efe0: 6669 6c65 6e61 6d65 2c20 0d0a 0909 0909  filename, ......
-0005eff0: 0909 0909 0909 0962 6173 6575 6e69 7420  .......baseunit 
-0005f000: 3d20 7365 6c66 2e62 6173 6575 6e69 742c  = self.baseunit,
-0005f010: 206c 696e 6573 5f61 7265 203d 2027 6461   lines_are = 'da
-0005f020: 7461 272c 2073 7562 706c 6f74 203d 2054  ta', subplot = T
-0005f030: 7275 652c 200d 0a09 0909 0909 0909 0909  rue, ...........
-0005f040: 0909 636f 6c6f 725f 6f66 6673 6574 203d  ..color_offset =
-0005f050: 206c 656e 2872 656c 5f74 696d 6529 2a28   len(rel_time)*(
-0005f060: 692b 3129 2c20 6c69 6e65 7769 6474 6820  i+1), linewidth 
-0005f070: 3d20 6c69 6e65 7769 6474 682c 2073 6361  = linewidth, sca
-0005f080: 7474 6572 6375 7420 3d20 6f2e 7363 6174  ttercut = o.scat
-0005f090: 7465 7263 7574 290d 0a09 0909 0909 0909  tercut).........
-0005f0a0: 0968 616e 646c 6573 2c20 6c61 6265 6c73  .handles, labels
-0005f0b0: 3d61 782e 6765 745f 6c65 6765 6e64 5f68  =ax.get_legend_h
-0005f0c0: 616e 646c 6573 5f6c 6162 656c 7328 290d  andles_labels().
-0005f0d0: 0a09 0909 0909 0909 0966 6f72 2065 6e74  .........for ent
-0005f0e0: 2069 6e20 7265 6c5f 7469 6d65 3a0d 0a09   in rel_time:...
-0005f0f0: 0909 0909 0909 0909 6c61 622e 6170 7065  ........lab.appe
-0005f100: 6e64 2827 2567 2025 7327 2528 656e 742c  nd('%g %s'%(ent,
-0005f110: 6f2e 6261 7365 756e 6974 2920 2b20 275f  o.baseunit) + '_
-0005f120: 2720 2b20 7374 7228 6f2e 6669 6c65 6e61  ' + str(o.filena
-0005f130: 6d65 2929 0d0a 0909 0909 0909 0909 666f  me))..........fo
-0005f140: 7220 6120 696e 2068 616e 646c 6573 5b2d  r a in handles[-
-0005f150: 6c65 6e28 7265 6c5f 7469 6d65 293a 5d3a  len(rel_time):]:
-0005f160: 0d0a 0909 0909 0909 0909 0968 616e 2e61  ...........han.a
-0005f170: 7070 656e 6428 6129 0d0a 0909 0909 0909  ppend(a)........
-0005f180: 096e 6f72 6d5f 6661 696c 6564 203d 2046  .norm_failed = F
-0005f190: 616c 7365 0d0a 0909 0909 0909 6578 6365  alse........exce
-0005f1a0: 7074 3a0d 0a09 0909 0909 0909 7072 696e  pt:.........prin
-0005f1b0: 7428 2773 6361 6c69 6e67 2046 6169 6c65  t('scaling Faile
-0005f1c0: 6421 2729 0d0a 0909 0909 0909 096e 6f72  d!').........nor
-0005f1d0: 6d5f 6661 696c 6564 203d 2054 7275 650d  m_failed = True.
-0005f1e0: 0a09 0909 0909 656c 7365 3a20 6e6f 726d  ......else: norm
-0005f1f0: 5f66 6169 6c65 643d 5472 7565 090d 0a09  _failed=True....
-0005f200: 0909 0909 6966 206e 6f72 6d5f 6661 696c  ....if norm_fail
-0005f210: 6564 3a0d 0a09 0909 0909 0961 783d 706c  ed:........ax=pl
-0005f220: 6f74 5f74 696d 6528 7265 5b27 4143 275d  ot_time(re['AC']
-0005f230: 2c20 636d 6170 203d 2063 6f6c 6f72 732c  , cmap = colors,
-0005f240: 2061 7820 3d20 6178 2c20 7265 6c5f 7469   ax = ax, rel_ti
-0005f250: 6d65 203d 2072 656c 5f74 696d 652c 200d  me = rel_time, .
-0005f260: 0a09 0909 0909 0909 0909 0974 696d 655f  ...........time_
-0005f270: 7769 6474 685f 7065 7263 656e 7420 3d20  width_percent = 
-0005f280: 7469 6d65 5f77 6964 7468 5f70 6572 6365  time_width_perce
-0005f290: 6e74 2c20 7469 746c 6520 3d20 2727 2c20  nt, title = '', 
-0005f2a0: 6c69 6e65 735f 6172 6520 3d20 2766 6974  lines_are = 'fit
-0005f2b0: 7465 6427 2c20 0d0a 0909 0909 0909 0909  ted', ..........
-0005f2c0: 0909 7375 6270 6c6f 7420 3d20 5472 7565  ..subplot = True
-0005f2d0: 2c20 636f 6c6f 725f 6f66 6673 6574 203d  , color_offset =
-0005f2e0: 206c 656e 2872 656c 5f74 696d 6529 2a28   len(rel_time)*(
-0005f2f0: 692b 3129 2c20 6c69 6e65 7769 6474 6820  i+1), linewidth 
-0005f300: 3d20 6c69 6e65 7769 6474 682c 2073 6361  = linewidth, sca
-0005f310: 7474 6572 6375 7420 3d20 6f2e 7363 6174  ttercut = o.scat
-0005f320: 7465 7263 7574 290d 0a09 0909 0909 0968  tercut)........h
-0005f330: 616e 646c 6573 2c20 6c61 6265 6c73 3d61  andles, labels=a
-0005f340: 782e 6765 745f 6c65 6765 6e64 5f68 616e  x.get_legend_han
-0005f350: 646c 6573 5f6c 6162 656c 7328 290d 0a09  dles_labels()...
-0005f360: 0909 0909 0966 6f72 2065 6e74 2069 6e20  .....for ent in 
-0005f370: 7265 6c5f 7469 6d65 3a0d 0a09 0909 0909  rel_time:.......
-0005f380: 0909 6c61 622e 6170 7065 6e64 2827 2567  ..lab.append('%g
-0005f390: 2025 7320 6669 7427 2528 656e 742c 6f2e   %s fit'%(ent,o.
-0005f3a0: 6261 7365 756e 6974 2920 2b20 275f 2720  baseunit) + '_' 
-0005f3b0: 2b20 7374 7228 6f2e 6669 6c65 6e61 6d65  + str(o.filename
-0005f3c0: 2929 0d0a 0909 0909 0909 666f 7220 6120  ))........for a 
-0005f3d0: 696e 2068 616e 646c 6573 5b2d 6c65 6e28  in handles[-len(
-0005f3e0: 7265 6c5f 7469 6d65 293a 5d3a 0d0a 0909  rel_time):]:....
-0005f3f0: 0909 0909 0968 616e 2e61 7070 656e 6428  .....han.append(
-0005f400: 6129 0d0a 0909 0909 0909 0d0a 0909 0909  a)..............
-0005f410: 0909 6966 2064 6174 615f 616e 645f 6669  ..if data_and_fi
-0005f420: 743a 0d0a 0909 0909 0909 0961 783d 706c  t:.........ax=pl
-0005f430: 6f74 5f74 696d 6528 7265 5b27 4127 5d2c  ot_time(re['A'],
-0005f440: 2063 6d61 7020 3d20 7365 6c66 2e63 6d61   cmap = self.cma
-0005f450: 702c 2061 7820 3d20 6178 2c20 7265 6c5f  p, ax = ax, rel_
-0005f460: 7469 6d65 203d 2072 656c 5f74 696d 652c  time = rel_time,
-0005f470: 200d 0a09 0909 0909 0909 0909 0974 696d   ............tim
-0005f480: 655f 7769 6474 685f 7065 7263 656e 7420  e_width_percent 
-0005f490: 3d20 7469 6d65 5f77 6964 7468 5f70 6572  = time_width_per
-0005f4a0: 6365 6e74 2c20 7469 746c 6520 3d20 6f2e  cent, title = o.
-0005f4b0: 6669 6c65 6e61 6d65 2c20 0d0a 0909 0909  filename, ......
-0005f4c0: 0909 0909 0909 6261 7365 756e 6974 203d  ......baseunit =
-0005f4d0: 2073 656c 662e 6261 7365 756e 6974 2c20   self.baseunit, 
-0005f4e0: 6c69 6e65 735f 6172 6520 3d20 2764 6174  lines_are = 'dat
-0005f4f0: 6127 2c20 7375 6270 6c6f 7420 3d20 5472  a', subplot = Tr
-0005f500: 7565 2c20 0d0a 0909 0909 0909 0909 0909  ue, ............
-0005f510: 636f 6c6f 725f 6f66 6673 6574 203d 206c  color_offset = l
-0005f520: 656e 2872 656c 5f74 696d 6529 2a28 692b  en(rel_time)*(i+
-0005f530: 3129 2c20 6c69 6e65 7769 6474 6820 3d20  1), linewidth = 
-0005f540: 6c69 6e65 7769 6474 682c 2073 6361 7474  linewidth, scatt
-0005f550: 6572 6375 7420 3d20 6f2e 7363 6174 7465  ercut = o.scatte
-0005f560: 7263 7574 290d 0a09 0909 0909 0909 6861  rcut).........ha
-0005f570: 6e64 6c65 732c 206c 6162 656c 733d 6178  ndles, labels=ax
-0005f580: 2e67 6574 5f6c 6567 656e 645f 6861 6e64  .get_legend_hand
-0005f590: 6c65 735f 6c61 6265 6c73 2829 0d0a 0909  les_labels()....
-0005f5a0: 0909 0909 0966 6f72 2065 6e74 2069 6e20  .....for ent in 
-0005f5b0: 7265 6c5f 7469 6d65 3a0d 0a09 0909 0909  rel_time:.......
-0005f5c0: 0909 096c 6162 2e61 7070 656e 6428 2725  ...lab.append('%
-0005f5d0: 6720 2573 2725 2865 6e74 2c6f 2e62 6173  g %s'%(ent,o.bas
-0005f5e0: 6575 6e69 7429 202b 2027 5f27 202b 2073  eunit) + '_' + s
-0005f5f0: 7472 286f 2e66 696c 656e 616d 6529 290d  tr(o.filename)).
-0005f600: 0a09 0909 0909 0909 666f 7220 6120 696e  ........for a in
-0005f610: 2068 616e 646c 6573 5b2d 6c65 6e28 7265   handles[-len(re
-0005f620: 6c5f 7469 6d65 293a 5d3a 0d0a 0909 0909  l_time):]:......
-0005f630: 0909 0909 6861 6e2e 6170 7065 6e64 2861  ....han.append(a
-0005f640: 290d 0a09 0909 6966 206e 6f74 206e 6f72  ).....if not nor
-0005f650: 6d5f 6661 696c 6564 3a0d 0a09 0909 0961  m_failed:......a
-0005f660: 782e 7365 745f 7469 746c 6528 2763 6f6d  x.set_title('com
-0005f670: 7061 7265 206d 6561 7375 7265 6420 616e  pare measured an
-0005f680: 6420 6669 7474 6564 2064 6174 6120 6174  d fitted data at
-0005f690: 2067 6976 656e 2074 696d 6573 5c6e 2073   given times\n s
-0005f6a0: 6361 6c65 6420 746f 2074 3d25 6720 7073  caled to t=%g ps
-0005f6b0: 203a 2025 6720 7073 202c 2077 6c3d 2025   : %g ps , wl= %
-0005f6c0: 6720 6e6d 3a20 2567 206e 6d27 2528 6e6f  g nm: %g nm'%(no
-0005f6d0: 726d 5f77 696e 646f 775b 305d 2c6e 6f72  rm_window[0],nor
-0005f6e0: 6d5f 7769 6e64 6f77 5b31 5d2c 6e6f 726d  m_window[1],norm
-0005f6f0: 5f77 696e 646f 775b 325d 2c6e 6f72 6d5f  _window[2],norm_
-0005f700: 7769 6e64 6f77 5b33 5d29 290d 0a09 0909  window[3])).....
-0005f710: 656c 7365 3a0d 0a09 0909 0961 782e 7365  else:......ax.se
-0005f720: 745f 7469 746c 6528 2763 6f6d 7061 7265  t_title('compare
-0005f730: 206d 6561 7375 7265 6420 616e 6420 6669   measured and fi
-0005f740: 7474 6564 2064 6174 6120 6174 2067 6976  tted data at giv
-0005f750: 656e 2074 696d 6573 2729 0d0a 0909 0961  en times').....a
-0005f760: 782e 7365 745f 786c 696d 2872 655b 2741  x.set_xlim(re['A
-0005f770: 275d 2e63 6f6c 756d 6e73 2e76 616c 7565  '].columns.value
-0005f780: 735b 305d 2c72 655b 2741 275d 2e63 6f6c  s[0],re['A'].col
-0005f790: 756d 6e73 2e76 616c 7565 735b 2d31 5d29  umns.values[-1])
-0005f7a0: 0d0a 0909 0961 782e 6c65 6765 6e64 2868  .....ax.legend(h
-0005f7b0: 616e 2c20 6c61 6220 2c6c 6162 656c 7370  an, lab ,labelsp
-0005f7c0: 6163 696e 6720 3d20 302c 206e 636f 6c20  acing = 0, ncol 
-0005f7d0: 3d20 322c 2063 6f6c 756d 6e73 7061 6369  = 2, columnspaci
-0005f7e0: 6e67 203d 2031 2c20 6861 6e64 6c65 6c65  ng = 1, handlele
-0005f7f0: 6e67 7468 203d 2031 2c20 6672 616d 656f  ngth = 1, frameo
-0005f800: 6e20 3d20 4661 6c73 6529 0d0a 0909 656c  n = False)....el
-0005f810: 7365 3a0d 0a09 0909 6966 206e 6f72 6d5f  se:.....if norm_
-0005f820: 7769 6e64 6f77 2069 7320 6e6f 7420 4e6f  window is not No
-0005f830: 6e65 3a0d 0a09 0909 0972 6566 5f73 6361  ne:......ref_sca
-0005f840: 6c65 3d73 656c 662e 6473 2e6c 6f63 5b6e  le=self.ds.loc[n
-0005f850: 6f72 6d5f 7769 6e64 6f77 5b30 5d3a 6e6f  orm_window[0]:no
-0005f860: 726d 5f77 696e 646f 775b 315d 2c6e 6f72  rm_window[1],nor
-0005f870: 6d5f 7769 6e64 6f77 5b32 5d3a 6e6f 726d  m_window[2]:norm
-0005f880: 5f77 696e 646f 775b 335d 5d2e 6d65 616e  _window[3]].mean
-0005f890: 2829 2e6d 6561 6e28 290d 0a09 0909 6f62  ().mean().....ob
-0005f8a0: 6a65 6374 733d 6c65 6e28 7265 6c5f 7469  jects=len(rel_ti
-0005f8b0: 6d65 292a 2831 2b6c 656e 286f 7468 6572  me)*(1+len(other
-0005f8c0: 2929 0d0a 0909 0963 6f6c 6f72 733d 636f  )).....colors=co
-0005f8d0: 6c6d 2863 6d61 703d 636d 6170 2c6b 3d72  lm(cmap=cmap,k=r
-0005f8e0: 616e 6765 286f 626a 6563 7473 2929 0d0a  ange(objects))..
-0005f8f0: 0909 0966 6967 2c61 783d 706c 742e 7375  ...fig,ax=plt.su
-0005f900: 6270 6c6f 7473 2866 6967 7369 7a65 3d28  bplots(figsize=(
-0005f910: 3130 2c36 292c 6470 693d 3130 3029 0d0a  10,6),dpi=100)..
-0005f920: 0909 095f 3d70 6c6f 745f 7469 6d65 2873  ..._=plot_time(s
-0005f930: 656c 662e 6473 2c20 6178 203d 2061 782c  elf.ds, ax = ax,
-0005f940: 2072 656c 5f74 696d 6520 3d20 7265 6c5f   rel_time = rel_
-0005f950: 7469 6d65 2c20 7469 6d65 5f77 6964 7468  time, time_width
-0005f960: 5f70 6572 6365 6e74 203d 2074 696d 655f  _percent = time_
-0005f970: 7769 6474 685f 7065 7263 656e 742c 200d  width_percent, .
-0005f980: 0a09 0909 0909 0974 6974 6c65 203d 2074  .......title = t
-0005f990: 6974 6c65 2c20 6c69 6e65 735f 6172 6520  itle, lines_are 
-0005f9a0: 3d20 2764 6174 6127 2c20 7363 6174 7465  = 'data', scatte
-0005f9b0: 7263 7574 203d 2073 656c 662e 7363 6174  rcut = self.scat
-0005f9c0: 7465 7263 7574 2c20 626f 7264 6572 6375  tercut, bordercu
-0005f9d0: 7420 3d20 7365 6c66 2e62 6f72 6465 7263  t = self.borderc
-0005f9e0: 7574 2c20 0d0a 0909 0909 0909 7761 7665  ut, ........wave
-0005f9f0: 5f6e 6d5f 6269 6e20 3d20 7365 6c66 2e77  _nm_bin = self.w
-0005fa00: 6176 655f 6e6d 5f62 696e 2c20 636d 6170  ave_nm_bin, cmap
-0005fa10: 203d 2063 6f6c 6f72 732c 2073 7562 706c   = colors, subpl
-0005fa20: 6f74 203d 2054 7275 652c 206c 696e 6577  ot = True, linew
-0005fa30: 6964 7468 203d 206c 696e 6577 6964 7468  idth = linewidth
-0005fa40: 2c20 6261 7365 756e 6974 3d73 656c 662e  , baseunit=self.
-0005fa50: 6261 7365 756e 6974 290d 0a09 0909 6966  baseunit).....if
-0005fa60: 2031 3a0d 0a09 0909 095f 3d70 6c6f 745f   1:......_=plot_
-0005fa70: 7469 6d65 2873 656c 662e 6473 2c20 6178  time(self.ds, ax
-0005fa80: 203d 2061 782c 2072 656c 5f74 696d 6520   = ax, rel_time 
-0005fa90: 3d20 7265 6c5f 7469 6d65 2c20 7469 6d65  = rel_time, time
-0005faa0: 5f77 6964 7468 5f70 6572 6365 6e74 203d  _width_percent =
-0005fab0: 2074 696d 655f 7769 6474 685f 7065 7263   time_width_perc
-0005fac0: 656e 742c 200d 0a09 0909 0909 0909 7469  ent, .........ti
-0005fad0: 746c 6520 3d20 7469 746c 652c 206c 696e  tle = title, lin
-0005fae0: 6573 5f61 7265 203d 2027 736d 6f6f 7468  es_are = 'smooth
-0005faf0: 6564 272c 2073 6361 7474 6572 6375 7420  ed', scattercut 
-0005fb00: 3d20 7365 6c66 2e73 6361 7474 6572 6375  = self.scattercu
-0005fb10: 742c 2062 6f72 6465 7263 7574 203d 2073  t, bordercut = s
-0005fb20: 656c 662e 626f 7264 6572 6375 742c 7761  elf.bordercut,wa
-0005fb30: 7665 5f6e 6d5f 6269 6e20 3d20 7365 6c66  ve_nm_bin = self
-0005fb40: 2e77 6176 655f 6e6d 5f62 696e 2c20 636d  .wave_nm_bin, cm
-0005fb50: 6170 203d 2063 6f6c 6f72 732c 2073 7562  ap = colors, sub
-0005fb60: 706c 6f74 203d 2046 616c 7365 2c20 6c69  plot = False, li
-0005fb70: 6e65 7769 6474 6820 3d20 6c69 6e65 7769  newidth = linewi
-0005fb80: 6474 682c 2062 6173 6575 6e69 7420 3d20  dth, baseunit = 
-0005fb90: 7365 6c66 2e62 6173 6575 6e69 7429 0d0a  self.baseunit)..
-0005fba0: 0909 0968 616e 646c 6573 2c20 6c61 6265  ...handles, labe
-0005fbb0: 6c73 3d61 782e 6765 745f 6c65 6765 6e64  ls=ax.get_legend
-0005fbc0: 5f68 616e 646c 6573 5f6c 6162 656c 7328  _handles_labels(
-0005fbd0: 290d 0a09 0909 6c61 623d 5b27 2567 2025  ).....lab=['%g %
-0005fbe0: 7327 2528 656e 742c 7365 6c66 2e62 6173  s'%(ent,self.bas
-0005fbf0: 6575 6e69 7429 202b 2027 5f27 202b 2073  eunit) + '_' + s
-0005fc00: 7472 2873 656c 662e 6669 6c65 6e61 6d65  tr(self.filename
-0005fc10: 2920 666f 7220 656e 7420 696e 2072 656c  ) for ent in rel
-0005fc20: 5f74 696d 655d 0d0a 0909 0968 616e 3d68  _time].....han=h
-0005fc30: 616e 646c 6573 5b3a 6c65 6e28 7265 6c5f  andles[:len(rel_
-0005fc40: 7469 6d65 295d 0d0a 0909 0969 6620 6f74  time)].....if ot
-0005fc50: 6865 7220 6973 206e 6f74 204e 6f6e 653a  her is not None:
-0005fc60: 0d0a 0909 0909 666f 7220 692c 6f20 696e  ......for i,o in
-0005fc70: 2065 6e75 6d65 7261 7465 286f 7468 6572   enumerate(other
-0005fc80: 293a 0d0a 0909 0909 0969 6620 6e6f 726d  ):.......if norm
-0005fc90: 5f77 696e 646f 7720 6973 206e 6f74 204e  _window is not N
-0005fca0: 6f6e 653a 0d0a 0909 0909 0909 7265 6c5f  one:........rel_
-0005fcb0: 7363 616c 653d 6f2e 6473 2e6c 6f63 5b6e  scale=o.ds.loc[n
-0005fcc0: 6f72 6d5f 7769 6e64 6f77 5b30 5d3a 6e6f  orm_window[0]:no
-0005fcd0: 726d 5f77 696e 646f 775b 315d 2c6e 6f72  rm_window[1],nor
-0005fce0: 6d5f 7769 6e64 6f77 5b32 5d3a 6e6f 726d  m_window[2]:norm
-0005fcf0: 5f77 696e 646f 775b 335d 5d2e 6d65 616e  _window[3]].mean
-0005fd00: 2829 2e6d 6561 6e28 290d 0a09 0909 0909  ().mean().......
-0005fd10: 0974 7279 3a0d 0a09 0909 0909 0909 7363  .try:.........sc
-0005fd20: 616c 696e 6720 3d20 2872 656c 5f73 6361  aling = (rel_sca
-0005fd30: 6c65 2f72 6566 5f73 6361 6c65 290d 0a09  le/ref_scale)...
-0005fd40: 0909 0909 0909 6178 3d70 6c6f 745f 7469  ......ax=plot_ti
-0005fd50: 6d65 286f 2e64 732f 7363 616c 696e 672c  me(o.ds/scaling,
-0005fd60: 2063 6d61 7020 3d20 636f 6c6f 7273 2c20   cmap = colors, 
-0005fd70: 6178 203d 2061 782c 2072 656c 5f74 696d  ax = ax, rel_tim
-0005fd80: 6520 3d20 7265 6c5f 7469 6d65 2c20 0d0a  e = rel_time, ..
-0005fd90: 0909 0909 0909 0909 0909 7469 6d65 5f77  ..........time_w
-0005fda0: 6964 7468 5f70 6572 6365 6e74 203d 2074  idth_percent = t
-0005fdb0: 696d 655f 7769 6474 685f 7065 7263 656e  ime_width_percen
-0005fdc0: 742c 2074 6974 6c65 203d 2074 6974 6c65  t, title = title
-0005fdd0: 2c20 6c69 6e65 735f 6172 6520 3d20 2764  , lines_are = 'd
-0005fde0: 6174 6127 2c20 0d0a 0909 0909 0909 0909  ata', ..........
-0005fdf0: 0909 7363 6174 7465 7263 7574 203d 206f  ..scattercut = o
-0005fe00: 2e73 6361 7474 6572 6375 742c 2062 6f72  .scattercut, bor
-0005fe10: 6465 7263 7574 203d 206f 2e62 6f72 6465  dercut = o.borde
-0005fe20: 7263 7574 2c20 6c69 6e65 7769 6474 6820  rcut, linewidth 
-0005fe30: 3d20 6c69 6e65 7769 6474 682c 200d 0a09  = linewidth, ...
-0005fe40: 0909 0909 0909 0909 0977 6176 655f 6e6d  .........wave_nm
-0005fe50: 5f62 696e 203d 206f 2e77 6176 655f 6e6d  _bin = o.wave_nm
-0005fe60: 5f62 696e 2c20 7375 6270 6c6f 7420 3d20  _bin, subplot = 
-0005fe70: 5472 7565 2c20 636f 6c6f 725f 6f66 6673  True, color_offs
-0005fe80: 6574 203d 206c 656e 2872 656c 5f74 696d  et = len(rel_tim
-0005fe90: 6529 2a28 692b 3129 290d 0a09 0909 0909  e)*(i+1)).......
-0005fea0: 0909 6861 6e64 6c65 732c 206c 6162 656c  ..handles, label
-0005feb0: 733d 6178 2e67 6574 5f6c 6567 656e 645f  s=ax.get_legend_
-0005fec0: 6861 6e64 6c65 735f 6c61 6265 6c73 2829  handles_labels()
-0005fed0: 0d0a 0909 0909 0909 0966 6f72 2065 6e74  .........for ent
-0005fee0: 2069 6e20 7265 6c5f 7469 6d65 3a0d 0a09   in rel_time:...
-0005fef0: 0909 0909 0909 096c 6162 2e61 7070 656e  .......lab.appen
-0005ff00: 6428 2725 6720 2573 2725 2865 6e74 2c6f  d('%g %s'%(ent,o
-0005ff10: 2e62 6173 6575 6e69 7429 202b 2027 5f27  .baseunit) + '_'
-0005ff20: 202b 2073 7472 286f 2e66 696c 656e 616d   + str(o.filenam
-0005ff30: 6529 290d 0a09 0909 0909 0909 666f 7220  e)).........for 
-0005ff40: 6120 696e 2068 616e 646c 6573 5b2d 6c65  a in handles[-le
-0005ff50: 6e28 7265 6c5f 7469 6d65 293a 5d3a 0d0a  n(rel_time):]:..
-0005ff60: 0909 0909 0909 0909 6861 6e2e 6170 7065  ........han.appe
-0005ff70: 6e64 2861 290d 0a0d 0a09 0909 0909 0909  nd(a)...........
-0005ff80: 6966 2064 6174 615f 616e 645f 6669 743a  if data_and_fit:
-0005ff90: 0d0a 0909 0909 0909 0909 6178 3d70 6c6f  ..........ax=plo
-0005ffa0: 745f 7469 6d65 286f 2e64 732f 7363 616c  t_time(o.ds/scal
-0005ffb0: 696e 672c 2063 6d61 7020 3d20 636f 6c6f  ing, cmap = colo
-0005ffc0: 7273 2c20 6178 203d 2061 782c 2072 656c  rs, ax = ax, rel
-0005ffd0: 5f74 696d 6520 3d20 7265 6c5f 7469 6d65  _time = rel_time
-0005ffe0: 2c20 0d0a 0909 0909 0909 0909 0909 7469  , ............ti
-0005fff0: 6d65 5f77 6964 7468 5f70 6572 6365 6e74  me_width_percent
-00060000: 203d 2074 696d 655f 7769 6474 685f 7065   = time_width_pe
-00060010: 7263 656e 742c 2074 6974 6c65 203d 2074  rcent, title = t
-00060020: 6974 6c65 2c20 6c69 6e65 735f 6172 6520  itle, lines_are 
-00060030: 3d20 2773 6d6f 6f74 6865 6427 2c20 0d0a  = 'smoothed', ..
-00060040: 0909 0909 0909 0909 0909 7363 6174 7465  ..........scatte
-00060050: 7263 7574 203d 206f 2e73 6361 7474 6572  rcut = o.scatter
-00060060: 6375 742c 2062 6f72 6465 7263 7574 203d  cut, bordercut =
-00060070: 206f 2e62 6f72 6465 7263 7574 2c20 6c69   o.bordercut, li
-00060080: 6e65 7769 6474 6820 3d20 6c69 6e65 7769  newidth = linewi
-00060090: 6474 682c 200d 0a09 0909 0909 0909 0909  dth, ...........
-000600a0: 0977 6176 655f 6e6d 5f62 696e 203d 206f  .wave_nm_bin = o
-000600b0: 2e77 6176 655f 6e6d 5f62 696e 2c20 7375  .wave_nm_bin, su
-000600c0: 6270 6c6f 7420 3d20 5472 7565 2c20 636f  bplot = True, co
-000600d0: 6c6f 725f 6f66 6673 6574 203d 206c 656e  lor_offset = len
-000600e0: 2872 656c 5f74 696d 6529 2a28 692b 3129  (rel_time)*(i+1)
-000600f0: 290d 0a09 0909 0909 0909 7363 616c 696e  ).........scalin
-00060100: 675f 6661 696c 6564 3d46 616c 7365 0d0a  g_failed=False..
-00060110: 0909 0909 0909 6578 6365 7074 3a0d 0a09  ......except:...
-00060120: 0909 0909 0909 7072 696e 7428 2773 6361  ......print('sca
-00060130: 6c69 6e67 2046 6169 6c65 6421 2729 0d0a  ling Failed!')..
-00060140: 0909 0909 0909 0973 6361 6c69 6e67 5f66  .......scaling_f
-00060150: 6169 6c65 643d 5472 7565 0d0a 0909 0909  ailed=True......
-00060160: 0965 6c73 653a 0d0a 0909 0909 0909 7363  .else:........sc
-00060170: 616c 696e 675f 6661 696c 6564 3d54 7275  aling_failed=Tru
-00060180: 650d 0a09 0909 0909 6966 2073 6361 6c69  e.......if scali
-00060190: 6e67 5f66 6169 6c65 643a 0d0a 0909 0909  ng_failed:......
-000601a0: 0909 6178 3d70 6c6f 745f 7469 6d65 286f  ..ax=plot_time(o
-000601b0: 2e64 732c 2063 6d61 7020 3d20 636f 6c6f  .ds, cmap = colo
-000601c0: 7273 2c20 6178 203d 2061 782c 2072 656c  rs, ax = ax, rel
-000601d0: 5f74 696d 6520 3d20 7265 6c5f 7469 6d65  _time = rel_time
-000601e0: 2c20 0d0a 0909 0909 0909 0909 0974 696d  , ...........tim
-000601f0: 655f 7769 6474 685f 7065 7263 656e 7420  e_width_percent 
-00060200: 3d20 7469 6d65 5f77 6964 7468 5f70 6572  = time_width_per
-00060210: 6365 6e74 2c20 7469 746c 6520 3d20 7469  cent, title = ti
-00060220: 746c 652c 206c 696e 6573 5f61 7265 203d  tle, lines_are =
-00060230: 2027 6461 7461 272c 200d 0a09 0909 0909   'data', .......
-00060240: 0909 0909 7363 6174 7465 7263 7574 203d  ....scattercut =
-00060250: 206f 2e73 6361 7474 6572 6375 742c 2062   o.scattercut, b
-00060260: 6f72 6465 7263 7574 203d 206f 2e62 6f72  ordercut = o.bor
-00060270: 6465 7263 7574 2c20 6c69 6e65 7769 6474  dercut, linewidt
-00060280: 6820 3d20 6c69 6e65 7769 6474 682c 200d  h = linewidth, .
-00060290: 0a09 0909 0909 0909 0909 7761 7665 5f6e  ..........wave_n
-000602a0: 6d5f 6269 6e20 3d20 6f2e 7761 7665 5f6e  m_bin = o.wave_n
-000602b0: 6d5f 6269 6e2c 2073 7562 706c 6f74 203d  m_bin, subplot =
-000602c0: 2054 7275 652c 2063 6f6c 6f72 5f6f 6666   True, color_off
-000602d0: 7365 7420 3d20 6c65 6e28 7265 6c5f 7469  set = len(rel_ti
-000602e0: 6d65 292a 2869 2b31 2929 0d0a 0909 0909  me)*(i+1))......
-000602f0: 0909 6861 6e64 6c65 732c 206c 6162 656c  ..handles, label
-00060300: 733d 6178 2e67 6574 5f6c 6567 656e 645f  s=ax.get_legend_
-00060310: 6861 6e64 6c65 735f 6c61 6265 6c73 2829  handles_labels()
-00060320: 0d0a 0909 0909 0909 666f 7220 656e 7420  ........for ent 
-00060330: 696e 2072 656c 5f74 696d 653a 0d0a 0909  in rel_time:....
-00060340: 0909 0909 096c 6162 2e61 7070 656e 6428  .....lab.append(
-00060350: 2725 6720 2573 2725 2865 6e74 2c6f 2e62  '%g %s'%(ent,o.b
-00060360: 6173 6575 6e69 7429 202b 2027 5f27 202b  aseunit) + '_' +
-00060370: 2073 7472 286f 2e66 696c 656e 616d 6529   str(o.filename)
-00060380: 290d 0a09 0909 0909 0966 6f72 2061 2069  )........for a i
-00060390: 6e20 6861 6e64 6c65 735b 2d6c 656e 2872  n handles[-len(r
-000603a0: 656c 5f74 696d 6529 3a5d 3a0d 0a09 0909  el_time):]:.....
-000603b0: 0909 0909 6861 6e2e 6170 7065 6e64 2861  ....han.append(a
-000603c0: 290d 0a09 0909 0909 0969 6620 6461 7461  )........if data
-000603d0: 5f61 6e64 5f66 6974 3a0d 0a09 0909 0909  _and_fit:.......
-000603e0: 0909 6178 3d70 6c6f 745f 7469 6d65 286f  ..ax=plot_time(o
-000603f0: 2e64 732c 2063 6d61 7020 3d20 636f 6c6f  .ds, cmap = colo
-00060400: 7273 2c20 6178 203d 2061 782c 2072 656c  rs, ax = ax, rel
-00060410: 5f74 696d 6520 3d20 7265 6c5f 7469 6d65  _time = rel_time
-00060420: 2c20 0d0a 0909 0909 0909 0909 0974 696d  , ...........tim
-00060430: 655f 7769 6474 685f 7065 7263 656e 7420  e_width_percent 
-00060440: 3d20 7469 6d65 5f77 6964 7468 5f70 6572  = time_width_per
-00060450: 6365 6e74 2c20 7469 746c 6520 3d20 7469  cent, title = ti
-00060460: 746c 652c 206c 696e 6573 5f61 7265 203d  tle, lines_are =
-00060470: 2027 736d 6f6f 7468 6564 272c 200d 0a09   'smoothed', ...
-00060480: 0909 0909 0909 0909 7363 6174 7465 7263  ........scatterc
-00060490: 7574 203d 206f 2e73 6361 7474 6572 6375  ut = o.scattercu
-000604a0: 742c 2062 6f72 6465 7263 7574 203d 206f  t, bordercut = o
-000604b0: 2e62 6f72 6465 7263 7574 2c20 6c69 6e65  .bordercut, line
-000604c0: 7769 6474 6820 3d20 6c69 6e65 7769 6474  width = linewidt
-000604d0: 682c 200d 0a09 0909 0909 0909 0909 7761  h, ...........wa
-000604e0: 7665 5f6e 6d5f 6269 6e20 3d20 6f2e 7761  ve_nm_bin = o.wa
-000604f0: 7665 5f6e 6d5f 6269 6e2c 2073 7562 706c  ve_nm_bin, subpl
-00060500: 6f74 203d 2054 7275 652c 2063 6f6c 6f72  ot = True, color
-00060510: 5f6f 6666 7365 7420 3d20 6c65 6e28 7265  _offset = len(re
-00060520: 6c5f 7469 6d65 292a 2869 2b31 2929 0d0a  l_time)*(i+1))..
-00060530: 0909 0909 0909 0909 090d 0a09 0909 6966  ..............if
-00060540: 206e 6f74 2073 6361 6c69 6e67 5f66 6169   not scaling_fai
-00060550: 6c65 643a 0d0a 0909 0909 6178 2e73 6574  led:......ax.set
-00060560: 5f74 6974 6c65 2827 636f 6d70 6172 6520  _title('compare 
-00060570: 6d65 6173 7572 6564 2061 6e64 2073 6d6f  measured and smo
-00060580: 6f74 6865 6420 6461 7461 2061 7420 6769  othed data at gi
-00060590: 7665 6e20 7469 6d65 735c 6e20 7363 616c  ven times\n scal
-000605a0: 6564 2074 6f20 743d 2567 2070 7320 3a20  ed to t=%g ps : 
-000605b0: 2567 2070 7320 2c20 776c 3d20 2567 206e  %g ps , wl= %g n
-000605c0: 6d3a 2025 6720 6e6d 2725 286e 6f72 6d5f  m: %g nm'%(norm_
-000605d0: 7769 6e64 6f77 5b30 5d2c 6e6f 726d 5f77  window[0],norm_w
-000605e0: 696e 646f 775b 315d 2c6e 6f72 6d5f 7769  indow[1],norm_wi
-000605f0: 6e64 6f77 5b32 5d2c 6e6f 726d 5f77 696e  ndow[2],norm_win
-00060600: 646f 775b 335d 2929 0d0a 0909 0965 6c73  dow[3])).....els
-00060610: 653a 0d0a 0909 0909 6178 2e73 6574 5f74  e:......ax.set_t
-00060620: 6974 6c65 2827 636f 6d70 6172 6520 6d65  itle('compare me
-00060630: 6173 7572 6564 2061 6e64 2073 6d6f 6f74  asured and smoot
-00060640: 6865 6420 6461 7461 2061 7420 6769 7665  hed data at give
-00060650: 6e20 7469 6d65 7327 290d 0a09 0909 6178  n times').....ax
-00060660: 2e6c 6567 656e 6428 6861 6e2c 206c 6162  .legend(han, lab
-00060670: 2c20 6c61 6265 6c73 7061 6369 6e67 203d  , labelspacing =
-00060680: 2030 2c20 6e63 6f6c 203d 2032 2c20 636f   0, ncol = 2, co
-00060690: 6c75 6d6e 7370 6163 696e 6720 3d20 312c  lumnspacing = 1,
-000606a0: 2068 616e 646c 656c 656e 6774 6820 3d20   handlelength = 
-000606b0: 312c 2066 7261 6d65 6f6e 203d 2046 616c  1, frameon = Fal
-000606c0: 7365 290d 0a09 0909 6966 2073 656c 662e  se).....if self.
-000606d0: 626f 7264 6572 6375 7420 6973 204e 6f6e  bordercut is Non
-000606e0: 653a 0d0a 0909 0909 6178 2e73 6574 5f78  e:......ax.set_x
-000606f0: 6c69 6d28 7365 6c66 2e64 732e 636f 6c75  lim(self.ds.colu
-00060700: 6d6e 732e 7661 6c75 6573 5b30 5d2c 7365  mns.values[0],se
-00060710: 6c66 2e64 732e 636f 6c75 6d6e 732e 7661  lf.ds.columns.va
-00060720: 6c75 6573 5b2d 315d 290d 0a09 0909 656c  lues[-1]).....el
-00060730: 7365 3a0d 0a09 0909 0961 782e 7365 745f  se:......ax.set_
-00060740: 786c 696d 2873 656c 662e 626f 7264 6572  xlim(self.border
-00060750: 6375 7429 0d0a 0909 6966 2073 7065 6374  cut)....if spect
-00060760: 7261 2069 7320 6e6f 7420 4e6f 6e65 3a0d  ra is not None:.
-00060770: 0a09 0909 7370 6563 7472 612e 706c 6f74  ....spectra.plot
-00060780: 2861 783d 6178 2c6c 6567 656e 643d 4661  (ax=ax,legend=Fa
-00060790: 6c73 6529 0d0a 0909 0968 616e 646c 6573  lse).....handles
-000607a0: 2c20 6c61 6265 6c73 3d61 782e 6765 745f  , labels=ax.get_
-000607b0: 6c65 6765 6e64 5f68 616e 646c 6573 5f6c  legend_handles_l
-000607c0: 6162 656c 7328 290d 0a09 0909 6861 6e2e  abels().....han.
-000607d0: 6170 7065 6e64 2868 616e 646c 6573 5b2d  append(handles[-
-000607e0: 315d 290d 0a09 0909 6c61 622e 6170 7065  1]).....lab.appe
-000607f0: 6e64 286c 6162 656c 735b 2d31 5d29 0d0a  nd(labels[-1])..
-00060800: 0909 0961 782e 6c65 6765 6e64 2868 616e  ...ax.legend(han
-00060810: 2c20 6c61 6220 2c6c 6162 656c 7370 6163  , lab ,labelspac
-00060820: 696e 6720 3d20 302c 206e 636f 6c20 3d20  ing = 0, ncol = 
-00060830: 322c 2063 6f6c 756d 6e73 7061 6369 6e67  2, columnspacing
-00060840: 203d 2031 2c20 6861 6e64 6c65 6c65 6e67   = 1, handleleng
-00060850: 7468 203d 2031 2c20 6672 616d 656f 6e20  th = 1, frameon 
-00060860: 3d20 4661 6c73 6529 0d0a 0909 6966 2070  = False)....if p
-00060870: 6c6f 745f 7365 636f 6e64 5f61 735f 656e  lot_second_as_en
-00060880: 6572 6779 3a0d 0a09 0909 6178 323d 6178  ergy:.....ax2=ax
-00060890: 2e74 7769 6e79 2829 0d0a 0909 0961 7832  .twiny().....ax2
-000608a0: 2e73 6574 5f78 6c69 6d28 6178 2e67 6574  .set_xlim(ax.get
-000608b0: 5f78 6c69 6d28 2929 0d0a 0909 0961 7832  _xlim()).....ax2
-000608c0: 2e73 6574 5f78 7469 636b 7328 6178 2e67  .set_xticks(ax.g
-000608d0: 6574 5f78 7469 636b 7328 2929 0d0a 0909  et_xticks())....
-000608e0: 096c 6162 656c 733d 5b27 252e 3266 2725  .labels=['%.2f'%
-000608f0: 2873 6369 7079 2e63 6f6e 7374 616e 7473  (scipy.constants
-00060900: 2e68 2a73 6369 7079 2e63 6f6e 7374 616e  .h*scipy.constan
-00060910: 7473 2e63 2f28 612a 3165 2d39 2a73 6369  ts.c/(a*1e-9*sci
-00060920: 7079 2e63 6f6e 7374 616e 7473 2e65 6c65  py.constants.ele
-00060930: 6374 726f 6e5f 766f 6c74 2929 2066 6f72  ctron_volt)) for
-00060940: 2061 2069 6e20 6178 322e 6765 745f 7874   a in ax2.get_xt
-00060950: 6963 6b73 2829 5d0d 0a09 0909 5f3d 6178  icks()]....._=ax
-00060960: 322e 7365 745f 7874 6963 6b6c 6162 656c  2.set_xticklabel
-00060970: 7328 6c61 6265 6c73 290d 0a09 0909 5f3d  s(labels)....._=
-00060980: 6178 322e 7365 745f 786c 6162 656c 2827  ax2.set_xlabel('
-00060990: 456e 6572 6779 2069 6e20 6556 2729 0d0a  Energy in eV')..
-000609a0: 0909 0961 782e 7365 745f 7a6f 7264 6572  ...ax.set_zorder
-000609b0: 2861 7832 2e67 6574 5f7a 6f72 6465 7228  (ax2.get_zorder(
-000609c0: 292b 3129 0d0a 0909 6669 673d 706c 742e  )+1)....fig=plt.
-000609d0: 6763 6628 290d 0a09 0966 6967 2e74 6967  gcf()....fig.tig
-000609e0: 6874 5f6c 6179 6f75 7428 290d 0a09 0969  ht_layout()....i
-000609f0: 6620 7365 6c66 2e73 6176 655f 6669 6775  f self.save_figu
-00060a00: 7265 735f 746f 5f66 6f6c 6465 723a 0d0a  res_to_folder:..
-00060a10: 0909 0966 6967 2e73 6176 6566 6967 2863  ...fig.savefig(c
-00060a20: 6865 636b 5f66 6f6c 6465 7228 7061 7468  heck_folder(path
-00060a30: 3d73 656c 662e 6669 6775 7265 5f70 6174  =self.figure_pat
-00060a40: 682c 6669 6c65 6e61 6d65 3d27 636f 6d70  h,filename='comp
-00060a50: 6172 655f 6174 5f74 696d 655f 2573 2e70  are_at_time_%s.p
-00060a60: 6e67 2725 275f 272e 6a6f 696e 285b 2725  ng'%'_'.join(['%
-00060a70: 6727 2561 2066 6f72 2061 2069 6e20 7265  g'%a for a in re
-00060a80: 6c5f 7469 6d65 5d29 292c 6262 6f78 5f69  l_time])),bbox_i
-00060a90: 6e63 6865 733d 2774 6967 6874 2729 0d0a  nches='tight')..
-00060aa0: 0909 0909 0909 2020 0d0a 0d0a 0964 6566  ......  .....def
-00060ab0: 2043 6f6d 7061 7265 5f61 745f 7761 7665   Compare_at_wave
-00060ac0: 2873 656c 662c 2072 656c 5f77 6176 6520  (self, rel_wave 
-00060ad0: 3d20 4e6f 6e65 2c20 6f74 6865 7220 3d20  = None, other = 
-00060ae0: 4e6f 6e65 2c20 6669 7474 6564 203d 2046  None, fitted = F
-00060af0: 616c 7365 2c20 6e6f 726d 5f77 696e 646f  alse, norm_windo
-00060b00: 7720 3d20 4e6f 6e65 2c0d 0a09 0909 0909  w = None,.......
-00060b10: 0977 6964 7468 203d 204e 6f6e 652c 2063  .width = None, c
-00060b20: 6d61 7020 3d20 4e6f 6e65 2c20 6461 7461  map = None, data
-00060b30: 5f61 6e64 5f66 6974 203d 2046 616c 7365  _and_fit = False
-00060b40: 2c20 7363 616c 655f 7479 7065 203d 2027  , scale_type = '
-00060b50: 7379 6d6c 6f67 272c 206c 696e 6577 6964  symlog', linewid
-00060b60: 7468 203d 2031 293a 0d0a 0909 2727 2754  th = 1):....'''T
-00060b70: 6869 7320 6675 6e63 7469 6f6e 2070 6c6f  his function plo
-00060b80: 7473 206d 756c 7469 706c 6520 6b69 6e65  ts multiple kine
-00060b90: 7469 6373 2069 6e74 6f20 7468 6520 7361  tics into the sa
-00060ba0: 6d65 2066 6967 7572 6520 6174 206f 6e65  me figure at one
-00060bb0: 206f 720d 0a09 096d 756c 7469 706c 6520   or....multiple 
-00060bc0: 6769 7665 6e20 7761 7665 6c65 6e67 7468  given wavelength
-00060bd0: 2028 7265 6c5f 7761 7665 2920 616e 6420   (rel_wave) and 
-00060be0: 2061 6c6c 6f77 7320 666f 7220 0d0a 0909   allows for ....
-00060bf0: 3a72 6566 3a60 4e6f 726d 616c 697a 6174  :ref:`Normalizat
-00060c00: 696f 6e20 616e 6420 5363 616c 696e 6760  ion and Scaling`
-00060c10: 2056 6572 7920 7573 6566 756c 2074 6f20   Very useful to 
-00060c20: 636f 6d70 6172 6520 7468 6520 0d0a 0909  compare the ....
-00060c30: 6b69 6e65 7469 6373 2066 6f72 2064 6966  kinetics for dif
-00060c40: 6665 7265 6e74 2071 7565 6e63 6865 7220  ferent quencher 
-00060c50: 636f 6e63 656e 7472 6174 696f 6e73 206f  concentrations o
-00060c60: 7220 7075 6d70 2070 6f77 6572 732c 200d  r pump powers, .
-00060c70: 0a09 096f 7220 652e 672e 2064 6966 6665  ...or e.g. diffe
-00060c80: 7265 6e74 2066 6974 732e 2054 6865 2070  rent fits. The p
-00060c90: 6172 616d 6574 6572 2077 6964 7468 206f  arameter width o
-00060ca0: 7220 7468 6520 6765 6e65 7261 6c20 7365  r the general se
-00060cb0: 6c66 2e77 6176 656c 656e 6774 685f 6269  lf.wavelength_bi
-00060cc0: 6e0d 0a09 0977 6869 6368 2069 7320 7573  n....which is us
-00060cd0: 6564 2069 6620 7769 6474 6820 6973 204e  ed if width is N
-00060ce0: 6f6e 6520 2844 6566 6175 6c74 2920 6465  one (Default) de
-00060cf0: 6669 6e65 7320 7468 6520 7769 6474 6820  fines the width 
-00060d00: 6f66 0d0a 0909 7468 6520 7370 6563 7472  of....the spectr
-00060d10: 616c 2077 696e 646f 7720 7468 6174 2069  al window that i
-00060d20: 7320 696e 7465 6772 6174 6564 2061 6e64  s integrated and
-00060d30: 2073 686f 776e 2e0d 0a0d 0a09 0941 206e   shown.......A n
-00060d40: 6f72 6d61 6c69 7a61 7469 6f6e 2077 696e  ormalization win
-00060d50: 646f 7720 6361 6e20 6265 2067 6976 656e  dow can be given
-00060d60: 2061 7420 7768 6963 6820 616c 6c20 7468   at which all th
-00060d70: 6520 706c 6f74 7465 6420 6375 7276 6573  e plotted curves
-00060d80: 2061 7265 206e 6f72 6d61 6c69 7a65 6420   are normalized 
-00060d90: 746f 2e20 0d0a 0909 5468 6973 2077 696e  to. ....This win
-00060da0: 646f 7720 646f 6573 206e 6f74 2068 6176  dow does not hav
-00060db0: 6520 746f 2062 6520 696e 2074 6865 2070  e to be in the p
-00060dc0: 6c6f 7474 6564 2072 6567 696f 6e2e 2053  lotted region. S
-00060dd0: 6565 203a 7265 663a 604e 6f72 6d61 6c69  ee :ref:`Normali
-00060de0: 7a61 7469 6f6e 2061 6e64 2053 6361 6c69  zation and Scali
-00060df0: 6e67 600d 0a09 090d 0a09 0950 6172 616d  ng`........Param
-00060e00: 6574 6572 730d 0a09 092d 2d2d 2d2d 2d2d  eters....-------
-00060e10: 2d2d 2d2d 2d2d 2d0d 0a09 090d 0a09 0972  -------........r
-00060e20: 656c 5f77 6176 6520 3a20 666c 6f61 7420  el_wave : float 
-00060e30: 6f72 206c 6973 742f 7665 6374 6f72 2028  or list/vector (
-00060e40: 6f66 2066 6c6f 6174 7329 0d0a 0909 0953  of floats).....S
-00060e50: 7065 6369 6679 2074 6865 2077 6176 656c  pecify the wavel
-00060e60: 656e 6774 6820 7768 6572 6520 746f 2070  ength where to p
-00060e70: 6c6f 7420 7468 6520 6b69 6e65 7469 6373  lot the kinetics
-00060e80: 2c20 7369 6e67 6c65 2076 616c 7565 206f  , single value o
-00060e90: 720d 0a09 0909 6c69 7374 2f76 6563 746f  r.....list/vecto
-00060ea0: 7220 6f66 2076 616c 7565 7320 286f 6e6c  r of values (onl
-00060eb0: 7920 6d61 6e64 6174 6f72 7920 656e 7472  y mandatory entr
-00060ec0: 7929 2046 6f72 2065 6163 6820 656e 7472  y) For each entr
-00060ed0: 7920 696e 200d 0a09 0909 7265 6c5f 7761  y in .....rel_wa
-00060ee0: 7665 2061 206b 696e 6574 6963 2069 7320  ve a kinetic is 
-00060ef0: 706c 6f74 7465 642e 2027 7265 6c5f 7761  plotted. 'rel_wa
-00060f00: 7665 2720 616e 6420 2777 6964 7468 2720  ve' and 'width' 
-00060f10: 0d0a 0909 0928 696e 2074 6865 206f 626a  .....(in the obj
-00060f20: 6563 7420 6361 6c6c 6564 2027 7761 7665  ect called 'wave
-00060f30: 6c65 6e67 7468 5f62 696e 2720 776f 726b  length_bin' work
-00060f40: 2074 6f67 6574 6865 7220 666f 7220 7468   together for th
-00060f50: 6520 6372 6561 7469 6f6e 200d 0a09 0909  e creation .....
-00060f60: 6f66 206b 696e 6574 6963 2070 6c6f 7473  of kinetic plots
-00060f70: 2e20 4174 2065 6163 6820 7365 6c65 6374  . At each select
-00060f80: 6564 2077 6176 656c 656e 6774 6820 7468  ed wavelength th
-00060f90: 6520 6461 7461 2062 6574 7765 656e 200d  e data between .
-00060fa0: 0a09 0909 7761 7665 6c65 6e67 7468 2b77  ....wavelength+w
-00060fb0: 6964 7468 2f32 2061 6e64 2077 6176 656c  idth/2 and wavel
-00060fc0: 656e 6774 682d 7769 6474 682f 3220 6973  ength-width/2 is
-00060fd0: 2061 7665 7261 6765 6420 0d0a 0909 0966   averaged .....f
-00060fe0: 6f72 2065 6163 6820 7469 6d65 706f 696e  or each timepoin
-00060ff0: 740d 0a09 0909 0d0a 0909 6f74 6865 7220  t.........other 
-00061000: 3a20 5441 206f 626a 6563 7420 6f72 206c  : TA object or l
-00061010: 6973 7420 6f66 2074 686f 7365 2c20 6f70  ist of those, op
-00061020: 7469 6f6e 616c 200d 0a09 0909 7368 6f75  tional .....shou
-00061030: 6c64 2062 6520 7461 2e70 6c6f 745f 6675  ld be ta.plot_fu
-00061040: 6e63 206f 626a 6563 7473 2028 6c6f 6164  nc objects (load
-00061050: 6564 206f 7220 636f 7069 6564 2920 616e  ed or copied) an
-00061060: 6420 6973 2077 6861 7420 0d0a 0909 0969  d is what .....i
-00061070: 7320 706c 6f74 7465 6420 6167 6169 6e73  s plotted agains
-00061080: 7420 7468 6520 6461 7461 2075 7365 2061  t the data use a
-00061090: 206c 6973 7420 5b74 6131 2c74 6132 2c2e   list [ta1,ta2,.
-000610a0: 2e2e 205d 206f 7220 6765 6e65 7261 7465  .. ] or generate
-000610b0: 2074 6869 730d 0a09 0909 6c69 7374 2075   this.....list u
-000610c0: 7369 6e67 2074 6865 2047 7569 2066 756e  sing the Gui fun
-000610d0: 6374 696f 6e2e 2053 6565 2073 6563 7469  ction. See secti
-000610e0: 6f6e 203a 7265 663a 604f 7065 6e69 6e67  on :ref:`Opening
-000610f0: 206d 756c 7469 706c 6520 6669 6c65 7360   multiple files`
-00061100: 2069 6e20 0d0a 0909 0974 6865 2064 6f63   in .....the doc
-00061110: 756d 656e 7461 7469 6f6e 0d0a 0d0a 0909  umentation......
-00061120: 6669 7474 6564 203a 2062 6f6f 6c2c 206f  fitted : bool, o
-00061130: 7074 696f 6e61 6c0d 0a09 0909 5472 7565  ptional.....True
-00061140: 2f46 616c 7365 2028 4465 6661 756c 7429  /False (Default)
-00061150: 202d 2075 7365 2066 6974 7465 6420 6461   - use fitted da
-00061160: 7461 2069 6e73 7465 6164 206f 6620 7261  ta instead of ra
-00061170: 7720 6461 7461 2e20 0d0a 0909 0949 6620  w data. .....If 
-00061180: 5472 7565 2c20 7468 6520 6669 7474 6564  True, the fitted
-00061190: 2064 6174 6170 6f69 6e74 7320 2877 6974   datapoints (wit
-000611a0: 686f 7574 2069 6e74 6572 706f 6c61 7469  hout interpolati
-000611b0: 6f6e 2920 6172 6520 7573 6564 2e20 0d0a  on) are used. ..
-000611c0: 0909 0954 6869 7320 6973 2069 6e74 656e  ...This is inten
-000611d0: 6465 6420 666f 7220 636f 6d70 6172 696e  ded for comparin
-000611e0: 6720 652e 672e 2064 6966 6665 7265 6e74  g e.g. different
-000611f0: 2066 6974 730d 0a0d 0a09 096e 6f72 6d5f   fits......norm_
-00061200: 7769 6e64 6f77 203a 204e 6f6e 6520 6f72  window : None or
-00061210: 206c 6973 742f 7665 6374 6f72 2028 7769   list/vector (wi
-00061220: 7468 2034 2066 6c6f 6174 7329 2c20 6f70  th 4 floats), op
-00061230: 7469 6f6e 616c 0d0a 0909 096e 6f72 6d5f  tional.....norm_
-00061240: 7769 6e64 6f77 2047 6976 6520 6120 6c69  window Give a li
-00061250: 7374 2f74 7570 656c 2f76 6563 746f 7220  st/tupel/vector 
-00061260: 7769 7468 2034 2065 6e74 7269 6573 2069  with 4 entries i
-00061270: 6e20 7468 6520 6f72 6465 7220 0d0a 0909  n the order ....
-00061280: 095b 5374 6172 7420 2d20 7469 6d65 2c20  .[Start - time, 
-00061290: 456e 6420 2d20 7469 6d65 2c20 5374 6172  End - time, Star
-000612a0: 7420 2d20 7761 7665 6c65 6e67 7468 2c20  t - wavelength, 
-000612b0: 456e 6420 2d20 5761 7665 6c65 6e67 7468  End - Wavelength
-000612c0: 5d2c 200d 0a09 0909 7365 6520 7365 6374  ], .....see sect
-000612d0: 696f 6e20 3a72 6566 3a60 4e6f 726d 616c  ion :ref:`Normal
-000612e0: 697a 6174 696f 6e20 616e 6420 5363 616c  ization and Scal
-000612f0: 696e 6760 2069 6e20 7468 6520 646f 6375  ing` in the docu
-00061300: 6d65 6e74 6174 696f 6e2e 0d0a 0909 0949  mentation......I
-00061310: 6620 4e6f 6e65 2028 4465 6661 756c 7429  f None (Default)
-00061320: 206e 6f20 6e6f 726d 616c 697a 6174 696f   no normalizatio
-00061330: 6e20 6973 2064 6f6e 652e 0d0a 0d0a 0909  n is done.......
-00061340: 7769 6474 680d 0a09 0920 2020 5370 6563  width....   Spec
-00061350: 6966 7920 7468 6520 7769 6474 6820 6162  ify the width ab
-00061360: 6f76 6520 616e 6420 6265 6c6f 7720 7468  ove and below th
-00061370: 6520 6769 7665 6e20 7761 7665 6c65 6e67  e given waveleng
-00061380: 7468 2074 6861 7420 6973 0d0a 0909 2020  th that is....  
-00061390: 2069 6e74 6567 7261 7465 6420 6173 2077   integrated as w
-000613a0: 696e 646f 772e 2049 6620 6c65 6674 2074  indow. If left t
-000613b0: 6f20 2844 6566 6175 6c74 2920 224e 6f6e  o (Default) "Non
-000613c0: 6522 2074 6865 2076 616c 7565 2066 726f  e" the value fro
-000613d0: 6d20 7461 2069 730d 0a09 0920 2020 7573  m ta is....   us
-000613e0: 6564 2e0d 0a0d 0a09 0964 6174 615f 616e  ed.......data_an
-000613f0: 645f 6669 7420 3a20 626f 6f6c 2c20 6f70  d_fit : bool, op
-00061400: 7469 6f6e 616c 0d0a 0909 0954 7275 6520  tional.....True 
-00061410: 6f72 2046 616c 7365 2028 4465 6661 756c  or False (Defaul
-00061420: 7429 2c20 6368 6f6f 7365 2069 6620 666f  t), choose if fo
-00061430: 7220 7468 6520 4669 7474 6564 2070 6c6f  r the Fitted plo
-00061440: 7420 7468 6520 7261 7720 6461 7461 206f  t the raw data o
-00061450: 6620 7468 6520 0d0a 0909 096f 7468 6572  f the .....other
-00061460: 2070 726f 6a65 6374 7320 6973 2074 6f20   projects is to 
-00061470: 6265 2070 6c6f 7474 696e 6720 696e 2061  be plotting in a
-00061480: 6464 6974 696f 6e20 746f 2074 6865 2066  ddition to the f
-00061490: 6974 7465 6420 6c69 6e65 2e20 466f 7220  itted line. For 
-000614a0: 4661 6c73 6520 2844 6566 6175 6c74 290d  False (Default).
-000614b0: 0a09 0909 4f6e 6c79 2074 6865 2066 6974  ....Only the fit
-000614c0: 2069 7320 706c 6f74 7465 642e 0d0a 0909   is plotted.....
-000614d0: 090d 0a09 096c 696e 6577 6964 7468 203a  .....linewidth :
-000614e0: 2066 6c6f 6174 2c20 6f70 7469 6f6e 616c   float, optional
-000614f0: 0d0a 0909 096c 696e 6577 6964 7468 2074  .....linewidth t
-00061500: 6f20 6265 2075 7365 6420 666f 7220 706c  o be used for pl
-00061510: 6f74 7469 6e67 0d0a 0909 0909 0d0a 0909  otting..........
-00061520: 636d 6170 203a 204e 6f6e 6520 6f72 206d  cmap : None or m
-00061530: 6174 706c 6f74 6c69 6220 636f 6c6f 7220  atplotlib color 
-00061540: 6d61 702c 206f 7074 696f 6e61 6c0d 0a09  map, optional...
-00061550: 0909 6973 2061 2070 6f77 6572 6675 6c6c  ..is a powerfull
-00061560: 2076 6172 6961 626c 6520 7468 6174 2063   variable that c
-00061570: 686f 6f73 6573 2074 6865 2063 6f6c 6f75  hooses the colou
-00061580: 7220 6d61 7020 6170 706c 6965 6420 666f  r map applied fo
-00061590: 7220 616c 6c20 706c 6f74 732e 2049 6620  r all plots. If 
-000615a0: 7365 7420 746f 200d 0a09 0909 4e6f 6e65  set to .....None
-000615b0: 2028 4465 6661 756c 7429 2074 6865 6e20   (Default) then 
-000615c0: 7468 6520 7365 6c66 2e63 6d61 7020 6973  the self.cmap is
-000615d0: 2075 7365 642e 0d0a 0909 0941 7320 7374   used......As st
-000615e0: 616e 6461 7264 2049 2075 7365 2074 6865  andard I use the
-000615f0: 2063 6f6c 6f72 206d 6170 2022 6a65 7422   color map "jet"
-00061600: 2066 726f 6d20 6d61 7470 6c6f 746c 6962   from matplotlib
-00061610: 2e20 5468 6572 6520 6172 6520 6120 7661  . There are a va
-00061620: 7269 6574 7920 6f66 2063 6f6c 6f72 6d61  riety of colorma
-00061630: 7073 200d 0a09 0909 6176 6169 6c61 626c  ps .....availabl
-00061640: 6520 7468 6174 2061 7265 2076 6572 7920  e that are very 
-00061650: 7573 6566 756c 6c2e 2042 6573 6964 6520  usefull. Beside 
-00061660: 226a 6574 222c 2022 7669 7269 6469 7322  "jet", "viridis"
-00061670: 2069 7320 6120 676f 6f64 2063 686f 6963   is a good choic
-00061680: 6520 6173 2069 7420 6973 2077 656c 6c20  e as it is well 
-00061690: 0d0a 0909 0976 6973 6962 6c65 2075 6e64  .....visible und
-000616a0: 6572 2072 6564 2d67 7265 656e 2062 6c69  er red-green bli
-000616b0: 6e64 6e65 7373 2e20 4f74 6865 7220 7573  ndness. Other us
-000616c0: 6566 756c 206d 6170 7320 6172 6520 2270  eful maps are "p
-000616d0: 7269 736d 2220 666f 7220 6869 6768 2066  rism" for high f
-000616e0: 6c75 6374 7561 7469 6f6e 7320 0d0a 0909  luctuations ....
-000616f0: 096f 7220 6469 7665 7267 696e 6720 636f  .or diverging co
-00061700: 6c6f 7220 6d61 7073 206c 696b 6520 2273  lor maps like "s
-00061710: 6569 736d 6963 222e 200d 0a09 0909 5365  eismic". .....Se
-00061720: 6520 6874 7470 733a 2f2f 6d61 7470 6c6f  e https://matplo
-00061730: 746c 6962 2e6f 7267 2f33 2e31 2e30 2f74  tlib.org/3.1.0/t
-00061740: 7574 6f72 6961 6c73 2f63 6f6c 6f72 732f  utorials/colors/
-00061750: 636f 6c6f 726d 6170 732e 6874 6d6c 2066  colormaps.html f
-00061760: 6f72 2061 2063 6f6d 7072 6568 656e 7369  or a comprehensi
-00061770: 7665 200d 0a09 0909 7365 6c65 6374 696f  ve .....selectio
-00061780: 6e2e 2049 6e20 7468 6520 636f 6465 2074  n. In the code t
-00061790: 6865 2063 6f6c 6f72 6d61 7073 2061 7265  he colormaps are
-000617a0: 2069 6d70 6f72 7465 6420 736f 2069 6620   imported so if 
-000617b0: 706c 6f74 5f66 756e 6320 6973 2069 6d70  plot_func is imp
-000617c0: 6f72 7465 6420 6173 2070 6620 7468 656e  orted as pf then
-000617d0: 200d 0a09 0909 7365 6c66 2e63 6d61 703d   .....self.cmap=
-000617e0: 7066 2e63 6d2e 7669 7269 6469 7320 7365  pf.cm.viridis se
-000617f0: 7473 2076 6972 6964 6973 2061 7320 7468  ts viridis as th
-00061800: 6520 6d61 7020 746f 2075 7365 2e20 496e  e map to use. In
-00061810: 7465 726e 616c 6c79 2074 6865 2063 6f6c  ternally the col
-00061820: 6f72 7320 6172 6520 6368 6f73 656e 200d  ors are chosen .
-00061830: 0a09 0909 7769 7468 2074 6865 2022 636f  ....with the "co
-00061840: 6c6d 2220 6675 6e63 7469 6f6e 2e20 5468  lm" function. Th
-00061850: 6520 3264 2070 6c6f 7473 2072 6571 7569  e 2d plots requi
-00061860: 7265 2061 2063 6f6e 7469 6e75 6f75 7320  re a continuous 
-00061870: 636f 6c6f 7220 6d61 7020 736f 2069 6620  color map so if 
-00061880: 736f 6d65 7468 696e 6720 0d0a 0909 0965  something .....e
-00061890: 6c73 6520 6973 2067 6976 6520 3264 2070  lse is give 2d p
-000618a0: 6c6f 7473 2061 7265 2073 686f 776e 2061  lots are shown a
-000618b0: 7574 6f6d 6174 6963 616c 6c79 2077 6974  utomatically wit
-000618c0: 6820 226a 6574 222e 2046 6f72 2061 6c6c  h "jet". For all
-000618d0: 206f 6620 7468 6520 3164 2070 6c6f 7473   of the 1d plots
-000618e0: 2068 6f77 6576 6572 200d 0a09 0909 4920   however .....I 
-000618f0: 6669 7273 7420 7365 6c65 6374 2061 206e  first select a n
-00061900: 756d 6265 7220 6f66 2063 6f6c 6f72 7320  umber of colors 
-00061910: 6265 666f 7265 2065 6163 6820 706c 6f74  before each plot
-00061920: 2e20 4966 2063 6d61 7020 6973 2061 2063  . If cmap is a c
-00061930: 6f6e 7469 6e6f 7573 206d 6170 2074 6865  ontinous map the
-00061940: 6e20 7468 6573 650d 0a09 0909 6172 6520  n these.....are 
-00061950: 7361 6d70 6c65 6420 6576 656e 6c79 206f  sampled evenly o
-00061960: 7665 7220 7468 6520 636f 6c6f 7572 6d61  ver the colourma
-00061970: 702e 204d 616e 7561 6c20 6974 6572 6162  p. Manual iterab
-00061980: 6c65 7320 6f66 2063 6f6c 6f75 7273 200d  les of colours .
-00061990: 0a09 0909 636d 6170 3d5b 2831 2c30 2c30  ....cmap=[(1,0,0
-000619a0: 292c 2830 2c31 2c30 292c 2830 2c30 2c31  ),(0,1,0),(0,0,1
-000619b0: 292c 2e2e 2e5d 2061 7265 2061 6c73 6f20  ),...] are also 
-000619c0: 6163 6365 7074 6564 2c20 6173 2061 7265  accepted, as are
-000619d0: 2076 6563 746f 7273 206f 7220 6461 7461   vectors or data
-000619e0: 6672 616d 6573 2074 6861 7420 0d0a 0909  frames that ....
-000619f0: 0963 6f6e 7461 696e 2061 7320 726f 7773  .contain as rows
-00061a00: 2074 6865 2063 6f6c 6f72 732e 2054 6865   the colors. The
-00061a10: 7265 206d 7573 7420 6265 206f 6620 636f  re must be of co
-00061a20: 7572 7365 2073 7566 6669 6369 656e 7420  urse sufficient 
-00061a30: 636f 6c6f 7273 2070 7265 7365 6e74 2066  colors present f
-00061a40: 6f72 200d 0a09 0909 7468 6520 6e75 6d62  or .....the numb
-00061a50: 6572 7320 6f66 206c 696e 6573 2074 6861  ers of lines tha
-00061a60: 7420 7769 6c6c 2062 6520 706c 6f74 7465  t will be plotte
-00061a70: 642e 2053 6f20 4920 7265 636f 6d6d 656e  d. So I recommen
-00061a80: 6420 746f 2070 726f 7669 6465 2061 7420  d to provide at 
-00061a90: 6c65 6173 7420 3130 2063 6f6c 6f75 7273  least 10 colours
-00061aa0: 200d 0a09 0909 2865 2e67 2e7e 796f 7572   .....(e.g.~your
-00061ab0: 2075 6e69 7665 7273 6974 7920 636f 6c6f   university colo
-00061ac0: 7273 292e 2063 6f6c 6f75 7273 2061 7265  rs). colours are
-00061ad0: 2061 6c77 6179 7320 6769 7665 6e20 6173   always given as
-00061ae0: 2061 2c20 6c69 7374 206f 7220 7475 706c   a, list or tupl
-00061af0: 6520 7769 7468 2052 4741 206f 7220 5247  e with RGA or RG
-00061b00: 4241 0d0a 0909 0928 7769 7468 2074 6865  BA.....(with the
-00061b10: 206c 6173 7420 4120 6265 6569 6e67 2074   last A beeing t
-00061b20: 6865 2041 6c70 6861 3d74 7261 6e73 7061  he Alpha=transpa
-00061b30: 7265 6e63 792e 2041 6c6c 206e 756d 6265  rency. All numbe
-00061b40: 7273 2061 7265 2062 6574 7765 656e 2030  rs are between 0
-00061b50: 2061 6e64 2031 2e20 0d0a 0909 0949 6620   and 1. .....If 
-00061b60: 6120 6c69 7374 2f76 6563 746f 722f 4461  a list/vector/Da
-00061b70: 7461 4672 616d 6520 6973 2067 6976 656e  taFrame is given
-00061b80: 2066 6f72 2074 6865 2063 6f6c 6f75 7273   for the colours
-00061b90: 2074 6865 7920 7769 6c6c 2062 6520 7573   they will be us
-00061ba0: 6564 2069 6e20 7468 6520 6f72 6465 7220  ed in the order 
-00061bb0: 7072 6f76 6964 6564 2e0d 0a09 090d 0a09  provided........
-00061bc0: 0953 6361 6c65 5f74 7970 6520 3a20 4e6f  .Scale_type : No
-00061bd0: 6e65 206f 7220 7374 720d 0a09 0909 6973  ne or str.....is
-00061be0: 2061 2067 656e 6572 616c 2073 6574 7469   a general setti
-00061bf0: 6e67 2074 6861 7420 6361 6e20 696e 666c  ng that can infl
-00061c00: 7565 6e63 6573 2077 6861 7420 7469 6d65  uences what time
-00061c10: 2061 7869 7320 7769 6c6c 2062 6520 7573   axis will be us
-00061c20: 6564 2066 6f72 2074 6865 2070 6c6f 7473  ed for the plots
-00061c30: 2e20 0d0a 0909 0922 7379 6d6c 6f67 2220  . ....."symlog" 
-00061c40: 286c 696e 6561 7220 6172 6f75 6e64 207a  (linear around z
-00061c50: 6572 6f20 616e 6420 6c6f 6761 7269 7468  ero and logarith
-00061c60: 6d69 6320 6f74 6865 7277 6973 6529 2022  mic otherwise) "
-00061c70: 6c69 6e22 2061 6e64 2022 6c6f 6722 2061  lin" and "log" a
-00061c80: 7265 2076 616c 6964 206f 7074 696f 6e73  re valid options
-00061c90: 2e09 0d0a 0909 0909 090d 0a09 0945 7861  .............Exa
-00061ca0: 6d70 6c65 730d 0a09 092d 2d2d 2d2d 2d2d  mples....-------
-00061cb0: 2d0d 0a09 090d 0a09 093e 3e3e 2069 6d70  -........>>> imp
-00061cc0: 6f72 7420 706c 6f74 5f66 756e 6320 6173  ort plot_func as
-00061cd0: 2070 660d 0a09 093e 3e3e 2074 6120 3d20   pf....>>> ta = 
-00061ce0: 7066 2e54 4128 2774 6573 7431 2e68 6466  pf.TA('test1.hdf
-00061cf0: 3527 2920 236f 7065 6e20 7468 6520 6f72  5') #open the or
-00061d00: 6967 696e 616c 2070 726f 6a65 6374 0d0a  iginal project..
-00061d10: 0909 0d0a 0909 4e6f 7720 6f70 656e 2061  ......Now open a
-00061d20: 2062 756e 6368 206f 6620 6f74 6865 7220   bunch of other 
-00061d30: 7072 6f6a 6563 7473 2074 6f20 636f 6d70  projects to comp
-00061d40: 6172 6520 6167 6169 6e73 740d 0a09 090d  are against.....
-00061d50: 0a09 093e 3e3e 206f 7468 6572 5f70 726f  ...>>> other_pro
-00061d60: 6a65 6374 7320 3d20 7066 2e47 5549 5f6f  jects = pf.GUI_o
-00061d70: 7065 6e28 7072 6f6a 6563 745f 6c69 7374  pen(project_list
-00061d80: 203d 205b 2766 696c 6531 2e53 4941 272c   = ['file1.SIA',
-00061d90: 2027 6669 6c65 322e 5349 4127 5d29 0d0a   'file2.SIA'])..
-00061da0: 0909 0d0a 0909 5479 7069 6361 6c20 7573  ......Typical us
-00061db0: 653a 0d0a 0909 436f 6d70 6172 6520 7468  e:....Compare th
-00061dc0: 6520 7261 7720 6461 7461 2077 6974 686f  e raw data witho
-00061dd0: 7574 206e 6f72 6d61 6c69 7a61 7469 6f6e  ut normalization
-00061de0: 2061 7420 3430 3020 6e6d 2061 6e64 2035   at 400 nm and 5
-00061df0: 3030 206e 6d0d 0a09 090d 0a09 093e 3e3e  00 nm........>>>
-00061e00: 2074 612e 436f 6d70 6172 655f 6174 5f77   ta.Compare_at_w
-00061e10: 6176 6528 7265 6c5f 7761 7665 203d 205b  ave(rel_wave = [
-00061e20: 3430 302c 2035 3030 5d2c 206f 7468 6572  400, 500], other
-00061e30: 7320 3d20 6f74 6865 725f 7072 6f6a 6563  s = other_projec
-00061e40: 7429 0d0a 0909 0d0a 0909 436f 6d70 6172  t)........Compar
-00061e50: 6520 7468 6520 7175 616c 6974 7920 6f66  e the quality of
-00061e60: 2074 6865 2066 6974 2064 6174 6120 7769   the fit data wi
-00061e70: 7468 6f75 7420 6e6f 726d 616c 697a 6174  thout normalizat
-00061e80: 696f 6e20 6174 2034 3030 206e 6d20 616e  ion at 400 nm an
-00061e90: 6420 3530 3020 6e6d 0d0a 0909 0d0a 0909  d 500 nm........
-00061ea0: 3e3e 3e20 7461 2e43 6f6d 7061 7265 5f61  >>> ta.Compare_a
-00061eb0: 745f 7761 7665 2872 656c 5f77 6176 6520  t_wave(rel_wave 
-00061ec0: 3d20 5b34 3030 2c20 3530 305d 2c20 6f74  = [400, 500], ot
-00061ed0: 6865 7273 203d 206f 7468 6572 5f70 726f  hers = other_pro
-00061ee0: 6a65 6374 2c20 6669 7474 6564 203d 2054  ject, fitted = T
-00061ef0: 7275 6529 0d0a 0909 0d0a 0909 436f 6d70  rue)........Comp
-00061f00: 6172 6520 7769 7468 206e 6f72 6d61 6c69  are with normali
-00061f10: 7a61 7469 6f6e 2077 696e 646f 7720 6265  zation window be
-00061f20: 7477 6565 6e20 3170 7320 616e 6420 3270  tween 1ps and 2p
-00061f30: 7320 616e 6420 3430 306e 6d20 616e 6420  s and 400nm and 
-00061f40: 3435 306e 6d0d 0a09 090d 0a09 093e 3e3e  450nm........>>>
-00061f50: 206e 6f72 6d5f 7769 6e64 6f77 3d5b 312c   norm_window=[1,
-00061f60: 322c 3430 302c 3435 305d 0d0a 0909 3e3e  2,400,450]....>>
-00061f70: 3e20 7461 2e43 6f6d 7061 7265 5f61 745f  > ta.Compare_at_
-00061f80: 7761 7665 2872 656c 5f77 6176 6520 3d20  wave(rel_wave = 
-00061f90: 5b34 3030 2c20 3530 305d 2c20 6f74 6865  [400, 500], othe
-00061fa0: 7273 203d 206f 7468 6572 5f70 726f 6a65  rs = other_proje
-00061fb0: 6374 2c20 6e6f 726d 5f77 696e 646f 7720  ct, norm_window 
-00061fc0: 3d20 6e6f 726d 5f77 696e 646f 7729 0d0a  = norm_window)..
-00061fd0: 0909 0d0a 0909 5573 6520 6578 616d 706c  ......Use exampl
-00061fe0: 653a 204f 6674 656e 2074 6865 7265 2061  e: Often there a
-00061ff0: 7265 2061 206c 6f74 206f 6620 6469 6666  re a lot of diff
-00062000: 6572 656e 7420 6d65 6173 7572 656d 656e  erent measuremen
-00062010: 7473 2074 6f20 0d0a 0909 636f 6d70 6172  ts to ....compar
-00062020: 6520 6174 206d 756c 7469 706c 6520 7761  e at multiple wa
-00062030: 7665 6c65 6e67 7468 2e20 5468 6520 6e6f  velength. The no
-00062040: 726d 6c69 7a61 7469 6f6e 2069 7320 7065  rmlization is pe
-00062050: 7266 6f72 6d65 6420 6174 2074 6865 2067  rformed at the g
-00062060: 726f 756e 6420 7374 6174 6520 626c 6561  round state blea
-00062070: 6368 0d0a 0909 3436 3020 6e6d 2061 6e64  ch....460 nm and
-00062080: 2065 6172 6c79 2069 6e20 7469 6d65 2e20   early in time. 
-00062090: 5468 656e 2069 7420 6973 2062 6574 7465  Then it is bette
-000620a0: 7220 746f 206d 616b 6520 6120 6e65 7720  r to make a new 
-000620b0: 706c 6f74 2066 6f72 2065 6163 6820 0d0a  plot for each ..
-000620c0: 0909 7761 7665 6c65 6e67 7468 2e20 5468  ..wavelength. Th
-000620d0: 6520 6e6f 726d 616c 697a 6174 696f 6e20  e normalization 
-000620e0: 7769 6e64 6f77 2073 7461 7973 2066 6978  window stays fix
-000620f0: 6564 2e0d 0a09 090d 0a09 093e 3e3e 2070  ed.........>>> p
-00062100: 6c74 2e63 6c6f 7365 2827 616c 6c27 2920  lt.close('all') 
-00062110: 236d 616b 6520 736f 6d65 2073 7061 6365  #make some space
-00062120: 0d0a 0909 3e3e 3e20 6e6f 726d 5f77 696e  ....>>> norm_win
-00062130: 646f 773d 5b30 2e33 2c30 2e35 2c34 3530  dow=[0.3,0.5,450
-00062140: 2c34 3730 5d20 2364 6566 696e 6520 7769  ,470] #define wi
-00062150: 6e64 6f77 2069 6e20 6772 6f75 6e64 2073  ndow in ground s
-00062160: 7461 7465 2062 6c65 6163 680d 0a09 093e  tate bleach....>
-00062170: 3e3e 2066 6f72 2077 6176 6520 696e 205b  >> for wave in [
-00062180: 3330 302c 3430 302c 3530 302c 3630 302c  300,400,500,600,
-00062190: 3730 305d 3a20 2369 7465 7261 7465 206f  700]: #iterate o
-000621a0: 7665 7220 7468 6520 7761 7665 6c65 6e67  ver the waveleng
-000621b0: 7468 200d 0a09 093e 3e3e 2009 7461 2e43  th ....>>> .ta.C
-000621c0: 6f6d 7061 7265 5f61 745f 7761 7665 2872  ompare_at_wave(r
-000621d0: 656c 5f77 6176 6520 3d20 7761 7665 2c20  el_wave = wave, 
-000621e0: 6f74 6865 7273 203d 206f 7468 6572 5f70  others = other_p
-000621f0: 726f 6a65 6374 2c20 6e6f 726d 5f77 696e  roject, norm_win
-00062200: 646f 7720 3d20 6e6f 726d 5f77 696e 646f  dow = norm_windo
-00062210: 7729 0d0a 0909 0d0a 0909 2727 2709 0d0a  w)........'''...
-00062220: 0909 0d0a 0909 6966 2073 656c 662e 7361  ......if self.sa
-00062230: 7665 5f66 6967 7572 6573 5f74 6f5f 666f  ve_figures_to_fo
-00062240: 6c64 6572 3a73 656c 662e 6669 6775 7265  lder:self.figure
-00062250: 5f70 6174 683d 6368 6563 6b5f 666f 6c64  _path=check_fold
-00062260: 6572 2870 6174 683d 2772 6573 756c 745f  er(path='result_
-00062270: 6669 6775 7265 7327 2c63 7572 7265 6e74  figures',current
-00062280: 5f70 6174 683d 7365 6c66 2e70 6174 6829  _path=self.path)
-00062290: 0d0a 0909 6966 2077 6964 7468 2069 7320  ....if width is 
-000622a0: 4e6f 6e65 3a77 6964 7468 3d73 656c 662e  None:width=self.
-000622b0: 7761 7665 6c65 6e67 7468 5f62 696e 0d0a  wavelength_bin..
-000622c0: 0909 6966 2072 656c 5f77 6176 6520 6973  ..if rel_wave is
-000622d0: 204e 6f6e 653a 0d0a 0909 0972 656c 5f77   None:.....rel_w
-000622e0: 6176 653d 7365 6c66 2e72 656c 5f77 6176  ave=self.rel_wav
-000622f0: 650d 0a09 0969 6620 6f74 6865 7220 6973  e....if other is
-00062300: 206e 6f74 204e 6f6e 653a 0d0a 0909 0969   not None:.....i
-00062310: 6620 6e6f 7420 6861 7361 7474 7228 6f74  f not hasattr(ot
-00062320: 6865 722c 275f 5f69 7465 725f 5f27 293a  her,'__iter__'):
-00062330: 6f74 6865 723d 5b6f 7468 6572 5d0d 0a09  other=[other]...
-00062340: 0969 6620 6e6f 7420 6861 7361 7474 7228  .if not hasattr(
-00062350: 7265 6c5f 7761 7665 2c27 5f5f 6974 6572  rel_wave,'__iter
-00062360: 5f5f 2729 3a0d 0a09 0909 7265 6c5f 7761  __'):.....rel_wa
-00062370: 7665 3d5b 7265 6c5f 7761 7665 5d0d 0a09  ve=[rel_wave]...
-00062380: 0969 6620 636d 6170 2069 7320 4e6f 6e65  .if cmap is None
-00062390: 3a63 6d61 703d 7365 6c66 2e63 6d61 700d  :cmap=self.cmap.
-000623a0: 0a09 0969 6620 6669 7474 6564 3a0d 0a09  ...if fitted:...
-000623b0: 0909 7472 793a 0d0a 0909 0909 7265 3d73  ..try:......re=s
-000623c0: 656c 662e 7265 0d0a 0909 0965 7863 6570  elf.re.....excep
-000623d0: 743a 0d0a 0909 0909 7072 696e 7428 224e  t:......print("N
-000623e0: 6f20 6669 7474 6564 2072 6573 756c 7473  o fitted results
-000623f0: 2070 7265 7365 6e74 2229 0d0a 0909 0909   present")......
-00062400: 7265 7475 726e 2046 616c 7365 0d0a 0909  return False....
-00062410: 0969 6620 6e6f 726d 5f77 696e 646f 7720  .if norm_window 
-00062420: 6973 206e 6f74 204e 6f6e 653a 0d0a 0909  is not None:....
-00062430: 0909 7265 665f 7363 616c 6520 3d20 7265  ..ref_scale = re
-00062440: 5b27 4127 5d2e 6c6f 635b 6e6f 726d 5f77  ['A'].loc[norm_w
-00062450: 696e 646f 775b 305d 3a6e 6f72 6d5f 7769  indow[0]:norm_wi
-00062460: 6e64 6f77 5b31 5d2c 206e 6f72 6d5f 7769  ndow[1], norm_wi
-00062470: 6e64 6f77 5b32 5d3a 6e6f 726d 5f77 696e  ndow[2]:norm_win
-00062480: 646f 775b 335d 5d2e 6d65 616e 2829 2e6d  dow[3]].mean().m
-00062490: 6561 6e28 290d 0a09 0909 6669 672c 2061  ean().....fig, a
-000624a0: 7820 3d20 706c 742e 7375 6270 6c6f 7473  x = plt.subplots
-000624b0: 2866 6967 7369 7a65 203d 2028 3130 2c20  (figsize = (10, 
-000624c0: 3629 2c20 6470 6920 3d20 3130 3029 0d0a  6), dpi = 100)..
-000624d0: 0909 0963 6f6c 6f72 7320 3d20 636f 6c6d  ...colors = colm
-000624e0: 2863 6d61 7020 3d20 636d 6170 2c20 6b20  (cmap = cmap, k 
-000624f0: 3d20 7261 6e67 6528 6c65 6e28 7265 6c5f  = range(len(rel_
-00062500: 7761 7665 292a 2832 2b6c 656e 286f 7468  wave)*(2+len(oth
-00062510: 6572 2929 2929 0d0a 0909 0961 7820 3d20  er)))).....ax = 
-00062520: 706c 6f74 3164 2872 655b 2741 275d 2c20  plot1d(re['A'], 
-00062530: 6178 203d 2061 782c 2077 6176 656c 656e  ax = ax, wavelen
-00062540: 6774 6820 3d20 7265 6c5f 7761 7665 2c20  gth = rel_wave, 
-00062550: 7769 6474 6820 3d20 7769 6474 682c 206c  width = width, l
-00062560: 696e 6573 5f61 7265 203d 2027 6461 7461  ines_are = 'data
-00062570: 272c 200d 0a09 0909 0909 0963 6d61 7020  ', ........cmap 
-00062580: 3d20 636f 6c6f 7273 2c20 7469 746c 6520  = colors, title 
-00062590: 3d20 2727 2c20 706c 6f74 5f74 7970 6520  = '', plot_type 
-000625a0: 3d20 7363 616c 655f 7479 7065 2c20 6c69  = scale_type, li
-000625b0: 6e65 7769 6474 6820 3d20 6c69 6e65 7769  newidth = linewi
-000625c0: 6474 6829 0d0a 0909 0961 7820 3d20 706c  dth).....ax = pl
-000625d0: 6f74 3164 2872 655b 2741 4327 5d2c 2061  ot1d(re['AC'], a
-000625e0: 7820 3d20 6178 2c20 7761 7665 6c65 6e67  x = ax, waveleng
-000625f0: 7468 203d 2072 656c 5f77 6176 652c 2077  th = rel_wave, w
-00062600: 6964 7468 203d 2077 6964 7468 2c20 6c69  idth = width, li
-00062610: 6e65 735f 6172 6520 3d20 2766 6974 7465  nes_are = 'fitte
-00062620: 6427 2c20 0d0a 0909 0909 0909 636d 6170  d', ........cmap
-00062630: 203d 2063 6f6c 6f72 732c 2074 6974 6c65   = colors, title
-00062640: 203d 2027 272c 2073 7562 706c 6f74 203d   = '', subplot =
-00062650: 2054 7275 652c 2070 6c6f 745f 7479 7065   True, plot_type
-00062660: 203d 2073 6361 6c65 5f74 7970 652c 206c   = scale_type, l
-00062670: 696e 6577 6964 7468 203d 206c 696e 6577  inewidth = linew
-00062680: 6964 7468 290d 0a09 0909 2361 7820 3d20  idth).....#ax = 
-00062690: 706c 6f74 3164 2872 655b 2741 4327 5d2c  plot1d(re['AC'],
-000626a0: 2061 7820 3d20 6178 2c20 7761 7665 6c65   ax = ax, wavele
-000626b0: 6e67 7468 203d 2072 656c 5f77 6176 652c  ngth = rel_wave,
-000626c0: 2077 6964 7468 203d 2077 6964 7468 2c20   width = width, 
-000626d0: 6c69 6e65 735f 6172 6520 3d20 2766 6974  lines_are = 'fit
-000626e0: 7465 6427 2c20 0d0a 0909 0923 0909 0963  ted', .....#...c
-000626f0: 6d61 7020 3d20 636f 6c6f 7273 2c20 636f  map = colors, co
-00062700: 6c6f 725f 6f66 6673 6574 203d 206c 656e  lor_offset = len
-00062710: 2872 656c 5f77 6176 6529 2c20 7469 746c  (rel_wave), titl
-00062720: 6520 3d20 2727 2c20 7375 6270 6c6f 7420  e = '', subplot 
-00062730: 3d20 5472 7565 2c20 706c 6f74 5f74 7970  = True, plot_typ
-00062740: 6520 3d20 7363 616c 655f 7479 7065 290d  e = scale_type).
-00062750: 0a09 0909 6861 6e64 2c20 206c 6162 656c  ....hand,  label
-00062760: 7320 3d20 6178 2e67 6574 5f6c 6567 656e  s = ax.get_legen
-00062770: 645f 6861 6e64 6c65 735f 6c61 6265 6c73  d_handles_labels
-00062780: 2829 0d0a 0909 096c 6162 3d5b 2725 6720  ().....lab=['%g 
-00062790: 6e6d 2725 6120 2b20 275f 2720 2b20 7374  nm'%a + '_' + st
-000627a0: 7228 7365 6c66 2e66 696c 656e 616d 6529  r(self.filename)
-000627b0: 2066 6f72 2061 2069 6e20 7265 6c5f 7761   for a in rel_wa
-000627c0: 7665 5d0d 0a09 0909 666f 7220 656e 7420  ve].....for ent 
-000627d0: 696e 2072 656c 5f77 6176 653a 0d0a 0909  in rel_wave:....
-000627e0: 0909 6c61 622e 6170 7065 6e64 2827 2567  ..lab.append('%g
-000627f0: 206e 6d27 2565 6e74 202b 2027 5f27 202b   nm'%ent + '_' +
-00062800: 2073 7472 2873 656c 662e 6669 6c65 6e61   str(self.filena
-00062810: 6d65 2929 0d0a 0909 090d 0a09 0909 6966  me))..........if
-00062820: 206f 7468 6572 2069 7320 6e6f 7420 4e6f   other is not No
-00062830: 6e65 3a0d 0a09 0909 0966 6f72 2069 2c6f  ne:......for i,o
-00062840: 2069 6e20 656e 756d 6572 6174 6528 6f74   in enumerate(ot
-00062850: 6865 7229 3a0d 0a09 0909 0909 692b 3d31  her):.......i+=1
-00062860: 0d0a 0909 0909 0963 6f6c 6f72 5f6f 6666  .......color_off
-00062870: 7365 743d 2869 2b31 292a 6c65 6e28 7265  set=(i+1)*len(re
-00062880: 6c5f 7761 7665 290d 0a09 0909 0909 7472  l_wave).......tr
-00062890: 793a 0d0a 0909 0909 0909 7265 3d6f 2e72  y:........re=o.r
-000628a0: 650d 0a09 0909 0909 6578 6365 7074 3a0d  e.......except:.
-000628b0: 0a09 0909 0909 0970 7269 6e74 2827 2573  .......print('%s
-000628c0: 2068 6173 206e 6f20 6669 7474 6564 2072   has no fitted r
-000628d0: 6573 756c 7473 2725 6f2e 6669 6c65 6e61  esults'%o.filena
-000628e0: 6d65 290d 0a09 0909 0909 0963 6f6e 7469  me)........conti
-000628f0: 6e75 650d 0a09 0909 0909 6966 206e 6f72  nue.......if nor
-00062900: 6d5f 7769 6e64 6f77 2069 7320 6e6f 7420  m_window is not 
-00062910: 4e6f 6e65 3a0d 0a09 0909 0909 0972 656c  None:........rel
-00062920: 5f73 6361 6c65 3d72 655b 2741 275d 2e6c  _scale=re['A'].l
-00062930: 6f63 5b6e 6f72 6d5f 7769 6e64 6f77 5b30  oc[norm_window[0
-00062940: 5d3a 6e6f 726d 5f77 696e 646f 775b 315d  ]:norm_window[1]
-00062950: 2c6e 6f72 6d5f 7769 6e64 6f77 5b32 5d3a  ,norm_window[2]:
-00062960: 6e6f 726d 5f77 696e 646f 775b 335d 5d2e  norm_window[3]].
-00062970: 6d65 616e 2829 2e6d 6561 6e28 290d 0a09  mean().mean()...
-00062980: 0909 0909 0909 0909 0909 0909 200d 0a09  ............ ...
-00062990: 0909 0909 0974 7279 3a0d 0a09 0909 0909  .....try:.......
-000629a0: 0909 7363 616c 696e 673d 2872 656c 5f73  ..scaling=(rel_s
-000629b0: 6361 6c65 202f 2072 6566 5f73 6361 6c65  cale / ref_scale
-000629c0: 290d 0a09 0909 0909 0909 6966 2064 6174  ).........if dat
-000629d0: 615f 616e 645f 6669 743a 0d0a 0909 0909  a_and_fit:......
-000629e0: 0909 0909 6178 203d 2070 6c6f 7431 6428  ....ax = plot1d(
-000629f0: 7265 5b27 4127 5d2f 7363 616c 696e 672c  re['A']/scaling,
-00062a00: 2063 6d61 7020 3d20 636f 6c6f 7273 2c20   cmap = colors, 
-00062a10: 6178 203d 2061 782c 2077 6176 656c 656e  ax = ax, wavelen
-00062a20: 6774 6820 3d20 7265 6c5f 7761 7665 2c20  gth = rel_wave, 
-00062a30: 7769 6474 6820 3d20 7769 6474 682c 0d0a  width = width,..
-00062a40: 0909 0909 0909 0909 0909 0974 6974 6c65  ...........title
-00062a50: 203d 2027 272c 206c 696e 6573 5f61 7265   = '', lines_are
-00062a60: 203d 2027 6461 7461 272c 2073 7562 706c   = 'data', subpl
-00062a70: 6f74 203d 2054 7275 652c 2063 6f6c 6f72  ot = True, color
-00062a80: 5f6f 6666 7365 7420 3d20 636f 6c6f 725f  _offset = color_
-00062a90: 6f66 6673 6574 2c0d 0a09 0909 0909 0909  offset,.........
-00062aa0: 0909 0909 706c 6f74 5f74 7970 6520 3d20  ....plot_type = 
-00062ab0: 7363 616c 655f 7479 7065 2c20 6c69 6e65  scale_type, line
-00062ac0: 7769 6474 6820 3d20 6c69 6e65 7769 6474  width = linewidt
-00062ad0: 6829 0d0a 0909 0909 0909 0961 7820 3d20  h).........ax = 
-00062ae0: 706c 6f74 3164 2872 655b 2741 4327 5d2f  plot1d(re['AC']/
-00062af0: 7363 616c 696e 672c 2063 6d61 7020 3d20  scaling, cmap = 
-00062b00: 636f 6c6f 7273 2c20 6178 203d 2061 782c  colors, ax = ax,
-00062b10: 2077 6176 656c 656e 6774 6820 3d20 7265   wavelength = re
-00062b20: 6c5f 7761 7665 2c20 7769 6474 6820 3d20  l_wave, width = 
-00062b30: 7769 6474 682c 0d0a 0909 0909 0909 0909  width,..........
-00062b40: 0909 7469 746c 6520 3d20 2727 2c20 6c69  ..title = '', li
-00062b50: 6e65 735f 6172 6520 3d20 2766 6974 7465  nes_are = 'fitte
-00062b60: 6427 2c20 7375 6270 6c6f 7420 3d20 5472  d', subplot = Tr
-00062b70: 7565 2c20 636f 6c6f 725f 6f66 6673 6574  ue, color_offset
-00062b80: 203d 2063 6f6c 6f72 5f6f 6666 7365 742c   = color_offset,
-00062b90: 200d 0a09 0909 0909 0909 0909 0970 6c6f   ............plo
-00062ba0: 745f 7479 7065 203d 2073 6361 6c65 5f74  t_type = scale_t
-00062bb0: 7970 652c 206c 696e 6577 6964 7468 203d  ype, linewidth =
-00062bc0: 206c 696e 6577 6964 7468 290d 0a09 0909   linewidth).....
-00062bd0: 0909 0909 0909 0909 0909 0909 0909 0909  ................
-00062be0: 0909 200d 0a09 0909 0909 0965 7863 6570  .. ........excep
-00062bf0: 743a 0d0a 0909 0909 0909 0970 7269 6e74  t:.........print
-00062c00: 2827 7363 616c 696e 6720 4661 696c 6564  ('scaling Failed
-00062c10: 2127 290d 0a09 0909 0909 0909 6966 2064  !').........if d
-00062c20: 6174 615f 616e 645f 6669 743a 0d0a 0909  ata_and_fit:....
-00062c30: 0909 0909 0909 6178 203d 2070 6c6f 7431  ......ax = plot1
-00062c40: 6428 7265 5b27 4127 5d2c 2063 6d61 7020  d(re['A'], cmap 
-00062c50: 3d20 636f 6c6f 7273 2c20 6178 203d 2061  = colors, ax = a
-00062c60: 782c 2077 6176 656c 656e 6774 6820 3d20  x, wavelength = 
-00062c70: 7265 6c5f 7761 7665 2c20 7769 6474 6820  rel_wave, width 
-00062c80: 3d20 7769 6474 682c 200d 0a09 0909 0909  = width, .......
-00062c90: 0909 0909 0909 0974 6974 6c65 203d 2027  .......title = '
-00062ca0: 272c 206c 696e 6573 5f61 7265 203d 2027  ', lines_are = '
-00062cb0: 6461 7461 272c 2073 7562 706c 6f74 203d  data', subplot =
-00062cc0: 2054 7275 652c 2063 6f6c 6f72 5f6f 6666   True, color_off
-00062cd0: 7365 7420 3d20 636f 6c6f 725f 6f66 6673  set = color_offs
-00062ce0: 6574 2c20 0d0a 0909 0909 0909 0909 0909  et, ............
-00062cf0: 0909 706c 6f74 5f74 7970 6520 3d20 7363  ..plot_type = sc
-00062d00: 616c 655f 7479 7065 2c20 6c69 6e65 7769  ale_type, linewi
-00062d10: 6474 6820 3d20 6c69 6e65 7769 6474 6829  dth = linewidth)
-00062d20: 0d0a 0909 0909 0909 0961 7820 3d20 706c  .........ax = pl
-00062d30: 6f74 3164 2872 655b 2741 4327 5d2c 2063  ot1d(re['AC'], c
-00062d40: 6d61 7020 3d20 636f 6c6f 7273 2c20 6178  map = colors, ax
-00062d50: 203d 2061 782c 2077 6176 656c 656e 6774   = ax, wavelengt
-00062d60: 6820 3d20 7265 6c5f 7761 7665 2c20 7769  h = rel_wave, wi
-00062d70: 6474 6820 3d20 7769 6474 682c 200d 0a09  dth = width, ...
-00062d80: 0909 0909 0909 0909 0909 7469 746c 6520  ..........title 
-00062d90: 3d20 2727 2c20 6c69 6e65 735f 6172 6520  = '', lines_are 
-00062da0: 3d20 2766 6974 7465 6427 2c20 7375 6270  = 'fitted', subp
-00062db0: 6c6f 7420 3d20 5472 7565 2c20 636f 6c6f  lot = True, colo
-00062dc0: 725f 6f66 6673 6574 203d 2063 6f6c 6f72  r_offset = color
-00062dd0: 5f6f 6666 7365 742c 200d 0a09 0909 0909  _offset, .......
-00062de0: 0909 0909 0909 706c 6f74 5f74 7970 6520  ......plot_type 
-00062df0: 3d20 7363 616c 655f 7479 7065 2c20 6c69  = scale_type, li
-00062e00: 6e65 7769 6474 6820 3d20 6c69 6e65 7769  newidth = linewi
-00062e10: 6474 6829 200d 0a09 0909 0909 656c 7365  dth) .......else
-00062e20: 3a0d 0a09 0909 0909 0969 6620 6461 7461  :........if data
-00062e30: 5f61 6e64 5f66 6974 3a0d 0a09 0909 0909  _and_fit:.......
-00062e40: 0909 6178 203d 2070 6c6f 7431 6428 7265  ..ax = plot1d(re
-00062e50: 5b27 4127 5d2c 2063 6d61 7020 3d20 636f  ['A'], cmap = co
-00062e60: 6c6f 7273 2c20 6178 203d 2061 782c 2077  lors, ax = ax, w
-00062e70: 6176 656c 656e 6774 6820 3d20 7265 6c5f  avelength = rel_
-00062e80: 7761 7665 2c20 7769 6474 6820 3d20 7769  wave, width = wi
-00062e90: 6474 682c 200d 0a09 0909 0909 0909 0909  dth, ...........
-00062ea0: 0909 7469 746c 6520 3d20 2727 2c20 6c69  ..title = '', li
-00062eb0: 6e65 735f 6172 6520 3d20 2764 6174 6127  nes_are = 'data'
-00062ec0: 2c20 7375 6270 6c6f 7420 3d20 5472 7565  , subplot = True
-00062ed0: 2c20 636f 6c6f 725f 6f66 6673 6574 203d  , color_offset =
-00062ee0: 2063 6f6c 6f72 5f6f 6666 7365 742c 200d   color_offset, .
-00062ef0: 0a09 0909 0909 0909 0909 0909 706c 6f74  ............plot
-00062f00: 5f74 7970 6520 3d20 7363 616c 655f 7479  _type = scale_ty
-00062f10: 7065 2c20 6c69 6e65 7769 6474 6820 3d20  pe, linewidth = 
-00062f20: 6c69 6e65 7769 6474 6829 0d0a 0909 0909  linewidth)......
-00062f30: 0909 6178 203d 2070 6c6f 7431 6428 7265  ..ax = plot1d(re
-00062f40: 5b27 4143 275d 2c20 636d 6170 203d 2063  ['AC'], cmap = c
-00062f50: 6f6c 6f72 732c 2061 7820 3d20 6178 2c20  olors, ax = ax, 
-00062f60: 7761 7665 6c65 6e67 7468 203d 2072 656c  wavelength = rel
-00062f70: 5f77 6176 652c 2077 6964 7468 203d 2077  _wave, width = w
-00062f80: 6964 7468 2c20 0d0a 0909 0909 0909 0909  idth, ..........
-00062f90: 0909 7469 746c 6520 3d20 2727 2c20 6c69  ..title = '', li
-00062fa0: 6e65 735f 6172 6520 3d20 2766 6974 7465  nes_are = 'fitte
-00062fb0: 6427 2c20 7375 6270 6c6f 7420 3d20 5472  d', subplot = Tr
-00062fc0: 7565 2c20 636f 6c6f 725f 6f66 6673 6574  ue, color_offset
-00062fd0: 203d 2063 6f6c 6f72 5f6f 6666 7365 742c   = color_offset,
-00062fe0: 200d 0a09 0909 0909 0909 0909 0970 6c6f   ............plo
-00062ff0: 745f 7479 7065 203d 2073 6361 6c65 5f74  t_type = scale_t
-00063000: 7970 652c 206c 696e 6577 6964 7468 203d  ype, linewidth =
-00063010: 206c 696e 6577 6964 7468 290d 0a09 0909   linewidth).....
-00063020: 0909 666f 7220 656e 7420 696e 2072 656c  ..for ent in rel
-00063030: 5f77 6176 653a 0d0a 0909 0909 0909 6966  _wave:........if
-00063040: 2064 6174 615f 616e 645f 6669 743a 0d0a   data_and_fit:..
-00063050: 0909 0909 0909 096c 6162 2e61 7070 656e  .......lab.appen
-00063060: 6428 2725 6720 6e6d 2725 656e 7420 2b20  d('%g nm'%ent + 
-00063070: 275f 2720 2b20 7374 7228 6f2e 6669 6c65  '_' + str(o.file
-00063080: 6e61 6d65 2929 0d0a 0909 0909 0909 6c61  name))........la
-00063090: 622e 6170 7065 6e64 2827 2567 206e 6d27  b.append('%g nm'
-000630a0: 2565 6e74 202b 2027 5f27 202b 2073 7472  %ent + '_' + str
-000630b0: 286f 2e66 696c 656e 616d 6529 290d 0a09  (o.filename))...
-000630c0: 0909 0909 6861 6e64 6c65 732c 206c 6162  ....handles, lab
-000630d0: 656c 733d 6178 2e67 6574 5f6c 6567 656e  els=ax.get_legen
-000630e0: 645f 6861 6e64 6c65 735f 6c61 6265 6c73  d_handles_labels
-000630f0: 2829 0d0a 0909 0909 0969 6620 6461 7461  ().......if data
-00063100: 5f61 6e64 5f66 6974 3a0d 0a09 0909 0909  _and_fit:.......
-00063110: 0966 6f72 2061 2069 6e20 6861 6e64 6c65  .for a in handle
-00063120: 735b 2d32 2a6c 656e 2872 656c 5f77 6176  s[-2*len(rel_wav
-00063130: 6529 3a5d 3a0d 0a09 0909 0909 0909 6861  e):]:.........ha
-00063140: 6e64 2e61 7070 656e 6428 6129 0d0a 0909  nd.append(a)....
-00063150: 0909 0965 6c73 653a 0d0a 0909 0909 0909  ...else:........
-00063160: 666f 7220 6120 696e 2068 616e 646c 6573  for a in handles
-00063170: 5b2d 6c65 6e28 7265 6c5f 7761 7665 293a  [-len(rel_wave):
-00063180: 5d3a 0d0a 0909 0909 0909 0968 616e 642e  ]:.........hand.
-00063190: 6170 7065 6e64 2861 290d 0a09 0909 6966  append(a).....if
-000631a0: 206e 6f72 6d5f 7769 6e64 6f77 2069 7320   norm_window is 
-000631b0: 6e6f 7420 4e6f 6e65 3a0d 0a09 0909 0920  not None:...... 
-000631c0: 0d0a 0909 0909 6178 2e73 6574 5f74 6974  ......ax.set_tit
-000631d0: 6c65 2827 636f 6d70 6172 6520 6d65 6173  le('compare meas
-000631e0: 7572 6564 2061 6e64 2066 6974 7465 6420  ured and fitted 
-000631f0: 6461 7461 2061 7420 6769 7665 6e20 7761  data at given wa
-00063200: 7665 6c65 6e67 7468 205c 6e20 7363 616c  velength \n scal
-00063210: 6564 2074 6f20 743d 2567 2070 7320 3a20  ed to t=%g ps : 
-00063220: 2567 2070 7320 2c20 776c 3d20 2567 206e  %g ps , wl= %g n
-00063230: 6d3a 2025 6720 6e6d 2725 286e 6f72 6d5f  m: %g nm'%(norm_
-00063240: 7769 6e64 6f77 5b30 5d2c 6e6f 726d 5f77  window[0],norm_w
-00063250: 696e 646f 775b 315d 2c6e 6f72 6d5f 7769  indow[1],norm_wi
-00063260: 6e64 6f77 5b32 5d2c 6e6f 726d 5f77 696e  ndow[2],norm_win
-00063270: 646f 775b 335d 2929 0d0a 0909 0965 6c73  dow[3])).....els
-00063280: 653a 0d0a 0909 0909 6178 2e73 6574 5f74  e:......ax.set_t
-00063290: 6974 6c65 2827 636f 6d70 6172 6520 6d65  itle('compare me
-000632a0: 6173 7572 6564 2061 6e64 2066 6974 7465  asured and fitte
-000632b0: 6420 6461 7461 2061 7420 6769 7665 6e20  d data at given 
-000632c0: 7761 7665 6c65 6e67 7468 2729 0d0a 0909  wavelength')....
-000632d0: 0961 782e 7365 745f 786c 696d 2872 655b  .ax.set_xlim(re[
-000632e0: 2741 275d 2e69 6e64 6578 2e76 616c 7565  'A'].index.value
-000632f0: 735b 305d 2c72 655b 2741 275d 2e69 6e64  s[0],re['A'].ind
-00063300: 6578 2e76 616c 7565 735b 2d31 5d29 0d0a  ex.values[-1])..
-00063310: 0909 0961 782e 6c65 6765 6e64 2868 616e  ...ax.legend(han
-00063320: 642c 6c61 6229 0d0a 0909 656c 7365 3a0d  d,lab)....else:.
-00063330: 0a09 0909 6669 672c 2061 7820 3d20 706c  ....fig, ax = pl
-00063340: 742e 7375 6270 6c6f 7473 2866 6967 7369  t.subplots(figsi
-00063350: 7a65 203d 2028 3130 2c20 3629 2c20 6470  ze = (10, 6), dp
-00063360: 6920 3d20 3130 3029 0d0a 0909 0963 6f6c  i = 100).....col
-00063370: 6f72 7320 3d20 636f 6c6d 2863 6d61 7020  ors = colm(cmap 
-00063380: 3d20 636d 6170 2c20 6b20 3d20 7261 6e67  = cmap, k = rang
-00063390: 6528 6c65 6e28 7265 6c5f 7761 7665 292a  e(len(rel_wave)*
-000633a0: 2832 2b6c 656e 286f 7468 6572 2929 2929  (2+len(other))))
-000633b0: 0d0a 0909 0969 6620 6e6f 726d 5f77 696e  .....if norm_win
-000633c0: 646f 7720 6973 206e 6f74 204e 6f6e 653a  dow is not None:
-000633d0: 0d0a 0909 0909 7265 665f 7363 616c 6520  ......ref_scale 
-000633e0: 3d20 7365 6c66 2e64 732e 6c6f 635b 6e6f  = self.ds.loc[no
-000633f0: 726d 5f77 696e 646f 775b 305d 3a6e 6f72  rm_window[0]:nor
-00063400: 6d5f 7769 6e64 6f77 5b31 5d2c 206e 6f72  m_window[1], nor
-00063410: 6d5f 7769 6e64 6f77 5b32 5d3a 6e6f 726d  m_window[2]:norm
-00063420: 5f77 696e 646f 775b 335d 5d2e 6d65 616e  _window[3]].mean
-00063430: 2829 2e6d 6561 6e28 290d 0a09 0909 6178  ().mean().....ax
-00063440: 203d 2070 6c6f 7431 6428 7365 6c66 2e64   = plot1d(self.d
-00063450: 732c 2063 6d61 7020 3d20 636f 6c6f 7273  s, cmap = colors
-00063460: 2c20 6178 203d 2061 782c 2077 6176 656c  , ax = ax, wavel
-00063470: 656e 6774 6820 3d20 7265 6c5f 7761 7665  ength = rel_wave
-00063480: 2c20 7769 6474 6820 3d20 7769 6474 682c  , width = width,
-00063490: 2074 6974 6c65 203d 2073 656c 662e 6669   title = self.fi
-000634a0: 6c65 6e61 6d65 2c0d 0a09 0909 0909 0962  lename,........b
-000634b0: 6173 6575 6e69 7420 3d20 7365 6c66 2e62  aseunit = self.b
-000634c0: 6173 6575 6e69 742c 206c 696e 6573 5f61  aseunit, lines_a
-000634d0: 7265 203d 2027 6461 7461 272c 2073 6361  re = 'data', sca
-000634e0: 7474 6572 6375 7420 3d20 7365 6c66 2e73  ttercut = self.s
-000634f0: 6361 7474 6572 6375 742c 200d 0a09 0909  cattercut, .....
-00063500: 0909 0962 6f72 6465 7263 7574 203d 2073  ...bordercut = s
-00063510: 656c 662e 626f 7264 6572 6375 742c 2073  elf.bordercut, s
-00063520: 7562 706c 6f74 203d 2046 616c 7365 2c20  ubplot = False, 
-00063530: 636f 6c6f 725f 6f66 6673 6574 203d 2030  color_offset = 0
-00063540: 2c20 7469 6d65 6c69 6d69 7473 203d 2073  , timelimits = s
-00063550: 656c 662e 7469 6d65 6c69 6d69 7473 2c20  elf.timelimits, 
-00063560: 0d0a 0909 0909 0909 696e 7465 6e73 6974  ........intensit
-00063570: 795f 7261 6e67 6520 3d20 7365 6c66 2e69  y_range = self.i
-00063580: 6e74 656e 7369 7479 5f72 616e 6765 2c20  ntensity_range, 
-00063590: 706c 6f74 5f74 7970 6520 3d20 7363 616c  plot_type = scal
-000635a0: 655f 7479 7065 2c20 6c69 6e65 7769 6474  e_type, linewidt
-000635b0: 6820 3d20 6c69 6e65 7769 6474 6829 0d0a  h = linewidth)..
-000635c0: 0909 0961 7820 3d20 706c 6f74 3164 2873  ...ax = plot1d(s
-000635d0: 656c 662e 6473 2c20 636d 6170 203d 2063  elf.ds, cmap = c
-000635e0: 6f6c 6f72 732c 2061 7820 3d20 6178 2c20  olors, ax = ax, 
-000635f0: 7761 7665 6c65 6e67 7468 203d 2072 656c  wavelength = rel
-00063600: 5f77 6176 652c 2077 6964 7468 203d 2077  _wave, width = w
-00063610: 6964 7468 2c20 7469 746c 6520 3d20 7365  idth, title = se
-00063620: 6c66 2e66 696c 656e 616d 652c 200d 0a09  lf.filename, ...
-00063630: 0909 0909 0962 6173 6575 6e69 7420 3d20  .....baseunit = 
-00063640: 7365 6c66 2e62 6173 6575 6e69 742c 206c  self.baseunit, l
-00063650: 696e 6573 5f61 7265 203d 2027 736d 6f6f  ines_are = 'smoo
-00063660: 7468 6564 272c 2073 6361 7474 6572 6375  thed', scattercu
-00063670: 7420 3d20 7365 6c66 2e73 6361 7474 6572  t = self.scatter
-00063680: 6375 742c 200d 0a09 0909 0909 0962 6f72  cut, ........bor
-00063690: 6465 7263 7574 203d 2073 656c 662e 626f  dercut = self.bo
-000636a0: 7264 6572 6375 742c 2073 7562 706c 6f74  rdercut, subplot
-000636b0: 203d 2046 616c 7365 2c20 636f 6c6f 725f   = False, color_
-000636c0: 6f66 6673 6574 203d 2030 2c20 7469 6d65  offset = 0, time
-000636d0: 6c69 6d69 7473 203d 2073 656c 662e 7469  limits = self.ti
-000636e0: 6d65 6c69 6d69 7473 2c20 0d0a 0909 0909  melimits, ......
-000636f0: 0909 696e 7465 6e73 6974 795f 7261 6e67  ..intensity_rang
-00063700: 6520 3d20 7365 6c66 2e69 6e74 656e 7369  e = self.intensi
-00063710: 7479 5f72 616e 6765 2c20 706c 6f74 5f74  ty_range, plot_t
-00063720: 7970 6520 3d20 7363 616c 655f 7479 7065  ype = scale_type
-00063730: 2c20 6c69 6e65 7769 6474 6820 3d20 6c69  , linewidth = li
-00063740: 6e65 7769 6474 6829 0d0a 0909 0969 6620  newidth).....if 
-00063750: 313a 0d0a 0909 0909 6861 6e64 6c65 732c  1:......handles,
-00063760: 206c 6162 656c 733d 6178 2e67 6574 5f6c   labels=ax.get_l
-00063770: 6567 656e 645f 6861 6e64 6c65 735f 6c61  egend_handles_la
-00063780: 6265 6c73 2829 0d0a 0909 0909 6c61 623d  bels()......lab=
-00063790: 5b27 2567 206e 6d27 2561 202b 2027 5f27  ['%g nm'%a + '_'
-000637a0: 202b 2073 7472 2873 656c 662e 6669 6c65   + str(self.file
-000637b0: 6e61 6d65 2920 666f 7220 6120 696e 2072  name) for a in r
-000637c0: 656c 5f77 6176 655d 0d0a 0909 0909 6861  el_wave]......ha
-000637d0: 6e64 3d68 616e 646c 6573 5b6c 656e 2872  nd=handles[len(r
-000637e0: 656c 5f77 6176 6529 3a5d 0d0a 0909 0909  el_wave):]......
-000637f0: 6966 206f 7468 6572 2069 7320 6e6f 7420  if other is not 
-00063800: 4e6f 6e65 3a0d 0a09 0909 0909 666f 7220  None:.......for 
-00063810: 692c 6f20 696e 2065 6e75 6d65 7261 7465  i,o in enumerate
-00063820: 286f 7468 6572 293a 0d0a 0909 0909 0909  (other):........
-00063830: 692b 3d31 0d0a 0909 0909 0909 636f 6c6f  i+=1........colo
-00063840: 725f 6f66 6673 6574 3d28 692b 3129 2a6c  r_offset=(i+1)*l
-00063850: 656e 2872 656c 5f77 6176 6529 0d0a 0909  en(rel_wave)....
-00063860: 0909 0909 6966 206e 6f72 6d5f 7769 6e64  ....if norm_wind
-00063870: 6f77 2069 7320 6e6f 7420 4e6f 6e65 3a0d  ow is not None:.
-00063880: 0a09 0909 0909 0909 7265 6c5f 7363 616c  ........rel_scal
-00063890: 653d 6f2e 6473 2e6c 6f63 5b6e 6f72 6d5f  e=o.ds.loc[norm_
-000638a0: 7769 6e64 6f77 5b30 5d3a 6e6f 726d 5f77  window[0]:norm_w
-000638b0: 696e 646f 775b 315d 2c6e 6f72 6d5f 7769  indow[1],norm_wi
-000638c0: 6e64 6f77 5b32 5d3a 6e6f 726d 5f77 696e  ndow[2]:norm_win
-000638d0: 646f 775b 335d 5d2e 6d65 616e 2829 2e6d  dow[3]].mean().m
-000638e0: 6561 6e28 290d 0a09 0909 0909 0909 7472  ean().........tr
-000638f0: 793a 0d0a 0909 0909 0909 0909 7363 616c  y:..........scal
-00063900: 696e 673d 2872 656c 5f73 6361 6c65 2f72  ing=(rel_scale/r
-00063910: 6566 5f73 6361 6c65 290d 0a09 0909 0909  ef_scale).......
-00063920: 0909 0961 7820 3d20 706c 6f74 3164 286f  ...ax = plot1d(o
-00063930: 2e64 732f 7363 616c 696e 672c 2063 6d61  .ds/scaling, cma
-00063940: 7020 3d20 636f 6c6f 7273 2c20 6178 203d  p = colors, ax =
-00063950: 2061 782c 2077 6176 656c 656e 6774 6820   ax, wavelength 
-00063960: 3d20 7265 6c5f 7761 7665 2c20 7769 6474  = rel_wave, widt
-00063970: 6820 3d20 7769 6474 682c 0d0a 0909 0909  h = width,......
-00063980: 0909 0909 0909 0974 6974 6c65 203d 206f  .......title = o
-00063990: 2e66 696c 656e 616d 652c 2062 6173 6575  .filename, baseu
-000639a0: 6e69 7420 3d20 7365 6c66 2e62 6173 6575  nit = self.baseu
-000639b0: 6e69 742c 2074 696d 656c 696d 6974 7320  nit, timelimits 
-000639c0: 3d20 7365 6c66 2e74 696d 656c 696d 6974  = self.timelimit
-000639d0: 732c 0d0a 0909 0909 0909 0909 0909 096c  s,.............l
-000639e0: 696e 6573 5f61 7265 203d 2027 6461 7461  ines_are = 'data
-000639f0: 272c 2073 6361 7474 6572 6375 7420 3d20  ', scattercut = 
-00063a00: 7365 6c66 2e73 6361 7474 6572 6375 742c  self.scattercut,
-00063a10: 2062 6f72 6465 7263 7574 203d 2073 656c   bordercut = sel
-00063a20: 662e 626f 7264 6572 6375 742c 0d0a 0909  f.bordercut,....
-00063a30: 0909 0909 0909 0909 0973 7562 706c 6f74  .........subplot
-00063a40: 203d 2054 7275 652c 2063 6f6c 6f72 5f6f   = True, color_o
-00063a50: 6666 7365 7420 3d20 636f 6c6f 725f 6f66  ffset = color_of
-00063a60: 6673 6574 2c20 0d0a 0909 0909 0909 0909  fset, ..........
-00063a70: 0909 0969 6e74 656e 7369 7479 5f72 616e  ...intensity_ran
-00063a80: 6765 203d 2073 656c 662e 696e 7465 6e73  ge = self.intens
-00063a90: 6974 795f 7261 6e67 652c 2070 6c6f 745f  ity_range, plot_
-00063aa0: 7479 7065 203d 2073 6361 6c65 5f74 7970  type = scale_typ
-00063ab0: 652c 206c 696e 6577 6964 7468 203d 206c  e, linewidth = l
-00063ac0: 696e 6577 6964 7468 290d 0a09 0909 0909  inewidth).......
-00063ad0: 0909 0961 7820 3d20 706c 6f74 3164 286f  ...ax = plot1d(o
-00063ae0: 2e64 732f 7363 616c 696e 672c 2063 6d61  .ds/scaling, cma
-00063af0: 7020 3d20 636f 6c6f 7273 2c20 6178 203d  p = colors, ax =
-00063b00: 2061 782c 2077 6176 656c 656e 6774 6820   ax, wavelength 
-00063b10: 3d20 7265 6c5f 7761 7665 2c20 7769 6474  = rel_wave, widt
-00063b20: 6820 3d20 7769 6474 682c 0d0a 0909 0909  h = width,......
-00063b30: 0909 0909 0909 0974 6974 6c65 203d 206f  .......title = o
-00063b40: 2e66 696c 656e 616d 652c 2062 6173 6575  .filename, baseu
-00063b50: 6e69 7420 3d20 7365 6c66 2e62 6173 6575  nit = self.baseu
-00063b60: 6e69 742c 2074 696d 656c 696d 6974 7320  nit, timelimits 
-00063b70: 3d20 7365 6c66 2e74 696d 656c 696d 6974  = self.timelimit
-00063b80: 732c 0d0a 0909 0909 0909 0909 0909 096c  s,.............l
-00063b90: 696e 6573 5f61 7265 203d 2027 736d 6f6f  ines_are = 'smoo
-00063ba0: 7468 6564 272c 2073 6361 7474 6572 6375  thed', scattercu
-00063bb0: 7420 3d20 7365 6c66 2e73 6361 7474 6572  t = self.scatter
-00063bc0: 6375 742c 2062 6f72 6465 7263 7574 203d  cut, bordercut =
-00063bd0: 2073 656c 662e 626f 7264 6572 6375 742c   self.bordercut,
-00063be0: 0d0a 0909 0909 0909 0909 0909 0973 7562  .............sub
-00063bf0: 706c 6f74 203d 2054 7275 652c 2063 6f6c  plot = True, col
-00063c00: 6f72 5f6f 6666 7365 7420 3d20 636f 6c6f  or_offset = colo
-00063c10: 725f 6f66 6673 6574 2c20 0d0a 0909 0909  r_offset, ......
-00063c20: 0909 0909 0909 0969 6e74 656e 7369 7479  .......intensity
-00063c30: 5f72 616e 6765 203d 2073 656c 662e 696e  _range = self.in
-00063c40: 7465 6e73 6974 795f 7261 6e67 652c 2070  tensity_range, p
-00063c50: 6c6f 745f 7479 7065 203d 2073 6361 6c65  lot_type = scale
-00063c60: 5f74 7970 652c 206c 696e 6577 6964 7468  _type, linewidth
-00063c70: 203d 206c 696e 6577 6964 7468 290d 0a09   = linewidth)...
-00063c80: 0909 0909 0909 6578 6365 7074 3a0d 0a09  ......except:...
-00063c90: 0909 0909 0909 0970 7269 6e74 2827 7363  .......print('sc
-00063ca0: 616c 696e 6720 6661 696c 6564 2729 0d0a  aling failed')..
-00063cb0: 0909 0909 0909 0909 6178 203d 2070 6c6f  ........ax = plo
-00063cc0: 7431 6428 6f2e 6473 2c20 636d 6170 203d  t1d(o.ds, cmap =
-00063cd0: 2063 6f6c 6f72 732c 2061 7820 3d20 6178   colors, ax = ax
-00063ce0: 2c20 7761 7665 6c65 6e67 7468 203d 2072  , wavelength = r
-00063cf0: 656c 5f77 6176 652c 2077 6964 7468 203d  el_wave, width =
-00063d00: 2077 6964 7468 2c0d 0a09 0909 0909 0909   width,.........
-00063d10: 0909 0909 7469 746c 6520 3d20 6f2e 6669  ....title = o.fi
-00063d20: 6c65 6e61 6d65 2c20 6261 7365 756e 6974  lename, baseunit
-00063d30: 203d 2073 656c 662e 6261 7365 756e 6974   = self.baseunit
-00063d40: 2c20 7469 6d65 6c69 6d69 7473 203d 2073  , timelimits = s
-00063d50: 656c 662e 7469 6d65 6c69 6d69 7473 2c0d  elf.timelimits,.
-00063d60: 0a09 0909 0909 0909 0909 0909 6c69 6e65  ............line
-00063d70: 735f 6172 6520 3d20 2764 6174 6127 2c20  s_are = 'data', 
-00063d80: 7363 6174 7465 7263 7574 203d 2073 656c  scattercut = sel
-00063d90: 662e 7363 6174 7465 7263 7574 2c20 626f  f.scattercut, bo
-00063da0: 7264 6572 6375 7420 3d20 7365 6c66 2e62  rdercut = self.b
-00063db0: 6f72 6465 7263 7574 2c0d 0a09 0909 0909  ordercut,.......
-00063dc0: 0909 0909 0909 7375 6270 6c6f 7420 3d20  ......subplot = 
-00063dd0: 5472 7565 2c20 636f 6c6f 725f 6f66 6673  True, color_offs
-00063de0: 6574 203d 2063 6f6c 6f72 5f6f 6666 7365  et = color_offse
-00063df0: 742c 200d 0a09 0909 0909 0909 0909 0909  t, .............
-00063e00: 696e 7465 6e73 6974 795f 7261 6e67 6520  intensity_range 
-00063e10: 3d20 7365 6c66 2e69 6e74 656e 7369 7479  = self.intensity
-00063e20: 5f72 616e 6765 2c20 706c 6f74 5f74 7970  _range, plot_typ
-00063e30: 6520 3d20 7363 616c 655f 7479 7065 2c20  e = scale_type, 
-00063e40: 6c69 6e65 7769 6474 6820 3d20 6c69 6e65  linewidth = line
-00063e50: 7769 6474 6829 0d0a 0909 0909 0909 0909  width)..........
-00063e60: 6178 203d 2070 6c6f 7431 6428 6f2e 6473  ax = plot1d(o.ds
-00063e70: 2c20 636d 6170 203d 2063 6f6c 6f72 732c  , cmap = colors,
-00063e80: 2061 7820 3d20 6178 2c20 7761 7665 6c65   ax = ax, wavele
-00063e90: 6e67 7468 203d 2072 656c 5f77 6176 652c  ngth = rel_wave,
-00063ea0: 2077 6964 7468 203d 2077 6964 7468 2c0d   width = width,.
-00063eb0: 0a09 0909 0909 0909 0909 0909 7469 746c  ............titl
-00063ec0: 6520 3d20 6f2e 6669 6c65 6e61 6d65 2c20  e = o.filename, 
-00063ed0: 6261 7365 756e 6974 203d 2073 656c 662e  baseunit = self.
-00063ee0: 6261 7365 756e 6974 2c20 7469 6d65 6c69  baseunit, timeli
-00063ef0: 6d69 7473 203d 2073 656c 662e 7469 6d65  mits = self.time
-00063f00: 6c69 6d69 7473 2c0d 0a09 0909 0909 0909  limits,.........
-00063f10: 0909 0909 6c69 6e65 735f 6172 6520 3d20  ....lines_are = 
-00063f20: 2773 6d6f 6f74 6865 6427 2c20 7363 6174  'smoothed', scat
-00063f30: 7465 7263 7574 203d 2073 656c 662e 7363  tercut = self.sc
-00063f40: 6174 7465 7263 7574 2c20 626f 7264 6572  attercut, border
-00063f50: 6375 7420 3d20 7365 6c66 2e62 6f72 6465  cut = self.borde
-00063f60: 7263 7574 2c0d 0a09 0909 0909 0909 0909  rcut,...........
-00063f70: 0909 7375 6270 6c6f 7420 3d20 5472 7565  ..subplot = True
-00063f80: 2c20 636f 6c6f 725f 6f66 6673 6574 203d  , color_offset =
-00063f90: 2063 6f6c 6f72 5f6f 6666 7365 742c 200d   color_offset, .
-00063fa0: 0a09 0909 0909 0909 0909 0909 696e 7465  ............inte
-00063fb0: 6e73 6974 795f 7261 6e67 6520 3d20 7365  nsity_range = se
-00063fc0: 6c66 2e69 6e74 656e 7369 7479 5f72 616e  lf.intensity_ran
-00063fd0: 6765 2c20 706c 6f74 5f74 7970 6520 3d20  ge, plot_type = 
-00063fe0: 7363 616c 655f 7479 7065 2c20 6c69 6e65  scale_type, line
-00063ff0: 7769 6474 6820 3d20 6c69 6e65 7769 6474  width = linewidt
-00064000: 6829 0d0a 0909 0909 0909 656c 7365 3a0d  h)........else:.
-00064010: 0a09 0909 0909 0909 6178 203d 2070 6c6f  ........ax = plo
-00064020: 7431 6428 6f2e 6473 2c20 636d 6170 203d  t1d(o.ds, cmap =
-00064030: 2063 6f6c 6f72 732c 2061 7820 3d20 6178   colors, ax = ax
-00064040: 2c20 7761 7665 6c65 6e67 7468 203d 2072  , wavelength = r
-00064050: 656c 5f77 6176 652c 2077 6964 7468 203d  el_wave, width =
-00064060: 2077 6964 7468 2c20 7469 746c 6520 3d20   width, title = 
-00064070: 6f2e 6669 6c65 6e61 6d65 2c0d 0a09 0909  o.filename,.....
-00064080: 0909 0909 0909 0962 6173 6575 6e69 7420  .......baseunit 
-00064090: 3d20 7365 6c66 2e62 6173 6575 6e69 742c  = self.baseunit,
-000640a0: 2074 696d 656c 696d 6974 7320 3d20 7365   timelimits = se
-000640b0: 6c66 2e74 696d 656c 696d 6974 732c 206c  lf.timelimits, l
-000640c0: 696e 6573 5f61 7265 203d 2027 6461 7461  ines_are = 'data
-000640d0: 272c 0d0a 0909 0909 0909 0909 0909 7363  ',............sc
-000640e0: 6174 7465 7263 7574 203d 2073 656c 662e  attercut = self.
-000640f0: 7363 6174 7465 7263 7574 2c20 626f 7264  scattercut, bord
-00064100: 6572 6375 7420 3d20 7365 6c66 2e62 6f72  ercut = self.bor
-00064110: 6465 7263 7574 2c20 7375 6270 6c6f 7420  dercut, subplot 
-00064120: 3d20 5472 7565 2c0d 0a09 0909 0909 0909  = True,.........
-00064130: 0909 0963 6f6c 6f72 5f6f 6666 7365 7420  ...color_offset 
-00064140: 3d20 636f 6c6f 725f 6f66 6673 6574 2c20  = color_offset, 
-00064150: 696e 7465 6e73 6974 795f 7261 6e67 6520  intensity_range 
-00064160: 3d20 7365 6c66 2e69 6e74 656e 7369 7479  = self.intensity
-00064170: 5f72 616e 6765 2c20 0d0a 0909 0909 0909  _range, ........
-00064180: 0909 0909 706c 6f74 5f74 7970 6520 3d20  ....plot_type = 
-00064190: 7363 616c 655f 7479 7065 2c20 6c69 6e65  scale_type, line
-000641a0: 7769 6474 6820 3d20 6c69 6e65 7769 6474  width = linewidt
-000641b0: 6829 0d0a 0909 0909 0909 0961 7820 3d20  h).........ax = 
-000641c0: 706c 6f74 3164 286f 2e64 732c 2063 6d61  plot1d(o.ds, cma
-000641d0: 7020 3d20 636f 6c6f 7273 2c20 6178 203d  p = colors, ax =
-000641e0: 2061 782c 2077 6176 656c 656e 6774 6820   ax, wavelength 
-000641f0: 3d20 7265 6c5f 7761 7665 2c20 7769 6474  = rel_wave, widt
-00064200: 6820 3d20 7769 6474 682c 2074 6974 6c65  h = width, title
-00064210: 203d 206f 2e66 696c 656e 616d 652c 0d0a   = o.filename,..
-00064220: 0909 0909 0909 0909 0909 6261 7365 756e  ..........baseun
-00064230: 6974 203d 2073 656c 662e 6261 7365 756e  it = self.baseun
-00064240: 6974 2c20 7469 6d65 6c69 6d69 7473 203d  it, timelimits =
-00064250: 2073 656c 662e 7469 6d65 6c69 6d69 7473   self.timelimits
-00064260: 2c20 6c69 6e65 735f 6172 6520 3d20 2773  , lines_are = 's
-00064270: 6d6f 6f74 6865 6427 2c0d 0a09 0909 0909  moothed',.......
-00064280: 0909 0909 0973 6361 7474 6572 6375 7420  .....scattercut 
-00064290: 3d20 7365 6c66 2e73 6361 7474 6572 6375  = self.scattercu
-000642a0: 742c 2062 6f72 6465 7263 7574 203d 2073  t, bordercut = s
-000642b0: 656c 662e 626f 7264 6572 6375 742c 2073  elf.bordercut, s
-000642c0: 7562 706c 6f74 203d 2054 7275 652c 0d0a  ubplot = True,..
-000642d0: 0909 0909 0909 0909 0909 636f 6c6f 725f  ..........color_
-000642e0: 6f66 6673 6574 203d 2063 6f6c 6f72 5f6f  offset = color_o
-000642f0: 6666 7365 742c 2069 6e74 656e 7369 7479  ffset, intensity
-00064300: 5f72 616e 6765 203d 2073 656c 662e 696e  _range = self.in
-00064310: 7465 6e73 6974 795f 7261 6e67 652c 200d  tensity_range, .
-00064320: 0a09 0909 0909 0909 0909 0970 6c6f 745f  ...........plot_
-00064330: 7479 7065 203d 2073 6361 6c65 5f74 7970  type = scale_typ
-00064340: 652c 206c 696e 6577 6964 7468 203d 206c  e, linewidth = l
-00064350: 696e 6577 6964 7468 290d 0a09 0909 0909  inewidth).......
-00064360: 0966 6f72 2065 6e74 2069 6e20 5b27 2567  .for ent in ['%g
-00064370: 206e 6d27 2561 202b 2027 5f27 202b 2073   nm'%a + '_' + s
-00064380: 7472 286f 2e66 696c 656e 616d 6529 2066  tr(o.filename) f
-00064390: 6f72 2061 2069 6e20 7265 6c5f 7761 7665  or a in rel_wave
-000643a0: 5d3a 0d0a 0909 0909 0909 096c 6162 2e61  ]:.........lab.a
-000643b0: 7070 656e 6428 656e 7429 0d0a 0909 0909  ppend(ent)......
-000643c0: 0909 6861 6e64 6c65 732c 206c 6162 656c  ..handles, label
-000643d0: 733d 6178 2e67 6574 5f6c 6567 656e 645f  s=ax.get_legend_
-000643e0: 6861 6e64 6c65 735f 6c61 6265 6c73 2829  handles_labels()
-000643f0: 0d0a 0909 0909 0909 666f 7220 6861 2069  ........for ha i
-00064400: 6e20 6861 6e64 6c65 735b 2d6c 656e 2872  n handles[-len(r
-00064410: 656c 5f77 6176 6529 3a5d 3a0d 0a09 0909  el_wave):]:.....
-00064420: 0909 0909 6861 6e64 2e61 7070 656e 6428  ....hand.append(
-00064430: 6861 290d 0a09 0909 0961 782e 7365 745f  ha)......ax.set_
-00064440: 7469 746c 6528 2763 6f6d 7061 7265 206d  title('compare m
-00064450: 6561 7375 7265 6420 616e 6420 736d 6f6f  easured and smoo
-00064460: 7468 6564 2064 6174 6120 6174 2067 6976  thed data at giv
-00064470: 656e 2077 6176 656c 656e 6774 6827 290d  en wavelength').
-00064480: 0a09 0909 0969 6620 6e6f 726d 5f77 696e  .....if norm_win
-00064490: 646f 7720 6973 206e 6f74 204e 6f6e 653a  dow is not None:
-000644a0: 0d0a 0909 0909 0961 782e 7365 745f 7469  .......ax.set_ti
-000644b0: 746c 6528 2763 6f6d 7061 7265 206d 6561  tle('compare mea
-000644c0: 7375 7265 6420 616e 6420 736d 6f6f 7468  sured and smooth
-000644d0: 6564 2064 6174 6120 6174 2067 6976 656e  ed data at given
-000644e0: 2077 6176 656c 656e 6774 6820 5c6e 2073   wavelength \n s
-000644f0: 6361 6c65 6420 746f 2074 3d25 6720 7073  caled to t=%g ps
-00064500: 203a 2025 6720 7073 202c 2077 6c3d 2025   : %g ps , wl= %
-00064510: 6720 6e6d 3a20 2567 206e 6d27 2528 6e6f  g nm: %g nm'%(no
-00064520: 726d 5f77 696e 646f 775b 305d 2c6e 6f72  rm_window[0],nor
-00064530: 6d5f 7769 6e64 6f77 5b31 5d2c 6e6f 726d  m_window[1],norm
-00064540: 5f77 696e 646f 775b 325d 2c6e 6f72 6d5f  _window[2],norm_
-00064550: 7769 6e64 6f77 5b33 5d29 290d 0a09 0909  window[3])).....
-00064560: 0961 782e 6c65 6765 6e64 2868 616e 642c  .ax.legend(hand,
-00064570: 6c61 6229 0d0a 0909 6966 2073 656c 662e  lab)....if self.
-00064580: 7361 7665 5f66 6967 7572 6573 5f74 6f5f  save_figures_to_
-00064590: 666f 6c64 6572 3a20 200d 0a09 0909 6669  folder:  .....fi
-000645a0: 672e 7361 7665 6669 6728 6368 6563 6b5f  g.savefig(check_
-000645b0: 666f 6c64 6572 2870 6174 683d 7365 6c66  folder(path=self
-000645c0: 2e66 6967 7572 655f 7061 7468 2c66 696c  .figure_path,fil
-000645d0: 656e 616d 653d 2763 6f6d 7061 7265 5f61  ename='compare_a
-000645e0: 745f 7761 7665 5f25 732e 706e 6727 2527  t_wave_%s.png'%'
-000645f0: 5f27 2e6a 6f69 6e28 5b27 2567 2725 6120  _'.join(['%g'%a 
-00064600: 666f 7220 6120 696e 2072 656c 5f77 6176  for a in rel_wav
-00064610: 655d 2929 2c0d 0a09 0909 6262 6f78 5f69  e])),.....bbox_i
-00064620: 6e63 6865 733d 2774 6967 6874 2729 0d0a  nches='tight')..
-00064630: 0909 0972 6574 7572 6e20 6178 0d0a 0d0a  ...return ax....
-00064640: 0d0a 0964 6566 2043 6f6d 7061 7265 5f44  ...def Compare_D
-00064650: 4143 2873 656c 662c 206f 7468 6572 203d  AC(self, other =
-00064660: 204e 6f6e 652c 2073 7065 6374 7261 203d   None, spectra =
-00064670: 204e 6f6e 652c 2073 6570 6172 6174 655f   None, separate_
-00064680: 706c 6f74 7320 3d20 4661 6c73 652c 2063  plots = False, c
-00064690: 6d61 7020 3d20 4e6f 6e65 293a 0d0a 0909  map = None):....
-000646a0: 2727 2754 6869 7320 6973 2061 2063 6f6e  '''This is a con
-000646b0: 7665 6e69 656e 6365 2066 756e 6374 696f  venience functio
-000646c0: 6e20 746f 2070 6c6f 7420 6d75 6c74 6970  n to plot multip
-000646d0: 6c65 2065 7874 7261 6374 6564 2073 7065  le extracted spe
-000646e0: 6374 7261 200d 0a09 0928 4441 5320 6f72  ctra ....(DAS or
-000646f0: 2073 7065 6369 6573 2061 7373 6f63 6961   species associa
-00064700: 7465 6429 2069 6e74 6f20 7468 6520 7361  ted) into the sa
-00064710: 6d65 2066 6967 7572 6520 6f72 2069 6e74  me figure or int
-00064720: 6f20 6120 7365 7061 7261 7465 2066 6967  o a separate fig
-00064730: 7572 650d 0a09 0965 6163 682e 204f 7468  ure....each. Oth
-00064740: 6572 2073 686f 756c 6420 6265 2074 612e  er should be ta.
-00064750: 706c 6f74 5f66 756e 6320 6f62 6a65 6374  plot_func object
-00064760: 7320 286c 6f61 6465 6420 6f72 2063 6f70  s (loaded or cop
-00064770: 6965 6429 2e20 4279 0d0a 0909 7374 616e  ied). By....stan
-00064780: 6461 7264 2069 7420 706c 6f74 7320 616c  dard it plots al
-00064790: 6c20 696e 746f 2074 6865 2073 616d 6520  l into the same 
-000647a0: 7769 6e64 6f77 2e20 4966 2061 6c6c 2070  window. If all p
-000647b0: 726f 6a65 6374 2068 6176 6520 7468 6520  roject have the 
-000647c0: 7361 6d65 0d0a 0909 6e75 6d62 6572 206f  same....number o
-000647d0: 6620 636f 6d70 6f6e 656e 7473 206f 6e65  f components one
-000647e0: 2063 616e 2061 6374 6976 6174 6520 2273   can activate "s
-000647f0: 6570 6172 6174 655f 706c 6f74 7322 2061  eparate_plots" a
-00064800: 6e64 2068 6176 6520 6561 6368 0d0a 0909  nd have each....
-00064810: 7365 7061 7261 7465 6420 2869 6e20 7468  separated (in th
-00064820: 6520 6f72 6465 7220 6372 6561 7465 6420  e order created 
-00064830: 696e 2074 6865 2070 726f 6a65 6374 7329  in the projects)
-00064840: 2e0d 0a0d 0a09 0954 6865 2022 5370 6563  .......The "Spec
-00064850: 7472 6122 2070 6172 616d 6574 6572 2061  tra" parameter a
-00064860: 6c6c 6f77 7320 6173 2062 6566 6f72 6520  llows as before 
-00064870: 7468 6520 696e 636c 7573 696f 6e20 6f66  the inclusion of
-00064880: 2061 6e20 6578 7465 726e 616c 0d0a 0909   an external....
-00064890: 7370 6563 7472 756d 2e20 4f74 6865 7273  spectrum. Others
-000648a0: 2069 7320 6f70 7469 6f6e 616c 2061 6e64   is optional and
-000648b0: 2049 2075 7365 2074 6869 7320 6675 6e63   I use this func
-000648c0: 7469 6f6e 206f 6674 656e 2074 6f20 636f  tion often to co
-000648d0: 6d70 6172 650d 0a09 0973 7065 6369 6573  mpare....species
-000648e0: 2061 7373 6f63 6961 7465 6420 7370 6563   associated spec
-000648f0: 7472 6120 7769 7468 206f 6e65 206f 7220  tra with one or 
-00064900: 6d75 6c74 6970 6c65 2073 7465 6164 7920  multiple steady 
-00064910: 7374 6174 6520 7370 6563 7472 612e 0d0a  state spectra...
-00064920: 0909 0d0a 0909 5061 7261 6d65 7465 7273  ......Parameters
-00064930: 0d0a 0909 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ....------------
-00064940: 2d2d 0d0a 0909 090d 0a09 096f 7468 6572  --.........other
-00064950: 203a 2054 4120 6f62 6a65 6374 206f 7220   : TA object or 
-00064960: 6c69 7374 206f 6620 7468 6f73 652c 206f  list of those, o
-00064970: 7074 696f 6e61 6c20 0d0a 0909 0973 686f  ptional .....sho
-00064980: 756c 6420 6265 2074 612e 706c 6f74 5f66  uld be ta.plot_f
-00064990: 756e 6320 6f62 6a65 6374 7320 286c 6f61  unc objects (loa
-000649a0: 6465 6420 6f72 2063 6f70 6965 6429 2061  ded or copied) a
-000649b0: 6e64 2069 7320 7768 6174 200d 0a09 0909  nd is what .....
-000649c0: 6973 2070 6c6f 7474 6564 2061 6761 696e  is plotted again
-000649d0: 7374 2074 6865 2064 6174 6120 7573 6520  st the data use 
-000649e0: 6120 6c69 7374 205b 7461 312c 7461 322c  a list [ta1,ta2,
-000649f0: 2e2e 2e20 5d20 6f72 2067 656e 6572 6174  ... ] or generat
-00064a00: 6520 7468 6973 0d0a 0909 096c 6973 7420  e this.....list 
-00064a10: 7573 696e 6720 7468 6520 4775 6920 6675  using the Gui fu
-00064a20: 6e63 7469 6f6e 2e20 5365 6520 7365 6374  nction. See sect
-00064a30: 696f 6e20 3a72 6566 3a60 4f70 656e 696e  ion :ref:`Openin
-00064a40: 6720 6d75 6c74 6970 6c65 2066 696c 6573  g multiple files
-00064a50: 6020 696e 200d 0a09 0909 7468 6520 646f  ` in .....the do
-00064a60: 6375 6d65 6e74 6174 696f 6e0d 0a0d 0a09  cumentation.....
-00064a70: 0973 7065 6374 7261 203a 204e 6f6e 6520  .spectra : None 
-00064a80: 6f72 2044 6174 6146 7261 6d65 2c20 6f70  or DataFrame, op
-00064a90: 7469 6f6e 616c 0d0a 0909 0949 6620 616e  tional.....If an
-00064aa0: 2044 6174 6146 7261 6d65 2077 6974 6820   DataFrame with 
-00064ab0: 7468 6520 7761 7665 6c65 6e67 7468 2061  the wavelength a
-00064ac0: 7320 696e 6465 7820 6973 2070 726f 7669  s index is provi
-00064ad0: 6465 642c 2054 6865 6e20 7468 6520 7370  ded, Then the sp
-00064ae0: 6563 7472 6120 6f66 2065 6163 6820 636f  ectra of each co
-00064af0: 6c75 6d6e 0d0a 0909 0969 7320 706c 6f74  lumn.....is plot
-00064b00: 7465 6420 696e 746f 2074 6865 2064 6966  ted into the dif
-00064b10: 6665 7265 6e74 6961 6c20 7370 6563 7472  ferential spectr
-00064b20: 6120 313a 3120 616e 6420 7468 6520 636f  a 1:1 and the co
-00064b30: 6c75 6d6e 206e 616d 6573 2061 7265 2075  lumn names are u
-00064b40: 7365 6420 696e 2074 6865 206c 6567 656e  sed in the legen
-00064b50: 640d 0a09 0909 5072 696f 7220 7363 616c  d.....Prior scal
-00064b60: 696e 6720 6973 2068 6967 686c 7920 7375  ing is highly su
-00064b70: 6767 6573 7465 642e 2054 6865 7365 2073  ggested. These s
-00064b80: 7065 6374 7261 2061 7265 206e 6f74 2028  pectra are not (
-00064b90: 696e 2067 656e 6572 616c 2920 7363 616c  in general) scal
-00064ba0: 6564 2077 6974 6820 7468 6520 0d0a 0909  ed with the ....
-00064bb0: 096e 6f72 6d20 7769 6e64 6f77 2e20 2873  .norm window. (s
-00064bc0: 6565 2065 7861 6d70 6c65 7329 0d0a 0d0a  ee examples)....
-00064bd0: 0909 7365 7061 7261 7465 5f70 6c6f 7473  ..separate_plots
-00064be0: 203a 2062 6f6f 6c2c 206f 7074 696f 6e61   : bool, optiona
-00064bf0: 6c0d 0a09 0909 5472 7565 206f 7220 4661  l.....True or Fa
-00064c00: 6c73 6520 2844 6566 6175 6c74 292c 2073  lse (Default), s
-00064c10: 6570 6172 6174 6520 706c 6f74 7320 6973  eparate plots is
-00064c20: 2074 6865 2073 7769 7463 6820 7468 6174   the switch that
-00064c30: 2064 6563 6964 6573 2069 6620 6120 6178   decides if a ax
-00064c40: 6973 206f 7220 0d0a 0909 096d 756c 7469  is or .....multi
-00064c50: 706c 6520 6178 6973 2061 7265 2075 7365  ple axis are use
-00064c60: 642e 2054 6869 7320 6f70 7469 6f6e 2077  d. This option w
-00064c70: 696c 6c20 7265 7375 6c74 2069 6e20 6120  ill result in a 
-00064c80: 6372 6173 6820 756e 6c65 7373 2061 6c6c  crash unless all
-00064c90: 206f 626a 6563 7473 2068 6176 6520 7468   objects have th
-00064ca0: 650d 0a09 0909 7361 6d65 206e 756d 6265  e.....same numbe
-00064cb0: 7220 6f66 2044 4153 2f53 4153 2063 6f6d  r of DAS/SAS com
-00064cc0: 706f 6e65 6e74 730d 0a09 0909 090d 0a09  ponents.........
-00064cd0: 0963 6d61 7020 3a20 4e6f 6e65 206f 7220  .cmap : None or 
-00064ce0: 6d61 7470 6c6f 746c 6962 2063 6f6c 6f72  matplotlib color
-00064cf0: 206d 6170 2c20 6f70 7469 6f6e 616c 0d0a   map, optional..
-00064d00: 0909 0969 7320 6120 706f 7765 7266 756c  ...is a powerful
-00064d10: 6c20 7661 7269 6162 6c65 2074 6861 7420  l variable that 
-00064d20: 6368 6f6f 7365 7320 7468 6520 636f 6c6f  chooses the colo
-00064d30: 7572 206d 6170 2061 7070 6c69 6564 2066  ur map applied f
-00064d40: 6f72 2061 6c6c 2070 6c6f 7473 2e20 4966  or all plots. If
-00064d50: 2073 6574 2074 6f20 0d0a 0909 094e 6f6e   set to .....Non
-00064d60: 6520 2844 6566 6175 6c74 2920 7468 656e  e (Default) then
-00064d70: 2074 6865 2073 656c 662e 636d 6170 2069   the self.cmap i
-00064d80: 7320 7573 6564 2e0d 0a09 0909 4173 2073  s used......As s
-00064d90: 7461 6e64 6172 6420 4920 7573 6520 7468  tandard I use th
-00064da0: 6520 636f 6c6f 7220 6d61 7020 226a 6574  e color map "jet
-00064db0: 2220 6672 6f6d 206d 6174 706c 6f74 6c69  " from matplotli
-00064dc0: 622e 2054 6865 7265 2061 7265 2061 2076  b. There are a v
-00064dd0: 6172 6965 7479 206f 6620 636f 6c6f 726d  ariety of colorm
-00064de0: 6170 7320 0d0a 0909 0961 7661 696c 6162  aps .....availab
-00064df0: 6c65 2074 6861 7420 6172 6520 7665 7279  le that are very
-00064e00: 2075 7365 6675 6c6c 2e20 4265 7369 6465   usefull. Beside
-00064e10: 2022 6a65 7422 2c20 2276 6972 6964 6973   "jet", "viridis
-00064e20: 2220 6973 2061 2067 6f6f 6420 6368 6f69  " is a good choi
-00064e30: 6365 2061 7320 6974 2069 7320 7765 6c6c  ce as it is well
-00064e40: 200d 0a09 0909 7669 7369 626c 6520 756e   .....visible un
-00064e50: 6465 7220 7265 642d 6772 6565 6e20 626c  der red-green bl
-00064e60: 696e 646e 6573 732e 204f 7468 6572 2075  indness. Other u
-00064e70: 7365 6675 6c20 6d61 7073 2061 7265 2022  seful maps are "
-00064e80: 7072 6973 6d22 2066 6f72 2068 6967 6820  prism" for high 
-00064e90: 666c 7563 7475 6174 696f 6e73 200d 0a09  fluctuations ...
-00064ea0: 0909 6f72 2064 6976 6572 6769 6e67 2063  ..or diverging c
-00064eb0: 6f6c 6f72 206d 6170 7320 6c69 6b65 2022  olor maps like "
-00064ec0: 7365 6973 6d69 6322 2e20 0d0a 0909 0953  seismic". .....S
-00064ed0: 6565 2068 7474 7073 3a2f 2f6d 6174 706c  ee https://matpl
-00064ee0: 6f74 6c69 622e 6f72 672f 332e 312e 302f  otlib.org/3.1.0/
-00064ef0: 7475 746f 7269 616c 732f 636f 6c6f 7273  tutorials/colors
-00064f00: 2f63 6f6c 6f72 6d61 7073 2e68 746d 6c20  /colormaps.html 
-00064f10: 666f 7220 6120 636f 6d70 7265 6865 6e73  for a comprehens
-00064f20: 6976 6520 0d0a 0909 0973 656c 6563 7469  ive .....selecti
-00064f30: 6f6e 2e20 496e 2074 6865 2063 6f64 6520  on. In the code 
-00064f40: 7468 6520 636f 6c6f 726d 6170 7320 6172  the colormaps ar
-00064f50: 6520 696d 706f 7274 6564 2073 6f20 6966  e imported so if
-00064f60: 2070 6c6f 745f 6675 6e63 2069 7320 696d   plot_func is im
-00064f70: 706f 7274 6564 2061 7320 7066 2074 6865  ported as pf the
-00064f80: 6e20 0d0a 0909 0973 656c 662e 636d 6170  n .....self.cmap
-00064f90: 3d70 662e 636d 2e76 6972 6964 6973 2073  =pf.cm.viridis s
-00064fa0: 6574 7320 7669 7269 6469 7320 6173 2074  ets viridis as t
-00064fb0: 6865 206d 6170 2074 6f20 7573 652e 2049  he map to use. I
-00064fc0: 6e74 6572 6e61 6c6c 7920 7468 6520 636f  nternally the co
-00064fd0: 6c6f 7273 2061 7265 2063 686f 7365 6e20  lors are chosen 
-00064fe0: 0d0a 0909 0977 6974 6820 7468 6520 2263  .....with the "c
-00064ff0: 6f6c 6d22 2066 756e 6374 696f 6e2e 2054  olm" function. T
-00065000: 6865 2032 6420 706c 6f74 7320 7265 7175  he 2d plots requ
-00065010: 6972 6520 6120 636f 6e74 696e 756f 7573  ire a continuous
-00065020: 2063 6f6c 6f72 206d 6170 2073 6f20 6966   color map so if
-00065030: 2073 6f6d 6574 6869 6e67 200d 0a09 0909   something .....
-00065040: 656c 7365 2069 7320 6769 7665 2032 6420  else is give 2d 
-00065050: 706c 6f74 7320 6172 6520 7368 6f77 6e20  plots are shown 
-00065060: 6175 746f 6d61 7469 6361 6c6c 7920 7769  automatically wi
-00065070: 7468 2022 6a65 7422 2e20 466f 7220 616c  th "jet". For al
-00065080: 6c20 6f66 2074 6865 2031 6420 706c 6f74  l of the 1d plot
-00065090: 7320 686f 7765 7665 7220 0d0a 0909 0949  s however .....I
-000650a0: 2066 6972 7374 2073 656c 6563 7420 6120   first select a 
-000650b0: 6e75 6d62 6572 206f 6620 636f 6c6f 7273  number of colors
-000650c0: 2062 6566 6f72 6520 6561 6368 2070 6c6f   before each plo
-000650d0: 742e 2049 6620 636d 6170 2069 7320 6120  t. If cmap is a 
-000650e0: 636f 6e74 696e 6f75 7320 6d61 7020 7468  continous map th
-000650f0: 656e 2074 6865 7365 0d0a 0909 0961 7265  en these.....are
-00065100: 2073 616d 706c 6564 2065 7665 6e6c 7920   sampled evenly 
-00065110: 6f76 6572 2074 6865 2063 6f6c 6f75 726d  over the colourm
-00065120: 6170 2e20 4d61 6e75 616c 2069 7465 7261  ap. Manual itera
-00065130: 626c 6573 206f 6620 636f 6c6f 7572 7320  bles of colours 
-00065140: 0d0a 0909 0963 6d61 703d 5b28 312c 302c  .....cmap=[(1,0,
-00065150: 3029 2c28 302c 312c 3029 2c28 302c 302c  0),(0,1,0),(0,0,
-00065160: 3129 2c2e 2e2e 5d20 6172 6520 616c 736f  1),...] are also
-00065170: 2061 6363 6570 7465 642c 2061 7320 6172   accepted, as ar
-00065180: 6520 7665 6374 6f72 7320 6f72 2064 6174  e vectors or dat
-00065190: 6166 7261 6d65 7320 7468 6174 200d 0a09  aframes that ...
-000651a0: 0909 636f 6e74 6169 6e20 6173 2072 6f77  ..contain as row
-000651b0: 7320 7468 6520 636f 6c6f 7273 2e20 5468  s the colors. Th
-000651c0: 6572 6520 6d75 7374 2062 6520 6f66 2063  ere must be of c
-000651d0: 6f75 7273 6520 7375 6666 6963 6965 6e74  ourse sufficient
-000651e0: 2063 6f6c 6f72 7320 7072 6573 656e 7420   colors present 
-000651f0: 666f 7220 0d0a 0909 0974 6865 206e 756d  for .....the num
-00065200: 6265 7273 206f 6620 6c69 6e65 7320 7468  bers of lines th
-00065210: 6174 2077 696c 6c20 6265 2070 6c6f 7474  at will be plott
-00065220: 6564 2e20 536f 2049 2072 6563 6f6d 6d65  ed. So I recomme
-00065230: 6e64 2074 6f20 7072 6f76 6964 6520 6174  nd to provide at
-00065240: 206c 6561 7374 2031 3020 636f 6c6f 7572   least 10 colour
-00065250: 7320 0d0a 0909 0928 652e 672e 7e79 6f75  s .....(e.g.~you
-00065260: 7220 756e 6976 6572 7369 7479 2063 6f6c  r university col
-00065270: 6f72 7329 2e20 636f 6c6f 7572 7320 6172  ors). colours ar
-00065280: 6520 616c 7761 7973 2067 6976 656e 2061  e always given a
-00065290: 7320 612c 206c 6973 7420 6f72 2074 7570  s a, list or tup
-000652a0: 6c65 2077 6974 6820 5247 4120 6f72 2052  le with RGA or R
-000652b0: 4742 410d 0a09 0909 2877 6974 6820 7468  GBA.....(with th
-000652c0: 6520 6c61 7374 2041 2062 6565 696e 6720  e last A beeing 
-000652d0: 7468 6520 416c 7068 613d 7472 616e 7370  the Alpha=transp
-000652e0: 6172 656e 6379 2e20 416c 6c20 6e75 6d62  arency. All numb
-000652f0: 6572 7320 6172 6520 6265 7477 6565 6e20  ers are between 
-00065300: 3020 616e 6420 312e 200d 0a09 0909 4966  0 and 1. .....If
-00065310: 2061 206c 6973 742f 7665 6374 6f72 2f44   a list/vector/D
-00065320: 6174 6146 7261 6d65 2069 7320 6769 7665  ataFrame is give
-00065330: 6e20 666f 7220 7468 6520 636f 6c6f 7572  n for the colour
-00065340: 7320 7468 6579 2077 696c 6c20 6265 2075  s they will be u
-00065350: 7365 6420 696e 2074 6865 206f 7264 6572  sed in the order
-00065360: 2070 726f 7669 6465 642e 0d0a 0909 0d0a   provided.......
-00065370: 0909 4578 616d 706c 6573 0d0a 0909 2d2d  ..Examples....--
-00065380: 2d2d 2d2d 2d2d 0d0a 0909 0d0a 0909 3e3e  ------........>>
-00065390: 3e20 696d 706f 7274 2070 6c6f 745f 6675  > import plot_fu
-000653a0: 6e63 2061 7320 7066 0d0a 0909 3e3e 3e20  nc as pf....>>> 
-000653b0: 7461 203d 2070 662e 5441 2827 7465 7374  ta = pf.TA('test
-000653c0: 312e 6864 6635 2729 2023 6f70 656e 2074  1.hdf5') #open t
-000653d0: 6865 206f 7269 6769 6e61 6c20 7072 6f6a  he original proj
-000653e0: 6563 742c 200d 0a09 093e 3e3e 2074 6869  ect, ....>>> thi
-000653f0: 7320 4d55 5354 2063 6f6e 7461 696e 2061  s MUST contain a
-00065400: 2066 6974 2c20 6f74 6865 7277 6973 6520   fit, otherwise 
-00065410: 7468 6973 2077 696c 6c20 7261 6973 6520  this will raise 
-00065420: 616e 2065 7272 6f72 0d0a 0909 0d0a 0909  an error........
-00065430: 4e6f 7720 6f70 656e 2061 2062 756e 6368  Now open a bunch
-00065440: 206f 6620 6f74 6865 7220 7072 6f6a 6563   of other projec
-00065450: 7473 2074 6f20 636f 6d70 6172 6520 6167  ts to compare ag
-00065460: 6169 6e73 742c 0d0a 0909 0d0a 0909 3e3e  ainst,........>>
-00065470: 3e20 2363 6f6d 7061 7265 2069 6e20 6120  > #compare in a 
-00065480: 7369 6e67 6c65 2077 696e 646f 770d 0a09  single window...
-00065490: 093e 3e3e 206f 7468 6572 5f70 726f 6a65  .>>> other_proje
-000654a0: 6374 7320 3d20 7066 2e47 5549 5f6f 7065  cts = pf.GUI_ope
-000654b0: 6e28 7072 6f6a 6563 745f 6c69 7374 203d  n(project_list =
-000654c0: 205b 2766 696c 6531 2e68 6466 3527 2c20   ['file1.hdf5', 
-000654d0: 2766 696c 6532 2e68 6466 3527 5d29 0d0a  'file2.hdf5'])..
-000654e0: 0909 3e3e 3e20 7461 2e43 6f6d 7061 7265  ..>>> ta.Compare
-000654f0: 5f44 4143 286f 7468 6572 7320 3d20 6f74  _DAC(others = ot
-00065500: 6865 725f 7072 6f6a 6563 7429 0d0a 0909  her_project)....
-00065510: 3e3e 3e20 2363 6f6d 7072 6172 6520 696e  >>> #comprare in
-00065520: 2073 6570 6172 6174 6520 7769 6e64 6f77   separate window
-00065530: 732c 200d 0a09 093e 3e3e 2023 7468 6520  s, ....>>> #the 
-00065540: 6f74 6865 7220 7072 6f6a 6563 7473 206d  other projects m
-00065550: 7573 7420 6861 7665 2074 6865 2073 616d  ust have the sam
-00065560: 6520 6e75 6d62 6572 206f 6620 636f 6d70  e number of comp
-00065570: 6f6e 656e 7473 0d0a 0909 3e3e 3e20 7461  onents....>>> ta
-00065580: 2e43 6f6d 7061 7265 5f44 4143 286f 7468  .Compare_DAC(oth
-00065590: 6572 7320 3d20 6f74 6865 725f 7072 6f6a  ers = other_proj
-000655a0: 6563 742c 2073 6570 6172 6174 655f 706c  ect, separate_pl
-000655b0: 6f74 7320 3d20 5472 7565 290d 0a09 090d  ots = True).....
-000655c0: 0a09 0943 6f6d 7061 7265 2074 6865 2044  ...Compare the D
-000655d0: 4143 2074 6f20 616e 2065 7874 6572 6e61  AC to an externa
-000655e0: 6c20 7370 6563 7472 756d 0d0a 0909 0d0a  l spectrum......
-000655f0: 0909 3e3e 3e20 6578 745f 7370 6563 203d  ..>>> ext_spec =
-00065600: 2070 642e 7265 6164 5f63 7376 2827 4173   pd.read_csv('As
-00065610: 6369 695f 7370 6563 7472 756d 2e64 6174  cii_spectrum.dat
-00065620: 272c 2073 6570 203d 2027 2c27 290d 0a09  ', sep = ',')...
-00065630: 093e 3e3e 2074 612e 436f 6d70 6172 655f  .>>> ta.Compare_
-00065640: 4441 4328 7370 6563 7472 6120 3d20 6578  DAC(spectra = ex
-00065650: 745f 7370 6563 2920 2363 6f6d 7061 7265  t_spec) #compare
-00065660: 206a 7573 7420 7468 6520 6375 7272 656e   just the curren
-00065670: 7420 736f 6c75 7469 6f6e 0d0a 0909 3e3e  t solution....>>
-00065680: 3e20 7461 2e43 6f6d 7061 7265 5f44 4143  > ta.Compare_DAC
-00065690: 2873 7065 6374 7261 203d 2065 7874 5f73  (spectra = ext_s
-000656a0: 7065 632c 206f 7468 6572 7320 3d20 6f74  pec, others = ot
-000656b0: 6865 725f 7072 6f6a 6563 7429 2023 636f  her_project) #co
-000656c0: 6d70 6172 6520 6d75 6c74 6970 6c65 0d0a  mpare multiple..
-000656d0: 0909 0d0a 0909 2727 270d 0a09 090d 0a09  ......'''.......
-000656e0: 0969 6620 7365 6c66 2e73 6176 655f 6669  .if self.save_fi
-000656f0: 6775 7265 735f 746f 5f66 6f6c 6465 723a  gures_to_folder:
-00065700: 7365 6c66 2e66 6967 7572 655f 7061 7468  self.figure_path
-00065710: 203d 2063 6865 636b 5f66 6f6c 6465 7228   = check_folder(
-00065720: 7061 7468 203d 2027 7265 7375 6c74 5f66  path = 'result_f
-00065730: 6967 7572 6573 272c 2063 7572 7265 6e74  igures', current
-00065740: 5f70 6174 6820 3d20 7365 6c66 2e70 6174  _path = self.pat
-00065750: 6829 0d0a 0909 6966 206f 7468 6572 2069  h)....if other i
-00065760: 7320 6e6f 7420 4e6f 6e65 3a0d 0a09 0909  s not None:.....
-00065770: 6966 206e 6f74 2068 6173 6174 7472 286f  if not hasattr(o
-00065780: 7468 6572 2c20 275f 5f69 7465 725f 5f27  ther, '__iter__'
-00065790: 293a 6f74 6865 7220 3d20 5b6f 7468 6572  ):other = [other
-000657a0: 5d0d 0a09 0974 7279 3a0d 0a09 0909 7265  ]....try:.....re
-000657b0: 203d 2073 656c 662e 7265 2e63 6f70 7928   = self.re.copy(
-000657c0: 290d 0a09 0965 7863 6570 743a 0d0a 0909  )....except:....
-000657d0: 0970 7269 6e74 2822 4e6f 2066 6974 7465  .print("No fitte
-000657e0: 6420 7265 7375 6c74 7320 7072 6573 656e  d results presen
-000657f0: 7422 290d 0a09 0909 7265 7475 726e 2046  t").....return F
-00065800: 616c 7365 0d0a 0909 6966 2063 6d61 7020  alse....if cmap 
-00065810: 6973 204e 6f6e 653a 636d 6170 203d 2073  is None:cmap = s
-00065820: 656c 662e 636d 6170 0d0a 0909 7370 6563  elf.cmap....spec
-00065830: 6965 733d 7265 5b27 4441 4327 5d2e 636f  ies=re['DAC'].co
-00065840: 6c75 6d6e 732e 7661 6c75 6573 0d0a 0909  lumns.values....
-00065850: 6966 206f 7468 6572 2069 7320 4e6f 6e65  if other is None
-00065860: 3a0d 0a09 0909 636f 6c20 3d20 7261 6e67  :.....col = rang
-00065870: 6528 6c65 6e28 7265 5b27 4441 4327 5d2e  e(len(re['DAC'].
-00065880: 636f 6c75 6d6e 732e 7661 6c75 6573 2929  columns.values))
-00065890: 0d0a 0909 0963 6f6c 6f72 7320 3d20 636f  .....colors = co
-000658a0: 6c6d 2863 6d61 7020 3d20 636d 6170 2c20  lm(cmap = cmap, 
-000658b0: 6b20 3d20 636f 6c29 0d0a 0909 090d 0a09  k = col)........
-000658c0: 0965 6c73 653a 0d0a 0909 0972 655b 2744  .else:.....re['D
-000658d0: 4143 275d 2e63 6f6c 756d 6e73 203d 205b  AC'].columns = [
-000658e0: 7365 6c66 2e66 696c 656e 616d 6520 2b20  self.filename + 
-000658f0: 275c 6e27 202b 2027 2573 2725 6120 666f  '\n' + '%s'%a fo
-00065900: 7220 6120 696e 2072 655b 2744 4143 275d  r a in re['DAC']
-00065910: 2e63 6f6c 756d 6e73 5d0d 0a09 0909 6966  .columns].....if
-00065920: 2073 6570 6172 6174 655f 706c 6f74 733a   separate_plots:
-00065930: 0d0a 0909 0909 636f 6c6f 7273 203d 2063  ......colors = c
-00065940: 6f6c 6d28 636d 6170 203d 2063 6d61 702c  olm(cmap = cmap,
-00065950: 206b 203d 206e 702e 6172 616e 6765 286c   k = np.arange(l
-00065960: 656e 286f 7468 6572 292b 3129 290d 0a09  en(other)+1))...
-00065970: 0909 656c 7365 3a0d 0a09 0909 0963 6f6c  ..else:......col
-00065980: 6f72 7320 3d20 636f 6c6d 2863 6d61 7020  ors = colm(cmap 
-00065990: 3d20 636d 6170 2c20 6b20 3d20 6e70 2e61  = cmap, k = np.a
-000659a0: 7261 6e67 6528 286c 656e 286f 7468 6572  range((len(other
-000659b0: 292b 3129 2a6c 656e 2873 7065 6369 6573  )+1)*len(species
-000659c0: 2929 290d 0a09 0944 4143 203d 2072 655b  )))....DAC = re[
-000659d0: 2744 4143 275d 0d0a 0909 6861 6e64 3d5b  'DAC']....hand=[
-000659e0: 5d0d 0a09 0969 6620 7365 7061 7261 7465  ]....if separate
-000659f0: 5f70 6c6f 7473 3a0d 0a09 0909 6e5f 636f  _plots:.....n_co
-00065a00: 6c73 203d 2069 6e74 286e 702e 6365 696c  ls = int(np.ceil
-00065a10: 286c 656e 2872 655b 2744 4143 275d 2e63  (len(re['DAC'].c
-00065a20: 6f6c 756d 6e73 292f 3229 290d 0a09 0909  olumns)/2)).....
-00065a30: 636f 6c20 3d20 5b63 6f6c 6f72 735b 305d  col = [colors[0]
-00065a40: 2066 6f72 2061 2069 6e20 7261 6e67 6528   for a in range(
-00065a50: 6c65 6e28 7265 5b27 4441 4327 5d2e 636f  len(re['DAC'].co
-00065a60: 6c75 6d6e 7329 295d 0d0a 0909 0969 6620  lumns))].....if 
-00065a70: 7365 6c66 2e73 6361 7474 6572 6375 7420  self.scattercut 
-00065a80: 6973 204e 6f6e 653a 090d 0a09 0909 0961  is None:.......a
-00065a90: 7820 3d20 4441 432e 706c 6f74 2873 7562  x = DAC.plot(sub
-00065aa0: 706c 6f74 7320 3d20 7365 7061 7261 7465  plots = separate
-00065ab0: 5f70 6c6f 7473 2c20 6669 6773 697a 6520  _plots, figsize 
-00065ac0: 3d20 2831 322c 2031 3029 2c20 6c61 796f  = (12, 10), layo
-00065ad0: 7574 203d 2028 6e5f 636f 6c73 2c20 3229  ut = (n_cols, 2)
-00065ae0: 2c20 0d0a 0909 0909 0909 0909 096c 6567  , ...........leg
-00065af0: 656e 6420 3d20 4661 6c73 652c 2063 6f6c  end = False, col
-00065b00: 6f72 203d 2063 6f6c 2c20 7368 6172 6578  or = col, sharex
-00065b10: 203d 2046 616c 7365 290d 0a0d 0a09 0909   = False).......
-00065b20: 0961 3d61 782e 7261 7665 6c28 290d 0a09  .a=ax.ravel()...
-00065b30: 0909 0968 616e 646c 6573 2c6c 6162 656c  ...handles,label
-00065b40: 733d 615b 305d 2e67 6574 5f6c 6567 656e  s=a[0].get_legen
-00065b50: 645f 6861 6e64 6c65 735f 6c61 6265 6c73  d_handles_labels
-00065b60: 2829 0d0a 0909 0909 6861 6e64 2e61 7070  ()......hand.app
-00065b70: 656e 6428 6861 6e64 6c65 735b 2d31 5d29  end(handles[-1])
-00065b80: 0d0a 0909 0965 6c69 6620 6973 696e 7374  .....elif isinst
-00065b90: 616e 6365 2873 656c 662e 7363 6174 7465  ance(self.scatte
-00065ba0: 7263 7574 5b30 5d2c 2020 6e75 6d62 6572  rcut[0],  number
-00065bb0: 732e 4e75 6d62 6572 293a 0d0a 0909 0909  s.Number):......
-00065bc0: 6178 203d 2044 4143 2e6c 6f63 5b3a 7365  ax = DAC.loc[:se
-00065bd0: 6c66 2e73 6361 7474 6572 6375 745b 305d  lf.scattercut[0]
-00065be0: 2c20 3a5d 2e70 6c6f 7428 7375 6270 6c6f  , :].plot(subplo
-00065bf0: 7473 203d 2073 6570 6172 6174 655f 706c  ts = separate_pl
-00065c00: 6f74 732c 2066 6967 7369 7a65 203d 2028  ots, figsize = (
-00065c10: 3132 2c20 3130 292c 206c 6179 6f75 7420  12, 10), layout 
-00065c20: 3d20 286e 5f63 6f6c 732c 2032 292c 200d  = (n_cols, 2), .
-00065c30: 0a09 0909 0909 0909 0909 0909 0909 6c65  ..............le
-00065c40: 6765 6e64 203d 2046 616c 7365 2c20 636f  gend = False, co
-00065c50: 6c6f 7220 3d20 636f 6c2c 2073 6861 7265  lor = col, share
-00065c60: 7820 3d20 4661 6c73 6529 0909 0909 0909  x = False)......
-00065c70: 0909 0d0a 0909 0909 613d 6178 2e72 6176  ........a=ax.rav
-00065c80: 656c 2829 0d0a 0909 0909 6861 6e64 6c65  el()......handle
-00065c90: 732c 6c61 6265 6c73 3d61 5b30 5d2e 6765  s,labels=a[0].ge
-00065ca0: 745f 6c65 6765 6e64 5f68 616e 646c 6573  t_legend_handles
-00065cb0: 5f6c 6162 656c 7328 290d 0a09 0909 0968  _labels()......h
-00065cc0: 616e 642e 6170 7065 6e64 2868 616e 646c  and.append(handl
-00065cd0: 6573 5b2d 315d 2909 0d0a 0909 0909 4441  es[-1]).......DA
-00065ce0: 435f 6375 743d 4441 432e 6c6f 635b 7365  C_cut=DAC.loc[se
-00065cf0: 6c66 2e73 6361 7474 6572 6375 745b 315d  lf.scattercut[1]
-00065d00: 3a2c 203a 5d0d 0a09 0909 0966 6f72 2069  :, :]......for i
-00065d10: 2c61 6d20 696e 2065 6e75 6d65 7261 7465  ,am in enumerate
-00065d20: 2844 4143 5f63 7574 2e63 6f6c 756d 6e73  (DAC_cut.columns
-00065d30: 293a 0d0a 0909 0909 0944 4143 5f63 7574  ):.......DAC_cut
-00065d40: 2e69 6c6f 635b 3a2c 695d 2e70 6c6f 7428  .iloc[:,i].plot(
-00065d50: 6178 203d 2061 5b69 5d2c 206c 6567 656e  ax = a[i], legen
-00065d60: 6420 3d20 4661 6c73 652c 2063 6f6c 6f72  d = False, color
-00065d70: 203d 2063 6f6c 290d 0a09 0909 656c 7365   = col).....else
-00065d80: 3a0d 0a09 0909 0973 6361 7474 6572 6375  :......scattercu
-00065d90: 7420 3d20 666c 6174 7465 6e28 7365 6c66  t = flatten(self
-00065da0: 2e73 6361 7474 6572 6375 7429 0d0a 0909  .scattercut)....
-00065db0: 0909 666f 7220 6920 696e 2072 616e 6765  ..for i in range
-00065dc0: 286c 656e 2873 6361 7474 6572 6375 7429  (len(scattercut)
-00065dd0: 2f32 2b31 293a 0d0a 0909 0909 0969 6620  /2+1):.......if 
-00065de0: 6920 3d3d 2030 3a0d 0a09 0909 0909 0961  i == 0:........a
-00065df0: 7820 3d20 4441 432e 6c6f 635b 3a73 6361  x = DAC.loc[:sca
-00065e00: 7474 6572 6375 745b 305d 2c20 3a5d 2e70  ttercut[0], :].p
-00065e10: 6c6f 7428 7375 6270 6c6f 7473 203d 2073  lot(subplots = s
-00065e20: 6570 6172 6174 655f 706c 6f74 732c 2066  eparate_plots, f
-00065e30: 6967 7369 7a65 203d 2028 3132 2c20 3130  igsize = (12, 10
-00065e40: 292c 200d 0a09 0909 0909 0909 0909 0909  ), .............
-00065e50: 0909 096c 6179 6f75 7420 3d20 286e 5f63  ...layout = (n_c
-00065e60: 6f6c 732c 2032 292c 206c 6567 656e 6420  ols, 2), legend 
-00065e70: 3d20 4661 6c73 652c 2063 6f6c 6f72 203d  = False, color =
-00065e80: 2063 6f6c 2c20 7368 6172 6578 203d 2046   col, sharex = F
-00065e90: 616c 7365 290d 0a09 0909 0909 090d 0a09  alse)...........
-00065ea0: 0909 0909 0961 3d61 782e 7261 7665 6c28  .....a=ax.ravel(
-00065eb0: 290d 0a09 0909 0909 0968 616e 646c 6573  )........handles
-00065ec0: 2c6c 6162 656c 733d 615b 305d 2e67 6574  ,labels=a[0].get
-00065ed0: 5f6c 6567 656e 645f 6861 6e64 6c65 735f  _legend_handles_
-00065ee0: 6c61 6265 6c73 2829 0d0a 0909 0909 0909  labels()........
-00065ef0: 6861 6e64 2e61 7070 656e 6428 6861 6e64  hand.append(hand
-00065f00: 6c65 735b 2d31 5d29 090d 0a09 0909 0909  les[-1])........
-00065f10: 656c 6966 2069 3c28 6c65 6e28 7363 6174  elif i<(len(scat
-00065f20: 7465 7263 7574 292f 3229 3a0d 0a09 0909  tercut)/2):.....
-00065f30: 0909 0966 6f72 206a 2c61 6d20 696e 2065  ...for j,am in e
-00065f40: 6e75 6d65 7261 7465 2861 7829 3a0d 0a09  numerate(ax):...
-00065f50: 0909 0909 0909 4441 432e 6c6f 635b 7363  ......DAC.loc[sc
-00065f60: 6174 7465 7263 7574 5b32 2a69 2d31 5d3a  attercut[2*i-1]:
-00065f70: 7363 6174 7465 7263 7574 5b32 2a69 5d2c  scattercut[2*i],
-00065f80: 203a 5d2e 706c 6f74 2861 7820 3d20 615b   :].plot(ax = a[
-00065f90: 6a5d 2c20 6c65 6765 6e64 203d 2046 616c  j], legend = Fal
-00065fa0: 7365 2c20 636f 6c6f 7220 3d20 636f 6c2c  se, color = col,
-00065fb0: 206c 6162 656c 203d 2027 5f6e 6f6c 6567   label = '_noleg
-00065fc0: 656e 645f 2729 0d0a 0909 0909 0965 6c73  end_').......els
-00065fd0: 653a 0d0a 0909 0909 0909 666f 7220 6a2c  e:........for j,
-00065fe0: 616d 2069 6e20 656e 756d 6572 6174 6528  am in enumerate(
-00065ff0: 6178 293a 0d0a 0909 0909 0909 0944 4143  ax):.........DAC
-00066000: 2e6c 6f63 5b73 6361 7474 6572 6375 745b  .loc[scattercut[
-00066010: 2d31 5d3a 2c20 3a5d 2e70 6c6f 7428 6178  -1]:, :].plot(ax
-00066020: 203d 2061 5b6a 5d2c 206c 6567 656e 6420   = a[j], legend 
-00066030: 3d20 4661 6c73 652c 2063 6f6c 6f72 203d  = False, color =
-00066040: 2063 6f6c 2c20 6c61 6265 6c20 3d20 275f   col, label = '_
-00066050: 6e6f 6c65 6765 6e64 5f27 290d 0a09 0965  nolegend_')....e
-00066060: 6c73 653a 0d0a 0909 0969 6620 7365 6c66  lse:.....if self
-00066070: 2e73 6361 7474 6572 6375 7420 6973 204e  .scattercut is N
-00066080: 6f6e 653a 090d 0a09 0909 0961 7820 203d  one:.......ax  =
-00066090: 2020 4441 432e 706c 6f74 2873 7562 706c    DAC.plot(subpl
-000660a0: 6f74 7320 3d20 7365 7061 7261 7465 5f70  ots = separate_p
-000660b0: 6c6f 7473 2c20 6669 6773 697a 6520 3d20  lots, figsize = 
-000660c0: 2831 362c 2038 292c 206c 6567 656e 6420  (16, 8), legend 
-000660d0: 3d20 4661 6c73 652c 2063 6f6c 6f72 203d  = False, color =
-000660e0: 2063 6f6c 6f72 735b 3a6c 656e 2873 7065   colors[:len(spe
-000660f0: 6369 6573 295d 2c20 6c61 6265 6c20 3d20  cies)], label = 
-00066100: 275f 6e6f 6c65 6765 6e64 5f27 290d 0a09  '_nolegend_')...
-00066110: 0909 656c 6966 2069 7369 6e73 7461 6e63  ..elif isinstanc
-00066120: 6528 7365 6c66 2e73 6361 7474 6572 6375  e(self.scattercu
-00066130: 745b 305d 2c20 6e75 6d62 6572 732e 4e75  t[0], numbers.Nu
-00066140: 6d62 6572 293a 0d0a 0909 0909 6178 2020  mber):......ax  
-00066150: 3d20 2044 4143 2e6c 6f63 5b3a 7365 6c66  =  DAC.loc[:self
-00066160: 2e73 6361 7474 6572 6375 745b 305d 2c20  .scattercut[0], 
-00066170: 3a5d 2e70 6c6f 7428 7375 6270 6c6f 7473  :].plot(subplots
-00066180: 203d 2073 6570 6172 6174 655f 706c 6f74   = separate_plot
-00066190: 732c 2066 6967 7369 7a65 203d 2028 3136  s, figsize = (16
-000661a0: 2c20 3829 2c20 6c65 6765 6e64 203d 2046  , 8), legend = F
-000661b0: 616c 7365 2c20 636f 6c6f 7220 3d20 636f  alse, color = co
-000661c0: 6c6f 7273 5b3a 6c65 6e28 7370 6563 6965  lors[:len(specie
-000661d0: 7329 5d2c 206c 6162 656c 203d 2027 5f6e  s)], label = '_n
-000661e0: 6f6c 6567 656e 645f 2729 0d0a 0909 0909  olegend_')......
-000661f0: 6178 2020 3d20 2044 4143 2e6c 6f63 5b73  ax  =  DAC.loc[s
-00066200: 656c 662e 7363 6174 7465 7263 7574 5b31  elf.scattercut[1
-00066210: 5d3a 2c20 203a 5d2e 706c 6f74 2861 783d  ]:,  :].plot(ax=
-00066220: 6178 2c20 7375 6270 6c6f 7473 203d 2073  ax, subplots = s
-00066230: 6570 6172 6174 655f 706c 6f74 732c 2066  eparate_plots, f
-00066240: 6967 7369 7a65 203d 2028 3136 2c20 3829  igsize = (16, 8)
-00066250: 2c20 6c65 6765 6e64 203d 2046 616c 7365  , legend = False
-00066260: 2c20 636f 6c6f 7220 3d20 636f 6c6f 7273  , color = colors
-00066270: 5b3a 6c65 6e28 7370 6563 6965 7329 5d2c  [:len(species)],
-00066280: 206c 6162 656c 203d 2027 5f6e 6f6c 6567   label = '_noleg
-00066290: 656e 645f 2729 0d0a 0909 0965 6c73 653a  end_').....else:
-000662a0: 0d0a 0909 0909 7363 6174 7465 7263 7574  ......scattercut
-000662b0: 2020 3d20 2066 6c61 7474 656e 2873 656c    =  flatten(sel
-000662c0: 662e 7363 6174 7465 7263 7574 290d 0a09  f.scattercut)...
-000662d0: 0909 0966 6f72 2069 2069 6e20 7261 6e67  ...for i in rang
-000662e0: 6528 6c65 6e28 7363 6174 7465 7263 7574  e(len(scattercut
-000662f0: 292f 322b 3129 3a0d 0a09 0909 0909 6966  )/2+1):.......if
-00066300: 2069 2020 3d3d 2020 303a 0d0a 0909 0909   i  ==  0:......
-00066310: 0909 6178 2020 3d20 2044 4143 2e6c 6f63  ..ax  =  DAC.loc
-00066320: 5b3a 7363 6174 7465 7263 7574 5b30 5d2c  [:scattercut[0],
-00066330: 2020 3a5d 2e70 6c6f 7428 7375 6270 6c6f    :].plot(subplo
-00066340: 7473 203d 2073 6570 6172 6174 655f 706c  ts = separate_pl
-00066350: 6f74 732c 2066 6967 7369 7a65 203d 2028  ots, figsize = (
-00066360: 3136 2c20 3829 2c20 6c65 6765 6e64 203d  16, 8), legend =
-00066370: 2046 616c 7365 2c20 636f 6c6f 7220 3d20   False, color = 
-00066380: 636f 6c6f 7273 5b3a 6c65 6e28 7370 6563  colors[:len(spec
-00066390: 6965 7329 5d2c 206c 6162 656c 203d 2027  ies)], label = '
-000663a0: 5f6e 6f6c 6567 656e 645f 2729 0d0a 0909  _nolegend_')....
-000663b0: 0909 0965 6c69 6620 693c 286c 656e 2873  ...elif i<(len(s
-000663c0: 6361 7474 6572 6375 7429 2f32 293a 0d0a  cattercut)/2):..
-000663d0: 0909 0909 0909 6178 2020 3d20 2044 4143  ......ax  =  DAC
-000663e0: 2e6c 6f63 5b73 6361 7474 6572 6375 745b  .loc[scattercut[
-000663f0: 322a 692d 315d 3a73 6361 7474 6572 6375  2*i-1]:scattercu
-00066400: 745b 322a 695d 2c20 203a 5d2e 706c 6f74  t[2*i],  :].plot
-00066410: 2861 783d 6178 2c20 7375 6270 6c6f 7473  (ax=ax, subplots
-00066420: 203d 2073 6570 6172 6174 655f 706c 6f74   = separate_plot
-00066430: 732c 2066 6967 7369 7a65 203d 2028 3136  s, figsize = (16
-00066440: 2c20 3829 2c20 6c65 6765 6e64 203d 2046  , 8), legend = F
-00066450: 616c 7365 2c20 636f 6c6f 7220 3d20 636f  alse, color = co
-00066460: 6c6f 7273 5b3a 6c65 6e28 7370 6563 6965  lors[:len(specie
-00066470: 7329 5d2c 206c 6162 656c 203d 2027 5f6e  s)], label = '_n
-00066480: 6f6c 6567 656e 645f 2729 0d0a 0909 0909  olegend_')......
-00066490: 0965 6c73 653a 0d0a 0909 0909 0909 6178  .else:........ax
-000664a0: 2020 3d20 2044 4143 2e6c 6f63 5b73 6361    =  DAC.loc[sca
-000664b0: 7474 6572 6375 745b 2d31 5d3a 2c20 203a  ttercut[-1]:,  :
-000664c0: 5d2e 706c 6f74 2861 783d 6178 2c20 7375  ].plot(ax=ax, su
-000664d0: 6270 6c6f 7473 203d 2073 6570 6172 6174  bplots = separat
-000664e0: 655f 706c 6f74 732c 2066 6967 7369 7a65  e_plots, figsize
-000664f0: 203d 2028 3136 2c20 3829 2c20 6c65 6765   = (16, 8), lege
-00066500: 6e64 203d 2046 616c 7365 2c20 636f 6c6f  nd = False, colo
-00066510: 7220 3d20 636f 6c6f 7273 5b3a 6c65 6e28  r = colors[:len(
-00066520: 7370 6563 6965 7329 5d2c 206c 6162 656c  species)], label
-00066530: 203d 2027 5f6e 6f6c 6567 656e 645f 2729   = '_nolegend_')
-00066540: 0d0a 0909 6966 206f 7468 6572 2069 7320  ....if other is 
-00066550: 6e6f 7420 4e6f 6e65 3a0d 0a09 0909 666f  not None:.....fo
-00066560: 7220 692c 6f20 696e 2065 6e75 6d65 7261  r i,o in enumera
-00066570: 7465 286f 7468 6572 293a 0d0a 0909 0909  te(other):......
-00066580: 7472 793a 0d0a 0909 0909 0972 653d 6f2e  try:.......re=o.
-00066590: 7265 2e63 6f70 7928 290d 0a09 0909 0965  re.copy()......e
-000665a0: 7863 6570 743a 0d0a 0909 0909 0970 7269  xcept:.......pri
-000665b0: 6e74 2827 2573 2068 6173 206e 6f20 6669  nt('%s has no fi
-000665c0: 7474 6564 2072 6573 756c 7473 2725 6f2e  tted results'%o.
-000665d0: 6669 6c65 6e61 6d65 290d 0a09 0909 0909  filename).......
-000665e0: 636f 6e74 696e 7565 0d0a 0909 0909 7265  continue......re
-000665f0: 5b27 4441 4327 5d2e 636f 6c75 6d6e 733d  ['DAC'].columns=
-00066600: 5b6f 2e66 696c 656e 616d 6520 2b20 275c  [o.filename + '\
-00066610: 6e27 202b 2027 2573 2725 6120 666f 7220  n' + '%s'%a for 
-00066620: 6120 696e 2072 655b 2744 4143 275d 2e63  a in re['DAC'].c
-00066630: 6f6c 756d 6e73 5d0d 0a09 0909 0969 6620  olumns]......if 
-00066640: 7365 7061 7261 7465 5f70 6c6f 7473 3a09  separate_plots:.
-00066650: 0909 090d 0a09 0909 0909 636f 6c3d 5b63  ..........col=[c
-00066660: 6f6c 6f72 735b 692b 315d 2066 6f72 2061  olors[i+1] for a
-00066670: 2069 6e20 7261 6e67 6528 6c65 6e28 7265   in range(len(re
-00066680: 5b27 4441 4327 5d2e 636f 6c75 6d6e 7329  ['DAC'].columns)
-00066690: 295d 0d0a 0909 0909 0966 6f72 206a 2c61  )].......for j,a
-000666a0: 6d20 696e 2065 6e75 6d65 7261 7465 2872  m in enumerate(r
-000666b0: 655b 2744 4143 275d 2e63 6f6c 756d 6e73  e['DAC'].columns
-000666c0: 293a 0d0a 0909 0909 0909 6966 206f 2e73  ):........if o.s
-000666d0: 6361 7474 6572 6375 7420 6973 204e 6f6e  cattercut is Non
-000666e0: 653a 090d 0a09 0909 0909 0909 7265 5b27  e:..........re['
-000666f0: 4441 4327 5d2e 696c 6f63 5b3a 2c6a 5d2e  DAC'].iloc[:,j].
-00066700: 706c 6f74 2873 7562 706c 6f74 733d 4661  plot(subplots=Fa
-00066710: 6c73 652c 6178 3d61 5b6a 5d2c 6c65 6765  lse,ax=a[j],lege
-00066720: 6e64 3d46 616c 7365 2c63 6f6c 6f72 3d63  nd=False,color=c
-00066730: 6f6c 5b69 5d29 0d0a 0909 0909 0909 0969  ol[i]).........i
-00066740: 6620 6a3d 3d30 3a0d 0a09 0909 0909 0909  f j==0:.........
-00066750: 0968 616e 646c 6573 2c6c 6162 656c 733d  .handles,labels=
-00066760: 615b 305d 2e67 6574 5f6c 6567 656e 645f  a[0].get_legend_
-00066770: 6861 6e64 6c65 735f 6c61 6265 6c73 2829  handles_labels()
-00066780: 0d0a 0909 0909 0909 0909 6861 6e64 2e61  ..........hand.a
-00066790: 7070 656e 6428 6861 6e64 6c65 735b 2d31  ppend(handles[-1
-000667a0: 5d29 090d 0a09 0909 0909 0965 6c69 6620  ]).........elif 
-000667b0: 6973 696e 7374 616e 6365 286f 2e73 6361  isinstance(o.sca
-000667c0: 7474 6572 6375 745b 305d 2c20 206e 756d  ttercut[0],  num
-000667d0: 6265 7273 2e4e 756d 6265 7229 3a0d 0a09  bers.Number):...
-000667e0: 0909 0909 0909 7265 5b27 4441 4327 5d2e  ......re['DAC'].
-000667f0: 696c 6f63 5b3a 2c6a 5d2e 6c6f 635b 3a6f  iloc[:,j].loc[:o
-00066800: 2e73 6361 7474 6572 6375 745b 305d 5d2e  .scattercut[0]].
-00066810: 706c 6f74 2873 7562 706c 6f74 733d 4661  plot(subplots=Fa
-00066820: 6c73 652c 6178 3d61 5b6a 5d2c 6c65 6765  lse,ax=a[j],lege
-00066830: 6e64 3d46 616c 7365 2c63 6f6c 6f72 3d63  nd=False,color=c
-00066840: 6f6c 5b69 5d29 0d0a 0909 0909 0909 0969  ol[i]).........i
-00066850: 6620 6a3d 3d30 3a0d 0a09 0909 0909 0909  f j==0:.........
-00066860: 0968 616e 646c 6573 2c6c 6162 656c 733d  .handles,labels=
-00066870: 615b 305d 2e67 6574 5f6c 6567 656e 645f  a[0].get_legend_
-00066880: 6861 6e64 6c65 735f 6c61 6265 6c73 2829  handles_labels()
-00066890: 0d0a 0909 0909 0909 0909 6861 6e64 2e61  ..........hand.a
-000668a0: 7070 656e 6428 6861 6e64 6c65 735b 2d31  ppend(handles[-1
-000668b0: 5d29 090d 0a09 0909 0909 0909 7265 5b27  ])..........re['
-000668c0: 4441 4327 5d2e 696c 6f63 5b3a 2c6a 5d2e  DAC'].iloc[:,j].
-000668d0: 6c6f 635b 6f2e 7363 6174 7465 7263 7574  loc[o.scattercut
-000668e0: 5b31 5d3a 5d2e 706c 6f74 2873 7562 706c  [1]:].plot(subpl
-000668f0: 6f74 733d 4661 6c73 652c 6178 3d61 5b6a  ots=False,ax=a[j
-00066900: 5d2c 6c65 6765 6e64 3d46 616c 7365 2c63  ],legend=False,c
-00066910: 6f6c 6f72 3d63 6f6c 5b69 5d2c 6c61 6265  olor=col[i],labe
-00066920: 6c20 3d20 275f 6e6f 6c65 6765 6e64 5f27  l = '_nolegend_'
-00066930: 290d 0a09 0909 0909 0965 6c73 653a 0d0a  )........else:..
-00066940: 0909 0909 0909 0973 6361 7474 6572 6375  .......scattercu
-00066950: 7420 3d20 666c 6174 7465 6e28 6f2e 7363  t = flatten(o.sc
-00066960: 6174 7465 7263 7574 290d 0a09 0909 0909  attercut).......
-00066970: 0909 666f 7220 6d20 696e 2072 616e 6765  ..for m in range
-00066980: 286c 656e 2873 6361 7474 6572 6375 7429  (len(scattercut)
-00066990: 2f32 2b31 293a 0d0a 0909 0909 0909 0909  /2+1):..........
-000669a0: 6966 206d 203d 3d20 303a 0d0a 0909 0909  if m == 0:......
-000669b0: 0909 0909 0972 655b 2744 4143 275d 2e69  .....re['DAC'].i
-000669c0: 6c6f 635b 3a2c 6a5d 2e6c 6f63 5b3a 7363  loc[:,j].loc[:sc
-000669d0: 6174 7465 7263 7574 5b30 5d5d 2e70 6c6f  attercut[0]].plo
-000669e0: 7428 7375 6270 6c6f 7473 3d46 616c 7365  t(subplots=False
-000669f0: 2c61 783d 615b 6a5d 2c6c 6567 656e 643d  ,ax=a[j],legend=
-00066a00: 4661 6c73 652c 636f 6c6f 723d 636f 6c5b  False,color=col[
-00066a10: 695d 290d 0a09 0909 0909 0909 0909 6966  i])...........if
-00066a20: 206a 3d3d 303a 0d0a 0909 0909 0909 0909   j==0:..........
-00066a30: 0909 6861 6e64 6c65 732c 6c61 6265 6c73  ..handles,labels
-00066a40: 3d61 5b6a 5d2e 6765 745f 6c65 6765 6e64  =a[j].get_legend
-00066a50: 5f68 616e 646c 6573 5f6c 6162 656c 7328  _handles_labels(
-00066a60: 290d 0a09 0909 0909 0909 0909 0968 616e  )............han
-00066a70: 642e 6170 7065 6e64 2868 616e 646c 6573  d.append(handles
-00066a80: 5b2d 315d 2909 0d0a 0909 0909 0909 0909  [-1])...........
-00066a90: 656c 6966 206d 3c28 6c65 6e28 7363 6174  elif m<(len(scat
-00066aa0: 7465 7263 7574 292f 3229 3a0d 0a09 0909  tercut)/2):.....
-00066ab0: 0909 0909 0909 7265 5b27 4441 4327 5d2e  ......re['DAC'].
-00066ac0: 696c 6f63 5b3a 2c6a 5d2e 6c6f 635b 7363  iloc[:,j].loc[sc
-00066ad0: 6174 7465 7263 7574 5b32 2a6d 2d31 5d3a  attercut[2*m-1]:
-00066ae0: 7363 6174 7465 7263 7574 5b32 2a6d 5d5d  scattercut[2*m]]
-00066af0: 2e70 6c6f 7428 7375 6270 6c6f 7473 3d46  .plot(subplots=F
-00066b00: 616c 7365 2c61 783d 615b 6a5d 2c6c 6567  alse,ax=a[j],leg
-00066b10: 656e 643d 4661 6c73 652c 636f 6c6f 723d  end=False,color=
-00066b20: 636f 6c5b 695d 2c6c 6162 656c 203d 2027  col[i],label = '
-00066b30: 5f6e 6f6c 6567 656e 645f 2729 0d0a 0909  _nolegend_')....
-00066b40: 0909 0909 0909 656c 7365 3a0d 0a09 0909  ......else:.....
-00066b50: 0909 0909 0909 7265 5b27 4441 4327 5d2e  ......re['DAC'].
-00066b60: 696c 6f63 5b3a 2c6a 5d2e 6c6f 635b 7363  iloc[:,j].loc[sc
-00066b70: 6174 7465 7263 7574 5b2d 315d 3a5d 2e70  attercut[-1]:].p
-00066b80: 6c6f 7428 7375 6270 6c6f 7473 3d46 616c  lot(subplots=Fal
-00066b90: 7365 2c61 783d 615b 6a5d 2c6c 6567 656e  se,ax=a[j],legen
-00066ba0: 643d 4661 6c73 652c 636f 6c6f 723d 636f  d=False,color=co
-00066bb0: 6c5b 695d 2c6c 6162 656c 203d 2027 5f6e  l[i],label = '_n
-00066bc0: 6f6c 6567 656e 645f 2729 0d0a 0909 0909  olegend_')......
-00066bd0: 0909 615b 6a5d 2e73 6574 5f78 6c61 6265  ..a[j].set_xlabe
-00066be0: 6c28 2757 6176 656c 656e 6774 6820 696e  l('Wavelength in
-00066bf0: 206e 6d27 2909 0909 090d 0a09 0909 0909   nm')...........
-00066c00: 0961 5b6a 5d2e 7365 745f 796c 6162 656c  .a[j].set_ylabel
-00066c10: 2827 5370 6563 7472 616c 2073 7472 656e  ('Spectral stren
-00066c20: 6774 6820 696e 2061 7262 2e20 756e 6974  gth in arb. unit
-00066c30: 7327 290d 0a09 0909 0909 0961 5b6a 5d2e  s')........a[j].
-00066c40: 6c65 6765 6e64 2866 6f6e 7473 697a 653d  legend(fontsize=
-00066c50: 382c 6672 616d 656f 6e3d 4661 6c73 6529  8,frameon=False)
-00066c60: 0d0a 0909 090d 0a09 0909 0965 6c73 653a  ...........else:
-00066c70: 0d0a 0909 0909 0964 6163 733d 6c65 6e28  .......dacs=len(
-00066c80: 7265 5b27 4441 4327 5d2e 636f 6c75 6d6e  re['DAC'].column
-00066c90: 7329 0d0a 0909 0909 0963 6f6c 3d63 6f6c  s).......col=col
-00066ca0: 6f72 735b 2869 2b31 292a 6461 6373 3a28  ors[(i+1)*dacs:(
-00066cb0: 692b 3229 2a64 6163 735d 090d 0a09 0909  i+2)*dacs]......
-00066cc0: 0909 4441 433d 7265 5b27 4441 4327 5d0d  ..DAC=re['DAC'].
-00066cd0: 0a09 0909 0909 6966 206f 2e73 6361 7474  ......if o.scatt
-00066ce0: 6572 6375 7420 6973 204e 6f6e 653a 090d  ercut is None:..
-00066cf0: 0a09 0909 0909 0961 7820 3d20 4441 432e  .......ax = DAC.
-00066d00: 706c 6f74 2873 7562 706c 6f74 733d 7365  plot(subplots=se
-00066d10: 7061 7261 7465 5f70 6c6f 7473 2c61 783d  parate_plots,ax=
-00066d20: 6178 2c6c 6567 656e 643d 4661 6c73 652c  ax,legend=False,
-00066d30: 636f 6c6f 723d 636f 6c6f 7273 5b28 692b  color=colors[(i+
-00066d40: 3129 2a6c 656e 2873 7065 6369 6573 293a  1)*len(species):
-00066d50: 2869 2b32 292a 6c65 6e28 7370 6563 6965  (i+2)*len(specie
-00066d60: 7329 5d29 0d0a 0909 0909 0965 6c69 6620  s)]).......elif 
-00066d70: 6973 696e 7374 616e 6365 286f 2e73 6361  isinstance(o.sca
-00066d80: 7474 6572 6375 745b 305d 2c20 206e 756d  ttercut[0],  num
-00066d90: 6265 7273 2e4e 756d 6265 7229 3a0d 0a09  bers.Number):...
-00066da0: 0909 0909 0961 7820 3d20 4441 432e 6c6f  .....ax = DAC.lo
-00066db0: 635b 3a6f 2e73 6361 7474 6572 6375 745b  c[:o.scattercut[
-00066dc0: 305d 2c20 3a5d 2e70 6c6f 7428 7375 6270  0], :].plot(subp
-00066dd0: 6c6f 7473 3d73 6570 6172 6174 655f 706c  lots=separate_pl
-00066de0: 6f74 732c 6178 3d61 782c 6c65 6765 6e64  ots,ax=ax,legend
-00066df0: 3d46 616c 7365 2c63 6f6c 6f72 3d63 6f6c  =False,color=col
-00066e00: 6f72 735b 2869 2b31 292a 6c65 6e28 7370  ors[(i+1)*len(sp
-00066e10: 6563 6965 7329 3a28 692b 3229 2a6c 656e  ecies):(i+2)*len
-00066e20: 2873 7065 6369 6573 295d 290d 0a09 0909  (species)]).....
-00066e30: 0909 0944 4143 2e6c 6f63 5b6f 2e73 6361  ...DAC.loc[o.sca
-00066e40: 7474 6572 6375 745b 315d 3a2c 203a 5d2e  ttercut[1]:, :].
-00066e50: 706c 6f74 2873 7562 706c 6f74 733d 7365  plot(subplots=se
-00066e60: 7061 7261 7465 5f70 6c6f 7473 2c61 783d  parate_plots,ax=
-00066e70: 6178 2c6c 6567 656e 643d 4661 6c73 652c  ax,legend=False,
-00066e80: 636f 6c6f 723d 636f 6c6f 7273 5b28 692b  color=colors[(i+
-00066e90: 3129 2a6c 656e 2873 7065 6369 6573 293a  1)*len(species):
-00066ea0: 2869 2b32 292a 6c65 6e28 7370 6563 6965  (i+2)*len(specie
-00066eb0: 7329 5d29 0d0a 0909 0909 0965 6c73 653a  s)]).......else:
-00066ec0: 0d0a 0909 0909 0909 7363 6174 7465 7263  ........scatterc
-00066ed0: 7574 203d 2066 6c61 7474 656e 286f 2e73  ut = flatten(o.s
-00066ee0: 6361 7474 6572 6375 7429 0d0a 0909 0909  cattercut)......
-00066ef0: 0909 666f 7220 6920 696e 2072 616e 6765  ..for i in range
-00066f00: 286c 656e 2873 6361 7474 6572 6375 7429  (len(scattercut)
-00066f10: 2f32 2b31 293a 0d0a 0909 0909 0909 0969  /2+1):.........i
-00066f20: 6620 6920 3d3d 2030 3a0d 0a09 0909 0909  f i == 0:.......
-00066f30: 0909 0961 7820 3d20 4441 432e 6c6f 635b  ...ax = DAC.loc[
-00066f40: 3a73 6361 7474 6572 6375 745b 305d 2c20  :scattercut[0], 
-00066f50: 3a5d 2e70 6c6f 7428 7375 6270 6c6f 7473  :].plot(subplots
-00066f60: 3d73 6570 6172 6174 655f 706c 6f74 732c  =separate_plots,
-00066f70: 6178 3d61 782c 6c65 6765 6e64 3d46 616c  ax=ax,legend=Fal
-00066f80: 7365 2c63 6f6c 6f72 3d63 6f6c 6f72 735b  se,color=colors[
-00066f90: 2869 2b31 292a 6c65 6e28 7370 6563 6965  (i+1)*len(specie
-00066fa0: 7329 3a28 692b 3229 2a6c 656e 2873 7065  s):(i+2)*len(spe
-00066fb0: 6369 6573 295d 290d 0a09 0909 0909 0909  cies)]).........
-00066fc0: 656c 6966 2069 3c28 6c65 6e28 7363 6174  elif i<(len(scat
-00066fd0: 7465 7263 7574 292f 3229 3a0d 0a09 0909  tercut)/2):.....
-00066fe0: 0909 0909 0961 7820 3d20 4441 432e 6c6f  .....ax = DAC.lo
-00066ff0: 635b 7363 6174 7465 7263 7574 5b32 2a69  c[scattercut[2*i
-00067000: 2d31 5d3a 7363 6174 7465 7263 7574 5b32  -1]:scattercut[2
-00067010: 2a69 5d2c 203a 5d2e 706c 6f74 2873 7562  *i], :].plot(sub
-00067020: 706c 6f74 733d 7365 7061 7261 7465 5f70  plots=separate_p
-00067030: 6c6f 7473 2c61 783d 6178 2c6c 6567 656e  lots,ax=ax,legen
-00067040: 643d 4661 6c73 652c 636f 6c6f 723d 636f  d=False,color=co
-00067050: 6c6f 7273 5b28 692b 3129 2a6c 656e 2873  lors[(i+1)*len(s
-00067060: 7065 6369 6573 293a 2869 2b32 292a 6c65  pecies):(i+2)*le
-00067070: 6e28 7370 6563 6965 7329 5d29 0d0a 0909  n(species)])....
-00067080: 0909 0909 0965 6c73 653a 0d0a 0909 0909  .....else:......
-00067090: 0909 0909 6178 203d 2044 4143 2e6c 6f63  ....ax = DAC.loc
-000670a0: 5b73 6361 7474 6572 6375 745b 2d31 5d3a  [scattercut[-1]:
-000670b0: 2c20 3a5d 2e70 6c6f 7428 7375 6270 6c6f  , :].plot(subplo
-000670c0: 7473 3d73 6570 6172 6174 655f 706c 6f74  ts=separate_plot
-000670d0: 732c 6178 3d61 782c 6c65 6765 6e64 3d46  s,ax=ax,legend=F
-000670e0: 616c 7365 2c63 6f6c 6f72 3d63 6f6c 6f72  alse,color=color
-000670f0: 735b 2869 2b31 292a 6c65 6e28 7370 6563  s[(i+1)*len(spec
-00067100: 6965 7329 3a28 692b 3229 2a6c 656e 2873  ies):(i+2)*len(s
-00067110: 7065 6369 6573 295d 290d 0a09 0909 0909  pecies)]).......
-00067120: 6178 2e73 6574 5f78 6c61 6265 6c28 2757  ax.set_xlabel('W
-00067130: 6176 656c 656e 6774 6820 696e 206e 6d27  avelength in nm'
-00067140: 2909 0909 090d 0a09 0909 0909 6178 2e73  )...........ax.s
-00067150: 6574 5f79 6c61 6265 6c28 2753 7065 6374  et_ylabel('Spect
-00067160: 7261 6c20 7374 7265 6e67 7468 2069 6e20  ral strength in 
-00067170: 6172 622e 2075 6e69 7473 2729 0d0a 0909  arb. units')....
-00067180: 0909 0961 782e 6c65 6765 6e64 2866 6f6e  ...ax.legend(fon
-00067190: 7473 697a 653d 382c 6672 616d 656f 6e3d  tsize=8,frameon=
-000671a0: 4661 6c73 6529 0d0a 0909 6966 206e 6f74  False)....if not
-000671b0: 2068 6173 6174 7472 2861 782c 275f 5f69   hasattr(ax,'__i
-000671c0: 7465 725f 5f27 293a 6178 3d6e 702e 6172  ter__'):ax=np.ar
-000671d0: 7261 7928 5b61 785d 290d 0a09 0969 6620  ray([ax])....if 
-000671e0: 7370 6563 7472 6120 6973 206e 6f74 204e  spectra is not N
-000671f0: 6f6e 653a 0d0a 0909 0966 6f72 2061 2069  one:.....for a i
-00067200: 6e20 6178 3a0d 0a09 0909 0973 7065 6374  n ax:......spect
-00067210: 7261 2e70 6c6f 7428 6178 3d61 2c73 7562  ra.plot(ax=a,sub
-00067220: 706c 6f74 733d 7365 7061 7261 7465 5f70  plots=separate_p
-00067230: 6c6f 7473 2909 0909 090d 0a09 0966 6967  lots)........fig
-00067240: 3d28 6178 2e72 6176 656c 2829 295b 305d  =(ax.ravel())[0]
-00067250: 2e66 6967 7572 650d 0a09 0969 6620 7365  .figure....if se
-00067260: 7061 7261 7465 5f70 6c6f 7473 3a0d 0a09  parate_plots:...
-00067270: 0909 6669 672e 7365 745f 7369 7a65 5f69  ..fig.set_size_i
-00067280: 6e63 6865 7328 3132 2c31 3029 0d0a 0909  nches(12,10)....
-00067290: 0961 7865 735f 6e75 6d62 6572 3d66 6967  .axes_number=fig
-000672a0: 2e67 6574 5f61 7865 7328 290d 0a09 0909  .get_axes().....
-000672b0: 6e61 6d65 733d 5b73 656c 662e 6669 6c65  names=[self.file
-000672c0: 6e61 6d65 5d0d 0a09 0909 6966 206f 7468  name].....if oth
-000672d0: 6572 2069 7320 6e6f 7420 4e6f 6e65 3a0d  er is not None:.
-000672e0: 0a09 0909 0966 6f72 206f 2069 6e20 6f74  .....for o in ot
-000672f0: 6865 723a 0d0a 0909 0909 096e 616d 6573  her:.......names
-00067300: 2e61 7070 656e 6428 6f2e 6669 6c65 6e61  .append(o.filena
-00067310: 6d65 290d 0a09 0909 666f 7220 692c 6178  me).....for i,ax
-00067320: 2069 6e20 656e 756d 6572 6174 6528 6178   in enumerate(ax
-00067330: 6573 5f6e 756d 6265 7229 3a0d 0a09 0909  es_number):.....
-00067340: 0974 7279 3a0d 0a09 0909 0909 6e61 6d65  .try:.......name
-00067350: 7465 6d70 3d5b 2725 7327 2573 7065 6369  temp=['%s'%speci
-00067360: 6573 5b69 5d20 2b20 2720 2d20 2720 2b20  es[i] + ' - ' + 
-00067370: 6120 666f 7220 6120 696e 206e 616d 6573  a for a in names
-00067380: 5d0d 0a09 0909 0909 6178 2e6c 6567 656e  ].......ax.legen
-00067390: 6428 6861 6e64 2c6e 616d 6574 656d 7029  d(hand,nametemp)
-000673a0: 0d0a 0909 0909 6578 6365 7074 3a0d 0a09  ......except:...
-000673b0: 0909 0909 7061 7373 0d0a 0909 656c 7365  ....pass....else
-000673c0: 3a0d 0a09 0909 6178 3d66 6967 2e67 6574  :.....ax=fig.get
-000673d0: 5f61 7865 7328 295b 305d 0d0a 0909 096e  _axes()[0].....n
-000673e0: 616d 6573 3d5b 7365 6c66 2e66 696c 656e  ames=[self.filen
-000673f0: 616d 655d 0d0a 0909 0969 6620 6f74 6865  ame].....if othe
-00067400: 7220 6973 206e 6f74 204e 6f6e 653a 0d0a  r is not None:..
-00067410: 0909 0909 666f 7220 6f20 696e 206f 7468  ....for o in oth
-00067420: 6572 3a0d 0a09 0909 0909 6e61 6d65 732e  er:.......names.
-00067430: 6170 7065 6e64 286f 2e66 696c 656e 616d  append(o.filenam
-00067440: 6529 0d0a 0909 0968 616e 646c 6573 2c6c  e).....handles,l
-00067450: 6162 656c 733d 6178 2e67 6574 5f6c 6567  abels=ax.get_leg
-00067460: 656e 645f 6861 6e64 6c65 735f 6c61 6265  end_handles_labe
-00067470: 6c73 2829 0d0a 0909 096e 616d 6574 656d  ls().....nametem
-00067480: 703d 5b5d 0d0a 0909 0974 7279 3a0d 0a09  p=[].....try:...
-00067490: 0909 0966 6f72 2061 2069 6e20 6e61 6d65  ...for a in name
-000674a0: 733a 0d0a 0909 0909 0966 6f72 2062 2069  s:.......for b i
-000674b0: 6e20 7370 6563 6965 733a 0d0a 0909 0909  n species:......
-000674c0: 0909 6e61 6d65 7465 6d70 2e61 7070 656e  ..nametemp.appen
-000674d0: 6428 2725 7327 2562 202b 2027 202d 2027  d('%s'%b + ' - '
-000674e0: 202b 2061 290d 0a09 0909 0961 782e 6c65   + a)......ax.le
-000674f0: 6765 6e64 2868 616e 646c 6573 2c6e 616d  gend(handles,nam
-00067500: 6574 656d 7029 0d0a 0909 0965 7863 6570  etemp).....excep
-00067510: 743a 0d0a 0909 0909 7061 7373 0d0a 0909  t:......pass....
-00067520: 0966 6967 2e73 6574 5f73 697a 655f 696e  .fig.set_size_in
-00067530: 6368 6573 2831 362c 3829 0d0a 0909 6669  ches(16,8)....fi
-00067540: 672e 7469 6768 745f 6c61 796f 7574 2829  g.tight_layout()
-00067550: 0d0a 0909 6966 2073 656c 662e 7361 7665  ....if self.save
-00067560: 5f66 6967 7572 6573 5f74 6f5f 666f 6c64  _figures_to_fold
-00067570: 6572 3a0d 0a09 0909 6669 672e 7361 7665  er:.....fig.save
-00067580: 6669 6728 6368 6563 6b5f 666f 6c64 6572  fig(check_folder
-00067590: 2870 6174 683d 7365 6c66 2e66 6967 7572  (path=self.figur
-000675a0: 655f 7061 7468 2c66 696c 656e 616d 653d  e_path,filename=
-000675b0: 2763 6f6d 7061 7265 5f44 4143 2e70 6e67  'compare_DAC.png
-000675c0: 2729 2c62 626f 785f 696e 6368 6573 3d27  '),bbox_inches='
-000675d0: 7469 6768 7427 290d 0a0d 0a0d 0a0d 0a    tight')........
+0005b880: 7920 3d3d 2769 6e74 656e 7369 7479 5f72  y =='intensity_r
+0005b890: 616e 6765 273a 0d0a 0909 0909 0909 0972  ange':.........r
+0005b8a0: 6561 643d 5b66 6c6f 6174 2861 2920 666f  ead=[float(a) fo
+0005b8b0: 7220 6120 696e 2072 6561 645d 0d0a 0909  r a in read]....
+0005b8c0: 0909 0909 656c 6966 206b 6579 2069 6e20  ....elif key in 
+0005b8d0: 5b27 7265 6c5f 7469 6d65 272c 2772 656c  ['rel_time','rel
+0005b8e0: 5f77 6176 6527 5d3a 0d0a 0909 0909 0909  _wave']:........
+0005b8f0: 0972 6561 643d 6e70 2e61 7272 6179 2872  .read=np.array(r
+0005b900: 6561 642c 6474 7970 653d 6e70 2e66 6c6f  ead,dtype=np.flo
+0005b910: 6174 3634 290d 0a09 0909 0909 0965 6c69  at64)........eli
+0005b920: 6620 6b65 7920 696e 205b 2773 6361 7474  f key in ['scatt
+0005b930: 6572 6375 7427 5d3a 0d0a 0909 0909 0909  ercut']:........
+0005b940: 0974 7279 3a0d 0a09 0909 0909 0909 0972  .try:..........r
+0005b950: 6561 643d 5b66 6c6f 6174 2861 2920 666f  ead=[float(a) fo
+0005b960: 7220 6120 696e 2072 6561 645d 0d0a 0909  r a in read]....
+0005b970: 0909 0909 0965 7863 6570 743a 236d 6179  .....except:#may
+0005b980: 6265 2077 6520 6861 7665 2020 6120 6c69  be we have  a li
+0005b990: 7374 206f 6620 7363 6174 7465 7263 7574  st of scattercut
+0005b9a0: 730d 0a09 0909 0909 0909 0974 7279 3a0d  s..........try:.
+0005b9b0: 0a09 0909 0909 0909 0909 6f75 745f 6c69  ..........out_li
+0005b9c0: 7374 656e 3d5b 5d0d 0a09 0909 0909 0909  sten=[].........
+0005b9d0: 0909 666f 7220 6c69 7374 656e 2069 6e20  ..for listen in 
+0005b9e0: 7265 6164 3a0d 0a09 0909 0909 0909 0909  read:...........
+0005b9f0: 096f 7574 6c69 7374 656e 2e61 7070 656e  .outlisten.appen
+0005ba00: 6428 5b66 6c6f 6174 2861 2920 666f 7220  d([float(a) for 
+0005ba10: 6120 696e 206c 6973 7465 6e5d 290d 0a09  a in listen])...
+0005ba20: 0909 0909 0909 0965 7863 6570 743a 236e  .......except:#n
+0005ba30: 6f20 6964 6561 206c 6574 7320 7365 6520  o idea lets see 
+0005ba40: 7768 6174 2068 6170 7065 6e73 0d0a 0909  what happens....
+0005ba50: 0909 0909 0909 0970 6173 730d 0a09 0909  .......pass.....
+0005ba60: 0909 0973 656c 662e 5f5f 6469 6374 5f5f  ...self.__dict__
+0005ba70: 5b6b 6579 5d3d 7265 6164 0d0a 0909 0909  [key]=read......
+0005ba80: 6578 6365 7074 3a23 7765 276c 6c20 6765  except:#we'll ge
+0005ba90: 7420 616e 2065 7863 6570 7469 6f6e 2065  t an exception e
+0005baa0: 7665 7279 2074 696d 6520 7468 6572 6520  very time there 
+0005bab0: 6973 2061 6e20 6461 7461 6672 616d 650d  is an dataframe.
+0005bac0: 0a09 0909 0909 2370 7269 6e74 2827 4672  ......#print('Fr
+0005bad0: 616d 653a 272b 6b65 7929 0d0a 0909 0909  ame:'+key)......
+0005bae0: 0964 6174 615f 6672 616d 655f 6c69 7374  .data_frame_list
+0005baf0: 2e61 7070 656e 6428 6b65 7929 0d0a 0d0a  .append(key)....
+0005bb00: 0909 7472 793a 0d0a 0909 0966 2e63 6c6f  ..try:.....f.clo
+0005bb10: 7365 2829 0d0a 0909 6578 6365 7074 3a0d  se()....except:.
+0005bb20: 0a09 0909 7061 7373 0d0a 0909 666f 7220  ....pass....for 
+0005bb30: 6b65 7920 696e 2064 6174 615f 6672 616d  key in data_fram
+0005bb40: 655f 6c69 7374 3a0d 0a09 0909 7472 793a  e_list:.....try:
+0005bb50: 0d0a 0909 0909 6966 2022 7265 5f22 2069  ......if "re_" i
+0005bb60: 6e20 6b65 795b 3a33 5d3a 0d0a 0909 0909  n key[:3]:......
+0005bb70: 0923 7072 696e 7428 2772 6520 696e 206c  .#print('re in l
+0005bb80: 6973 7427 290d 0a09 0909 0909 7365 6c66  ist').......self
+0005bb90: 2e5f 5f64 6963 745f 5f5b 2772 6527 5d5b  .__dict__['re'][
+0005bba0: 6b65 795b 333a 5d5d 3d70 616e 6461 732e  key[3:]]=pandas.
+0005bbb0: 7265 6164 5f68 6466 2873 6176 6564 5f70  read_hdf(saved_p
+0005bbc0: 726f 6a65 6374 2c6b 6579 3d6b 6579 2c6d  roject,key=key,m
+0005bbd0: 6f64 653d 2772 272c 6461 7461 5f63 6f6c  ode='r',data_col
+0005bbe0: 756d 6e73 3d54 7275 6529 0d0a 0909 0909  umns=True)......
+0005bbf0: 656c 6966 206b 6579 2069 6e20 5b27 6473  elif key in ['ds
+0005bc00: 5f6f 7269 272c 2770 6172 5f66 6974 272c  _ori','par_fit',
+0005bc10: 2770 6172 275d 3a0d 0a09 0909 0909 7365  'par']:.......se
+0005bc20: 6c66 2e5f 5f64 6963 745f 5f5b 6b65 795d  lf.__dict__[key]
+0005bc30: 3d70 616e 6461 732e 7265 6164 5f68 6466  =pandas.read_hdf
+0005bc40: 2873 6176 6564 5f70 726f 6a65 6374 2c6b  (saved_project,k
+0005bc50: 6579 3d6b 6579 2c6d 6f64 653d 2772 272c  ey=key,mode='r',
+0005bc60: 6461 7461 5f63 6f6c 756d 6e73 3d54 7275  data_columns=Tru
+0005bc70: 6529 0d0a 0909 0909 656c 7365 3a0d 0a09  e)......else:...
+0005bc80: 0909 0909 7072 696e 7428 226d 6973 7369  ....print("missi
+0005bc90: 6e67 206b 6579 3a22 202b 206b 6579 290d  ng key:" + key).
+0005bca0: 0a09 0909 6578 6365 7074 3a0d 0a09 0909  ....except:.....
+0005bcb0: 0969 6620 6b65 7920 3d3d 2027 7061 7227  .if key == 'par'
+0005bcc0: 2061 6e64 206f 6c64 5f73 7769 7463 683a   and old_switch:
+0005bcd0: 7061 7373 2023 2077 6520 6861 7665 2072  pass # we have r
+0005bce0: 6561 6420 6974 2062 6566 6f72 6520 616c  ead it before al
+0005bcf0: 7265 6164 7920 616e 6420 7468 6520 6572  ready and the er
+0005bd00: 726f 7220 6973 206f 6b0d 0a09 0920 0d0a  ror is ok.... ..
+0005bd10: 0909 0909 656c 7365 3a70 7269 6e74 2822  ....else:print("
+0005bd20: 6572 726f 7220 696e 206b 6579 3a22 202b  error in key:" +
+0005bd30: 206b 6579 290d 0a09 090d 0a09 0974 7279   key)........try
+0005bd40: 3a0d 0a09 0909 7365 6c66 2e5f 5f64 6963  :.....self.__dic
+0005bd50: 745f 5f5b 2772 6527 5d5b 2766 6974 5f72  t__['re']['fit_r
+0005bd60: 6573 756c 7473 5f72 6174 6573 275d 3d73  esults_rates']=s
+0005bd70: 656c 662e 5f5f 6469 6374 5f5f 5b27 7061  elf.__dict__['pa
+0005bd80: 725f 6669 7427 5d0d 0a09 0909 7365 6c66  r_fit'].....self
+0005bd90: 2e5f 5f64 6963 745f 5f5b 2772 6527 5d5b  .__dict__['re'][
+0005bda0: 2766 6974 5f72 6573 756c 7473 5f74 696d  'fit_results_tim
+0005bdb0: 6573 275d 3d70 6172 6466 5f74 6f5f 7469  es']=pardf_to_ti
+0005bdc0: 6d65 6466 2873 656c 662e 5f5f 6469 6374  medf(self.__dict
+0005bdd0: 5f5f 5b27 7265 275d 5b27 6669 745f 7265  __['re']['fit_re
+0005bde0: 7375 6c74 735f 7261 7465 7327 5d29 0d0a  sults_rates'])..
+0005bdf0: 0909 6578 6365 7074 3a0d 0a09 0909 7061  ..except:.....pa
+0005be00: 7373 0d0a 0909 0d0a 0909 2374 6865 2070  ss........#the p
+0005be10: 6172 2063 6f6e 7665 7273 696f 6e20 6675  ar conversion fu
+0005be20: 6e63 7469 6f6e 2066 6169 6c65 642c 2071  nction failed, q
+0005be30: 7569 636b 6669 780d 0a09 0966 6f72 206f  uickfix....for o
+0005be40: 7665 725f 6b65 7920 696e 205b 2770 6172  ver_key in ['par
+0005be50: 5f66 6974 272c 2770 6172 275d 3a0d 0a09  _fit','par']:...
+0005be60: 0909 7472 793a 0d0a 0909 0909 7061 725f  ..try:......par_
+0005be70: 6466 3d73 656c 662e 5f5f 6469 6374 5f5f  df=self.__dict__
+0005be80: 5b6f 7665 725f 6b65 795d 2e6c 6f63 5b3a  [over_key].loc[:
+0005be90: 2c5b 2776 616c 7565 272c 276d 696e 272c  ,['value','min',
+0005bea0: 276d 6178 272c 2776 6172 7927 2c27 6578  'max','vary','ex
+0005beb0: 7072 275d 5d0d 0a09 0909 0970 6172 3d6c  pr']]......par=l
+0005bec0: 6d66 6974 2e50 6172 616d 6574 6572 7328  mfit.Parameters(
+0005bed0: 290d 0a09 0909 0966 6f72 206b 6579 2069  )......for key i
+0005bee0: 6e20 7061 725f 6466 2e69 6e64 6578 2e76  n par_df.index.v
+0005bef0: 616c 7565 733a 0d0a 0909 0909 0970 6172  alues:.......par
+0005bf00: 2e61 6464 286b 6579 2c20 7661 6c75 653d  .add(key, value=
+0005bf10: 7061 725f 6466 2e6c 6f63 5b6b 6579 2c27  par_df.loc[key,'
+0005bf20: 7661 6c75 6527 5d2c 2076 6172 793d 7061  value'], vary=pa
+0005bf30: 725f 6466 2e6c 6f63 5b6b 6579 2c27 7661  r_df.loc[key,'va
+0005bf40: 7279 275d 2c20 6d69 6e3d 7061 725f 6466  ry'], min=par_df
+0005bf50: 2e6c 6f63 5b6b 6579 2c27 6d69 6e27 5d2c  .loc[key,'min'],
+0005bf60: 206d 6178 3d70 6172 5f64 662e 6c6f 635b   max=par_df.loc[
+0005bf70: 6b65 792c 276d 6178 275d 290d 0a09 0909  key,'max']).....
+0005bf80: 0909 0909 0909 0909 0909 0909 2020 0d0a  ............  ..
+0005bf90: 0909 0909 7365 6c66 2e5f 5f64 6963 745f  ....self.__dict_
+0005bfa0: 5f5b 6f76 6572 5f6b 6579 5d3d 7061 720d  _[over_key]=par.
+0005bfb0: 0a09 0909 6578 6365 7074 3a0d 0a09 0909  ....except:.....
+0005bfc0: 0970 6173 730d 0a09 0969 6620 6f6c 645f  .pass....if old_
+0005bfd0: 7377 6974 6368 3a0d 0a09 0909 7472 793a  switch:.....try:
+0005bfe0: 0d0a 0909 0909 7365 6c66 2e5f 5f64 6963  ......self.__dic
+0005bff0: 745f 5f5b 2772 6527 5d5b 2766 6974 5f72  t__['re']['fit_r
+0005c000: 6573 756c 7473 5f72 6174 6573 275d 3d70  esults_rates']=p
+0005c010: 6172 5f74 6f5f 7061 7264 6628 7365 6c66  ar_to_pardf(self
+0005c020: 2e70 6172 290d 0a09 0909 0973 656c 662e  .par)......self.
+0005c030: 5f5f 6469 6374 5f5f 5b27 7265 275d 5b27  __dict__['re']['
+0005c040: 6669 745f 7265 7375 6c74 735f 7469 6d65  fit_results_time
+0005c050: 7327 5d3d 7061 7264 665f 746f 5f74 696d  s']=pardf_to_tim
+0005c060: 6564 6628 7061 725f 746f 5f70 6172 6466  edf(par_to_pardf
+0005c070: 2873 656c 662e 7061 7229 290d 0a09 0909  (self.par)).....
+0005c080: 0973 656c 662e 5f5f 6469 6374 5f5f 5b27  .self.__dict__['
+0005c090: 7061 725f 6669 7427 5d3d 7365 6c66 2e70  par_fit']=self.p
+0005c0a0: 6172 0d0a 0909 0965 7863 6570 743a 0d0a  ar.....except:..
+0005c0b0: 0909 0909 7061 7373 0d0a 0909 7365 6c66  ....pass....self
+0005c0c0: 2e73 6176 655f 6669 6775 7265 735f 746f  .save_figures_to
+0005c0d0: 5f66 6f6c 6465 723d 4661 6c73 650d 0a09  _folder=False...
+0005c0e0: 0973 656c 662e 7061 7468 3d63 7572 7265  .self.path=curre
+0005c0f0: 6e74 5f70 6174 680d 0a09 0969 6620 6f6c  nt_path....if ol
+0005c100: 645f 7377 6974 6368 3a23 636f 6e76 6572  d_switch:#conver
+0005c110: 7420 7072 6f6a 6563 7420 696e 746f 206e  t project into n
+0005c120: 6577 2074 7970 650d 0a09 0909 2363 6c65  ew type.....#cle
+0005c130: 616e 206f 6c64 2066 696c 6573 2074 6861  an old files tha
+0005c140: 7420 7765 7265 2072 6561 6420 7772 6f6e  t were read wron
+0005c150: 670d 0a09 0909 666f 7220 6b65 7920 696e  g.....for key in
+0005c160: 205b 2772 655f 6669 6e61 6c5f 696e 745f   ['re_final_int_
+0005c170: 7061 7227 2c27 7265 5f66 696e 616c 5f73  par','re_final_s
+0005c180: 6574 7570 5f70 6172 272c 2772 655f 6669  etup_par','re_fi
+0005c190: 6e61 6c5f 7469 6d65 5f70 6172 272c 2772  nal_time_par','r
+0005c1a0: 655f 696e 745f 6572 726f 7227 5d3a 0d0a  e_int_error']:..
+0005c1b0: 0909 0909 7472 793a 0d0a 0909 0909 0964  ....try:.......d
+0005c1c0: 656c 2073 656c 662e 5f5f 6469 6374 5f5f  el self.__dict__
+0005c1d0: 5b6b 6579 5d0d 0a09 0909 0965 7863 6570  [key]......excep
+0005c1e0: 7420 4b65 7945 7272 6f72 3a0d 0a09 0909  t KeyError:.....
+0005c1f0: 0909 7072 696e 7428 6627 4b65 7920 7b6b  ..print(f'Key {k
+0005c200: 6579 7d20 6973 206e 6f74 2069 6e20 7468  ey} is not in th
+0005c210: 6520 6469 6374 696f 6e61 7279 2729 0d0a  e dictionary')..
+0005c220: 0909 0966 6f72 206b 6579 2069 6e20 5b27  ...for key in ['
+0005c230: 6669 6e61 6c5f 696e 745f 7061 7227 2c27  final_int_par','
+0005c240: 6669 6e61 6c5f 7365 7475 705f 7061 7227  final_setup_par'
+0005c250: 2c27 6669 6e61 6c5f 7469 6d65 5f70 6172  ,'final_time_par
+0005c260: 272c 2769 6e74 5f65 7272 6f72 275d 3a0d  ','int_error']:.
+0005c270: 0a09 0909 0974 7279 3a0d 0a09 0909 0909  .....try:.......
+0005c280: 6465 6c20 7365 6c66 2e5f 5f64 6963 745f  del self.__dict_
+0005c290: 5f5b 2772 6527 5d5b 6b65 795d 0d0a 0909  _['re'][key]....
+0005c2a0: 0909 6578 6365 7074 204b 6579 4572 726f  ..except KeyErro
+0005c2b0: 723a 0d0a 0909 0909 0970 7269 6e74 2866  r:.......print(f
+0005c2c0: 274b 6579 207b 6b65 797d 2069 7320 6e6f  'Key {key} is no
+0005c2d0: 7420 696e 2074 6865 2064 6963 7469 6f6e  t in the diction
+0005c2e0: 6172 7927 290d 0a09 0909 7472 793a 0d0a  ary').....try:..
+0005c2f0: 0909 0909 7365 6c66 2e73 6176 655f 7072  ....self.save_pr
+0005c300: 6f6a 6563 7428 290d 0a09 0909 0970 7269  oject()......pri
+0005c310: 6e74 2822 7072 6f6a 6563 7420 636f 6e76  nt("project conv
+0005c320: 6572 7465 6420 696e 746f 206e 6577 2064  erted into new d
+0005c330: 6174 6120 7479 7065 2061 6e64 2073 6176  ata type and sav
+0005c340: 6564 2061 6761 696e 2229 0d0a 0909 0965  ed again").....e
+0005c350: 7863 6570 743a 0d0a 0909 0909 7072 696e  xcept:......prin
+0005c360: 7428 2270 726f 6a65 6374 2063 6f6e 7665  t("project conve
+0005c370: 7274 6564 2069 6275 7420 636f 756c 6420  rted ibut could 
+0005c380: 6e6f 7420 6265 2073 6176 6564 2229 0d0a  not be saved")..
+0005c390: 0909 7365 6c66 2e70 6174 683d 6375 7272  ..self.path=curr
+0005c3a0: 656e 745f 7061 7468 0d0a 0909 666f 7220  ent_path....for 
+0005c3b0: 6b65 7920 696e 205b 2774 696d 655f 6269  key in ['time_bi
+0005c3c0: 6e27 2c27 7265 6c5f 7761 7665 272c 2772  n','rel_wave','r
+0005c3d0: 656c 5f74 696d 6527 2c27 7363 6174 7465  el_time','scatte
+0005c3e0: 7263 7574 272c 2762 6f72 6465 7263 7574  rcut','bordercut
+0005c3f0: 272c 2774 696d 656c 696d 6974 7327 2c27  ','timelimits','
+0005c400: 696e 7465 6e73 6974 795f 7261 6e67 6527  intensity_range'
+0005c410: 2c27 7761 7665 5f6e 6d5f 6269 6e27 2c27  ,'wave_nm_bin','
+0005c420: 7761 7665 6c65 6e67 7468 5f62 696e 272c  wavelength_bin',
+0005c430: 2769 676e 6f72 655f 7469 6d65 5f72 6567  'ignore_time_reg
+0005c440: 696f 6e27 5d3a 0d0a 0909 0974 7279 3a0d  ion']:.....try:.
+0005c450: 0a09 0909 0969 6620 6973 696e 7374 616e  .....if isinstan
+0005c460: 6365 2873 656c 662e 5f5f 6469 6374 5f5f  ce(self.__dict__
+0005c470: 5b6b 6579 5d2c 6279 7465 7329 3a0d 0a09  [key],bytes):...
+0005c480: 0909 0909 2370 7269 6e74 286b 6579 202b  ....#print(key +
+0005c490: 2027 2073 6574 2074 6f20 4e6f 6e65 2729   ' set to None')
+0005c4a0: 0d0a 0909 0909 0973 656c 662e 5f5f 6469  .......self.__di
+0005c4b0: 6374 5f5f 5b6b 6579 5d3d 4e6f 6e65 0d0a  ct__[key]=None..
+0005c4c0: 0909 0909 656c 6966 2069 7369 6e73 7461  ....elif isinsta
+0005c4d0: 6e63 6528 7365 6c66 2e5f 5f64 6963 745f  nce(self.__dict_
+0005c4e0: 5f5b 6b65 795d 2c73 7472 293a 0d0a 0909  _[key],str):....
+0005c4f0: 0909 0969 6620 7365 6c66 2e5f 5f64 6963  ...if self.__dic
+0005c500: 745f 5f5b 6b65 795d 3d3d 274e 6f6e 6527  t__[key]=='None'
+0005c510: 3a0d 0a09 0909 0909 0973 656c 662e 5f5f  :........self.__
+0005c520: 6469 6374 5f5f 5b6b 6579 5d3d 4e6f 6e65  dict__[key]=None
+0005c530: 0d0a 0909 0965 7863 6570 743a 0d0a 0909  .....except:....
+0005c540: 0909 636f 6e74 696e 7565 0d0a 0909 7472  ..continue....tr
+0005c550: 793a 0d0a 0909 0973 656c 662e 6669 6775  y:.....self.figu
+0005c560: 7265 5f70 6174 683d 7374 7228 7365 6c66  re_path=str(self
+0005c570: 2e66 6967 7572 655f 7061 7468 290d 0a09  .figure_path)...
+0005c580: 0909 6966 2027 4e6f 6e65 2720 696e 2073  ..if 'None' in s
+0005c590: 656c 662e 6669 6775 7265 5f70 6174 683a  elf.figure_path:
+0005c5a0: 0d0a 0909 0909 7365 6c66 2e66 6967 7572  ......self.figur
+0005c5b0: 655f 7061 7468 3d4e 6f6e 650d 0a09 0965  e_path=None....e
+0005c5c0: 7863 6570 743a 0d0a 0909 0970 6173 730d  xcept:.....pass.
+0005c5d0: 0a0d 0a09 6465 6620 436f 7079 2873 656c  ....def Copy(sel
+0005c5e0: 6629 3a0d 0a09 0927 2727 7265 7475 726e  f):....'''return
+0005c5f0: 7320 6120 6465 6570 2063 6f70 7920 6f66  s a deep copy of
+0005c600: 2074 6865 206f 626a 6563 742e 0d0a 0909   the object.....
+0005c610: 0d0a 0909 4578 616d 706c 6573 0d0a 0909  ....Examples....
+0005c620: 2d2d 2d2d 2d2d 2d2d 0d0a 0909 3e3e 3e74  --------....>>>t
+0005c630: 613d 706c 6f74 5f66 756e 632e 5441 2827  a=plot_func.TA('
+0005c640: 7465 7374 6669 6c65 2e68 6466 3527 2920  testfile.hdf5') 
+0005c650: 236f 7065 6e20 6120 7072 6f6a 6563 740d  #open a project.
+0005c660: 0a09 093e 3e3e 7461 313d 7461 2e43 6f70  ...>>>ta1=ta.Cop
+0005c670: 7928 2920 236d 616b 6520 6120 636f 7079  y() #make a copy
+0005c680: 2066 6f72 2073 6f6d 6520 7465 7374 7320   for some tests 
+0005c690: 6f72 2061 2064 6966 6665 726e 6574 2066  or a differnet f
+0005c6a0: 6974 0d0a 0909 0d0a 0909 2727 2720 0d0a  it........''' ..
+0005c6b0: 0909 696d 706f 7274 2063 6f70 790d 0a09  ..import copy...
+0005c6c0: 0972 6574 7572 6e20 636f 7079 2e64 6565  .return copy.dee
+0005c6d0: 7063 6f70 7928 7365 6c66 290d 0a0d 0a0d  pcopy(self).....
+0005c6e0: 0a09 6465 6620 436f 6d70 6172 655f 6174  ..def Compare_at
+0005c6f0: 5f74 696d 6528 7365 6c66 2c20 7265 6c5f  _time(self, rel_
+0005c700: 7469 6d65 203d 204e 6f6e 652c 206f 7468  time = None, oth
+0005c710: 6572 203d 204e 6f6e 652c 2066 6974 7465  er = None, fitte
+0005c720: 6420 3d20 4661 6c73 652c 206e 6f72 6d5f  d = False, norm_
+0005c730: 7769 6e64 6f77 203d 204e 6f6e 652c 0d0a  window = None,..
+0005c740: 0909 0909 0909 7469 6d65 5f77 6964 7468  ......time_width
+0005c750: 5f70 6572 6365 6e74 203d 204e 6f6e 652c  _percent = None,
+0005c760: 2073 7065 6374 7261 203d 204e 6f6e 652c   spectra = None,
+0005c770: 2064 6174 615f 616e 645f 6669 7420 3d20   data_and_fit = 
+0005c780: 4661 6c73 652c 2063 6d61 7020 3d20 4e6f  False, cmap = No
+0005c790: 6e65 202c 200d 0a09 0909 0909 0970 7269  ne , ........pri
+0005c7a0: 6e74 5f63 6c69 636b 5f70 6f73 6974 696f  nt_click_positio
+0005c7b0: 6e20 3d20 4661 6c73 652c 206c 696e 6577  n = False, linew
+0005c7c0: 6964 7468 203d 2031 2c20 7469 746c 653d  idth = 1, title=
+0005c7d0: 2727 2c20 706c 6f74 5f73 6563 6f6e 645f  '', plot_second_
+0005c7e0: 6173 5f65 6e65 7267 7920 3d20 5472 7565  as_energy = True
+0005c7f0: 293a 0d0a 0909 2727 2754 6869 7320 6675  ):....'''This fu
+0005c800: 6e63 7469 6f6e 2070 6c6f 7473 206d 756c  nction plots mul
+0005c810: 7469 706c 6520 7370 6563 7472 6120 696e  tiple spectra in
+0005c820: 746f 2074 6865 2073 616d 6520 6669 6775  to the same figu
+0005c830: 7265 2061 7420 6120 6769 7665 6e20 7265  re at a given re
+0005c840: 6c5f 7469 6d65 2028 7469 6d65 706f 696e  l_time (timepoin
+0005c850: 7473 2920 616e 6420 0d0a 0909 616c 6c6f  ts) and ....allo
+0005c860: 7773 2066 6f72 206e 6f72 6d61 6c69 7a61  ws for normaliza
+0005c870: 7469 6f6e 2e20 5665 7279 2075 7365 6675  tion. Very usefu
+0005c880: 6c20 746f 2063 6f6d 7061 7265 2074 6865  l to compare the
+0005c890: 2073 7065 6374 7261 2066 6f72 2064 6966   spectra for dif
+0005c8a0: 6665 7265 6e74 2073 6f6c 7665 6e74 7320  ferent solvents 
+0005c8b0: 6f72 2071 7565 6e63 6865 7273 2c20 6f72  or quenchers, or
+0005c8c0: 0d0a 0909 652e 672e 2064 6966 6665 7265  ....e.g. differe
+0005c8d0: 6e74 2066 6974 732e 2054 6865 2074 612e  nt fits. The ta.
+0005c8e0: 7469 6d65 5f77 6964 7468 5f70 6572 6365  time_width_perce
+0005c8f0: 6e74 2070 6172 616d 6574 6572 2064 6566  nt parameter def
+0005c900: 696e 6573 2069 6620 7468 6973 2069 7320  ines if this is 
+0005c910: 610d 0a09 0973 696e 676c 6520 7469 6d65  a....single time
+0005c920: 2028 6966 2074 696d 655f 7769 6474 685f   (if time_width_
+0005c930: 7065 7263 656e 7420 3d20 3029 206f 7220  percent = 0) or 
+0005c940: 616e 2069 6e74 6567 7261 7465 6420 7769  an integrated wi
+0005c950: 6e64 6f77 2e0d 0a09 094f 6e6c 7920 2272  ndow.....Only "r
+0005c960: 656c 5f74 696d 6522 2069 7320 6120 6d61  el_time" is a ma
+0005c970: 6e64 6174 6f72 792c 2074 6865 2072 6573  ndatory, the res
+0005c980: 7420 6361 6e20 6265 2074 616b 656e 2066  t can be taken f
+0005c990: 726f 6d20 7468 6520 6f72 6967 696e 616c  rom the original
+0005c9a0: 2070 726f 6a65 6374 2028 7461 292e 0d0a   project (ta)...
+0005c9b0: 0909 0d0a 0909 5468 6520 6e6f 726d 616c  ......The normal
+0005c9c0: 697a 6174 696f 6e20 6973 2072 6561 6c69  ization is reali
+0005c9d0: 7a65 6420 6279 2067 6976 696e 6720 6120  zed by giving a 
+0005c9e0: 6e6f 726d 5f77 696e 646f 7720 0d0a 0909  norm_window ....
+0005c9f0: 6174 2077 6869 6368 2074 6865 2069 6e74  at which the int
+0005ca00: 656e 7369 7479 2069 6e20 7468 6520 7472  ensity in the tr
+0005ca10: 6967 6765 7269 6e67 206f 626a 6563 7420  iggering object 
+0005ca20: 6973 2069 6e74 6567 7261 7465 6420 2869  is integrated (i
+0005ca30: 6e20 7461 2e43 6f6d 7061 7265 5f61 745f  n ta.Compare_at_
+0005ca40: 7469 6d65 286f 7468 6572 2e2e 2920 0d0a  time(other..) ..
+0005ca50: 0909 2274 6122 2069 7320 7468 6520 7472  .."ta" is the tr
+0005ca60: 6967 6765 7269 6e67 206f 626a 6563 742e  iggering object.
+0005ca70: 2054 6865 2069 6e20 6561 6368 206f 6620   The in each of 
+0005ca80: 7468 6520 6f74 6865 7220 6375 7276 6573  the other curves
+0005ca90: 2074 6865 2073 616d 6520 7769 6e64 6f77   the same window
+0005caa0: 2069 730d 0a09 0969 6e74 6567 7261 7465   is....integrate
+0005cab0: 6420 616e 6420 7468 6520 6375 7276 6520  d and the curve 
+0005cac0: 7363 616c 6564 2062 7920 7468 6973 2076  scaled by this v
+0005cad0: 616c 7565 2e20 496d 706f 7274 616e 7420  alue. Important 
+0005cae0: 746f 206e 6f74 6520 6973 2074 6861 7420  to note is that 
+0005caf0: 7468 6973 2077 696e 646f 770d 0a09 0964  this window....d
+0005cb00: 6f65 7320 6e6f 7420 6e65 6564 2074 6f20  oes not need to 
+0005cb10: 6265 2069 6e20 7468 6520 706c 6f74 2e20  be in the plot. 
+0005cb20: 652e 672e 2074 6865 206e 6f72 6d61 6c69  e.g. the normali
+0005cb30: 7a61 7469 6f6e 2063 616e 2062 6520 646f  zation can be do
+0005cb40: 6e65 2061 7420 6120 6469 6666 6572 656e  ne at a differen
+0005cb50: 7420 7469 6d65 2e0d 0a09 090d 0a09 0956  t time.........V
+0005cb60: 6572 7920 6f66 7465 6e20 6f6e 6520 776f  ery often one wo
+0005cb70: 756c 6420 6c69 6b65 2074 6f20 636f 6d70  uld like to comp
+0005cb80: 6172 6520 7468 6520 6d65 6173 7572 6564  are the measured
+0005cb90: 2073 7065 6374 7261 2061 7420 6120 6365   spectra at a ce
+0005cba0: 7274 6169 6e0d 0a09 0974 696d 6520 746f  rtain....time to
+0005cbb0: 2061 6e20 6578 7465 726e 616c 2073 7065   an external spe
+0005cbc0: 6374 7275 6d20 2865 2e67 2e20 7370 6563  ctrum (e.g. spec
+0005cbd0: 7472 6f2d 656c 6563 7472 6f2d 6368 656d  tro-electro-chem
+0005cbe0: 6973 7472 7920 6f72 2073 7465 6164 790d  istry or steady.
+0005cbf0: 0a09 0973 7461 7465 2061 6273 6f72 7074  ...state absorpt
+0005cc00: 696f 6e29 2e20 5468 6973 2063 616e 2062  ion). This can b
+0005cc10: 6520 646f 6e65 2062 7920 6c6f 6164 696e  e done by loadin
+0005cc20: 6720 6120 7370 6563 6966 6963 2073 7065  g a specific spe
+0005cc30: 6374 7275 6d20 696e 746f 0d0a 0909 6120  ctrum into....a 
+0005cc40: 4461 7461 4672 616d 6520 616e 6420 6861  DataFrame and ha
+0005cc50: 6e64 696e 6720 7468 6973 2064 6174 6120  nding this data 
+0005cc60: 4672 616d 6520 746f 2074 6865 2063 6f6d  Frame to the com
+0005cc70: 7061 7269 7369 6f6e 2066 756e 6374 696f  parision functio
+0005cc80: 6e2e 2054 6865 0d0a 0909 6675 6e63 7469  n. The....functi
+0005cc90: 6f6e 2063 616e 2061 6c73 6f20 6265 2075  on can also be u
+0005cca0: 7365 6420 746f 2070 6c6f 7420 652e 672e  sed to plot e.g.
+0005ccb0: 2074 6865 206d 6561 7375 7265 6420 7370   the measured sp
+0005ccc0: 6563 7472 6120 7673 2e20 616e 0d0a 0909  ectra vs. an....
+0005ccd0: 6578 7465 726e 616c 2073 7065 6374 7275  external spectru
+0005cce0: 6d20 7769 7468 6f75 7420 6769 7669 6e67  m without giving
+0005ccf0: 2061 6e79 2022 6f74 6865 7222 2050 726f   any "other" Pro
+0005cd00: 6a65 6374 732e 2028 7665 7279 2075 7365  jects. (very use
+0005cd10: 6675 6c20 666f 720d 0a09 0963 6f6d 7061  ful for....compa
+0005cd20: 7269 7369 6f6e 7329 2e0d 0a09 0920 0d0a  risions)..... ..
+0005cd30: 0909 5061 7261 6d65 7465 7273 0d0a 0909  ..Parameters....
+0005cd40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a09  -------------...
+0005cd50: 090d 0a09 0972 656c 5f74 696d 6520 3a20  .....rel_time : 
+0005cd60: 666c 6f61 7420 6f72 206c 6973 742f 7665  float or list/ve
+0005cd70: 6374 6f72 2028 6f66 2066 6c6f 6174 7329  ctor (of floats)
+0005cd80: 0d0a 0909 0953 7065 6369 6679 2074 6865  .....Specify the
+0005cd90: 2074 696d 6573 2077 6865 7265 2074 6f20   times where to 
+0005cda0: 706c 6f74 2c20 7369 6e67 6c65 2076 616c  plot, single val
+0005cdb0: 7565 206f 7220 6c69 7374 2f76 6563 746f  ue or list/vecto
+0005cdc0: 7220 6f66 2076 616c 7565 732e 200d 0a09  r of values. ...
+0005cdd0: 0909 466f 7220 6561 6368 2065 6e74 7279  ..For each entry
+0005cde0: 2069 6e20 7265 6c5f 7469 6d65 2061 2073   in rel_time a s
+0005cdf0: 7065 6374 7275 6d20 6973 2070 6c6f 7474  pectrum is plott
+0005ce00: 6564 2e20 0d0a 0909 0949 6620 7469 6d65  ed. .....If time
+0005ce10: 5f77 6964 7468 5f70 6572 6365 6e74 3d30  _width_percent=0
+0005ce20: 2028 4465 6661 756c 7429 2074 6865 206e   (Default) the n
+0005ce30: 6561 7265 7374 206d 6561 7375 7265 6420  earest measured 
+0005ce40: 0d0a 0909 0974 696d 6570 6f69 6e74 2069  .....timepoint i
+0005ce50: 7320 6368 6f73 656e 2e20 466f 7220 6f74  s chosen. For ot
+0005ce60: 6865 7220 7661 6c75 6573 2073 6565 2070  her values see p
+0005ce70: 6172 616d 6574 6572 2022 7469 6d65 5f77  arameter "time_w
+0005ce80: 6964 7468 5f70 6572 6365 6e74 222e 0d0a  idth_percent"...
+0005ce90: 0909 090d 0a09 096f 7468 6572 203a 2054  .......other : T
+0005cea0: 4120 6f62 6a65 6374 206f 7220 6c69 7374  A object or list
+0005ceb0: 206f 6620 7468 6f73 652c 206f 7074 696f   of those, optio
+0005cec0: 6e61 6c20 0d0a 0909 0973 686f 756c 6420  nal .....should 
+0005ced0: 6265 2074 612e 706c 6f74 5f66 756e 6320  be ta.plot_func 
+0005cee0: 6f62 6a65 6374 7320 286c 6f61 6465 6420  objects (loaded 
+0005cef0: 6f72 2063 6f70 6965 6429 2061 6e64 2069  or copied) and i
+0005cf00: 7320 7768 6174 200d 0a09 0909 6973 2070  s what .....is p
+0005cf10: 6c6f 7474 6564 2061 6761 696e 7374 2074  lotted against t
+0005cf20: 6865 2064 6174 6120 7573 6520 6120 6c69  he data use a li
+0005cf30: 7374 205b 7461 312c 7461 322c 2e2e 2e20  st [ta1,ta2,... 
+0005cf40: 5d20 6f72 2067 656e 6572 6174 6520 7468  ] or generate th
+0005cf50: 6973 0d0a 0909 096c 6973 7420 7573 696e  is.....list usin
+0005cf60: 6720 7468 6520 4775 6920 6675 6e63 7469  g the Gui functi
+0005cf70: 6f6e 2e20 5365 6520 7365 6374 696f 6e20  on. See section 
+0005cf80: 3a72 6566 3a60 4f70 656e 696e 6720 6d75  :ref:`Opening mu
+0005cf90: 6c74 6970 6c65 2066 696c 6573 6020 696e  ltiple files` in
+0005cfa0: 200d 0a09 0909 7468 6520 646f 6375 6d65   .....the docume
+0005cfb0: 6e74 6174 696f 6e0d 0a09 090d 0a09 0966  ntation........f
+0005cfc0: 6974 7465 6420 3a20 626f 6f6c 2c20 6f70  itted : bool, op
+0005cfd0: 7469 6f6e 616c 0d0a 0909 0954 7275 652f  tional.....True/
+0005cfe0: 4661 6c73 6520 2844 6566 6175 6c74 2920  False (Default) 
+0005cff0: 2d20 7573 6520 6669 7474 6564 2064 6174  - use fitted dat
+0005d000: 6120 696e 7374 6561 6420 6f66 2072 6177  a instead of raw
+0005d010: 2064 6174 612e 200d 0a09 0909 4966 2054   data. .....If T
+0005d020: 7275 652c 2074 6865 2066 6974 7465 6420  rue, the fitted 
+0005d030: 6461 7461 706f 696e 7473 2028 7769 7468  datapoints (with
+0005d040: 6f75 7420 696e 7465 7270 6f6c 6174 696f  out interpolatio
+0005d050: 6e29 2061 7265 2075 7365 642e 200d 0a09  n) are used. ...
+0005d060: 0909 5468 6973 2069 7320 696e 7465 6e64  ..This is intend
+0005d070: 6564 2066 6f72 2063 6f6d 7061 7269 6e67  ed for comparing
+0005d080: 2065 2e67 2e20 6469 6666 6572 656e 7420   e.g. different 
+0005d090: 6669 7473 0d0a 0909 0d0a 0909 6e6f 726d  fits........norm
+0005d0a0: 5f77 696e 646f 7720 3a20 4e6f 6e65 206f  _window : None o
+0005d0b0: 7220 6c69 7374 2f76 6563 746f 7220 2877  r list/vector (w
+0005d0c0: 6974 6820 3420 666c 6f61 7473 292c 206f  ith 4 floats), o
+0005d0d0: 7074 696f 6e61 6c0d 0a09 0909 6e6f 726d  ptional.....norm
+0005d0e0: 5f77 696e 646f 7720 4769 7665 2061 206c  _window Give a l
+0005d0f0: 6973 742f 7475 7065 6c2f 7665 6374 6f72  ist/tupel/vector
+0005d100: 2077 6974 6820 3420 656e 7472 6965 7320   with 4 entries 
+0005d110: 696e 2074 6865 206f 7264 6572 200d 0a09  in the order ...
+0005d120: 0909 5b53 7461 7274 202d 2074 696d 652c  ..[Start - time,
+0005d130: 2045 6e64 202d 2074 696d 652c 2053 7461   End - time, Sta
+0005d140: 7274 202d 2077 6176 656c 656e 6774 682c  rt - wavelength,
+0005d150: 2045 6e64 202d 2057 6176 656c 656e 6774   End - Wavelengt
+0005d160: 685d 2c20 0d0a 0909 0973 6565 2073 6563  h], .....see sec
+0005d170: 7469 6f6e 2020 3a72 6566 3a60 4e6f 726d  tion  :ref:`Norm
+0005d180: 616c 697a 6174 696f 6e20 616e 6420 5363  alization and Sc
+0005d190: 616c 696e 6760 2020 696e 2074 6865 2064  aling`  in the d
+0005d1a0: 6f63 756d 656e 7461 7469 6f6e 2e0d 0a09  ocumentation....
+0005d1b0: 0909 4966 204e 6f6e 6520 2844 6566 6175  ..If None (Defau
+0005d1c0: 6c74 2920 6e6f 206e 6f72 6d61 6c69 7a61  lt) no normaliza
+0005d1d0: 7469 6f6e 2069 7320 646f 6e65 2e0d 0a09  tion is done....
+0005d1e0: 090d 0a09 096c 696e 6577 6964 7468 203a  .....linewidth :
+0005d1f0: 2066 6c6f 6174 2c20 6f70 7469 6f6e 616c   float, optional
+0005d200: 0d0a 0909 096c 696e 6577 6964 7468 2074  .....linewidth t
+0005d210: 6f20 6265 2075 7365 6420 666f 7220 706c  o be used for pl
+0005d220: 6f74 7469 6e67 0909 0d0a 0909 0d0a 0909  otting..........
+0005d230: 7469 6d65 5f77 6964 7468 5f70 6572 6365  time_width_perce
+0005d240: 6e74 203a 204e 6f6e 6520 6f72 2066 6c6f  nt : None or flo
+0005d250: 6174 2c20 6f70 7469 6f6e 616c 0d0a 0909  at, optional....
+0005d260: 0922 7265 6c5f 7469 6d65 2220 616e 6420  ."rel_time" and 
+0005d270: 2274 696d 655f 7769 6474 685f 7065 7263  "time_width_perc
+0005d280: 656e 7422 2077 6f72 6b20 746f 6765 7468  ent" work togeth
+0005d290: 6572 2066 6f72 2063 7265 6174 696e 6720  er for creating 
+0005d2a0: 7370 6563 7472 616c 2070 6c6f 7473 2061  spectral plots a
+0005d2b0: 7420 0d0a 0909 0973 7065 6369 6669 6320  t .....specific 
+0005d2c0: 7469 6d65 706f 696e 7473 2e20 466f 7220  timepoints. For 
+0005d2d0: 6561 6368 2065 6e74 7279 2069 6e20 7265  each entry in re
+0005d2e0: 6c5f 7469 6d65 2061 2073 7065 6374 7275  l_time a spectru
+0005d2f0: 6d20 6973 2070 6c6f 7474 6564 2e20 0d0a  m is plotted. ..
+0005d300: 0909 0949 6620 686f 7765 7665 7220 652e  ...If however e.
+0005d310: 672e 2074 696d 655f 7769 6474 685f 7065  g. time_width_pe
+0005d320: 7263 656e 743d 3130 2074 6865 2072 6567  rcent=10 the reg
+0005d330: 696f 6e20 6265 7477 6565 6e20 7468 6520  ion between the 
+0005d340: 7469 6d65 706f 696e 7420 636c 6f73 6573  timepoint closes
+0005d350: 7420 0d0a 0909 0974 6f20 3a6d 6174 683a  t .....to :math:
+0005d360: 6074 696d 6570 6f69 6e74 2b30 2e31 7874  `timepoint+0.1xt
+0005d370: 696d 6570 6f69 6e74 c2b4 2061 6e64 203a  imepoint.. and :
+0005d380: 6d61 7468 3a60 7469 6d65 706f 696e 742d  math:`timepoint-
+0005d390: 302e 3178 7469 6d65 706f 696e 7460 2069  0.1xtimepoint` i
+0005d3a0: 7320 6176 6572 6167 6564 2061 6e64 2073  s averaged and s
+0005d3b0: 686f 776e 200d 0a09 0909 2861 6e64 2074  hown .....(and t
+0005d3c0: 6865 206c 6567 656e 6420 6164 6a75 7374  he legend adjust
+0005d3d0: 6564 2061 6363 6f72 6469 6e67 6c79 292e  ed accordingly).
+0005d3e0: 2049 6620 4e6f 6e65 2028 4465 6661 756c   If None (Defaul
+0005d3f0: 7429 2069 7320 6769 7665 6e2c 2074 6865  t) is given, the
+0005d400: 2076 616c 7565 2069 7320 0d0a 0909 0974   value is .....t
+0005d410: 616b 656e 2066 726f 6d20 7468 6520 7472  aken from the tr
+0005d420: 6967 6765 7269 6e67 206f 626a 6563 7420  iggering object 
+0005d430: 2873 656c 662e 7469 6d65 5f77 6964 7468  (self.time_width
+0005d440: 5f70 6572 6365 6e74 2920 5468 6973 2069  _percent) This i
+0005d450: 7320 7061 7274 6963 756c 6172 6c79 2075  s particularly u
+0005d460: 7365 6675 6c20 666f 7220 7468 6520 6465  seful for the de
+0005d470: 6e73 6c79 0d0a 0909 0973 616d 706c 6564  nsly.....sampled
+0005d480: 2072 6567 696f 6e20 636c 6f73 6520 746f   region close to
+0005d490: 2074 3d30 2e20 5479 7069 6361 6c6c 7920   t=0. Typically 
+0005d4a0: 666f 7220 6120 6c6f 6761 7269 7468 6d69  for a logarithmi
+0005d4b0: 6320 7265 636f 7264 6564 206b 696e 6574  c recorded kinet
+0005d4c0: 6963 732c 2074 6865 200d 0a09 0909 7469  ics, the .....ti
+0005d4d0: 6d65 706f 696e 7473 2061 7420 6c61 7465  mepoints at late
+0005d4e0: 7220 7469 6d65 7320 7769 6c6c 2062 6520  r times will be 
+0005d4f0: 6675 7274 6865 7220 6170 7061 7274 2074  further appart t
+0005d500: 6861 6e20 3130 2070 6572 6365 6e74 206f  han 10 percent o
+0005d510: 6620 7468 6520 7661 6c75 652c 200d 0a09  f the value, ...
+0005d520: 0909 6275 7420 7468 6973 2061 6c6c 6f77  ..but this allow
+0005d530: 7320 746f 2065 6c65 6761 6e74 6c79 2063  s to elegantly c
+0005d540: 6f6d 6269 6e65 2076 616c 7565 7320 6172  ombine values ar
+0005d550: 6f75 6e64 2074 696d 653d 3020 666f 7220  ound time=0 for 
+0005d560: 6265 7474 6572 2073 7461 7469 7374 6963  better statistic
+0005d570: 732e 200d 0a09 0909 5468 6973 2061 7665  s. .....This ave
+0005d580: 7261 6769 6e67 2069 7320 6f6e 6c79 2061  raging is only a
+0005d590: 7070 6c69 6564 2066 6f72 2074 6865 2070  pplied for the p
+0005d5a0: 6c6f 7474 696e 6720 6675 6e63 7469 6f6e  lotting function
+0005d5b0: 2061 6e64 206e 6f74 2066 6f72 2074 6865   and not for the
+0005d5c0: 2066 6974 732e 0d0a 0909 0d0a 0909 7370   fits.........sp
+0005d5d0: 6563 7472 6120 3a20 4e6f 6e65 206f 7220  ectra : None or 
+0005d5e0: 4461 7461 4672 616d 652c 206f 7074 696f  DataFrame, optio
+0005d5f0: 6e61 6c0d 0a09 0909 4966 2061 6e20 4461  nal.....If an Da
+0005d600: 7461 4672 616d 6520 7769 7468 2074 6865  taFrame with the
+0005d610: 2077 6176 656c 656e 6774 6820 6173 2069   wavelength as i
+0005d620: 6e64 6578 2069 7320 7072 6f76 6964 6564  ndex is provided
+0005d630: 2c20 5468 656e 2074 6865 2073 7065 6374  , Then the spect
+0005d640: 7261 206f 6620 6561 6368 2063 6f6c 756d  ra of each colum
+0005d650: 6e0d 0a09 0909 6973 2070 6c6f 7474 6564  n.....is plotted
+0005d660: 2069 6e74 6f20 7468 6520 6469 6666 6572   into the differ
+0005d670: 656e 7469 616c 2073 7065 6374 7261 2031  ential spectra 1
+0005d680: 2d31 2061 6e64 2074 6865 2063 6f6c 756d  -1 and the colum
+0005d690: 6e20 6e61 6d65 7320 6172 6520 7573 6564  n names are used
+0005d6a0: 2069 6e20 7468 6520 6c65 6765 6e64 0d0a   in the legend..
+0005d6b0: 0909 0950 7269 6f72 2073 6361 6c69 6e67  ...Prior scaling
+0005d6c0: 2069 7320 6869 6768 6c79 2073 7567 6765   is highly sugge
+0005d6d0: 7374 6564 2e20 5468 6573 6520 7370 6563  sted. These spec
+0005d6e0: 7472 6120 6172 6520 6e6f 7420 2869 6e20  tra are not (in 
+0005d6f0: 6765 6e65 7261 6c29 2073 6361 6c65 6420  general) scaled 
+0005d700: 7769 7468 2074 6865 200d 0a09 0909 6e6f  with the .....no
+0005d710: 726d 2077 696e 646f 772e 2028 7365 6520  rm window. (see 
+0005d720: 6578 616d 706c 6573 292e 0d0a 0909 0d0a  examples).......
+0005d730: 0909 6461 7461 5f61 6e64 5f66 6974 203a  ..data_and_fit :
+0005d740: 2062 6f6f 6c2c 206f 7074 696f 6e61 6c0d   bool, optional.
+0005d750: 0a09 0909 5472 7565 206f 7220 4661 6c73  ....True or Fals
+0005d760: 6520 2844 6566 6175 6c74 292c 2063 686f  e (Default), cho
+0005d770: 6f73 6520 6966 2066 6f72 2074 6865 2046  ose if for the F
+0005d780: 6974 7465 6420 706c 6f74 2074 6865 2072  itted plot the r
+0005d790: 6177 2064 6174 6120 6f66 2074 6865 200d  aw data of the .
+0005d7a0: 0a09 0909 6f74 6865 7220 7072 6f6a 6563  ....other projec
+0005d7b0: 7473 2069 7320 746f 2062 6520 706c 6f74  ts is to be plot
+0005d7c0: 7469 6e67 2069 6e20 6164 6469 7469 6f6e  ting in addition
+0005d7d0: 2074 6f20 7468 6520 6669 7474 6564 206c   to the fitted l
+0005d7e0: 696e 652e 2046 6f72 2046 616c 7365 2028  ine. For False (
+0005d7f0: 4465 6661 756c 7429 0d0a 0909 094f 6e6c  Default).....Onl
+0005d800: 7920 7468 6520 6669 7420 6973 2070 6c6f  y the fit is plo
+0005d810: 7474 6564 2e20 0d0a 0909 0d0a 0909 636d  tted. ........cm
+0005d820: 6170 203a 204e 6f6e 6520 6f72 206d 6174  ap : None or mat
+0005d830: 706c 6f74 6c69 6220 636f 6c6f 7220 6d61  plotlib color ma
+0005d840: 702c 206f 7074 696f 6e61 6c0d 0a09 0909  p, optional.....
+0005d850: 6973 2061 2070 6f77 6572 6675 6c6c 2076  is a powerfull v
+0005d860: 6172 6961 626c 6520 7468 6174 2063 686f  ariable that cho
+0005d870: 6f73 6573 2074 6865 2063 6f6c 6f75 7220  oses the colour 
+0005d880: 6d61 7020 6170 706c 6965 6420 666f 7220  map applied for 
+0005d890: 616c 6c20 706c 6f74 732e 2049 6620 7365  all plots. If se
+0005d8a0: 7420 746f 200d 0a09 0909 4e6f 6e65 2028  t to .....None (
+0005d8b0: 4465 6661 756c 7429 2074 6865 6e20 7468  Default) then th
+0005d8c0: 6520 7365 6c66 2e63 6d61 7020 6973 2075  e self.cmap is u
+0005d8d0: 7365 642e 0d0a 0909 0941 7320 7374 616e  sed......As stan
+0005d8e0: 6461 7264 2049 2075 7365 2074 6865 2063  dard I use the c
+0005d8f0: 6f6c 6f72 206d 6170 2022 6a65 7422 2066  olor map "jet" f
+0005d900: 726f 6d20 6d61 7470 6c6f 746c 6962 2e20  rom matplotlib. 
+0005d910: 5468 6572 6520 6172 6520 6120 7661 7269  There are a vari
+0005d920: 6574 7920 6f66 2063 6f6c 6f72 6d61 7073  ety of colormaps
+0005d930: 200d 0a09 0909 6176 6169 6c61 626c 6520   .....available 
+0005d940: 7468 6174 2061 7265 2076 6572 7920 7573  that are very us
+0005d950: 6566 756c 6c2e 2042 6573 6964 6520 226a  efull. Beside "j
+0005d960: 6574 222c 2022 7669 7269 6469 7322 2069  et", "viridis" i
+0005d970: 7320 6120 676f 6f64 2063 686f 6963 6520  s a good choice 
+0005d980: 6173 2069 7420 6973 2077 656c 6c20 0d0a  as it is well ..
+0005d990: 0909 0976 6973 6962 6c65 2075 6e64 6572  ...visible under
+0005d9a0: 2072 6564 2d67 7265 656e 2062 6c69 6e64   red-green blind
+0005d9b0: 6e65 7373 2e20 4f74 6865 7220 7573 6566  ness. Other usef
+0005d9c0: 756c 206d 6170 7320 6172 6520 2270 7269  ul maps are "pri
+0005d9d0: 736d 2220 666f 7220 6869 6768 2066 6c75  sm" for high flu
+0005d9e0: 6374 7561 7469 6f6e 7320 0d0a 0909 096f  ctuations .....o
+0005d9f0: 7220 6469 7665 7267 696e 6720 636f 6c6f  r diverging colo
+0005da00: 7220 6d61 7073 206c 696b 6520 2273 6569  r maps like "sei
+0005da10: 736d 6963 222e 200d 0a09 0909 5365 6520  smic". .....See 
+0005da20: 6874 7470 733a 2f2f 6d61 7470 6c6f 746c  https://matplotl
+0005da30: 6962 2e6f 7267 2f33 2e31 2e30 2f74 7574  ib.org/3.1.0/tut
+0005da40: 6f72 6961 6c73 2f63 6f6c 6f72 732f 636f  orials/colors/co
+0005da50: 6c6f 726d 6170 732e 6874 6d6c 2066 6f72  lormaps.html for
+0005da60: 2061 2063 6f6d 7072 6568 656e 7369 7665   a comprehensive
+0005da70: 200d 0a09 0909 7365 6c65 6374 696f 6e2e   .....selection.
+0005da80: 2049 6e20 7468 6520 636f 6465 2074 6865   In the code the
+0005da90: 2063 6f6c 6f72 6d61 7073 2061 7265 2069   colormaps are i
+0005daa0: 6d70 6f72 7465 6420 736f 2069 6620 706c  mported so if pl
+0005dab0: 6f74 5f66 756e 6320 6973 2069 6d70 6f72  ot_func is impor
+0005dac0: 7465 6420 6173 2070 6620 7468 656e 200d  ted as pf then .
+0005dad0: 0a09 0909 7365 6c66 2e63 6d61 703d 7066  ....self.cmap=pf
+0005dae0: 2e63 6d2e 7669 7269 6469 7320 7365 7473  .cm.viridis sets
+0005daf0: 2076 6972 6964 6973 2061 7320 7468 6520   viridis as the 
+0005db00: 6d61 7020 746f 2075 7365 2e20 496e 7465  map to use. Inte
+0005db10: 726e 616c 6c79 2074 6865 2063 6f6c 6f72  rnally the color
+0005db20: 7320 6172 6520 6368 6f73 656e 200d 0a09  s are chosen ...
+0005db30: 0909 7769 7468 2074 6865 2022 636f 6c6d  ..with the "colm
+0005db40: 2220 6675 6e63 7469 6f6e 2e20 5468 6520  " function. The 
+0005db50: 3264 2070 6c6f 7473 2072 6571 7569 7265  2d plots require
+0005db60: 2061 2063 6f6e 7469 6e75 6f75 7320 636f   a continuous co
+0005db70: 6c6f 7220 6d61 7020 736f 2069 6620 736f  lor map so if so
+0005db80: 6d65 7468 696e 6720 0d0a 0909 0965 6c73  mething .....els
+0005db90: 6520 6973 2067 6976 6520 3264 2070 6c6f  e is give 2d plo
+0005dba0: 7473 2061 7265 2073 686f 776e 2061 7574  ts are shown aut
+0005dbb0: 6f6d 6174 6963 616c 6c79 2077 6974 6820  omatically with 
+0005dbc0: 226a 6574 222e 2046 6f72 2061 6c6c 206f  "jet". For all o
+0005dbd0: 6620 7468 6520 3164 2070 6c6f 7473 2068  f the 1d plots h
+0005dbe0: 6f77 6576 6572 200d 0a09 0909 4920 6669  owever .....I fi
+0005dbf0: 7273 7420 7365 6c65 6374 2061 206e 756d  rst select a num
+0005dc00: 6265 7220 6f66 2063 6f6c 6f72 7320 6265  ber of colors be
+0005dc10: 666f 7265 2065 6163 6820 706c 6f74 2e20  fore each plot. 
+0005dc20: 4966 2063 6d61 7020 6973 2061 2063 6f6e  If cmap is a con
+0005dc30: 7469 6e6f 7573 206d 6170 2074 6865 6e20  tinous map then 
+0005dc40: 7468 6573 650d 0a09 0909 6172 6520 7361  these.....are sa
+0005dc50: 6d70 6c65 6420 6576 656e 6c79 206f 7665  mpled evenly ove
+0005dc60: 7220 7468 6520 636f 6c6f 7572 6d61 702e  r the colourmap.
+0005dc70: 204d 616e 7561 6c20 6974 6572 6162 6c65   Manual iterable
+0005dc80: 7320 6f66 2063 6f6c 6f75 7273 200d 0a09  s of colours ...
+0005dc90: 0909 636d 6170 3d5b 2831 2c30 2c30 292c  ..cmap=[(1,0,0),
+0005dca0: 2830 2c31 2c30 292c 2830 2c30 2c31 292c  (0,1,0),(0,0,1),
+0005dcb0: 2e2e 2e5d 2061 7265 2061 6c73 6f20 6163  ...] are also ac
+0005dcc0: 6365 7074 6564 2c20 6173 2061 7265 2076  cepted, as are v
+0005dcd0: 6563 746f 7273 206f 7220 6461 7461 6672  ectors or datafr
+0005dce0: 616d 6573 2074 6861 7420 0d0a 0909 0963  ames that .....c
+0005dcf0: 6f6e 7461 696e 2061 7320 726f 7773 2074  ontain as rows t
+0005dd00: 6865 2063 6f6c 6f72 732e 2054 6865 7265  he colors. There
+0005dd10: 206d 7573 7420 6265 206f 6620 636f 7572   must be of cour
+0005dd20: 7365 2073 7566 6669 6369 656e 7420 636f  se sufficient co
+0005dd30: 6c6f 7273 2070 7265 7365 6e74 2066 6f72  lors present for
+0005dd40: 200d 0a09 0909 7468 6520 6e75 6d62 6572   .....the number
+0005dd50: 7320 6f66 206c 696e 6573 2074 6861 7420  s of lines that 
+0005dd60: 7769 6c6c 2062 6520 706c 6f74 7465 642e  will be plotted.
+0005dd70: 2053 6f20 4920 7265 636f 6d6d 656e 6420   So I recommend 
+0005dd80: 746f 2070 726f 7669 6465 2061 7420 6c65  to provide at le
+0005dd90: 6173 7420 3130 2063 6f6c 6f75 7273 200d  ast 10 colours .
+0005dda0: 0a09 0909 2865 2e67 2e7e 796f 7572 2075  ....(e.g.~your u
+0005ddb0: 6e69 7665 7273 6974 7920 636f 6c6f 7273  niversity colors
+0005ddc0: 292e 2063 6f6c 6f75 7273 2061 7265 2061  ). colours are a
+0005ddd0: 6c77 6179 7320 6769 7665 6e20 6173 2061  lways given as a
+0005dde0: 2c20 6c69 7374 206f 7220 7475 706c 6520  , list or tuple 
+0005ddf0: 7769 7468 2052 4741 206f 7220 5247 4241  with RGA or RGBA
+0005de00: 0d0a 0909 0928 7769 7468 2074 6865 206c  .....(with the l
+0005de10: 6173 7420 4120 6265 6569 6e67 2074 6865  ast A beeing the
+0005de20: 2041 6c70 6861 3d74 7261 6e73 7061 7265   Alpha=transpare
+0005de30: 6e63 792e 2041 6c6c 206e 756d 6265 7273  ncy. All numbers
+0005de40: 2061 7265 2062 6574 7765 656e 2030 2061   are between 0 a
+0005de50: 6e64 2031 2e20 0d0a 0909 0949 6620 6120  nd 1. .....If a 
+0005de60: 6c69 7374 2f76 6563 746f 722f 4461 7461  list/vector/Data
+0005de70: 4672 616d 6520 6973 2067 6976 656e 2066  Frame is given f
+0005de80: 6f72 2074 6865 2063 6f6c 6f75 7273 2074  or the colours t
+0005de90: 6865 7920 7769 6c6c 2062 6520 7573 6564  hey will be used
+0005dea0: 2069 6e20 7468 6520 6f72 6465 7220 7072   in the order pr
+0005deb0: 6f76 6964 6564 2e0d 0a09 0970 6c6f 745f  ovided.....plot_
+0005dec0: 7365 636f 6e64 5f61 735f 656e 6572 6779  second_as_energy
+0005ded0: 203a 2062 6f6f 6c2c 206f 7074 696f 6e61   : bool, optiona
+0005dee0: 6c0d 0a09 0909 466f 7220 2844 6566 6175  l.....For (Defau
+0005def0: 6c74 2920 5472 7565 2061 2073 6563 6f6e  lt) True a secon
+0005df00: 6420 782d 6178 6973 2069 7320 706c 6f74  d x-axis is plot
+0005df10: 7465 6420 2077 6974 6820 2265 5622 2061  ted  with "eV" a
+0005df20: 7320 756e 6974 0d0a 0d0a 0909 7072 696e  s unit......prin
+0005df30: 745f 636c 6963 6b5f 706f 7369 7469 6f6e  t_click_position
+0005df40: 203a 2062 6f6f 6c2c 206f 7074 696f 6e61   : bool, optiona
+0005df50: 6c0d 0a09 0909 6966 2054 7275 6520 7468  l.....if True th
+0005df60: 656e 2074 6865 2063 6c69 636b 2070 6f73  en the click pos
+0005df70: 6974 696f 6e20 6973 2070 7269 6e74 6564  ition is printed
+0005df80: 2066 6f72 2074 6865 2073 7065 6374 7261   for the spectra
+0005df90: 6c20 706c 6f74 7320 0d0a 0d0a 0909 4578  l plots ......Ex
+0005dfa0: 616d 706c 6573 0d0a 0909 2d2d 2d2d 2d2d  amples....------
+0005dfb0: 2d2d 2d2d 0d0a 0909 0d0a 0909 3e3e 3e20  ----........>>> 
+0005dfc0: 696d 706f 7274 2070 6c6f 745f 6675 6e63  import plot_func
+0005dfd0: 2061 7320 7066 0d0a 0909 3e3e 3e20 7461   as pf....>>> ta
+0005dfe0: 203d 2070 662e 5441 2822 7465 7374 312e   = pf.TA("test1.
+0005dff0: 6864 6635 2229 2023 6f70 656e 2074 6865  hdf5") #open the
+0005e000: 206f 7269 6769 6e61 6c20 7072 6f6a 6563   original projec
+0005e010: 740d 0a09 090d 0a09 094e 6f77 206f 7065  t........Now ope
+0005e020: 6e20 6120 6275 6e63 6820 6f66 206f 7468  n a bunch of oth
+0005e030: 6572 2070 6f72 6a65 6374 7320 746f 2063  er porjects to c
+0005e040: 6f6d 6172 6520 6167 6169 6e73 740d 0a09  omare against...
+0005e050: 090d 0a09 093e 3e3e 206f 7468 6572 5f70  .....>>> other_p
+0005e060: 726f 6a65 6374 7320 3d20 7066 2e47 5549  rojects = pf.GUI
+0005e070: 5f6f 7065 6e28 7072 6f6a 6563 745f 6c69  _open(project_li
+0005e080: 7374 203d 205b 2266 696c 6531 2e53 4941  st = ["file1.SIA
+0005e090: 222c 2022 6669 6c65 322e 5349 4122 5d29  ", "file2.SIA"])
+0005e0a0: 0d0a 0909 0d0a 0909 5479 7069 6361 6c20  ........Typical 
+0005e0b0: 7573 6520 6973 2063 6f6d 7061 7265 2074  use is compare t
+0005e0c0: 6865 2072 6177 2064 6174 6120 7769 7468  he raw data with
+0005e0d0: 6f75 7420 6e6f 726d 616c 697a 6174 696f  out normalizatio
+0005e0e0: 6e20 6174 2031 7073 2061 6e64 2036 7073  n at 1ps and 6ps
+0005e0f0: 2e0d 0a09 090d 0a09 093e 3e3e 2074 612e  .........>>> ta.
+0005e100: 436f 6d70 6172 655f 6174 5f74 696d 6528  Compare_at_time(
+0005e110: 7265 6c5f 7469 6d65 203d 205b 312c 365d  rel_time = [1,6]
+0005e120: 2c20 6f74 6865 7273 203d 206f 7468 6572  , others = other
+0005e130: 5f70 726f 6a65 6374 290d 0a09 090d 0a09  _project).......
+0005e140: 0943 6f6d 7061 7265 2074 6865 2066 6974  .Compare the fit
+0005e150: 2077 6974 6870 7574 206e 6f72 6d61 6c69   withput normali
+0005e160: 7a61 7469 6f6e 2061 7420 3170 7320 616e  zation at 1ps an
+0005e170: 6420 3670 732e 0d0a 0909 0d0a 0909 3e3e  d 6ps.........>>
+0005e180: 3e20 7461 2e43 6f6d 7061 7265 5f61 745f  > ta.Compare_at_
+0005e190: 7469 6d65 2872 656c 5f74 696d 6520 3d20  time(rel_time = 
+0005e1a0: 5b31 2c36 5d2c 206f 7468 6572 7320 3d20  [1,6], others = 
+0005e1b0: 6f74 6865 725f 7072 6f6a 6563 742c 2066  other_project, f
+0005e1c0: 6974 7465 6420 3d20 5472 7565 290d 0a09  itted = True)...
+0005e1d0: 090d 0a09 0943 6f6d 7061 7265 2077 6974  .....Compare wit
+0005e1e0: 6820 6e6f 726d 616c 697a 6174 696f 6e20  h normalization 
+0005e1f0: 7769 6e64 6f77 2062 6574 7765 656e 2031  window between 1
+0005e200: 7073 2061 6e64 2032 7073 2061 6e64 2034  ps and 2ps and 4
+0005e210: 3030 6e6d 2061 6e64 2034 3530 6e6d 2e0d  00nm and 450nm..
+0005e220: 0a09 090d 0a09 093e 3e3e 206e 6f72 6d5f  .......>>> norm_
+0005e230: 7769 6e64 6f77 3d5b 312c 322c 3430 302c  window=[1,2,400,
+0005e240: 3435 305d 0d0a 0909 3e3e 3e20 7461 2e43  450]....>>> ta.C
+0005e250: 6f6d 7061 7265 5f61 745f 7469 6d65 2872  ompare_at_time(r
+0005e260: 656c 5f74 696d 6520 3d20 5b31 2c36 5d2c  el_time = [1,6],
+0005e270: 206f 7468 6572 7320 3d20 6f74 6865 725f   others = other_
+0005e280: 7072 6f6a 6563 742c 206e 6f72 6d5f 7769  project, norm_wi
+0005e290: 6e64 6f77 203d 206e 6f72 6d5f 7769 6e64  ndow = norm_wind
+0005e2a0: 6f77 290d 0a09 090d 0a09 0943 6f6d 7061  ow)........Compa
+0005e2b0: 7265 2074 6865 2073 7065 6374 7275 6d20  re the spectrum 
+0005e2c0: 6174 2031 7073 2061 6e64 2036 7073 2077  at 1ps and 6ps w
+0005e2d0: 6974 6820 616e 2065 7874 6572 6e61 6c20  ith an external 
+0005e2e0: 7370 6563 7472 756d 2e0d 0a09 090d 0a09  spectrum........
+0005e2f0: 093e 3e3e 2065 7874 5f73 7065 6320 3d20  .>>> ext_spec = 
+0005e300: 7064 2e72 6561 645f 6373 7628 2241 7363  pd.read_csv("Asc
+0005e310: 6969 5f73 7065 6374 7275 6d2e 6461 7422  ii_spectrum.dat"
+0005e320: 2c20 7365 7020 3d20 222c 2229 0d0a 0909  , sep = ",")....
+0005e330: 3e3e 3e20 7461 2e43 6f6d 7061 7265 5f61  >>> ta.Compare_a
+0005e340: 745f 7469 6d65 2872 656c 5f74 696d 6520  t_time(rel_time 
+0005e350: 3d20 5b31 2c36 5d2c 2073 7065 6374 7261  = [1,6], spectra
+0005e360: 203d 2065 7874 5f73 7065 6329 0d0a 0d0a   = ext_spec)....
+0005e370: 0909 5573 6520 6578 616d 706c 6520 2d20  ..Use example - 
+0005e380: 204f 6674 656e 2074 6865 7265 2061 7265   Often there are
+0005e390: 2061 206c 6f74 206f 6620 6469 6666 6572   a lot of differ
+0005e3a0: 656e 7420 6d65 6173 7572 656d 656e 7473  ent measurements
+0005e3b0: 2074 6f20 0d0a 0909 636f 6d70 6172 6520   to ....compare 
+0005e3c0: 6174 206d 756c 7469 706c 6520 7469 6d65  at multiple time
+0005e3d0: 2e20 5468 6520 6e6f 726d 6c69 7a61 7469  . The normlizati
+0005e3e0: 6f6e 2069 7320 7065 7266 6f72 6d65 6420  on is performed 
+0005e3f0: 6174 2074 6865 2067 726f 756e 6420 7374  at the ground st
+0005e400: 6174 6520 626c 6561 6368 0d0a 0909 3436  ate bleach....46
+0005e410: 3020 6e6d 2061 6e64 2065 6172 6c79 2069  0 nm and early i
+0005e420: 6e20 7469 6d65 2e20 5468 656e 2069 7420  n time. Then it 
+0005e430: 6973 2062 6574 7465 7220 746f 206d 616b  is better to mak
+0005e440: 6520 6120 6e65 7720 706c 6f74 2066 6f72  e a new plot for
+0005e450: 2065 6163 6820 0d0a 0909 7469 6d65 706f   each ....timepo
+0005e460: 696e 742e 2054 6865 206e 6f72 6d61 6c69  int. The normali
+0005e470: 7a61 7469 6f6e 2077 696e 646f 7720 7374  zation window st
+0005e480: 6179 7320 6669 7865 642e 0d0a 0909 0d0a  ays fixed.......
+0005e490: 0909 3e3e 3e20 706c 742e 636c 6f73 6528  ..>>> plt.close(
+0005e4a0: 2261 6c6c 2229 2023 6d61 6b65 2073 6f6d  "all") #make som
+0005e4b0: 6520 7370 6163 650d 0a09 093e 3e3e 206e  e space....>>> n
+0005e4c0: 6f72 6d5f 7769 6e64 6f77 3d5b 302e 332c  orm_window=[0.3,
+0005e4d0: 302e 352c 3435 302c 3437 305d 2023 6465  0.5,450,470] #de
+0005e4e0: 6669 6e65 2077 696e 646f 7720 696e 2067  fine window in g
+0005e4f0: 726f 756e 6420 7374 6174 6520 626c 6561  round state blea
+0005e500: 6368 0d0a 0909 3e3e 3e20 666f 7220 7420  ch....>>> for t 
+0005e510: 696e 205b 302e 332c 302e 352c 312c 332c  in [0.3,0.5,1,3,
+0005e520: 3130 2c33 305d 3a20 2369 7465 7261 7465  10,30]: #iterate
+0005e530: 206f 7665 7220 7468 6520 7761 7665 6c65   over the wavele
+0005e540: 6e67 7468 200d 0a09 093e 3e3e 2009 7461  ngth ....>>> .ta
+0005e550: 2e43 6f6d 7061 7265 5f61 745f 7469 6d65  .Compare_at_time
+0005e560: 2872 656c 5f74 696d 6520 3d20 742c 206f  (rel_time = t, o
+0005e570: 7468 6572 7320 3d20 6f74 6865 725f 7072  thers = other_pr
+0005e580: 6f6a 6563 742c 206e 6f72 6d5f 7769 6e64  oject, norm_wind
+0005e590: 6f77 203d 206e 6f72 6d5f 7769 6e64 6f77  ow = norm_window
+0005e5a0: 290d 0a09 090d 0a09 0927 2727 0d0a 0909  )........'''....
+0005e5b0: 0d0a 0909 6966 2073 656c 662e 7361 7665  ....if self.save
+0005e5c0: 5f66 6967 7572 6573 5f74 6f5f 666f 6c64  _figures_to_fold
+0005e5d0: 6572 3a73 656c 662e 6669 6775 7265 5f70  er:self.figure_p
+0005e5e0: 6174 683d 6368 6563 6b5f 666f 6c64 6572  ath=check_folder
+0005e5f0: 2870 6174 683d 2772 6573 756c 745f 6669  (path='result_fi
+0005e600: 6775 7265 7327 2c63 7572 7265 6e74 5f70  gures',current_p
+0005e610: 6174 683d 7365 6c66 2e70 6174 6829 0d0a  ath=self.path)..
+0005e620: 0909 6966 2074 696d 655f 7769 6474 685f  ..if time_width_
+0005e630: 7065 7263 656e 7420 6973 204e 6f6e 653a  percent is None:
+0005e640: 7469 6d65 5f77 6964 7468 5f70 6572 6365  time_width_perce
+0005e650: 6e74 3d73 656c 662e 7469 6d65 5f77 6964  nt=self.time_wid
+0005e660: 7468 5f70 6572 6365 6e74 0d0a 0909 6966  th_percent....if
+0005e670: 2072 656c 5f74 696d 6520 6973 204e 6f6e   rel_time is Non
+0005e680: 653a 7265 6c5f 7469 6d65 3d73 656c 662e  e:rel_time=self.
+0005e690: 7265 6c5f 7469 6d65 0d0a 0909 6966 206f  rel_time....if o
+0005e6a0: 7468 6572 2069 7320 6e6f 7420 4e6f 6e65  ther is not None
+0005e6b0: 3a0d 0a09 0909 6966 206e 6f74 2068 6173  :.....if not has
+0005e6c0: 6174 7472 286f 7468 6572 2c27 5f5f 6974  attr(other,'__it
+0005e6d0: 6572 5f5f 2729 3a6f 7468 6572 3d5b 6f74  er__'):other=[ot
+0005e6e0: 6865 725d 0d0a 0909 6966 2072 656c 5f74  her]....if rel_t
+0005e6f0: 696d 6520 6973 206e 6f74 204e 6f6e 653a  ime is not None:
+0005e700: 0d0a 0909 0969 6620 6e6f 7420 6861 7361  .....if not hasa
+0005e710: 7474 7228 7265 6c5f 7469 6d65 2c27 5f5f  ttr(rel_time,'__
+0005e720: 6974 6572 5f5f 2729 3a72 656c 5f74 696d  iter__'):rel_tim
+0005e730: 653d 5b72 656c 5f74 696d 655d 0909 0d0a  e=[rel_time]....
+0005e740: 0909 656c 7365 3a0d 0a09 0909 7265 6c5f  ..else:.....rel_
+0005e750: 7469 6d65 3d5b 315d 0d0a 0909 6966 2063  time=[1]....if c
+0005e760: 6d61 7020 6973 204e 6f6e 653a 636d 6170  map is None:cmap
+0005e770: 3d73 656c 662e 636d 6170 0d0a 0909 6966  =self.cmap....if
+0005e780: 2066 6974 7465 643a 0d0a 0909 0974 7279   fitted:.....try
+0005e790: 3a0d 0a09 0909 0972 653d 7365 6c66 2e72  :......re=self.r
+0005e7a0: 650d 0a09 0909 6578 6365 7074 3a0d 0a09  e.....except:...
+0005e7b0: 0909 0970 7269 6e74 2822 4e6f 2066 6974  ...print("No fit
+0005e7c0: 7465 6420 7265 7375 6c74 7320 7072 6573  ted results pres
+0005e7d0: 656e 7422 290d 0a09 0909 0972 6574 7572  ent")......retur
+0005e7e0: 6e20 4661 6c73 650d 0a09 0909 6966 206e  n False.....if n
+0005e7f0: 6f72 6d5f 7769 6e64 6f77 2069 7320 6e6f  orm_window is no
+0005e800: 7420 4e6f 6e65 3a0d 0a09 0909 0972 6566  t None:......ref
+0005e810: 5f73 6361 6c65 3d72 655b 2741 275d 2e6c  _scale=re['A'].l
+0005e820: 6f63 5b6e 6f72 6d5f 7769 6e64 6f77 5b30  oc[norm_window[0
+0005e830: 5d3a 6e6f 726d 5f77 696e 646f 775b 315d  ]:norm_window[1]
+0005e840: 2c6e 6f72 6d5f 7769 6e64 6f77 5b32 5d3a  ,norm_window[2]:
+0005e850: 6e6f 726d 5f77 696e 646f 775b 335d 5d2e  norm_window[3]].
+0005e860: 6d65 616e 2829 2e6d 6561 6e28 290d 0a09  mean().mean()...
+0005e870: 0909 6669 672c 6178 3d70 6c74 2e73 7562  ..fig,ax=plt.sub
+0005e880: 706c 6f74 7328 6669 6773 697a 653d 2831  plots(figsize=(1
+0005e890: 302c 3629 2c64 7069 3d31 3030 290d 0a09  0,6),dpi=100)...
+0005e8a0: 0909 6f62 6a65 6374 733d 6c65 6e28 7265  ..objects=len(re
+0005e8b0: 6c5f 7469 6d65 292a 2831 2b6c 656e 286f  l_time)*(1+len(o
+0005e8c0: 7468 6572 2929 0d0a 0909 0963 6f6c 6f72  ther)).....color
+0005e8d0: 733d 636f 6c6d 2863 6d61 703d 636d 6170  s=colm(cmap=cmap
+0005e8e0: 2c6b 3d72 616e 6765 286f 626a 6563 7473  ,k=range(objects
+0005e8f0: 2929 0d0a 0909 095f 3d70 6c6f 745f 7469  ))....._=plot_ti
+0005e900: 6d65 2872 655b 2741 275d 2c20 6178 203d  me(re['A'], ax =
+0005e910: 2061 782c 2072 656c 5f74 696d 6520 3d20   ax, rel_time = 
+0005e920: 7265 6c5f 7469 6d65 2c20 7469 6d65 5f77  rel_time, time_w
+0005e930: 6964 7468 5f70 6572 6365 6e74 203d 2074  idth_percent = t
+0005e940: 696d 655f 7769 6474 685f 7065 7263 656e  ime_width_percen
+0005e950: 742c 200d 0a09 0909 0909 0962 6173 6575  t, ........baseu
+0005e960: 6e69 7420 3d20 7365 6c66 2e62 6173 6575  nit = self.baseu
+0005e970: 6e69 742c 206c 696e 6573 5f61 7265 203d  nit, lines_are =
+0005e980: 2027 6461 7461 272c 2063 6d61 7020 3d20   'data', cmap = 
+0005e990: 636f 6c6f 7273 5b3a 6c65 6e28 7265 6c5f  colors[:len(rel_
+0005e9a0: 7469 6d65 295d 2c20 7469 746c 6520 3d20  time)], title = 
+0005e9b0: 2727 2c20 6c69 6e65 7769 6474 6820 3d20  '', linewidth = 
+0005e9c0: 6c69 6e65 7769 6474 682c 2073 7562 706c  linewidth, subpl
+0005e9d0: 6f74 3d20 5472 7565 2c20 7363 6174 7465  ot= True, scatte
+0005e9e0: 7263 7574 203d 2073 656c 662e 7363 6174  rcut = self.scat
+0005e9f0: 7465 7263 7574 290d 0a09 0909 5f3d 706c  tercut)....._=pl
+0005ea00: 6f74 5f74 696d 6528 7265 5b27 4143 275d  ot_time(re['AC']
+0005ea10: 2c20 6178 203d 2061 782c 2072 656c 5f74  , ax = ax, rel_t
+0005ea20: 696d 6520 3d20 7265 6c5f 7469 6d65 2c20  ime = rel_time, 
+0005ea30: 7469 6d65 5f77 6964 7468 5f70 6572 6365  time_width_perce
+0005ea40: 6e74 203d 2074 696d 655f 7769 6474 685f  nt = time_width_
+0005ea50: 7065 7263 656e 742c 200d 0a09 0909 0909  percent, .......
+0005ea60: 0962 6173 6575 6e69 7420 3d20 7365 6c66  .baseunit = self
+0005ea70: 2e62 6173 6575 6e69 742c 206c 696e 6573  .baseunit, lines
+0005ea80: 5f61 7265 203d 2027 6669 7474 6564 272c  _are = 'fitted',
+0005ea90: 2063 6d61 7020 3d20 636f 6c6f 7273 5b3a   cmap = colors[:
+0005eaa0: 6c65 6e28 7265 6c5f 7469 6d65 295d 2c20  len(rel_time)], 
+0005eab0: 7469 746c 6520 3d20 2727 2c20 7375 6270  title = '', subp
+0005eac0: 6c6f 7420 3d20 4661 6c73 652c 206c 696e  lot = False, lin
+0005ead0: 6577 6964 7468 203d 206c 696e 6577 6964  ewidth = linewid
+0005eae0: 7468 2c20 7363 6174 7465 7263 7574 203d  th, scattercut =
+0005eaf0: 2073 656c 662e 7363 6174 7465 7263 7574   self.scattercut
+0005eb00: 290d 0a09 0909 6861 6e64 6c65 732c 206c  ).....handles, l
+0005eb10: 6162 656c 733d 6178 2e67 6574 5f6c 6567  abels=ax.get_leg
+0005eb20: 656e 645f 6861 6e64 6c65 735f 6c61 6265  end_handles_labe
+0005eb30: 6c73 2829 0d0a 0909 096c 6162 3d5b 2725  ls().....lab=['%
+0005eb40: 6720 2573 2725 2865 6e74 2c73 656c 662e  g %s'%(ent,self.
+0005eb50: 6261 7365 756e 6974 2920 2b20 275f 2720  baseunit) + '_' 
+0005eb60: 2b20 7374 7228 7365 6c66 2e66 696c 656e  + str(self.filen
+0005eb70: 616d 6529 2066 6f72 2065 6e74 2069 6e20  ame) for ent in 
+0005eb80: 7265 6c5f 7469 6d65 5d0d 0a09 0909 6861  rel_time].....ha
+0005eb90: 6e3d 6861 6e64 6c65 735b 3a6c 656e 2872  n=handles[:len(r
+0005eba0: 656c 5f74 696d 6529 2a32 5d0d 0a09 0909  el_time)*2].....
+0005ebb0: 666f 7220 656e 7420 696e 2072 656c 5f74  for ent in rel_t
+0005ebc0: 696d 653a 0d0a 0909 0909 6c61 622e 6170  ime:......lab.ap
+0005ebd0: 7065 6e64 2827 2567 2025 7320 6669 7427  pend('%g %s fit'
+0005ebe0: 2528 656e 742c 7365 6c66 2e62 6173 6575  %(ent,self.baseu
+0005ebf0: 6e69 7429 202b 2027 5f27 202b 2073 7472  nit) + '_' + str
+0005ec00: 2873 656c 662e 6669 6c65 6e61 6d65 2929  (self.filename))
+0005ec10: 0d0a 0909 0969 6620 6f74 6865 7220 6973  .....if other is
+0005ec20: 206e 6f74 204e 6f6e 653a 0d0a 0909 0909   not None:......
+0005ec30: 666f 7220 692c 6f20 696e 2065 6e75 6d65  for i,o in enume
+0005ec40: 7261 7465 286f 7468 6572 293a 0d0a 0909  rate(other):....
+0005ec50: 0909 0974 7279 3a0d 0a09 0909 0909 0972  ...try:........r
+0005ec60: 653d 6f2e 7265 0d0a 0909 0909 0965 7863  e=o.re.......exc
+0005ec70: 6570 743a 0d0a 0909 0909 0909 7072 696e  ept:........prin
+0005ec80: 7428 2725 7320 6861 7320 6e6f 2066 6974  t('%s has no fit
+0005ec90: 7465 6420 7265 7375 6c74 7327 256f 2e66  ted results'%o.f
+0005eca0: 696c 656e 616d 6529 0d0a 0909 0909 0909  ilename)........
+0005ecb0: 636f 6e74 696e 7565 0d0a 0909 0909 0969  continue.......i
+0005ecc0: 6620 6e6f 726d 5f77 696e 646f 7720 6973  f norm_window is
+0005ecd0: 206e 6f74 204e 6f6e 653a 0d0a 0909 0909   not None:......
+0005ece0: 0909 7265 6c5f 7363 616c 653d 7265 5b27  ..rel_scale=re['
+0005ecf0: 4127 5d2e 6c6f 635b 6e6f 726d 5f77 696e  A'].loc[norm_win
+0005ed00: 646f 775b 305d 3a6e 6f72 6d5f 7769 6e64  dow[0]:norm_wind
+0005ed10: 6f77 5b31 5d2c 6e6f 726d 5f77 696e 646f  ow[1],norm_windo
+0005ed20: 775b 325d 3a6e 6f72 6d5f 7769 6e64 6f77  w[2]:norm_window
+0005ed30: 5b33 5d5d 2e6d 6561 6e28 292e 6d65 616e  [3]].mean().mean
+0005ed40: 2829 0d0a 0909 0909 0909 7472 793a 0d0a  ()........try:..
+0005ed50: 0909 0909 0909 0973 6361 6c69 6e67 3d28  .......scaling=(
+0005ed60: 7265 6c5f 7363 616c 652f 7265 665f 7363  rel_scale/ref_sc
+0005ed70: 616c 6529 0d0a 0909 0909 0909 0961 783d  ale).........ax=
+0005ed80: 706c 6f74 5f74 696d 6528 7265 5b27 4143  plot_time(re['AC
+0005ed90: 275d 2f73 6361 6c69 6e67 2c20 636d 6170  ']/scaling, cmap
+0005eda0: 203d 2063 6f6c 6f72 732c 2061 7820 3d20   = colors, ax = 
+0005edb0: 6178 2c20 7265 6c5f 7469 6d65 203d 2072  ax, rel_time = r
+0005edc0: 656c 5f74 696d 652c 200d 0a09 0909 0909  el_time, .......
+0005edd0: 0909 0909 0974 696d 655f 7769 6474 685f  .....time_width_
+0005ede0: 7065 7263 656e 7420 3d20 7469 6d65 5f77  percent = time_w
+0005edf0: 6964 7468 5f70 6572 6365 6e74 2c20 7469  idth_percent, ti
+0005ee00: 746c 6520 3d20 2727 2c20 6c69 6e65 735f  tle = '', lines_
+0005ee10: 6172 6520 3d20 2766 6974 7465 6427 2c20  are = 'fitted', 
+0005ee20: 0d0a 0909 0909 0909 0909 0909 7375 6270  ............subp
+0005ee30: 6c6f 7420 3d20 5472 7565 2c20 636f 6c6f  lot = True, colo
+0005ee40: 725f 6f66 6673 6574 203d 206c 656e 2872  r_offset = len(r
+0005ee50: 656c 5f74 696d 6529 2a28 692b 3129 2c20  el_time)*(i+1), 
+0005ee60: 6c69 6e65 7769 6474 6820 3d20 6c69 6e65  linewidth = line
+0005ee70: 7769 6474 682c 2073 6361 7474 6572 6375  width, scattercu
+0005ee80: 7420 3d20 6f2e 7363 6174 7465 7263 7574  t = o.scattercut
+0005ee90: 290d 0a09 0909 0909 0909 6861 6e64 6c65  ).........handle
+0005eea0: 732c 206c 6162 656c 733d 6178 2e67 6574  s, labels=ax.get
+0005eeb0: 5f6c 6567 656e 645f 6861 6e64 6c65 735f  _legend_handles_
+0005eec0: 6c61 6265 6c73 2829 0d0a 0909 0909 0909  labels()........
+0005eed0: 0966 6f72 2065 6e74 2069 6e20 7265 6c5f  .for ent in rel_
+0005eee0: 7469 6d65 3a0d 0a09 0909 0909 0909 096c  time:..........l
+0005eef0: 6162 2e61 7070 656e 6428 2725 6720 2573  ab.append('%g %s
+0005ef00: 2066 6974 2725 2865 6e74 2c6f 2e62 6173   fit'%(ent,o.bas
+0005ef10: 6575 6e69 7429 202b 2027 5f27 202b 2073  eunit) + '_' + s
+0005ef20: 7472 286f 2e66 696c 656e 616d 6529 290d  tr(o.filename)).
+0005ef30: 0a09 0909 0909 0909 666f 7220 6120 696e  ........for a in
+0005ef40: 2068 616e 646c 6573 5b2d 6c65 6e28 7265   handles[-len(re
+0005ef50: 6c5f 7469 6d65 293a 5d3a 0d0a 0909 0909  l_time):]:......
+0005ef60: 0909 0909 6861 6e2e 6170 7065 6e64 2861  ....han.append(a
+0005ef70: 290d 0a09 0909 0909 0909 0d0a 0909 0909  )...............
+0005ef80: 0909 0969 6620 6461 7461 5f61 6e64 5f66  ...if data_and_f
+0005ef90: 6974 3a0d 0a09 0909 0909 0909 0961 783d  it:..........ax=
+0005efa0: 706c 6f74 5f74 696d 6528 7265 5b27 4127  plot_time(re['A'
+0005efb0: 5d2f 7363 616c 696e 672c 2063 6d61 7020  ]/scaling, cmap 
+0005efc0: 3d20 7365 6c66 2e63 6d61 702c 2061 7820  = self.cmap, ax 
+0005efd0: 3d20 6178 2c20 7265 6c5f 7469 6d65 203d  = ax, rel_time =
+0005efe0: 2072 656c 5f74 696d 652c 200d 0a09 0909   rel_time, .....
+0005eff0: 0909 0909 0909 0909 7469 6d65 5f77 6964  ........time_wid
+0005f000: 7468 5f70 6572 6365 6e74 203d 2074 696d  th_percent = tim
+0005f010: 655f 7769 6474 685f 7065 7263 656e 742c  e_width_percent,
+0005f020: 2074 6974 6c65 203d 206f 2e66 696c 656e   title = o.filen
+0005f030: 616d 652c 200d 0a09 0909 0909 0909 0909  ame, ...........
+0005f040: 0909 6261 7365 756e 6974 203d 2073 656c  ..baseunit = sel
+0005f050: 662e 6261 7365 756e 6974 2c20 6c69 6e65  f.baseunit, line
+0005f060: 735f 6172 6520 3d20 2764 6174 6127 2c20  s_are = 'data', 
+0005f070: 7375 6270 6c6f 7420 3d20 5472 7565 2c20  subplot = True, 
+0005f080: 0d0a 0909 0909 0909 0909 0909 0963 6f6c  .............col
+0005f090: 6f72 5f6f 6666 7365 7420 3d20 6c65 6e28  or_offset = len(
+0005f0a0: 7265 6c5f 7469 6d65 292a 2869 2b31 292c  rel_time)*(i+1),
+0005f0b0: 206c 696e 6577 6964 7468 203d 206c 696e   linewidth = lin
+0005f0c0: 6577 6964 7468 2c20 7363 6174 7465 7263  ewidth, scatterc
+0005f0d0: 7574 203d 206f 2e73 6361 7474 6572 6375  ut = o.scattercu
+0005f0e0: 7429 0d0a 0909 0909 0909 0909 6861 6e64  t)..........hand
+0005f0f0: 6c65 732c 206c 6162 656c 733d 6178 2e67  les, labels=ax.g
+0005f100: 6574 5f6c 6567 656e 645f 6861 6e64 6c65  et_legend_handle
+0005f110: 735f 6c61 6265 6c73 2829 0d0a 0909 0909  s_labels()......
+0005f120: 0909 0909 666f 7220 656e 7420 696e 2072  ....for ent in r
+0005f130: 656c 5f74 696d 653a 0d0a 0909 0909 0909  el_time:........
+0005f140: 0909 096c 6162 2e61 7070 656e 6428 2725  ...lab.append('%
+0005f150: 6720 2573 2725 2865 6e74 2c6f 2e62 6173  g %s'%(ent,o.bas
+0005f160: 6575 6e69 7429 202b 2027 5f27 202b 2073  eunit) + '_' + s
+0005f170: 7472 286f 2e66 696c 656e 616d 6529 290d  tr(o.filename)).
+0005f180: 0a09 0909 0909 0909 0966 6f72 2061 2069  .........for a i
+0005f190: 6e20 6861 6e64 6c65 735b 2d6c 656e 2872  n handles[-len(r
+0005f1a0: 656c 5f74 696d 6529 3a5d 3a0d 0a09 0909  el_time):]:.....
+0005f1b0: 0909 0909 0909 6861 6e2e 6170 7065 6e64  ......han.append
+0005f1c0: 2861 290d 0a09 0909 0909 0909 6e6f 726d  (a).........norm
+0005f1d0: 5f66 6169 6c65 6420 3d20 4661 6c73 650d  _failed = False.
+0005f1e0: 0a09 0909 0909 0965 7863 6570 743a 0d0a  .......except:..
+0005f1f0: 0909 0909 0909 0970 7269 6e74 2827 7363  .......print('sc
+0005f200: 616c 696e 6720 4661 696c 6564 2127 290d  aling Failed!').
+0005f210: 0a09 0909 0909 0909 6e6f 726d 5f66 6169  ........norm_fai
+0005f220: 6c65 6420 3d20 5472 7565 0d0a 0909 0909  led = True......
+0005f230: 0965 6c73 653a 206e 6f72 6d5f 6661 696c  .else: norm_fail
+0005f240: 6564 3d54 7275 6509 0d0a 0909 0909 0969  ed=True........i
+0005f250: 6620 6e6f 726d 5f66 6169 6c65 643a 0d0a  f norm_failed:..
+0005f260: 0909 0909 0909 6178 3d70 6c6f 745f 7469  ......ax=plot_ti
+0005f270: 6d65 2872 655b 2741 4327 5d2c 2063 6d61  me(re['AC'], cma
+0005f280: 7020 3d20 636f 6c6f 7273 2c20 6178 203d  p = colors, ax =
+0005f290: 2061 782c 2072 656c 5f74 696d 6520 3d20   ax, rel_time = 
+0005f2a0: 7265 6c5f 7469 6d65 2c20 0d0a 0909 0909  rel_time, ......
+0005f2b0: 0909 0909 0909 7469 6d65 5f77 6964 7468  ......time_width
+0005f2c0: 5f70 6572 6365 6e74 203d 2074 696d 655f  _percent = time_
+0005f2d0: 7769 6474 685f 7065 7263 656e 742c 2074  width_percent, t
+0005f2e0: 6974 6c65 203d 2027 272c 206c 696e 6573  itle = '', lines
+0005f2f0: 5f61 7265 203d 2027 6669 7474 6564 272c  _are = 'fitted',
+0005f300: 200d 0a09 0909 0909 0909 0909 0973 7562   ............sub
+0005f310: 706c 6f74 203d 2054 7275 652c 2063 6f6c  plot = True, col
+0005f320: 6f72 5f6f 6666 7365 7420 3d20 6c65 6e28  or_offset = len(
+0005f330: 7265 6c5f 7469 6d65 292a 2869 2b31 292c  rel_time)*(i+1),
+0005f340: 206c 696e 6577 6964 7468 203d 206c 696e   linewidth = lin
+0005f350: 6577 6964 7468 2c20 7363 6174 7465 7263  ewidth, scatterc
+0005f360: 7574 203d 206f 2e73 6361 7474 6572 6375  ut = o.scattercu
+0005f370: 7429 0d0a 0909 0909 0909 6861 6e64 6c65  t)........handle
+0005f380: 732c 206c 6162 656c 733d 6178 2e67 6574  s, labels=ax.get
+0005f390: 5f6c 6567 656e 645f 6861 6e64 6c65 735f  _legend_handles_
+0005f3a0: 6c61 6265 6c73 2829 0d0a 0909 0909 0909  labels()........
+0005f3b0: 666f 7220 656e 7420 696e 2072 656c 5f74  for ent in rel_t
+0005f3c0: 696d 653a 0d0a 0909 0909 0909 096c 6162  ime:.........lab
+0005f3d0: 2e61 7070 656e 6428 2725 6720 2573 2066  .append('%g %s f
+0005f3e0: 6974 2725 2865 6e74 2c6f 2e62 6173 6575  it'%(ent,o.baseu
+0005f3f0: 6e69 7429 202b 2027 5f27 202b 2073 7472  nit) + '_' + str
+0005f400: 286f 2e66 696c 656e 616d 6529 290d 0a09  (o.filename))...
+0005f410: 0909 0909 0966 6f72 2061 2069 6e20 6861  .....for a in ha
+0005f420: 6e64 6c65 735b 2d6c 656e 2872 656c 5f74  ndles[-len(rel_t
+0005f430: 696d 6529 3a5d 3a0d 0a09 0909 0909 0909  ime):]:.........
+0005f440: 6861 6e2e 6170 7065 6e64 2861 290d 0a09  han.append(a)...
+0005f450: 0909 0909 090d 0a09 0909 0909 0969 6620  .............if 
+0005f460: 6461 7461 5f61 6e64 5f66 6974 3a0d 0a09  data_and_fit:...
+0005f470: 0909 0909 0909 6178 3d70 6c6f 745f 7469  ......ax=plot_ti
+0005f480: 6d65 2872 655b 2741 275d 2c20 636d 6170  me(re['A'], cmap
+0005f490: 203d 2073 656c 662e 636d 6170 2c20 6178   = self.cmap, ax
+0005f4a0: 203d 2061 782c 2072 656c 5f74 696d 6520   = ax, rel_time 
+0005f4b0: 3d20 7265 6c5f 7469 6d65 2c20 0d0a 0909  = rel_time, ....
+0005f4c0: 0909 0909 0909 0909 7469 6d65 5f77 6964  ........time_wid
+0005f4d0: 7468 5f70 6572 6365 6e74 203d 2074 696d  th_percent = tim
+0005f4e0: 655f 7769 6474 685f 7065 7263 656e 742c  e_width_percent,
+0005f4f0: 2074 6974 6c65 203d 206f 2e66 696c 656e   title = o.filen
+0005f500: 616d 652c 200d 0a09 0909 0909 0909 0909  ame, ...........
+0005f510: 0962 6173 6575 6e69 7420 3d20 7365 6c66  .baseunit = self
+0005f520: 2e62 6173 6575 6e69 742c 206c 696e 6573  .baseunit, lines
+0005f530: 5f61 7265 203d 2027 6461 7461 272c 2073  _are = 'data', s
+0005f540: 7562 706c 6f74 203d 2054 7275 652c 200d  ubplot = True, .
+0005f550: 0a09 0909 0909 0909 0909 0963 6f6c 6f72  ...........color
+0005f560: 5f6f 6666 7365 7420 3d20 6c65 6e28 7265  _offset = len(re
+0005f570: 6c5f 7469 6d65 292a 2869 2b31 292c 206c  l_time)*(i+1), l
+0005f580: 696e 6577 6964 7468 203d 206c 696e 6577  inewidth = linew
+0005f590: 6964 7468 2c20 7363 6174 7465 7263 7574  idth, scattercut
+0005f5a0: 203d 206f 2e73 6361 7474 6572 6375 7429   = o.scattercut)
+0005f5b0: 0d0a 0909 0909 0909 0968 616e 646c 6573  .........handles
+0005f5c0: 2c20 6c61 6265 6c73 3d61 782e 6765 745f  , labels=ax.get_
+0005f5d0: 6c65 6765 6e64 5f68 616e 646c 6573 5f6c  legend_handles_l
+0005f5e0: 6162 656c 7328 290d 0a09 0909 0909 0909  abels().........
+0005f5f0: 666f 7220 656e 7420 696e 2072 656c 5f74  for ent in rel_t
+0005f600: 696d 653a 0d0a 0909 0909 0909 0909 6c61  ime:..........la
+0005f610: 622e 6170 7065 6e64 2827 2567 2025 7327  b.append('%g %s'
+0005f620: 2528 656e 742c 6f2e 6261 7365 756e 6974  %(ent,o.baseunit
+0005f630: 2920 2b20 275f 2720 2b20 7374 7228 6f2e  ) + '_' + str(o.
+0005f640: 6669 6c65 6e61 6d65 2929 0d0a 0909 0909  filename))......
+0005f650: 0909 0966 6f72 2061 2069 6e20 6861 6e64  ...for a in hand
+0005f660: 6c65 735b 2d6c 656e 2872 656c 5f74 696d  les[-len(rel_tim
+0005f670: 6529 3a5d 3a0d 0a09 0909 0909 0909 0968  e):]:..........h
+0005f680: 616e 2e61 7070 656e 6428 6129 0d0a 0909  an.append(a)....
+0005f690: 0969 6620 6e6f 7420 6e6f 726d 5f66 6169  .if not norm_fai
+0005f6a0: 6c65 643a 0d0a 0909 0909 6178 2e73 6574  led:......ax.set
+0005f6b0: 5f74 6974 6c65 2827 636f 6d70 6172 6520  _title('compare 
+0005f6c0: 6d65 6173 7572 6564 2061 6e64 2066 6974  measured and fit
+0005f6d0: 7465 6420 6461 7461 2061 7420 6769 7665  ted data at give
+0005f6e0: 6e20 7469 6d65 735c 6e20 7363 616c 6564  n times\n scaled
+0005f6f0: 2074 6f20 743d 2567 2070 7320 3a20 2567   to t=%g ps : %g
+0005f700: 2070 7320 2c20 776c 3d20 2567 206e 6d3a   ps , wl= %g nm:
+0005f710: 2025 6720 6e6d 2725 286e 6f72 6d5f 7769   %g nm'%(norm_wi
+0005f720: 6e64 6f77 5b30 5d2c 6e6f 726d 5f77 696e  ndow[0],norm_win
+0005f730: 646f 775b 315d 2c6e 6f72 6d5f 7769 6e64  dow[1],norm_wind
+0005f740: 6f77 5b32 5d2c 6e6f 726d 5f77 696e 646f  ow[2],norm_windo
+0005f750: 775b 335d 2929 0d0a 0909 0965 6c73 653a  w[3])).....else:
+0005f760: 0d0a 0909 0909 6178 2e73 6574 5f74 6974  ......ax.set_tit
+0005f770: 6c65 2827 636f 6d70 6172 6520 6d65 6173  le('compare meas
+0005f780: 7572 6564 2061 6e64 2066 6974 7465 6420  ured and fitted 
+0005f790: 6461 7461 2061 7420 6769 7665 6e20 7469  data at given ti
+0005f7a0: 6d65 7327 290d 0a09 0909 6178 2e73 6574  mes').....ax.set
+0005f7b0: 5f78 6c69 6d28 7265 5b27 4127 5d2e 636f  _xlim(re['A'].co
+0005f7c0: 6c75 6d6e 732e 7661 6c75 6573 5b30 5d2c  lumns.values[0],
+0005f7d0: 7265 5b27 4127 5d2e 636f 6c75 6d6e 732e  re['A'].columns.
+0005f7e0: 7661 6c75 6573 5b2d 315d 290d 0a09 0909  values[-1]).....
+0005f7f0: 6178 2e6c 6567 656e 6428 6861 6e2c 206c  ax.legend(han, l
+0005f800: 6162 202c 6c61 6265 6c73 7061 6369 6e67  ab ,labelspacing
+0005f810: 203d 2030 2c20 6e63 6f6c 203d 2032 2c20   = 0, ncol = 2, 
+0005f820: 636f 6c75 6d6e 7370 6163 696e 6720 3d20  columnspacing = 
+0005f830: 312c 2068 616e 646c 656c 656e 6774 6820  1, handlelength 
+0005f840: 3d20 312c 2066 7261 6d65 6f6e 203d 2046  = 1, frameon = F
+0005f850: 616c 7365 290d 0a09 0965 6c73 653a 0d0a  alse)....else:..
+0005f860: 0909 0969 6620 6e6f 726d 5f77 696e 646f  ...if norm_windo
+0005f870: 7720 6973 206e 6f74 204e 6f6e 653a 0d0a  w is not None:..
+0005f880: 0909 0909 7265 665f 7363 616c 653d 7365  ....ref_scale=se
+0005f890: 6c66 2e64 732e 6c6f 635b 6e6f 726d 5f77  lf.ds.loc[norm_w
+0005f8a0: 696e 646f 775b 305d 3a6e 6f72 6d5f 7769  indow[0]:norm_wi
+0005f8b0: 6e64 6f77 5b31 5d2c 6e6f 726d 5f77 696e  ndow[1],norm_win
+0005f8c0: 646f 775b 325d 3a6e 6f72 6d5f 7769 6e64  dow[2]:norm_wind
+0005f8d0: 6f77 5b33 5d5d 2e6d 6561 6e28 292e 6d65  ow[3]].mean().me
+0005f8e0: 616e 2829 0d0a 0909 096f 626a 6563 7473  an().....objects
+0005f8f0: 3d6c 656e 2872 656c 5f74 696d 6529 2a28  =len(rel_time)*(
+0005f900: 312b 6c65 6e28 6f74 6865 7229 290d 0a09  1+len(other))...
+0005f910: 0909 636f 6c6f 7273 3d63 6f6c 6d28 636d  ..colors=colm(cm
+0005f920: 6170 3d63 6d61 702c 6b3d 7261 6e67 6528  ap=cmap,k=range(
+0005f930: 6f62 6a65 6374 7329 290d 0a09 0909 6669  objects)).....fi
+0005f940: 672c 6178 3d70 6c74 2e73 7562 706c 6f74  g,ax=plt.subplot
+0005f950: 7328 6669 6773 697a 653d 2831 302c 3629  s(figsize=(10,6)
+0005f960: 2c64 7069 3d31 3030 290d 0a09 0909 5f3d  ,dpi=100)....._=
+0005f970: 706c 6f74 5f74 696d 6528 7365 6c66 2e64  plot_time(self.d
+0005f980: 732c 2061 7820 3d20 6178 2c20 7265 6c5f  s, ax = ax, rel_
+0005f990: 7469 6d65 203d 2072 656c 5f74 696d 652c  time = rel_time,
+0005f9a0: 2074 696d 655f 7769 6474 685f 7065 7263   time_width_perc
+0005f9b0: 656e 7420 3d20 7469 6d65 5f77 6964 7468  ent = time_width
+0005f9c0: 5f70 6572 6365 6e74 2c20 0d0a 0909 0909  _percent, ......
+0005f9d0: 0909 7469 746c 6520 3d20 7469 746c 652c  ..title = title,
+0005f9e0: 206c 696e 6573 5f61 7265 203d 2027 6461   lines_are = 'da
+0005f9f0: 7461 272c 2073 6361 7474 6572 6375 7420  ta', scattercut 
+0005fa00: 3d20 7365 6c66 2e73 6361 7474 6572 6375  = self.scattercu
+0005fa10: 742c 2062 6f72 6465 7263 7574 203d 2073  t, bordercut = s
+0005fa20: 656c 662e 626f 7264 6572 6375 742c 200d  elf.bordercut, .
+0005fa30: 0a09 0909 0909 0977 6176 655f 6e6d 5f62  .......wave_nm_b
+0005fa40: 696e 203d 2073 656c 662e 7761 7665 5f6e  in = self.wave_n
+0005fa50: 6d5f 6269 6e2c 2063 6d61 7020 3d20 636f  m_bin, cmap = co
+0005fa60: 6c6f 7273 2c20 7375 6270 6c6f 7420 3d20  lors, subplot = 
+0005fa70: 5472 7565 2c20 6c69 6e65 7769 6474 6820  True, linewidth 
+0005fa80: 3d20 6c69 6e65 7769 6474 682c 2062 6173  = linewidth, bas
+0005fa90: 6575 6e69 743d 7365 6c66 2e62 6173 6575  eunit=self.baseu
+0005faa0: 6e69 7429 0d0a 0909 0969 6620 313a 0d0a  nit).....if 1:..
+0005fab0: 0909 0909 5f3d 706c 6f74 5f74 696d 6528  ...._=plot_time(
+0005fac0: 7365 6c66 2e64 732c 2061 7820 3d20 6178  self.ds, ax = ax
+0005fad0: 2c20 7265 6c5f 7469 6d65 203d 2072 656c  , rel_time = rel
+0005fae0: 5f74 696d 652c 2074 696d 655f 7769 6474  _time, time_widt
+0005faf0: 685f 7065 7263 656e 7420 3d20 7469 6d65  h_percent = time
+0005fb00: 5f77 6964 7468 5f70 6572 6365 6e74 2c20  _width_percent, 
+0005fb10: 0d0a 0909 0909 0909 0974 6974 6c65 203d  .........title =
+0005fb20: 2074 6974 6c65 2c20 6c69 6e65 735f 6172   title, lines_ar
+0005fb30: 6520 3d20 2773 6d6f 6f74 6865 6427 2c20  e = 'smoothed', 
+0005fb40: 7363 6174 7465 7263 7574 203d 2073 656c  scattercut = sel
+0005fb50: 662e 7363 6174 7465 7263 7574 2c20 626f  f.scattercut, bo
+0005fb60: 7264 6572 6375 7420 3d20 7365 6c66 2e62  rdercut = self.b
+0005fb70: 6f72 6465 7263 7574 2c77 6176 655f 6e6d  ordercut,wave_nm
+0005fb80: 5f62 696e 203d 2073 656c 662e 7761 7665  _bin = self.wave
+0005fb90: 5f6e 6d5f 6269 6e2c 2063 6d61 7020 3d20  _nm_bin, cmap = 
+0005fba0: 636f 6c6f 7273 2c20 7375 6270 6c6f 7420  colors, subplot 
+0005fbb0: 3d20 4661 6c73 652c 206c 696e 6577 6964  = False, linewid
+0005fbc0: 7468 203d 206c 696e 6577 6964 7468 2c20  th = linewidth, 
+0005fbd0: 6261 7365 756e 6974 203d 2073 656c 662e  baseunit = self.
+0005fbe0: 6261 7365 756e 6974 290d 0a09 0909 6861  baseunit).....ha
+0005fbf0: 6e64 6c65 732c 206c 6162 656c 733d 6178  ndles, labels=ax
+0005fc00: 2e67 6574 5f6c 6567 656e 645f 6861 6e64  .get_legend_hand
+0005fc10: 6c65 735f 6c61 6265 6c73 2829 0d0a 0909  les_labels()....
+0005fc20: 096c 6162 3d5b 2725 6720 2573 2725 2865  .lab=['%g %s'%(e
+0005fc30: 6e74 2c73 656c 662e 6261 7365 756e 6974  nt,self.baseunit
+0005fc40: 2920 2b20 275f 2720 2b20 7374 7228 7365  ) + '_' + str(se
+0005fc50: 6c66 2e66 696c 656e 616d 6529 2066 6f72  lf.filename) for
+0005fc60: 2065 6e74 2069 6e20 7265 6c5f 7469 6d65   ent in rel_time
+0005fc70: 5d0d 0a09 0909 6861 6e3d 6861 6e64 6c65  ].....han=handle
+0005fc80: 735b 3a6c 656e 2872 656c 5f74 696d 6529  s[:len(rel_time)
+0005fc90: 5d0d 0a09 0909 6966 206f 7468 6572 2069  ].....if other i
+0005fca0: 7320 6e6f 7420 4e6f 6e65 3a0d 0a09 0909  s not None:.....
+0005fcb0: 0966 6f72 2069 2c6f 2069 6e20 656e 756d  .for i,o in enum
+0005fcc0: 6572 6174 6528 6f74 6865 7229 3a0d 0a09  erate(other):...
+0005fcd0: 0909 0909 6966 206e 6f72 6d5f 7769 6e64  ....if norm_wind
+0005fce0: 6f77 2069 7320 6e6f 7420 4e6f 6e65 3a0d  ow is not None:.
+0005fcf0: 0a09 0909 0909 0972 656c 5f73 6361 6c65  .......rel_scale
+0005fd00: 3d6f 2e64 732e 6c6f 635b 6e6f 726d 5f77  =o.ds.loc[norm_w
+0005fd10: 696e 646f 775b 305d 3a6e 6f72 6d5f 7769  indow[0]:norm_wi
+0005fd20: 6e64 6f77 5b31 5d2c 6e6f 726d 5f77 696e  ndow[1],norm_win
+0005fd30: 646f 775b 325d 3a6e 6f72 6d5f 7769 6e64  dow[2]:norm_wind
+0005fd40: 6f77 5b33 5d5d 2e6d 6561 6e28 292e 6d65  ow[3]].mean().me
+0005fd50: 616e 2829 0d0a 0909 0909 0909 7472 793a  an()........try:
+0005fd60: 0d0a 0909 0909 0909 0973 6361 6c69 6e67  .........scaling
+0005fd70: 203d 2028 7265 6c5f 7363 616c 652f 7265   = (rel_scale/re
+0005fd80: 665f 7363 616c 6529 0d0a 0909 0909 0909  f_scale)........
+0005fd90: 0961 783d 706c 6f74 5f74 696d 6528 6f2e  .ax=plot_time(o.
+0005fda0: 6473 2f73 6361 6c69 6e67 2c20 636d 6170  ds/scaling, cmap
+0005fdb0: 203d 2063 6f6c 6f72 732c 2061 7820 3d20   = colors, ax = 
+0005fdc0: 6178 2c20 7265 6c5f 7469 6d65 203d 2072  ax, rel_time = r
+0005fdd0: 656c 5f74 696d 652c 200d 0a09 0909 0909  el_time, .......
+0005fde0: 0909 0909 0974 696d 655f 7769 6474 685f  .....time_width_
+0005fdf0: 7065 7263 656e 7420 3d20 7469 6d65 5f77  percent = time_w
+0005fe00: 6964 7468 5f70 6572 6365 6e74 2c20 7469  idth_percent, ti
+0005fe10: 746c 6520 3d20 7469 746c 652c 206c 696e  tle = title, lin
+0005fe20: 6573 5f61 7265 203d 2027 6461 7461 272c  es_are = 'data',
+0005fe30: 200d 0a09 0909 0909 0909 0909 0973 6361   ............sca
+0005fe40: 7474 6572 6375 7420 3d20 6f2e 7363 6174  ttercut = o.scat
+0005fe50: 7465 7263 7574 2c20 626f 7264 6572 6375  tercut, bordercu
+0005fe60: 7420 3d20 6f2e 626f 7264 6572 6375 742c  t = o.bordercut,
+0005fe70: 206c 696e 6577 6964 7468 203d 206c 696e   linewidth = lin
+0005fe80: 6577 6964 7468 2c20 0d0a 0909 0909 0909  ewidth, ........
+0005fe90: 0909 0909 7761 7665 5f6e 6d5f 6269 6e20  ....wave_nm_bin 
+0005fea0: 3d20 6f2e 7761 7665 5f6e 6d5f 6269 6e2c  = o.wave_nm_bin,
+0005feb0: 2073 7562 706c 6f74 203d 2054 7275 652c   subplot = True,
+0005fec0: 2063 6f6c 6f72 5f6f 6666 7365 7420 3d20   color_offset = 
+0005fed0: 6c65 6e28 7265 6c5f 7469 6d65 292a 2869  len(rel_time)*(i
+0005fee0: 2b31 2929 0d0a 0909 0909 0909 0968 616e  +1)).........han
+0005fef0: 646c 6573 2c20 6c61 6265 6c73 3d61 782e  dles, labels=ax.
+0005ff00: 6765 745f 6c65 6765 6e64 5f68 616e 646c  get_legend_handl
+0005ff10: 6573 5f6c 6162 656c 7328 290d 0a09 0909  es_labels().....
+0005ff20: 0909 0909 666f 7220 656e 7420 696e 2072  ....for ent in r
+0005ff30: 656c 5f74 696d 653a 0d0a 0909 0909 0909  el_time:........
+0005ff40: 0909 6c61 622e 6170 7065 6e64 2827 2567  ..lab.append('%g
+0005ff50: 2025 7327 2528 656e 742c 6f2e 6261 7365   %s'%(ent,o.base
+0005ff60: 756e 6974 2920 2b20 275f 2720 2b20 7374  unit) + '_' + st
+0005ff70: 7228 6f2e 6669 6c65 6e61 6d65 2929 0d0a  r(o.filename))..
+0005ff80: 0909 0909 0909 0966 6f72 2061 2069 6e20  .......for a in 
+0005ff90: 6861 6e64 6c65 735b 2d6c 656e 2872 656c  handles[-len(rel
+0005ffa0: 5f74 696d 6529 3a5d 3a0d 0a09 0909 0909  _time):]:.......
+0005ffb0: 0909 0968 616e 2e61 7070 656e 6428 6129  ...han.append(a)
+0005ffc0: 0d0a 0d0a 0909 0909 0909 0969 6620 6461  ...........if da
+0005ffd0: 7461 5f61 6e64 5f66 6974 3a0d 0a09 0909  ta_and_fit:.....
+0005ffe0: 0909 0909 0961 783d 706c 6f74 5f74 696d  .....ax=plot_tim
+0005fff0: 6528 6f2e 6473 2f73 6361 6c69 6e67 2c20  e(o.ds/scaling, 
+00060000: 636d 6170 203d 2063 6f6c 6f72 732c 2061  cmap = colors, a
+00060010: 7820 3d20 6178 2c20 7265 6c5f 7469 6d65  x = ax, rel_time
+00060020: 203d 2072 656c 5f74 696d 652c 200d 0a09   = rel_time, ...
+00060030: 0909 0909 0909 0909 0974 696d 655f 7769  .........time_wi
+00060040: 6474 685f 7065 7263 656e 7420 3d20 7469  dth_percent = ti
+00060050: 6d65 5f77 6964 7468 5f70 6572 6365 6e74  me_width_percent
+00060060: 2c20 7469 746c 6520 3d20 7469 746c 652c  , title = title,
+00060070: 206c 696e 6573 5f61 7265 203d 2027 736d   lines_are = 'sm
+00060080: 6f6f 7468 6564 272c 200d 0a09 0909 0909  oothed', .......
+00060090: 0909 0909 0973 6361 7474 6572 6375 7420  .....scattercut 
+000600a0: 3d20 6f2e 7363 6174 7465 7263 7574 2c20  = o.scattercut, 
+000600b0: 626f 7264 6572 6375 7420 3d20 6f2e 626f  bordercut = o.bo
+000600c0: 7264 6572 6375 742c 206c 696e 6577 6964  rdercut, linewid
+000600d0: 7468 203d 206c 696e 6577 6964 7468 2c20  th = linewidth, 
+000600e0: 0d0a 0909 0909 0909 0909 0909 7761 7665  ............wave
+000600f0: 5f6e 6d5f 6269 6e20 3d20 6f2e 7761 7665  _nm_bin = o.wave
+00060100: 5f6e 6d5f 6269 6e2c 2073 7562 706c 6f74  _nm_bin, subplot
+00060110: 203d 2054 7275 652c 2063 6f6c 6f72 5f6f   = True, color_o
+00060120: 6666 7365 7420 3d20 6c65 6e28 7265 6c5f  ffset = len(rel_
+00060130: 7469 6d65 292a 2869 2b31 2929 0d0a 0909  time)*(i+1))....
+00060140: 0909 0909 0973 6361 6c69 6e67 5f66 6169  .....scaling_fai
+00060150: 6c65 643d 4661 6c73 650d 0a09 0909 0909  led=False.......
+00060160: 0965 7863 6570 743a 0d0a 0909 0909 0909  .except:........
+00060170: 0970 7269 6e74 2827 7363 616c 696e 6720  .print('scaling 
+00060180: 4661 696c 6564 2127 290d 0a09 0909 0909  Failed!').......
+00060190: 0909 7363 616c 696e 675f 6661 696c 6564  ..scaling_failed
+000601a0: 3d54 7275 650d 0a09 0909 0909 656c 7365  =True.......else
+000601b0: 3a0d 0a09 0909 0909 0973 6361 6c69 6e67  :........scaling
+000601c0: 5f66 6169 6c65 643d 5472 7565 0d0a 0909  _failed=True....
+000601d0: 0909 0969 6620 7363 616c 696e 675f 6661  ...if scaling_fa
+000601e0: 696c 6564 3a0d 0a09 0909 0909 0961 783d  iled:........ax=
+000601f0: 706c 6f74 5f74 696d 6528 6f2e 6473 2c20  plot_time(o.ds, 
+00060200: 636d 6170 203d 2063 6f6c 6f72 732c 2061  cmap = colors, a
+00060210: 7820 3d20 6178 2c20 7265 6c5f 7469 6d65  x = ax, rel_time
+00060220: 203d 2072 656c 5f74 696d 652c 200d 0a09   = rel_time, ...
+00060230: 0909 0909 0909 0909 7469 6d65 5f77 6964  ........time_wid
+00060240: 7468 5f70 6572 6365 6e74 203d 2074 696d  th_percent = tim
+00060250: 655f 7769 6474 685f 7065 7263 656e 742c  e_width_percent,
+00060260: 2074 6974 6c65 203d 2074 6974 6c65 2c20   title = title, 
+00060270: 6c69 6e65 735f 6172 6520 3d20 2764 6174  lines_are = 'dat
+00060280: 6127 2c20 0d0a 0909 0909 0909 0909 0973  a', ...........s
+00060290: 6361 7474 6572 6375 7420 3d20 6f2e 7363  cattercut = o.sc
+000602a0: 6174 7465 7263 7574 2c20 626f 7264 6572  attercut, border
+000602b0: 6375 7420 3d20 6f2e 626f 7264 6572 6375  cut = o.bordercu
+000602c0: 742c 206c 696e 6577 6964 7468 203d 206c  t, linewidth = l
+000602d0: 696e 6577 6964 7468 2c20 0d0a 0909 0909  inewidth, ......
+000602e0: 0909 0909 0977 6176 655f 6e6d 5f62 696e  .....wave_nm_bin
+000602f0: 203d 206f 2e77 6176 655f 6e6d 5f62 696e   = o.wave_nm_bin
+00060300: 2c20 7375 6270 6c6f 7420 3d20 5472 7565  , subplot = True
+00060310: 2c20 636f 6c6f 725f 6f66 6673 6574 203d  , color_offset =
+00060320: 206c 656e 2872 656c 5f74 696d 6529 2a28   len(rel_time)*(
+00060330: 692b 3129 290d 0a09 0909 0909 0968 616e  i+1))........han
+00060340: 646c 6573 2c20 6c61 6265 6c73 3d61 782e  dles, labels=ax.
+00060350: 6765 745f 6c65 6765 6e64 5f68 616e 646c  get_legend_handl
+00060360: 6573 5f6c 6162 656c 7328 290d 0a09 0909  es_labels().....
+00060370: 0909 0966 6f72 2065 6e74 2069 6e20 7265  ...for ent in re
+00060380: 6c5f 7469 6d65 3a0d 0a09 0909 0909 0909  l_time:.........
+00060390: 6c61 622e 6170 7065 6e64 2827 2567 2025  lab.append('%g %
+000603a0: 7327 2528 656e 742c 6f2e 6261 7365 756e  s'%(ent,o.baseun
+000603b0: 6974 2920 2b20 275f 2720 2b20 7374 7228  it) + '_' + str(
+000603c0: 6f2e 6669 6c65 6e61 6d65 2929 0d0a 0909  o.filename))....
+000603d0: 0909 0909 666f 7220 6120 696e 2068 616e  ....for a in han
+000603e0: 646c 6573 5b2d 6c65 6e28 7265 6c5f 7469  dles[-len(rel_ti
+000603f0: 6d65 293a 5d3a 0d0a 0909 0909 0909 0968  me):]:.........h
+00060400: 616e 2e61 7070 656e 6428 6129 0d0a 0909  an.append(a)....
+00060410: 0909 0909 6966 2064 6174 615f 616e 645f  ....if data_and_
+00060420: 6669 743a 0d0a 0909 0909 0909 0961 783d  fit:.........ax=
+00060430: 706c 6f74 5f74 696d 6528 6f2e 6473 2c20  plot_time(o.ds, 
+00060440: 636d 6170 203d 2063 6f6c 6f72 732c 2061  cmap = colors, a
+00060450: 7820 3d20 6178 2c20 7265 6c5f 7469 6d65  x = ax, rel_time
+00060460: 203d 2072 656c 5f74 696d 652c 200d 0a09   = rel_time, ...
+00060470: 0909 0909 0909 0909 7469 6d65 5f77 6964  ........time_wid
+00060480: 7468 5f70 6572 6365 6e74 203d 2074 696d  th_percent = tim
+00060490: 655f 7769 6474 685f 7065 7263 656e 742c  e_width_percent,
+000604a0: 2074 6974 6c65 203d 2074 6974 6c65 2c20   title = title, 
+000604b0: 6c69 6e65 735f 6172 6520 3d20 2773 6d6f  lines_are = 'smo
+000604c0: 6f74 6865 6427 2c20 0d0a 0909 0909 0909  othed', ........
+000604d0: 0909 0973 6361 7474 6572 6375 7420 3d20  ...scattercut = 
+000604e0: 6f2e 7363 6174 7465 7263 7574 2c20 626f  o.scattercut, bo
+000604f0: 7264 6572 6375 7420 3d20 6f2e 626f 7264  rdercut = o.bord
+00060500: 6572 6375 742c 206c 696e 6577 6964 7468  ercut, linewidth
+00060510: 203d 206c 696e 6577 6964 7468 2c20 0d0a   = linewidth, ..
+00060520: 0909 0909 0909 0909 0977 6176 655f 6e6d  .........wave_nm
+00060530: 5f62 696e 203d 206f 2e77 6176 655f 6e6d  _bin = o.wave_nm
+00060540: 5f62 696e 2c20 7375 6270 6c6f 7420 3d20  _bin, subplot = 
+00060550: 5472 7565 2c20 636f 6c6f 725f 6f66 6673  True, color_offs
+00060560: 6574 203d 206c 656e 2872 656c 5f74 696d  et = len(rel_tim
+00060570: 6529 2a28 692b 3129 290d 0a09 0909 0909  e)*(i+1)).......
+00060580: 0909 0909 0d0a 0909 0969 6620 6e6f 7420  .........if not 
+00060590: 7363 616c 696e 675f 6661 696c 6564 3a0d  scaling_failed:.
+000605a0: 0a09 0909 0961 782e 7365 745f 7469 746c  .....ax.set_titl
+000605b0: 6528 2763 6f6d 7061 7265 206d 6561 7375  e('compare measu
+000605c0: 7265 6420 616e 6420 736d 6f6f 7468 6564  red and smoothed
+000605d0: 2064 6174 6120 6174 2067 6976 656e 2074   data at given t
+000605e0: 696d 6573 5c6e 2073 6361 6c65 6420 746f  imes\n scaled to
+000605f0: 2074 3d25 6720 7073 203a 2025 6720 7073   t=%g ps : %g ps
+00060600: 202c 2077 6c3d 2025 6720 6e6d 3a20 2567   , wl= %g nm: %g
+00060610: 206e 6d27 2528 6e6f 726d 5f77 696e 646f   nm'%(norm_windo
+00060620: 775b 305d 2c6e 6f72 6d5f 7769 6e64 6f77  w[0],norm_window
+00060630: 5b31 5d2c 6e6f 726d 5f77 696e 646f 775b  [1],norm_window[
+00060640: 325d 2c6e 6f72 6d5f 7769 6e64 6f77 5b33  2],norm_window[3
+00060650: 5d29 290d 0a09 0909 656c 7365 3a0d 0a09  ])).....else:...
+00060660: 0909 0961 782e 7365 745f 7469 746c 6528  ...ax.set_title(
+00060670: 2763 6f6d 7061 7265 206d 6561 7375 7265  'compare measure
+00060680: 6420 616e 6420 736d 6f6f 7468 6564 2064  d and smoothed d
+00060690: 6174 6120 6174 2067 6976 656e 2074 696d  ata at given tim
+000606a0: 6573 2729 0d0a 0909 0961 782e 6c65 6765  es').....ax.lege
+000606b0: 6e64 2868 616e 2c20 6c61 622c 206c 6162  nd(han, lab, lab
+000606c0: 656c 7370 6163 696e 6720 3d20 302c 206e  elspacing = 0, n
+000606d0: 636f 6c20 3d20 322c 2063 6f6c 756d 6e73  col = 2, columns
+000606e0: 7061 6369 6e67 203d 2031 2c20 6861 6e64  pacing = 1, hand
+000606f0: 6c65 6c65 6e67 7468 203d 2031 2c20 6672  lelength = 1, fr
+00060700: 616d 656f 6e20 3d20 4661 6c73 6529 0d0a  ameon = False)..
+00060710: 0909 0969 6620 7365 6c66 2e62 6f72 6465  ...if self.borde
+00060720: 7263 7574 2069 7320 4e6f 6e65 3a0d 0a09  rcut is None:...
+00060730: 0909 0961 782e 7365 745f 786c 696d 2873  ...ax.set_xlim(s
+00060740: 656c 662e 6473 2e63 6f6c 756d 6e73 2e76  elf.ds.columns.v
+00060750: 616c 7565 735b 305d 2c73 656c 662e 6473  alues[0],self.ds
+00060760: 2e63 6f6c 756d 6e73 2e76 616c 7565 735b  .columns.values[
+00060770: 2d31 5d29 0d0a 0909 0965 6c73 653a 0d0a  -1]).....else:..
+00060780: 0909 0909 6178 2e73 6574 5f78 6c69 6d28  ....ax.set_xlim(
+00060790: 7365 6c66 2e62 6f72 6465 7263 7574 290d  self.bordercut).
+000607a0: 0a09 0969 6620 7370 6563 7472 6120 6973  ...if spectra is
+000607b0: 206e 6f74 204e 6f6e 653a 0d0a 0909 0973   not None:.....s
+000607c0: 7065 6374 7261 2e70 6c6f 7428 6178 3d61  pectra.plot(ax=a
+000607d0: 782c 6c65 6765 6e64 3d46 616c 7365 290d  x,legend=False).
+000607e0: 0a09 0909 6861 6e64 6c65 732c 206c 6162  ....handles, lab
+000607f0: 656c 733d 6178 2e67 6574 5f6c 6567 656e  els=ax.get_legen
+00060800: 645f 6861 6e64 6c65 735f 6c61 6265 6c73  d_handles_labels
+00060810: 2829 0d0a 0909 0968 616e 2e61 7070 656e  ().....han.appen
+00060820: 6428 6861 6e64 6c65 735b 2d31 5d29 0d0a  d(handles[-1])..
+00060830: 0909 096c 6162 2e61 7070 656e 6428 6c61  ...lab.append(la
+00060840: 6265 6c73 5b2d 315d 290d 0a09 0909 6178  bels[-1]).....ax
+00060850: 2e6c 6567 656e 6428 6861 6e2c 206c 6162  .legend(han, lab
+00060860: 202c 6c61 6265 6c73 7061 6369 6e67 203d   ,labelspacing =
+00060870: 2030 2c20 6e63 6f6c 203d 2032 2c20 636f   0, ncol = 2, co
+00060880: 6c75 6d6e 7370 6163 696e 6720 3d20 312c  lumnspacing = 1,
+00060890: 2068 616e 646c 656c 656e 6774 6820 3d20   handlelength = 
+000608a0: 312c 2066 7261 6d65 6f6e 203d 2046 616c  1, frameon = Fal
+000608b0: 7365 290d 0a09 0969 6620 706c 6f74 5f73  se)....if plot_s
+000608c0: 6563 6f6e 645f 6173 5f65 6e65 7267 793a  econd_as_energy:
+000608d0: 0d0a 0909 0961 7832 3d61 782e 7477 696e  .....ax2=ax.twin
+000608e0: 7928 290d 0a09 0909 6178 322e 7365 745f  y().....ax2.set_
+000608f0: 786c 696d 2861 782e 6765 745f 786c 696d  xlim(ax.get_xlim
+00060900: 2829 290d 0a09 0909 6178 322e 7365 745f  ()).....ax2.set_
+00060910: 7874 6963 6b73 2861 782e 6765 745f 7874  xticks(ax.get_xt
+00060920: 6963 6b73 2829 290d 0a09 0909 6c61 6265  icks()).....labe
+00060930: 6c73 3d5b 2725 2e32 6627 2528 7363 6970  ls=['%.2f'%(scip
+00060940: 792e 636f 6e73 7461 6e74 732e 682a 7363  y.constants.h*sc
+00060950: 6970 792e 636f 6e73 7461 6e74 732e 632f  ipy.constants.c/
+00060960: 2861 2a31 652d 392a 7363 6970 792e 636f  (a*1e-9*scipy.co
+00060970: 6e73 7461 6e74 732e 656c 6563 7472 6f6e  nstants.electron
+00060980: 5f76 6f6c 7429 2920 666f 7220 6120 696e  _volt)) for a in
+00060990: 2061 7832 2e67 6574 5f78 7469 636b 7328   ax2.get_xticks(
+000609a0: 295d 0d0a 0909 095f 3d61 7832 2e73 6574  )]....._=ax2.set
+000609b0: 5f78 7469 636b 6c61 6265 6c73 286c 6162  _xticklabels(lab
+000609c0: 656c 7329 0d0a 0909 095f 3d61 7832 2e73  els)....._=ax2.s
+000609d0: 6574 5f78 6c61 6265 6c28 2745 6e65 7267  et_xlabel('Energ
+000609e0: 7920 696e 2065 5627 290d 0a09 0909 6178  y in eV').....ax
+000609f0: 2e73 6574 5f7a 6f72 6465 7228 6178 322e  .set_zorder(ax2.
+00060a00: 6765 745f 7a6f 7264 6572 2829 2b31 290d  get_zorder()+1).
+00060a10: 0a09 0966 6967 3d70 6c74 2e67 6366 2829  ...fig=plt.gcf()
+00060a20: 0d0a 0909 6669 672e 7469 6768 745f 6c61  ....fig.tight_la
+00060a30: 796f 7574 2829 0d0a 0909 6966 2073 656c  yout()....if sel
+00060a40: 662e 7361 7665 5f66 6967 7572 6573 5f74  f.save_figures_t
+00060a50: 6f5f 666f 6c64 6572 3a0d 0a09 0909 6669  o_folder:.....fi
+00060a60: 672e 7361 7665 6669 6728 6368 6563 6b5f  g.savefig(check_
+00060a70: 666f 6c64 6572 2870 6174 683d 7365 6c66  folder(path=self
+00060a80: 2e66 6967 7572 655f 7061 7468 2c66 696c  .figure_path,fil
+00060a90: 656e 616d 653d 2763 6f6d 7061 7265 5f61  ename='compare_a
+00060aa0: 745f 7469 6d65 5f25 732e 706e 6727 2527  t_time_%s.png'%'
+00060ab0: 5f27 2e6a 6f69 6e28 5b27 2567 2725 6120  _'.join(['%g'%a 
+00060ac0: 666f 7220 6120 696e 2072 656c 5f74 696d  for a in rel_tim
+00060ad0: 655d 2929 2c62 626f 785f 696e 6368 6573  e])),bbox_inches
+00060ae0: 3d27 7469 6768 7427 290d 0a09 0909 0909  ='tight').......
+00060af0: 0920 200d 0a0d 0a09 6465 6620 436f 6d70  .  .....def Comp
+00060b00: 6172 655f 6174 5f77 6176 6528 7365 6c66  are_at_wave(self
+00060b10: 2c20 7265 6c5f 7761 7665 203d 204e 6f6e  , rel_wave = Non
+00060b20: 652c 206f 7468 6572 203d 204e 6f6e 652c  e, other = None,
+00060b30: 2066 6974 7465 6420 3d20 4661 6c73 652c   fitted = False,
+00060b40: 206e 6f72 6d5f 7769 6e64 6f77 203d 204e   norm_window = N
+00060b50: 6f6e 652c 0d0a 0909 0909 0909 7769 6474  one,........widt
+00060b60: 6820 3d20 4e6f 6e65 2c20 636d 6170 203d  h = None, cmap =
+00060b70: 204e 6f6e 652c 2064 6174 615f 616e 645f   None, data_and_
+00060b80: 6669 7420 3d20 4661 6c73 652c 2073 6361  fit = False, sca
+00060b90: 6c65 5f74 7970 6520 3d20 2773 796d 6c6f  le_type = 'symlo
+00060ba0: 6727 2c20 6c69 6e65 7769 6474 6820 3d20  g', linewidth = 
+00060bb0: 3129 3a0d 0a09 0927 2727 5468 6973 2066  1):....'''This f
+00060bc0: 756e 6374 696f 6e20 706c 6f74 7320 6d75  unction plots mu
+00060bd0: 6c74 6970 6c65 206b 696e 6574 6963 7320  ltiple kinetics 
+00060be0: 696e 746f 2074 6865 2073 616d 6520 6669  into the same fi
+00060bf0: 6775 7265 2061 7420 6f6e 6520 6f72 0d0a  gure at one or..
+00060c00: 0909 6d75 6c74 6970 6c65 2067 6976 656e  ..multiple given
+00060c10: 2077 6176 656c 656e 6774 6820 2872 656c   wavelength (rel
+00060c20: 5f77 6176 6529 2061 6e64 2020 616c 6c6f  _wave) and  allo
+00060c30: 7773 2066 6f72 200d 0a09 093a 7265 663a  ws for ....:ref:
+00060c40: 604e 6f72 6d61 6c69 7a61 7469 6f6e 2061  `Normalization a
+00060c50: 6e64 2053 6361 6c69 6e67 6020 5665 7279  nd Scaling` Very
+00060c60: 2075 7365 6675 6c20 746f 2063 6f6d 7061   useful to compa
+00060c70: 7265 2074 6865 200d 0a09 096b 696e 6574  re the ....kinet
+00060c80: 6963 7320 666f 7220 6469 6666 6572 656e  ics for differen
+00060c90: 7420 7175 656e 6368 6572 2063 6f6e 6365  t quencher conce
+00060ca0: 6e74 7261 7469 6f6e 7320 6f72 2070 756d  ntrations or pum
+00060cb0: 7020 706f 7765 7273 2c20 0d0a 0909 6f72  p powers, ....or
+00060cc0: 2065 2e67 2e20 6469 6666 6572 656e 7420   e.g. different 
+00060cd0: 6669 7473 2e20 5468 6520 7061 7261 6d65  fits. The parame
+00060ce0: 7465 7220 7769 6474 6820 6f72 2074 6865  ter width or the
+00060cf0: 2067 656e 6572 616c 2073 656c 662e 7761   general self.wa
+00060d00: 7665 6c65 6e67 7468 5f62 696e 0d0a 0909  velength_bin....
+00060d10: 7768 6963 6820 6973 2075 7365 6420 6966  which is used if
+00060d20: 2077 6964 7468 2069 7320 4e6f 6e65 2028   width is None (
+00060d30: 4465 6661 756c 7429 2064 6566 696e 6573  Default) defines
+00060d40: 2074 6865 2077 6964 7468 206f 660d 0a09   the width of...
+00060d50: 0974 6865 2073 7065 6374 7261 6c20 7769  .the spectral wi
+00060d60: 6e64 6f77 2074 6861 7420 6973 2069 6e74  ndow that is int
+00060d70: 6567 7261 7465 6420 616e 6420 7368 6f77  egrated and show
+00060d80: 6e2e 0d0a 0d0a 0909 4120 6e6f 726d 616c  n.......A normal
+00060d90: 697a 6174 696f 6e20 7769 6e64 6f77 2063  ization window c
+00060da0: 616e 2062 6520 6769 7665 6e20 6174 2077  an be given at w
+00060db0: 6869 6368 2061 6c6c 2074 6865 2070 6c6f  hich all the plo
+00060dc0: 7474 6564 2063 7572 7665 7320 6172 6520  tted curves are 
+00060dd0: 6e6f 726d 616c 697a 6564 2074 6f2e 200d  normalized to. .
+00060de0: 0a09 0954 6869 7320 7769 6e64 6f77 2064  ...This window d
+00060df0: 6f65 7320 6e6f 7420 6861 7665 2074 6f20  oes not have to 
+00060e00: 6265 2069 6e20 7468 6520 706c 6f74 7465  be in the plotte
+00060e10: 6420 7265 6769 6f6e 2e20 5365 6520 3a72  d region. See :r
+00060e20: 6566 3a60 4e6f 726d 616c 697a 6174 696f  ef:`Normalizatio
+00060e30: 6e20 616e 6420 5363 616c 696e 6760 0d0a  n and Scaling`..
+00060e40: 0909 0d0a 0909 5061 7261 6d65 7465 7273  ......Parameters
+00060e50: 0d0a 0909 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ....------------
+00060e60: 2d2d 0d0a 0909 0d0a 0909 7265 6c5f 7761  --........rel_wa
+00060e70: 7665 203a 2066 6c6f 6174 206f 7220 6c69  ve : float or li
+00060e80: 7374 2f76 6563 746f 7220 286f 6620 666c  st/vector (of fl
+00060e90: 6f61 7473 290d 0a09 0909 5370 6563 6966  oats).....Specif
+00060ea0: 7920 7468 6520 7761 7665 6c65 6e67 7468  y the wavelength
+00060eb0: 2077 6865 7265 2074 6f20 706c 6f74 2074   where to plot t
+00060ec0: 6865 206b 696e 6574 6963 732c 2073 696e  he kinetics, sin
+00060ed0: 676c 6520 7661 6c75 6520 6f72 0d0a 0909  gle value or....
+00060ee0: 096c 6973 742f 7665 6374 6f72 206f 6620  .list/vector of 
+00060ef0: 7661 6c75 6573 2028 6f6e 6c79 206d 616e  values (only man
+00060f00: 6461 746f 7279 2065 6e74 7279 2920 466f  datory entry) Fo
+00060f10: 7220 6561 6368 2065 6e74 7279 2069 6e20  r each entry in 
+00060f20: 0d0a 0909 0972 656c 5f77 6176 6520 6120  .....rel_wave a 
+00060f30: 6b69 6e65 7469 6320 6973 2070 6c6f 7474  kinetic is plott
+00060f40: 6564 2e20 2772 656c 5f77 6176 6527 2061  ed. 'rel_wave' a
+00060f50: 6e64 2027 7769 6474 6827 200d 0a09 0909  nd 'width' .....
+00060f60: 2869 6e20 7468 6520 6f62 6a65 6374 2063  (in the object c
+00060f70: 616c 6c65 6420 2777 6176 656c 656e 6774  alled 'wavelengt
+00060f80: 685f 6269 6e27 2077 6f72 6b20 746f 6765  h_bin' work toge
+00060f90: 7468 6572 2066 6f72 2074 6865 2063 7265  ther for the cre
+00060fa0: 6174 696f 6e20 0d0a 0909 096f 6620 6b69  ation .....of ki
+00060fb0: 6e65 7469 6320 706c 6f74 732e 2041 7420  netic plots. At 
+00060fc0: 6561 6368 2073 656c 6563 7465 6420 7761  each selected wa
+00060fd0: 7665 6c65 6e67 7468 2074 6865 2064 6174  velength the dat
+00060fe0: 6120 6265 7477 6565 6e20 0d0a 0909 0977  a between .....w
+00060ff0: 6176 656c 656e 6774 682b 7769 6474 682f  avelength+width/
+00061000: 3220 616e 6420 7761 7665 6c65 6e67 7468  2 and wavelength
+00061010: 2d77 6964 7468 2f32 2069 7320 6176 6572  -width/2 is aver
+00061020: 6167 6564 200d 0a09 0909 666f 7220 6561  aged .....for ea
+00061030: 6368 2074 696d 6570 6f69 6e74 0d0a 0909  ch timepoint....
+00061040: 090d 0a09 096f 7468 6572 203a 2054 4120  .....other : TA 
+00061050: 6f62 6a65 6374 206f 7220 6c69 7374 206f  object or list o
+00061060: 6620 7468 6f73 652c 206f 7074 696f 6e61  f those, optiona
+00061070: 6c20 0d0a 0909 0973 686f 756c 6420 6265  l .....should be
+00061080: 2074 612e 706c 6f74 5f66 756e 6320 6f62   ta.plot_func ob
+00061090: 6a65 6374 7320 286c 6f61 6465 6420 6f72  jects (loaded or
+000610a0: 2063 6f70 6965 6429 2061 6e64 2069 7320   copied) and is 
+000610b0: 7768 6174 200d 0a09 0909 6973 2070 6c6f  what .....is plo
+000610c0: 7474 6564 2061 6761 696e 7374 2074 6865  tted against the
+000610d0: 2064 6174 6120 7573 6520 6120 6c69 7374   data use a list
+000610e0: 205b 7461 312c 7461 322c 2e2e 2e20 5d20   [ta1,ta2,... ] 
+000610f0: 6f72 2067 656e 6572 6174 6520 7468 6973  or generate this
+00061100: 0d0a 0909 096c 6973 7420 7573 696e 6720  .....list using 
+00061110: 7468 6520 4775 6920 6675 6e63 7469 6f6e  the Gui function
+00061120: 2e20 5365 6520 7365 6374 696f 6e20 3a72  . See section :r
+00061130: 6566 3a60 4f70 656e 696e 6720 6d75 6c74  ef:`Opening mult
+00061140: 6970 6c65 2066 696c 6573 6020 696e 200d  iple files` in .
+00061150: 0a09 0909 7468 6520 646f 6375 6d65 6e74  ....the document
+00061160: 6174 696f 6e0d 0a0d 0a09 0966 6974 7465  ation......fitte
+00061170: 6420 3a20 626f 6f6c 2c20 6f70 7469 6f6e  d : bool, option
+00061180: 616c 0d0a 0909 0954 7275 652f 4661 6c73  al.....True/Fals
+00061190: 6520 2844 6566 6175 6c74 2920 2d20 7573  e (Default) - us
+000611a0: 6520 6669 7474 6564 2064 6174 6120 696e  e fitted data in
+000611b0: 7374 6561 6420 6f66 2072 6177 2064 6174  stead of raw dat
+000611c0: 612e 200d 0a09 0909 4966 2054 7275 652c  a. .....If True,
+000611d0: 2074 6865 2066 6974 7465 6420 6461 7461   the fitted data
+000611e0: 706f 696e 7473 2028 7769 7468 6f75 7420  points (without 
+000611f0: 696e 7465 7270 6f6c 6174 696f 6e29 2061  interpolation) a
+00061200: 7265 2075 7365 642e 200d 0a09 0909 5468  re used. .....Th
+00061210: 6973 2069 7320 696e 7465 6e64 6564 2066  is is intended f
+00061220: 6f72 2063 6f6d 7061 7269 6e67 2065 2e67  or comparing e.g
+00061230: 2e20 6469 6666 6572 656e 7420 6669 7473  . different fits
+00061240: 0d0a 0d0a 0909 6e6f 726d 5f77 696e 646f  ......norm_windo
+00061250: 7720 3a20 4e6f 6e65 206f 7220 6c69 7374  w : None or list
+00061260: 2f76 6563 746f 7220 2877 6974 6820 3420  /vector (with 4 
+00061270: 666c 6f61 7473 292c 206f 7074 696f 6e61  floats), optiona
+00061280: 6c0d 0a09 0909 6e6f 726d 5f77 696e 646f  l.....norm_windo
+00061290: 7720 4769 7665 2061 206c 6973 742f 7475  w Give a list/tu
+000612a0: 7065 6c2f 7665 6374 6f72 2077 6974 6820  pel/vector with 
+000612b0: 3420 656e 7472 6965 7320 696e 2074 6865  4 entries in the
+000612c0: 206f 7264 6572 200d 0a09 0909 5b53 7461   order .....[Sta
+000612d0: 7274 202d 2074 696d 652c 2045 6e64 202d  rt - time, End -
+000612e0: 2074 696d 652c 2053 7461 7274 202d 2077   time, Start - w
+000612f0: 6176 656c 656e 6774 682c 2045 6e64 202d  avelength, End -
+00061300: 2057 6176 656c 656e 6774 685d 2c20 0d0a   Wavelength], ..
+00061310: 0909 0973 6565 2073 6563 7469 6f6e 203a  ...see section :
+00061320: 7265 663a 604e 6f72 6d61 6c69 7a61 7469  ref:`Normalizati
+00061330: 6f6e 2061 6e64 2053 6361 6c69 6e67 6020  on and Scaling` 
+00061340: 696e 2074 6865 2064 6f63 756d 656e 7461  in the documenta
+00061350: 7469 6f6e 2e0d 0a09 0909 4966 204e 6f6e  tion......If Non
+00061360: 6520 2844 6566 6175 6c74 2920 6e6f 206e  e (Default) no n
+00061370: 6f72 6d61 6c69 7a61 7469 6f6e 2069 7320  ormalization is 
+00061380: 646f 6e65 2e0d 0a0d 0a09 0977 6964 7468  done.......width
+00061390: 0d0a 0909 2020 2053 7065 6369 6679 2074  ....   Specify t
+000613a0: 6865 2077 6964 7468 2061 626f 7665 2061  he width above a
+000613b0: 6e64 2062 656c 6f77 2074 6865 2067 6976  nd below the giv
+000613c0: 656e 2077 6176 656c 656e 6774 6820 7468  en wavelength th
+000613d0: 6174 2069 730d 0a09 0920 2020 696e 7465  at is....   inte
+000613e0: 6772 6174 6564 2061 7320 7769 6e64 6f77  grated as window
+000613f0: 2e20 4966 206c 6566 7420 746f 2028 4465  . If left to (De
+00061400: 6661 756c 7429 2022 4e6f 6e65 2220 7468  fault) "None" th
+00061410: 6520 7661 6c75 6520 6672 6f6d 2074 6120  e value from ta 
+00061420: 6973 0d0a 0909 2020 2075 7365 642e 0d0a  is....   used...
+00061430: 0d0a 0909 6461 7461 5f61 6e64 5f66 6974  ....data_and_fit
+00061440: 203a 2062 6f6f 6c2c 206f 7074 696f 6e61   : bool, optiona
+00061450: 6c0d 0a09 0909 5472 7565 206f 7220 4661  l.....True or Fa
+00061460: 6c73 6520 2844 6566 6175 6c74 292c 2063  lse (Default), c
+00061470: 686f 6f73 6520 6966 2066 6f72 2074 6865  hoose if for the
+00061480: 2046 6974 7465 6420 706c 6f74 2074 6865   Fitted plot the
+00061490: 2072 6177 2064 6174 6120 6f66 2074 6865   raw data of the
+000614a0: 200d 0a09 0909 6f74 6865 7220 7072 6f6a   .....other proj
+000614b0: 6563 7473 2069 7320 746f 2062 6520 706c  ects is to be pl
+000614c0: 6f74 7469 6e67 2069 6e20 6164 6469 7469  otting in additi
+000614d0: 6f6e 2074 6f20 7468 6520 6669 7474 6564  on to the fitted
+000614e0: 206c 696e 652e 2046 6f72 2046 616c 7365   line. For False
+000614f0: 2028 4465 6661 756c 7429 0d0a 0909 094f   (Default).....O
+00061500: 6e6c 7920 7468 6520 6669 7420 6973 2070  nly the fit is p
+00061510: 6c6f 7474 6564 2e0d 0a09 0909 0d0a 0909  lotted..........
+00061520: 6c69 6e65 7769 6474 6820 3a20 666c 6f61  linewidth : floa
+00061530: 742c 206f 7074 696f 6e61 6c0d 0a09 0909  t, optional.....
+00061540: 6c69 6e65 7769 6474 6820 746f 2062 6520  linewidth to be 
+00061550: 7573 6564 2066 6f72 2070 6c6f 7474 696e  used for plottin
+00061560: 670d 0a09 0909 090d 0a09 0963 6d61 7020  g..........cmap 
+00061570: 3a20 4e6f 6e65 206f 7220 6d61 7470 6c6f  : None or matplo
+00061580: 746c 6962 2063 6f6c 6f72 206d 6170 2c20  tlib color map, 
+00061590: 6f70 7469 6f6e 616c 0d0a 0909 0969 7320  optional.....is 
+000615a0: 6120 706f 7765 7266 756c 6c20 7661 7269  a powerfull vari
+000615b0: 6162 6c65 2074 6861 7420 6368 6f6f 7365  able that choose
+000615c0: 7320 7468 6520 636f 6c6f 7572 206d 6170  s the colour map
+000615d0: 2061 7070 6c69 6564 2066 6f72 2061 6c6c   applied for all
+000615e0: 2070 6c6f 7473 2e20 4966 2073 6574 2074   plots. If set t
+000615f0: 6f20 0d0a 0909 094e 6f6e 6520 2844 6566  o .....None (Def
+00061600: 6175 6c74 2920 7468 656e 2074 6865 2073  ault) then the s
+00061610: 656c 662e 636d 6170 2069 7320 7573 6564  elf.cmap is used
+00061620: 2e0d 0a09 0909 4173 2073 7461 6e64 6172  ......As standar
+00061630: 6420 4920 7573 6520 7468 6520 636f 6c6f  d I use the colo
+00061640: 7220 6d61 7020 226a 6574 2220 6672 6f6d  r map "jet" from
+00061650: 206d 6174 706c 6f74 6c69 622e 2054 6865   matplotlib. The
+00061660: 7265 2061 7265 2061 2076 6172 6965 7479  re are a variety
+00061670: 206f 6620 636f 6c6f 726d 6170 7320 0d0a   of colormaps ..
+00061680: 0909 0961 7661 696c 6162 6c65 2074 6861  ...available tha
+00061690: 7420 6172 6520 7665 7279 2075 7365 6675  t are very usefu
+000616a0: 6c6c 2e20 4265 7369 6465 2022 6a65 7422  ll. Beside "jet"
+000616b0: 2c20 2276 6972 6964 6973 2220 6973 2061  , "viridis" is a
+000616c0: 2067 6f6f 6420 6368 6f69 6365 2061 7320   good choice as 
+000616d0: 6974 2069 7320 7765 6c6c 200d 0a09 0909  it is well .....
+000616e0: 7669 7369 626c 6520 756e 6465 7220 7265  visible under re
+000616f0: 642d 6772 6565 6e20 626c 696e 646e 6573  d-green blindnes
+00061700: 732e 204f 7468 6572 2075 7365 6675 6c20  s. Other useful 
+00061710: 6d61 7073 2061 7265 2022 7072 6973 6d22  maps are "prism"
+00061720: 2066 6f72 2068 6967 6820 666c 7563 7475   for high fluctu
+00061730: 6174 696f 6e73 200d 0a09 0909 6f72 2064  ations .....or d
+00061740: 6976 6572 6769 6e67 2063 6f6c 6f72 206d  iverging color m
+00061750: 6170 7320 6c69 6b65 2022 7365 6973 6d69  aps like "seismi
+00061760: 6322 2e20 0d0a 0909 0953 6565 2068 7474  c". .....See htt
+00061770: 7073 3a2f 2f6d 6174 706c 6f74 6c69 622e  ps://matplotlib.
+00061780: 6f72 672f 332e 312e 302f 7475 746f 7269  org/3.1.0/tutori
+00061790: 616c 732f 636f 6c6f 7273 2f63 6f6c 6f72  als/colors/color
+000617a0: 6d61 7073 2e68 746d 6c20 666f 7220 6120  maps.html for a 
+000617b0: 636f 6d70 7265 6865 6e73 6976 6520 0d0a  comprehensive ..
+000617c0: 0909 0973 656c 6563 7469 6f6e 2e20 496e  ...selection. In
+000617d0: 2074 6865 2063 6f64 6520 7468 6520 636f   the code the co
+000617e0: 6c6f 726d 6170 7320 6172 6520 696d 706f  lormaps are impo
+000617f0: 7274 6564 2073 6f20 6966 2070 6c6f 745f  rted so if plot_
+00061800: 6675 6e63 2069 7320 696d 706f 7274 6564  func is imported
+00061810: 2061 7320 7066 2074 6865 6e20 0d0a 0909   as pf then ....
+00061820: 0973 656c 662e 636d 6170 3d70 662e 636d  .self.cmap=pf.cm
+00061830: 2e76 6972 6964 6973 2073 6574 7320 7669  .viridis sets vi
+00061840: 7269 6469 7320 6173 2074 6865 206d 6170  ridis as the map
+00061850: 2074 6f20 7573 652e 2049 6e74 6572 6e61   to use. Interna
+00061860: 6c6c 7920 7468 6520 636f 6c6f 7273 2061  lly the colors a
+00061870: 7265 2063 686f 7365 6e20 0d0a 0909 0977  re chosen .....w
+00061880: 6974 6820 7468 6520 2263 6f6c 6d22 2066  ith the "colm" f
+00061890: 756e 6374 696f 6e2e 2054 6865 2032 6420  unction. The 2d 
+000618a0: 706c 6f74 7320 7265 7175 6972 6520 6120  plots require a 
+000618b0: 636f 6e74 696e 756f 7573 2063 6f6c 6f72  continuous color
+000618c0: 206d 6170 2073 6f20 6966 2073 6f6d 6574   map so if somet
+000618d0: 6869 6e67 200d 0a09 0909 656c 7365 2069  hing .....else i
+000618e0: 7320 6769 7665 2032 6420 706c 6f74 7320  s give 2d plots 
+000618f0: 6172 6520 7368 6f77 6e20 6175 746f 6d61  are shown automa
+00061900: 7469 6361 6c6c 7920 7769 7468 2022 6a65  tically with "je
+00061910: 7422 2e20 466f 7220 616c 6c20 6f66 2074  t". For all of t
+00061920: 6865 2031 6420 706c 6f74 7320 686f 7765  he 1d plots howe
+00061930: 7665 7220 0d0a 0909 0949 2066 6972 7374  ver .....I first
+00061940: 2073 656c 6563 7420 6120 6e75 6d62 6572   select a number
+00061950: 206f 6620 636f 6c6f 7273 2062 6566 6f72   of colors befor
+00061960: 6520 6561 6368 2070 6c6f 742e 2049 6620  e each plot. If 
+00061970: 636d 6170 2069 7320 6120 636f 6e74 696e  cmap is a contin
+00061980: 6f75 7320 6d61 7020 7468 656e 2074 6865  ous map then the
+00061990: 7365 0d0a 0909 0961 7265 2073 616d 706c  se.....are sampl
+000619a0: 6564 2065 7665 6e6c 7920 6f76 6572 2074  ed evenly over t
+000619b0: 6865 2063 6f6c 6f75 726d 6170 2e20 4d61  he colourmap. Ma
+000619c0: 6e75 616c 2069 7465 7261 626c 6573 206f  nual iterables o
+000619d0: 6620 636f 6c6f 7572 7320 0d0a 0909 0963  f colours .....c
+000619e0: 6d61 703d 5b28 312c 302c 3029 2c28 302c  map=[(1,0,0),(0,
+000619f0: 312c 3029 2c28 302c 302c 3129 2c2e 2e2e  1,0),(0,0,1),...
+00061a00: 5d20 6172 6520 616c 736f 2061 6363 6570  ] are also accep
+00061a10: 7465 642c 2061 7320 6172 6520 7665 6374  ted, as are vect
+00061a20: 6f72 7320 6f72 2064 6174 6166 7261 6d65  ors or dataframe
+00061a30: 7320 7468 6174 200d 0a09 0909 636f 6e74  s that .....cont
+00061a40: 6169 6e20 6173 2072 6f77 7320 7468 6520  ain as rows the 
+00061a50: 636f 6c6f 7273 2e20 5468 6572 6520 6d75  colors. There mu
+00061a60: 7374 2062 6520 6f66 2063 6f75 7273 6520  st be of course 
+00061a70: 7375 6666 6963 6965 6e74 2063 6f6c 6f72  sufficient color
+00061a80: 7320 7072 6573 656e 7420 666f 7220 0d0a  s present for ..
+00061a90: 0909 0974 6865 206e 756d 6265 7273 206f  ...the numbers o
+00061aa0: 6620 6c69 6e65 7320 7468 6174 2077 696c  f lines that wil
+00061ab0: 6c20 6265 2070 6c6f 7474 6564 2e20 536f  l be plotted. So
+00061ac0: 2049 2072 6563 6f6d 6d65 6e64 2074 6f20   I recommend to 
+00061ad0: 7072 6f76 6964 6520 6174 206c 6561 7374  provide at least
+00061ae0: 2031 3020 636f 6c6f 7572 7320 0d0a 0909   10 colours ....
+00061af0: 0928 652e 672e 7e79 6f75 7220 756e 6976  .(e.g.~your univ
+00061b00: 6572 7369 7479 2063 6f6c 6f72 7329 2e20  ersity colors). 
+00061b10: 636f 6c6f 7572 7320 6172 6520 616c 7761  colours are alwa
+00061b20: 7973 2067 6976 656e 2061 7320 612c 206c  ys given as a, l
+00061b30: 6973 7420 6f72 2074 7570 6c65 2077 6974  ist or tuple wit
+00061b40: 6820 5247 4120 6f72 2052 4742 410d 0a09  h RGA or RGBA...
+00061b50: 0909 2877 6974 6820 7468 6520 6c61 7374  ..(with the last
+00061b60: 2041 2062 6565 696e 6720 7468 6520 416c   A beeing the Al
+00061b70: 7068 613d 7472 616e 7370 6172 656e 6379  pha=transparency
+00061b80: 2e20 416c 6c20 6e75 6d62 6572 7320 6172  . All numbers ar
+00061b90: 6520 6265 7477 6565 6e20 3020 616e 6420  e between 0 and 
+00061ba0: 312e 200d 0a09 0909 4966 2061 206c 6973  1. .....If a lis
+00061bb0: 742f 7665 6374 6f72 2f44 6174 6146 7261  t/vector/DataFra
+00061bc0: 6d65 2069 7320 6769 7665 6e20 666f 7220  me is given for 
+00061bd0: 7468 6520 636f 6c6f 7572 7320 7468 6579  the colours they
+00061be0: 2077 696c 6c20 6265 2075 7365 6420 696e   will be used in
+00061bf0: 2074 6865 206f 7264 6572 2070 726f 7669   the order provi
+00061c00: 6465 642e 0d0a 0909 0d0a 0909 5363 616c  ded.........Scal
+00061c10: 655f 7479 7065 203a 204e 6f6e 6520 6f72  e_type : None or
+00061c20: 2073 7472 0d0a 0909 0969 7320 6120 6765   str.....is a ge
+00061c30: 6e65 7261 6c20 7365 7474 696e 6720 7468  neral setting th
+00061c40: 6174 2063 616e 2069 6e66 6c75 656e 6365  at can influence
+00061c50: 7320 7768 6174 2074 696d 6520 6178 6973  s what time axis
+00061c60: 2077 696c 6c20 6265 2075 7365 6420 666f   will be used fo
+00061c70: 7220 7468 6520 706c 6f74 732e 200d 0a09  r the plots. ...
+00061c80: 0909 2273 796d 6c6f 6722 2028 6c69 6e65  .."symlog" (line
+00061c90: 6172 2061 726f 756e 6420 7a65 726f 2061  ar around zero a
+00061ca0: 6e64 206c 6f67 6172 6974 686d 6963 206f  nd logarithmic o
+00061cb0: 7468 6572 7769 7365 2920 226c 696e 2220  therwise) "lin" 
+00061cc0: 616e 6420 226c 6f67 2220 6172 6520 7661  and "log" are va
+00061cd0: 6c69 6420 6f70 7469 6f6e 732e 090d 0a09  lid options.....
+00061ce0: 0909 0909 0d0a 0909 4578 616d 706c 6573  ........Examples
+00061cf0: 0d0a 0909 2d2d 2d2d 2d2d 2d2d 0d0a 0909  ....--------....
+00061d00: 0d0a 0909 3e3e 3e20 696d 706f 7274 2070  ....>>> import p
+00061d10: 6c6f 745f 6675 6e63 2061 7320 7066 0d0a  lot_func as pf..
+00061d20: 0909 3e3e 3e20 7461 203d 2070 662e 5441  ..>>> ta = pf.TA
+00061d30: 2827 7465 7374 312e 6864 6635 2729 2023  ('test1.hdf5') #
+00061d40: 6f70 656e 2074 6865 206f 7269 6769 6e61  open the origina
+00061d50: 6c20 7072 6f6a 6563 740d 0a09 090d 0a09  l project.......
+00061d60: 094e 6f77 206f 7065 6e20 6120 6275 6e63  .Now open a bunc
+00061d70: 6820 6f66 206f 7468 6572 2070 726f 6a65  h of other proje
+00061d80: 6374 7320 746f 2063 6f6d 7061 7265 2061  cts to compare a
+00061d90: 6761 696e 7374 0d0a 0909 0d0a 0909 3e3e  gainst........>>
+00061da0: 3e20 6f74 6865 725f 7072 6f6a 6563 7473  > other_projects
+00061db0: 203d 2070 662e 4755 495f 6f70 656e 2870   = pf.GUI_open(p
+00061dc0: 726f 6a65 6374 5f6c 6973 7420 3d20 5b27  roject_list = ['
+00061dd0: 6669 6c65 312e 5349 4127 2c20 2766 696c  file1.SIA', 'fil
+00061de0: 6532 2e53 4941 275d 290d 0a09 090d 0a09  e2.SIA']).......
+00061df0: 0954 7970 6963 616c 2075 7365 3a0d 0a09  .Typical use:...
+00061e00: 0943 6f6d 7061 7265 2074 6865 2072 6177  .Compare the raw
+00061e10: 2064 6174 6120 7769 7468 6f75 7420 6e6f   data without no
+00061e20: 726d 616c 697a 6174 696f 6e20 6174 2034  rmalization at 4
+00061e30: 3030 206e 6d20 616e 6420 3530 3020 6e6d  00 nm and 500 nm
+00061e40: 0d0a 0909 0d0a 0909 3e3e 3e20 7461 2e43  ........>>> ta.C
+00061e50: 6f6d 7061 7265 5f61 745f 7761 7665 2872  ompare_at_wave(r
+00061e60: 656c 5f77 6176 6520 3d20 5b34 3030 2c20  el_wave = [400, 
+00061e70: 3530 305d 2c20 6f74 6865 7273 203d 206f  500], others = o
+00061e80: 7468 6572 5f70 726f 6a65 6374 290d 0a09  ther_project)...
+00061e90: 090d 0a09 0943 6f6d 7061 7265 2074 6865  .....Compare the
+00061ea0: 2071 7561 6c69 7479 206f 6620 7468 6520   quality of the 
+00061eb0: 6669 7420 6461 7461 2077 6974 686f 7574  fit data without
+00061ec0: 206e 6f72 6d61 6c69 7a61 7469 6f6e 2061   normalization a
+00061ed0: 7420 3430 3020 6e6d 2061 6e64 2035 3030  t 400 nm and 500
+00061ee0: 206e 6d0d 0a09 090d 0a09 093e 3e3e 2074   nm........>>> t
+00061ef0: 612e 436f 6d70 6172 655f 6174 5f77 6176  a.Compare_at_wav
+00061f00: 6528 7265 6c5f 7761 7665 203d 205b 3430  e(rel_wave = [40
+00061f10: 302c 2035 3030 5d2c 206f 7468 6572 7320  0, 500], others 
+00061f20: 3d20 6f74 6865 725f 7072 6f6a 6563 742c  = other_project,
+00061f30: 2066 6974 7465 6420 3d20 5472 7565 290d   fitted = True).
+00061f40: 0a09 090d 0a09 0943 6f6d 7061 7265 2077  .......Compare w
+00061f50: 6974 6820 6e6f 726d 616c 697a 6174 696f  ith normalizatio
+00061f60: 6e20 7769 6e64 6f77 2062 6574 7765 656e  n window between
+00061f70: 2031 7073 2061 6e64 2032 7073 2061 6e64   1ps and 2ps and
+00061f80: 2034 3030 6e6d 2061 6e64 2034 3530 6e6d   400nm and 450nm
+00061f90: 0d0a 0909 0d0a 0909 3e3e 3e20 6e6f 726d  ........>>> norm
+00061fa0: 5f77 696e 646f 773d 5b31 2c32 2c34 3030  _window=[1,2,400
+00061fb0: 2c34 3530 5d0d 0a09 093e 3e3e 2074 612e  ,450]....>>> ta.
+00061fc0: 436f 6d70 6172 655f 6174 5f77 6176 6528  Compare_at_wave(
+00061fd0: 7265 6c5f 7761 7665 203d 205b 3430 302c  rel_wave = [400,
+00061fe0: 2035 3030 5d2c 206f 7468 6572 7320 3d20   500], others = 
+00061ff0: 6f74 6865 725f 7072 6f6a 6563 742c 206e  other_project, n
+00062000: 6f72 6d5f 7769 6e64 6f77 203d 206e 6f72  orm_window = nor
+00062010: 6d5f 7769 6e64 6f77 290d 0a09 090d 0a09  m_window).......
+00062020: 0955 7365 2065 7861 6d70 6c65 3a20 4f66  .Use example: Of
+00062030: 7465 6e20 7468 6572 6520 6172 6520 6120  ten there are a 
+00062040: 6c6f 7420 6f66 2064 6966 6665 7265 6e74  lot of different
+00062050: 206d 6561 7375 7265 6d65 6e74 7320 746f   measurements to
+00062060: 200d 0a09 0963 6f6d 7061 7265 2061 7420   ....compare at 
+00062070: 6d75 6c74 6970 6c65 2077 6176 656c 656e  multiple wavelen
+00062080: 6774 682e 2054 6865 206e 6f72 6d6c 697a  gth. The normliz
+00062090: 6174 696f 6e20 6973 2070 6572 666f 726d  ation is perform
+000620a0: 6564 2061 7420 7468 6520 6772 6f75 6e64  ed at the ground
+000620b0: 2073 7461 7465 2062 6c65 6163 680d 0a09   state bleach...
+000620c0: 0934 3630 206e 6d20 616e 6420 6561 726c  .460 nm and earl
+000620d0: 7920 696e 2074 696d 652e 2054 6865 6e20  y in time. Then 
+000620e0: 6974 2069 7320 6265 7474 6572 2074 6f20  it is better to 
+000620f0: 6d61 6b65 2061 206e 6577 2070 6c6f 7420  make a new plot 
+00062100: 666f 7220 6561 6368 200d 0a09 0977 6176  for each ....wav
+00062110: 656c 656e 6774 682e 2054 6865 206e 6f72  elength. The nor
+00062120: 6d61 6c69 7a61 7469 6f6e 2077 696e 646f  malization windo
+00062130: 7720 7374 6179 7320 6669 7865 642e 0d0a  w stays fixed...
+00062140: 0909 0d0a 0909 3e3e 3e20 706c 742e 636c  ......>>> plt.cl
+00062150: 6f73 6528 2761 6c6c 2729 2023 6d61 6b65  ose('all') #make
+00062160: 2073 6f6d 6520 7370 6163 650d 0a09 093e   some space....>
+00062170: 3e3e 206e 6f72 6d5f 7769 6e64 6f77 3d5b  >> norm_window=[
+00062180: 302e 332c 302e 352c 3435 302c 3437 305d  0.3,0.5,450,470]
+00062190: 2023 6465 6669 6e65 2077 696e 646f 7720   #define window 
+000621a0: 696e 2067 726f 756e 6420 7374 6174 6520  in ground state 
+000621b0: 626c 6561 6368 0d0a 0909 3e3e 3e20 666f  bleach....>>> fo
+000621c0: 7220 7761 7665 2069 6e20 5b33 3030 2c34  r wave in [300,4
+000621d0: 3030 2c35 3030 2c36 3030 2c37 3030 5d3a  00,500,600,700]:
+000621e0: 2023 6974 6572 6174 6520 6f76 6572 2074   #iterate over t
+000621f0: 6865 2077 6176 656c 656e 6774 6820 0d0a  he wavelength ..
+00062200: 0909 3e3e 3e20 0974 612e 436f 6d70 6172  ..>>> .ta.Compar
+00062210: 655f 6174 5f77 6176 6528 7265 6c5f 7761  e_at_wave(rel_wa
+00062220: 7665 203d 2077 6176 652c 206f 7468 6572  ve = wave, other
+00062230: 7320 3d20 6f74 6865 725f 7072 6f6a 6563  s = other_projec
+00062240: 742c 206e 6f72 6d5f 7769 6e64 6f77 203d  t, norm_window =
+00062250: 206e 6f72 6d5f 7769 6e64 6f77 290d 0a09   norm_window)...
+00062260: 090d 0a09 0927 2727 090d 0a09 090d 0a09  .....'''........
+00062270: 0969 6620 7365 6c66 2e73 6176 655f 6669  .if self.save_fi
+00062280: 6775 7265 735f 746f 5f66 6f6c 6465 723a  gures_to_folder:
+00062290: 7365 6c66 2e66 6967 7572 655f 7061 7468  self.figure_path
+000622a0: 3d63 6865 636b 5f66 6f6c 6465 7228 7061  =check_folder(pa
+000622b0: 7468 3d27 7265 7375 6c74 5f66 6967 7572  th='result_figur
+000622c0: 6573 272c 6375 7272 656e 745f 7061 7468  es',current_path
+000622d0: 3d73 656c 662e 7061 7468 290d 0a09 0969  =self.path)....i
+000622e0: 6620 7769 6474 6820 6973 204e 6f6e 653a  f width is None:
+000622f0: 7769 6474 683d 7365 6c66 2e77 6176 656c  width=self.wavel
+00062300: 656e 6774 685f 6269 6e0d 0a09 0969 6620  ength_bin....if 
+00062310: 7265 6c5f 7761 7665 2069 7320 4e6f 6e65  rel_wave is None
+00062320: 3a0d 0a09 0909 7265 6c5f 7761 7665 3d73  :.....rel_wave=s
+00062330: 656c 662e 7265 6c5f 7761 7665 0d0a 0909  elf.rel_wave....
+00062340: 6966 206f 7468 6572 2069 7320 6e6f 7420  if other is not 
+00062350: 4e6f 6e65 3a0d 0a09 0909 6966 206e 6f74  None:.....if not
+00062360: 2068 6173 6174 7472 286f 7468 6572 2c27   hasattr(other,'
+00062370: 5f5f 6974 6572 5f5f 2729 3a6f 7468 6572  __iter__'):other
+00062380: 3d5b 6f74 6865 725d 0d0a 0909 6966 206e  =[other]....if n
+00062390: 6f74 2068 6173 6174 7472 2872 656c 5f77  ot hasattr(rel_w
+000623a0: 6176 652c 275f 5f69 7465 725f 5f27 293a  ave,'__iter__'):
+000623b0: 0d0a 0909 0972 656c 5f77 6176 653d 5b72  .....rel_wave=[r
+000623c0: 656c 5f77 6176 655d 0d0a 0909 6966 2063  el_wave]....if c
+000623d0: 6d61 7020 6973 204e 6f6e 653a 636d 6170  map is None:cmap
+000623e0: 3d73 656c 662e 636d 6170 0d0a 0909 6966  =self.cmap....if
+000623f0: 2066 6974 7465 643a 0d0a 0909 0974 7279   fitted:.....try
+00062400: 3a0d 0a09 0909 0972 653d 7365 6c66 2e72  :......re=self.r
+00062410: 650d 0a09 0909 6578 6365 7074 3a0d 0a09  e.....except:...
+00062420: 0909 0970 7269 6e74 2822 4e6f 2066 6974  ...print("No fit
+00062430: 7465 6420 7265 7375 6c74 7320 7072 6573  ted results pres
+00062440: 656e 7422 290d 0a09 0909 0972 6574 7572  ent")......retur
+00062450: 6e20 4661 6c73 650d 0a09 0909 6966 206e  n False.....if n
+00062460: 6f72 6d5f 7769 6e64 6f77 2069 7320 6e6f  orm_window is no
+00062470: 7420 4e6f 6e65 3a0d 0a09 0909 0972 6566  t None:......ref
+00062480: 5f73 6361 6c65 203d 2072 655b 2741 275d  _scale = re['A']
+00062490: 2e6c 6f63 5b6e 6f72 6d5f 7769 6e64 6f77  .loc[norm_window
+000624a0: 5b30 5d3a 6e6f 726d 5f77 696e 646f 775b  [0]:norm_window[
+000624b0: 315d 2c20 6e6f 726d 5f77 696e 646f 775b  1], norm_window[
+000624c0: 325d 3a6e 6f72 6d5f 7769 6e64 6f77 5b33  2]:norm_window[3
+000624d0: 5d5d 2e6d 6561 6e28 292e 6d65 616e 2829  ]].mean().mean()
+000624e0: 0d0a 0909 0966 6967 2c20 6178 203d 2070  .....fig, ax = p
+000624f0: 6c74 2e73 7562 706c 6f74 7328 6669 6773  lt.subplots(figs
+00062500: 697a 6520 3d20 2831 302c 2036 292c 2064  ize = (10, 6), d
+00062510: 7069 203d 2031 3030 290d 0a09 0909 636f  pi = 100).....co
+00062520: 6c6f 7273 203d 2063 6f6c 6d28 636d 6170  lors = colm(cmap
+00062530: 203d 2063 6d61 702c 206b 203d 2072 616e   = cmap, k = ran
+00062540: 6765 286c 656e 2872 656c 5f77 6176 6529  ge(len(rel_wave)
+00062550: 2a28 322b 6c65 6e28 6f74 6865 7229 2929  *(2+len(other)))
+00062560: 290d 0a09 0909 6178 203d 2070 6c6f 7431  ).....ax = plot1
+00062570: 6428 7265 5b27 4127 5d2c 2061 7820 3d20  d(re['A'], ax = 
+00062580: 6178 2c20 7761 7665 6c65 6e67 7468 203d  ax, wavelength =
+00062590: 2072 656c 5f77 6176 652c 2077 6964 7468   rel_wave, width
+000625a0: 203d 2077 6964 7468 2c20 6c69 6e65 735f   = width, lines_
+000625b0: 6172 6520 3d20 2764 6174 6127 2c20 0d0a  are = 'data', ..
+000625c0: 0909 0909 0909 636d 6170 203d 2063 6f6c  ......cmap = col
+000625d0: 6f72 732c 2074 6974 6c65 203d 2027 272c  ors, title = '',
+000625e0: 2070 6c6f 745f 7479 7065 203d 2073 6361   plot_type = sca
+000625f0: 6c65 5f74 7970 652c 206c 696e 6577 6964  le_type, linewid
+00062600: 7468 203d 206c 696e 6577 6964 7468 290d  th = linewidth).
+00062610: 0a09 0909 6178 203d 2070 6c6f 7431 6428  ....ax = plot1d(
+00062620: 7265 5b27 4143 275d 2c20 6178 203d 2061  re['AC'], ax = a
+00062630: 782c 2077 6176 656c 656e 6774 6820 3d20  x, wavelength = 
+00062640: 7265 6c5f 7761 7665 2c20 7769 6474 6820  rel_wave, width 
+00062650: 3d20 7769 6474 682c 206c 696e 6573 5f61  = width, lines_a
+00062660: 7265 203d 2027 6669 7474 6564 272c 200d  re = 'fitted', .
+00062670: 0a09 0909 0909 0963 6d61 7020 3d20 636f  .......cmap = co
+00062680: 6c6f 7273 2c20 7469 746c 6520 3d20 2727  lors, title = ''
+00062690: 2c20 7375 6270 6c6f 7420 3d20 5472 7565  , subplot = True
+000626a0: 2c20 706c 6f74 5f74 7970 6520 3d20 7363  , plot_type = sc
+000626b0: 616c 655f 7479 7065 2c20 6c69 6e65 7769  ale_type, linewi
+000626c0: 6474 6820 3d20 6c69 6e65 7769 6474 6829  dth = linewidth)
+000626d0: 0d0a 0909 0923 6178 203d 2070 6c6f 7431  .....#ax = plot1
+000626e0: 6428 7265 5b27 4143 275d 2c20 6178 203d  d(re['AC'], ax =
+000626f0: 2061 782c 2077 6176 656c 656e 6774 6820   ax, wavelength 
+00062700: 3d20 7265 6c5f 7761 7665 2c20 7769 6474  = rel_wave, widt
+00062710: 6820 3d20 7769 6474 682c 206c 696e 6573  h = width, lines
+00062720: 5f61 7265 203d 2027 6669 7474 6564 272c  _are = 'fitted',
+00062730: 200d 0a09 0909 2309 0909 636d 6170 203d   .....#...cmap =
+00062740: 2063 6f6c 6f72 732c 2063 6f6c 6f72 5f6f   colors, color_o
+00062750: 6666 7365 7420 3d20 6c65 6e28 7265 6c5f  ffset = len(rel_
+00062760: 7761 7665 292c 2074 6974 6c65 203d 2027  wave), title = '
+00062770: 272c 2073 7562 706c 6f74 203d 2054 7275  ', subplot = Tru
+00062780: 652c 2070 6c6f 745f 7479 7065 203d 2073  e, plot_type = s
+00062790: 6361 6c65 5f74 7970 6529 0d0a 0909 0968  cale_type).....h
+000627a0: 616e 642c 2020 6c61 6265 6c73 203d 2061  and,  labels = a
+000627b0: 782e 6765 745f 6c65 6765 6e64 5f68 616e  x.get_legend_han
+000627c0: 646c 6573 5f6c 6162 656c 7328 290d 0a09  dles_labels()...
+000627d0: 0909 6c61 623d 5b27 2567 206e 6d27 2561  ..lab=['%g nm'%a
+000627e0: 202b 2027 5f27 202b 2073 7472 2873 656c   + '_' + str(sel
+000627f0: 662e 6669 6c65 6e61 6d65 2920 666f 7220  f.filename) for 
+00062800: 6120 696e 2072 656c 5f77 6176 655d 0d0a  a in rel_wave]..
+00062810: 0909 0966 6f72 2065 6e74 2069 6e20 7265  ...for ent in re
+00062820: 6c5f 7761 7665 3a0d 0a09 0909 096c 6162  l_wave:......lab
+00062830: 2e61 7070 656e 6428 2725 6720 6e6d 2725  .append('%g nm'%
+00062840: 656e 7420 2b20 275f 2720 2b20 7374 7228  ent + '_' + str(
+00062850: 7365 6c66 2e66 696c 656e 616d 6529 290d  self.filename)).
+00062860: 0a09 0909 0d0a 0909 0969 6620 6f74 6865  .........if othe
+00062870: 7220 6973 206e 6f74 204e 6f6e 653a 0d0a  r is not None:..
+00062880: 0909 0909 666f 7220 692c 6f20 696e 2065  ....for i,o in e
+00062890: 6e75 6d65 7261 7465 286f 7468 6572 293a  numerate(other):
+000628a0: 0d0a 0909 0909 0969 2b3d 310d 0a09 0909  .......i+=1.....
+000628b0: 0909 636f 6c6f 725f 6f66 6673 6574 3d28  ..color_offset=(
+000628c0: 692b 3129 2a6c 656e 2872 656c 5f77 6176  i+1)*len(rel_wav
+000628d0: 6529 0d0a 0909 0909 0974 7279 3a0d 0a09  e).......try:...
+000628e0: 0909 0909 0972 653d 6f2e 7265 0d0a 0909  .....re=o.re....
+000628f0: 0909 0965 7863 6570 743a 0d0a 0909 0909  ...except:......
+00062900: 0909 7072 696e 7428 2725 7320 6861 7320  ..print('%s has 
+00062910: 6e6f 2066 6974 7465 6420 7265 7375 6c74  no fitted result
+00062920: 7327 256f 2e66 696c 656e 616d 6529 0d0a  s'%o.filename)..
+00062930: 0909 0909 0909 636f 6e74 696e 7565 0d0a  ......continue..
+00062940: 0909 0909 0969 6620 6e6f 726d 5f77 696e  .....if norm_win
+00062950: 646f 7720 6973 206e 6f74 204e 6f6e 653a  dow is not None:
+00062960: 0d0a 0909 0909 0909 7265 6c5f 7363 616c  ........rel_scal
+00062970: 653d 7265 5b27 4127 5d2e 6c6f 635b 6e6f  e=re['A'].loc[no
+00062980: 726d 5f77 696e 646f 775b 305d 3a6e 6f72  rm_window[0]:nor
+00062990: 6d5f 7769 6e64 6f77 5b31 5d2c 6e6f 726d  m_window[1],norm
+000629a0: 5f77 696e 646f 775b 325d 3a6e 6f72 6d5f  _window[2]:norm_
+000629b0: 7769 6e64 6f77 5b33 5d5d 2e6d 6561 6e28  window[3]].mean(
+000629c0: 292e 6d65 616e 2829 0d0a 0909 0909 0909  ).mean()........
+000629d0: 0909 0909 0909 0920 0d0a 0909 0909 0909  ....... ........
+000629e0: 7472 793a 0d0a 0909 0909 0909 0973 6361  try:.........sca
+000629f0: 6c69 6e67 3d28 7265 6c5f 7363 616c 6520  ling=(rel_scale 
+00062a00: 2f20 7265 665f 7363 616c 6529 0d0a 0909  / ref_scale)....
+00062a10: 0909 0909 0969 6620 6461 7461 5f61 6e64  .....if data_and
+00062a20: 5f66 6974 3a0d 0a09 0909 0909 0909 0961  _fit:..........a
+00062a30: 7820 3d20 706c 6f74 3164 2872 655b 2741  x = plot1d(re['A
+00062a40: 275d 2f73 6361 6c69 6e67 2c20 636d 6170  ']/scaling, cmap
+00062a50: 203d 2063 6f6c 6f72 732c 2061 7820 3d20   = colors, ax = 
+00062a60: 6178 2c20 7761 7665 6c65 6e67 7468 203d  ax, wavelength =
+00062a70: 2072 656c 5f77 6176 652c 2077 6964 7468   rel_wave, width
+00062a80: 203d 2077 6964 7468 2c0d 0a09 0909 0909   = width,.......
+00062a90: 0909 0909 0909 7469 746c 6520 3d20 2727  ......title = ''
+00062aa0: 2c20 6c69 6e65 735f 6172 6520 3d20 2764  , lines_are = 'd
+00062ab0: 6174 6127 2c20 7375 6270 6c6f 7420 3d20  ata', subplot = 
+00062ac0: 5472 7565 2c20 636f 6c6f 725f 6f66 6673  True, color_offs
+00062ad0: 6574 203d 2063 6f6c 6f72 5f6f 6666 7365  et = color_offse
+00062ae0: 742c 0d0a 0909 0909 0909 0909 0909 0970  t,.............p
+00062af0: 6c6f 745f 7479 7065 203d 2073 6361 6c65  lot_type = scale
+00062b00: 5f74 7970 652c 206c 696e 6577 6964 7468  _type, linewidth
+00062b10: 203d 206c 696e 6577 6964 7468 290d 0a09   = linewidth)...
+00062b20: 0909 0909 0909 6178 203d 2070 6c6f 7431  ......ax = plot1
+00062b30: 6428 7265 5b27 4143 275d 2f73 6361 6c69  d(re['AC']/scali
+00062b40: 6e67 2c20 636d 6170 203d 2063 6f6c 6f72  ng, cmap = color
+00062b50: 732c 2061 7820 3d20 6178 2c20 7761 7665  s, ax = ax, wave
+00062b60: 6c65 6e67 7468 203d 2072 656c 5f77 6176  length = rel_wav
+00062b70: 652c 2077 6964 7468 203d 2077 6964 7468  e, width = width
+00062b80: 2c0d 0a09 0909 0909 0909 0909 0974 6974  ,............tit
+00062b90: 6c65 203d 2027 272c 206c 696e 6573 5f61  le = '', lines_a
+00062ba0: 7265 203d 2027 6669 7474 6564 272c 2073  re = 'fitted', s
+00062bb0: 7562 706c 6f74 203d 2054 7275 652c 2063  ubplot = True, c
+00062bc0: 6f6c 6f72 5f6f 6666 7365 7420 3d20 636f  olor_offset = co
+00062bd0: 6c6f 725f 6f66 6673 6574 2c20 0d0a 0909  lor_offset, ....
+00062be0: 0909 0909 0909 0909 706c 6f74 5f74 7970  ........plot_typ
+00062bf0: 6520 3d20 7363 616c 655f 7479 7065 2c20  e = scale_type, 
+00062c00: 6c69 6e65 7769 6474 6820 3d20 6c69 6e65  linewidth = line
+00062c10: 7769 6474 6829 0d0a 0909 0909 0909 0909  width)..........
+00062c20: 0909 0909 0909 0909 0909 0909 0920 0d0a  ............. ..
+00062c30: 0909 0909 0909 6578 6365 7074 3a0d 0a09  ......except:...
+00062c40: 0909 0909 0909 7072 696e 7428 2773 6361  ......print('sca
+00062c50: 6c69 6e67 2046 6169 6c65 6421 2729 0d0a  ling Failed!')..
+00062c60: 0909 0909 0909 0969 6620 6461 7461 5f61  .......if data_a
+00062c70: 6e64 5f66 6974 3a0d 0a09 0909 0909 0909  nd_fit:.........
+00062c80: 0961 7820 3d20 706c 6f74 3164 2872 655b  .ax = plot1d(re[
+00062c90: 2741 275d 2c20 636d 6170 203d 2063 6f6c  'A'], cmap = col
+00062ca0: 6f72 732c 2061 7820 3d20 6178 2c20 7761  ors, ax = ax, wa
+00062cb0: 7665 6c65 6e67 7468 203d 2072 656c 5f77  velength = rel_w
+00062cc0: 6176 652c 2077 6964 7468 203d 2077 6964  ave, width = wid
+00062cd0: 7468 2c20 0d0a 0909 0909 0909 0909 0909  th, ............
+00062ce0: 0909 7469 746c 6520 3d20 2727 2c20 6c69  ..title = '', li
+00062cf0: 6e65 735f 6172 6520 3d20 2764 6174 6127  nes_are = 'data'
+00062d00: 2c20 7375 6270 6c6f 7420 3d20 5472 7565  , subplot = True
+00062d10: 2c20 636f 6c6f 725f 6f66 6673 6574 203d  , color_offset =
+00062d20: 2063 6f6c 6f72 5f6f 6666 7365 742c 200d   color_offset, .
+00062d30: 0a09 0909 0909 0909 0909 0909 0970 6c6f  .............plo
+00062d40: 745f 7479 7065 203d 2073 6361 6c65 5f74  t_type = scale_t
+00062d50: 7970 652c 206c 696e 6577 6964 7468 203d  ype, linewidth =
+00062d60: 206c 696e 6577 6964 7468 290d 0a09 0909   linewidth).....
+00062d70: 0909 0909 6178 203d 2070 6c6f 7431 6428  ....ax = plot1d(
+00062d80: 7265 5b27 4143 275d 2c20 636d 6170 203d  re['AC'], cmap =
+00062d90: 2063 6f6c 6f72 732c 2061 7820 3d20 6178   colors, ax = ax
+00062da0: 2c20 7761 7665 6c65 6e67 7468 203d 2072  , wavelength = r
+00062db0: 656c 5f77 6176 652c 2077 6964 7468 203d  el_wave, width =
+00062dc0: 2077 6964 7468 2c20 0d0a 0909 0909 0909   width, ........
+00062dd0: 0909 0909 0974 6974 6c65 203d 2027 272c  .....title = '',
+00062de0: 206c 696e 6573 5f61 7265 203d 2027 6669   lines_are = 'fi
+00062df0: 7474 6564 272c 2073 7562 706c 6f74 203d  tted', subplot =
+00062e00: 2054 7275 652c 2063 6f6c 6f72 5f6f 6666   True, color_off
+00062e10: 7365 7420 3d20 636f 6c6f 725f 6f66 6673  set = color_offs
+00062e20: 6574 2c20 0d0a 0909 0909 0909 0909 0909  et, ............
+00062e30: 0970 6c6f 745f 7479 7065 203d 2073 6361  .plot_type = sca
+00062e40: 6c65 5f74 7970 652c 206c 696e 6577 6964  le_type, linewid
+00062e50: 7468 203d 206c 696e 6577 6964 7468 2920  th = linewidth) 
+00062e60: 0d0a 0909 0909 0965 6c73 653a 0d0a 0909  .......else:....
+00062e70: 0909 0909 6966 2064 6174 615f 616e 645f  ....if data_and_
+00062e80: 6669 743a 0d0a 0909 0909 0909 0961 7820  fit:.........ax 
+00062e90: 3d20 706c 6f74 3164 2872 655b 2741 275d  = plot1d(re['A']
+00062ea0: 2c20 636d 6170 203d 2063 6f6c 6f72 732c  , cmap = colors,
+00062eb0: 2061 7820 3d20 6178 2c20 7761 7665 6c65   ax = ax, wavele
+00062ec0: 6e67 7468 203d 2072 656c 5f77 6176 652c  ngth = rel_wave,
+00062ed0: 2077 6964 7468 203d 2077 6964 7468 2c20   width = width, 
+00062ee0: 0d0a 0909 0909 0909 0909 0909 0974 6974  .............tit
+00062ef0: 6c65 203d 2027 272c 206c 696e 6573 5f61  le = '', lines_a
+00062f00: 7265 203d 2027 6461 7461 272c 2073 7562  re = 'data', sub
+00062f10: 706c 6f74 203d 2054 7275 652c 2063 6f6c  plot = True, col
+00062f20: 6f72 5f6f 6666 7365 7420 3d20 636f 6c6f  or_offset = colo
+00062f30: 725f 6f66 6673 6574 2c20 0d0a 0909 0909  r_offset, ......
+00062f40: 0909 0909 0909 0970 6c6f 745f 7479 7065  .......plot_type
+00062f50: 203d 2073 6361 6c65 5f74 7970 652c 206c   = scale_type, l
+00062f60: 696e 6577 6964 7468 203d 206c 696e 6577  inewidth = linew
+00062f70: 6964 7468 290d 0a09 0909 0909 0961 7820  idth)........ax 
+00062f80: 3d20 706c 6f74 3164 2872 655b 2741 4327  = plot1d(re['AC'
+00062f90: 5d2c 2063 6d61 7020 3d20 636f 6c6f 7273  ], cmap = colors
+00062fa0: 2c20 6178 203d 2061 782c 2077 6176 656c  , ax = ax, wavel
+00062fb0: 656e 6774 6820 3d20 7265 6c5f 7761 7665  ength = rel_wave
+00062fc0: 2c20 7769 6474 6820 3d20 7769 6474 682c  , width = width,
+00062fd0: 200d 0a09 0909 0909 0909 0909 0974 6974   ............tit
+00062fe0: 6c65 203d 2027 272c 206c 696e 6573 5f61  le = '', lines_a
+00062ff0: 7265 203d 2027 6669 7474 6564 272c 2073  re = 'fitted', s
+00063000: 7562 706c 6f74 203d 2054 7275 652c 2063  ubplot = True, c
+00063010: 6f6c 6f72 5f6f 6666 7365 7420 3d20 636f  olor_offset = co
+00063020: 6c6f 725f 6f66 6673 6574 2c20 0d0a 0909  lor_offset, ....
+00063030: 0909 0909 0909 0909 706c 6f74 5f74 7970  ........plot_typ
+00063040: 6520 3d20 7363 616c 655f 7479 7065 2c20  e = scale_type, 
+00063050: 6c69 6e65 7769 6474 6820 3d20 6c69 6e65  linewidth = line
+00063060: 7769 6474 6829 0d0a 0909 0909 0966 6f72  width).......for
+00063070: 2065 6e74 2069 6e20 7265 6c5f 7761 7665   ent in rel_wave
+00063080: 3a0d 0a09 0909 0909 0969 6620 6461 7461  :........if data
+00063090: 5f61 6e64 5f66 6974 3a0d 0a09 0909 0909  _and_fit:.......
+000630a0: 0909 6c61 622e 6170 7065 6e64 2827 2567  ..lab.append('%g
+000630b0: 206e 6d27 2565 6e74 202b 2027 5f27 202b   nm'%ent + '_' +
+000630c0: 2073 7472 286f 2e66 696c 656e 616d 6529   str(o.filename)
+000630d0: 290d 0a09 0909 0909 096c 6162 2e61 7070  )........lab.app
+000630e0: 656e 6428 2725 6720 6e6d 2725 656e 7420  end('%g nm'%ent 
+000630f0: 2b20 275f 2720 2b20 7374 7228 6f2e 6669  + '_' + str(o.fi
+00063100: 6c65 6e61 6d65 2929 0d0a 0909 0909 0968  lename)).......h
+00063110: 616e 646c 6573 2c20 6c61 6265 6c73 3d61  andles, labels=a
+00063120: 782e 6765 745f 6c65 6765 6e64 5f68 616e  x.get_legend_han
+00063130: 646c 6573 5f6c 6162 656c 7328 290d 0a09  dles_labels()...
+00063140: 0909 0909 6966 2064 6174 615f 616e 645f  ....if data_and_
+00063150: 6669 743a 0d0a 0909 0909 0909 666f 7220  fit:........for 
+00063160: 6120 696e 2068 616e 646c 6573 5b2d 322a  a in handles[-2*
+00063170: 6c65 6e28 7265 6c5f 7761 7665 293a 5d3a  len(rel_wave):]:
+00063180: 0d0a 0909 0909 0909 0968 616e 642e 6170  .........hand.ap
+00063190: 7065 6e64 2861 290d 0a09 0909 0909 656c  pend(a).......el
+000631a0: 7365 3a0d 0a09 0909 0909 0966 6f72 2061  se:........for a
+000631b0: 2069 6e20 6861 6e64 6c65 735b 2d6c 656e   in handles[-len
+000631c0: 2872 656c 5f77 6176 6529 3a5d 3a0d 0a09  (rel_wave):]:...
+000631d0: 0909 0909 0909 6861 6e64 2e61 7070 656e  ......hand.appen
+000631e0: 6428 6129 0d0a 0909 0969 6620 6e6f 726d  d(a).....if norm
+000631f0: 5f77 696e 646f 7720 6973 206e 6f74 204e  _window is not N
+00063200: 6f6e 653a 0d0a 0909 0909 200d 0a09 0909  one:...... .....
+00063210: 0961 782e 7365 745f 7469 746c 6528 2763  .ax.set_title('c
+00063220: 6f6d 7061 7265 206d 6561 7375 7265 6420  ompare measured 
+00063230: 616e 6420 6669 7474 6564 2064 6174 6120  and fitted data 
+00063240: 6174 2067 6976 656e 2077 6176 656c 656e  at given wavelen
+00063250: 6774 6820 5c6e 2073 6361 6c65 6420 746f  gth \n scaled to
+00063260: 2074 3d25 6720 7073 203a 2025 6720 7073   t=%g ps : %g ps
+00063270: 202c 2077 6c3d 2025 6720 6e6d 3a20 2567   , wl= %g nm: %g
+00063280: 206e 6d27 2528 6e6f 726d 5f77 696e 646f   nm'%(norm_windo
+00063290: 775b 305d 2c6e 6f72 6d5f 7769 6e64 6f77  w[0],norm_window
+000632a0: 5b31 5d2c 6e6f 726d 5f77 696e 646f 775b  [1],norm_window[
+000632b0: 325d 2c6e 6f72 6d5f 7769 6e64 6f77 5b33  2],norm_window[3
+000632c0: 5d29 290d 0a09 0909 656c 7365 3a0d 0a09  ])).....else:...
+000632d0: 0909 0961 782e 7365 745f 7469 746c 6528  ...ax.set_title(
+000632e0: 2763 6f6d 7061 7265 206d 6561 7375 7265  'compare measure
+000632f0: 6420 616e 6420 6669 7474 6564 2064 6174  d and fitted dat
+00063300: 6120 6174 2067 6976 656e 2077 6176 656c  a at given wavel
+00063310: 656e 6774 6827 290d 0a09 0909 6178 2e73  ength').....ax.s
+00063320: 6574 5f78 6c69 6d28 7265 5b27 4127 5d2e  et_xlim(re['A'].
+00063330: 696e 6465 782e 7661 6c75 6573 5b30 5d2c  index.values[0],
+00063340: 7265 5b27 4127 5d2e 696e 6465 782e 7661  re['A'].index.va
+00063350: 6c75 6573 5b2d 315d 290d 0a09 0909 6178  lues[-1]).....ax
+00063360: 2e6c 6567 656e 6428 6861 6e64 2c6c 6162  .legend(hand,lab
+00063370: 290d 0a09 0965 6c73 653a 0d0a 0909 0966  )....else:.....f
+00063380: 6967 2c20 6178 203d 2070 6c74 2e73 7562  ig, ax = plt.sub
+00063390: 706c 6f74 7328 6669 6773 697a 6520 3d20  plots(figsize = 
+000633a0: 2831 302c 2036 292c 2064 7069 203d 2031  (10, 6), dpi = 1
+000633b0: 3030 290d 0a09 0909 636f 6c6f 7273 203d  00).....colors =
+000633c0: 2063 6f6c 6d28 636d 6170 203d 2063 6d61   colm(cmap = cma
+000633d0: 702c 206b 203d 2072 616e 6765 286c 656e  p, k = range(len
+000633e0: 2872 656c 5f77 6176 6529 2a28 322b 6c65  (rel_wave)*(2+le
+000633f0: 6e28 6f74 6865 7229 2929 290d 0a09 0909  n(other)))).....
+00063400: 6966 206e 6f72 6d5f 7769 6e64 6f77 2069  if norm_window i
+00063410: 7320 6e6f 7420 4e6f 6e65 3a0d 0a09 0909  s not None:.....
+00063420: 0972 6566 5f73 6361 6c65 203d 2073 656c  .ref_scale = sel
+00063430: 662e 6473 2e6c 6f63 5b6e 6f72 6d5f 7769  f.ds.loc[norm_wi
+00063440: 6e64 6f77 5b30 5d3a 6e6f 726d 5f77 696e  ndow[0]:norm_win
+00063450: 646f 775b 315d 2c20 6e6f 726d 5f77 696e  dow[1], norm_win
+00063460: 646f 775b 325d 3a6e 6f72 6d5f 7769 6e64  dow[2]:norm_wind
+00063470: 6f77 5b33 5d5d 2e6d 6561 6e28 292e 6d65  ow[3]].mean().me
+00063480: 616e 2829 0d0a 0909 0961 7820 3d20 706c  an().....ax = pl
+00063490: 6f74 3164 2873 656c 662e 6473 2c20 636d  ot1d(self.ds, cm
+000634a0: 6170 203d 2063 6f6c 6f72 732c 2061 7820  ap = colors, ax 
+000634b0: 3d20 6178 2c20 7761 7665 6c65 6e67 7468  = ax, wavelength
+000634c0: 203d 2072 656c 5f77 6176 652c 2077 6964   = rel_wave, wid
+000634d0: 7468 203d 2077 6964 7468 2c20 7469 746c  th = width, titl
+000634e0: 6520 3d20 7365 6c66 2e66 696c 656e 616d  e = self.filenam
+000634f0: 652c 0d0a 0909 0909 0909 6261 7365 756e  e,........baseun
+00063500: 6974 203d 2073 656c 662e 6261 7365 756e  it = self.baseun
+00063510: 6974 2c20 6c69 6e65 735f 6172 6520 3d20  it, lines_are = 
+00063520: 2764 6174 6127 2c20 7363 6174 7465 7263  'data', scatterc
+00063530: 7574 203d 2073 656c 662e 7363 6174 7465  ut = self.scatte
+00063540: 7263 7574 2c20 0d0a 0909 0909 0909 626f  rcut, ........bo
+00063550: 7264 6572 6375 7420 3d20 7365 6c66 2e62  rdercut = self.b
+00063560: 6f72 6465 7263 7574 2c20 7375 6270 6c6f  ordercut, subplo
+00063570: 7420 3d20 4661 6c73 652c 2063 6f6c 6f72  t = False, color
+00063580: 5f6f 6666 7365 7420 3d20 302c 2074 696d  _offset = 0, tim
+00063590: 656c 696d 6974 7320 3d20 7365 6c66 2e74  elimits = self.t
+000635a0: 696d 656c 696d 6974 732c 200d 0a09 0909  imelimits, .....
+000635b0: 0909 0969 6e74 656e 7369 7479 5f72 616e  ...intensity_ran
+000635c0: 6765 203d 2073 656c 662e 696e 7465 6e73  ge = self.intens
+000635d0: 6974 795f 7261 6e67 652c 2070 6c6f 745f  ity_range, plot_
+000635e0: 7479 7065 203d 2073 6361 6c65 5f74 7970  type = scale_typ
+000635f0: 652c 206c 696e 6577 6964 7468 203d 206c  e, linewidth = l
+00063600: 696e 6577 6964 7468 290d 0a09 0909 6178  inewidth).....ax
+00063610: 203d 2070 6c6f 7431 6428 7365 6c66 2e64   = plot1d(self.d
+00063620: 732c 2063 6d61 7020 3d20 636f 6c6f 7273  s, cmap = colors
+00063630: 2c20 6178 203d 2061 782c 2077 6176 656c  , ax = ax, wavel
+00063640: 656e 6774 6820 3d20 7265 6c5f 7761 7665  ength = rel_wave
+00063650: 2c20 7769 6474 6820 3d20 7769 6474 682c  , width = width,
+00063660: 2074 6974 6c65 203d 2073 656c 662e 6669   title = self.fi
+00063670: 6c65 6e61 6d65 2c20 0d0a 0909 0909 0909  lename, ........
+00063680: 6261 7365 756e 6974 203d 2073 656c 662e  baseunit = self.
+00063690: 6261 7365 756e 6974 2c20 6c69 6e65 735f  baseunit, lines_
+000636a0: 6172 6520 3d20 2773 6d6f 6f74 6865 6427  are = 'smoothed'
+000636b0: 2c20 7363 6174 7465 7263 7574 203d 2073  , scattercut = s
+000636c0: 656c 662e 7363 6174 7465 7263 7574 2c20  elf.scattercut, 
+000636d0: 0d0a 0909 0909 0909 626f 7264 6572 6375  ........bordercu
+000636e0: 7420 3d20 7365 6c66 2e62 6f72 6465 7263  t = self.borderc
+000636f0: 7574 2c20 7375 6270 6c6f 7420 3d20 4661  ut, subplot = Fa
+00063700: 6c73 652c 2063 6f6c 6f72 5f6f 6666 7365  lse, color_offse
+00063710: 7420 3d20 302c 2074 696d 656c 696d 6974  t = 0, timelimit
+00063720: 7320 3d20 7365 6c66 2e74 696d 656c 696d  s = self.timelim
+00063730: 6974 732c 200d 0a09 0909 0909 0969 6e74  its, ........int
+00063740: 656e 7369 7479 5f72 616e 6765 203d 2073  ensity_range = s
+00063750: 656c 662e 696e 7465 6e73 6974 795f 7261  elf.intensity_ra
+00063760: 6e67 652c 2070 6c6f 745f 7479 7065 203d  nge, plot_type =
+00063770: 2073 6361 6c65 5f74 7970 652c 206c 696e   scale_type, lin
+00063780: 6577 6964 7468 203d 206c 696e 6577 6964  ewidth = linewid
+00063790: 7468 290d 0a09 0909 6966 2031 3a0d 0a09  th).....if 1:...
+000637a0: 0909 0968 616e 646c 6573 2c20 6c61 6265  ...handles, labe
+000637b0: 6c73 3d61 782e 6765 745f 6c65 6765 6e64  ls=ax.get_legend
+000637c0: 5f68 616e 646c 6573 5f6c 6162 656c 7328  _handles_labels(
+000637d0: 290d 0a09 0909 096c 6162 3d5b 2725 6720  )......lab=['%g 
+000637e0: 6e6d 2725 6120 2b20 275f 2720 2b20 7374  nm'%a + '_' + st
+000637f0: 7228 7365 6c66 2e66 696c 656e 616d 6529  r(self.filename)
+00063800: 2066 6f72 2061 2069 6e20 7265 6c5f 7761   for a in rel_wa
+00063810: 7665 5d0d 0a09 0909 0968 616e 643d 6861  ve]......hand=ha
+00063820: 6e64 6c65 735b 6c65 6e28 7265 6c5f 7761  ndles[len(rel_wa
+00063830: 7665 293a 5d0d 0a09 0909 0969 6620 6f74  ve):]......if ot
+00063840: 6865 7220 6973 206e 6f74 204e 6f6e 653a  her is not None:
+00063850: 0d0a 0909 0909 0966 6f72 2069 2c6f 2069  .......for i,o i
+00063860: 6e20 656e 756d 6572 6174 6528 6f74 6865  n enumerate(othe
+00063870: 7229 3a0d 0a09 0909 0909 0969 2b3d 310d  r):........i+=1.
+00063880: 0a09 0909 0909 0963 6f6c 6f72 5f6f 6666  .......color_off
+00063890: 7365 743d 2869 2b31 292a 6c65 6e28 7265  set=(i+1)*len(re
+000638a0: 6c5f 7761 7665 290d 0a09 0909 0909 0969  l_wave)........i
+000638b0: 6620 6e6f 726d 5f77 696e 646f 7720 6973  f norm_window is
+000638c0: 206e 6f74 204e 6f6e 653a 0d0a 0909 0909   not None:......
+000638d0: 0909 0972 656c 5f73 6361 6c65 3d6f 2e64  ...rel_scale=o.d
+000638e0: 732e 6c6f 635b 6e6f 726d 5f77 696e 646f  s.loc[norm_windo
+000638f0: 775b 305d 3a6e 6f72 6d5f 7769 6e64 6f77  w[0]:norm_window
+00063900: 5b31 5d2c 6e6f 726d 5f77 696e 646f 775b  [1],norm_window[
+00063910: 325d 3a6e 6f72 6d5f 7769 6e64 6f77 5b33  2]:norm_window[3
+00063920: 5d5d 2e6d 6561 6e28 292e 6d65 616e 2829  ]].mean().mean()
+00063930: 0d0a 0909 0909 0909 0974 7279 3a0d 0a09  .........try:...
+00063940: 0909 0909 0909 0973 6361 6c69 6e67 3d28  .......scaling=(
+00063950: 7265 6c5f 7363 616c 652f 7265 665f 7363  rel_scale/ref_sc
+00063960: 616c 6529 0d0a 0909 0909 0909 0909 6178  ale)..........ax
+00063970: 203d 2070 6c6f 7431 6428 6f2e 6473 2f73   = plot1d(o.ds/s
+00063980: 6361 6c69 6e67 2c20 636d 6170 203d 2063  caling, cmap = c
+00063990: 6f6c 6f72 732c 2061 7820 3d20 6178 2c20  olors, ax = ax, 
+000639a0: 7761 7665 6c65 6e67 7468 203d 2072 656c  wavelength = rel
+000639b0: 5f77 6176 652c 2077 6964 7468 203d 2077  _wave, width = w
+000639c0: 6964 7468 2c0d 0a09 0909 0909 0909 0909  idth,...........
+000639d0: 0909 7469 746c 6520 3d20 6f2e 6669 6c65  ..title = o.file
+000639e0: 6e61 6d65 2c20 6261 7365 756e 6974 203d  name, baseunit =
+000639f0: 2073 656c 662e 6261 7365 756e 6974 2c20   self.baseunit, 
+00063a00: 7469 6d65 6c69 6d69 7473 203d 2073 656c  timelimits = sel
+00063a10: 662e 7469 6d65 6c69 6d69 7473 2c0d 0a09  f.timelimits,...
+00063a20: 0909 0909 0909 0909 0909 6c69 6e65 735f  ..........lines_
+00063a30: 6172 6520 3d20 2764 6174 6127 2c20 7363  are = 'data', sc
+00063a40: 6174 7465 7263 7574 203d 2073 656c 662e  attercut = self.
+00063a50: 7363 6174 7465 7263 7574 2c20 626f 7264  scattercut, bord
+00063a60: 6572 6375 7420 3d20 7365 6c66 2e62 6f72  ercut = self.bor
+00063a70: 6465 7263 7574 2c0d 0a09 0909 0909 0909  dercut,.........
+00063a80: 0909 0909 7375 6270 6c6f 7420 3d20 5472  ....subplot = Tr
+00063a90: 7565 2c20 636f 6c6f 725f 6f66 6673 6574  ue, color_offset
+00063aa0: 203d 2063 6f6c 6f72 5f6f 6666 7365 742c   = color_offset,
+00063ab0: 200d 0a09 0909 0909 0909 0909 0909 696e   .............in
+00063ac0: 7465 6e73 6974 795f 7261 6e67 6520 3d20  tensity_range = 
+00063ad0: 7365 6c66 2e69 6e74 656e 7369 7479 5f72  self.intensity_r
+00063ae0: 616e 6765 2c20 706c 6f74 5f74 7970 6520  ange, plot_type 
+00063af0: 3d20 7363 616c 655f 7479 7065 2c20 6c69  = scale_type, li
+00063b00: 6e65 7769 6474 6820 3d20 6c69 6e65 7769  newidth = linewi
+00063b10: 6474 6829 0d0a 0909 0909 0909 0909 6178  dth)..........ax
+00063b20: 203d 2070 6c6f 7431 6428 6f2e 6473 2f73   = plot1d(o.ds/s
+00063b30: 6361 6c69 6e67 2c20 636d 6170 203d 2063  caling, cmap = c
+00063b40: 6f6c 6f72 732c 2061 7820 3d20 6178 2c20  olors, ax = ax, 
+00063b50: 7761 7665 6c65 6e67 7468 203d 2072 656c  wavelength = rel
+00063b60: 5f77 6176 652c 2077 6964 7468 203d 2077  _wave, width = w
+00063b70: 6964 7468 2c0d 0a09 0909 0909 0909 0909  idth,...........
+00063b80: 0909 7469 746c 6520 3d20 6f2e 6669 6c65  ..title = o.file
+00063b90: 6e61 6d65 2c20 6261 7365 756e 6974 203d  name, baseunit =
+00063ba0: 2073 656c 662e 6261 7365 756e 6974 2c20   self.baseunit, 
+00063bb0: 7469 6d65 6c69 6d69 7473 203d 2073 656c  timelimits = sel
+00063bc0: 662e 7469 6d65 6c69 6d69 7473 2c0d 0a09  f.timelimits,...
+00063bd0: 0909 0909 0909 0909 0909 6c69 6e65 735f  ..........lines_
+00063be0: 6172 6520 3d20 2773 6d6f 6f74 6865 6427  are = 'smoothed'
+00063bf0: 2c20 7363 6174 7465 7263 7574 203d 2073  , scattercut = s
+00063c00: 656c 662e 7363 6174 7465 7263 7574 2c20  elf.scattercut, 
+00063c10: 626f 7264 6572 6375 7420 3d20 7365 6c66  bordercut = self
+00063c20: 2e62 6f72 6465 7263 7574 2c0d 0a09 0909  .bordercut,.....
+00063c30: 0909 0909 0909 0909 7375 6270 6c6f 7420  ........subplot 
+00063c40: 3d20 5472 7565 2c20 636f 6c6f 725f 6f66  = True, color_of
+00063c50: 6673 6574 203d 2063 6f6c 6f72 5f6f 6666  fset = color_off
+00063c60: 7365 742c 200d 0a09 0909 0909 0909 0909  set, ...........
+00063c70: 0909 696e 7465 6e73 6974 795f 7261 6e67  ..intensity_rang
+00063c80: 6520 3d20 7365 6c66 2e69 6e74 656e 7369  e = self.intensi
+00063c90: 7479 5f72 616e 6765 2c20 706c 6f74 5f74  ty_range, plot_t
+00063ca0: 7970 6520 3d20 7363 616c 655f 7479 7065  ype = scale_type
+00063cb0: 2c20 6c69 6e65 7769 6474 6820 3d20 6c69  , linewidth = li
+00063cc0: 6e65 7769 6474 6829 0d0a 0909 0909 0909  newidth)........
+00063cd0: 0965 7863 6570 743a 0d0a 0909 0909 0909  .except:........
+00063ce0: 0909 7072 696e 7428 2773 6361 6c69 6e67  ..print('scaling
+00063cf0: 2066 6169 6c65 6427 290d 0a09 0909 0909   failed').......
+00063d00: 0909 0961 7820 3d20 706c 6f74 3164 286f  ...ax = plot1d(o
+00063d10: 2e64 732c 2063 6d61 7020 3d20 636f 6c6f  .ds, cmap = colo
+00063d20: 7273 2c20 6178 203d 2061 782c 2077 6176  rs, ax = ax, wav
+00063d30: 656c 656e 6774 6820 3d20 7265 6c5f 7761  elength = rel_wa
+00063d40: 7665 2c20 7769 6474 6820 3d20 7769 6474  ve, width = widt
+00063d50: 682c 0d0a 0909 0909 0909 0909 0909 0974  h,.............t
+00063d60: 6974 6c65 203d 206f 2e66 696c 656e 616d  itle = o.filenam
+00063d70: 652c 2062 6173 6575 6e69 7420 3d20 7365  e, baseunit = se
+00063d80: 6c66 2e62 6173 6575 6e69 742c 2074 696d  lf.baseunit, tim
+00063d90: 656c 696d 6974 7320 3d20 7365 6c66 2e74  elimits = self.t
+00063da0: 696d 656c 696d 6974 732c 0d0a 0909 0909  imelimits,......
+00063db0: 0909 0909 0909 096c 696e 6573 5f61 7265  .......lines_are
+00063dc0: 203d 2027 6461 7461 272c 2073 6361 7474   = 'data', scatt
+00063dd0: 6572 6375 7420 3d20 7365 6c66 2e73 6361  ercut = self.sca
+00063de0: 7474 6572 6375 742c 2062 6f72 6465 7263  ttercut, borderc
+00063df0: 7574 203d 2073 656c 662e 626f 7264 6572  ut = self.border
+00063e00: 6375 742c 0d0a 0909 0909 0909 0909 0909  cut,............
+00063e10: 0973 7562 706c 6f74 203d 2054 7275 652c  .subplot = True,
+00063e20: 2063 6f6c 6f72 5f6f 6666 7365 7420 3d20   color_offset = 
+00063e30: 636f 6c6f 725f 6f66 6673 6574 2c20 0d0a  color_offset, ..
+00063e40: 0909 0909 0909 0909 0909 0969 6e74 656e  ...........inten
+00063e50: 7369 7479 5f72 616e 6765 203d 2073 656c  sity_range = sel
+00063e60: 662e 696e 7465 6e73 6974 795f 7261 6e67  f.intensity_rang
+00063e70: 652c 2070 6c6f 745f 7479 7065 203d 2073  e, plot_type = s
+00063e80: 6361 6c65 5f74 7970 652c 206c 696e 6577  cale_type, linew
+00063e90: 6964 7468 203d 206c 696e 6577 6964 7468  idth = linewidth
+00063ea0: 290d 0a09 0909 0909 0909 0961 7820 3d20  )..........ax = 
+00063eb0: 706c 6f74 3164 286f 2e64 732c 2063 6d61  plot1d(o.ds, cma
+00063ec0: 7020 3d20 636f 6c6f 7273 2c20 6178 203d  p = colors, ax =
+00063ed0: 2061 782c 2077 6176 656c 656e 6774 6820   ax, wavelength 
+00063ee0: 3d20 7265 6c5f 7761 7665 2c20 7769 6474  = rel_wave, widt
+00063ef0: 6820 3d20 7769 6474 682c 0d0a 0909 0909  h = width,......
+00063f00: 0909 0909 0909 0974 6974 6c65 203d 206f  .......title = o
+00063f10: 2e66 696c 656e 616d 652c 2062 6173 6575  .filename, baseu
+00063f20: 6e69 7420 3d20 7365 6c66 2e62 6173 6575  nit = self.baseu
+00063f30: 6e69 742c 2074 696d 656c 696d 6974 7320  nit, timelimits 
+00063f40: 3d20 7365 6c66 2e74 696d 656c 696d 6974  = self.timelimit
+00063f50: 732c 0d0a 0909 0909 0909 0909 0909 096c  s,.............l
+00063f60: 696e 6573 5f61 7265 203d 2027 736d 6f6f  ines_are = 'smoo
+00063f70: 7468 6564 272c 2073 6361 7474 6572 6375  thed', scattercu
+00063f80: 7420 3d20 7365 6c66 2e73 6361 7474 6572  t = self.scatter
+00063f90: 6375 742c 2062 6f72 6465 7263 7574 203d  cut, bordercut =
+00063fa0: 2073 656c 662e 626f 7264 6572 6375 742c   self.bordercut,
+00063fb0: 0d0a 0909 0909 0909 0909 0909 0973 7562  .............sub
+00063fc0: 706c 6f74 203d 2054 7275 652c 2063 6f6c  plot = True, col
+00063fd0: 6f72 5f6f 6666 7365 7420 3d20 636f 6c6f  or_offset = colo
+00063fe0: 725f 6f66 6673 6574 2c20 0d0a 0909 0909  r_offset, ......
+00063ff0: 0909 0909 0909 0969 6e74 656e 7369 7479  .......intensity
+00064000: 5f72 616e 6765 203d 2073 656c 662e 696e  _range = self.in
+00064010: 7465 6e73 6974 795f 7261 6e67 652c 2070  tensity_range, p
+00064020: 6c6f 745f 7479 7065 203d 2073 6361 6c65  lot_type = scale
+00064030: 5f74 7970 652c 206c 696e 6577 6964 7468  _type, linewidth
+00064040: 203d 206c 696e 6577 6964 7468 290d 0a09   = linewidth)...
+00064050: 0909 0909 0965 6c73 653a 0d0a 0909 0909  .....else:......
+00064060: 0909 0961 7820 3d20 706c 6f74 3164 286f  ...ax = plot1d(o
+00064070: 2e64 732c 2063 6d61 7020 3d20 636f 6c6f  .ds, cmap = colo
+00064080: 7273 2c20 6178 203d 2061 782c 2077 6176  rs, ax = ax, wav
+00064090: 656c 656e 6774 6820 3d20 7265 6c5f 7761  elength = rel_wa
+000640a0: 7665 2c20 7769 6474 6820 3d20 7769 6474  ve, width = widt
+000640b0: 682c 2074 6974 6c65 203d 206f 2e66 696c  h, title = o.fil
+000640c0: 656e 616d 652c 0d0a 0909 0909 0909 0909  ename,..........
+000640d0: 0909 6261 7365 756e 6974 203d 2073 656c  ..baseunit = sel
+000640e0: 662e 6261 7365 756e 6974 2c20 7469 6d65  f.baseunit, time
+000640f0: 6c69 6d69 7473 203d 2073 656c 662e 7469  limits = self.ti
+00064100: 6d65 6c69 6d69 7473 2c20 6c69 6e65 735f  melimits, lines_
+00064110: 6172 6520 3d20 2764 6174 6127 2c0d 0a09  are = 'data',...
+00064120: 0909 0909 0909 0909 0973 6361 7474 6572  .........scatter
+00064130: 6375 7420 3d20 7365 6c66 2e73 6361 7474  cut = self.scatt
+00064140: 6572 6375 742c 2062 6f72 6465 7263 7574  ercut, bordercut
+00064150: 203d 2073 656c 662e 626f 7264 6572 6375   = self.bordercu
+00064160: 742c 2073 7562 706c 6f74 203d 2054 7275  t, subplot = Tru
+00064170: 652c 0d0a 0909 0909 0909 0909 0909 636f  e,............co
+00064180: 6c6f 725f 6f66 6673 6574 203d 2063 6f6c  lor_offset = col
+00064190: 6f72 5f6f 6666 7365 742c 2069 6e74 656e  or_offset, inten
+000641a0: 7369 7479 5f72 616e 6765 203d 2073 656c  sity_range = sel
+000641b0: 662e 696e 7465 6e73 6974 795f 7261 6e67  f.intensity_rang
+000641c0: 652c 200d 0a09 0909 0909 0909 0909 0970  e, ............p
+000641d0: 6c6f 745f 7479 7065 203d 2073 6361 6c65  lot_type = scale
+000641e0: 5f74 7970 652c 206c 696e 6577 6964 7468  _type, linewidth
+000641f0: 203d 206c 696e 6577 6964 7468 290d 0a09   = linewidth)...
+00064200: 0909 0909 0909 6178 203d 2070 6c6f 7431  ......ax = plot1
+00064210: 6428 6f2e 6473 2c20 636d 6170 203d 2063  d(o.ds, cmap = c
+00064220: 6f6c 6f72 732c 2061 7820 3d20 6178 2c20  olors, ax = ax, 
+00064230: 7761 7665 6c65 6e67 7468 203d 2072 656c  wavelength = rel
+00064240: 5f77 6176 652c 2077 6964 7468 203d 2077  _wave, width = w
+00064250: 6964 7468 2c20 7469 746c 6520 3d20 6f2e  idth, title = o.
+00064260: 6669 6c65 6e61 6d65 2c0d 0a09 0909 0909  filename,.......
+00064270: 0909 0909 0962 6173 6575 6e69 7420 3d20  .....baseunit = 
+00064280: 7365 6c66 2e62 6173 6575 6e69 742c 2074  self.baseunit, t
+00064290: 696d 656c 696d 6974 7320 3d20 7365 6c66  imelimits = self
+000642a0: 2e74 696d 656c 696d 6974 732c 206c 696e  .timelimits, lin
+000642b0: 6573 5f61 7265 203d 2027 736d 6f6f 7468  es_are = 'smooth
+000642c0: 6564 272c 0d0a 0909 0909 0909 0909 0909  ed',............
+000642d0: 7363 6174 7465 7263 7574 203d 2073 656c  scattercut = sel
+000642e0: 662e 7363 6174 7465 7263 7574 2c20 626f  f.scattercut, bo
+000642f0: 7264 6572 6375 7420 3d20 7365 6c66 2e62  rdercut = self.b
+00064300: 6f72 6465 7263 7574 2c20 7375 6270 6c6f  ordercut, subplo
+00064310: 7420 3d20 5472 7565 2c0d 0a09 0909 0909  t = True,.......
+00064320: 0909 0909 0963 6f6c 6f72 5f6f 6666 7365  .....color_offse
+00064330: 7420 3d20 636f 6c6f 725f 6f66 6673 6574  t = color_offset
+00064340: 2c20 696e 7465 6e73 6974 795f 7261 6e67  , intensity_rang
+00064350: 6520 3d20 7365 6c66 2e69 6e74 656e 7369  e = self.intensi
+00064360: 7479 5f72 616e 6765 2c20 0d0a 0909 0909  ty_range, ......
+00064370: 0909 0909 0909 706c 6f74 5f74 7970 6520  ......plot_type 
+00064380: 3d20 7363 616c 655f 7479 7065 2c20 6c69  = scale_type, li
+00064390: 6e65 7769 6474 6820 3d20 6c69 6e65 7769  newidth = linewi
+000643a0: 6474 6829 0d0a 0909 0909 0909 666f 7220  dth)........for 
+000643b0: 656e 7420 696e 205b 2725 6720 6e6d 2725  ent in ['%g nm'%
+000643c0: 6120 2b20 275f 2720 2b20 7374 7228 6f2e  a + '_' + str(o.
+000643d0: 6669 6c65 6e61 6d65 2920 666f 7220 6120  filename) for a 
+000643e0: 696e 2072 656c 5f77 6176 655d 3a0d 0a09  in rel_wave]:...
+000643f0: 0909 0909 0909 6c61 622e 6170 7065 6e64  ......lab.append
+00064400: 2865 6e74 290d 0a09 0909 0909 0968 616e  (ent)........han
+00064410: 646c 6573 2c20 6c61 6265 6c73 3d61 782e  dles, labels=ax.
+00064420: 6765 745f 6c65 6765 6e64 5f68 616e 646c  get_legend_handl
+00064430: 6573 5f6c 6162 656c 7328 290d 0a09 0909  es_labels().....
+00064440: 0909 0966 6f72 2068 6120 696e 2068 616e  ...for ha in han
+00064450: 646c 6573 5b2d 6c65 6e28 7265 6c5f 7761  dles[-len(rel_wa
+00064460: 7665 293a 5d3a 0d0a 0909 0909 0909 0968  ve):]:.........h
+00064470: 616e 642e 6170 7065 6e64 2868 6129 0d0a  and.append(ha)..
+00064480: 0909 0909 6178 2e73 6574 5f74 6974 6c65  ....ax.set_title
+00064490: 2827 636f 6d70 6172 6520 6d65 6173 7572  ('compare measur
+000644a0: 6564 2061 6e64 2073 6d6f 6f74 6865 6420  ed and smoothed 
+000644b0: 6461 7461 2061 7420 6769 7665 6e20 7761  data at given wa
+000644c0: 7665 6c65 6e67 7468 2729 0d0a 0909 0909  velength')......
+000644d0: 6966 206e 6f72 6d5f 7769 6e64 6f77 2069  if norm_window i
+000644e0: 7320 6e6f 7420 4e6f 6e65 3a0d 0a09 0909  s not None:.....
+000644f0: 0909 6178 2e73 6574 5f74 6974 6c65 2827  ..ax.set_title('
+00064500: 636f 6d70 6172 6520 6d65 6173 7572 6564  compare measured
+00064510: 2061 6e64 2073 6d6f 6f74 6865 6420 6461   and smoothed da
+00064520: 7461 2061 7420 6769 7665 6e20 7761 7665  ta at given wave
+00064530: 6c65 6e67 7468 205c 6e20 7363 616c 6564  length \n scaled
+00064540: 2074 6f20 743d 2567 2070 7320 3a20 2567   to t=%g ps : %g
+00064550: 2070 7320 2c20 776c 3d20 2567 206e 6d3a   ps , wl= %g nm:
+00064560: 2025 6720 6e6d 2725 286e 6f72 6d5f 7769   %g nm'%(norm_wi
+00064570: 6e64 6f77 5b30 5d2c 6e6f 726d 5f77 696e  ndow[0],norm_win
+00064580: 646f 775b 315d 2c6e 6f72 6d5f 7769 6e64  dow[1],norm_wind
+00064590: 6f77 5b32 5d2c 6e6f 726d 5f77 696e 646f  ow[2],norm_windo
+000645a0: 775b 335d 2929 0d0a 0909 0909 6178 2e6c  w[3]))......ax.l
+000645b0: 6567 656e 6428 6861 6e64 2c6c 6162 290d  egend(hand,lab).
+000645c0: 0a09 0969 6620 7365 6c66 2e73 6176 655f  ...if self.save_
+000645d0: 6669 6775 7265 735f 746f 5f66 6f6c 6465  figures_to_folde
+000645e0: 723a 2020 0d0a 0909 0966 6967 2e73 6176  r:  .....fig.sav
+000645f0: 6566 6967 2863 6865 636b 5f66 6f6c 6465  efig(check_folde
+00064600: 7228 7061 7468 3d73 656c 662e 6669 6775  r(path=self.figu
+00064610: 7265 5f70 6174 682c 6669 6c65 6e61 6d65  re_path,filename
+00064620: 3d27 636f 6d70 6172 655f 6174 5f77 6176  ='compare_at_wav
+00064630: 655f 2573 2e70 6e67 2725 275f 272e 6a6f  e_%s.png'%'_'.jo
+00064640: 696e 285b 2725 6727 2561 2066 6f72 2061  in(['%g'%a for a
+00064650: 2069 6e20 7265 6c5f 7761 7665 5d29 292c   in rel_wave])),
+00064660: 0d0a 0909 0962 626f 785f 696e 6368 6573  .....bbox_inches
+00064670: 3d27 7469 6768 7427 290d 0a09 0909 7265  ='tight').....re
+00064680: 7475 726e 2061 780d 0a0d 0a0d 0a09 6465  turn ax.......de
+00064690: 6620 436f 6d70 6172 655f 4441 4328 7365  f Compare_DAC(se
+000646a0: 6c66 2c20 6f74 6865 7220 3d20 4e6f 6e65  lf, other = None
+000646b0: 2c20 7370 6563 7472 6120 3d20 4e6f 6e65  , spectra = None
+000646c0: 2c20 7365 7061 7261 7465 5f70 6c6f 7473  , separate_plots
+000646d0: 203d 2046 616c 7365 2c20 636d 6170 203d   = False, cmap =
+000646e0: 204e 6f6e 6529 3a0d 0a09 0927 2727 5468   None):....'''Th
+000646f0: 6973 2069 7320 6120 636f 6e76 656e 6965  is is a convenie
+00064700: 6e63 6520 6675 6e63 7469 6f6e 2074 6f20  nce function to 
+00064710: 706c 6f74 206d 756c 7469 706c 6520 6578  plot multiple ex
+00064720: 7472 6163 7465 6420 7370 6563 7472 6120  tracted spectra 
+00064730: 0d0a 0909 2844 4153 206f 7220 7370 6563  ....(DAS or spec
+00064740: 6965 7320 6173 736f 6369 6174 6564 2920  ies associated) 
+00064750: 696e 746f 2074 6865 2073 616d 6520 6669  into the same fi
+00064760: 6775 7265 206f 7220 696e 746f 2061 2073  gure or into a s
+00064770: 6570 6172 6174 6520 6669 6775 7265 0d0a  eparate figure..
+00064780: 0909 6561 6368 2e20 4f74 6865 7220 7368  ..each. Other sh
+00064790: 6f75 6c64 2062 6520 7461 2e70 6c6f 745f  ould be ta.plot_
+000647a0: 6675 6e63 206f 626a 6563 7473 2028 6c6f  func objects (lo
+000647b0: 6164 6564 206f 7220 636f 7069 6564 292e  aded or copied).
+000647c0: 2042 790d 0a09 0973 7461 6e64 6172 6420   By....standard 
+000647d0: 6974 2070 6c6f 7473 2061 6c6c 2069 6e74  it plots all int
+000647e0: 6f20 7468 6520 7361 6d65 2077 696e 646f  o the same windo
+000647f0: 772e 2049 6620 616c 6c20 7072 6f6a 6563  w. If all projec
+00064800: 7420 6861 7665 2074 6865 2073 616d 650d  t have the same.
+00064810: 0a09 096e 756d 6265 7220 6f66 2063 6f6d  ...number of com
+00064820: 706f 6e65 6e74 7320 6f6e 6520 6361 6e20  ponents one can 
+00064830: 6163 7469 7661 7465 2022 7365 7061 7261  activate "separa
+00064840: 7465 5f70 6c6f 7473 2220 616e 6420 6861  te_plots" and ha
+00064850: 7665 2065 6163 680d 0a09 0973 6570 6172  ve each....separ
+00064860: 6174 6564 2028 696e 2074 6865 206f 7264  ated (in the ord
+00064870: 6572 2063 7265 6174 6564 2069 6e20 7468  er created in th
+00064880: 6520 7072 6f6a 6563 7473 292e 0d0a 0d0a  e projects).....
+00064890: 0909 5468 6520 2253 7065 6374 7261 2220  ..The "Spectra" 
+000648a0: 7061 7261 6d65 7465 7220 616c 6c6f 7773  parameter allows
+000648b0: 2061 7320 6265 666f 7265 2074 6865 2069   as before the i
+000648c0: 6e63 6c75 7369 6f6e 206f 6620 616e 2065  nclusion of an e
+000648d0: 7874 6572 6e61 6c0d 0a09 0973 7065 6374  xternal....spect
+000648e0: 7275 6d2e 204f 7468 6572 7320 6973 206f  rum. Others is o
+000648f0: 7074 696f 6e61 6c20 616e 6420 4920 7573  ptional and I us
+00064900: 6520 7468 6973 2066 756e 6374 696f 6e20  e this function 
+00064910: 6f66 7465 6e20 746f 2063 6f6d 7061 7265  often to compare
+00064920: 0d0a 0909 7370 6563 6965 7320 6173 736f  ....species asso
+00064930: 6369 6174 6564 2073 7065 6374 7261 2077  ciated spectra w
+00064940: 6974 6820 6f6e 6520 6f72 206d 756c 7469  ith one or multi
+00064950: 706c 6520 7374 6561 6479 2073 7461 7465  ple steady state
+00064960: 2073 7065 6374 7261 2e0d 0a09 090d 0a09   spectra........
+00064970: 0950 6172 616d 6574 6572 730d 0a09 092d  .Parameters....-
+00064980: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a09  -------------...
+00064990: 0909 0d0a 0909 6f74 6865 7220 3a20 5441  ......other : TA
+000649a0: 206f 626a 6563 7420 6f72 206c 6973 7420   object or list 
+000649b0: 6f66 2074 686f 7365 2c20 6f70 7469 6f6e  of those, option
+000649c0: 616c 200d 0a09 0909 7368 6f75 6c64 2062  al .....should b
+000649d0: 6520 7461 2e70 6c6f 745f 6675 6e63 206f  e ta.plot_func o
+000649e0: 626a 6563 7473 2028 6c6f 6164 6564 206f  bjects (loaded o
+000649f0: 7220 636f 7069 6564 2920 616e 6420 6973  r copied) and is
+00064a00: 2077 6861 7420 0d0a 0909 0969 7320 706c   what .....is pl
+00064a10: 6f74 7465 6420 6167 6169 6e73 7420 7468  otted against th
+00064a20: 6520 6461 7461 2075 7365 2061 206c 6973  e data use a lis
+00064a30: 7420 5b74 6131 2c74 6132 2c2e 2e2e 205d  t [ta1,ta2,... ]
+00064a40: 206f 7220 6765 6e65 7261 7465 2074 6869   or generate thi
+00064a50: 730d 0a09 0909 6c69 7374 2075 7369 6e67  s.....list using
+00064a60: 2074 6865 2047 7569 2066 756e 6374 696f   the Gui functio
+00064a70: 6e2e 2053 6565 2073 6563 7469 6f6e 203a  n. See section :
+00064a80: 7265 663a 604f 7065 6e69 6e67 206d 756c  ref:`Opening mul
+00064a90: 7469 706c 6520 6669 6c65 7360 2069 6e20  tiple files` in 
+00064aa0: 0d0a 0909 0974 6865 2064 6f63 756d 656e  .....the documen
+00064ab0: 7461 7469 6f6e 0d0a 0d0a 0909 7370 6563  tation......spec
+00064ac0: 7472 6120 3a20 4e6f 6e65 206f 7220 4461  tra : None or Da
+00064ad0: 7461 4672 616d 652c 206f 7074 696f 6e61  taFrame, optiona
+00064ae0: 6c0d 0a09 0909 4966 2061 6e20 4461 7461  l.....If an Data
+00064af0: 4672 616d 6520 7769 7468 2074 6865 2077  Frame with the w
+00064b00: 6176 656c 656e 6774 6820 6173 2069 6e64  avelength as ind
+00064b10: 6578 2069 7320 7072 6f76 6964 6564 2c20  ex is provided, 
+00064b20: 5468 656e 2074 6865 2073 7065 6374 7261  Then the spectra
+00064b30: 206f 6620 6561 6368 2063 6f6c 756d 6e0d   of each column.
+00064b40: 0a09 0909 6973 2070 6c6f 7474 6564 2069  ....is plotted i
+00064b50: 6e74 6f20 7468 6520 6469 6666 6572 656e  nto the differen
+00064b60: 7469 616c 2073 7065 6374 7261 2031 3a31  tial spectra 1:1
+00064b70: 2061 6e64 2074 6865 2063 6f6c 756d 6e20   and the column 
+00064b80: 6e61 6d65 7320 6172 6520 7573 6564 2069  names are used i
+00064b90: 6e20 7468 6520 6c65 6765 6e64 0d0a 0909  n the legend....
+00064ba0: 0950 7269 6f72 2073 6361 6c69 6e67 2069  .Prior scaling i
+00064bb0: 7320 6869 6768 6c79 2073 7567 6765 7374  s highly suggest
+00064bc0: 6564 2e20 5468 6573 6520 7370 6563 7472  ed. These spectr
+00064bd0: 6120 6172 6520 6e6f 7420 2869 6e20 6765  a are not (in ge
+00064be0: 6e65 7261 6c29 2073 6361 6c65 6420 7769  neral) scaled wi
+00064bf0: 7468 2074 6865 200d 0a09 0909 6e6f 726d  th the .....norm
+00064c00: 2077 696e 646f 772e 2028 7365 6520 6578   window. (see ex
+00064c10: 616d 706c 6573 290d 0a0d 0a09 0973 6570  amples)......sep
+00064c20: 6172 6174 655f 706c 6f74 7320 3a20 626f  arate_plots : bo
+00064c30: 6f6c 2c20 6f70 7469 6f6e 616c 0d0a 0909  ol, optional....
+00064c40: 0954 7275 6520 6f72 2046 616c 7365 2028  .True or False (
+00064c50: 4465 6661 756c 7429 2c20 7365 7061 7261  Default), separa
+00064c60: 7465 2070 6c6f 7473 2069 7320 7468 6520  te plots is the 
+00064c70: 7377 6974 6368 2074 6861 7420 6465 6369  switch that deci
+00064c80: 6465 7320 6966 2061 2061 7869 7320 6f72  des if a axis or
+00064c90: 200d 0a09 0909 6d75 6c74 6970 6c65 2061   .....multiple a
+00064ca0: 7869 7320 6172 6520 7573 6564 2e20 5468  xis are used. Th
+00064cb0: 6973 206f 7074 696f 6e20 7769 6c6c 2072  is option will r
+00064cc0: 6573 756c 7420 696e 2061 2063 7261 7368  esult in a crash
+00064cd0: 2075 6e6c 6573 7320 616c 6c20 6f62 6a65   unless all obje
+00064ce0: 6374 7320 6861 7665 2074 6865 0d0a 0909  cts have the....
+00064cf0: 0973 616d 6520 6e75 6d62 6572 206f 6620  .same number of 
+00064d00: 4441 532f 5341 5320 636f 6d70 6f6e 656e  DAS/SAS componen
+00064d10: 7473 0d0a 0909 0909 0d0a 0909 636d 6170  ts..........cmap
+00064d20: 203a 204e 6f6e 6520 6f72 206d 6174 706c   : None or matpl
+00064d30: 6f74 6c69 6220 636f 6c6f 7220 6d61 702c  otlib color map,
+00064d40: 206f 7074 696f 6e61 6c0d 0a09 0909 6973   optional.....is
+00064d50: 2061 2070 6f77 6572 6675 6c6c 2076 6172   a powerfull var
+00064d60: 6961 626c 6520 7468 6174 2063 686f 6f73  iable that choos
+00064d70: 6573 2074 6865 2063 6f6c 6f75 7220 6d61  es the colour ma
+00064d80: 7020 6170 706c 6965 6420 666f 7220 616c  p applied for al
+00064d90: 6c20 706c 6f74 732e 2049 6620 7365 7420  l plots. If set 
+00064da0: 746f 200d 0a09 0909 4e6f 6e65 2028 4465  to .....None (De
+00064db0: 6661 756c 7429 2074 6865 6e20 7468 6520  fault) then the 
+00064dc0: 7365 6c66 2e63 6d61 7020 6973 2075 7365  self.cmap is use
+00064dd0: 642e 0d0a 0909 0941 7320 7374 616e 6461  d......As standa
+00064de0: 7264 2049 2075 7365 2074 6865 2063 6f6c  rd I use the col
+00064df0: 6f72 206d 6170 2022 6a65 7422 2066 726f  or map "jet" fro
+00064e00: 6d20 6d61 7470 6c6f 746c 6962 2e20 5468  m matplotlib. Th
+00064e10: 6572 6520 6172 6520 6120 7661 7269 6574  ere are a variet
+00064e20: 7920 6f66 2063 6f6c 6f72 6d61 7073 200d  y of colormaps .
+00064e30: 0a09 0909 6176 6169 6c61 626c 6520 7468  ....available th
+00064e40: 6174 2061 7265 2076 6572 7920 7573 6566  at are very usef
+00064e50: 756c 6c2e 2042 6573 6964 6520 226a 6574  ull. Beside "jet
+00064e60: 222c 2022 7669 7269 6469 7322 2069 7320  ", "viridis" is 
+00064e70: 6120 676f 6f64 2063 686f 6963 6520 6173  a good choice as
+00064e80: 2069 7420 6973 2077 656c 6c20 0d0a 0909   it is well ....
+00064e90: 0976 6973 6962 6c65 2075 6e64 6572 2072  .visible under r
+00064ea0: 6564 2d67 7265 656e 2062 6c69 6e64 6e65  ed-green blindne
+00064eb0: 7373 2e20 4f74 6865 7220 7573 6566 756c  ss. Other useful
+00064ec0: 206d 6170 7320 6172 6520 2270 7269 736d   maps are "prism
+00064ed0: 2220 666f 7220 6869 6768 2066 6c75 6374  " for high fluct
+00064ee0: 7561 7469 6f6e 7320 0d0a 0909 096f 7220  uations .....or 
+00064ef0: 6469 7665 7267 696e 6720 636f 6c6f 7220  diverging color 
+00064f00: 6d61 7073 206c 696b 6520 2273 6569 736d  maps like "seism
+00064f10: 6963 222e 200d 0a09 0909 5365 6520 6874  ic". .....See ht
+00064f20: 7470 733a 2f2f 6d61 7470 6c6f 746c 6962  tps://matplotlib
+00064f30: 2e6f 7267 2f33 2e31 2e30 2f74 7574 6f72  .org/3.1.0/tutor
+00064f40: 6961 6c73 2f63 6f6c 6f72 732f 636f 6c6f  ials/colors/colo
+00064f50: 726d 6170 732e 6874 6d6c 2066 6f72 2061  rmaps.html for a
+00064f60: 2063 6f6d 7072 6568 656e 7369 7665 200d   comprehensive .
+00064f70: 0a09 0909 7365 6c65 6374 696f 6e2e 2049  ....selection. I
+00064f80: 6e20 7468 6520 636f 6465 2074 6865 2063  n the code the c
+00064f90: 6f6c 6f72 6d61 7073 2061 7265 2069 6d70  olormaps are imp
+00064fa0: 6f72 7465 6420 736f 2069 6620 706c 6f74  orted so if plot
+00064fb0: 5f66 756e 6320 6973 2069 6d70 6f72 7465  _func is importe
+00064fc0: 6420 6173 2070 6620 7468 656e 200d 0a09  d as pf then ...
+00064fd0: 0909 7365 6c66 2e63 6d61 703d 7066 2e63  ..self.cmap=pf.c
+00064fe0: 6d2e 7669 7269 6469 7320 7365 7473 2076  m.viridis sets v
+00064ff0: 6972 6964 6973 2061 7320 7468 6520 6d61  iridis as the ma
+00065000: 7020 746f 2075 7365 2e20 496e 7465 726e  p to use. Intern
+00065010: 616c 6c79 2074 6865 2063 6f6c 6f72 7320  ally the colors 
+00065020: 6172 6520 6368 6f73 656e 200d 0a09 0909  are chosen .....
+00065030: 7769 7468 2074 6865 2022 636f 6c6d 2220  with the "colm" 
+00065040: 6675 6e63 7469 6f6e 2e20 5468 6520 3264  function. The 2d
+00065050: 2070 6c6f 7473 2072 6571 7569 7265 2061   plots require a
+00065060: 2063 6f6e 7469 6e75 6f75 7320 636f 6c6f   continuous colo
+00065070: 7220 6d61 7020 736f 2069 6620 736f 6d65  r map so if some
+00065080: 7468 696e 6720 0d0a 0909 0965 6c73 6520  thing .....else 
+00065090: 6973 2067 6976 6520 3264 2070 6c6f 7473  is give 2d plots
+000650a0: 2061 7265 2073 686f 776e 2061 7574 6f6d   are shown autom
+000650b0: 6174 6963 616c 6c79 2077 6974 6820 226a  atically with "j
+000650c0: 6574 222e 2046 6f72 2061 6c6c 206f 6620  et". For all of 
+000650d0: 7468 6520 3164 2070 6c6f 7473 2068 6f77  the 1d plots how
+000650e0: 6576 6572 200d 0a09 0909 4920 6669 7273  ever .....I firs
+000650f0: 7420 7365 6c65 6374 2061 206e 756d 6265  t select a numbe
+00065100: 7220 6f66 2063 6f6c 6f72 7320 6265 666f  r of colors befo
+00065110: 7265 2065 6163 6820 706c 6f74 2e20 4966  re each plot. If
+00065120: 2063 6d61 7020 6973 2061 2063 6f6e 7469   cmap is a conti
+00065130: 6e6f 7573 206d 6170 2074 6865 6e20 7468  nous map then th
+00065140: 6573 650d 0a09 0909 6172 6520 7361 6d70  ese.....are samp
+00065150: 6c65 6420 6576 656e 6c79 206f 7665 7220  led evenly over 
+00065160: 7468 6520 636f 6c6f 7572 6d61 702e 204d  the colourmap. M
+00065170: 616e 7561 6c20 6974 6572 6162 6c65 7320  anual iterables 
+00065180: 6f66 2063 6f6c 6f75 7273 200d 0a09 0909  of colours .....
+00065190: 636d 6170 3d5b 2831 2c30 2c30 292c 2830  cmap=[(1,0,0),(0
+000651a0: 2c31 2c30 292c 2830 2c30 2c31 292c 2e2e  ,1,0),(0,0,1),..
+000651b0: 2e5d 2061 7265 2061 6c73 6f20 6163 6365  .] are also acce
+000651c0: 7074 6564 2c20 6173 2061 7265 2076 6563  pted, as are vec
+000651d0: 746f 7273 206f 7220 6461 7461 6672 616d  tors or datafram
+000651e0: 6573 2074 6861 7420 0d0a 0909 0963 6f6e  es that .....con
+000651f0: 7461 696e 2061 7320 726f 7773 2074 6865  tain as rows the
+00065200: 2063 6f6c 6f72 732e 2054 6865 7265 206d   colors. There m
+00065210: 7573 7420 6265 206f 6620 636f 7572 7365  ust be of course
+00065220: 2073 7566 6669 6369 656e 7420 636f 6c6f   sufficient colo
+00065230: 7273 2070 7265 7365 6e74 2066 6f72 200d  rs present for .
+00065240: 0a09 0909 7468 6520 6e75 6d62 6572 7320  ....the numbers 
+00065250: 6f66 206c 696e 6573 2074 6861 7420 7769  of lines that wi
+00065260: 6c6c 2062 6520 706c 6f74 7465 642e 2053  ll be plotted. S
+00065270: 6f20 4920 7265 636f 6d6d 656e 6420 746f  o I recommend to
+00065280: 2070 726f 7669 6465 2061 7420 6c65 6173   provide at leas
+00065290: 7420 3130 2063 6f6c 6f75 7273 200d 0a09  t 10 colours ...
+000652a0: 0909 2865 2e67 2e7e 796f 7572 2075 6e69  ..(e.g.~your uni
+000652b0: 7665 7273 6974 7920 636f 6c6f 7273 292e  versity colors).
+000652c0: 2063 6f6c 6f75 7273 2061 7265 2061 6c77   colours are alw
+000652d0: 6179 7320 6769 7665 6e20 6173 2061 2c20  ays given as a, 
+000652e0: 6c69 7374 206f 7220 7475 706c 6520 7769  list or tuple wi
+000652f0: 7468 2052 4741 206f 7220 5247 4241 0d0a  th RGA or RGBA..
+00065300: 0909 0928 7769 7468 2074 6865 206c 6173  ...(with the las
+00065310: 7420 4120 6265 6569 6e67 2074 6865 2041  t A beeing the A
+00065320: 6c70 6861 3d74 7261 6e73 7061 7265 6e63  lpha=transparenc
+00065330: 792e 2041 6c6c 206e 756d 6265 7273 2061  y. All numbers a
+00065340: 7265 2062 6574 7765 656e 2030 2061 6e64  re between 0 and
+00065350: 2031 2e20 0d0a 0909 0949 6620 6120 6c69   1. .....If a li
+00065360: 7374 2f76 6563 746f 722f 4461 7461 4672  st/vector/DataFr
+00065370: 616d 6520 6973 2067 6976 656e 2066 6f72  ame is given for
+00065380: 2074 6865 2063 6f6c 6f75 7273 2074 6865   the colours the
+00065390: 7920 7769 6c6c 2062 6520 7573 6564 2069  y will be used i
+000653a0: 6e20 7468 6520 6f72 6465 7220 7072 6f76  n the order prov
+000653b0: 6964 6564 2e0d 0a09 090d 0a09 0945 7861  ided.........Exa
+000653c0: 6d70 6c65 730d 0a09 092d 2d2d 2d2d 2d2d  mples....-------
+000653d0: 2d0d 0a09 090d 0a09 093e 3e3e 2069 6d70  -........>>> imp
+000653e0: 6f72 7420 706c 6f74 5f66 756e 6320 6173  ort plot_func as
+000653f0: 2070 660d 0a09 093e 3e3e 2074 6120 3d20   pf....>>> ta = 
+00065400: 7066 2e54 4128 2774 6573 7431 2e68 6466  pf.TA('test1.hdf
+00065410: 3527 2920 236f 7065 6e20 7468 6520 6f72  5') #open the or
+00065420: 6967 696e 616c 2070 726f 6a65 6374 2c20  iginal project, 
+00065430: 0d0a 0909 3e3e 3e20 7468 6973 204d 5553  ....>>> this MUS
+00065440: 5420 636f 6e74 6169 6e20 6120 6669 742c  T contain a fit,
+00065450: 206f 7468 6572 7769 7365 2074 6869 7320   otherwise this 
+00065460: 7769 6c6c 2072 6169 7365 2061 6e20 6572  will raise an er
+00065470: 726f 720d 0a09 090d 0a09 094e 6f77 206f  ror........Now o
+00065480: 7065 6e20 6120 6275 6e63 6820 6f66 206f  pen a bunch of o
+00065490: 7468 6572 2070 726f 6a65 6374 7320 746f  ther projects to
+000654a0: 2063 6f6d 7061 7265 2061 6761 696e 7374   compare against
+000654b0: 2c0d 0a09 090d 0a09 093e 3e3e 2023 636f  ,........>>> #co
+000654c0: 6d70 6172 6520 696e 2061 2073 696e 676c  mpare in a singl
+000654d0: 6520 7769 6e64 6f77 0d0a 0909 3e3e 3e20  e window....>>> 
+000654e0: 6f74 6865 725f 7072 6f6a 6563 7473 203d  other_projects =
+000654f0: 2070 662e 4755 495f 6f70 656e 2870 726f   pf.GUI_open(pro
+00065500: 6a65 6374 5f6c 6973 7420 3d20 5b27 6669  ject_list = ['fi
+00065510: 6c65 312e 6864 6635 272c 2027 6669 6c65  le1.hdf5', 'file
+00065520: 322e 6864 6635 275d 290d 0a09 093e 3e3e  2.hdf5'])....>>>
+00065530: 2074 612e 436f 6d70 6172 655f 4441 4328   ta.Compare_DAC(
+00065540: 6f74 6865 7273 203d 206f 7468 6572 5f70  others = other_p
+00065550: 726f 6a65 6374 290d 0a09 093e 3e3e 2023  roject)....>>> #
+00065560: 636f 6d70 7261 7265 2069 6e20 7365 7061  comprare in sepa
+00065570: 7261 7465 2077 696e 646f 7773 2c20 0d0a  rate windows, ..
+00065580: 0909 3e3e 3e20 2374 6865 206f 7468 6572  ..>>> #the other
+00065590: 2070 726f 6a65 6374 7320 6d75 7374 2068   projects must h
+000655a0: 6176 6520 7468 6520 7361 6d65 206e 756d  ave the same num
+000655b0: 6265 7220 6f66 2063 6f6d 706f 6e65 6e74  ber of component
+000655c0: 730d 0a09 093e 3e3e 2074 612e 436f 6d70  s....>>> ta.Comp
+000655d0: 6172 655f 4441 4328 6f74 6865 7273 203d  are_DAC(others =
+000655e0: 206f 7468 6572 5f70 726f 6a65 6374 2c20   other_project, 
+000655f0: 7365 7061 7261 7465 5f70 6c6f 7473 203d  separate_plots =
+00065600: 2054 7275 6529 0d0a 0909 0d0a 0909 436f   True)........Co
+00065610: 6d70 6172 6520 7468 6520 4441 4320 746f  mpare the DAC to
+00065620: 2061 6e20 6578 7465 726e 616c 2073 7065   an external spe
+00065630: 6374 7275 6d0d 0a09 090d 0a09 093e 3e3e  ctrum........>>>
+00065640: 2065 7874 5f73 7065 6320 3d20 7064 2e72   ext_spec = pd.r
+00065650: 6561 645f 6373 7628 2741 7363 6969 5f73  ead_csv('Ascii_s
+00065660: 7065 6374 7275 6d2e 6461 7427 2c20 7365  pectrum.dat', se
+00065670: 7020 3d20 272c 2729 0d0a 0909 3e3e 3e20  p = ',')....>>> 
+00065680: 7461 2e43 6f6d 7061 7265 5f44 4143 2873  ta.Compare_DAC(s
+00065690: 7065 6374 7261 203d 2065 7874 5f73 7065  pectra = ext_spe
+000656a0: 6329 2023 636f 6d70 6172 6520 6a75 7374  c) #compare just
+000656b0: 2074 6865 2063 7572 7265 6e74 2073 6f6c   the current sol
+000656c0: 7574 696f 6e0d 0a09 093e 3e3e 2074 612e  ution....>>> ta.
+000656d0: 436f 6d70 6172 655f 4441 4328 7370 6563  Compare_DAC(spec
+000656e0: 7472 6120 3d20 6578 745f 7370 6563 2c20  tra = ext_spec, 
+000656f0: 6f74 6865 7273 203d 206f 7468 6572 5f70  others = other_p
+00065700: 726f 6a65 6374 2920 2363 6f6d 7061 7265  roject) #compare
+00065710: 206d 756c 7469 706c 650d 0a09 090d 0a09   multiple.......
+00065720: 0927 2727 0d0a 0909 0d0a 0909 6966 2073  .'''........if s
+00065730: 656c 662e 7361 7665 5f66 6967 7572 6573  elf.save_figures
+00065740: 5f74 6f5f 666f 6c64 6572 3a73 656c 662e  _to_folder:self.
+00065750: 6669 6775 7265 5f70 6174 6820 3d20 6368  figure_path = ch
+00065760: 6563 6b5f 666f 6c64 6572 2870 6174 6820  eck_folder(path 
+00065770: 3d20 2772 6573 756c 745f 6669 6775 7265  = 'result_figure
+00065780: 7327 2c20 6375 7272 656e 745f 7061 7468  s', current_path
+00065790: 203d 2073 656c 662e 7061 7468 290d 0a09   = self.path)...
+000657a0: 0969 6620 6f74 6865 7220 6973 206e 6f74  .if other is not
+000657b0: 204e 6f6e 653a 0d0a 0909 0969 6620 6e6f   None:.....if no
+000657c0: 7420 6861 7361 7474 7228 6f74 6865 722c  t hasattr(other,
+000657d0: 2027 5f5f 6974 6572 5f5f 2729 3a6f 7468   '__iter__'):oth
+000657e0: 6572 203d 205b 6f74 6865 725d 0d0a 0909  er = [other]....
+000657f0: 7472 793a 0d0a 0909 0972 6520 3d20 7365  try:.....re = se
+00065800: 6c66 2e72 652e 636f 7079 2829 0d0a 0909  lf.re.copy()....
+00065810: 6578 6365 7074 3a0d 0a09 0909 7072 696e  except:.....prin
+00065820: 7428 224e 6f20 6669 7474 6564 2072 6573  t("No fitted res
+00065830: 756c 7473 2070 7265 7365 6e74 2229 0d0a  ults present")..
+00065840: 0909 0972 6574 7572 6e20 4661 6c73 650d  ...return False.
+00065850: 0a09 0969 6620 636d 6170 2069 7320 4e6f  ...if cmap is No
+00065860: 6e65 3a63 6d61 7020 3d20 7365 6c66 2e63  ne:cmap = self.c
+00065870: 6d61 700d 0a09 0973 7065 6369 6573 3d72  map....species=r
+00065880: 655b 2744 4143 275d 2e63 6f6c 756d 6e73  e['DAC'].columns
+00065890: 2e76 616c 7565 730d 0a09 0969 6620 6f74  .values....if ot
+000658a0: 6865 7220 6973 204e 6f6e 653a 0d0a 0909  her is None:....
+000658b0: 0963 6f6c 203d 2072 616e 6765 286c 656e  .col = range(len
+000658c0: 2872 655b 2744 4143 275d 2e63 6f6c 756d  (re['DAC'].colum
+000658d0: 6e73 2e76 616c 7565 7329 290d 0a09 0909  ns.values)).....
+000658e0: 636f 6c6f 7273 203d 2063 6f6c 6d28 636d  colors = colm(cm
+000658f0: 6170 203d 2063 6d61 702c 206b 203d 2063  ap = cmap, k = c
+00065900: 6f6c 290d 0a09 0909 0d0a 0909 656c 7365  ol).........else
+00065910: 3a0d 0a09 0909 7265 5b27 4441 4327 5d2e  :.....re['DAC'].
+00065920: 636f 6c75 6d6e 7320 3d20 5b73 656c 662e  columns = [self.
+00065930: 6669 6c65 6e61 6d65 202b 2027 5c6e 2720  filename + '\n' 
+00065940: 2b20 2725 7327 2561 2066 6f72 2061 2069  + '%s'%a for a i
+00065950: 6e20 7265 5b27 4441 4327 5d2e 636f 6c75  n re['DAC'].colu
+00065960: 6d6e 735d 0d0a 0909 0969 6620 7365 7061  mns].....if sepa
+00065970: 7261 7465 5f70 6c6f 7473 3a0d 0a09 0909  rate_plots:.....
+00065980: 0963 6f6c 6f72 7320 3d20 636f 6c6d 2863  .colors = colm(c
+00065990: 6d61 7020 3d20 636d 6170 2c20 6b20 3d20  map = cmap, k = 
+000659a0: 6e70 2e61 7261 6e67 6528 6c65 6e28 6f74  np.arange(len(ot
+000659b0: 6865 7229 2b31 2929 0d0a 0909 0965 6c73  her)+1)).....els
+000659c0: 653a 0d0a 0909 0909 636f 6c6f 7273 203d  e:......colors =
+000659d0: 2063 6f6c 6d28 636d 6170 203d 2063 6d61   colm(cmap = cma
+000659e0: 702c 206b 203d 206e 702e 6172 616e 6765  p, k = np.arange
+000659f0: 2828 6c65 6e28 6f74 6865 7229 2b31 292a  ((len(other)+1)*
+00065a00: 6c65 6e28 7370 6563 6965 7329 2929 0d0a  len(species)))..
+00065a10: 0909 4441 4320 3d20 7265 5b27 4441 4327  ..DAC = re['DAC'
+00065a20: 5d0d 0a09 0968 616e 643d 5b5d 0d0a 0909  ]....hand=[]....
+00065a30: 6966 2073 6570 6172 6174 655f 706c 6f74  if separate_plot
+00065a40: 733a 0d0a 0909 096e 5f63 6f6c 7320 3d20  s:.....n_cols = 
+00065a50: 696e 7428 6e70 2e63 6569 6c28 6c65 6e28  int(np.ceil(len(
+00065a60: 7265 5b27 4441 4327 5d2e 636f 6c75 6d6e  re['DAC'].column
+00065a70: 7329 2f32 2929 0d0a 0909 0963 6f6c 203d  s)/2)).....col =
+00065a80: 205b 636f 6c6f 7273 5b30 5d20 666f 7220   [colors[0] for 
+00065a90: 6120 696e 2072 616e 6765 286c 656e 2872  a in range(len(r
+00065aa0: 655b 2744 4143 275d 2e63 6f6c 756d 6e73  e['DAC'].columns
+00065ab0: 2929 5d0d 0a09 0909 6966 2073 656c 662e  ))].....if self.
+00065ac0: 7363 6174 7465 7263 7574 2069 7320 4e6f  scattercut is No
+00065ad0: 6e65 3a09 0d0a 0909 0909 6178 203d 2044  ne:.......ax = D
+00065ae0: 4143 2e70 6c6f 7428 7375 6270 6c6f 7473  AC.plot(subplots
+00065af0: 203d 2073 6570 6172 6174 655f 706c 6f74   = separate_plot
+00065b00: 732c 2066 6967 7369 7a65 203d 2028 3132  s, figsize = (12
+00065b10: 2c20 3130 292c 206c 6179 6f75 7420 3d20  , 10), layout = 
+00065b20: 286e 5f63 6f6c 732c 2032 292c 200d 0a09  (n_cols, 2), ...
+00065b30: 0909 0909 0909 0909 6c65 6765 6e64 203d  ........legend =
+00065b40: 2046 616c 7365 2c20 636f 6c6f 7220 3d20   False, color = 
+00065b50: 636f 6c2c 2073 6861 7265 7820 3d20 4661  col, sharex = Fa
+00065b60: 6c73 6529 0d0a 0d0a 0909 0909 613d 6178  lse)........a=ax
+00065b70: 2e72 6176 656c 2829 0d0a 0909 0909 6861  .ravel()......ha
+00065b80: 6e64 6c65 732c 6c61 6265 6c73 3d61 5b30  ndles,labels=a[0
+00065b90: 5d2e 6765 745f 6c65 6765 6e64 5f68 616e  ].get_legend_han
+00065ba0: 646c 6573 5f6c 6162 656c 7328 290d 0a09  dles_labels()...
+00065bb0: 0909 0968 616e 642e 6170 7065 6e64 2868  ...hand.append(h
+00065bc0: 616e 646c 6573 5b2d 315d 290d 0a09 0909  andles[-1]).....
+00065bd0: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
+00065be0: 7365 6c66 2e73 6361 7474 6572 6375 745b  self.scattercut[
+00065bf0: 305d 2c20 206e 756d 6265 7273 2e4e 756d  0],  numbers.Num
+00065c00: 6265 7229 3a0d 0a09 0909 0961 7820 3d20  ber):......ax = 
+00065c10: 4441 432e 6c6f 635b 3a73 656c 662e 7363  DAC.loc[:self.sc
+00065c20: 6174 7465 7263 7574 5b30 5d2c 203a 5d2e  attercut[0], :].
+00065c30: 706c 6f74 2873 7562 706c 6f74 7320 3d20  plot(subplots = 
+00065c40: 7365 7061 7261 7465 5f70 6c6f 7473 2c20  separate_plots, 
+00065c50: 6669 6773 697a 6520 3d20 2831 322c 2031  figsize = (12, 1
+00065c60: 3029 2c20 6c61 796f 7574 203d 2028 6e5f  0), layout = (n_
+00065c70: 636f 6c73 2c20 3229 2c20 0d0a 0909 0909  cols, 2), ......
+00065c80: 0909 0909 0909 0909 096c 6567 656e 6420  .........legend 
+00065c90: 3d20 4661 6c73 652c 2063 6f6c 6f72 203d  = False, color =
+00065ca0: 2063 6f6c 2c20 7368 6172 6578 203d 2046   col, sharex = F
+00065cb0: 616c 7365 2909 0909 0909 0909 090d 0a09  alse)...........
+00065cc0: 0909 0961 3d61 782e 7261 7665 6c28 290d  ...a=ax.ravel().
+00065cd0: 0a09 0909 0968 616e 646c 6573 2c6c 6162  .....handles,lab
+00065ce0: 656c 733d 615b 305d 2e67 6574 5f6c 6567  els=a[0].get_leg
+00065cf0: 656e 645f 6861 6e64 6c65 735f 6c61 6265  end_handles_labe
+00065d00: 6c73 2829 0d0a 0909 0909 6861 6e64 2e61  ls()......hand.a
+00065d10: 7070 656e 6428 6861 6e64 6c65 735b 2d31  ppend(handles[-1
+00065d20: 5d29 090d 0a09 0909 0944 4143 5f63 7574  ]).......DAC_cut
+00065d30: 3d44 4143 2e6c 6f63 5b73 656c 662e 7363  =DAC.loc[self.sc
+00065d40: 6174 7465 7263 7574 5b31 5d3a 2c20 3a5d  attercut[1]:, :]
+00065d50: 0d0a 0909 0909 666f 7220 692c 616d 2069  ......for i,am i
+00065d60: 6e20 656e 756d 6572 6174 6528 4441 435f  n enumerate(DAC_
+00065d70: 6375 742e 636f 6c75 6d6e 7329 3a0d 0a09  cut.columns):...
+00065d80: 0909 0909 4441 435f 6375 742e 696c 6f63  ....DAC_cut.iloc
+00065d90: 5b3a 2c69 5d2e 706c 6f74 2861 7820 3d20  [:,i].plot(ax = 
+00065da0: 615b 695d 2c20 6c65 6765 6e64 203d 2046  a[i], legend = F
+00065db0: 616c 7365 2c20 636f 6c6f 7220 3d20 636f  alse, color = co
+00065dc0: 6c29 0d0a 0909 0965 6c73 653a 0d0a 0909  l).....else:....
+00065dd0: 0909 7363 6174 7465 7263 7574 203d 2066  ..scattercut = f
+00065de0: 6c61 7474 656e 2873 656c 662e 7363 6174  latten(self.scat
+00065df0: 7465 7263 7574 290d 0a09 0909 0966 6f72  tercut)......for
+00065e00: 2069 2069 6e20 7261 6e67 6528 6c65 6e28   i in range(len(
+00065e10: 7363 6174 7465 7263 7574 292f 322b 3129  scattercut)/2+1)
+00065e20: 3a0d 0a09 0909 0909 6966 2069 203d 3d20  :.......if i == 
+00065e30: 303a 0d0a 0909 0909 0909 6178 203d 2044  0:........ax = D
+00065e40: 4143 2e6c 6f63 5b3a 7363 6174 7465 7263  AC.loc[:scatterc
+00065e50: 7574 5b30 5d2c 203a 5d2e 706c 6f74 2873  ut[0], :].plot(s
+00065e60: 7562 706c 6f74 7320 3d20 7365 7061 7261  ubplots = separa
+00065e70: 7465 5f70 6c6f 7473 2c20 6669 6773 697a  te_plots, figsiz
+00065e80: 6520 3d20 2831 322c 2031 3029 2c20 0d0a  e = (12, 10), ..
+00065e90: 0909 0909 0909 0909 0909 0909 0909 6c61  ..............la
+00065ea0: 796f 7574 203d 2028 6e5f 636f 6c73 2c20  yout = (n_cols, 
+00065eb0: 3229 2c20 6c65 6765 6e64 203d 2046 616c  2), legend = Fal
+00065ec0: 7365 2c20 636f 6c6f 7220 3d20 636f 6c2c  se, color = col,
+00065ed0: 2073 6861 7265 7820 3d20 4661 6c73 6529   sharex = False)
+00065ee0: 0d0a 0909 0909 0909 0d0a 0909 0909 0909  ................
+00065ef0: 613d 6178 2e72 6176 656c 2829 0d0a 0909  a=ax.ravel()....
+00065f00: 0909 0909 6861 6e64 6c65 732c 6c61 6265  ....handles,labe
+00065f10: 6c73 3d61 5b30 5d2e 6765 745f 6c65 6765  ls=a[0].get_lege
+00065f20: 6e64 5f68 616e 646c 6573 5f6c 6162 656c  nd_handles_label
+00065f30: 7328 290d 0a09 0909 0909 0968 616e 642e  s()........hand.
+00065f40: 6170 7065 6e64 2868 616e 646c 6573 5b2d  append(handles[-
+00065f50: 315d 2909 0d0a 0909 0909 0965 6c69 6620  1])........elif 
+00065f60: 693c 286c 656e 2873 6361 7474 6572 6375  i<(len(scattercu
+00065f70: 7429 2f32 293a 0d0a 0909 0909 0909 666f  t)/2):........fo
+00065f80: 7220 6a2c 616d 2069 6e20 656e 756d 6572  r j,am in enumer
+00065f90: 6174 6528 6178 293a 0d0a 0909 0909 0909  ate(ax):........
+00065fa0: 0944 4143 2e6c 6f63 5b73 6361 7474 6572  .DAC.loc[scatter
+00065fb0: 6375 745b 322a 692d 315d 3a73 6361 7474  cut[2*i-1]:scatt
+00065fc0: 6572 6375 745b 322a 695d 2c20 3a5d 2e70  ercut[2*i], :].p
+00065fd0: 6c6f 7428 6178 203d 2061 5b6a 5d2c 206c  lot(ax = a[j], l
+00065fe0: 6567 656e 6420 3d20 4661 6c73 652c 2063  egend = False, c
+00065ff0: 6f6c 6f72 203d 2063 6f6c 2c20 6c61 6265  olor = col, labe
+00066000: 6c20 3d20 275f 6e6f 6c65 6765 6e64 5f27  l = '_nolegend_'
+00066010: 290d 0a09 0909 0909 656c 7365 3a0d 0a09  ).......else:...
+00066020: 0909 0909 0966 6f72 206a 2c61 6d20 696e  .....for j,am in
+00066030: 2065 6e75 6d65 7261 7465 2861 7829 3a0d   enumerate(ax):.
+00066040: 0a09 0909 0909 0909 4441 432e 6c6f 635b  ........DAC.loc[
+00066050: 7363 6174 7465 7263 7574 5b2d 315d 3a2c  scattercut[-1]:,
+00066060: 203a 5d2e 706c 6f74 2861 7820 3d20 615b   :].plot(ax = a[
+00066070: 6a5d 2c20 6c65 6765 6e64 203d 2046 616c  j], legend = Fal
+00066080: 7365 2c20 636f 6c6f 7220 3d20 636f 6c2c  se, color = col,
+00066090: 206c 6162 656c 203d 2027 5f6e 6f6c 6567   label = '_noleg
+000660a0: 656e 645f 2729 0d0a 0909 656c 7365 3a0d  end_')....else:.
+000660b0: 0a09 0909 6966 2073 656c 662e 7363 6174  ....if self.scat
+000660c0: 7465 7263 7574 2069 7320 4e6f 6e65 3a09  tercut is None:.
+000660d0: 0d0a 0909 0909 6178 2020 3d20 2044 4143  ......ax  =  DAC
+000660e0: 2e70 6c6f 7428 7375 6270 6c6f 7473 203d  .plot(subplots =
+000660f0: 2073 6570 6172 6174 655f 706c 6f74 732c   separate_plots,
+00066100: 2066 6967 7369 7a65 203d 2028 3136 2c20   figsize = (16, 
+00066110: 3829 2c20 6c65 6765 6e64 203d 2046 616c  8), legend = Fal
+00066120: 7365 2c20 636f 6c6f 7220 3d20 636f 6c6f  se, color = colo
+00066130: 7273 5b3a 6c65 6e28 7370 6563 6965 7329  rs[:len(species)
+00066140: 5d2c 206c 6162 656c 203d 2027 5f6e 6f6c  ], label = '_nol
+00066150: 6567 656e 645f 2729 0d0a 0909 0965 6c69  egend_').....eli
+00066160: 6620 6973 696e 7374 616e 6365 2873 656c  f isinstance(sel
+00066170: 662e 7363 6174 7465 7263 7574 5b30 5d2c  f.scattercut[0],
+00066180: 206e 756d 6265 7273 2e4e 756d 6265 7229   numbers.Number)
+00066190: 3a0d 0a09 0909 0961 7820 203d 2020 4441  :......ax  =  DA
+000661a0: 432e 6c6f 635b 3a73 656c 662e 7363 6174  C.loc[:self.scat
+000661b0: 7465 7263 7574 5b30 5d2c 203a 5d2e 706c  tercut[0], :].pl
+000661c0: 6f74 2873 7562 706c 6f74 7320 3d20 7365  ot(subplots = se
+000661d0: 7061 7261 7465 5f70 6c6f 7473 2c20 6669  parate_plots, fi
+000661e0: 6773 697a 6520 3d20 2831 362c 2038 292c  gsize = (16, 8),
+000661f0: 206c 6567 656e 6420 3d20 4661 6c73 652c   legend = False,
+00066200: 2063 6f6c 6f72 203d 2063 6f6c 6f72 735b   color = colors[
+00066210: 3a6c 656e 2873 7065 6369 6573 295d 2c20  :len(species)], 
+00066220: 6c61 6265 6c20 3d20 275f 6e6f 6c65 6765  label = '_nolege
+00066230: 6e64 5f27 290d 0a09 0909 0961 7820 203d  nd_')......ax  =
+00066240: 2020 4441 432e 6c6f 635b 7365 6c66 2e73    DAC.loc[self.s
+00066250: 6361 7474 6572 6375 745b 315d 3a2c 2020  cattercut[1]:,  
+00066260: 3a5d 2e70 6c6f 7428 6178 3d61 782c 2073  :].plot(ax=ax, s
+00066270: 7562 706c 6f74 7320 3d20 7365 7061 7261  ubplots = separa
+00066280: 7465 5f70 6c6f 7473 2c20 6669 6773 697a  te_plots, figsiz
+00066290: 6520 3d20 2831 362c 2038 292c 206c 6567  e = (16, 8), leg
+000662a0: 656e 6420 3d20 4661 6c73 652c 2063 6f6c  end = False, col
+000662b0: 6f72 203d 2063 6f6c 6f72 735b 3a6c 656e  or = colors[:len
+000662c0: 2873 7065 6369 6573 295d 2c20 6c61 6265  (species)], labe
+000662d0: 6c20 3d20 275f 6e6f 6c65 6765 6e64 5f27  l = '_nolegend_'
+000662e0: 290d 0a09 0909 656c 7365 3a0d 0a09 0909  ).....else:.....
+000662f0: 0973 6361 7474 6572 6375 7420 203d 2020  .scattercut  =  
+00066300: 666c 6174 7465 6e28 7365 6c66 2e73 6361  flatten(self.sca
+00066310: 7474 6572 6375 7429 0d0a 0909 0909 666f  ttercut)......fo
+00066320: 7220 6920 696e 2072 616e 6765 286c 656e  r i in range(len
+00066330: 2873 6361 7474 6572 6375 7429 2f32 2b31  (scattercut)/2+1
+00066340: 293a 0d0a 0909 0909 0969 6620 6920 203d  ):.......if i  =
+00066350: 3d20 2030 3a0d 0a09 0909 0909 0961 7820  =  0:........ax 
+00066360: 203d 2020 4441 432e 6c6f 635b 3a73 6361   =  DAC.loc[:sca
+00066370: 7474 6572 6375 745b 305d 2c20 203a 5d2e  ttercut[0],  :].
+00066380: 706c 6f74 2873 7562 706c 6f74 7320 3d20  plot(subplots = 
+00066390: 7365 7061 7261 7465 5f70 6c6f 7473 2c20  separate_plots, 
+000663a0: 6669 6773 697a 6520 3d20 2831 362c 2038  figsize = (16, 8
+000663b0: 292c 206c 6567 656e 6420 3d20 4661 6c73  ), legend = Fals
+000663c0: 652c 2063 6f6c 6f72 203d 2063 6f6c 6f72  e, color = color
+000663d0: 735b 3a6c 656e 2873 7065 6369 6573 295d  s[:len(species)]
+000663e0: 2c20 6c61 6265 6c20 3d20 275f 6e6f 6c65  , label = '_nole
+000663f0: 6765 6e64 5f27 290d 0a09 0909 0909 656c  gend_').......el
+00066400: 6966 2069 3c28 6c65 6e28 7363 6174 7465  if i<(len(scatte
+00066410: 7263 7574 292f 3229 3a0d 0a09 0909 0909  rcut)/2):.......
+00066420: 0961 7820 203d 2020 4441 432e 6c6f 635b  .ax  =  DAC.loc[
+00066430: 7363 6174 7465 7263 7574 5b32 2a69 2d31  scattercut[2*i-1
+00066440: 5d3a 7363 6174 7465 7263 7574 5b32 2a69  ]:scattercut[2*i
+00066450: 5d2c 2020 3a5d 2e70 6c6f 7428 6178 3d61  ],  :].plot(ax=a
+00066460: 782c 2073 7562 706c 6f74 7320 3d20 7365  x, subplots = se
+00066470: 7061 7261 7465 5f70 6c6f 7473 2c20 6669  parate_plots, fi
+00066480: 6773 697a 6520 3d20 2831 362c 2038 292c  gsize = (16, 8),
+00066490: 206c 6567 656e 6420 3d20 4661 6c73 652c   legend = False,
+000664a0: 2063 6f6c 6f72 203d 2063 6f6c 6f72 735b   color = colors[
+000664b0: 3a6c 656e 2873 7065 6369 6573 295d 2c20  :len(species)], 
+000664c0: 6c61 6265 6c20 3d20 275f 6e6f 6c65 6765  label = '_nolege
+000664d0: 6e64 5f27 290d 0a09 0909 0909 656c 7365  nd_').......else
+000664e0: 3a0d 0a09 0909 0909 0961 7820 203d 2020  :........ax  =  
+000664f0: 4441 432e 6c6f 635b 7363 6174 7465 7263  DAC.loc[scatterc
+00066500: 7574 5b2d 315d 3a2c 2020 3a5d 2e70 6c6f  ut[-1]:,  :].plo
+00066510: 7428 6178 3d61 782c 2073 7562 706c 6f74  t(ax=ax, subplot
+00066520: 7320 3d20 7365 7061 7261 7465 5f70 6c6f  s = separate_plo
+00066530: 7473 2c20 6669 6773 697a 6520 3d20 2831  ts, figsize = (1
+00066540: 362c 2038 292c 206c 6567 656e 6420 3d20  6, 8), legend = 
+00066550: 4661 6c73 652c 2063 6f6c 6f72 203d 2063  False, color = c
+00066560: 6f6c 6f72 735b 3a6c 656e 2873 7065 6369  olors[:len(speci
+00066570: 6573 295d 2c20 6c61 6265 6c20 3d20 275f  es)], label = '_
+00066580: 6e6f 6c65 6765 6e64 5f27 290d 0a09 0969  nolegend_')....i
+00066590: 6620 6f74 6865 7220 6973 206e 6f74 204e  f other is not N
+000665a0: 6f6e 653a 0d0a 0909 0966 6f72 2069 2c6f  one:.....for i,o
+000665b0: 2069 6e20 656e 756d 6572 6174 6528 6f74   in enumerate(ot
+000665c0: 6865 7229 3a0d 0a09 0909 0974 7279 3a0d  her):......try:.
+000665d0: 0a09 0909 0909 7265 3d6f 2e72 652e 636f  ......re=o.re.co
+000665e0: 7079 2829 0d0a 0909 0909 6578 6365 7074  py()......except
+000665f0: 3a0d 0a09 0909 0909 7072 696e 7428 2725  :.......print('%
+00066600: 7320 6861 7320 6e6f 2066 6974 7465 6420  s has no fitted 
+00066610: 7265 7375 6c74 7327 256f 2e66 696c 656e  results'%o.filen
+00066620: 616d 6529 0d0a 0909 0909 0963 6f6e 7469  ame).......conti
+00066630: 6e75 650d 0a09 0909 0972 655b 2744 4143  nue......re['DAC
+00066640: 275d 2e63 6f6c 756d 6e73 3d5b 6f2e 6669  '].columns=[o.fi
+00066650: 6c65 6e61 6d65 202b 2027 5c6e 2720 2b20  lename + '\n' + 
+00066660: 2725 7327 2561 2066 6f72 2061 2069 6e20  '%s'%a for a in 
+00066670: 7265 5b27 4441 4327 5d2e 636f 6c75 6d6e  re['DAC'].column
+00066680: 735d 0d0a 0909 0909 6966 2073 6570 6172  s]......if separ
+00066690: 6174 655f 706c 6f74 733a 0909 0909 0d0a  ate_plots:......
+000666a0: 0909 0909 0963 6f6c 3d5b 636f 6c6f 7273  .....col=[colors
+000666b0: 5b69 2b31 5d20 666f 7220 6120 696e 2072  [i+1] for a in r
+000666c0: 616e 6765 286c 656e 2872 655b 2744 4143  ange(len(re['DAC
+000666d0: 275d 2e63 6f6c 756d 6e73 2929 5d0d 0a09  '].columns))]...
+000666e0: 0909 0909 666f 7220 6a2c 616d 2069 6e20  ....for j,am in 
+000666f0: 656e 756d 6572 6174 6528 7265 5b27 4441  enumerate(re['DA
+00066700: 4327 5d2e 636f 6c75 6d6e 7329 3a0d 0a09  C'].columns):...
+00066710: 0909 0909 0969 6620 6f2e 7363 6174 7465  .....if o.scatte
+00066720: 7263 7574 2069 7320 4e6f 6e65 3a09 0d0a  rcut is None:...
+00066730: 0909 0909 0909 0972 655b 2744 4143 275d  .......re['DAC']
+00066740: 2e69 6c6f 635b 3a2c 6a5d 2e70 6c6f 7428  .iloc[:,j].plot(
+00066750: 7375 6270 6c6f 7473 3d46 616c 7365 2c61  subplots=False,a
+00066760: 783d 615b 6a5d 2c6c 6567 656e 643d 4661  x=a[j],legend=Fa
+00066770: 6c73 652c 636f 6c6f 723d 636f 6c5b 695d  lse,color=col[i]
+00066780: 290d 0a09 0909 0909 0909 6966 206a 3d3d  ).........if j==
+00066790: 303a 0d0a 0909 0909 0909 0909 6861 6e64  0:..........hand
+000667a0: 6c65 732c 6c61 6265 6c73 3d61 5b30 5d2e  les,labels=a[0].
+000667b0: 6765 745f 6c65 6765 6e64 5f68 616e 646c  get_legend_handl
+000667c0: 6573 5f6c 6162 656c 7328 290d 0a09 0909  es_labels().....
+000667d0: 0909 0909 0968 616e 642e 6170 7065 6e64  .....hand.append
+000667e0: 2868 616e 646c 6573 5b2d 315d 2909 0d0a  (handles[-1])...
+000667f0: 0909 0909 0909 656c 6966 2069 7369 6e73  ......elif isins
+00066800: 7461 6e63 6528 6f2e 7363 6174 7465 7263  tance(o.scatterc
+00066810: 7574 5b30 5d2c 2020 6e75 6d62 6572 732e  ut[0],  numbers.
+00066820: 4e75 6d62 6572 293a 0d0a 0909 0909 0909  Number):........
+00066830: 0972 655b 2744 4143 275d 2e69 6c6f 635b  .re['DAC'].iloc[
+00066840: 3a2c 6a5d 2e6c 6f63 5b3a 6f2e 7363 6174  :,j].loc[:o.scat
+00066850: 7465 7263 7574 5b30 5d5d 2e70 6c6f 7428  tercut[0]].plot(
+00066860: 7375 6270 6c6f 7473 3d46 616c 7365 2c61  subplots=False,a
+00066870: 783d 615b 6a5d 2c6c 6567 656e 643d 4661  x=a[j],legend=Fa
+00066880: 6c73 652c 636f 6c6f 723d 636f 6c5b 695d  lse,color=col[i]
+00066890: 290d 0a09 0909 0909 0909 6966 206a 3d3d  ).........if j==
+000668a0: 303a 0d0a 0909 0909 0909 0909 6861 6e64  0:..........hand
+000668b0: 6c65 732c 6c61 6265 6c73 3d61 5b30 5d2e  les,labels=a[0].
+000668c0: 6765 745f 6c65 6765 6e64 5f68 616e 646c  get_legend_handl
+000668d0: 6573 5f6c 6162 656c 7328 290d 0a09 0909  es_labels().....
+000668e0: 0909 0909 0968 616e 642e 6170 7065 6e64  .....hand.append
+000668f0: 2868 616e 646c 6573 5b2d 315d 2909 0d0a  (handles[-1])...
+00066900: 0909 0909 0909 0972 655b 2744 4143 275d  .......re['DAC']
+00066910: 2e69 6c6f 635b 3a2c 6a5d 2e6c 6f63 5b6f  .iloc[:,j].loc[o
+00066920: 2e73 6361 7474 6572 6375 745b 315d 3a5d  .scattercut[1]:]
+00066930: 2e70 6c6f 7428 7375 6270 6c6f 7473 3d46  .plot(subplots=F
+00066940: 616c 7365 2c61 783d 615b 6a5d 2c6c 6567  alse,ax=a[j],leg
+00066950: 656e 643d 4661 6c73 652c 636f 6c6f 723d  end=False,color=
+00066960: 636f 6c5b 695d 2c6c 6162 656c 203d 2027  col[i],label = '
+00066970: 5f6e 6f6c 6567 656e 645f 2729 0d0a 0909  _nolegend_')....
+00066980: 0909 0909 656c 7365 3a0d 0a09 0909 0909  ....else:.......
+00066990: 0909 7363 6174 7465 7263 7574 203d 2066  ..scattercut = f
+000669a0: 6c61 7474 656e 286f 2e73 6361 7474 6572  latten(o.scatter
+000669b0: 6375 7429 0d0a 0909 0909 0909 0966 6f72  cut).........for
+000669c0: 206d 2069 6e20 7261 6e67 6528 6c65 6e28   m in range(len(
+000669d0: 7363 6174 7465 7263 7574 292f 322b 3129  scattercut)/2+1)
+000669e0: 3a0d 0a09 0909 0909 0909 0969 6620 6d20  :..........if m 
+000669f0: 3d3d 2030 3a0d 0a09 0909 0909 0909 0909  == 0:...........
+00066a00: 7265 5b27 4441 4327 5d2e 696c 6f63 5b3a  re['DAC'].iloc[:
+00066a10: 2c6a 5d2e 6c6f 635b 3a73 6361 7474 6572  ,j].loc[:scatter
+00066a20: 6375 745b 305d 5d2e 706c 6f74 2873 7562  cut[0]].plot(sub
+00066a30: 706c 6f74 733d 4661 6c73 652c 6178 3d61  plots=False,ax=a
+00066a40: 5b6a 5d2c 6c65 6765 6e64 3d46 616c 7365  [j],legend=False
+00066a50: 2c63 6f6c 6f72 3d63 6f6c 5b69 5d29 0d0a  ,color=col[i])..
+00066a60: 0909 0909 0909 0909 0969 6620 6a3d 3d30  .........if j==0
+00066a70: 3a0d 0a09 0909 0909 0909 0909 0968 616e  :............han
+00066a80: 646c 6573 2c6c 6162 656c 733d 615b 6a5d  dles,labels=a[j]
+00066a90: 2e67 6574 5f6c 6567 656e 645f 6861 6e64  .get_legend_hand
+00066aa0: 6c65 735f 6c61 6265 6c73 2829 0d0a 0909  les_labels()....
+00066ab0: 0909 0909 0909 0909 6861 6e64 2e61 7070  ........hand.app
+00066ac0: 656e 6428 6861 6e64 6c65 735b 2d31 5d29  end(handles[-1])
+00066ad0: 090d 0a09 0909 0909 0909 0965 6c69 6620  ...........elif 
+00066ae0: 6d3c 286c 656e 2873 6361 7474 6572 6375  m<(len(scattercu
+00066af0: 7429 2f32 293a 0d0a 0909 0909 0909 0909  t)/2):..........
+00066b00: 0972 655b 2744 4143 275d 2e69 6c6f 635b  .re['DAC'].iloc[
+00066b10: 3a2c 6a5d 2e6c 6f63 5b73 6361 7474 6572  :,j].loc[scatter
+00066b20: 6375 745b 322a 6d2d 315d 3a73 6361 7474  cut[2*m-1]:scatt
+00066b30: 6572 6375 745b 322a 6d5d 5d2e 706c 6f74  ercut[2*m]].plot
+00066b40: 2873 7562 706c 6f74 733d 4661 6c73 652c  (subplots=False,
+00066b50: 6178 3d61 5b6a 5d2c 6c65 6765 6e64 3d46  ax=a[j],legend=F
+00066b60: 616c 7365 2c63 6f6c 6f72 3d63 6f6c 5b69  alse,color=col[i
+00066b70: 5d2c 6c61 6265 6c20 3d20 275f 6e6f 6c65  ],label = '_nole
+00066b80: 6765 6e64 5f27 290d 0a09 0909 0909 0909  gend_').........
+00066b90: 0965 6c73 653a 0d0a 0909 0909 0909 0909  .else:..........
+00066ba0: 0972 655b 2744 4143 275d 2e69 6c6f 635b  .re['DAC'].iloc[
+00066bb0: 3a2c 6a5d 2e6c 6f63 5b73 6361 7474 6572  :,j].loc[scatter
+00066bc0: 6375 745b 2d31 5d3a 5d2e 706c 6f74 2873  cut[-1]:].plot(s
+00066bd0: 7562 706c 6f74 733d 4661 6c73 652c 6178  ubplots=False,ax
+00066be0: 3d61 5b6a 5d2c 6c65 6765 6e64 3d46 616c  =a[j],legend=Fal
+00066bf0: 7365 2c63 6f6c 6f72 3d63 6f6c 5b69 5d2c  se,color=col[i],
+00066c00: 6c61 6265 6c20 3d20 275f 6e6f 6c65 6765  label = '_nolege
+00066c10: 6e64 5f27 290d 0a09 0909 0909 0961 5b6a  nd_')........a[j
+00066c20: 5d2e 7365 745f 786c 6162 656c 2827 5761  ].set_xlabel('Wa
+00066c30: 7665 6c65 6e67 7468 2069 6e20 6e6d 2729  velength in nm')
+00066c40: 0909 0909 0d0a 0909 0909 0909 615b 6a5d  ............a[j]
+00066c50: 2e73 6574 5f79 6c61 6265 6c28 2753 7065  .set_ylabel('Spe
+00066c60: 6374 7261 6c20 7374 7265 6e67 7468 2069  ctral strength i
+00066c70: 6e20 6172 622e 2075 6e69 7473 2729 0d0a  n arb. units')..
+00066c80: 0909 0909 0909 615b 6a5d 2e6c 6567 656e  ......a[j].legen
+00066c90: 6428 666f 6e74 7369 7a65 3d38 2c66 7261  d(fontsize=8,fra
+00066ca0: 6d65 6f6e 3d46 616c 7365 290d 0a09 0909  meon=False).....
+00066cb0: 0d0a 0909 0909 656c 7365 3a0d 0a09 0909  ......else:.....
+00066cc0: 0909 6461 6373 3d6c 656e 2872 655b 2744  ..dacs=len(re['D
+00066cd0: 4143 275d 2e63 6f6c 756d 6e73 290d 0a09  AC'].columns)...
+00066ce0: 0909 0909 636f 6c3d 636f 6c6f 7273 5b28  ....col=colors[(
+00066cf0: 692b 3129 2a64 6163 733a 2869 2b32 292a  i+1)*dacs:(i+2)*
+00066d00: 6461 6373 5d09 0d0a 0909 0909 0944 4143  dacs]........DAC
+00066d10: 3d72 655b 2744 4143 275d 0d0a 0909 0909  =re['DAC']......
+00066d20: 0969 6620 6f2e 7363 6174 7465 7263 7574  .if o.scattercut
+00066d30: 2069 7320 4e6f 6e65 3a09 0d0a 0909 0909   is None:.......
+00066d40: 0909 6178 203d 2044 4143 2e70 6c6f 7428  ..ax = DAC.plot(
+00066d50: 7375 6270 6c6f 7473 3d73 6570 6172 6174  subplots=separat
+00066d60: 655f 706c 6f74 732c 6178 3d61 782c 6c65  e_plots,ax=ax,le
+00066d70: 6765 6e64 3d46 616c 7365 2c63 6f6c 6f72  gend=False,color
+00066d80: 3d63 6f6c 6f72 735b 2869 2b31 292a 6c65  =colors[(i+1)*le
+00066d90: 6e28 7370 6563 6965 7329 3a28 692b 3229  n(species):(i+2)
+00066da0: 2a6c 656e 2873 7065 6369 6573 295d 290d  *len(species)]).
+00066db0: 0a09 0909 0909 656c 6966 2069 7369 6e73  ......elif isins
+00066dc0: 7461 6e63 6528 6f2e 7363 6174 7465 7263  tance(o.scatterc
+00066dd0: 7574 5b30 5d2c 2020 6e75 6d62 6572 732e  ut[0],  numbers.
+00066de0: 4e75 6d62 6572 293a 0d0a 0909 0909 0909  Number):........
+00066df0: 6178 203d 2044 4143 2e6c 6f63 5b3a 6f2e  ax = DAC.loc[:o.
+00066e00: 7363 6174 7465 7263 7574 5b30 5d2c 203a  scattercut[0], :
+00066e10: 5d2e 706c 6f74 2873 7562 706c 6f74 733d  ].plot(subplots=
+00066e20: 7365 7061 7261 7465 5f70 6c6f 7473 2c61  separate_plots,a
+00066e30: 783d 6178 2c6c 6567 656e 643d 4661 6c73  x=ax,legend=Fals
+00066e40: 652c 636f 6c6f 723d 636f 6c6f 7273 5b28  e,color=colors[(
+00066e50: 692b 3129 2a6c 656e 2873 7065 6369 6573  i+1)*len(species
+00066e60: 293a 2869 2b32 292a 6c65 6e28 7370 6563  ):(i+2)*len(spec
+00066e70: 6965 7329 5d29 0d0a 0909 0909 0909 4441  ies)])........DA
+00066e80: 432e 6c6f 635b 6f2e 7363 6174 7465 7263  C.loc[o.scatterc
+00066e90: 7574 5b31 5d3a 2c20 3a5d 2e70 6c6f 7428  ut[1]:, :].plot(
+00066ea0: 7375 6270 6c6f 7473 3d73 6570 6172 6174  subplots=separat
+00066eb0: 655f 706c 6f74 732c 6178 3d61 782c 6c65  e_plots,ax=ax,le
+00066ec0: 6765 6e64 3d46 616c 7365 2c63 6f6c 6f72  gend=False,color
+00066ed0: 3d63 6f6c 6f72 735b 2869 2b31 292a 6c65  =colors[(i+1)*le
+00066ee0: 6e28 7370 6563 6965 7329 3a28 692b 3229  n(species):(i+2)
+00066ef0: 2a6c 656e 2873 7065 6369 6573 295d 290d  *len(species)]).
+00066f00: 0a09 0909 0909 656c 7365 3a0d 0a09 0909  ......else:.....
+00066f10: 0909 0973 6361 7474 6572 6375 7420 3d20  ...scattercut = 
+00066f20: 666c 6174 7465 6e28 6f2e 7363 6174 7465  flatten(o.scatte
+00066f30: 7263 7574 290d 0a09 0909 0909 0966 6f72  rcut)........for
+00066f40: 2069 2069 6e20 7261 6e67 6528 6c65 6e28   i in range(len(
+00066f50: 7363 6174 7465 7263 7574 292f 322b 3129  scattercut)/2+1)
+00066f60: 3a0d 0a09 0909 0909 0909 6966 2069 203d  :.........if i =
+00066f70: 3d20 303a 0d0a 0909 0909 0909 0909 6178  = 0:..........ax
+00066f80: 203d 2044 4143 2e6c 6f63 5b3a 7363 6174   = DAC.loc[:scat
+00066f90: 7465 7263 7574 5b30 5d2c 203a 5d2e 706c  tercut[0], :].pl
+00066fa0: 6f74 2873 7562 706c 6f74 733d 7365 7061  ot(subplots=sepa
+00066fb0: 7261 7465 5f70 6c6f 7473 2c61 783d 6178  rate_plots,ax=ax
+00066fc0: 2c6c 6567 656e 643d 4661 6c73 652c 636f  ,legend=False,co
+00066fd0: 6c6f 723d 636f 6c6f 7273 5b28 692b 3129  lor=colors[(i+1)
+00066fe0: 2a6c 656e 2873 7065 6369 6573 293a 2869  *len(species):(i
+00066ff0: 2b32 292a 6c65 6e28 7370 6563 6965 7329  +2)*len(species)
+00067000: 5d29 0d0a 0909 0909 0909 0965 6c69 6620  ]).........elif 
+00067010: 693c 286c 656e 2873 6361 7474 6572 6375  i<(len(scattercu
+00067020: 7429 2f32 293a 0d0a 0909 0909 0909 0909  t)/2):..........
+00067030: 6178 203d 2044 4143 2e6c 6f63 5b73 6361  ax = DAC.loc[sca
+00067040: 7474 6572 6375 745b 322a 692d 315d 3a73  ttercut[2*i-1]:s
+00067050: 6361 7474 6572 6375 745b 322a 695d 2c20  cattercut[2*i], 
+00067060: 3a5d 2e70 6c6f 7428 7375 6270 6c6f 7473  :].plot(subplots
+00067070: 3d73 6570 6172 6174 655f 706c 6f74 732c  =separate_plots,
+00067080: 6178 3d61 782c 6c65 6765 6e64 3d46 616c  ax=ax,legend=Fal
+00067090: 7365 2c63 6f6c 6f72 3d63 6f6c 6f72 735b  se,color=colors[
+000670a0: 2869 2b31 292a 6c65 6e28 7370 6563 6965  (i+1)*len(specie
+000670b0: 7329 3a28 692b 3229 2a6c 656e 2873 7065  s):(i+2)*len(spe
+000670c0: 6369 6573 295d 290d 0a09 0909 0909 0909  cies)]).........
+000670d0: 656c 7365 3a0d 0a09 0909 0909 0909 0961  else:..........a
+000670e0: 7820 3d20 4441 432e 6c6f 635b 7363 6174  x = DAC.loc[scat
+000670f0: 7465 7263 7574 5b2d 315d 3a2c 203a 5d2e  tercut[-1]:, :].
+00067100: 706c 6f74 2873 7562 706c 6f74 733d 7365  plot(subplots=se
+00067110: 7061 7261 7465 5f70 6c6f 7473 2c61 783d  parate_plots,ax=
+00067120: 6178 2c6c 6567 656e 643d 4661 6c73 652c  ax,legend=False,
+00067130: 636f 6c6f 723d 636f 6c6f 7273 5b28 692b  color=colors[(i+
+00067140: 3129 2a6c 656e 2873 7065 6369 6573 293a  1)*len(species):
+00067150: 2869 2b32 292a 6c65 6e28 7370 6563 6965  (i+2)*len(specie
+00067160: 7329 5d29 0d0a 0909 0909 0961 782e 7365  s)]).......ax.se
+00067170: 745f 786c 6162 656c 2827 5761 7665 6c65  t_xlabel('Wavele
+00067180: 6e67 7468 2069 6e20 6e6d 2729 0909 0909  ngth in nm')....
+00067190: 0d0a 0909 0909 0961 782e 7365 745f 796c  .......ax.set_yl
+000671a0: 6162 656c 2827 5370 6563 7472 616c 2073  abel('Spectral s
+000671b0: 7472 656e 6774 6820 696e 2061 7262 2e20  trength in arb. 
+000671c0: 756e 6974 7327 290d 0a09 0909 0909 6178  units').......ax
+000671d0: 2e6c 6567 656e 6428 666f 6e74 7369 7a65  .legend(fontsize
+000671e0: 3d38 2c66 7261 6d65 6f6e 3d46 616c 7365  =8,frameon=False
+000671f0: 290d 0a09 0969 6620 6e6f 7420 6861 7361  )....if not hasa
+00067200: 7474 7228 6178 2c27 5f5f 6974 6572 5f5f  ttr(ax,'__iter__
+00067210: 2729 3a61 783d 6e70 2e61 7272 6179 285b  '):ax=np.array([
+00067220: 6178 5d29 0d0a 0909 6966 2073 7065 6374  ax])....if spect
+00067230: 7261 2069 7320 6e6f 7420 4e6f 6e65 3a0d  ra is not None:.
+00067240: 0a09 0909 666f 7220 6120 696e 2061 783a  ....for a in ax:
+00067250: 0d0a 0909 0909 7370 6563 7472 612e 706c  ......spectra.pl
+00067260: 6f74 2861 783d 612c 7375 6270 6c6f 7473  ot(ax=a,subplots
+00067270: 3d73 6570 6172 6174 655f 706c 6f74 7329  =separate_plots)
+00067280: 0909 0909 0d0a 0909 6669 673d 2861 782e  ........fig=(ax.
+00067290: 7261 7665 6c28 2929 5b30 5d2e 6669 6775  ravel())[0].figu
+000672a0: 7265 0d0a 0909 6966 2073 6570 6172 6174  re....if separat
+000672b0: 655f 706c 6f74 733a 0d0a 0909 0966 6967  e_plots:.....fig
+000672c0: 2e73 6574 5f73 697a 655f 696e 6368 6573  .set_size_inches
+000672d0: 2831 322c 3130 290d 0a09 0909 6178 6573  (12,10).....axes
+000672e0: 5f6e 756d 6265 723d 6669 672e 6765 745f  _number=fig.get_
+000672f0: 6178 6573 2829 0d0a 0909 096e 616d 6573  axes().....names
+00067300: 3d5b 7365 6c66 2e66 696c 656e 616d 655d  =[self.filename]
+00067310: 0d0a 0909 0969 6620 6f74 6865 7220 6973  .....if other is
+00067320: 206e 6f74 204e 6f6e 653a 0d0a 0909 0909   not None:......
+00067330: 666f 7220 6f20 696e 206f 7468 6572 3a0d  for o in other:.
+00067340: 0a09 0909 0909 6e61 6d65 732e 6170 7065  ......names.appe
+00067350: 6e64 286f 2e66 696c 656e 616d 6529 0d0a  nd(o.filename)..
+00067360: 0909 0966 6f72 2069 2c61 7820 696e 2065  ...for i,ax in e
+00067370: 6e75 6d65 7261 7465 2861 7865 735f 6e75  numerate(axes_nu
+00067380: 6d62 6572 293a 0d0a 0909 0909 7472 793a  mber):......try:
+00067390: 0d0a 0909 0909 096e 616d 6574 656d 703d  .......nametemp=
+000673a0: 5b27 2573 2725 7370 6563 6965 735b 695d  ['%s'%species[i]
+000673b0: 202b 2027 202d 2027 202b 2061 2066 6f72   + ' - ' + a for
+000673c0: 2061 2069 6e20 6e61 6d65 735d 0d0a 0909   a in names]....
+000673d0: 0909 0961 782e 6c65 6765 6e64 2868 616e  ...ax.legend(han
+000673e0: 642c 6e61 6d65 7465 6d70 290d 0a09 0909  d,nametemp).....
+000673f0: 0965 7863 6570 743a 0d0a 0909 0909 0970  .except:.......p
+00067400: 6173 730d 0a09 0965 6c73 653a 0d0a 0909  ass....else:....
+00067410: 0961 783d 6669 672e 6765 745f 6178 6573  .ax=fig.get_axes
+00067420: 2829 5b30 5d0d 0a09 0909 6e61 6d65 733d  ()[0].....names=
+00067430: 5b73 656c 662e 6669 6c65 6e61 6d65 5d0d  [self.filename].
+00067440: 0a09 0909 6966 206f 7468 6572 2069 7320  ....if other is 
+00067450: 6e6f 7420 4e6f 6e65 3a0d 0a09 0909 0966  not None:......f
+00067460: 6f72 206f 2069 6e20 6f74 6865 723a 0d0a  or o in other:..
+00067470: 0909 0909 096e 616d 6573 2e61 7070 656e  .....names.appen
+00067480: 6428 6f2e 6669 6c65 6e61 6d65 290d 0a09  d(o.filename)...
+00067490: 0909 6861 6e64 6c65 732c 6c61 6265 6c73  ..handles,labels
+000674a0: 3d61 782e 6765 745f 6c65 6765 6e64 5f68  =ax.get_legend_h
+000674b0: 616e 646c 6573 5f6c 6162 656c 7328 290d  andles_labels().
+000674c0: 0a09 0909 6e61 6d65 7465 6d70 3d5b 5d0d  ....nametemp=[].
+000674d0: 0a09 0909 7472 793a 0d0a 0909 0909 666f  ....try:......fo
+000674e0: 7220 6120 696e 206e 616d 6573 3a0d 0a09  r a in names:...
+000674f0: 0909 0909 666f 7220 6220 696e 2073 7065  ....for b in spe
+00067500: 6369 6573 3a0d 0a09 0909 0909 096e 616d  cies:........nam
+00067510: 6574 656d 702e 6170 7065 6e64 2827 2573  etemp.append('%s
+00067520: 2725 6220 2b20 2720 2d20 2720 2b20 6129  '%b + ' - ' + a)
+00067530: 0d0a 0909 0909 6178 2e6c 6567 656e 6428  ......ax.legend(
+00067540: 6861 6e64 6c65 732c 6e61 6d65 7465 6d70  handles,nametemp
+00067550: 290d 0a09 0909 6578 6365 7074 3a0d 0a09  ).....except:...
+00067560: 0909 0970 6173 730d 0a09 0909 6669 672e  ...pass.....fig.
+00067570: 7365 745f 7369 7a65 5f69 6e63 6865 7328  set_size_inches(
+00067580: 3136 2c38 290d 0a09 0966 6967 2e74 6967  16,8)....fig.tig
+00067590: 6874 5f6c 6179 6f75 7428 290d 0a09 0969  ht_layout()....i
+000675a0: 6620 7365 6c66 2e73 6176 655f 6669 6775  f self.save_figu
+000675b0: 7265 735f 746f 5f66 6f6c 6465 723a 0d0a  res_to_folder:..
+000675c0: 0909 0966 6967 2e73 6176 6566 6967 2863  ...fig.savefig(c
+000675d0: 6865 636b 5f66 6f6c 6465 7228 7061 7468  heck_folder(path
+000675e0: 3d73 656c 662e 6669 6775 7265 5f70 6174  =self.figure_pat
+000675f0: 682c 6669 6c65 6e61 6d65 3d27 636f 6d70  h,filename='comp
+00067600: 6172 655f 4441 432e 706e 6727 292c 6262  are_DAC.png'),bb
+00067610: 6f78 5f69 6e63 6865 733d 2774 6967 6874  ox_inches='tight
+00067620: 2729 0d0a 0d0a 0d0a 0d0a                 ')........
```

### Comparing `KiMoPack-7.0.0/src/KiMoPack.egg-info/PKG-INFO` & `KiMoPack-7.0.1/src/KiMoPack.egg-info/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: KiMoPack
-Version: 7.0.0
+Version: 7.0.1
 Summary: A comprehensive package for the analysis of kinetic data.
 Home-page: https://github.com/erdzeichen/KiMoPack
 Author: Jens Uhlig
 Author-email: jens.uhlig@chemphys.lu.se
 Project-URL: Bug Tracker, https://github.com/erdzeichen/KiMoPack/issues
 Classifier: Programming Language :: Python :: 3
 Classifier: License :: OSI Approved :: GNU General Public License v3 (GPLv3)
```

### Comparing `KiMoPack-7.0.0/src/KiMoPack.egg-info/SOURCES.txt` & `KiMoPack-7.0.1/src/KiMoPack.egg-info/SOURCES.txt`

 * *Files 18% similar despite different names*

```diff
@@ -21,23 +21,14 @@
 Workflow_tools/.ipynb_checkpoints/TA_Raw_plotting-checkpoint.ipynb
 Workflow_tools/.ipynb_checkpoints/TA_Raw_plotting_and_Simple_Fit-checkpoint.ipynb
 Workflow_tools/.ipynb_checkpoints/TA_comparative_plotting_and_data_extraction-checkpoint.ipynb
 Workflow_tools/.ipynb_checkpoints/TA_single_scan_handling-checkpoint.ipynb
 Workflow_tools/.ipynb_checkpoints/TA_testing-checkpoint.ipynb
 Workflow_tools/Data/Sample_1.SIA
 Workflow_tools/Data/Sample_2.SIA
-Workflow_tools/Workflow_tools/TA_Advanced_Fit.ipynb
-Workflow_tools/Workflow_tools/TA_Raw_plotting.ipynb
-Workflow_tools/Workflow_tools/TA_Raw_plotting_and_Simple_Fit.ipynb
-Workflow_tools/Workflow_tools/TA_comparative_plotting_and_data_extraction.ipynb
-Workflow_tools/Workflow_tools/TA_single_scan_handling.ipynb
-Workflow_tools/Workflow_tools/function_library.py
-Workflow_tools/Workflow_tools/import_library.py
-Workflow_tools/Workflow_tools/.ipynb_checkpoints/TA_Advanced_Fit-checkpoint.ipynb
-Workflow_tools/Workflow_tools/.ipynb_checkpoints/TA_Raw_plotting_and_Simple_Fit-checkpoint.ipynb
 Workflow_tools/additional_formats/streak_camera/Analysis of emission data.ipynb
 Workflow_tools/additional_formats/streak_camera/import_library.py
 Workflow_tools/additional_formats/streak_camera/.ipynb_checkpoints/Importing and analysis of emission data-checkpoint.ipynb
 Workflow_tools/additional_functions/cut.py
 Workflow_tools/additional_functions/standard_functions.py
 src/KiMoPack/__init__.py
 src/KiMoPack/plot_func.py
```

