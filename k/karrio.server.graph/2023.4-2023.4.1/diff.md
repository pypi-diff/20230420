# Comparing `tmp/karrio.server.graph-2023.4-py3-none-any.whl.zip` & `tmp/karrio.server.graph-2023.4.1-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,37 +1,37 @@
-Zip file size: 36971 bytes, number of entries: 35
+Zip file size: 36992 bytes, number of entries: 35
 -rw-rw-r--  2.0 unx       81 b- defN 22-Nov-15 19:21 karrio/server/graph/__init__.py
 -rw-rw-r--  2.0 unx       63 b- defN 22-Nov-15 19:21 karrio/server/graph/admin.py
 -rw-rw-r--  2.0 unx       99 b- defN 22-Nov-15 19:21 karrio/server/graph/apps.py
 -rw-rw-r--  2.0 unx     1459 b- defN 22-Nov-15 19:21 karrio/server/graph/forms.py
 -rw-rw-r--  2.0 unx     1321 b- defN 22-Nov-15 19:21 karrio/server/graph/models.py
 -rw-rw-r--  2.0 unx     1110 b- defN 23-Mar-03 13:50 karrio/server/graph/schema.py
--rw-rw-r--  2.0 unx    15022 b- defN 23-Apr-15 09:39 karrio/server/graph/serializers.py
+-rw-rw-r--  2.0 unx    14962 b- defN 23-Apr-19 22:57 karrio/server/graph/serializers.py
 -rw-rw-r--  2.0 unx      183 b- defN 23-Mar-03 13:50 karrio/server/graph/urls.py
 -rw-rw-r--  2.0 unx     7976 b- defN 23-Mar-29 00:05 karrio/server/graph/utils.py
--rw-rw-r--  2.0 unx     2895 b- defN 23-Apr-15 09:51 karrio/server/graph/views.py
+-rw-rw-r--  2.0 unx     3021 b- defN 23-Apr-19 18:37 karrio/server/graph/views.py
 -rw-rw-r--  2.0 unx        0 b- defN 23-Mar-03 13:50 karrio/server/graph/management/__init__.py
 -rw-rw-r--  2.0 unx        0 b- defN 23-Mar-03 13:50 karrio/server/graph/management/commands/__init__.py
 -rw-rw-r--  2.0 unx      294 b- defN 23-Mar-03 13:50 karrio/server/graph/management/commands/export_schema.py
 -rw-rw-r--  2.0 unx     1609 b- defN 22-Nov-15 19:21 karrio/server/graph/migrations/0001_initial.py
 -rw-rw-r--  2.0 unx      538 b- defN 22-Nov-15 19:21 karrio/server/graph/migrations/0002_auto_20210512_1353.py
 -rw-rw-r--  2.0 unx        0 b- defN 22-Nov-15 19:21 karrio/server/graph/migrations/__init__.py
 -rw-rw-r--  2.0 unx       80 b- defN 23-Mar-03 13:50 karrio/server/graph/schemas/__init__.py
 -rw-rw-r--  2.0 unx    10277 b- defN 23-Mar-29 00:11 karrio/server/graph/schemas/base/__init__.py
 -rw-rw-r--  2.0 unx    17909 b- defN 23-Apr-15 08:22 karrio/server/graph/schemas/base/inputs.py
--rw-rw-r--  2.0 unx    21258 b- defN 23-Apr-18 09:10 karrio/server/graph/schemas/base/mutations.py
--rw-rw-r--  2.0 unx    28436 b- defN 23-Apr-18 09:32 karrio/server/graph/schemas/base/types.py
+-rw-rw-r--  2.0 unx    21262 b- defN 23-Apr-19 22:16 karrio/server/graph/schemas/base/mutations.py
+-rw-rw-r--  2.0 unx    28348 b- defN 23-Apr-19 22:14 karrio/server/graph/schemas/base/types.py
 -rw-rw-r--  2.0 unx     3786 b- defN 23-Apr-02 11:05 karrio/server/graph/templates/graphql/graphiql.html
 -rw-rw-r--  2.0 unx      467 b- defN 22-Nov-15 19:21 karrio/server/graph/templates/karrio/email_change_email.html
 -rw-rw-r--  2.0 unx      431 b- defN 22-Nov-15 19:21 karrio/server/graph/templates/karrio/email_change_email.txt
 -rw-rw-r--  2.0 unx      553 b- defN 22-Nov-15 19:21 karrio/server/graph/templates/karrio/password_reset_email.html
 -rw-rw-r--  2.0 unx      226 b- defN 22-Nov-15 19:21 karrio/server/graph/tests/__init__.py
 -rw-rw-r--  2.0 unx     2951 b- defN 23-Apr-17 18:08 karrio/server/graph/tests/base.py
 -rw-rw-r--  2.0 unx     6437 b- defN 23-Mar-03 13:50 karrio/server/graph/tests/test_carrier_connections.py
 -rw-rw-r--  2.0 unx    21626 b- defN 23-Mar-03 13:50 karrio/server/graph/tests/test_templates.py
 -rw-rw-r--  2.0 unx     1919 b- defN 23-Mar-03 13:50 karrio/server/graph/tests/test_user_info.py
 -rw-rw-r--  2.0 unx      106 b- defN 23-Mar-03 13:50 karrio/server/settings/graph.py
--rw-rw-r--  2.0 unx      718 b- defN 23-Apr-18 10:32 karrio.server.graph-2023.4.dist-info/METADATA
--rw-rw-r--  2.0 unx       92 b- defN 23-Apr-18 10:32 karrio.server.graph-2023.4.dist-info/WHEEL
--rw-rw-r--  2.0 unx        7 b- defN 23-Apr-18 10:32 karrio.server.graph-2023.4.dist-info/top_level.txt
--rw-rw-r--  2.0 unx     3362 b- defN 23-Apr-18 10:32 karrio.server.graph-2023.4.dist-info/RECORD
-35 files, 153291 bytes uncompressed, 31397 bytes compressed:  79.5%
+-rw-rw-r--  2.0 unx      720 b- defN 23-Apr-20 18:43 karrio.server.graph-2023.4.1.dist-info/METADATA
+-rw-rw-r--  2.0 unx       92 b- defN 23-Apr-20 18:43 karrio.server.graph-2023.4.1.dist-info/WHEEL
+-rw-rw-r--  2.0 unx        7 b- defN 23-Apr-20 18:43 karrio.server.graph-2023.4.1.dist-info/top_level.txt
+-rw-rw-r--  2.0 unx     3370 b- defN 23-Apr-20 18:43 karrio.server.graph-2023.4.1.dist-info/RECORD
+35 files, 153283 bytes uncompressed, 31402 bytes compressed:  79.5%
```

## zipnote {}

```diff
@@ -87,20 +87,20 @@
 
 Filename: karrio/server/graph/tests/test_user_info.py
 Comment: 
 
 Filename: karrio/server/settings/graph.py
 Comment: 
 
-Filename: karrio.server.graph-2023.4.dist-info/METADATA
+Filename: karrio.server.graph-2023.4.1.dist-info/METADATA
 Comment: 
 
-Filename: karrio.server.graph-2023.4.dist-info/WHEEL
+Filename: karrio.server.graph-2023.4.1.dist-info/WHEEL
 Comment: 
 
-Filename: karrio.server.graph-2023.4.dist-info/top_level.txt
+Filename: karrio.server.graph-2023.4.1.dist-info/top_level.txt
 Comment: 
 
-Filename: karrio.server.graph-2023.4.dist-info/RECORD
+Filename: karrio.server.graph-2023.4.1.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## karrio/server/graph/serializers.py

```diff
@@ -412,24 +412,23 @@
                 settings,
                 payload=dict(label_template=template),
                 context=context,
             )
             settings.save()
 
         carrier = getattr(settings, "carrier_ptr", instance)
-        config = providers.Carrier.resolve_config(carrier, context=context)
         config_data = validated_data.get(carrier_name, {}).get("config")
         if config_data:
             CarrierConfigModelSerializer.map(
-                instance=config,
+                instance=carrier.config,
                 context=context,
                 data={
                     "carrier": carrier.pk,
                     "config": serializers.process_dictionaries_mutations(
-                        ["config"], config_data, config
+                        ["config"], config_data, carrier.config
                     ),
                 },
             ).save()
 
         return carrier
```

## karrio/server/graph/views.py

```diff
@@ -10,29 +10,34 @@
 from rest_framework import exceptions
 
 import strawberry.http as http
 import strawberry.types as types
 import strawberry.django.views as views
 import graphql.error.graphql_error as graphql
 
+import karrio.lib as lib
 import karrio.server.conf as conf
 import karrio.server.graph.schema as schema
 
 logger = logging.getLogger(__name__)
 ACCESS_METHOD = getattr(
     settings,
     "SESSION_ACCESS_MIXIN",
     "karrio.server.core.authentication.AccessMixin",
 )
 AccessMixin: typing.Any = pydoc.locate(ACCESS_METHOD)
 
 
 class GraphQLView(AccessMixin, views.GraphQLView):
     def dispatch(self, request, *args, **kwargs):
-        if self.should_render_graphiql(request):
+        should_render_graphiql = lib.failsafe(
+            lambda: self.should_render_graphiql(request)
+        )
+
+        if should_render_graphiql:
             context = dict(APP_NAME=conf.settings.APP_NAME)
 
             return self._render_graphiql(request, context=context)
 
         return super().dispatch(request, *args, **kwargs)
 
     def process_result(
```

## karrio/server/graph/schemas/base/mutations.py

```diff
@@ -622,15 +622,15 @@
             else:
                 if hasattr(carrier, "active_orgs"):
                     carrier.active_orgs.remove(info.context.request.org)
                 else:
                     carrier.active_users.remove(info.context.request.user)
 
         if "config" in input:
-            config = providers.Carrier.resolve_config(carrier, context=context)
+            config = providers.Carrier.resolve_config(carrier, is_user_config=True)
             serializers.CarrierConfigModelSerializer.map(
                 instance=config,
                 context=context,
                 data={
                     "carrier": carrier.pk,
                     "config": process_dictionaries_mutations(
                         ["config"], (input["config"] or {}), config
```

## karrio/server/graph/schemas/base/types.py

```diff
@@ -733,16 +733,15 @@
         if hasattr(self, "active_orgs"):
             return self.active_orgs.filter(id=info.context.request.org.id).exists()
 
         return self.active_users.filter(id=info.context.request.user.id).exists()
 
     @strawberry.field
     def config(self: providers.Carrier, info: Info) -> typing.Optional[utils.JSON]:
-        config = providers.Carrier.resolve_config(self, context=info.context.request)
-        return getattr(config, "config", None)
+        return getattr(self, "config", None)
 
     @staticmethod
     @utils.authentication_required
     def resolve_list(
         info,
     ) -> typing.List["SystemConnectionType"]:
         return providers.Carrier.system_carriers.filter(
```

## Comparing `karrio.server.graph-2023.4.dist-info/METADATA` & `karrio.server.graph-2023.4.1.dist-info/METADATA`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: karrio.server.graph
-Version: 2023.4
+Version: 2023.4.1
 Summary: Multi-carrier shipping API Graph module
 Home-page: https://github.com/karrioapi/karrio
 Author: karrio
 Author-email: hello@karrio.io
 License: Apache-2.0
 Platform: UNKNOWN
 Classifier: Programming Language :: Python :: 3
```

## Comparing `karrio.server.graph-2023.4.dist-info/RECORD` & `karrio.server.graph-2023.4.1.dist-info/RECORD`

 * *Files 4% similar despite different names*

```diff
@@ -1,35 +1,35 @@
 karrio/server/graph/__init__.py,sha256=iOEMwnlORWezdO8-2vxBIPSR37D7JGjluZ8f55vzxls,81
 karrio/server/graph/admin.py,sha256=suMo4x8I3JBxAFBVIdE-5qnqZ6JAZV0FESABHOSc-vg,63
 karrio/server/graph/apps.py,sha256=grL5ySDnW2amzj0nTXFm-WCoTWViVYvKqGlsi4k5epI,99
 karrio/server/graph/forms.py,sha256=B-oP0xrucKUmijGr3hu7p6ASQ8bNUElo1TgFfq38xZE,1459
 karrio/server/graph/models.py,sha256=CEnE4AsVyjBufyK6ebWmUH3s8DwA0HvZg0fUoZb5Pn4,1321
 karrio/server/graph/schema.py,sha256=lMyn9NZJdVulHWT_wJA6RFpBTtF4o47BBXmH9wsCgQY,1110
-karrio/server/graph/serializers.py,sha256=F8AvV2dwcMwAEUy2ET7FW2l195rLKOmtlr8feYCVWiM,15022
+karrio/server/graph/serializers.py,sha256=j3suw9L2wuIaLzob5QrdmVcg6oIy1FHO-aCJqglBWBk,14962
 karrio/server/graph/urls.py,sha256=HKo0gkx5TgoWDV0ap2QCtueNTmaAqvX6qVDe3c2UT1E,183
 karrio/server/graph/utils.py,sha256=VZZkTblJ49U8ehzgao_47WKVCTz6coxZ0lov6-wq0QM,7976
-karrio/server/graph/views.py,sha256=g0Ab-CfvprjIAN5coEZG1rwll57oWgEdkpl184REHPk,2895
+karrio/server/graph/views.py,sha256=Aua9QZDXa76BSomL4VnxYYzAXZ_BtIS5MnYnjzJB2rI,3021
 karrio/server/graph/management/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 karrio/server/graph/management/commands/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 karrio/server/graph/management/commands/export_schema.py,sha256=WMwiDISpTwtA6MRqSxKjX9LOa3caWEHA_OKRxPIgcsQ,294
 karrio/server/graph/migrations/0001_initial.py,sha256=oeaS5JSkQP6w9ulYar3mdn695ybkog-1QoyKUIW1SCg,1609
 karrio/server/graph/migrations/0002_auto_20210512_1353.py,sha256=TnUwR9EP0qp3gJ38f9w0PYawK2VheDtqXEgyRhYZS2M,538
 karrio/server/graph/migrations/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 karrio/server/graph/schemas/__init__.py,sha256=Kn-I1j3HP3jwZccpz6FL9r1k6b3UEAMVh2kFPCKNS0w,80
 karrio/server/graph/schemas/base/__init__.py,sha256=2mQwFMz_HLxw7VDeSBcYwJIulidfifgpo-phJRVX5GM,10277
 karrio/server/graph/schemas/base/inputs.py,sha256=aMWiwPp8yEnhLADb3keiw5DoxTo6Ck5qP67ADHC0UI8,17909
-karrio/server/graph/schemas/base/mutations.py,sha256=ROGZ0ww7gNwCxo4DlU0Hu9NRrTwaJIgRkgp4-3guDPY,21258
-karrio/server/graph/schemas/base/types.py,sha256=ct4ngQtI8e4MwVp7wR6tojFxdB_Oml357llbECYAMnM,28436
+karrio/server/graph/schemas/base/mutations.py,sha256=d7x8zPECXbxse1p19bUUlLmsJn8oTqLdbkgFd8J7CXI,21262
+karrio/server/graph/schemas/base/types.py,sha256=4fY4jKrspwIHPIvQnZ2994aq-2jm7KEM820rfUDmgUs,28348
 karrio/server/graph/templates/graphql/graphiql.html,sha256=MQjQbBqoRE0QLsOUck8SaXo6B2oJO8dT6YZzUqbDan0,3786
 karrio/server/graph/templates/karrio/email_change_email.html,sha256=YHqTy9VGV_s7kio57Tg3v7TCIN3QlnPHi2ioTOcHJLE,467
 karrio/server/graph/templates/karrio/email_change_email.txt,sha256=NXXuzLR63hn2F1fVAjzmuguptuuTvujwqI7YLSrQoio,431
 karrio/server/graph/templates/karrio/password_reset_email.html,sha256=dttqYVL73cQNuTFsVdn2GV4Ckee8PTY8oEF53GbDRcg,553
 karrio/server/graph/tests/__init__.py,sha256=VPMzf25Q3paSsckO6nwOIGl0WQyovUSZQ6GAYMHNV6Q,226
 karrio/server/graph/tests/base.py,sha256=sUnjorRVfHVi-DKLwFJPd_mh3DP4R_ccksTCPv8AoEM,2951
 karrio/server/graph/tests/test_carrier_connections.py,sha256=tK-abkbMbio-U4cP7-eL6Ew0IY_T1aTCmIJg28i6BpQ,6437
 karrio/server/graph/tests/test_templates.py,sha256=WVU6vcfr6tEk917uSn1dECU8bkQtgD7FNuE-GJuFido,21626
 karrio/server/graph/tests/test_user_info.py,sha256=fa9ErBjgIUFgsAdvHyBACRKQp6AjwSAI5EwW2_k5PmU,1919
 karrio/server/settings/graph.py,sha256=cz2yQHbp3xCfyFKuUkPEFfkI2fFVggExIY49wGz7mt0,106
-karrio.server.graph-2023.4.dist-info/METADATA,sha256=y-WqT0Ym3VGZ-rWMHGtAuDeOlOsFiImSTCtv7tZPW34,718
-karrio.server.graph-2023.4.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
-karrio.server.graph-2023.4.dist-info/top_level.txt,sha256=mfkVZXzNuVRmA7NRlck_Ub-C8Zgtqxbx3gX1Rq_W-i0,7
-karrio.server.graph-2023.4.dist-info/RECORD,,
+karrio.server.graph-2023.4.1.dist-info/METADATA,sha256=ojXKl4n31Gh3VDQlL3MXsl4qTPxeEOlnRM-pvEMZxqY,720
+karrio.server.graph-2023.4.1.dist-info/WHEEL,sha256=pkctZYzUS4AYVn6dJ-7367OJZivF2e8RA9b_ZBjif18,92
+karrio.server.graph-2023.4.1.dist-info/top_level.txt,sha256=mfkVZXzNuVRmA7NRlck_Ub-C8Zgtqxbx3gX1Rq_W-i0,7
+karrio.server.graph-2023.4.1.dist-info/RECORD,,
```

